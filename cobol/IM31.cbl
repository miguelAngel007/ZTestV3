       CBL NOSEQ,S,BUF(16K),LANG(UE)
**************************  IM31  **************************************
*     * 510351 03/03/25 MEJORA EN CUENTAS PARA PASAR A ESTADO PURGADO. *
*     * 413369 18/11/24 CANCELA ESTADO BLOQUEDO CTANEG 137-138         *
*     * 410223 10/06/24 METODOLOGIA SPLIT PARA SALDO COMPROMISO..      *
*     * 203917 31/08/22 INT.ACREEDOR CTA.REMUNERADAS. MES VIGENTE......*
*     * 802262 12/11/20 PROYECTO UPGRADE GN172 EDVR                    *
***   * 602090 07/04/17 JCSC PROXIM 2.4 - GLOSAS                      **
      * FO5238 15/05/2011 PROYECTO REBORN
************************************************************************
00*0050 IDENTIFICATION DIVISION.
000100 PROGRAM-ID. IM31.
000150*REMARKS. DEMAND DEPOSIT FILE MAINTENANCE AND POSTING.            IM004
000180*    *************************************************************IM004
000210*    *************************************************************IM004
000240*    ****                                                     ****IM004
000270*    *******  IM31 PROCEDURE DIVISION FUNCTION DIRECTORY   *******IM004
000300*    ****                                                     ****IM004
000330*    *************************************************************IM004
000360*    *************************************************************IM004
000390*    *                                                           *IM004
000420*    * INITIAL SECTION                                           *IM004
000450*    *     OPEN FILES, INITIALIZATION                A0001-A0099 *IM004
000480*    *     INPUT MASTER READ                         C0500       *IM004
000510*    *                                                           *IM004
000540*    * CONTROL SECTION                                           *IM004
000570*    *     SET LOW CONTROL                           C0600       *IM004
000600*    *     SYSTEM TOTAL RECORD GENERATION            C1000       *IM004
000630*    *     CONTROL BREAK DETERMINATION               C1020-C1040 *IM004
000660*    *     HEADER RECORD PROCESSING                  C2000-2005  *IM004
000690*    *                                                           *IM004
000720*    * PRE-TRANSACTION MASTER PROCESSING                         *IM004
000750*    *     DELETE ACCOUNTS, TRAILERS                 C2100       *IM004
000780*    *     MASTER, WORK AREA INITIALIZATION          C2180-C2189 *IM004
000810*    *     CLEAR LOAN PAYMENT INFORMATION            C2190       *IM004
000840*    *     YEAR-END PROCESSING                       C2200       *IM004
000870*    *     MONTH-END PROCESSING                      C2220       *IM004
000900*    *     CLEAR SERVICE CHARGE INFORMATION          C2250       *IM007
000930*    *     INTEREST RATE RECALCULATIONS              C2300       *IM004
000960*    *     BACKDATED/CORRECTED RATE HISTORY          C2308-C2309 *IM004
000990*    *     SKIPPED DAYS PROCESSING                   C2310-C2369 *IM004
001020*    *     TODAYS LOAN ACCRUAL/AGGREGATION           C2370-C2400 *IM004
001050*    *     BANK/CUST/CASH AVAILABILITY BUMP          C2410-C2447 *IM007
001060*    *     KITING BUMP                               C2450-C2459 *IM006
001080*    *     CLEAR STATEMENT INFORMATION               C2495       *9915855
001090*    *     CLEAR IOD/SAV/OD CYCLE INFORMATION        C255*        9915851
001100*    *     CHECK BCR SW TO REBUILD EDITED ACCT #     C2620       *0417078
001110*    *                                                           *IM004
001140*    * TRANSACTION PROCESSING                                    *IM004
001170*    *     NEW ACCOUNT PROCESSING                    G0010-K0015 *IM004
001200*    *     MONETARY TRANSACTION PRELIMINARY EDITING  K0040-K0080 *IM004
001230*    *     PAST DUE AUTOMATIC LOAN PAYMENT CAPTURE   K0080       *IM004
001260*    *     DDA CHECK PROCESSING                      K0090-K0385 *IM004
001290*    *     DDA DEPOSIT PROCESSING                    K0400-K0550 *IM004
001320*    *     DDA CREDIT PROCESSING                     K0600-K0760 *IM004
001350*    *     DDA DEBIT PROCESSING                      K0800-K1150 *IM004
001380*    *     LOAN CREDIT PROCESSING                    K1200-K1570 *IM004
001410*    *     LOAN DEBIT PROCESSING                     K1600-K1950 *IM004
001440*    *     SAVINGS CREDIT PROCESSING                 K1960-K1975 *IM004
001470*    *     SAVINGS DEBIT PROCESSING                  K1980-K1989 *IM004
001500*    *     CLOSING DDA/SAV TRANSACTION PROCESSING    K1990-K1999 *IM004
001530*    *     NON-MONETARY TRAN CLASS PROCESSING        K2000-K2015 *IM004
001560*    *     BANK AVAIL TRANSACTION PROCESSING         K2080-K2090 *IM007
001570*    *     CUST AVAIL TRANSACTION PROCESSING         K2100-K2180 *IM007
001580*    *     BANK/CUST AVAIL ADJUST TRANS PROCESSING   K2200-K2320 *IM007
001650*    *     STOP/HOLD TRANSACTION PROCESSING          K2400-K2420 *IM004
001660*    *     PASSBOOK PROCESSING                       K2470       *0427139
001680*    *     LIST-POST HEADER PROCESSING               K2500-K2780 *IM004
001710*    *     NAME/ADDRESS CHANGE PROCESSING            K2800-K2850 *IM004
001740*    *     TRAILER DELETE PROCESSING                 K3000-K3197 *IM004
001770*    *     SAVINGS TRAILER ADDITION                  K3200       *IM004
001800*    *     LOAN TRAILER ADDITION                     K3300       *IM004
001802*    *     PLAN TRAILER ADDITION                     K3350       *0617360
001830*    *     MARKETING TRAILER ADDITION                K3400       *IM004
001840*    *     EXPEDITED FUNDS TRAILER ADDITION          K3450       *IM007
001860*    *     AFFILIATE-TRANSFER TRAILER ADDITION       K3500-K3540 *IM004
001890*    *     OVERDRAFT ACCRUAL TRAILER ADDITION        K3600-K3650 *1003625
001920*    *     COMBINED STATEMENT TRAILER ADDITION       K3800-K3840 *IM004
001950*    *     ZERO BALANCE TRAILER ADDITION             K3900       *IM004
001980*    *     LIMIT TRANSFER TRAILER ADDITION           K4000       *IM004
002010*    *     SOCIAL SECURITY N/A TRAILER ADDITION      K4100-K4150 *IM004
002040*    *     STATEMENT REQUEST PROCESSING              K4200-K4240 *IM004
002070*    *     ACCOUNT DELETE TRANSACTION PROCESSING     K4300       *IM004
002075*    *     PLAN ACCOUNT CONTR/DISTR ADJUSTMENT       K4350       *0617360
002100*    *     MEMO TRANSACTION PROCESSING               K4400-K4680 *IM004
002130*    *     FORMATTED MASTER REQUEST  PROCESSING      K4700       *IM004
002160*    *     SPECIAL INSTRUCTION PROCESSING            K4800       *IM004
002190*    *     NON-PAR/LOCK-BOX TRANSACTION PROCESSING   K4900       *IM004
002220*    *     FILE MAINTENANCE TRAN PROCESSING          K5000-K5500 *IM004
002250*    *     LOAN EXTENSION TRANSACTION PROCESSING     K5800       *IM004
002260*    *     EXT INVEST AFTER MAINTENANCE PROCESSING   K5900-K5950 *2016639
002280*    *     STATEMENT ITEM PROCESSING                 K7000-K9000 *IM004
002310*    *     TRANSACTION FILE READ                     Q0010-Q0100 *IM004
002340*    *     LOAN CAUTION ACCOUNT PROCESSING           Q3000       *IM004
002370*    *     TRANSACTION TRIAL CALL                    Q4200       *IM004
002400*    *     LARGE ITEMS PROCESSING                    Q4250-Q4300 *IM004
002430*    *     TRANSACTION FILE WRITE (I/O)              Q5000       *IM004
002460*    *                                                           *IM004
002490*    * AFTER TRANSACTION MASTER PROCESSING                       *IM004
002520*    *     ACCOUNT/TRAILER DROPPED IF PURGE          R0010-R0020 *IM004
002550*    *     DELETED TRAILER COMPRESSION               R0030-R0089 *IM004
002580*    *     LOAN OVERPAYMENT RECONCILIATION           R0100-R0120 *IM004
002610*    *     AUTOMATIC LOAN PAYMENT CAPTURE & BILLING  R0300-R0495 *IM004
002640*    *     LOAN DELINQUENCY PROCESSING (PHASE)       R0500-R0585 *IM004
002650*    *     EXPEDITED FUNDS PROCESSING  (PHASE)       R0700-R0800 *IM007
002670*    *     OVERDRAFT CHARGE GENERATION               R1100-R1130 *IM004
002700*    *     NSF CHARGE GENERATION                     R1150-R1160 *IM004
002730*    *     DRAWING AGAINST UNAVAILABLE CHARGE GEN    R1180-R1190 *IM007
002760*    *     STATEMENT DETERMINATION                   R1200-R1620 *IM004
002790*    *     COMBINED STATEMENT REQUESTS               R1800-R1890 *IM004
002820*    *     SERVICE CHARGE DETERMINATION              R2000-R2450 *IM004
002821*    *     IOD/SAV INT PAYMENT / OD CHARGE           R2500       *9915851
002830*    *     MAINTENANCE OF MINIMUM DDA BALANCE        R2675-R2687 *IM005
002850*    *     LOAN PAYMENT CALC/ACCRUAL/INTEREST XFER   R3600-R3674 *IM005
002910*    *     LOAN TRANSACTION GENERATION               R3690       *IM004
002940*    *     LOAN OVERLIMIT PROCESSING                 R3695       *IM004
002970*    *     IOD INTEREST ACCRUAL (PHASE)              R3775-R3785 *IM004
003000*    *     IOD INTEREST PAYMENT PROCESSING           R3790       *IM004
003030*    *     SAVINGS TRAILER PROCESSING                R3800       *IM004
003060*    *     SAV INTEREST ACCRUAL (PHASE)              R3820-R3825 *IM004
003090*    *     SAV INTEREST PAYMENT PROCESSING (PHASE)   R3830-R3899 *IM004
003120*    *     OVERDRAFT ACCRUAL (PHASE)                 R3900-R3920 *IM004
003150*    *     BALANCE AGGREGATES ACCUMULATIONS          R4000-R4010 *IM004
003180*    *     OVERDRAFT INTEREST CHARGE (PHASE)         R4011-R4013 *IM004
003210*    *     SERVICE CHARGE PROCESSING (PHASE)         R4014-R4080 *IM004
003240*    *     AMOUNT TRANSFER TRAILER PROCESSING        R4100-R4270 *IM004
003270*    *     DATA CENTER TRAILER PROCESSING            R4280-R4299 *IM004
003300*    *     MARKETING TRAILER PROCESSING              R4300-R4490 *0617360
003310*    *     PLAN TRAILER PROCESSING                   R4500-R4520 *0617360
003330*    *     CMA SWEEP PROCESSING                      R4600-R4690 *9916431
003350*    *     NEXT DAY EXTERNAL INVESTMENT PROCESSING   R4700-R4799 *2016639
003360*    *     LIMIT TRANSFER TRAILER PROCESSING         R4800-R4880 *IM007
003390*    *     TARGET AMT ACCOUNT TRAILER PROCESSING     R4900-R4910 *IM004
003420*    *     STATEMENT EXCEPTION GENERATION, REQUESTS  R5000-R5195 *IM004
003450*    *     LOAN STATEMENT PROCESSING                 R5196-R5210 *IM004
003480*    *     INTERNAL DDA/INTEREST TRANSFER            R5300       *IM004
003510*    *     KITING SUSPECT DETERMINATION              R5320-R5350 *IM004
003540*    *     REPORTABLE BAL CHANGE DETERMINATION       R5400       *IM004
003570*    *     OVERDRAFT FOLLOW-UP                       R5500       *IM004
003575*    *     ESCHEATMENT PROCESSING                    R7100       *0902504
003600*    *     STATUS CHANGE PROCESSING                  R6000-R7500 *IM006
003610*    *     LOAN ORIGINATION COSTS PROCESSING         R7600-R7630 *IM006
003615*    *     LOAN AUTO CHG STATUS TO 6-STOP ACCRUAL    R7800        0627535
003620*    *                                                           *IM006
003660*    * REPORTS EXCEPTION GENERATION                  R8000-R8900 *IM004
003670*    *     EXTERNAL INVESTMENT REPORTING             R9100-R9199 *2016639
003690*    *                                                           *IM004
003720*    * OUTGOING SECTION                                          *IM004
003750*    *     OUTGOING TOTALS/FORWARD DAYS PROCESSING   S0100-S1500 *IM004
003780*    *     TRIAL BALANCE PRINT (PHASE)               S2000       *IM004
003810*    *     SPECIAL INSTRUCTION PRINT                 S2010-S2020 *IM004
003840*    *     WRITE OUTPUT MASTER RECORD                S2500-S3000 *IM004
003870*    *                                                           *IM004
003900*    * PERFORMED PARAGRAPHS SECTION                              *IM004
003930*    *     CLEAR DDA TOTALS                          A0010       *IM004
003960*    *     CLEAR LOAN/SAVINGS TOTALS                 A0010       *IM004
003990*    *     TRIAL BALANCE CALL                        S2000       *IM004
004020*    *     WRITE MASTER                              S2500       *IM004
004050*    *     WRITE EXCEPTION RECORD                    AFTER S2500 *IM004
004080*    *     WRITE EXCEPTION MASTER                    AFTER S2500 *IM004
004110*    *     CALCULATE AVAILABLE BALANCE               AFTER S2500 *IM004
004140*    *     WRITE GENERATED TRANSACTIONS              AFTER S2500 *IM004
004170*    *     TRANSACTION ACCRUAL ADJUSTMENT            AFTER S2500 *IM004
004200*    *     ACCRUED INTEREST ADJUSTMENT               AFTER S2500 *IM004
004225*    *     BUILD EDITED ACCT NUMBER                  X0140       *0417078
004230*    *     READ AND PROCESS RATE HISTORY             X0200-X0880 *IM004
004260*    *     OVERDRAFT ACCRUED INTEREST ADJUSTMENT     X0900        IM004
004270*    *     CAPITALIZATION OF INTEREST                X0950        9915845
004290*    *                                                           *IM004
004320*    * FINAL SECTION                                             *IM004
004350*    *     TRIAL BALANCE BREAK DETERMINATION         Y0100       *IM008
004380*    *     READ BANK CONTROL FILE                    Y1100       *IM004
004410*    *     BUILD BANK REPORT TABLE                   Y1200-Y1220 *IM004
004470*    *     REWRITE BANK CONTROL (RUN COMPLETED)      Z0010-Z0070 *IM004
004500*    *     ERROR ROUTINES                            Z2000-Z2600 *IM004
004530*    *                                                           *IM004
004560*    *                                                           *IM004
004590*    *************************************************************IM004
004620*    *************************************************************IM004
004650*    *************************************************************IM004
007500     SKIP1
007502*----------------------------------------------------------------*0266725
007504*                **  HISTORY OF REVISION **                      *0266725
007506*                                                                *0266725
007508*  DATE     DESCRIPTION                                  CHNGID  *0266725
007510*  -------- -------------------------------------------  --------*0266725
007512*                                                                *0266725
007514*  07/25/01 REPLACE THE CALLS TO SIMVECHR WITH THE COBOL ~~~6725 *0266725
007516*           INSTRUCTION FOR MOVE-BY-REFERENCE.                   *0266741
007517* 01/06/02 CODE MODIFIED FOR DBCS ENABLING                        0266741
007518* 14/09/10 REAPPLY CODE: CONTROL CLOSING W/ GRACE DAYS   IMI002  *IMI002
007519* 14/09/10 REAPPLY CODE: HANDLING OF ACCOUNT STATUS      IMIB004 *IMIB004
007520* 14/09/10 REAPPLY CODE: DETERMINE STATUS MAINTENANCE    IMIB51  *IMIB51
007521* 14/09/10 REAPPLY CODE: DETERMINE RATE FOR SPECIAL A/CS IMIB056 *IMIB056
007522* 14/09/10 REAPPLY CODE: SKIP TO PARAGRAPH R1805         IMIB59  *IMIB59
007523* 14/09/10 REAPPLY CODE: SKIP PROC FOR CLOSED ACCOUNTS   IMIB60  *IMIB60
007524* 14/09/10 REAPPLY CODE: CALL IM31IBST MODULE            IMIBXXX *IMIBXXX
007525* 14/09/10 REAPPLY CODE: INITIALISE OD STATUS & YTD CHGD IMODTRAI*IMODTRAI
007526* 14/09/10 REAPPLY CODE: GRACE DAYS CHECKING             0702079 *0702079
007527* 14/09/10 REAPPLY CODE: SKIP STATUS CHANGE OF 08 TO 05  060I035 *060I035
007528* 14/09/10 REAPPLY CODE: POST IF TRAN ACCEPTED ONLINE    IMIBXX  *IMIBXX
007529* 19/04/11 DEFINE WORK AREA FOR CUSTOMER NUMBER FIELD    IMUP021 *IMUP021
007530* 26/04/11 APPLIED RSEC FIX FOR IM0145                   ~~~0145 *
007531* 27/04/11 APPLIED RSEC FIX FOR IM0161                   ~~~0161 *
007532* 27/04/11 APPLIED RSEC FIX FOR IM0179                   ~~~0179 *
007533* 02/05/11 APPLIED RSEC FIX FOR IM0183                   ~~~0183 *
007534* 22/11/11 ADD LIMIT EXPIRING TOMORROW TO ONLINE TOTAL   U22NOV  *
007535* 19/12/11 FIX REASON CLOSE ISSUE C2010-01               UC2010  *
007536* 06/01/12 MOVED CODE TO COPYBOOK DUE TO LIBRARIAN ISSUE U06ENE  *
007549*----------------------------------------------------------------*0266725
007550 ENVIRONMENT DIVISION.
007600 CONFIGURATION SECTION.
007650*    *************************************************************
007700*    *               SEGMENT PRIORITY LEVEL INDEX                *
007750*    *************************************************************
007800*    *                                                           *
007850*    *  LEVEL        FUNCTION                                    *
007900*    *                                                           *
007950*    *    1      ROOT SEGMENT                                    *
008000*    *   19      SEGMENTED AREA NORMALLY IN CORE                 *
008050*    *   20      IOD INTEREST PROCESSING                         *
008100*    *   21      SAV INTEREST PROCESSING                         *
008150*    *   22      LIST-POST HEADER PROCESSING                     *
008200*    *   23      FILE MAINTENANCE APPLICATION                    *
008250*    *   23      FILE MAINTENANCE RECALCULATION AND EDITING      *
008300*    *   24      LOAN TRANSACTION PROCESSING                     *
008350*    *   25      LOAN TRANSACTION PROCESSING                     *
008400*    *   26      LOAN MASTER PROCESSING                          *
008450*    *   31      AMOUNT TRANSFER PROCESSING                      *
008500*    *   34      MEMO TRANSACTION PROCESSING                     *
008550*    *   36      CUST AVAIL TRANS/ADJUSTMENTS PROCESSING         *IM007
008600*    *   46      TRAILER ADDITIONS AND DELETIONS (EXCEPT N/A)    *
008650*    *   47      TRAILER ADDITIONS AND DELETIONS (EXCEPT N/A)    *
008700*    *   48      CONTROL BREAK AND BCR PROCESSING                *
008750*    *   49      INITIALIZATION AND FINALIZATION ROUTINES        *
008800*    *                                                           *
008850*    *************************************************************
008900*    *       TO INCLUDE ANY OF THE ABOVE FUNCTIONS AS CORE       *
008950*    *   RESIDENT, CHANGE THE SEGMENT-LIMIT LEVEL TO BE          *
009000*    *   ABOVE (UP TO 50) THE DESIRED FUNCTIONS LEVEL, RECOMPILE.*
009050*    *       FOR SEGMENT PROGRAM LOCATIONS, SEE THE CROSS-REFER- *
009100*    *   ENCE FOR DEFINITION. SEGMENTS ARE DESCRIPTIVELY NAMED.  *
009150*    *************************************************************
009200 INPUT-OUTPUT SECTION.
009250 FILE-CONTROL.
009300 DATA DIVISION.
009350 WORKING-STORAGE SECTION.
009351 77  SI-MODULE-INFO      PIC X(64)
009352     VALUE 'IM31      -----TSD-             11/23/10  21.43.51'.
009353*    THIS PROGRAM CONTAINS TRADE SECRETS THAT BELONG
009354*    TO FIDELITY INFORMATION SERVICES AND IS
009355*    LICENSED BY AN AGREEMENT.  ANY UNAUTHORIZED ACCESS,
009356*    USE, DUPLICATION, OR DISCLOSURE IS UNLAWFUL.
009357*    COPYRIGHT FIDELITY INFORMATION SERVICES
009358*    2010, ALL RIGHTS RESERVED.
009400 77  PROGRAM-NAME    PIC X(8)        VALUE 'IM31'.
009450 77  SDD-CHANGE      PIC X(12)       VALUE '06/25/76,000'.
009500 77  DC-CHANGE       PIC X(12)       VALUE '00/00/00,000'.
009550 77  LR-DAY          PIC S9999       COMP        SYNC.            IM007
009551 77  HR              PIC S9999       COMP        SYNC.            9915845
009552 77  HX              PIC S9999       COMP        SYNC.            9916139
009553 77  T               PIC S9999       COMP        SYNC.            9916139
009554 77  U               PIC S9999       COMP        SYNC.            9915845
009560 77  V               PIC S9999       COMP        SYNC.            IM007
009600 77  W               PIC S9999       COMP        SYNC.
009650 77  X               PIC S9999       COMP        SYNC.
009750 77  Z               PIC S9999       COMP        SYNC.
009800 77  SAVE-SC-DATE    PIC X(6)        VALUE SPACES.
009850 77  MAINT-START     PIC S9999       COMP        SYNC.
009900 77  MAINT-LENGTH    PIC S9999       COMP        SYNC.
009950 77  GO-TO-INDEX     PIC S9999       COMP        SYNC.
010000 77  BIN-1           PIC S9999       COMP        SYNC VALUE +0001.IM008
010007 77  BIN-5           PIC S9999       COMP        SYNC VALUE +0005.IM008
010014 77  BIN-10          PIC S9999       COMP        SYNC VALUE +0010.IM008
010021 77  BIN-15          PIC S9999       COMP        SYNC VALUE +0015.IM008
010028 77  BIN-19          PIC S9999       COMP        SYNC VALUE +0019.IM008
010030 77  BIN-20          PIC S9999       COMP        SYNC VALUE +0020.9916309
010035 77  NEG-1           PIC S9999       COMP        SYNC VALUE -0001.IM008
010040 77  IMFTC-EOF-SW    PIC X           VALUE '0'.                   9915749
010045 77  IMFTC-1ST-RD-SW PIC X           VALUE '1'.                   9916298
010050 77  WK-PRM-CHG      PIC X           VALUE '0'.
010060 77  PROD-OPEN-SW    PIC X           VALUE '0'.                   1105504
010070 77  MASS-PROD-MAINT PIC X           VALUE '0'.                   IM002
010080 77  MASS-NOTICES-SW PIC X           VALUE '0'.                   1004015
010100 77  TRAN-REWRITE-SW PIC X           VALUE '0'.
010150 77  SKIP-READ-SW    PIC X           VALUE '0'.
010200 77  SKIP-READ-MEMO  PIC X           VALUE '0'.
010250 77  BCR-BRK-SW      PIC X           VALUE '1'.
010300 77  NEW-MASTER-SW   PIC X           VALUE '0'.
010350 77  FIRST-READ-SW   PIC X           VALUE '1'.
010400 77  NEW-BANK-SW     PIC X           VALUE '0'.
010450 77  UPLINE-REJ-SW   PIC X           VALUE '0'.
010460 77  TIS-STMT-SW     PIC X           VALUE '0'.                   1004382
010470 77  TIS-SV-STMT-SW  PIC X           VALUE '0'.                   1004382
010500 77  ACCT-NOT-FOUND  PIC X           VALUE '0'.
010550 77  STOP-HIT-FLAG   PIC X           VALUE '0'.
010560 77  HAF-HIT-FLAG    PIC X           VALUE '0'.                   0902008
010570 77  RATE-CHG-SW     PIC X           VALUE '0'.                   1020057
010580 77  NEW-LOAN-SW     PIC X           VALUE '0'.                   1020057
010600 77  POST-COMPL      PIC X           VALUE '0'.
010650 77  CALC-AMT1       PIC S9(13)V99   VALUE +0.00 COMP-3.
010700 77  CALC-AMT2       PIC S9(13)V99   VALUE +0.00 COMP-3.
010750 77  HOLD-CALC1      PIC S9(15)      VALUE +0    COMP-3.          9915845
010800 77  HOLD-CALC2      PIC S9(15)      VALUE +0    COMP-3.          9915845
010802 77  IN-MMDA-CHECKS  PIC S9(7)      VALUE +0    COMP-3.           0266776
010804 77  IN-MMDA-XFERS   PIC S9(7)      VALUE +0    COMP-3.           0266776
010806 77  IN-MMDA-COMB    PIC S9(7)      VALUE +0    COMP-3.           0266776
010850 77  HDR-FLAG        PIC X           VALUE '0'.
010900 77  STATUS-IN       PIC XX.
010902 77  OD-REGE-OPT-CODE-IN PIC XX.                                  1020116
010950 77  TR-ITEM-COUNT   PIC S9(7)       COMP-3.
011000 77  LOAN-STATUS-IN  PIC X.
011050 77  NEW-ACCT-REJ-SW PIC X           VALUE '0'.
011100 77  NSF-TOTAL-SW    PIC X           VALUE '0'.
011150 77  ACCR-SW         PIC X           VALUE 'F'.
011200 77  WK-PSBK-ACCT-NO PIC X(10)       VALUE SPACES.                0427139
011250 77  AMT-PD          PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011300 77  DIFF-AMT        PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011350 77  MAX-TRNSFR-FG   PIC X           VALUE 'F'.
011352 77  RW-SW           PIC X           VALUE 'N'.                   0817741
011354 77  WK-STMT-ERR     PIC X           VALUE 'N'.                   0917834
011400 77  POS-TRFR-AMT    PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011450 77  HOLD-AMT-MTD    PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011500 77  PAYOFF-AMT      PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011550 77  AMT-SHORT       PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011600 77  DCD-NET-INT     PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011650 77  TOL-INT-AMT     PIC S9(13)V99   VALUE +0.00 COMP-3.          9915845
011655 77  SAVE-DAILY-ACCR-RATE PIC SVP9(15) VALUE +0.00 COMP-3.        0335614
011700 77  TOLERANCE-SW        PIC X           VALUE 'F'.               IM004
011710 77  SUPP-STMT-SW        PIC X           VALUE 'F'.               IM006
011720 77  IBT-SKIP-SW         PIC X           VALUE 'F'.               0827814
011730 77  PAYOFF-SW           PIC X           VALUE 'F'.               IM005
011740 77  LOAN-COSTS-FLAG     PIC X           VALUE '0'.               IM006
011750 77  WK-SV-STATUS-IN     PIC X           VALUE '9'.
011800 77  WK-LN-STATUS-IN     PIC X           VALUE '9'.
011850 77  WK-IM-STATUS-IN     PIC XX          VALUE '99'.
011900 77  WK-OD-STATUS-IN     PIC X           VALUE '9'.
011950 77  WK-DCD-STATUS-IN    PIC X           VALUE '9'.
011970 77  WK-EFA-STATUS-IN    PIC X           VALUE '9'.               IM007
012000 77  NEW-BK-NO-TRN-FLAG  PIC X           VALUE '0'.
012020 77  SRC-INFO-LENGTH-FLG PIC X           VALUE '0'.               IM006
012050 77  LN-ND-FLG           PIC X           VALUE '0'.
012100 77  LN-ND-AMT           PIC S9(13)V99   VALUE +0    COMP-3.      9915845
012102 77  WK-ROUND-ACCR       PIC S9(13)V99   VALUE +0    COMP-3.      0817836
012105 77  CMA-DDA-PAST-BAL    PIC S9(15)V99   VALUE +0    COMP-3.      2016683
012110 77  CMA-AGGR-DAYS       PIC S9(3)       VALUE +0    COMP-3.      2016683
012115 77  CMA-PAST-AGGR-DAYS  PIC S9(3)       VALUE +0    COMP-3.      2016683
012150 77  AGG-AMT             PIC S9(15)V99   VALUE +0    COMP-3.      9915845
012200 77  SAVE-AGGR           PIC S9(15)V99   VALUE +0    COMP-3.      9915845
012202 77  SAVE-INT-AGGR-BAL   PIC S9(15)V99   VALUE +0    COMP-3.      9916431
012204 77  SAVE-INT-AGGR-COLL  PIC S9(15)V99   VALUE +0    COMP-3.      9916431
012220 77  SAVE-AGGR-DAYS      PIC S9(3)       VALUE +0    COMP-3.      IM007
012221 77  SAVE-SC-AGGR-DAYS   PIC S9(3)       VALUE +0    COMP-3.      2016653
012222 77  SAVE-CMA-AGGR-DAYS  PIC S9(3)       VALUE +0    COMP-3.      2016683
012223 77  SAVE-CMA-PAST-AGGR  PIC S9(3)       VALUE +0    COMP-3.      2016683
012250 77  HOLD-STMT-PAGES     PIC S9(5)       VALUE +0    COMP-3.
012300 77  HOLD-DAYS           PIC S9(5)       VALUE +0    COMP-3.
012350 77  HOLD-STMT-LINES     PIC S9(5)       VALUE +0    COMP-3.
012400 77  TOT-NO-WKEND        PIC S9(5)       VALUE +0    COMP-3.
012450 77  DAILY-BAL-LINES     PIC S9(5)       VALUE +0    COMP-3.
012500 77  HOLD-WEEK-DAY       PIC S9          VALUE +0    COMP-3.
012510 77  HOLD-WEEK-DAY2      PIC S9          VALUE +0    COMP-3.      9915682
012550 77  DAILY-BAL-PAGES     PIC S9(5)       VALUE +0    COMP-3.
012555 77  HOLD-DDA-LEAP-FLG   PIC X           VALUE '0'.               9715519
012560 77  HOLD-SAV-LEAP-FLG   PIC X           VALUE '0'.               9715519
012565 77  HOLD-NEW-MASTER-SW  PIC X           VALUE '0'.               9715519
012570 77  HOLD-OPEN-DATE      PIC X(6)        VALUE SPACES.            9715519
012580 77  HOLD-CAPT-DATE      PIC X(8)        VALUE SPACES.            0617360
012600 77  IOD-FLAG            PIC X           VALUE 'F'.
012610 77  BONUS-CLEAR         PIC X           VALUE 'F'.               2016374
012650 77  IOD-CLOSE-FLAG      PIC X           VALUE 'F'.
012700 77  IOD-CLEAR           PIC X           VALUE 'F'.
012750 77  SAV-CLEAR           PIC X           VALUE 'F'.
012770 77  CLEAR-SAV-CY-SW     PIC X           VALUE 'F'.               IM002
012800 77  AFFL-ACCT-FLAG      PIC X           VALUE 'F'.
012812 77  IBT-NEW-FLAG        PIC X           VALUE '0'.               9915845
012816 77  IBT-96-FLAG         PIC X           VALUE '0'.               9915845
012818 77  IBT-ACCT-IND        PIC X           VALUE '0'.               9915845
012820 77  SAVE-IBT-FLG        PIC X           VALUE ' '.               9915845
012830 77  SAVE-IBT-HIGHST-SEG PIC X           VALUE ' '.               9915845
012840 77  SAVE-IBT-STMT-REQ   PIC X           VALUE ' '.               9915845
012850 77  SAVE-TYPE           PIC X           VALUE ' '.
012855 77  SAVE-CODE           PIC X           VALUE ' '.               IM008
012860 77  OL-DELETE-SW        PIC X           VALUE '0'.               IM003
012870 77  SAVE-EXC-14-REC     PIC X(248)      VALUE ' '.               9916070
012880 77  SAVE-REC            PIC X(3069)     VALUE ' '.               9915239
012890 77  SAVE-EXT-SC-REC     PIC X(2000)     VALUE ' '.               9915845
012892 77  SAVE-RATE-TRAILER   PIC X(1534)     VALUE ' '.               2012254
012896 77  SAVE-MASTER-FLAG    PIC X           VALUE '0'.               IM008
012900 77  PRINT-AREA          PIC X(133)      VALUE ' '.
012910 77  TISA-HOLD-ACCR      PIC S9(11)V9(6) VALUE ZERO.              9915845
012950 77  GL-TOTAL-CTR                PIC S9999       COMP      SYNC.  1003625
012955 77  GL-WRITE-TOTAL-CTR          PIC S9999       COMP      SYNC.  1003625
013000 77  RATE-HIST-OPEN              PIC X           VALUE 'F'.       1003625
013054 77  TRN-NOT-FND-COST-CTR        PIC X(30)       VALUE SPACES.    1003625
013060 77  GL-MAINT-SW                 PIC X           VALUE 'F'.       1003625
013070 77  HOLD-ZIP                    PIC X(10)       VALUE SPACES.    1003625
013080 77  MAX-EXC                     PIC X           VALUE '0'.       1003625
013084 77  WK-OD-CYC-ACR               PIC S9(13)V99   VALUE +0  COMP-3.9915845
013086 77  WRK-RSRVE-RT                PIC S9V9(8)     VALUE +0  COMP-3.9915845
013090 77  PRIME-BILL-FLAG             PIC X           VALUE '0'.       1003625
013095 77  SAVE-PAST-ACCR-FLAG         PIC X           VALUE '0'.       1003625
013096 77  HOLD-RTE-RET                PIC S9(3)       VALUE +0  COMP-3.9915845
013097 77  WK-HOLD-AMT11               PIC S9(13)V99   VALUE +0  COMP-3.9915845
013098 77  WK-HOLD-AMT13               PIC S9(13)V99   VALUE +0  COMP-3.9915845
013105 77  MASTER-GROUPING-SW          PIC X           VALUE SPACE.     1003625
013106 77  CURR-INFO-LENGTH            PIC S9999       VALUE +25 COMP.  9915845
013107 77  WK-HOLD-EC-AMT              PIC S9(13)V99   VALUE +0  COMP-3.9915845
013109 77  CURR-PAST-DUE-DAYS          PIC S9(3)       VALUE +0  COMP-3.1003625
013111 77  PREV-PAST-DUE-DAYS          PIC S9(3)       VALUE +0  COMP-3.1003625
013113 77  PAST-DUE-UPDATE-FLAG        PIC X           VALUE 'N'.       1003625
013114 77  WS-SKIP-APYE                PIC X           VALUE 'N'.       1105232
013115 77  WS-ANC-CHARGE               PIC X           VALUE '0'.       0516691
013116 77  WS-PLN-TRLR-FULL            PIC X           VALUE 'N'.       0617360
013117 77  WS-PLN-DEL-FLG              PIC X           VALUE 'N'.       0617360
013118 77  WS-RATE-DELETED             PIC X           VALUE 'N'.       1003625
013119 77  WS-RATE-REGION-KEY-CHANGE   PIC X           VALUE 'N'.       1003625
013120 77  HOLD-RATE-REGION            PIC X(10).                       1003625
013121 77  HOLD-SVC-CHRG-REGION        PIC X(10).                       1003625
013122 77  WS-RATE-NOT-FOUND           PIC X           VALUE 'N'.       1003625
013123 77  WS-RATE-KEY-LEVEL           PIC X.                           1003625
013124 77  WORK-SUB                    PIC S9999 COMP-3.                2016664
013125 77  BANK-SUB                    PIC 99.                          1003625
013126 77  HOLD-PRIME-RATE             PIC S9V9(8) COMP-3     VALUE +0. 9915845
013127 77  DAF-DAYS                    PIC S999.                        1003625
013128 77  RNX-WS-YR                   PIC XX.                          1003625
013129 77  WS-IOD-TIS-HOLD-CYC-BEG-ACCR PIC S9(13)V99 COMP-3  VALUE +0. 9915845
013130 77  WS-INT-TIS-HOLD-CYC-BEG-ACCR PIC S9(13)V99 COMP-3  VALUE +0. 9915845
013132 77  BRT-CNT                     PIC S999       COMP-3  VALUE +0. 2016374
013134 77  BRT-MAX                     PIC S999       COMP-3 VALUE +100.2016374
013136 77  BRT-EOF-FLAG                PIC X          VALUE 'N'.        2016374
013140 77  WS-ACCRUAL-BAL              PIC S9(13)V99  COMP-3  VALUE +0. 9915845
013145 77  WS-FACTOR                   PIC S9(3)      COMP-3  VALUE +0. 9915845
013150 77  WS-ZERO-CYC-BEG-ACCR        PIC X           VALUE 'N'.       9915845
013155 77  TX-ERR-MSG                  PIC X(48)       VALUE SPACES.    9915849
013156 77  WS-MAINT-ON-0660-TDY        PIC X           VALUE 'N'.       2016628
013157 77  WS-MAINT-ON-0689-TDY        PIC X           VALUE 'N'.       ~~~0179
013158 77  WS-PREV-INT-AGG-ADJ         PIC S9(13)V99  COMP-3 VALUE +0.  ~~~0179
013159 77  WS-MST-OLD-DATA             PIC X(40)       VALUE SPACES.    ~~~0179
013160 77  HOLD-EDITED-ACCT            PIC X(12)       VALUE SPACES.    ~~~0179
013161****                                                              9915845
013162 01  WS-CUSTNO-14.                                                IMUP021
013164     03  FILLER                  PIC XX.                          IMUP021
013166     03  WS-CUST-NO-12           PIC X(12).                       IMUP021
013170 01  DUMMY-RECORD                PIC X.                           9915845
013172 01  WK-CTL-1                    PIC S99 VALUE ZERO.              0326995
013180     EJECT                                                        9915845
013190     COPY SIWSMESS.                                               9915845
013200     COPY SIWSSBLD.                                               9915845
013210     EJECT                                                        9915845
013220     COPY SIWSSIOB.                                               9915845
013230     EJECT                                                        9915845
013240     COPY SIWSSLKP.                                               9915845
013250     EJECT                                                        9915845
013255     COPY SIWSHIBD.                                               9916073
013257     EJECT                                                        9916073
013258     COPY SIWSINTL.                                               2016639
013259     EJECT                                                        2016639
013260     COPY IMMANTTB.                                               9915845
013270     COPY IMWSMLNG.                                               9915845
013280     COPY IMWSTBAL.                                               9915845
013290     COPY IMWSXR.                                                 9915845
013292     COPY IMWSBONI.                                               2016374
013294     COPY IMWSBRTM.                                               2016374
013296     COPY IMWSUIC.                                                0617360
013297     COPY SIWSSTML.                                               0266741
013298     COPY IMMLLT01.                                               0266741
013299     COPY IMML31.                                                 0266741
013300     COPY IMML31XR.                                               0266741
013301     COPY IMWSREGE.                                               1020116
013302     EJECT                                                        1020116
013308*                                                                 1020116
013310 01  SV-SEGMENT-NO                   PIC XX          VALUE SPACES.9915845
013320 01  SAVE-LOAN-TRAILER-INFO.                                      9915845
013330     03  SAVE-LOAN-STMT-CLEAR        PIC X           VALUE SPACE. 9915845
013340     03  SAVE-LOAN-STATEMENT-INFO.                                9915845
013350         05  FILLER                  PIC X(72)       VALUE SPACES.9915845
013360         05  SAVE-LN-BILL-CY-DAYS    PIC S999 COMP-3 VALUE ZEROES.9915845
013370     03  SAVE-DATE-LAST-RATE-CHANGE  PIC X(6)        VALUE SPACES.9915845
013380     03  SAVE-PRIME-RATE        PIC S9V9(8)   COMP-3 VALUE ZEROES.9915845
013390     03  SAVE-ANNUAL-RATE       PIC S9V9(8)   COMP-3 VALUE ZEROES.9915845
013400     03  SAVE-DAILY-RATE        PIC SVP9(15)  COMP-3 VALUE ZEROES.9915845
013410     03  SAVE-PAYOFF-AMT        PIC S9(13)V99 COMP-3 VALUE ZEROES.9915845
013420     03  SAVE-BEGIN-INT         PIC S9(13)V99 COMP-3 VALUE ZEROES.9915845
013430     03  SAVE-DATE-LAST-BILLING      PIC X(6)        VALUE SPACES.9915845
013440     03  CYCL-LN-BILL-CY-DAYS        PIC S999 COMP-3 VALUE ZEROES.9915845
013450     03  CYCL-DATE-LAST-BILLING      PIC X(6)        VALUE SPACES.9915845
013452     03  SV-LN-AGGR-DAYS             PIC S999 COMP-3 VALUE ZEROES.2016432
013460     SKIP2                                                        9915845
013470 01  SI-MESSAGE-AREA.                                             9915845
013480     05  SIMESS-MESS1.                                            9915845
013490         10  SIMESS-OPTIONAL-MESS1    PIC X(22)  VALUE  SPACES.   9915845
013500         10  FILLER                   PIC X(34)  VALUE            9915845
013510         ' ACCOUNT MASTER RECORD ON FILE -- '.                    9915845
013520         10  FILLER                   PIC X(44)  VALUE            9915845
013530         'NO MEMO RECORD FOUND                        '.          9915845
013600     05  SIMESS-MESS2.
013650         10  SIMESS-OPTIONAL-MESS2    PIC X(50)  VALUE
013700         ' ENVIRONMENT RECORD NOT FOUND ON TABLE FILE       '.
013750         10  FILLER                   PIC X(50)  VALUE SPACES.
013800     05  SIMESS-MESS3.
013850         10  SIMESS-OPTIONAL-MESS3    PIC X(50)  VALUE  SPACES.
013900         10  FILLER                   PIC X(50)  VALUE
013950         ' ENVIRONMENT RECORD -- INVALID SEQ/ON-LINE OPTIONS'.
014000     05  SIMESS-MESS4.
014050         10  SIMESS-OPTIONAL-MESS4    PIC X(22)  VALUE  SPACES.
014100         10  FILLER                   PIC X(52)  VALUE            0902213
014110         ' NEW ON-LINE FIAS MASTER W/O NEW ACCOUNT TRANSACTION'.  0902213
014120         10  FILLER                   PIC X(26)  VALUE SPACES.    0902213
014130     05  SIMESS-MESS5.                                            0902213
014140         10  SIMESS-OPTIONAL-MESS5    PIC X(23) VALUE SPACES.     0902213
014150         10  FILLER                   PIC X(35) VALUE             0902213
014160         'BALANCE HISTORY RECORD W/O MASTER  '.                   0902213
014170         10  FILLER                   PIC X(42) VALUE SPACES.     0902213
014180     05  SIMESS-MESS6.                                            0902213
014190         10  SIMESS-OPTIONAL-MESS6    PIC X(23)  VALUE SPACES.    0902213
014200         10  FILLER                   PIC X(33)  VALUE            0902213
014210         'BALANCE HISTORY TYPE IS INVALID  '.                     0902213
014220         10  FILLER                   PIC X(44)  VALUE SPACES.    0902213
014230     05  SIMESS-MESS7.                                            0902213
014240         10  SIMESS-OPTIONAL-MESS7    PIC X(22)  VALUE SPACES.    0902213
014250         10  SIMESS-OPTIONAL-MESS7-T  PIC X      VALUE SPACES.    0902213
014255         10  SIMESS-OPTIONAL-MESS7-S  PIC X      VALUE SPACES.    0902509
014260         10  FILLER                   PIC X(41)  VALUE            0902213
014270         'REQUIRED BALANCE HISTORY RECORD MISSING  '.             0902213
014280         10  FILLER                   PIC X(35)  VALUE SPACES.    0902509
014281     05  SIMESS-MESS8.                                            0902509
014282         10  SIMESS-OPTIONAL-MESS8    PIC X(8)   VALUE SPACES.    0902509
014283         10  FILLER                   PIC X(44)  VALUE            0902509
014284         ' BALANCE HISTORY HEADER MISSING FOR THIS BCR'.          0902509
014285         10  FILLER                   PIC X(48)  VALUE SPACES.    0902509
014286     05  SIMESS-MESS9.                                            0902509
014287         10  FILLER                   PIC X(33)  VALUE            0902509
014288         'BALANCE HISTORY AND BANK CONTROL '.                     0902509
014289         10  FILLER                   PIC X(26)  VALUE            0902509
014290         'SEQUENCE NUMBERS DISAGREE '.                            0902509
014291         10  FILLER                   PIC X(15)  VALUE            0902509
014292         'BAL HIST SEQ = '.                                       0902509
014293         10  SIMESS-MESS9-BH-SEQ      PIC -9(05).                 0902509
014294         10  FILLER                   PIC X(13)  VALUE            0902509
014295         'BK CTL SEQ = '.                                         0902509
014296         10  SIMESS-MESS9-BC-SEQ      PIC -9(05).                 0902509
014297         10  FILLER                   PIC X      VALUE SPACES.    0902509
014298     05  SIMESS-MESS10.                                           1003624
014299         10  SIMESS-OPTIONAL-MESS10   PIC X(22)  VALUE  SPACES.   1003624
014300         10  FILLER                   PIC X(12)  VALUE            1003624
014301         'RETURN CODE '.                                          1003624
014302         10  SIMESS-M10-CODE          PIC X(4).                   1003624
014303         10  FILLER                   PIC X(62)  VALUE            1003624
014304         'SSR TABLE BUILD ERROR'.                                 1003624
014305     05  SIMESS-MESS11.                                           1003624
014306         10  SIMESS-OPTIONAL-MESS11   PIC X(22)  VALUE  SPACES.   1003624
014307         10  FILLER                   PIC X(12)  VALUE            1003624
014308         'RETURN CODE '.                                          1003624
014309         10  SIMESS-M11-CODE          PIC X(4).                   1003624
014310         10  FILLER                   PIC X(62)  VALUE            1003624
014311         'SSR TABLE LOOKUP ERROR'.                                1003624
014320     05  SIMESS-MESS12.                                           1105504
014322         10  SIMESS-OPTIONAL-MESS12  PIC X(50)  VALUE             1105504
014324         'PRODUCT TYPE FILE EMPTY '.                              1105504
014326         10  FILLER                  PIC X(50)  VALUE SPACES.     1105504
014328     05  SIMESS-MESS13.                                           9915855
014330         10  SIMESS-OPTIONAL-MESS13   PIC X(23) VALUE SPACES.     9915855
014332         10  FILLER                   PIC X(35) VALUE             9915855
014334         'OD LIMIT FILE RECORD W/O MASTER    '.                   9915855
014336         10  FILLER                   PIC X(42) VALUE SPACES.     9915855
014338     05  SIMESS-MESS14.                                           9915855
014340         10  FILLER                   PIC X(31)  VALUE            9915855
014342         'OD LIMIT FILE AND BANK CONTROL '.                       9915855
014344         10  FILLER                   PIC X(26)  VALUE            9915855
014346         'SEQUENCE NUMBERS DISAGREE '.                            9915855
014348         10  FILLER                   PIC X(15)  VALUE            9915855
014350         'OD LIMIT SEQ = '.                                       9915855
014352         10  SIMESS-MESS14-BH-SEQ     PIC -9(05).                 9915855
014354         10  FILLER                   PIC X(13)  VALUE            9915855
014356         'BK CTL SEQ = '.                                         9915855
014358         10  SIMESS-MESS14-BC-SEQ     PIC -9(05).                 9915855
014360         10  FILLER                   PIC XXX    VALUE SPACES.    9915855
014362     05  SIMESS-MESS15.                                           0927817
014364         10  SIMESS-OPTIONAL-MESS15   PIC X(23) VALUE SPACES.     0927817
014366         10  FILLER                   PIC X(35) VALUE             0927817
014368         'EXTENDED FLOAT RECORD W/O MASTER   '.                   0927817
014370         10  FILLER                   PIC X(42) VALUE SPACES.     0927817
014372     05  SIMESS-MESS16.                                           0927817
014374         10  FILLER                   PIC X(32)  VALUE            0927817
014376         'EXTENDED FLOAT AND BANK CONTROL '.                      0927817
014378         10  FILLER                   PIC X(26)  VALUE            0927817
014380         'SEQUENCE NUMBERS DISAGREE '.                            0927817
014382         10  FILLER                   PIC X(16)  VALUE            0927817
014384         'EXT FLOAT SEQ = '.                                      0927817
014386         10  SIMESS-MESS16-FF-SEQ     PIC -9(05).                 0927817
014388         10  FILLER                   PIC X(13)  VALUE            0927817
014390         'BK CTL SEQ = '.                                         0927817
014392         10  SIMESS-MESS16-BC-SEQ     PIC -9(05).                 0927817
014394         10  FILLER                   PIC X      VALUE SPACES.    0927817
014396     05  SIMESS-MESS17.                                           0927817
014398         10  SIMESS-OPTIONAL-MESS17   PIC X(22)  VALUE SPACES.    0927817
014400         10  FILLER                   PIC X(43)  VALUE            0927817
014402         'REQUIRED EXTENDED FLOAT RECORD MISSING   '.             0927817
014404         10  FILLER                   PIC X(35)  VALUE SPACES.    0927817
014406     05  SIMESS-MESS18.                                           0927817
014408         10  SIMESS-OPTIONAL-MESS18   PIC X(8)   VALUE SPACES.    0927817
014410         10  FILLER                   PIC X(44)  VALUE            0927817
014412         ' EXTENDED FLOAT HEADER MISSING FOR THIS BCR '.          0927817
014414         10  FILLER                   PIC X(48)  VALUE SPACES.    0927817
014416 01  FILLER                       REDEFINES  SI-MESSAGE-AREA.     0927817
014418     05  SIMESS-MESSAGE           OCCURS  18                      0927817
014420                                  INDEXED BY SIMESS-OPTIONAL-INDX.0927817
014422         10  FILLER               PIC X(100).                     0927817
014430                                                                  0417181
014432 01  TFR-VALID-VALUES.                                            0417181
014434     05  SYS-TYPE-TEST               PIC X(3).                    0417181
014436         88   SYS-TYPE-TFR    VALUE '010' THRU '019'              0417181
014438                                    '030' THRU '049'              0417181
014440                                    '070' THRU '099'              1010048
014442                                    '020' THRU '029'              0417181
014444                                    '050' THRU '069'.             0417181
014446     05  REG-CODE-TEST               PIC X(3).                    0417181
014448         88   REG-CODE-TFR    VALUE '303'  '330'.                 0417181
014450                                                                  0417181
014452 01  WORK-TFR-AREA.                                               1004773
014454     03  WK-RCK06A0-AMT         PIC S9(15)V99  COMP-3 VALUE ZEROS.9915845
014456     03  WK-RCK06A0-AVG         PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014458     03  WK-RCK06A0-NO          PIC S9(9)      COMP-3 VALUE ZEROS.9915845
014460     03  WK-RCK06D0-AMT         PIC S9(15)V99  COMP-3 VALUE ZEROS.9915845
014462     03  WK-RCK06D0-AVG         PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014464     03  WK-RCK06D0-NO          PIC S9(9)      COMP-3 VALUE ZEROS.9915845
014466     03  WK-RCK06E0-AMT         PIC S9(15)V99  COMP-3 VALUE ZEROS.9915845
014468     03  WK-RCK06E0-AVG         PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014470     03  WK-RCK06E0-NO          PIC S9(9)      COMP-3 VALUE ZEROS.9915845
014472     03  WK-RCK1000-AMT         PIC S9(15)V99  COMP-3 VALUE ZEROS.9915845
014474     03  WK-RCK1000-AVG         PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014476     03  WK-RCK1000-NO          PIC S9(9)      COMP-3 VALUE ZEROS.9915845
014478     03  WK-RCK11A0-AMT         PIC S9(15)V99  COMP-3 VALUE ZEROS.9915845
014480     03  WK-RCK11A0-AVG         PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014482     03  WK-RCK11A0-NO          PIC S9(9)      COMP-3 VALUE ZEROS.9915845
014484     03  WK-TFR-PRIN-BAL        PIC S9(13)V99  COMP-3 VALUE ZEROS.1004773
014485                                                                  1003625
014489 01  WRK-RATE-KEY.                                                9915845
014490     05  WRK-CTL1                    PIC XX.                      9915845
014491     05  WRK-CURRENCY                PIC XXX.                     9915845
014492     05  WRK-REGION                  PIC X(10).                   1003625
014493     05  WRK-PRODUCT                 PIC XXX.                     1003625
014494     05  WRK-TYPE                    PIC X.                       1003625
014495     05  WRK-PTR                     PIC 999.                     1003625
014500     SKIP3
014501 01  LOAN-RATE-INIT-AREA.                                         1003625
014502     03  SPLIT-RATE-AREA         COMP-3.                          1003625
014503         05  FILLER              PIC S9V9(8)         VALUE +.0.   9915845
014504         05  FILLER              PIC SVP9(15)        VALUE +.0.   9915845
014505         05  FILLER              PIC S9V9(8)         VALUE +.0.   9915845
014506         05  FILLER              PIC SVP9(15)        VALUE +.0.   9915845
014507         05  FILLER              PIC S9V9(8)         VALUE +.0.   9915845
014508         05  FILLER              PIC SVP9(15)        VALUE +.0.   9915845
014509         05  FILLER              PIC S9(13)V99       VALUE +0.    9915845
014510         05  FILLER              PIC S9(13)V99       VALUE +0.    9915845
014520 01  WS-LEAP-YR-SW               PIC X               VALUE 'N'.   1003625
014522     88  INTO-OR-OUTOF-LEAP-YR                       VALUE 'Y'.   1003625
014523 01  EXISTING-ACCT-SW            PIC X               VALUE 'N'.   1003625
014524     88  EXISTING-ACCT                               VALUE 'Y'.   1003625
014525*                                                                 1003625
014526 01  WORK-TFRCSI-AREA.                                            2015719
014528     03  WK-CSI-TOT-ASSET-AMT   PIC S9(15)V99  COMP-3 VALUE ZEROS.2015719
014530     03  WK-CSI-INT-ASSET-AMT   PIC S9(15)V99  COMP-3 VALUE ZEROS.2015719
014532     03  WK-CSI-INT-LIAB-AMT    PIC S9(15)V99  COMP-3 VALUE ZEROS.2015719
014533*                                                                 0316967
014534 01  WMX-TIER-RATES.                                              0316967
014535     05  WMX-TIER-RATE-KEY-LEVEL   PIC X.                         0316967
014536     05  WMX-TIER-CUR-DATA.                                       0316967
014537         10  WMX-TIER-CUR-DATE     PIC X(8).                      0316967
014538         10  WMX-TIER-CUR-RATES    OCCURS 9 TIMES COMP-3.         0316967
014539             15  WMX-TIER-CUR-ANN  PIC S9V9(8).                   0316967
014540             15  WMX-TIER-CUR-DAF  PIC SVP9(15).                  0316967
014541         10  WMX-TIER-CUR-LMT      PIC S9(13)V99  COMP-3          0316967
014542                                       OCCURS 8 TIMES.            0316967
014543     05  WMX-TIER-PREV-DATA.                                      0316967
014544         10  WMX-TIER-PREV-DATE    PIC X(8).                      0316967
014545         10  WMX-TIER-PREV-RATES   OCCURS 9 TIMES COMP-3.         0316967
014546             15  WMX-TIER-PREV-ANN PIC S9V9(8).                   0316967
014547             15  WMX-TIER-PREV-DAF PIC SVP9(15).                  0316967
014548         10  WMX-TIER-PREV-LMT     PIC S9(13)V99  COMP-3          0316967
014549                                       OCCURS 8 TIMES.            0316967
014550     COPY SIWSCNTL.
014600     EJECT
014650     COPY IMWSENVO.                                               IM003
028500     EJECT                                                        9915845
028600     COPY IMWSTRAN.                                               9915845
028700*                                                                 9915845
028800 66  TR-TRAN80-A RENAMES TR-REJ-PROG THRU TR-TRACE.               IM006
028850 66  TR-TRAN80-B RENAMES TR-80-TYPE THRU TR-80-RMDR.
028900 66  TR-TRAN50 RENAMES TR-SOURCE THRU TR-AMOUNT.
029000*                                                                 0427139
029050 01  PSBK-REC-07.                                                 0427139
029100     05  PSBK-COMB-FILE          PIC X         VALUE '0'.         0427139
029150     05  FILLER                  PIC X(32)     VALUE SPACES.      0427139
029200     05  PSBK-ADDR-PTR           PIC S999      COMP-3 VALUE +0.   0427139
029250     05  FILLER                  PIC X(5)      VALUE SPACES.      0427139
029300     05  FILLER                  OCCURS 6 TIMES                   0427139
029350                                 PIC S999      COMP-3 VALUE +0.   0427139
029400     05  FILLER                  PIC X(6)      VALUE SPACES.      0427139
029450     05  FILLER                  PIC S999      COMP-3 VALUE +0.   0427139
029500     05  FILLER                  PIC X(4)      VALUE SPACES.      0427139
029550     05  PSBK-RESET              PIC X         VALUE '0'.         0427139
029560     05  PSBK-FORMAT             PIC S9        COMP-3 VALUE +1.   0427139
029570     05  PSBK-SERIAL             PIC X         VALUE SPACES.      0427139
029580     05  FILLER                  PIC S999      COMP-3 VALUE +0.   0427139
029590     05  PSBK-STMT-PAGES         PIC S999      COMP-3 VALUE +0.   0427139
029600     05  PSBK-BEG-BAL            PIC S9(13)V99 COMP-3 VALUE +0.   0427139
029610     05  FILLER                  PIC S9(13)V99 COMP-3 VALUE +0.   0427139
029620     05  PSBK-STMT-LINES         PIC S999      COMP-3 VALUE +0.   0427139
029630     05  PSBK-STMT-PG-LINES      PIC S999      COMP-3 VALUE +0.   0427139
029640     05  PSBK-STMT-DATE          PIC X(6)      VALUE SPACES.      0427139
029650     05  FILLER                  OCCURS 5 TIMES                   0427139
029660                                 PIC S9(13)V99 COMP-3 VALUE +0.   0427139
029700*                                                                 0427139
029804******************************************************************IM006
029808***  THE FOLLOWING WORK AREA IS USED TO FORECAST THE LOAN      ***IM006
029812***  PAYMENT DUE DATE.  THE VALUES FOR SKIP-LOAN-ACCR-SW ARE:  ***IM006
029816***       0 = NOT USED.                                        ***IM006
029820***       1 = ACCOUNT HAS AN AUTO PAYMENT AND THE NEXT CAL-    ***IM006
029824***           CULATED PAYMENT DUE DATE IS TODAY.  THE LOAN     ***IM006
029828***           ACCRUAL WILL BE SKIPPED ON THE PAYMENT CALC DAY  ***IM006
029832***           UNTIL THE AUTO PAYMENT IS POSTED.                ***IM006
029836***       2 = THE LOAN ACCRUAL HAS BEEN SKIPPED AND WILL BE    ***IM006
029840***           ACCRUED AFTER THE THE AUTO PAYMENT IS POSTED.    ***IM006
029844******************************************************************IM006
029850 01  WORK-LOAN-ACCR-AREA.                                         IM006
029860     03  WORK-LOAN-PYMT-DATE     PIC X(6).                        IM006
029870     03  SKIP-LOAN-ACCR-SW       PIC X.                           IM006
029880     03  ACCR-DAYS-SKIPPED       PIC S999    COMP-3.              IM006
029882     03  ACCRUAL-DATE-WK.                                         1003625
029884         05  ADW-CC              PIC XX.                          1003625
029885         05  ADW-YY              PIC XX.                          1003625
029886         05  ADW-MM              PIC XX.                          1003625
029887         05  ADW-DD              PIC XX.                          1003625
029890     03  ACCR-DATE-MMDDYY.                                        1003625
029892         05  ACCR-DATE-MM        PIC XX.                          1003625
029894         05  ACCR-DATE-DD        PIC XX.                          1003625
029896         05  ACCR-DATE-YY        PIC XX.                          1003625
029900     SKIP3
029950     COPY SIWSSTHD.
030000     SKIP3
030050     COPY SIWSSPAR.
030060     SKIP3                                                        9915845
030065     COPY SIWSSPEX.                                               9915845
030070     SKIP3                                                        9915845
030110 01  CONTROL-CODE                PIC X.                           0902575
030120     SKIP2                                                        0902575
030150 01  TRIAL-CONTROL.
030200     03  TRIAL-CODE                  PIC X.
030250     03  TRIAL-SPOOL                 PIC X.
030300     03  TRIAL-FORM                  PIC X   VALUE HIGH-VALUE.
030350     03  TRIAL-PREV                  PIC X.
030400     03  DATE-LAST-ACTIVE            PIC X(6).
030450     03  TRIAL-TRANS                 PIC X   VALUE '0'.
030500     03  EX-MST-CTL                  PIC X   VALUE '0'.           9915845
030550 01  SAVE-DATE-8.
030600     03  SV-DT8-CENT             PIC XX.
030650     03  SV-DT8-YR               PIC XX.
030700     03  SV-DT8-MO               PIC XX.
030750     03  SV-DT8-DA               PIC XX.
030752 01  SAVE-OPEN-8.                                                 0266928
030754     03  SV-OP8-CENT             PIC XX.                          0266928
030756     03  SV-OP8-YR               PIC XX.                          0266928
030758     03  SV-OP8-MO               PIC XX.                          0266928
030760     03  SV-OP8-DA               PIC XX.                          0266928
030762 01  SAVE-OPEN-6.                                                 0266928
030764     03  SV-OP6-MO               PIC XX.                          0266928
030766     03  SV-OP6-DA               PIC XX.                          0266928
030768     03  SV-OP6-YR               PIC XX.                          0266928
030800 01  SAVE-DATE.
030850     05  DATE-LST-RATE-MO        PIC XX.
030900     05  DATE-LST-RATE-DA        PIC XX.
030950     05  DATE-LST-RATE-YR        PIC XX.
031000 01  HOLD-BKDT-INFO.
031050     03  HOLD-BKDT-DATE.
031100         05  HOLD-BKDT-MO        PIC XX.
031150         05  HOLD-BKDT-DA        PIC XX.
031200         05  HOLD-BKDT-YR        PIC XX.
031250     03  HOLD-BKDT-DAYS          PIC S999        COMP-3.
031300     03  HOLD-BKDT-HOL           PIC S9          COMP-3.
031308     03  HOLD-BH-DATE.                                            0902213
031316         05  HOLD-BH-CC          PIC XX        VALUE SPACES.      9915845
031324         05  HOLD-BH-YR          PIC XX        VALUE SPACES.      9915845
031332         05  HOLD-BH-MO          PIC XX        VALUE SPACES.      9915845
031340         05  HOLD-BH-DA          PIC XX        VALUE SPACES.      9915845
031350 01  HOLD-REJ.
031352     03  HOLD-REJ1       PIC X   VALUE '8'.                       0917829
031400     03  HOLD-REJ2       PIC X   VALUE '0'.                       0917829
031450     03  HOLD-REJ3       PIC X.                                   0917829
031453 01  WORK-DATES.                                                  IM005
031456     03  WORK-DATE1.                                              IM005
031457         05  WORK-DATE1-CC       PIC XX.                          1004775
031459         05  WORK-DATE1-YR       PIC XX.                          IM005
031462         05  WORK-DATE1-MO       PIC XX.                          IM005
031465         05  WORK-DATE1-DA       PIC XX.                          IM005
031468     03  WORK-DATE2.                                              IM005
031470         05  WORK-DATE2-CC       PIC XX.                          1004775
031471         05  WORK-DATE2-YR       PIC XX.                          IM005
031474         05  WORK-DATE2-MO       PIC XX.                          IM005
031477         05  WORK-DATE2-DA       PIC XX.                          IM005
031480     03  WORK-DATE3.                                              IM005
031482         05  WORK-DATE3-CC       PIC XX.                          1004775
031483         05  WORK-DATE3-YR       PIC XX.                          IM005
031485         05  WORK-DATE3-MO       PIC XX.                          IM006
031487         05  WORK-DATE3-DA       PIC XX.                          IM006
031489     03  WORK-XFER-DATE-1.                                        IM006
031491         05  WORK-XFER-CENT-1    PIC XX.                          IM006
031493         05  WORK-XFER-YR-1      PIC XX.                          IM006
031495         05  WORK-XFER-MO-1      PIC XX.                          IM006
031497         05  WORK-XFER-DA-1      PIC XX.                          IM006
031499     03  WORK-XFER-DATE-2.                                        IM006
031501         05  WORK-XFER-CENT-2    PIC XX.                          IM006
031503         05  WORK-XFER-YR-2      PIC XX.                          IM006
031505         05  WORK-XFER-MO-2      PIC XX.                          IM006
031507         05  WORK-XFER-DA-2      PIC XX.                          IM006
031509     03  WORK-XFER-DATE-3.                                        IM006
031511         05  WORK-XFER-CENT-3    PIC XX.                          IM006
031513         05  WORK-XFER-YR-3      PIC XX.                          IM006
031515         05  WORK-XFER-MO-3      PIC XX.                          IM006
031517         05  WORK-XFER-DA-3      PIC XX.                          IM006
031519 01  HOLD-65-WORK.                                                IM006
031521     03  HOLD-780-MONTHS         PIC S999    COMP-3  VALUE +780.  IM006
031523     03  HOLD-65-YEARS.                                           IM006
031525         05  HOLD-65-CENT        PIC XX.                          IM006
031527         05  HOLD-65-YR          PIC XX.                          IM006
031529         05  HOLD-65-MO          PIC XX.                          IM006
031531         05  HOLD-65-DA          PIC XX.                          IM006
031533 01  SAVE-WITHHOLD-TAXES         COMP-3.                          IM006
031550     03  SAVE-IOD-TAX            PIC S9(13)V99.                   9915845
031560     03  SAVE-IOD-TAX-ST         PIC S9(13)V99.                   2012254
031570     03  SAVE-IOD-TAX-LOC        PIC S9(13)V99.                   2012254
031600     03  SAVE-SAV-TAX            PIC S9(13)V99.                   9915845
031602     03  SAVE-SAV-TAX-ST         PIC S9(13)V99.                   2012254
031604     03  SAVE-SAV-TAX-LOC        PIC S9(13)V99.                   2012254
031605                                                                  9915845
031610 01  WORK-OD-TRLR-AREA.                                           9915845
031612     03  WKOD-SUB1               PIC S9999           COMP SYNC.   9915845
031614     03  WKOD-SUB2               PIC S9999           COMP SYNC.   9915845
031616     03  WKOD-LIMIT1-FLAG        PIC X               VALUE '0'.   9915845
031618     03  WKOD-LIMIT2-FLAG        PIC X               VALUE '0'.   9915845
031620     03  WKOD-LIMIT3-FLAG        PIC X               VALUE '0'.   9915845
031622     03  WKOD-LIMIT4-FLAG        PIC X               VALUE '0'.   9915845
031624     03  WKOD-LIMIT5-FLAG        PIC X               VALUE '0'.   9915845
031626     03  WKOD-LIMIT6-FLAG        PIC X               VALUE '0'.   9915845
031628     03  WKOD-LIMIT7-FLAG        PIC X               VALUE '0'.   9915845
031630     03  WKOD-LIMIT8-FLAG        PIC X               VALUE '0'.   9915845
031632     03  WKOD-LIMIT-PTR1-FLAG    PIC X               VALUE '0'.   9915845
031634     03  WKOD-LIMIT-PTR2-FLAG    PIC X               VALUE '0'.   9915845
031636     03  WKOD-LIMIT-PTR3-FLAG    PIC X               VALUE '0'.   9915845
031638     03  WKOD-LIMIT-PTR4-FLAG    PIC X               VALUE '0'.   9915845
031640     03  WKOD-LIMIT-PTR5-FLAG    PIC X               VALUE '0'.   9915845
031642     03  WKOD-LIMIT-PTR6-FLAG    PIC X               VALUE '0'.   9915845
031644     03  WKOD-LIMIT-PTR7-FLAG    PIC X               VALUE '0'.   9915845
031646     03  WKOD-LIMIT-PTR8-FLAG    PIC X               VALUE '0'.   9915845
031648     03  WKOD-LIMIT-AREA         OCCURS 8 TIMES.                  9915845
031650         05  WKOD-LIMIT          PIC S9(13)V99       COMP-3.      9915845
031652         05  WKOD-LIMIT-CMPR     PIC S9(13)V99       COMP-3.      9915845
031656         05  WKOD-LIMIT-PTR      PIC X.                           9915845
031660     03  WKOD-FM-LIMIT-REC               OCCURS 8 TIMES.          9915845
031662         05  WKOD-FM-LMT-REC-A.                                   9915845
031664             07  FILLER                  PIC X(22).               9915845
031666             07  WKOD-FM-LMT-RA-CLASS    PIC XX.                  9915845
031668             07  FILLER                  PIC X(10).               9915845
031670         05  WKOD-FM-LMT-REC-A-BAT-SEQ.                           9915845
031672             07  WKOD-FM-LMT-RA-PROG     PIC XX.                  9915845
031674             07  WKOD-FM-LMT-RA-REJRSN   PIC XXX.                 0717565
031676             07  WKOD-FM-LMT-RA-SOURCE   PIC XX.                  9915845
031678             07  WKOD-FM-LMT-RA-BAT      PIC S9(5)  COMP-3.       9915845
031680             07  WKOD-FM-LMT-RA-SEQ      PIC S9(5)  COMP-3.       9915845
031682             07  WKOD-FM-LMT-RA-TRACE    PIC S9(7)  COMP-3.       9915845
031684             07  WKOD-FM-LMT-RA-SCR-INFO PIC X(35).               9915845
031686         05  WKOD-FM-LMT-REC-B           PIC X(105).              9915845
031688     03  WKOD-FM-POINTER-REC               OCCURS 8 TIMES.        9915845
031690         05  WKOD-FM-PTR-REC-A.                                   9915845
031692             07  FILLER                  PIC X(22).               9915845
031694             07  WKOD-FM-PTR-RA-CLASS    PIC XX.                  9915845
031696             07  FILLER                  PIC X(10).               9915845
031698         05  WKOD-FM-PTR-REC-A-BAT-SEQ.                           9915845
031700             07  WKOD-FM-PTR-RA-PROG     PIC XX.                  9915845
031702             07  WKOD-FM-PTR-RA-REJRSN   PIC XXX.                 0717565
031704             07  WKOD-FM-PTR-RA-SOURCE   PIC XX.                  9915845
031706             07  WKOD-FM-PTR-RA-BAT      PIC S9(5)  COMP-3.       9915845
031708             07  WKOD-FM-PTR-RA-SEQ      PIC S9(5)  COMP-3.       9915845
031710             07  WKOD-FM-PTR-RA-TRACE    PIC S9(7)  COMP-3.       9915845
031712             07  WKOD-FM-PTR-RA-SCR-INFO PIC X(35).               9915845
031714         05  WKOD-FM-PTR-REC-B           PIC X(105).              9915845
031716     SKIP3                                                        9915845
031720 01  WK-TAX-RATES.                                                2016735
031721     05  WK-TAX-RT             PIC S9V9(8) COMP-3  VALUE ZEROS.   2016735
031722     05  WK-TAX-RT-ST          PIC S9V9(8) COMP-3  VALUE ZEROS.   2016735
031723     05  WK-TAX-RT-LOC         PIC S9V9(8) COMP-3  VALUE ZEROS.   2016735
031724     05  WK-TAX-RTS            PIC S9V9(8) COMP-3  VALUE ZEROS.   2016735
031745 01  BYTE-1-2.                                                    9915845
031750     03  BYTE-1                  PIC X.
031800     03  BYTE-2                  PIC X.
031850     SKIP2
031852 01  SV-MASTER-GROUP-NO              PIC XX.                      1003624
031854 01  SV-MASTER-GROUPS.                                            1003624
031856     03  SV-MST-GRP-ENTRY        OCCURS 25 TIMES.                 1003624
031858         05  SV-MST-GRP-NO       PIC X(2).                        1003624
031860 01  HOLD-MST-CONTROLS.                                           1003624
031862     03  HOLD-MST-CTL1     PIC XX      VALUE SPACES.              1003624
031864     03  HOLD-MST-CTL2     PIC XXX     VALUE SPACES.              1003624
031866     03  HOLD-MST-CTL3     PIC XXX     VALUE SPACES.              1003624
031868     03  HOLD-MST-CTL4     PIC XXXX    VALUE SPACES.              1003624
031870     SKIP1                                                        1003624
031872 01  WK-CONTROL-KEY.                                              1003624
031874     03  WK-CNTLS.                                                1003624
031876         05  WK-CTL1           PIC XX      VALUE SPACES.          1003624
031878         05  WK-CTL2           PIC XXX     VALUE SPACES.          1003624
031880         05  WK-CTL3           PIC XXX     VALUE SPACES.          1003624
031882         05  WK-CTL4           PIC XXXX    VALUE SPACES.          1003624
031884     03  WK-ACCT               PIC X(10)   VALUE SPACES.          1003624
031886                                                                  1003624
031890 01  BILLING-DATE-FORMATS.                                        9915845
031892     03  FILLER                  PIC X               VALUE '1'.   9915845
031894     03  FILLER                  PIC X               VALUE '1'.   9915845
031896                                                                  9915845
031900 01  WORK-FLAGS.
031950     03  DDA-FLAGS.
032000         05  POST-TODAY              PIC X.
032050         05  UNPOST-TODAY            PIC X.
032100         05  OD-TODAY                PIC X.
032120         05  DAU-TODAY               PIC X.                       IM003
032150         05  NSF-TODAY               PIC X.
032155         05  FM-TODAY                PIC X.                       0902970
032200         05  SERIAL-STMT             PIC X.
032250         05  SH-REJ-FLAG             PIC X.
032300         05  LIST-POST-DR-FLAG       PIC X.
032350         05  LIST-POST-CR-FLAG       PIC X.
032360         05  LIST-POST-ITEM          PIC X.                       0827768
032400         05  STATUS-MAINT            PIC X.
032450         05  CALC-FLAG               PIC X.
032500         05  NSF-CALC-FLAG           PIC X.
032520         05  CUST-CALC-FLAG          PIC X.                       IM003
032550         05  LG-ITEM-FLAG            PIC X.
032570         05  KITE-ITEM-FLAG          PIC X.                       IM006
032600         05  SYS-REQ-STMT            PIC X.
032650         05  STMT-TODAY              PIC X.
032652         05  YPULL-FLAG              PIC X.                       ~~~0161
032700         05  SVCH-TODAY              PIC X.
032750         05  INT-TODAY               PIC X.
032800         05  AUTO-DEP-DUE-TODAY      PIC X.
032850         05  AUTO-DEP-REC-TODAY      PIC X.
032900         05  MTD-AGGR-FLAG           PIC X.
032950         05  SVCH-PASS               PIC X.
033000         05  IOD-ACCRUE              PIC X.
033050         05  SAV-ACCRUE              PIC X.
033100         05  MAX-PASS                PIC X.
033150         05  BYPASS-ACTIVITY-SW      PIC X.
033200         05  BANK-AVAIL-CHANGE       PIC X.                       IM007
033220         05  CUST-AVAIL-CHANGE       PIC X.                       IM007
033300         05  IOD-CALC-DALY           PIC X.
033350         05  R3652-ALREADY           PIC X.
033400         05  R3670-ALREADY           PIC X.
033402         05  K1725-ALREADY           PIC X.                       0827796
033450         05  INACT-DORM-FLAG         PIC X.
033470         05  SAV-DORMANT-FLAG        PIC X.                       IM003
033500         05  HIFI-RPT-INEL-FLAG      PIC X.
033550         05  AGGREGATE-LOOP-SW       PIC X.
033600         05  HOLD-OD-ADJ-FLAG        PIC X.
033620         05  EFT-STMT-FLAG           PIC X.                       IM004
033630         05  CALL-EFAA-FLAG          PIC X.                       IM007
033640         05  SEND-EFAA-NOTICE        PIC X.                       IM007
033642         05  NON-EFAA-ACCOUNT        PIC X.                       IM007
033645         05  SAV-BKUP-WTHLD-FLAG     PIC X.                       IM007
033647         05  BKDT-DAYS-FLAG          PIC X.                       IM007
033648         05  OD-BKDT-DAYS-FLAG       PIC X.                       0903490
033650         05  SAV-BKDT-DAYS-FLAG      PIC X.                       9715519
033655         05  CERT-NAME-W8-STATUS     PIC X.                       9915828
033658         05  NEG-ACCR-FLAG           PIC X.                       0903490
033660         05  FDIC-CAUSED-OD          PIC X.                       0930077
033668         05  ODAC-CHG-TODAY          PIC X.                       0903490
033670         05  FULL-SHEET-TODAY        PIC X.                       1004015
033672         05  DDA-CLOSING-TRAN-FLAG   PIC X.                       1003634
033674         05  FM-TO-DDA-PTR           PIC X.                       1003625
033676         05  FM-TO-OD-PTR            PIC X.                       1003625
033677         05  FM-TO-FED-TAX-PTR       PIC X.                       2012254
033678         05  FM-TO-ST-TAX-PTR        PIC X.                       2012254
033679         05  FM-TO-LOC-TAX-PTR       PIC X.                       2012254
033680     03  LOAN-FLAGS.                                              2012254
033700         05  LOAN-POST-TODAY         PIC X.
033750         05  LOAN-PMT-TODAY          PIC X.
033800         05  OVER-LINE               PIC X.
033850         05  OVRLIM-FLAG             PIC X.
033950         05  LOAN-STAT-MAINT         PIC X.
033960         05  LOAN-STAT-STOP-ACCR-TDY PIC X.                       0627535
034000         05  AUTO-LOAN-PMT           PIC X.
034050         05  LOAN-ACCR-RECALC        PIC X.
034100         05  LOAN-STMT-CALC          PIC X.
034150         05  CURR-PMT-AUTO           PIC X.
034200         05  SR-HOLD-FLAG            PIC X.
034250         05  NO-LOAN                 PIC X.
034300         05  BACKDATE-SW             PIC X.                       IM006
034350         05  HOLD-ADJ-CODE           PIC X.
034400         05  RATE-TYPE               PIC X.
034450         05  RATE-CALC               PIC X.
034500         05  PRIME-CALC-FLAG         PIC X.
034520         05  LOAN-AGGR-SW            PIC X.                       IM006
034530         05  PRIME-RATE-CHG          PIC X.                       1003343
034531         05  CALC-ONLY-FLAG          PIC X           VALUE ZERO.  1003343
034532         05  SKIP-RATE-RECORD        PIC X           VALUE ZERO.  1003343
034534         05  FM-TO-LN-PTR            PIC X.                       1003625
034536         05  FM-TO-PREV-LN-PTR       PIC X.                       1003625
034537         05  BILLING-DATE-FLAG       PIC X.                       1004643
034538         05  TX-ERR-CODE             PIC X.                       9915849
034540         05  NEW-BILL-TRLR           PIC X.                       0827790
034550     03  TRLR-DELETE-FLAGS.
034600         05  AMT-TRANSFER-DEL        PIC X.
034650         05  COMB-STMT-DEL           PIC X.
034700     03  SAVINGS-FLAGS.
034750         05  SAVINGS-OR-LOAN         PIC X.
034800         05  SAVINGS-POST-TODAY      PIC X.
034850         05  LOAN-PRESENT            PIC X.
034900         05  SAVINGS-PRESENT         PIC X.
034950         05  SAVINGS-MINIMUM         PIC X.
035000         05  SAVINGS-STATUS-IN       PIC X.
035050         05  SWEEP-TODAY             PIC X.
035052         05  SAV-CLOSING-TRAN-FLAG   PIC X.                       1003634
035053         05  FM-TO-SAV-PTR           PIC X.                       1003625
035054         05  FM-TO-SAV-TIER-PTR      PIC X.                       0316967
035055 01  RATE-WORK-FLAGS.                                             0316967
035056     05  TIER-CHG-FLG          PIC X.                             2016664
035058     05  TIER-SUB              PIC S9999  COMP-3.                 2016664
035060     05  TIER-FUT              PIC S9999  COMP-3.                 2016664
035061     05  IOD-CHG-FLG           PIC X.                             2016664
035062     05  IOD-SUB               PIC S9999  COMP-3.                 2016664
035063     05  IOD-FUT               PIC S9999  COMP-3.                 2016664
035065     05  DFLT-IOD-CHG-FLG      PIC X.                             2016664
035066     05  DFLT-IOD-SUB          PIC S9999  COMP-3.                 2016664
035067     05  DFLT-IOD-FUT          PIC S9999  COMP-3.                 2016664
035068     05  SAV-CHG-FLG           PIC X.                             2016664
035069     05  SAV-SUB               PIC S9999  COMP-3.                 0316967
035070     05  SAV-FUT               PIC S9999  COMP-3.                 0316967
035071     05  SAV-TIER-CHG-FLG      PIC X.                             0316967
035072     05  SAV-TIER-SUB          PIC S9999  COMP-3.                 0316967
035073     05  SAV-TIER-FUT          PIC S9999  COMP-3.                 0316967
035074     05  LOAN-CHG-FLG          PIC X.                             2016664
035076     05  LOAN-SUB              PIC S9999  COMP-3.                 2016664
035078     05  LOAN-FUT              PIC S9999  COMP-3.                 2016664
035080     05  OD-CHG-FLG            PIC X.                             2016664
035082     05  OD-SUB                PIC S9999  COMP-3.                 2016664
035084     05  OD-FUT                PIC S9999  COMP-3.                 2016664
035086     05  OD-TRLR-CHG-FLG       PIC X       OCCURS 9 TIMES.        2016664
035088     05  OD-TRLR-SUB           PIC S9(4) COMP-3  OCCURS 9 TIMES.  2016664
035090     05  OD-TRLR-FUT           PIC S9(4) COMP-3  OCCURS 9 TIMES.  2016664
035104     05  PRIME-CHG-FLG         PIC X.                             2016664
035106     05  PRIME-SUB             PIC S9999  COMP-3.                 2016664
035108     05  PRIME-FUT             PIC S9999  COMP-3.                 2016664
035110     05  SPLIT-CHG-FLG         PIC X.                             2016664
035112     05  SPLIT-SUB             PIC S9999  COMP-3.                 2016664
035114     05  SPLIT-FUT             PIC S9999  COMP-3.                 2016664
035116     05  PREV-LOAN-CHG-FLG     PIC X.                             2016664
035118     05  PREV-LOAN-SUB         PIC S9999  COMP-3.                 2016664
035120     05  PREV-LOAN-FUT         PIC S9999  COMP-3.                 2016664
035122     05  PREV-SPLIT-CHG-FLG    PIC X.                             2016664
035124     05  PREV-SPLIT-SUB        PIC S9999  COMP-3.                 2016664
035126     05  PREV-SPLIT-FUT        PIC S9999  COMP-3.                 2016664
035127     05  FED-TAX-CHG-FLG       PIC X.                             2016664
035128     05  FED-TAX-SUB           PIC S9999  COMP-3.                 2016664
035129     05  FED-TAX-FUT           PIC S9999  COMP-3.                 2016664
035130     05  ST-TAX-CHG-FLG        PIC X.                             2016664
035131     05  ST-TAX-SUB            PIC S9999  COMP-3.                 2016664
035132     05  ST-TAX-FUT            PIC S9999  COMP-3.                 2016664
035133     05  LOC-TAX-CHG-FLG       PIC X.                             2016664
035134     05  LOC-TAX-SUB           PIC S9999  COMP-3.                 2016664
035135     05  LOC-TAX-FUT           PIC S9999  COMP-3.                 2016664
035136*                                                                 2012254
035137 01  HOLD-WORK-RATE-KEY.                                          2012254
035138     05  HOLD-REGION                 PIC X(10).                   2012254
035139     05  HOLD-PRODUCT                PIC X(03).                   2012254
035140     05  HOLD-PTR                    PIC 9(03).                   2012254
035141*                                                                 2012254
035150 01  CONTROL-AREA.
035200     03  PREV-1-3                    PIC X(8)    VALUE LOW-VALUE.
035250     03  LOW-CONTROL.
035300         05  LOW-1-4.
035350             07  LOW-1-3.
035400                 09  LOW-1-2.
035450                     11  LOW-1.
035500                         13  LOW-EOF PIC X.
035550                         13  FILLER  PIC X.
035600                     11  LOW-2       PIC XXX.
035650                 09  LOW-3           PIC XXX.
035700             07  LOW-4               PIC XXXX.
035750         05  LOW-ACCT                PIC X(10).
035800     03  MST-CONTROL.
035850         05  MST-1-4.
035900             07  MST-1-3.
035950                 09  MST-1-2.
036000                     11  MST-1.
036050                         13  MST-EOF PIC X       VALUE SPACE.
036100                         13  FILLER  PIC X.
036150                     11  MST-2       PIC XXX.
036200                 09  MST-3           PIC XXX.
036250             07  MST-4               PIC XXXX.
036300         05  MST-ACCT                PIC X(10).
036350     03  TRN-CONTROL.
036400         05  TRN-1-4.
036450             07  TRN-1-3.
036500                 09  TRN-1-2.
036550                     11  TRN-1.
036600                         13  TRN-EOF PIC X.
036650                         13  FILLER  PIC X.
036700                     11  TRN-2       PIC XXX.
036750                 09  TRN-3           PIC XXX.
036800             07  TRN-4               PIC XXXX.
036850         05  TRN-ACCT                PIC X(10).
036900     03  HOLD-CONTROL.
036950         05  HOLD-1-4.
037000             07  HOLD-1-3.
037050                 09  HOLD-1-2.
037100                     11  HOLD-1      PIC XX      VALUE SPACES.
037150                     11  HOLD-2      PIC XXX.
037200                 09  HOLD-3          PIC XXX.
037250             07  HOLD-4              PIC XXXX.
037252                                                                  0417078
037254 01  ACCT-WK-AREA                PIC X(13).                       0417078
037256 01  FILLER  REDEFINES ACCT-WK-AREA.                              0417078
037258     03  FILLER                  PIC X.                           0417078
037260     03  WK-ED-ACCT              PIC X(12).                       0417078
037262                                                                  0417078
037300     SKIP3
037350***** PARAMETERS FOR IM31 USER PHASE  ****************************
037400 01  IM31-USER-PHASE-AREA.
037450     03  FILLER                      PIC XXXX    VALUE 'IM31'.
037500     03  IM31-USER-PHASE             PIC XXXX.
037550 01  IM31-USER-PARAMETERS.
037600     03  IM31-USER-FLAG              PIC X.
037650     03  IM31-NEW-MST-SW             PIC X.
037670     03  IM31-ACCT-NOT-FOUND         PIC X.                       IM002
037671 01  IM22-SHORT-NAME-PHASE.                                       IM004
037672     03  FILLER                  PIC X(4)    VALUE 'IM22'.        IM004
037673     03  WK-GEN-PHASE            PIC X(4).                        IM004
037674 01  WORK-SHORT-NAME             PIC X(13).                       IM004
037675***** PARAMETERS FOR GENERATING A MAINTENANCE TRANSACTION FOR THE IM004
037676***** SHORT NAME ARE BELOW:  FIELD NUMBER    (0031)               IM004
037677*****                        MASTER LOCATION (00339)              9915845
037678*****                        MASTER LENGTH   (13)                 IM004
037679*****                        CHARACTER DATA  (C)                  IM004
037680*****                        CHECK OLD       (S)                  IM004
037681 01  IM-EXC15-FM-TRAN.                                            IM004
037682     03  IM-EXC15-FM-NEW-DATA    PIC X(35).                       IM004
037683     03  FILLER                  PIC X(13)  VALUE '00310033913CS'.9915845
037684     03  FILLER                  PIC X(5)    VALUE SPACES.        IM004
037685     03  SHORT-NAME-LIT          PIC X(17)   VALUE SPACES.        0266741
037686     03  IM-EXC15-MASTER-DATA    PIC X(35).                       IM004
037700*FOR GENERATING MAINT INFO FOR REGION CHANGES ON THE IM41P1.      1003625
037710 01  REGION-EXC15-FM-TRAN.                                        1003625
037715     03  R-EXC15-FM-NEW-DATA     PIC X(35).                       1003625
037720     03  R-EXC15-FM-FIELD        PIC X(04).                       1003625
037725     03  FILLER                  PIC X(14)   VALUE SPACES.        1105504
037730     03  R-EXC15-FM-DESC         PIC X(17).                       1003625
037735     SKIP3                                                        1003625
037737***** PARAMETERS FOR GENERATING A MAINTENANCE TRANSACTION FOR THE 1105504
037738***** COST CENTER ARE BELOW: FIELD NUMBER    (9998)               1105504
037739*****                        MASTER LOCATION (00136)              9915845
037740*****                        MASTER LENGTH   (30)                 1105504
037741*****                        CHARACTER DATA  (C)                  1105504
037742*****                        CHECK OLD       (S)                  1105504
037743 01  IM-EXC15-FM-TRAN-CC.                                         1105504
037744     03  IM-EXC15-FM-NEW-DATA-CC PIC X(35).                       1105504
037745     03  FILLER                  PIC X(13)  VALUE '99980013630CS'.9915845
037746     03  FILLER                  PIC X(5)    VALUE SPACES.        1105504
037747     03  COST-CENTER-LIT         PIC X(17)   VALUE SPACES.        0266741
037750***** PARAMETERS FOR INTEREST WITHHOLDING CALCULATION ROUTINE ****
037800     SKIP3
037850     COPY IMWSTXCL.                                               2012254
038150     SKIP3
038200 01  SERVICE-CHARGE-PARAMETERS.
038250     03  SC-FLAG                     PIC X       VALUE '0'.
038300     03  SC-SERV-WAIVE               PIC X       VALUE '0'.
038350     03  SC-ACH-WAIVE                PIC X       VALUE '0'.
038400     03  SC-ATM-WAIVE                PIC X       VALUE '0'.
038450     03  SC-OTH-WAIVE                PIC X       VALUE '0'.
038460     03  SC-FEE-TYPE                 PIC X       VALUE '0'.       0516691
038500     03  SC-AMOUNTS          COMP-3.
038550         05  SC-AMT-SERV             PIC S9(13)V99.               9915845
038600         05  SC-AMT-ACH              PIC S9(13)V99.               9915845
038650         05  SC-AMT-ATM              PIC S9(13)V99.               9915845
038700         05  SC-AMT-OTH              PIC S9(13)V99.               9915845
038701         05  SC-CTR-OTH              PIC S9(7).                   9915845
038702         05  SC-DISC-WVE-AMT         PIC S9(13)V99.               9915845
038703         05  SC-REG-WVE-AMT          PIC S9(13)V99.               9915845
038704         05  SC-TOT-EC               PIC S9(13)V99.               9915845
038705         05  SC-RESV-AMT             PIC S9(13)V99.               9915845
038706         05  SC-EC-BAL               PIC S9(13)V99   VALUE +0.00. 1105504
038707         05  SC-EC-RATE              PIC S9V9(8).                 9915845
038710         05  SC-AMT-EC               PIC S9(13)V99.               9915845
038750     03  SC-STATEMENT-SYBOLS.
038800         05  SC-STMT-SYM-SERV        PIC XX.
038850         05  SC-STMT-SYM-ACH         PIC XX.
038900         05  SC-STMT-SYM-ATM         PIC XX.
038950         05  SC-STMT-SYM-OTH         PIC XX.
038960         05  SC-STMT-SYM-EC          PIC XX.                      1004525
039000     SKIP3
039050 01  OD-CHARGE-PARAMETERS.
039100     03  OD-CHG-AMOUNTS      COMP-3.
039150         05  SC-AMT-OD-CHG           PIC S9(13)V99.               9915845
039200     03  OD-STATEMENT-SYBOLS.
039250         05  SC-STMT-SYM-OD          PIC XX.
039270     03  OD-SPLIT-IND                PIC S9999       COMP.        0902213
039280     03  OD-PER-MIN-AMT-HOLD         PIC S9(13)V99   COMP-3       9916073
039290                                                     VALUE +0.00. 9916073
039300     SKIP3
039310*                                                                 2016639
039320     COPY IMWS31XI.                                               2016639
039330*                                                                 2016639
039350 01  CMA-FEE-PARAMETERS.
039400     03  CMA-MGMT-FEES               PIC S9(13)V99    COMP-3.     9915845
039450     03  CMA-MGMT-FEE-SYM            PIC XX.
039500     03  CMA-FEE-WAIVE               PIC X       VALUE '0'.
039505*                                                                 9915845
039510 01  IM-SC-ACCESS.                                                9715464
039511     05  IM-SC-SVCM-ACCESS.                                       9916269
039512         10  IM-SC-SVCM-FILE-STATUS                               9916269
039513                                 PIC  X         VALUE 'C'.        9715464
039514         10  IM-SC-SVCM-CONTROL-ACCESS                            9916269
039515                                 PIC  X         VALUE 'I'.        9916269
039525*                                                                 9915845
039550 01  LOAN-PAST-DUE-WORK-AREA.                                     1002953
039555     05  HOLD-BILL-DUE-STAT      PIC  X         VALUE ZERO.       1002953
039560     05  HOLD-BILL-DUE-DATE.                                      1002953
039565         10  HOLD-BILL-DUE-CC    PIC  XX        VALUE SPACES.     1002953
039570         10  HOLD-BILL-DUE-YY    PIC  XX        VALUE SPACES.     1002953
039575         10  HOLD-BILL-DUE-MM    PIC  XX        VALUE SPACES.     1002953
039580         10  HOLD-BILL-DUE-DD    PIC  XX        VALUE SPACES.     1002953
039590                                                                  1105504
039600     COPY IMWSACCR.                                               1004554
039700                                                                  9715519
039800     COPY IMWSLPYR.                                               9715519
040300     SKIP3
040306 01  KITE-RATIO-PARAMETERS.                                       IM006
040312     03  WK-KITE-FLAG                PIC X.                       IM006
040318     03  WK-DEP-TURN-FLAG            PIC X.                       IM006
040324     03  WK-CR-DR-NO-FLAG            PIC X.                       IM006
040330     03  WK-CR-DR-AMT-FLAG           PIC X.                       IM006
040336     03  WK-DR-UNCOLL-AMT-FLAG       PIC X.                       IM006
040339     03  WK-KITE-AGGR-AMT            PIC S9(15)V99   COMP-3.      9915845
040342     SKIP3                                                        IM006
040344 01  WORK-STMT-SPECL-HANDL           PIC X(01).                   1105504
040350 01  WORK-NAME-ADDRESS.
040400     03  WK-NA-NO-LINES              PIC S9          COMP-3.
040410     03  WK-NA-COUNTRY               PIC XX.                      9915845
040450     03  WK-NA-LINES.
040500         05  WK-NA-ADDR-LINES.
040550             07  WK-NA-LINE-1        PIC X(42).
040600             07  WK-NA-LINE-2        PIC X(42).
040650             07  WK-NA-LINE-3        PIC X(42).
040700             07  WK-NA-LINE-4        PIC X(42).
040750             07  WK-NA-LINE-5        PIC X(42).                   1105504
040800         05  WK-NA-LINE-6            PIC X(42).
040850         05  WK-NA-LINE-7            PIC X(42).
040860         05  WK-NA-LINE-8            PIC X(42).                   1105504
040900     03  WK-NAME-LINE  REDEFINES WK-NA-LINES OCCURS 8 TIMES.      1105504
040950         05  WK-NA-LIN-AND-TYP.
041000             07  WK-NA-TYPE          PIC X.
041050             07  WK-NA-LINE          PIC X.
041100         05  FILLER                  PIC X(40).
041102     03  FILLER REDEFINES WK-NA-LINES.                            IM006
041104         05  FILLER                  PIC X(42) OCCURS 7 TIMES.    1105504
041106         05  FILLER                  PIC XX.                      IM006
041108         05  WK-NA-EFFECTIVE-DATES.                               IM006
041110             07  WK-NA-START-DATE    PIC X(6).                    IM006
041112             07  WK-NA-REMAIN-DAYS   PIC S999  COMP-3.            IM006
041116         05  WK-NA-NO-STMTS          PIC S999    COMP-3.          IM006
041118         05  WK-NA-USE-CODE          PIC X.                       IM006
041120         05  WK-NA-SSN-CODE          PIC X.                       IM006
041122         05  WK-NA-SOC-SEC.                                       IM006
041124             07  WK-NA-SSN-PRE       PIC X.                       IM006
041126             07  WK-NA-SSN-NO        PIC X(9).                    IM006
041128             07  WK-NA-SSN-SUF       PIC X.                       IM006
041130         05  WK-NA-PARTNER-PCT       PIC SV999   COMP-3.          IM006
041132         05  WK-NA-USER              PIC X.                       IM006
041134         05  WK-NA-PHONE.                                         IM006
041136             07  WK-NA-AREA-CODE     PIC XXX.                     IM006
041138             07  WK-NA-PHONE-NO      PIC X(7).                    IM006
041140             07  WK-NA-EXTEN-NO      PIC XXXX.                    9915845
041142     03  FILLER                      PIC X(50).                   9915845
041150     SKIP3
041155 01  WK-EX11-TRLR.                                                0326947
041160     03  WK-EX11-SSN-LINE            PIC X(40).                   0326947
041165     03  WK-EX11-SSN-FA              PIC X.                       0326947
041170     03  WK-EX11-SSN-CNTRY           PIC XX.                      0326947
041175     03  FILLER                      PIC X(42).                   0326947
041200 01  WORK-AREA1                                      COMP-3.
041250     03  HOLD-NO1                    PIC S9.
041300     03  HOLD-NO3                    PIC S9(3).
041350     03  HOLD-NO5                    PIC S9(5).
041355     03  HOLD-NO10                   PIC S9(3).                   9916309
041360     03  HOLD-NO11                   PIC S9(3).                   9916309
041365     03  HOLD-NO12                   PIC S9(3).                   9916309
041370     03  HOLD-NO13                   PIC S9(3).                   9916309
041400     03  HOLD-AMT                    PIC S9(15)V99.               9915845
041410     03  HOLD-SAV-ACCR  REDEFINES    HOLD-AMT                     1001985
041420                                     PIC S9(11)V9(6).             9915845
041430     03  HOLD-LOAN-ACCR REDEFINES    HOLD-AMT                     1001985
041440                                     PIC S9(11)V9(6).             9915845
041450     03  HOLD-NO REDEFINES HOLD-AMT  PIC S9(17).                  9915845
041550     03  HOLD-AMT5                   PIC S9(13)V99.               9915845
041600     03  HOLD-AMT7                   PIC S9(13)V99.               9915845
041650     03  HOLD-AMT9                   PIC S9(13)V99.               9915845
041700     03  HOLD-AMT11                  PIC S9(13)V99.               9915845
041750     03  HOLD-AMT13                  PIC S9(13)V99.
041755     03  HOLD-AMT15                  PIC S9(13)V99.               9916072
041760     03  HOLD-AMT-EXCESS             PIC S9(13)V99.               9915845
041770     03  HOLD-AMT-INCR               PIC S9(13)V99.               9915845
041780     03  HOLD-CMA-AMT                PIC S9(13)V99.               9916305
041800     03  HOLD-ACCR1                  PIC S9(13)V99.               9915845
041850     03  HOLD-ACCR2                  PIC S9(13)V99.               9915845
041852     03  HOLD-ADD-ACCR               PIC S9(13)V99    VALUE +0.   0417193
041854     03  HOLD-SUB-ACCR               PIC S9(13)V99    VALUE +0.   0417193
041870     03  HOLD-INTEREST               PIC S9(11)V9(6).             9915845
041872     03  HOLD-LOAN-INT               PIC S9(11)V9(6).             0827796
041875     03  HOLD-ACT-AMT                PIC S9(07)V99    VALUE +0.   0617360
041880     03  HOLD-ACC-AMT                PIC S9(07)V99    VALUE +0.   0617360
041885     03  HOLD-MAX-CNT-LIM            PIC S9(07)V99    VALUE +0.   0617360
041900     03  HOLD-ACCRUAL-DAYS           PIC S9.
041950     03  ACCRUAL-DAY                 PIC S9.
042000     03  CUR-BAL                     PIC S9(13)V99.
042010     03  SAVE-CUR-BAL                PIC S9(13)V99.               9916070
042020     03  CUST-BAL                    PIC S9(13)V99.               IM003
042050     03  OD-BAL                      PIC S9(13)V99.
042100     03  COLL-BAL                    PIC S9(13)V99.
042105     03  WS-TODAYS-COLL-BAL          PIC S9(13)V99.               1105504
042150     03  ACCT-BAL-IN                 PIC S9(13)V99.
042200     03  LOAN-BAL-IN                 PIC S9(13)V99.               9915845
042250     03  LOAN-PREV-BAL-IN            PIC S9(13)V99.               9915845
042300     03  LOAN-TODAY                  PIC S9(13)V99.               9915845
042320     03  LOAN-MIN-BAL                PIC S9(13)V99.               9915845
042350     03  PRIN-OVRPMT                 PIC S9(13)V99.               9915845
042400     03  HOLD-OPT                    PIC S9.
042450     03  INCR-TIMES                  PIC S9(9).                   9915845
042456     03  OD-CTR                      PIC S9(9).                   9915845
042457     03  ATM-POS-OD-CTR              PIC S9(9).                   1020116
042458     03  ATM-POS-NSF-CTR             PIC S9(9).                   1020116
042459     03  ATM-POS-DAU-CTR             PIC S9(9).                   1020116
042470     03  DAU-CTR                     PIC S9(9).                   9915845
042500     03  NSF-CTR                     PIC S9(9).                   9915845
042502     03  OD-CTR-FDIC                 PIC S9(9).                   0927850
042504     03  NSF-CTR-FDIC                PIC S9(9).                   0927850
042506     03  BATCH-RUN-FDIC              PIC S9(13)V99.               0930077
042510     03  NSF-RVRSL-CTR               PIC S9(9).                   9915845
042550     03  HOLD-INCRM                  PIC S9(13)V99.               9915845
042570     03  HOLD-LOAN-INCR              PIC S9(13)V99.               9915845
042600     03  SEQ-CTR                     PIC S9(9).                   9915845
042650     03  LINE-DB                     PIC S9.
042700     03  LINE-CR                     PIC S9.
042750     03  FS-DB                       PIC S9.
042800     03  FS-CR                       PIC S9.
042850     03  FLD-START                   PIC S9(5).
042900     03  TODAYS-INTRST-PYMT          PIC S9(13)V99.               9915845
042920     03  TODAYS-WTHLD-AMT            PIC S9(13)V99.               2016735
042950     03  TDAY-IOD-PMT                PIC S9(13)V99.               9915845
043000     03  TDAY-SAV-PMT                PIC S9(13)V99.               9915845
043050     03  TODAYS-DEBITS               PIC S9(13)V99.
043100     03  HOLD-LG-ITEM                PIC S9(13)V99.               9915845
043150     03  HOLD-MKT-LG-ITEM            PIC S9(13)V99.               9915845
043200     03  EX-SEQ-CTR                  PIC S999.
043250     03  NP-REV-CTR                  PIC S999.
043300     03  ACCR-BAL                    PIC S9(11)V9(6).             9915845
043350     03  ACCR-AMT1                   PIC S9(11)V9(6).             9915845
043352     03  ACCR-AMT2                   PIC S9(11)V9(6).             0817707
043360     03  ACCR-SVC-AMT                PIC S9(11)V9(6).             9915845
043370     03  BKDT-ACCR-BAL               PIC S9(9)V9(6).              9915255
043400     03  HOLD-RATE                   PIC SVP9(15).                9915845
043410     03  HOLD-DAILY-MAX              PIC SVP9(15).                9915845
043420     03  HOLD-RATE1                  PIC SVP9(15).                9915845
043430     03  HOLD-RATE2                  PIC SVP9(15).                9915845
043440     03  HOLD-RATE3                  PIC SVP9(15).                9915845
043450     03  LOAN-BAL                    PIC S9(13)V99.               9915845
043500     03  LOAN-LIM                    PIC S9(13)V99.               9915845
043520     03  LOAN-ACCRUAL-DAY            PIC S9.                      IM005
043550     03  HOLD-PYMT                   PIC S9(13)V99.               9915845
043600     03  SERIAL-DB                   PIC S999.
043650     03  SERIAL-DB-PAGE              PIC S999.
043700     03  SAVINGS-BALANCE-IN          PIC S9(13)V99.
043710     03  SAVINGS-BALANCE-DIF         PIC S9(13)V99.               1005110
043750     03  DDA-BALANCE-IN              PIC S9(13)V99.
043800     03  HOLD-SAV-INCR               PIC S9(13)V99.               9915845
043810     03  HOLD-SAV-INCR-COUNT         PIC S9(11).                  1004189
043820     03  HOLD-SAV-INCR-TOTAL         PIC S9(13)V99.               1004189
043850     03  TRANSFER-AMT                PIC S9(13)V99.
043900     03  SAVE-AMT                    PIC S9(13)V99.
043950     03  AMT-AVAIL                   PIC S9(13)V99.
043960     03  AMT-UNAVAIL                 PIC S9(13)V99.               9916072
043970     03  MAX-TAX                     PIC S9(13)V99.               IM007
044000     03  ACCRUAL-ROUND               PIC SV999.
044050     03  NSF-TOTAL                   PIC S9(13)V99.               9915845
044100     03  HOLD-ADJ                    PIC S9V9(8).                 9915845
044150     03  HOLD-MAX                    PIC S9V9(8).                 9915845
044200     03  HOLD-ANN-RTE                PIC S9V9(8).                 9915845
044210     03  SAVE-WMS-PRIME-RATE         PIC S9V9(8).                 9915845
044250     03  HOLD-ACCR-INT               PIC S9(11)V9(6).             9915845
044300     03  HOLD-HOLD-AMT               PIC S9(13)V99.               9915845
044350     03  HOLD-OD-BAL                 PIC S9(13)V99.               9915845
044400     03  HOLD-OD-LIMIT               PIC S9(13)V99.               9915845
044450     03  HOLD-TR-AMOUNT              PIC S9(13)V99.               9915845
044500     03  HOLD-OD-PRIME-ADJ           PIC S9V9(8).                 9915845
044520     03  HOLD-CUR-BAL                PIC S9(13)V99.               IM002
044530     03  HOLD-SAV-XFER               PIC S9(13)V99.               9915845
044540     03  HOLD-EFA-NSF-AMT            PIC S9(13)V99.               9915845
044545     03  SAVE-NO3                    PIC S9(3).                   IM008
044546     03  SAVE-ODAC-DAYS              PIC S9(3).                   0902940
044547     03  SAVE-ODAC-AGGR-BAL          PIC S9(15)V99.               9915845
044548     03  WS-PROV-HOLD-AMT            PIC S9(13)V99.               0927850
044550     SKIP2
044600 01  WORK-AREA2                                      DISPLAY.
044650     03  HOLD-9                      PIC 99.
044700     03  FILLER REDEFINES HOLD-9.
044750         05  HOLD-91                 PIC 9.
044800         05  HOLD-92                 PIC 9.
044850     03  HOLD-X REDEFINES HOLD-9.
044900         05  HOLD-X1                 PIC X.
044950         05  HOLD-X2                 PIC X.
044960     03  HOLD-ACC9                   PIC 99.                      0617360
044970     03  WK-PLN-TRLR-ELIG-MO9        PIC 99.                      0617360
045000     03  HOLD-DAY                    PIC XX.
045050     03  HOLD-DAY9 REDEFINES HOLD-DAY    PIC 99.
045100     03  STMT-CYCLE-DAYX             PIC X.
045150     03  STMT-CYCLE-DAY REDEFINES STMT-CYCLE-DAYX PIC 9.
045200     03  SVCH-CYCLE-DAYX             PIC X.
045250     03  SVCH-CYCLE-DAY REDEFINES SVCH-CYCLE-DAYX PIC 9.
045256     03  PYMT-CYCLE-DAYX             PIC X.                       IM006
045262     03  PYMT-CYCLE-DAY REDEFINES PYMT-CYCLE-DAYX PIC 9.          IM006
045270     03  WK-REJ-REASON               PIC XXX.                     0717565
045271     03  WK-REJ-REASON2              PIC XX.                      0717520
045272     03  SAVE-CMA-IND                PIC X.                       9916431
045274     03  SAVE-CMA-USE                PIC X.                       9916431
045300     SKIP2
045350 01  WORK-AREA3.
045400     03  HOLD-9Y             PIC 99.
045450     03  HOLD-Y  REDEFINES HOLD-9Y   PIC XX.
045500     03  HOLD-YEAR           PIC XX.                              IM006
045510     03  HOLD-YEAR9 REDEFINES HOLD-YEAR  PIC 99.                  IM006
045520     03  HOLD-MON-Y          PIC XX.                              IM006
045530     03  HOLD-DAY-Y          PIC XX.                              IM006
045535     03  HOLD-COSTS-DAY      PIC XX.                              0717621
045540     03  HOLD-STATUS-OPT     PIC X.                               0717564
045550     03  HOLD-DAILY-RATE-CODE        PIC X.                       0817657
045552     03  HOLD-LOAN-360-DAY-FACTOR    PIC X.                       0817657
045600     SKIP2
045650 01  WORK-AREA4.
045670     03  HOLD-DIVIDEND       PIC S9(13)      COMP-3.              9915845
045690     03  HOLD-REMAINDER      PIC S9(13)V99    COMP-3.             9915845
045700     03  HOLD-OD-DATE        PIC X(6).                            9915845
045702     03  HOLD-WORK-ACCOUNT.                                       9915845
045704         05  HOLD-WK-CTL1    PIC XX.                              9915857
045706         05  HOLD-WK-ACCT-20 PIC X(20).                           9915845
045708     03  FILLER REDEFINES HOLD-WORK-ACCOUNT.                      0417078
045710         05  FILLER            PIC X(8).                          0417078
045712         05  HOLD-WK-CTL4-ACCT PIC X(14).                         0417078
045720     03  WS-BIRTH-DATE.                                           0617360
045721         05  WS-BD-CENT              PIC XX.                      0617360
045722         05  WS-BD-YR                PIC XX.                      0617360
045723         05  WS-BD-MO                PIC XX.                      0617360
045724         05  WS-BD-DA                PIC XX.                      0617360
045725     03  WK-CAPTURE-DATE             PIC X(08)   VALUE SPACES.    0617360
045726     03  FILLER                      REDEFINES WK-CAPTURE-DATE.   0617360
045727         05  WK-CPT-YEAR.                                         0617360
045728             07  WK-CPT-CC           PIC X(02).                   0617360
045729             07  WK-CPT-YY           PIC X(02).                   0617360
045730             07  WK-CPT-YY9 REDEFINES WK-CPT-YY                   0617360
045731                                     PIC 99.                      0617360
045732         05  WK-CPT-MM               PIC X(02).                   0617360
045733         05  WK-CPT-MM9 REDEFINES WK-CPT-MM                       0617360
045734                                     PIC 99.                      0617360
045735         05  WK-CPT-DD               PIC X(02).                   0617360
045736     03  WK-LAST-DATE                PIC X(08)   VALUE SPACES.    0617360
045737     03  FILLER                      REDEFINES WK-LAST-DATE.      0617360
045738         05  WK-LST-YEAR.                                         0617360
045739             07  WK-LST-CC           PIC X(02).                   0617360
045740             07  WK-LST-YY           PIC X(02).                   0617360
045741             07  WK-LST-YY9 REDEFINES WK-LST-YY                   0617360
045742                                     PIC 99.                      0617360
045743         05  WK-LST-MM               PIC X(02).                   0617360
045744         05  WK-LST-DD               PIC X(02).                   0617360
045745     03  WS-PA-KEY-EDIT.                                          0617360
045746         05  WS-PA-PLAN-ID           PIC X(12).                   0617360
045747         05  FILLER                  PIC X           VALUE '-'.   0617360
045748         05  WS-PA-SEQ-NO            PIC XXX.                     0617360
045749         05  FILLER                  PIC X           VALUE '-'.   0617360
045750         05  WS-PA-EMP-ID            PIC X(12).                   0617360
045751     03  WS-HOLD-INDEX               INDEX.                       0617360
045752     03  WS-WORK-DATE8.                                           0617360
045754         05  WS-WD8-CENT             PIC XX.                      0617360
045757         05  WS-WD8-DATE6.                                        0617360
045758             07  WS-WD8-YR           PIC XX.                      0617360
045760             07  WS-WD8-MODA         PIC XXXX.                    0617360
045761     03  WK-STATUS-CHG-SW            PIC X           VALUE 'N'.   1017800
045762     03  WK-STATUS-CD                PIC X           VALUE '0'.   1017800
045772 01  WK-BIN.                                                      0617360
045774     05  WK-BIN9                     PIC S9(4)    COMP SYNC.      0617360
045776     05  WK-BINX REDEFINES WK-BIN9   PIC X(2).                    0617360
045778                                                                  0727606
045780 01  WK-PL-AMT                 PIC S9(13)V99  COMP-3 VALUE +0.    0727606
045782                                                                  0727606
045784     COPY IMWSPLED.                                               0727606
045786                                                                  0727606
045788     COPY IMWSPLTB.                                               0727606
045790                                                                  0727606
045802     SKIP2                                                        IM004
045804*****    THIS WORK AREA IS TO SAVE THE BANK/CUST AVAIL AND HOLD  *IM007
045806*****  FIELDS AT THE BEGINNING OF THE DAY TO USE TO CALCULATE    *IM004
045808*****  THE COLLECTED ACCRUAL BALANCE FOR CMA ACCOUNTS WHEN ACC-  *IM004
045810*****  RUALS ARE TO BE DONE ON THE PREVIOUS DAY'S BALANCE.       *IM004
045811     SKIP2                                                        IM004
045812 01  WORK-AREA5.                                                  IM004
045814     03  SAVE-HOLD-AMT           PIC S9(13)V99   COMP-3.          9915845
045816     03  SAVE-BANK-AMT           PIC S9(13)V99   COMP-3.          9915845
045817     03  SAVE-BANK-TRLR                          COMP-3.          IM007
045818         05  SAVE-BANK-TR-AMT    PIC S9(13)V99   OCCURS 7 TIMES.  9915845
045819     03  FILLER REDEFINES SAVE-BANK-TRLR         COMP-3.          IM007
045824         05  FILLER              PIC S9(13)V99.                   9915845
045826         05  SAVE-BANK-2-7.                                       IM007
045828             07  FILLER          PIC S9(13)V99   OCCURS 6 TIMES.  9915845
045830     03  SAVE-CUST-AMT           PIC S9(13)V99   COMP-3.          9915845
045831     03  SAVE-CUST-TRLR                          COMP-3.          IM007
045832         05  SAVE-CUST-TR-AMT    PIC S9(13)V99   OCCURS 12 TIMES. 9915845
045833     03  FILLER REDEFINES SAVE-CUST-TRLR         COMP-3.          IM007
045838         05  FILLER              PIC S9(13)V99.                   9915845
045840         05  SAVE-CUST-2-12.                                      IM007
045850             07  FILLER          PIC S9(13)V99   OCCURS 11 TIMES. 9915845
045860     SKIP2                                                        IM007
045870 01  SAVE-STMT-FIELD.                                             IM007
045900     03  SAVE-FLD1               PIC X.
045950     03  SAVE-FLD2               PIC X.
045970     SKIP2                                                        IM004
046000 01  NO-TRAILERS.
046050     03  FILLER              PIC XXX             VALUE '000'.     9915845
046100     03  FILLER              PIC S999    COMP-3  VALUE +0.        9915845
046150     03  FILLER              PIC XXXX            VALUE '0000'.
046200     03  FILLER              PIC S999    COMP-3  VALUE +0.
046250     03  FILLER              PIC X(8)            VALUE '00000000'.IM006
046260     03  FILLER              PIC X(6)            VALUE '000000'.  0617360
046270     03  FILLER              PIC X(11)           VALUE SPACES.    0617360
046280     03  FILLER              PIC X               VALUE '0'.       9915845
046290     SKIP2                                                        9915845
046300 01  SAV-CHG-REGQ.
046350     03  SCR-INT-AGGR-DAYS       PIC S999.
046400     03  SCR-INT-AGGR-BAL        PIC S9(15)V99.                   9915845
046450     03  SCR-ACCR-INT            PIC S9(11)V9(6).                 9915845
046500     SKIP3
046550 01  WORK-PROJECTIONS.
046600*****    THIS WORK AREA IS FOR PROJECTED ACCRUALS (IOD & SV).
046650     03  WORK-BANK-AVAIL-TRLR    COMP-3.                          IM007
046660         05  WK-BANK-AVAIL-AMT   PIC S9(13)V99  OCCURS 7 TIMES.   9915845
046670     03  FILLER  REDEFINES WORK-BANK-AVAIL-TRLR  COMP-3.          IM007
046680         05  FILLER              PIC S9(13)V99.                   9915845
046690         05  WK-BANK-AVAIL-2-7.                                   IM007
046700             07  FILLER          PIC S9(13)V99  OCCURS 6 TIMES.   9915845
046710     03  WORK-CUST-AVAIL-TRLR    COMP-3.                          IM007
046720         05  WK-CUST-AVAIL-FUNDS PIC S9(13)V99  OCCURS 12 TIMES.  9915845
046730     03  FILLER  REDEFINES WORK-CUST-AVAIL-TRLR  COMP-3.          IM007
046740         05  FILLER              PIC S9(13)V99.                   9915845
046750         05  WK-CUST-AVAIL-2-12.                                  IM007
046760             07  FILLER          PIC S9(13)V99   OCCURS 11 TIMES. 9915845
046770     03  PROJ-ACCR-BAL           PIC S9(13)V99   COMP-3.          9915845
046780     03  PROJ-ACCR-IOD-BAL       PIC S9(13)V99   COMP-3.          9915845
046790     03  PROJ-ACCR-SV-BAL        PIC S9(13)V99   COMP-3.          IM007
046800     03  PROJ-BANK-AVAIL-CHANGE  PIC X           VALUE 'F'.       IM007
046810     03  PROJ-UNAVAIL-CHANGE     PIC X           VALUE 'F'.       IM007
046820     SKIP3                                                        IM007
046830 01  WORK-BCA-ADJUSTMENT-AREA    COMP-3.                          IM007
046840     03  WORK-BCA-AMOUNT         PIC S9(13)V99.                   9915845
046845     03  WORK-BCA-AMOUNT2        PIC S9(13)V99.                   9915845
046850     03  WORK-BCA-ADJUSTMENTS.                                    IM007
046860         05  WORK-BCA-ADJ-AMT    PIC S9(13)V99.                   9915845
046870         05  WORK-BCA-ADJ-BUC    PIC S99.                         IM007
046880         05  WORK-BCA-ADJ-MTD    PIC S9(15)V99.                   9915845
046890 01  WORK-BCA-AGGREGATES-AREA    COMP-3.                          IM007
046910     03  WORK-BCA-51-AMT         PIC S9(13)V99   OCCURS  8 TIMES. 9915845
046916     03  WORK-BCA-52-AMT         PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046928     03  WORK-BCA-54-AMT         PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046934     03  WORK-BCA-55-AMT         PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046940     03  WORK-BCA-56-AMT         PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046946     03  WORK-BCA-57-REDEP       PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046952     03  WORK-BCA-57-RCTDC       PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046958     03  WORK-BCA-57-LWRSK       PIC S9(13)V99   OCCURS 13 TIMES. 9915845
046970 01  WORK-BCA-INDEX.                                              IM007
046980     03  FILLER                  PIC X.                           IM007
046990     03  WK-BCA-INDEX            PIC 9.                           IM007
047190 01  WORK-BUSINESS-DAYS          PIC S999        COMP-3.          IM007
047500     SKIP3
047510 01  PRODUCT-MAINT-TABLE.                                         IM002
047520     03  PMT-TBL-CTR                 PIC S999    COMP-3 VALUE +0. IM002
047530     03  PMT-ENTRY OCCURS 50 TIMES INDEXED BY PM-INDX.            IM002
047540         05  FILLER                  PIC X(19).                   IM002
047542         05  PMT-TYPE                PIC XXX.                     IM002
047544         05  FILLER                  PIC X(183).                  0910003
047550     SKIP3
047600 01  PRODUCT-NOTICES-TABLE.                                       1004015
047610     03  PNT-TBL-CTR                 PIC S999    COMP-3 VALUE +0. 1004015
047620     03  PNT-ENTRY OCCURS 200 TIMES INDEXED BY PN-INDX.           1004015
047630         05  PNT-TYPE                PIC XXX.                     1004015
047640     SKIP3                                                        1004015
047650 01  TRUTH-IN-SAVINGS-INFO           COMP-3.                      1004015
047660     03  IOD-TIS-INFO                OCCURS 9 TIMES.              1004015
047670         05  IOD-TIS-AGGR-BAL        PIC S9(15)V99.               1004015
047680         05  IOD-TIS-AGGR-DAY        PIC S999.                    1004015
047690         05  IOD-TIS-EARN-INT        PIC S9(11)V9(6).             9915845
047700     03  SAV-TIS-INFO                OCCURS 9 TIMES.              1004015
047710         05  SAV-TIS-AGGR-BAL        PIC S9(15)V99.               1004015
047720         05  SAV-TIS-AGGR-DAY        PIC S999.                    1004015
047730         05  SAV-TIS-EARN-INT        PIC S9(11)V9(6).             9915845
047740     03  WORK-TIS-ADJUSTMENTS.                                    1004015
047750         05  WORK-TIS-ADJ-AMT    PIC S9(13)V99.                   9915845
047760         05  WORK-TIS-ADJ-BUC    PIC S99.                         1004015
047770         05  WORK-TIS-ADJ-MTD    PIC S9(15)V99.                   9915845
047800 01  TISA-BACKDATE-ACCRUAL-PARMS.                                 1004795
047900     05  TISA-ACCRUAL-DAYS       PIC S999           VALUE ZERO.   1004795
048000     05  TISA-ACCRUAL-AMOUNT     PIC S9(11)V9(6)    VALUE ZERO.   9915845
048001     05  TISA-RHA-NEW-AMOUNT     PIC S9(11)V9(6)    VALUE ZERO.   9915845
048002     05  TISA-RHA-OLD-AMOUNT     PIC S9(11)V9(6)    VALUE ZERO.   9915845
048003     05  TISA-ACCRUED-TO-DATE    PIC S9(11)V9(6)    VALUE ZERO.   9915845
048010 01  TISA-RHW-TRAN-DATE.                                          1004795
048020     05  TISA-RHW-TRAN-CENT      PIC XX.                          1004795
048030     05  TISA-RHW-TRAN-YR        PIC XX.                          1004795
048100     05  TISA-RHW-TRAN-MO        PIC XX.                          1004795
048200     05  TISA-RHW-TRAN-DA        PIC XX.                          1004795
048300                                                                  1004795
048450 01  IM31-TOTALS.
048500     03  TOTAL-RECORD-1.
048600     COPY IMWSTOT1.                                               0902297
054500     03  TOTAL-RECORD-2.
054600     COPY IMWSTOT2.                                               0902297
055200     03  TOTAL-RECORD-3.                                          0902970
056100     COPY IMWSTOT3.                                               0902297
057100     SKIP2                                                        0902970
058100     COPY IMWSCTOT.                                               0902970
059100     SKIP2                                                        0902970
059120     COPY IMWSGLTS.                                               0902970
059130     SKIP2                                                        0902970
059140 01  GL-CURRENT-COST-CTR     PIC X(30)   VALUE SPACES.            0902970
059145 01  FILLER   REDEFINES  GL-CURRENT-COST-CTR.                     0902970
059147     03  GL-COST-CTR         PIC X(5) OCCURS 6 TIMES.             0902970
059150 01  SAV-GL-CURRENT-COST-CTR PIC X(30)   VALUE SPACES.            0902970
060000 01  RECAP-CODE-TABLE.                                            0902970
060100     03  GL-AMT-CODES           PIC X(8)   OCCURS 437 TIMES.      0737661
060200     03  GL-CNT-CODES           PIC X(8)   OCCURS 213 TIMES.      0737661
060210 01  RECAP-CODE-TABLE-SIZE.                                       9715253
060220     03  RECAP-CODE-AMT-SIZE    PIC S9(3)  COMP-3 VALUE +437.     0737661
060230     03  RECAP-CODE-CNT-SIZE    PIC S9(3)  COMP-3 VALUE +213.     0737661
060300     SKIP2                                                        0902970
060400 01  GL-BUILD-MISC-FIELDS.                                        0902970
060500     03  GL-BUILD-MASTER-SW            PIC X       VALUE SPACES.  0902970
060600     03  GL-BUILD-COST-CENTER          PIC X(30)   VALUE SPACES.  0902970
060700     SKIP2                                                        0902970
060800 01  WK-GL-ORIG-ACCT                   PIC X(22)   VALUE SPACES.  0902970
060810                                                                  0447267
060820 01  WK-BIN-SRCH-AREA.                                            0447267
060830     05  WK-BISCH-CODE           PIC X.                           0447267
060840     05  FILLER                  PIC XXX.                         0447267
060850     05  WK-BISCH-ENTRY.                                          0447267
060860         10  WK-BISCH-KEY.                                        0447267
060870             15  WK-BISCH-EXC    PIC XX.                          0447267
060880             15  WK-BISCH-SEQ    PIC 99.                          0447267
060890         10  WK-BISCH-RPT-NO     PIC 99.                          0447267
060900         10  WK-BISCH-LOCATION   PIC S999        COMP-3.          0447267
060910                                                                  0447267
060920 01  RPT-EXC-TBL-AREA.                                            0447267
060930     05  RPTEX-TBL-DISPLACEMENT  PIC S9(9)       COMP VALUE +72.  0447267
060940     05  RPTEX-TBL-SIZE          PIC S9(9)       COMP.            0447267
060950     05  RPTEX-TBL-ENTRY-SIZE    PIC S9(9)       COMP VALUE +8.   0447267
060960     05  RPTEX-TBL-KEY           PIC S9(9)       COMP VALUE +4.   0447267
060970     05  RPTEX-TBL-CONSTANT-0    PIC S9(9)       COMP VALUE +0.   0447267
060980     05  RPT-EXC-TABLE-AREA.                                      0447267
060990         10  RPT-EXC-LENGTH      PIC S9(4) COMP.                  0447267
061000         10  FILLER              PIC XX.                          0447267
061010         10  RPT-EXC-PHASE       PIC X(8).                        0447267
061020         10  FILLER              PIC X(32).                       0447267
061030         10  RPT-EXC-TABLE       PIC X(4000).                     0447267
061040         10  RPT-EXC-TBL-ENTRY REDEFINES RPT-EXC-TABLE            0447267
061050                 OCCURS 500 TIMES    PIC X(8).                    0447267
061550                                                                  0902970
061600                                                                  0902970
065400 01  STATEMENT-INFO-HOLD.
065450     03  SNAPSHOT-HOLD.
065500         05  HIGH-SNAP.
065550             07  H-SNAP1.
065600                 09  SNAP-END        PIC X       VALUE HIGH-VALUE.
065650                 09  FILLER          PIC X.
065700             07  H-SNAP2             PIC XXX.
065750             07  H-SNAP3             PIC XXX.
065800             07  H-SNAP4             PIC XXXX.
065850             07  H-SNAP-ACCT         PIC X(10).
065900     03  RESET-HOLD.
065950         05  HIGH-RESET.
066000             07  H-RESET1.
066050                 09  RESET-END       PIC X       VALUE HIGH-VALUE.
066100                 09  FILLER          PIC X.
066150             07  H-RESET2            PIC XXX.
066200             07  H-RESET3            PIC XXX.
066250             07  H-RESET4            PIC XXXX.
066300             07  H-RESET-ACCT        PIC X(10).
066350     03  SNAP-INIT                   PIC XXX.
066400     03  RESET-INIT                  PIC XXX.
066450     SKIP2
066500 01  EXCEPTION-LENGTH-TABLE                          COMP.
066550   02  EX-LENGTH-TBL.
066600     03  EX-01                       PIC S9999   VALUE +135.      0717565
066650     03  EX-02                       PIC S9999   VALUE +056.      9915239
066700     03  EX-03                       PIC S9999   VALUE +053.      0717565
066720     03  EX-04                       PIC S9999   VALUE +094.      0717565
066740     03  EX-05                       PIC S9999   VALUE +113.      0717565
066850     03  EX-06                       PIC S9999   VALUE +222.      0717565
066870     03  EX-07                       PIC S9999   VALUE +183.      0717565
066950     03  EX-08                       PIC S9999   VALUE +097.      0717565
067000     03  EX-09                       PIC S9999   VALUE +154.      0717565
067050     03  EX-10                       PIC S9999   VALUE +102.      0717565
067100     03  EX-11                       PIC S9999   VALUE +141.      0717565
067120     03  EX-12                       PIC S9999   VALUE +394.      0717565
067140     03  EX-13                       PIC S9999   VALUE +228.      0717565
067250     03  EX-14                       PIC S9999   VALUE +303.      0717565
067300     03  EX-15                       PIC S9999   VALUE +159.      0817665
067350     03  EX-16                       PIC S9999   VALUE +000.
067400     03  EX-17                       PIC S9999   VALUE +046.      0717565
067450     03  EX-18                       PIC S9999   VALUE +218.      0717565
067500     03  EX-19                       PIC S9999   VALUE +110.      0717565
067550     03  EX-20                       PIC S9(4)   VALUE +3042.     0717565
067600     03  EX-21                       PIC S9999   VALUE +073.      0717565
067650     03  EX-22                       PIC S9999   VALUE +000.      IM002
067670     03  EX-23                       PIC S9999   VALUE +148.      0717565
067680     03  EX-24                       PIC S9999   VALUE +054.      0717565
067685     03  EX-25                       PIC S9999   VALUE +000.      9915845
067687     03  EX-26                       PIC S9999   VALUE +184.      0717565
067688     03  EX-27                       PIC S9999   VALUE +000.      9915845
067689     03  EX-28                       PIC S9999   VALUE +000.      9915845
067690     03  EX-29                       PIC S9999   VALUE +130.      0717565
067691     03  EX-30                       PIC S9999   VALUE +000.      9915845
067692     03  EX-31                       PIC S9999   VALUE +000.      9915845
067693     03  EX-32                       PIC S9999   VALUE +000.      9915845
067694     03  EX-33                       PIC S9999   VALUE +000.      9915845
067695     03  EX-34                       PIC S9999   VALUE +000.      9915845
067696     03  EX-35                       PIC S9999   VALUE +000.      9915845
067697     03  EX-36                       PIC S9999   VALUE +000.      9915845
067698     03  EX-37                       PIC S9999   VALUE +000.      9915845
067699     03  EX-38                       PIC S9999   VALUE +000.      9915845
067700     03  EX-39                       PIC S9999   VALUE +000.      9915845
067701     03  EX-40                       PIC S9999   VALUE +000.      9915845
067702     03  EX-41                       PIC S9999   VALUE +000.      9915845
067703     03  EX-42                       PIC S9999   VALUE +000.      9915845
067704     03  EX-43                       PIC S9999   VALUE +000.      9915845
067705     03  EX-44                       PIC S9999   VALUE +081.      0717565
067706     03  EX-45                       PIC S9999   VALUE +3042.     0717565
067708     03  EX-46                       PIC S9999   VALUE +0091.     0717565
067710     03  EX-47                       PIC S9999   VALUE +0093.     0717565
067750     03  EX-SRC-INFO-LENGTH          PIC S9999   VALUE +044.      9915239
067760   02  FILLER REDEFINES EX-LENGTH-TBL.                            9915845
067770     03  EX-REC-LENGTH               PIC S9999   OCCURS 48 TIMES. 9915855
067800     SKIP2
067850     COPY IMWSEXWK.                                               9915845
081920 66  IMEX-INFO RENAMES IMEX-REC-NO THRU EX13-REJ-RESN.            IM006
081921 66  IMEX-INFO1  RENAMES IMEX-REC-NO THRU EX01-PLN-TAX-YR.        0617360
081922 66  IMEX-INFO2  RENAMES IMEX-REC-NO THRU EX02-SRC-INFORMATION.   0527319
081923 66  IMEX-INFO3  RENAMES IMEX-REC-NO THRU EX03-SRC-INFORMATION.   0527319
081924 66  IMEX-INFO4  RENAMES IMEX-REC-NO THRU EX04-SRC-INFORMATION.   0527319
081925 66  IMEX-INFO5  RENAMES IMEX-REC-NO THRU EX05-SRC-INFORMATION.   0527319
081926 66  IMEX-INFO6  RENAMES IMEX-REC-NO THRU EX06-LOAN-PREV-BAL.     0527319
081927 66  IMEX-INFO7  RENAMES IMEX-REC-NO THRU EX07-SRC-INFORMATION.   0527319
081928 66  IMEX-INFO8  RENAMES IMEX-REC-NO THRU EX08-ZBA-ULTMT-PRNT-CTL.0527319
081929 66  IMEX-INFO9  RENAMES IMEX-REC-NO THRU EX09-SRC-INFORMATION.   0527319
081930 66  IMEX-INFO10 RENAMES IMEX-REC-NO THRU EX10-REASON.            0527319
081931 66  IMEX-INFO11 RENAMES IMEX-REC-NO THRU EX11-SRC-INFORMATION.   0527319
081932 66  IMEX-INFO12 RENAMES IMEX-REC-NO THRU EX12-SRC-INFORMATION.   0527319
081933 66  IMEX-INFO13 RENAMES IMEX-REC-NO THRU EX13-SRC-INFORMATION.   0527319
081934 66  IMEX-INFO14 RENAMES IMEX-REC-NO THRU EX14-SVC-RD-CHG.        0527319
081935 66  IMEX-INFO15 RENAMES IMEX-REC-NO THRU EX15-FM-TRAN.           0527319
081936 66  IMEX-INFO17 RENAMES IMEX-REC-NO THRU EX17-SRC-INFORMATION.   0527319
081937 66  IMEX-INFO18 RENAMES IMEX-REC-NO THRU EX18-SRC-INFORMATION.   0527319
081938 66  IMEX-INFO19 RENAMES IMEX-REC-NO THRU EX19-LOAN-ACCR-INT.     0527319
081939 66  IMEX-INFO21 RENAMES IMEX-REC-NO THRU EX21-REJ-RSN.           0527319
081940 66  IMEX-INFO22 RENAMES IMEX-REC-NO THRU EX22-RMDR.              0527319
081941 66  IMEX-INFO23 RENAMES IMEX-REC-NO THRU EX23-SRC-INFORMATION.   0527319
081942 66  IMEX-INFO24 RENAMES IMEX-REC-NO THRU EX24-COSTS-TERM-CHG-TDY.0527319
081943 66  IMEX-INFO26 RENAMES IMEX-REC-NO THRU EX26-RATE-AREA.         0527319
081944 66  IMEX-INFO29 RENAMES IMEX-REC-NO THRU EX29-SRC-INFORMATION.   0617360
081945 66  IMEX-INFO44 RENAMES IMEX-REC-NO THRU EX44-TRACE.             0617360
081946 66  IMEX-INFO45 RENAMES IMEX-REC-NO THRU EX45-SEGMENT.           0617360
081947 66  IMEX-INFO46 RENAMES IMEX-REC-NO THRU EX46-DATA.              0617360
081948 66  IMEX-INFO47 RENAMES IMEX-REC-NO THRU EX47-FILLER.            0617360
081950 66  IMEX-REC-13A RENAMES EX13-REJ-PROG THRU EX13-TRACE.          IM006
082000 66  IMEX-REC-13B RENAMES EX13-TR-TYPE THRU EX13-RMDR.
082050     SKIP3
082100     SKIP2
082150 01  TEMP-HOLD-AREA.
082200     03  TEMP-132.                                                9915845
082250         05  FILLER                  PIC X(12).                   9915845
082300         05  TEMP-120.                                            9915845
082350             07  FILLER              PIC X(35).                   9915845
082400             07  TEMP-85.                                         9915845
082450                 09  FILLER          PIC X(37).                   9915845
082500                 09  TEMP-48.                                     9915845
082550                     11  FILLER      PIC X(02).                   9915845
082600                     11  TEMP-46.                                 9915845
082650                         13  FILLER  PIC X(24).                   9915845
082700                         13  TEMP-22 PIC X(22).                   9915845
082710                         13  TEMP-35 PIC X(35).                   9915851
082750                                                                  IM008
082753 01  ATF-RATE-AREA.                                               IM008
082756     03  ATF-INT-RATE-PTR                PIC S999    COMP-3.      1003625
082759     03  ATF-SPLT-RATE-SCHD              PIC S999    COMP-3.      1003625
082762     03  ATF-PREV-INT-PTR                PIC S999    COMP-3.      1003625
082765     03  ATF-PREV-SPLT-RATE-PTR          PIC S999    COMP-3.      1003625
082768     03  ATF-SPLT-RATE-IND               PIC X.                   IM008
082771     03  ATF-ADJUST-CODE                 PIC X.                   IM008
082772     03  ATF-DAY-FACTOR                  PIC X.                   IM008
082774     03  ATF-PRIME-CALC-FLAG             PIC X.                   IM008
082775     03  ATF-PRIME-BILL-FLAG             PIC X.                   IM008
082776     03  ATF-CAPTURE-DATE.                                        IM008
082777         05  ATF-CAPT-DATE-CENT          PIC XX.                  IM008
082780         05  ATF-CAPT-DATE-YR            PIC XX.                  IM008
082783         05  ATF-CAPT-DATE-MO            PIC XX.                  IM008
082786         05  ATF-CAPT-DATE-DA            PIC XX.                  IM008
082789     03  ATF-RATE-CHANGE-DATE.                                    IM008
082792         05  ATF-RATE-CHANGE-CENT        PIC XX.                  IM008
082795         05  ATF-RATE-CHANGE-YR          PIC XX.                  IM008
082798         05  ATF-RATE-CHANGE-MO          PIC XX.                  IM008
082801         05  ATF-RATE-CHANGE-DA          PIC XX.                  IM008
082804     03  ATF-SPLT-RATES.                                          IM008
082807         05  ATF-CUR-SPLIT               COMP-3.                  IM008
082810             07  ATF-CUR-RATE1-ANNL      PIC S9V9(8).             9915845
082813             07  ATF-CUR-RATE1-DAILY     PIC SVP9(15).            9915845
082816             07  ATF-CUR-RATE2-ANNL      PIC S9V9(8).             9915845
082819             07  ATF-CUR-RATE2-DAILY     PIC SVP9(15).            9915845
082822             07  ATF-CUR-RATE3-ANNL      PIC S9V9(8).             9915845
082825             07  ATF-CUR-RATE3-DAILY     PIC SVP9(15).            9915845
082828             07  ATF-CUR-RATE1-LIMIT     PIC S9(13)V99.           9915845
082831             07  ATF-CUR-RATE2-LIMIT     PIC S9(13)V99.           9915845
082834         05  ATF-CUR-RATE REDEFINES ATF-CUR-SPLIT COMP-3.         IM008
082835             07  ATF-CUR-PTR-ANN         PIC S9V9(8).             9915845
082836             07  ATF-CUR-PTR-DAF         PIC SVP9(15).            9915845
082837         05  ATF-PRV-SPLIT               COMP-3.                  IM008
082838             07  ATF-PRV-RATE1-ANNL      PIC S9V9(8).             9915845
082840             07  ATF-PRV-RATE1-DAILY     PIC SVP9(15).            9915845
082843             07  ATF-PRV-RATE2-ANNL      PIC S9V9(8).             9915845
082846             07  ATF-PRV-RATE2-DAILY     PIC SVP9(15).            9915845
082849             07  ATF-PRV-RATE3-ANNL      PIC S9V9(8).             9915845
082852             07  ATF-PRV-RATE3-DAILY     PIC SVP9(15).            9915845
082855             07  ATF-PRV-RATE1-LIMIT     PIC S9(13)V99.           9915845
082858             07  ATF-PRV-RATE2-LIMIT     PIC S9(13)V99.           9915845
082861         05  ATF-PRV-RATE REDEFINES ATF-PRV-SPLIT COMP-3.         IM008
082876             07  ATF-PRV-PTR-ANN         PIC S9V9(8).             9915845
082879             07  ATF-PRV-PTR-DAF         PIC SVP9(15).            9915845
082882     EJECT                                                        IM008
082883     COPY IMWRKBC0.                                               IMIBXX
082885     COPY IMWRKBC1.                                               0266741
082888     EJECT                                                        IM008
082900     COPY IMWRKBC2.                                               0266741
082950     EJECT
083000     COPY IMWRKBC3.                                               0266741
083050     EJECT
083052     COPY IMWRKBC4.                                               0266741
083054     EJECT                                                        1003625
083060     COPY IMWRKBC5.                                               0266741
083070     EJECT                                                        IM006
083080     COPY IMWRKBC6.                                               0266741
083090     EJECT                                                        IM008
083095     COPY IMWRKBC7.                                               0266741
083098     EJECT                                                        0902970
083100     COPY IMMEMO.
083102 01  IM-MEMO-HEADER-RECORD REDEFINES IM-MEMO-OL-AREA.             1003624
083104     03  IM-MEMO-HDR-KEY              PIC X(22).                  1003624
083106     03  IM-MEMO-HDR-ID               PIC X.                      1003624
083108     03  IM-MEMO-HDR-DATA-CENTER-ID   PIC XXXX.                   1003624
083110     03  IM-MEMO-HDR-GROUP            PIC X.                      1003624
083112     03  IM-MEMO-HDR-FILE-SEQ         PIC S9(5)       COMP-3.     1003624
083114     03  IM-MEMO-HDR-SYSTEM-DATE      PIC X(8).                   1003624
083116     03  IM-MEMO-HDR-SYSTEM-TIME      PIC X(6).                   1003624
083118     03  IM-MEMO-HDR-EOM              PIC X.                      1003624
083120     03  IM-MEMO-HDR-EOQ              PIC X.                      1003624
083122     03  IM-MEMO-HDR-EOY              PIC X.                      1003624
083124     03  FILLER                       PIC X(452).                 1003624
083150     EJECT
083190     COPY IMACLRTE.                                               1003625
083200     COPY IMAWKMST.
083250 66  WMS-DDA-MASTER RENAMES WMS-EXC-CODE THRU WMS-TRAILER-CNTL.
083300 66  WMS-TRAILERS RENAMES WMS-SOC-SEC-NA THRU
083350                          WMS-DC-TRLR.                            9915845
083400     SKIP1
083450 01  FILLER REDEFINES MASTER-AREA.
083500     03  FILLER                      PIC XXXX.
083550     03  MASTER-BYTE                 PIC X   OCCURS 16626 TIMES.  0930011
083600     SKIP2
083610 01  FILLER REDEFINES MASTER-AREA.                                9915845
083612     03  FILLER                      PIC XXXX.                    9915845
083614     03  FILLER                      PIC X(5769).                 9915845
083616     03  WMS-TRN-AFF-TRLRS           PIC X(0765).                 9915845
083618     03  FILLER                      PIC X(0942).                 9915845
083620     03  WMS-COMB-STMT-TRLRS         PIC X(0690).                 9915845
083622     03  FILLER                      PIC X(7960).                 0617360
083640     SKIP2                                                        9915845
083650 01  DDA-HEADER-RECORD REDEFINES MASTER-AREA.
083700     03  FILLER                      PIC XXXX.
083710     03  HDR-AREA-FIXED.                                          1003624
083750         05  HDR-KEY                 PIC X(22).                   1003624
083800         05  HDR-ID                  PIC X.                       1003624
083850         05  HDR-DATA-CENTER-ID      PIC XXXX.                    1003624
083900         05  HDR-GROUP               PIC X.                       1003624
083950         05  HDR-FILE-SEQ            PIC S9(5)       COMP-3.      1003624
084000         05  HDR-SYSTEM-DATE         PIC X(8).                    1003624
084050         05  HDR-SYSTEM-TIME         PIC X(6).                    1003624
084100         05  HDR-EOM                 PIC X.                       1003624
084150         05  HDR-EOQ                 PIC X.                       1003624
084200         05  HDR-EOY                 PIC X.                       1003624
084210         05  HDR-PROCESS-THRU-DATE   PIC X(6).                    1105504
084250         05  FILLER                  PIC X(26).                   9915858
084270 01  SAVE-MASTER-AREA                PIC X(16630).                0930011
084300     EJECT
084310     COPY IMNAME.                                                 9915868
084350 01  EXCEPTION-INFORMATION.
084400     03  EX-INFO.
084450         05  RECNO                   PIC XX.
084500         05  EXCODE.
084550             07  EXCODE-1            PIC XX.
084600             07  EXCODE-2            PIC XX.
084650         05  FILLER                  PIC X(13).                   0717565
084700         05  REJPROG                 PIC XX.
084750         05  REJRESN                 PIC XXX.                     0717565
084800     03  EX-LOAN-DISB                                COMP-3.
084850         05  OTH-ADJ.
084900             07  INS1-CHG            PIC S9(13)V99.               9915845
084950             07  INS2-CHG            PIC S9(13)V99.               9915845
085000             07  FEE-CHG             PIC S9(13)V99.               9915845
085050         05  BAL-ADJ REDEFINES OTH-ADJ.
085100             07  PRIN-OLD-DISB       PIC S9(13)V99.               9915845
085150             07  ADDL-CR-DISB        PIC S9(13)V99.               9915845
085160             07  FILLER              PIC S9(13)V99.               9915845
085200         05  PRIN-DISB               PIC S9(13)V99.               9915845
085250         05  INT-DISB                PIC S9(13)V99.               9915845
085300         05  OTH-DISB                PIC S9(13)V99.               9915845
085304     03  HOLD-LOAN-DISB                              COMP-3.      IM002
085305         05  HOLD-OTH-ADJ.                                        IM002
085306             07  HOLD-INS1-CHG       PIC S9(13)V99.               9915845
085307             07  HOLD-INS2-CHG       PIC S9(13)V99.               9915845
085308             07  HOLD-FEE-CHG        PIC S9(13)V99.               9915845
085309         05  HOLD-PRIN-DISB          PIC S9(13)V99.               9915845
085310         05  HOLD-INT-DISB           PIC S9(13)V99.               9915845
085311         05  HOLD-OTH-DISB           PIC S9(13)V99.               9915845
085312     SKIP2                                                        IM002
085313 01  CLOSING-FIELDS              COMP-3.                          IM002
085314     03  CLS-TR-AMOUNT           PIC S9(13)V99       VALUE +0.    9915845
085316     03  CLS-ACCR-INT            PIC S9(13)V99       VALUE +0.    9915845
085318     03  CLS-POS-ADJUST          PIC S9(13)V99       VALUE +0.    9915845
085320     03  CLS-DISTRIBUTION.                                        IM002
085324         05  CLS-ADJUSTMENT      PIC S9(13)V99       VALUE +0.    9915845
085328         05  CLS-IOD-INT-PAY     PIC S9(13)V99       VALUE +0.    9915845
085332         05  CLS-SAV-INT-PAY     PIC S9(13)V99       VALUE +0.    9915845
085334         05  CLS-OD-INT-CHG      PIC S9(13)V99       VALUE +0.    9915845
085336         05  CLS-IOD-INT-WAV     PIC S9(13)V99       VALUE +0.    9915845
085338         05  CLS-SAV-INT-WAV     PIC S9(13)V99       VALUE +0.    9915845
085340         05  CLS-OD-INT-WAV      PIC S9(13)V99       VALUE +0.    9915845
085343         05  CLS-IOD-TAX         PIC S9(13)V99       VALUE +0.    9915845
085346         05  CLS-SAV-TAX         PIC S9(13)V99       VALUE +0.    9915845
085348         05  CLS-CLOSE-CHG       PIC S9(13)V99       VALUE +0.    0527322
085350     SKIP2
085400 01  GEN-TRAN-OPTION-HOLD.
085450     03  GT-USER-CODE                PIC XX.
085500     03  GT-MNEUMONIC                PIC XX.
085550     03  GT-ACCUM1                   PIC S999    COMP-3.          1105504
085600     03  GT-ACCUM2                   PIC S999    COMP-3.          1105504
085650     03  GT-TRAN-OPTIONS             PIC X(7).
085700     03  GT-OPTION REDEFINES GT-TRAN-OPTIONS     PIC X
085750                                                 OCCURS 6 TIMES.
085800     03  GT-OPTION9 REDEFINES GT-TRAN-OPTIONS    PIC 9
085850                                                 OCCURS 6 TIMES.
085900     SKIP2
085950 01  STMT-OPT-HOLD.
086000     03  LINE-DEBITS      COMP-3.
086050         05  LINE-DB1                PIC S9.
086100         05  LINE-DB2                PIC S9.
086150         05  LINE-DB3                PIC S9.
086200     03  LINE-CREDITS     COMP-3.
086250         05  LINE-CR1                PIC S9.
086300         05  LINE-CR2                PIC S9.
086350         05  LINE-CR3                PIC S9.
086400     03  PAGE-LINES                  PIC S999        COMP-3.
086450     03  MIN-TRANS                   PIC S9          COMP-3.
086500     03  ZIP-SORT                    PIC X.
086550     03  LOAN-LINES                  PIC S9          COMP-3.
086600     03  RATE-LINES                  PIC S9          COMP-3.
086650     03  MSG-LINES                   PIC S9          COMP-3.
086700     03  DR-HDR-LINES                PIC S9          COMP-3.
086750     03  CR-HDR-LINES                PIC S9          COMP-3.
086800     03  ACH-LINES                   PIC S9          COMP-3.
086850     03  CHECK-LINES                 PIC S9          COMP-3.
086900     03  DEPOSIT-LINES               PIC S9          COMP-3.
086910     03  LOAN-BILL-FORMAT            PIC X.                       1002512
086920     03  CLSD-ACCT-STMT              PIC X.                       1002512
086950     SKIP2
087000 01  TRLR-SCHD-HOLD.
087050     03  TRLR-CODE                   PIC X.
087100     03  TRLR-DAY1.
087150         05  TRLR-DAY1-1             PIC X.
087200         05  TRLR-DAY1-2             PIC X.
087250     03  TRLR-DAY2.
087300         05  TRLR-DAY2-1             PIC X.
087350         05  TRLR-DAY2-2             PIC X.
087400     03  TRLR-FREQ                   PIC 99.
087450     03  TRLR-F REDEFINES TRLR-FREQ.
087500         05  TRLR-F1                 PIC 9.
087550         05  TRLR-F2                 PIC 9.
087600     SKIP2
087605******************************************************************9915845
087610***  THE FOLLOWING COPYBOOK IS USED TO DEFINE FIELDS USED FOR     9915845
087615***  INTEREST PAYMENT SCHEDULING.                                 9915845
087620***                                                               9915845
087625     COPY IMWS31IP.                                               9915845
087630***                                                               9915845
087635***  END OF EXIT.                                                 9915845
087640******************************************************************9915845
087645     SKIP2                                                        9915845
087650 01  SPLIT-RATE-HOLD                 COMP-3.                      IM008
087700     03  SR-ANNL-RATE1               PIC S9V9(8).                 9915845
087750     03  SR-DAILY-RATE1              PIC SVP9(15).                9915845
087850     03  SR-ANNL-RATE2               PIC S9V9(8).                 9915845
087900     03  SR-DAILY-RATE2              PIC SVP9(15).                9915845
088000     03  SR-ANNL-RATE3               PIC S9V9(8).                 9915845
088050     03  SR-DAILY-RATE3              PIC SVP9(15).                9915845
088060     03  SR-LIMIT1                   PIC S9(13)V99.               9915845
088070     03  SR-LIMIT2                   PIC S9(13)V99.               9915845
088100     SKIP2
088150     COPY SIWSDTAR.
088160     03  SICOMPDT-WORK-AREA.                                      1002953
088161         05  SICOMPDT-RETURN-FLAG    PIC  X.                      1002953
088165         05  SICOMPDT-DATE-FORMATS.                               1002953
088166             07  SICOMPDT-DATE-FMT1  PIC  X.                      1002953
088167             07  SICOMPDT-DATE-FMT2  PIC  X.                      1002953
088200     03  DATE-1.
088225         05  D1-CC                   PIC XX.                      1105729
088250         05  D1-YR                   PIC XX.
088300         05  D1-MO-DA.
088350             07  D1-MO               PIC XX.
088400             07  D1-DA               PIC XX.
088450     03  DATE-2.
088475         05  D2-CC                   PIC XX.                      1105729
088500         05  D2-YR                   PIC XX.
088550         05  D2-MO-DA.
088600             07  D2-MO               PIC XX.
088650             07  D2-DA               PIC XX.
088700     03  DATE-3.
088725         05  D3-CC                   PIC XX.                      1105729
088750         05  D3-YR                   PIC XX.
088800         05  D3-MO-DA.
088850             07  D3-MO               PIC XX.
088900             07  D3-DA               PIC XX.
088950             07  D3-N-DA REDEFINES D3-DA   PIC 99.
089250     03  HOLD-DATE.
089300         05  HOLD-MO                 PIC XX.
089350         05  HOLD-DA                 PIC XX.
089400         05  HOLD-YR                 PIC XX.
089410     03  HOLD-NEXT-DAY               PIC XX.                      1003844
089450     SKIP3
089460     COPY  SIWSDTWK.                                              1003625
089462 01  YEAR-END-DDA-CUR-DATA.                                       1003625
089464     03  YE-DDA-CUR-DAF          PIC SVP9(15) COMP-3.             9915845
089466 01  YEAR-END-FND-CUR-DATA.                                       1003625
089468     03  YE-FND-CUR-DATE         PIC X(8).                        1003625
089470     03  YE-FND-CUR-RATES        COMP-3 OCCURS 9 TIMES.           1003625
089472         05  YE-FND-CUR-ANN      PIC S9V9(8).                     9915845
089476         05  YE-FND-CUR-DAF      PIC SVP9(15).                    9915845
089478     03  YE-FND-CUR-LMT          PIC S9(13)V99 COMP-3             9915845
089480                                 OCCURS 8 TIMES.                  1003625
089482 01  YEAR-END-LN-CUR-DATA        COMP-3.                          1003625
089484     03  YE-LN-CUR-RATES.                                         1003625
089486         05  YE-LN-CUR-ANN       PIC S9V9(8).                     9915845
089490         05  YE-LN-CUR-DAF       PIC SVP9(15).                    9915845
089492     03  YE-WMS-LN-CUR-RATES.                                     1003625
089494         05  YE-WMS-ANNUAL-RATE  PIC S9V9(8).                     9915845
089496         05  YE-WMS-DAILY-RATE   PIC SVP9(15).                    9915845
089498 01  YEAR-END-SPL-CUR-DATA.                                       1003625
089500     03  YE-SPL-CUR-INFO.                                         1003625
089502         05  YE-SPL-CUR-RATES    COMP-3 OCCURS 3 TIMES.           1003625
089504             07  YE-SPL-CUR-ANN  PIC S9V9(8).                     9915845
089506             07  YE-SPL-CUR-DAF  PIC SVP9(15).                    9915845
089508         05  YE-SPL-CUR-LMT      PIC S9(13)V99  COMP-3            9915845
089510                                 OCCURS 2 TIMES.                  1003625
089512 01  WS-NEW-YEAR-DATE.                                            1003625
089514     05  WS-NY-CC                PIC XX.                          1003625
089516     05  WS-NY-YR                PIC XX.                          1003625
089518     05  WS-NY-MO                PIC XX         VALUE '01'.       1003625
089520     05  WS-NY-DA                PIC XX         VALUE '01'.       1003625
089524 01  RATE-WORK-AREA              COMP-3.                          1001295
089525     03  WK-LIR-ANNUAL           PIC S9V9(8).                     9915845
089526     03  WK-LIR-DAILY            PIC SVP9(15).                    9915845
089530 01  YEAR-END-OD-CUR-DATA.                                        0335614
089531     03  YE-OD-CUR-DATA              OCCURS 9 TIMES.              0335614
089532         05  YE-OD-CUR-DATE          PIC X(8).                    0335614
089533         05  YE-OD-CUR-RATES         COMP-3.                      0335614
089534             07  YE-OD-CUR-ANN       PIC S9V9(8).                 0335614
089535             07  YE-OD-CUR-DAF       PIC SVP9(15).                0335614
089540 01  YEAR-END-OD-PRM-CUR-DATA.                                    0335614
089541     03  YE-OD-CUR-PRM-DATE      PIC X(8).                        0335614
089542     03  YE-OD-CUR-PRIME         COMP-3.                          0335614
089543         05  YE-OD-PRM-CUR-ANN   PIC S9V9(8).                     0335614
089544         05  YE-OD-PRM-CUR-DAF   PIC SVP9(15).                    0335614
089550     SKIP3
089600 01  RATE-HIST-WORK.
089650*----------------------------------------------------------------*
089700*    VALUES FOR RHW-SW:  E = END-OF-FILE                         *
089750*                        F = OFF, NO RH RECORD READ OR NO MATCH  *
089800*                        N = ON, RH RECORD MATCH                 *
089850*----------------------------------------------------------------*
089900     03  RHW-SW                      PIC X           VALUE 'F'.
090300     03  RHW-LOAN                    PIC X           VALUE 'F'.
090350     03  RHW-IOD-FLAG                PIC X           VALUE 'F'.
090400     03  LOAN-AGGR-DONE              PIC X           VALUE 'F'.
090450     03  FIND-RATE-FLAG              PIC X           VALUE 'F'.
090500     03  RHW-NON-HIST                PIC X           VALUE 'F'.
090550     03  RHW-GEN-KEY.
090600         05  RHW-CONTROLS.                                        1003625
090602             10  RHW-CTL1            PIC XX.                      1003625
090603             10  RHW-CURR-CODE       PIC XXX.                     9915845
090604             10  RHW-REGION          PIC X(10).                   1003625
090610         05  RHW-PRODUCT             PIC XXX.                     1003625
090620         05  RHW-TYPE                PIC X.                       1003625
090650         05  RHW-IND                 PIC 999.                     1003625
090700     03  RHW-DATE-LAST-ACT           PIC X(6).
090750     03  RHW-TRAN-DATE.
090800         05  RHW-TRAN-CENT           PIC XX.
090850         05  RHW-TRAN-YR             PIC XX.
090900         05  RHW-TRAN-MO             PIC XX.
090950         05  RHW-TRAN-DA             PIC XX.
091000     03  RHW-DATE                    PIC X(8).
091050     03  RHW-DATE2                   PIC X(8).
091100     03  RHW-DAYS                    PIC S9(5)       COMP-3.
091150     03  RHW-DAYS2                   PIC S9(5)       COMP-3.
091200     03  RHW-NO-DAYS                 PIC S9(5)       COMP-3.
091250     03  RHW-ACCRUAL-AMOUNT          PIC S9(11)V9(6) COMP-3.      9915845
091300     03  RHW-SPLIT-RATE-IND          PIC S999        COMP-3.      1003625
091350     03  RHW-LOAN-IND                PIC S999        COMP-3.      1003625
091400     03  HOLD-AMT11-CY               PIC S9(13)V99   COMP-3.      9915845
091450     03  HOLD-AMT11-MTD              PIC S9(13)V99   COMP-3.      9915845
091470     03  HOLD-AMT11-YTD              PIC S9(13)V99   COMP-3.      9915845
091500     03  SR-LMT-WK                   PIC S9(13)V99   COMP-3.      9915845
091550     03  ACCR-AMT1-A                 PIC S9(11)V9(6) COMP-3.      9915845
091600     03  RHW-CY-DAYS                 PIC S999        COMP-3.
091650     03  RHW-MTD-DAYS                PIC S999        COMP-3.
091670     03  RHW-YTD-DAYS                PIC S999        COMP-3.      IM006
091700     03  RHW-OD-INT-PTR              PIC S999        COMP-3.      1003625
091750     03  RHW-OD                      PIC X           VALUE 'F'.
091800     SKIP3
091850                                                                  IM008
091860     COPY IMWSRTEM.                                               1003625
091870                                                                  IM008
091880     COPY IMWSRTEW.                                               1003625
091900                                                                  1003625
091902     COPY IMWSRTEH.                                               1003625
091904                                                                  1003625
091905     COPY IMWSRTHH.                                               1003625
092500*                                                                 1003625
099550 01  RATE-HIST-ACCRUAL.
099700     03  RHA-CHECK-ITEM              PIC X       VALUE '0'.
099750     03  RHA-EXCEPTION               PIC XX      VALUE SPACES.
099800     03  RHA-BC-CAPTURE-YR           PIC XX.
099850     03  RHA-FOR-BKDT-RATES          COMP-3.
099900         05  RHA-CUR-DAYS            PIC S9(5).
099950         05  RHA-PRV-DAYS            PIC S9(5).
100000         05  RHA-DEL-DAYS            PIC S9(5).
100050         05  RHA-CUR-DAILY           PIC SVP9(15).                9915845
100100         05  RHA-PRV-DAILY           PIC SVP9(15).                9915845
100150         05  RHA-DEL-DAILY           PIC SVP9(15).                9915845
100200     03  RHA-OLD-ACCRUAL             COMP-3.
100250         05  RHA-OLD-DDA-BAL         PIC S9(13)V99.
100300         05  RHA-OLD-BALANCE         PIC S9(13)V99.
100350         05  RHA-OLD-AMOUNT          PIC S9(11)V9(6).             9915845
100400         05  RHA-OLD-TO-DATE         PIC S9(11)V9(6).             9915845
100420         05  RHA-OLD-OD-BAL          PIC S9(13)V99.               IM008
100430         05  RHA-OLD-SAV-BAL         PIC S9(13)V99.               0316967
100450     03  RHA-NEW-ACCRUAL             COMP-3.
100500         05  RHA-NEW-DDA-BAL         PIC S9(13)V99.
100550         05  RHA-NEW-BALANCE         PIC S9(13)V99.
100600         05  RHA-NEW-AMOUNT          PIC S9(11)V9(6).             9915845
100650         05  RHA-NEW-TO-DATE         PIC S9(11)V9(6).             9915845
100670         05  RHA-NEW-OD-BAL          PIC S9(13)V99.               IM008
100680         05  RHA-NEW-SVC-AMT         PIC S9(11)V9(6).             9915845
100685         05  RHA-NEW-SAV-BAL         PIC S9(13)V99.               0316967
100700     COPY IMBALHST.                                               0902213
100701 01  BAL-HIST-CHK PIC X(8) VALUE SPACES.                          0266741
100702     COPY IMWRKBHI.                                               0902213
100703                                                                  0902213
100704     COPY IMWRKBHM.                                               0902213
100705                                                                  0902213
100706     COPY IMWRKBHO.                                               0902213
100707     COPY IMWRKBHS.                                               0316967
100708     COPY IMWRKBHT.                                               0316967
100709     COPY IMWRKAGM.                                               0902509
100710     SKIP3                                                        0902509
100711 01  BAL-HIST-WORK-FIELDS.                                        0902509
100712     03  BAL-HIST-OPEN               PIC X      VALUE 'F'.        0902509
100713     03  SKIP-READ-BAL               PIC X      VALUE '0'.        0902509
100714     03  BHW-TYPE                    PIC X      VALUE SPACE.      0902509
100715     03  BHW-MAX-RET                 PIC S9(3)  COMP-3            0902509
100716                                                VALUE ZERO.       0902509
100717     03  BAL-HIST-WORK-FLAGS.                                     0902509
100718*--------------------------------------------------------------*  0902509
100719*  WORK FLAG VALUES:  BALANCE HISTORY IS USED FOR THIS ACCOUNT *  0902509
100720*    IOD-FLAG: M = MMDA, I = IOD,  F = OFF (NO)                *  0902509
100721*    SAV-FLAG  R = REG,  T = TIER  F = OFF (NO)                *  0316967
100722*    ODAC-FLAG N = ON (YES),       F = OFF (NO)                *  0902509
100723*--------------------------------------------------------------*  0902509
100724         05  BHW-IOD-FLAG            PIC X      VALUE 'F'.        0902509
100725         05  BHW-SAV-FLAG            PIC X      VALUE 'F'.        0902509
100726         05  BHW-ODAC-FLAG           PIC X      VALUE 'F'.        0902509
100727                                                                  0902509
100728     03  BAL-HIST-WORK-LENGTH-TABLE  COMP-3.                      0902509
100729         05  BHW-LEN                 PIC S9(5)  VALUE ZERO.       0902509
100730         05  BHW-LEN-FIXED           PIC S9(5)  VALUE +31.        0902509
100731         05  BHW-LEN-IOD             PIC S9(5)  VALUE +77.        9915845
100732         05  BHW-LEN-MMDA            PIC S9(5)  VALUE +205.       9915845
100733         05  BHW-LEN-ODAC            PIC S9(5)  VALUE +255.       9915845
100734         05  BHW-LEN-SAV             PIC S9(5)  VALUE +71.        9915845
100735         05  BHW-LEN-SAVT            PIC S9(5)  VALUE +192.       0316967
100736         05  BHW-LEN-MMDA-AGGR       PIC S9(5)  VALUE +115.       0316967
100737     03  BAL-HIST-WORK-AGGR-FLAGS.                                0316967
100738         05  BHW-MMDA-AGGR-FLAG      PIC X      VALUE 'F'.        0316967
100740     SKIP3                                                        9915855
100750     COPY IMWSLMTM.                                               9915855
100752 66  OD-LIMIT-FIXED-AREA RENAMES OD-LIMIT-DELETE                  9915855
100754                         THRU    OD-LIMIT-OCCURRENCES.            9915855
100760     SKIP3                                                        9915855
100770 01  OD-LIMIT-REC-OUT.                                            9915855
100772     03  OD-LMT-OUT-LENGTH       PIC S9999  COMP.                 9915855
100774     03  OD-LMT-OUT-LNGTH-LOW    PIC XX.                          9915855
100776     03  OD-LMT-OUT-HEADER       PIC X(80).                       9915855
100778     03  FILLER                  PIC X(541).                      9915855
100780     SKIP3                                                        9915855
100804 01  OD-LIMIT-FILE-WORK-AREA.                                     9915855
100806     03  WS-SAVE-OD-OCCURRENCES  PIC S999   COMP-3    VALUE +0.   9915855
100808     03  WS-TOTAL-OD-AMT         PIC S9(13)V99 COMP-3 VALUE +0.   9915855
100810     03  WS-TOTAL-OD-AMT-ONLINE  PIC S9(13)V99 COMP-3 VALUE +0.   9915855
100812     03  WS-OD-LIMIT-OCC-DELETE  PIC X                VALUE '0'.  9915855
100814     03  WS-OD-LIMIT-MATCH-SW    PIC X                VALUE '1'.  9915855
100818     03  WS-OD-EXPIRE-TOMORROW   PIC X                VALUE '0'.  9915855
100820     03  WS-SAVE-OD-LIMIT-KEY    PIC X(22).                       9915855
100822*                                                                 9915855
100824*--------------------------------------------------------------*  0927817
100826*    EXTENDED FLOAT FILE COPYBOOKS AND WORK FIELDS             *  0927817
100828*--------------------------------------------------------------*  0927817
100830     COPY IMWSAFF.                                                0927817
100832     COPY IMWSWAFF.                                               0927817
100834     COPY IMWSCAFF.                                               0927817
100836*                                                                 0927817
100838 01  EXTENDED-FLOAT-WORK-FIELDS.                                  0927817
100840     03  AFF-OPEN                PIC X           VALUE 'F'.       0927817
100842     03  AFF-SKIP-READ           PIC X           VALUE '0'.       0927817
100844     03  AFF-FLAG                PIC X           VALUE 'F'.       0927817
100846     03  AFF-MAX-ENTRY           PIC S999 COMP-3 VALUE +0.        0927817
100848     03  AFF-FIXED               PIC S999 COMP-3 VALUE +58.       0927817
100850     03  AFF-ENTRY-SIZE          PIC S999 COMP-3 VALUE +8.        0927817
100852     03  AFF-CTL1-3              PIC X(8)        VALUE SPACES.    0927817
100860     SKIP3                                                        0927817
100870 01  TODAYS-REPORT-TABLE.                                         0927817
100880     03  REPORT9                     COMP.                        0927817
100890         05  RPT9                    PIC S9999   OCCURS 99 TIMES  0927817
100900                                         INDEXED BY RPT-INDEX.
100950     03  REPORTX REDEFINES REPORT9                   DISPLAY.
101000         05  RPTX                                OCCURS 99 TIMES.
101050             07  RPT-END             PIC X.
101100             07  FILLER              PIC X.
101150     SKIP2
101200 01  STATEMENT-REQUEST-TBL.
101250     03  ST-REQ-TBL  OCCURS 20 TIMES INDEXED BY REQ-IND.
101300         05  ST-REQ-TYPE     PIC X.
101350         05  ST-REQ-INIT     PIC XXX.
101400     SKIP2
101450 01  PHASE-AREA.
101500     03  IM31-PHASE.
101550         05  FILLER                  PIC XXXX    VALUE 'IM31'.
101600         05  IM31-PH2                PIC XXXX.
101650     03  TRIAL-PHASE                 PIC X(8).
101652     03  IM22-PHASE.                                              0617360
101654         05  FILLER                  PIC XXXX    VALUE 'IM22'.    0617360
101656         05  IM22-PH2                PIC XXXX.                    0617360
101658     SKIP2                                                        0617360
101660     COPY IMWSG8.                                                 0617360
101700     SKIP2
101710     COPY IMWSCLDC.                                               9915845
101720     SKIP3                                                        9915845
101750 01  CONSOLE-MESSAGE-AREA.
101800     03  EMSG-01.
101850         05  FILLER  PIC X(25) VALUE 'NO BCR FOUND FOR CONTROL '.
101900         05  E01-C1  PIC XX.
101950         05  FILLER  PIC X     VALUE '-'.
102000         05  E01-C2  PIC XXX.
102050         05  FILLER  PIC X     VALUE '-'.
102100         05  E01-C3  PIC XXX.
102150     03  EMSG-02.
102200         05  FILLER  PIC X(50) VALUE                              9915845
102250             'MASTER AND BANK CONTROL SEQUENCE NUMBERS DISAGREE '.9915845
102300         05  FILLER  PIC X(13) VALUE 'MASTER SEQ = '.
102350         05  E02-C1  PIC -9(05).
102400         05  FILLER  PIC X(13) VALUE 'BK CTL SEQ = '.
102450         05  E02-C2  PIC -9(05).
102500     03  EMSG-03.
102550         05  FILLER  PIC X(30) VALUE                              9915845
102600             'PROGRAM IM28 NOT RUN FOR BANK '.                    9915845
102650         05  E03-C1  PIC XX.
102700         05  FILLER  PIC X     VALUE '-'.
102750         05  E03-C2  PIC XXX.
102800         05  FILLER  PIC X     VALUE '-'.
102850         05  E03-C3  PIC XXX.
102860     03  EMSG-04.                                                 9915868
102861         05  FILLER  PIC X(24) VALUE 'PRODUCT MAINT RECORDS   '.  9915868
102862         05  FILLER  PIC X(09) VALUE 'FOR BANK '.                 9915868
102863         05  E04-C1  PIC XX.                                      9915868
102864         05  FILLER  PIC X     VALUE '-'.                         9915868
102865         05  E04-C2  PIC XXX.                                     9915868
102866         05  FILLER  PIC X     VALUE '-'.                         9915868
102867         05  E04-C3  PIC XXX.                                     9915868
102868     03  EMSG-05.                                                 9915868
102869         05  FILLER  PIC X(24) VALUE 'ACCT NOT FOUND ALT NAME '.  9915868
102870         05  FILLER  PIC X(24) VALUE 'AND ADDRESS FILE   KEY= '.  9915868
102871         05  E05-KEY PIC X(22) VALUE SPACES.                      9915868
102872         05  FILLER  PIC X(10) VALUE SPACES.                      9915868
102873     03  EMSG-06.                                                 9915868
102874         05  FILLER  PIC X(55) VALUE                              9915868
102875        'BYPASSING NON-PROCESSED PRODUCT MAINT RECORDS FOR BANK '.9915868
102876         05  E06-C1  PIC XX.                                      9915868
102877         05  FILLER  PIC X     VALUE '-'.                         9915868
102878         05  E06-C2  PIC XXX.                                     9915868
102879         05  FILLER  PIC X     VALUE '-'.                         9915868
102880         05  E06-C3  PIC XXX.                                     9915868
102881     03  EMSG-07.                                                 9916309
102882         05  FILLER  PIC X(26) VALUE 'STATEMENT SNAPSHOT RECORD'. 9916309
102883         05  FILLER  PIC X(25) VALUE 'DROPPED - ACCOUNT NUMBER'.  9916309
102884         05  E07-KEY PIC X(22) VALUE SPACES.                      9916309
102886*                                                                 0427139
102887 01  PB-EXC15-FM-TRAN.                                            0427139
102888     05  PB-EXC15-NEW-FM-DATA    PIC S9(13)V99   COMP-3.          0427139
102889     05  PB-EXC15-NEW-FM-DATE REDEFINES PB-EXC15-NEW-FM-DATA      0427139
102890                                 PIC X(08).                       0427139
102891     05  FILLER                  PIC X(27)       VALUE SPACES.    0427139
102892     03  PB-EXC15-FM-FIELD       PIC X(18).                       0427139
102893     03  PB-EXC15-FM-DESC        PIC X(17).                       0427139
102894 01  PB-EXC15-MST-OLD-DATA.                                       0427139
102895     05  PB-EXC15-MASTER-DATA    PIC S9(13)V99   COMP-3.          0427139
102896     05  FILLER                  PIC X(20)       VALUE SPACES.    0427139
102898*                                                                 9915868
102900 01  FUNDING-DATA-AREA.                                           1105504
102901     05  FUNDING-FLAG            PIC X(01)       VALUE '0'.       1105504
102902         88  NO-FUNDING          VALUE '0'.                       1105504
102903         88  FUNDING-TO-POST     VALUE '1'.                       1105504
102904         88  FUNDING-POSTED      VALUE '2'.                       1105504
102905     05  DB-WAITING              PIC X(01)       VALUE '0'.       1105504
102906     05  SAVE-FUNDING-TRANS      PIC X(2274).                     0717565
102907     05  SAVE-FUNDING-TRANS-R REDEFINES SAVE-FUNDING-TRANS.       1105504
102908         07  FILLER              PIC X(96).                       0717565
102909         07  FUNDING-AMT         PIC S9(13)V99   COMP-3.          9915845
102910         07  FILLER              PIC X(2170).                     0717565
102911     05  HOLD-FOR-FUNDING        PIC X(2274).                     0717565
102912 01  SCORE-PHASE                 PIC X(08)       VALUE 'IM67ODSC'.9915749
102913**** PARAMETERS FOR GENERATING FILE MAINT FOR THE OD LIMIT AMT :  0266932
102914**** FLD NBR   MASTER LOC   MASTER LGTH   PACKED DATA   CHECK OLD 0266932
102915**** (0080)     (00502)        (08)           (P)          (X)    0266932
102916*                                                                 0266932
102917 01  NB-EXC15-FM-TRAN.                                            0266932
102918     05  NB-EXC15-NEW-FM-DATA    PIC S9(13)V99   COMP-3.          0266932
102919     05  FILLER                  PIC X(27)       VALUE SPACES.    0266932
102920     05  FILLER     PIC X(13)    VALUE '00800050208PS'.           0266932
102921     05  FILLER                  PIC X(02)       VALUE SPACES.    0266932
102922     05  OD-LIMIT-FM-REQ-BY      PIC X(03)       VALUE '31 '.     0266932
102923     05  OD-LIMIT-AMT-LIT        PIC X(17)       VALUE SPACES.    0266932
102924     05  NB-EXC15-MASTER-DATA    PIC S9(13)V99   COMP-3.          0266932
102925     05  FILLER                  PIC X(27)       VALUE SPACES.    0266932
102926*                                                                 0266932
102927 01  WS-WBC-CLOSE-BALANCE        PIC S9(13)V99   COMP-3.          0827766
102929 01  NEW-WORK-FIELDS.                                             1105504
102930     03  NEW-OD-LIMIT            PIC S9(13)V99   COMP-3.          9915845
102931     03  ODSM-NOT-FOUND          PIC X(01)       VALUE SPACES.    1105504
102932     03  DLCA-DAYS               PIC S9(05)      COMP-3.          1105504
102933     03  RESERVE-AMT             PIC S9(13)V99   COMP-3.          9915845
102935 01  HOLD-RD-AMT                 PIC S9(13)V99   COMP-3.          9915845
102936 01  WS-REF-NO                   PIC S9(15)      COMP-3  VALUE +0.9915239
102937 01  WS-HOLD-DORM-FEE            PIC S9(13)V99   COMP-3.          1105504
102938 01  FUNDING-AMT-WK              PIC S9(13)V99   COMP-3.          9915845
102939 01  WS-FUNDING-USED             PIC S9(13)V99   COMP-3           9915845
102940                                                 VALUE +0.00.     1105504
102941 01  WS-FUND-TR                  PIC S9(13)V99   COMP-3           9915845
102942                                                 VALUE +0.00.     1105504
102943 01  WS-FIRST-DEBIT              PIC X           VALUE 'N'.       1105504
102944 01  WS-FIRST-LOC-ACT            PIC X           VALUE 'N'.       1105504
102945 01  BATCH-RUN-BALANCE           PIC S9(13)V99   COMP-3.          1105504
102946 01  BATCH-RUN-OD                PIC S9(13)V99   COMP-3.          9915845
102947 01  ACM-ABM-WORK-AREA.                                           1105504
102948     05  NB-REPAY-AMT            PIC S9(13)V99   COMP-3.          1105504
102949     05  NB-REPAY-CNT            PIC 9(08).                       1105504
102950     05  NB-ACD-DATE             PIC 9(06).                       1105504
102951     05  NB-ACD-DATE-R REDEFINES NB-ACD-DATE.                     1105504
102952         07  NB-ACD-DT-YY        PIC 9(02).                       1105504
102953         07  NB-ACD-DT-MM        PIC 9(02).                       1105504
102954         07  NB-ACD-DT-DD        PIC 9(02).                       1105504
102955     05  NB-BRW-CNT              PIC 9(08).                       1105504
102956     05  NB-BRW-AMT              PIC S9(13)V99   COMP-3.          1105504
102957     05  NB-WRK-BRW              PIC S9(13)V99   COMP-3.          1105504
102958     05  NB-ACF-ZIP.                                              1105504
102959         07  NB-ACF-1-5          PIC X(05).                       1105504
102960         07  FILLER              PIC X(01).                       1105504
102961         07  NB-ACF-6-10         PIC X(04).                       1105504
102962 01  WK-NEG-FEE-AMT              PIC S9(13)V99   COMP-3.          9915845
102963 01  WK-DEP-ACCM                 PIC S999        COMP-3.          9915749
102964 01  WK-OD-3RD-FOLLOWUP          PIC S999        COMP-3.          1105504
102965 01  HOLD-FEE-TYPE-NBR.                                           1105504
102966     03  HOLD-FEE-TYPE           PIC X(1).                        1105504
102967     03  HOLD-FEE-NBR            PIC X(3).                        1105504
102968                                                                  1105504
102969     COPY IMWSACMT.                                               1105504
102970                                                                  1105504
102971     COPY IMWACDLR.                                               1105504
102972                                                                  1105504
102973     COPY IMWKFTC.                                                1105504
102974                                                                  1105504
102975     COPY IMWSFEEM.                                               1105504
102976                                                                  1105504
102977     COPY IMWSBRRM.                                               1105504
102978                                                                  1105504
102979     COPY IMPRODFL.                                               1105504
102980                                                                  1105504
102981*----------------------------------------------------------------*1105504
102982*       IN-CORE TABLES BUILT FROM SORTED 'IMFTCM' TO BE USED     *1105504
102983*       AS A PART OF THE SERVICE CHARGE ROUTINES.                *1105504
102984*----------------------------------------------------------------*1105504
102985 01  WS-SRV-CHG-ACC                 PIC 9(03).                    1105504
102986**** OCCURRENCE WITHIN TABLE EQUALS ACCUMULATOR #1                1105504
102987 01  FEE-ACCUM-TABLE.                                             1105504
102988     03  FEE-TABLE-ITEM   OCCURS 200 TIMES                        1105504
102989                          INDEXED BY FEE-INX.                     1105504
102990         05  FEE-ACCUM-TYPE         PIC X(01).                    1105504
102991         05  FEE-ACCUM-NBR          PIC 9(03).                    1105504
102992         05  FEE-ACCUM-2            PIC 9(03).                    1105504
102993         05  FEE-ACCUM-COMPL-IND    PIC X(01).                    1105504
102994     03  FEE-ACCUM-MAX              PIC S9(3)     COMP-3.         9915845
102995 01  FEE-NUMBER-TABLE.                                            1105504
102996     03  FEE-NUMBER-ITEM  OCCURS 200 TIMES                        1105504
102997                          ASCENDING KEY IS FEE-NUMBER-NBR         1105504
102998                          INDEXED BY NBR-INX.                     1105504
102999         05  FEE-NUMBER-NBR         PIC 9(03).                    1105504
103000         05  FEE-NUMBER-ACCUM       PIC 9(03).                    1105504
103001     03  FEE-NBR-MAX                PIC S9(3)     COMP-3.         9915845
103002 01  EMSG-99.                                                     1105504
103003     03  FILLER  PIC X(39) VALUE                                  9915845
103004       'FEE TABLE RECORDS MISSING FOR CONTROL '.                  9915845
103005     03  E99-C1  PIC XX.                                          1105504
103006     03  FILLER  PIC X     VALUE '-'.                             1105504
103007     03  E99-C2  PIC XXX.                                         1105504
103008     03  FILLER  PIC X     VALUE '-'.                             1105504
103009     03  E99-C3  PIC XXX.                                         1105504
103010                                                                  1105504
103011*----------------------------------------------------------------*1105504
103012*       IN-CORE TABLES BUILT FROM 'IMPRDM' TO BE USED TO GET     *1105504
103013*       THE MUST CURRENT RESERVE RATE AND RRC THRESHOLD AMOUNT.  *1105504
103014*----------------------------------------------------------------*1105504
103015 01  PRODUCT-FILE-TABLE.                                          1105504
103016     03  PRD-TABLE-ITEM   OCCURS 50 TIMES                         1105504
103017                          INDEXED BY PRD-INX.                     1105504
103018         05  PRD-TYPE               PIC X(03).                    1105504
103019         05  PRD-RSRVE-RT           PIC S9V9(8)   COMP-3.         9915845
103020         05  PRD-THRESHOLD-AMT      PIC S9(13)V99 COMP-3.         9915845
103021         05  PRD-XINV-ALLOWED       PIC X.                        2016639
103022     03  PRD-NBR-MAX                PIC S9(3)     COMP-3.         2016639
103025*                                                                 9916451
103030 01  BATCH-RUN-BAL-OD-UPDATED       PIC X         VALUE 'N'.      9916451
103032 01  BATCH-OD-LIMIT                 PIC S9(13)V99 COMP-3.         0437237
103035*                                                                 9916451
103130******************************************************************9915845
103135***  THE FOLLOWING COPYBOOK MAY BE USED TO ISOLATE WORKING-STORAGE9915845
103140***  ENTRIES FOR ALL USER EXIT ROUTINES.                          9915845
103145***                                                               9915845
103150     COPY IM31UWS.                                                IMIB056
103152     COPY IM31UW.                                                 2010732
103153     COPY TSWSUBTB.                                               2010732
103155***                                                               9915845
103160***  END OF USER EXIT WORKING-STORAGE.                            9915845
103165******************************************************************9915845
103170*                                                                 9915845
103180******************************************************************9915845
103185***  THE FOLLOWING COPYBOOK MAY BE USED TO ISOLATE WORKING-STORAGE9915845
103190***  ENTRIES FOR INTERNATIONAL USER EXIT ROUTINES.                9915845
103195***                                                               9915845
103200     COPY IMNL31WS.                                               9915845
103205***                                                               9915845
103210***  END OF INTERNATIONAL EXIT WORKING-STORAGE.                   9915845
103215******************************************************************9915845
103220     EJECT                                                        9915845
103230 PROCEDURE DIVISION.                                              9915845
103240 INITIAL-SECTION     SECTION 49.                                  9915845
103250 A0001.
103300     MOVE PROGRAM-NAME TO SIMESS-PROGRAM.
103350     CALL 'SIMESS' USING SIMESS-AREA.
103360     MOVE SPACES TO WSSPLEX-LANGUAGE-CODE.                        9915845
103370     MOVE 'L'    TO WSSPLAR-EXT-FLAG.                             9915845
103400     PERFORM Z0040 THRU Z0060.
103450     MOVE 'E' TO I-O-CONTROL-OPERATOR.
103500     MOVE 'U' TO I-O-CONTROL-ACCESS.
103550     CALL 'IMBCRM' USING I-O-CONTROL-AREA,
103600                          DDA-WRKBCR-1.                           0266741
103650     MOVE '1' TO POST-COMPL.
103700     MOVE 'U' TO I-O-CONTROL-ACCESS.
103750     MOVE 'O' TO I-O-CONTROL-OPERATOR.
103800     CALL 'IMBCRM' USING I-O-CONTROL-AREA,
103850                          DDA-WRKBCR-4.                           0266741
103852     MOVE  DDA-WRKBCR-4  TO  DDA-WRKBCR-0.                        IMIBXX
103900     MOVE 'I' TO I-O-CONTROL-ACCESS.                              0447268
103950     MOVE 'O' TO I-O-CONTROL-OPERATOR.
104000     CALL 'IMPOSTS' USING I-O-CONTROL-AREA,
104050                          TRAN-FILE.
104052     MOVE 'O' TO I-O-CONTROL-ACCESS.                              0447268
104054     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            0447268
104056     CALL 'IMPOSTS' USING I-O-CONTROL-AREA,                       0447268
104058                          TRAN-FILE.                              0447268
104060     MOVE 'I' TO I-O-CONTROL-ACCESS.                              2016374
104070     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            2016374
104080     CALL 'IMBRTMS' USING I-O-CONTROL-AREA,                       2016374
104090                          BONUS-RATE-AREA.                        2016374
104100     MOVE 'O' TO I-O-CONTROL-ACCESS.
104150     MOVE 'O' TO I-O-CONTROL-OPERATOR.
104200     CALL 'IMTAGTS' USING I-O-CONTROL-AREA,
104250                          EXCEPTION-AREA.
104260     MOVE 'O' TO I-O-CONTROL-ACCESS.                              0902970
104270     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            0902970
104280     CALL 'IMGLTTS' USING I-O-CONTROL-AREA,                       0902970
104290                          GL-EXTRACT-RECORD.                      0902970
104291     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915868
104292     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915868
104293     CALL 'IMNMAMV' USING I-O-CONTROL-AREA,                       9915868
104294                          IMN-MASTER-RECORD.                      9915868
104300     MOVE 'I' TO I-O-CONTROL-ACCESS.
104350     MOVE 'O' TO I-O-CONTROL-OPERATOR.
104400     CALL 'SITBLMV' USING I-O-CONTROL-AREA,
104450                          SI-ENVIRONMENT-AREA.
104500     MOVE 'K' TO I-O-CONTROL-OPERATOR.
104550     CALL 'SITBLMV' USING I-O-CONTROL-AREA,
104600                          SI-ENVIRONMENT-AREA.
104650     IF  I-O-88-NOT-FOUND
104700         MOVE  501                   TO  SIMESS-MESS-NO
104750         SET   SIMESS-OPTIONAL-INDX  TO  02
104800         MOVE  SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)
104850                                     TO  SIMESS-OPTIONAL-MESSAGE
104900         CALL 'SIMESS' USING SIMESS-AREA.
104950     IF  SI-88-ENVIRONMENT-ONLINE   AND  SI-88-ENVIRONMENT-SEQ
105000         MOVE  501                   TO  SIMESS-MESS-NO
105050         MOVE  SI-ENVIRONMENT-AREA   TO  SIMESS-OPTIONAL-MESS3
105100         SET   SIMESS-OPTIONAL-INDX  TO  03
105150         MOVE  SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)
105200                                     TO  SIMESS-OPTIONAL-MESSAGE
105250         CALL 'SIMESS' USING SIMESS-AREA.
105251*                                                                 1003624
105252*  CHECK IF ONLINE MASTER GROUPING IS USED FOR THIS SSR           1003624
105253*                                                                 1003624
105254     MOVE 'TSSSRMV' TO SIWSBL-FILE-NAME.                          1003624
105255     MOVE 'IM'      TO SIWSBL-APPL-ID.                            1003624
105256     CALL 'SISSBLD' USING SIWSBL-APPL-PARMS                       1003624
105257                          SIWSBL-TABLE-AREA                       1003624
105258                          SIWSBL-STACK-TABLE.                     1003624
105259     IF  SIWSBL-RETURN-CODE NOT EQUAL '0'                         1003624
105260         MOVE 0501                  TO SIMESS-MESS-NO             1003624
105261         MOVE SIWSBL-RETURN-CODE    TO SIMESS-M10-CODE            1003624
105262         SET  SIMESS-OPTIONAL-INDX  TO  10                        1003624
105263         MOVE SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)               1003624
105264                                    TO  SIMESS-OPTIONAL-MESSAGE   1003624
105265         CALL 'SIMESS' USING SIMESS-AREA.                         1003624
105266******************************************************************1003624
105267**  FIND ALL MASTER GROUPS IN THE SSR TABLE                     **1003624
105268******************************************************************1003624
105270     MOVE '999999999999'  TO SIWSLK-ARGUMENT-CNTLS.               1003624
105271     MOVE SV-SEGMENT-NO   TO SIWSLK-ARGUMENT-SEGNO.               1003624
105272     MOVE '1'             TO SIWSLK-ACTION-FLAG-1.                1003624
105273     MOVE '7'             TO SIWSLK-ACTION-FLAG-2.                1003624
105278     CALL 'SISSLKP' USING SIWSLK-ACTION-PARAMETERS                1003624
105279                          SIWSBL-TABLE-AREA                       1003624
105280                          SIWSLK-RETURN-ENTRY.                    1003624
105281     IF  SIWSLK-LKP-RETURN-CODE EQUAL '0' OR '1' OR '2'           1003624
105282         NEXT SENTENCE                                            1003624
105283     ELSE                                                         1003624
105284         MOVE 0501                   TO SIMESS-MESS-NO            1003624
105285         MOVE SIWSLK-LKP-RETURN-CODE TO SIMESS-M11-CODE           1003624
105286         SET  SIMESS-OPTIONAL-INDX   TO 11                        1003624
105287         MOVE SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)               1003624
105288                                     TO SIMESS-OPTIONAL-MESSAGE   1003624
105289         CALL 'SIMESS' USING SIMESS-AREA.                         1003624
105290     SKIP1                                                        1003624
105291     MOVE SIWSLK-STACK-TABLE TO SV-MASTER-GROUPS.                 1003624
105292     SKIP1                                                        1003624
105293     IF  SV-MST-GRP-NO (2)  EQUAL LOW-VALUES                      1003624
105294     OR  (SI-ENVIRONMENT-SQVS EQUAL '0')                          1003624
105295     OR  (SI-ENVIRONMENT-EXCM EQUAL '0')                          1003624
105296         MOVE 'N' TO MASTER-GROUPING-SW                           1003624
105297     ELSE                                                         1003624
105298         MOVE 'Y' TO MASTER-GROUPING-SW.                          1003624
105300     IF  SI-88-ENVIRONMENT-ONLINE
105550         MOVE  'U'   TO  I-O-CONTROL-ACCESS
105600         MOVE  'O'   TO  I-O-CONTROL-OPERATOR
105650         CALL  'IMALPHA' USING I-O-CONTROL-AREA
105670                               SI-ENVIRONMENT-AREA                IM003
105700                               MASTER-AREA                        IM006
105706                              WBC-ONLINE-ALPHA-RECORD.            0266741
105707     IF  SI-88-ENVIRONMENT-ONLINE                                 1003624
105708         IF  MASTER-GROUPING-SW EQUAL 'N'                         1003624
105709             MOVE  'O'   TO  I-O-CONTROL-ACCESS                   1003624
105710             MOVE  'O'   TO  I-O-CONTROL-OPERATOR                 1003624
105711             CALL  'IMMEMMV' USING I-O-CONTROL-AREA               1003624
105712                                   IM-MEMO-OL-AREA                1003624
105713         ELSE                                                     1003624
105714             MOVE 'O' TO I-O-CONTROL-ACCESS                       1003624
105715             MOVE 'O' TO I-O-CONTROL-OPERATOR                     1003624
105716             MOVE 'IMMEMMV'    TO I-O-BASE-PROTOTYPE              1003624
105717                                  I-O-BASE-FILE-NAME              1003624
105718             CALL 'SISSLOP' USING SV-MASTER-GROUPS                1003624
105719                                  I-O-BASE                        1003624
105720                                  I-O-CONTROL-AREA                1003624
105721                                  IM-MEMO-OL-AREA.                1003624
105740     MOVE '2' TO SI-ENVIRONMENT-PSW.                              1003624
105750     MOVE 'O' TO I-O-CONTROL-OPERATOR.
105800     MOVE 'U' TO I-O-CONTROL-ACCESS.
105810     IF  MASTER-GROUPING-SW EQUAL 'N'                             1003624
105850         CALL 'IMACTM' USING I-O-CONTROL-AREA                     1003624
105900                             MASTER-AREA                          1003624
105950                             SI-ENVIRONMENT-AREA                  1003624
105951     ELSE                                                         1003624
105952         CALL 'IMACTS'  USING I-O-CONTROL-AREA                    1003624
105953                              MASTER-AREA                         1003624
105954                              SI-ENVIRONMENT-AREA                 1003624
105955                              I-O-BASE                            1003624
105956                              SV-MASTER-GROUPS.                   1003624
105960     MOVE 'O'                    TO  I-O-CONTROL-OPERATOR.        1004962
105962     MOVE 'I'                    TO  I-O-CONTROL-ACCESS.          1004962
105964     CALL 'IMSVCM'            USING  I-O-CONTROL-AREA             1004962
105966                                     DDA-WRKBCR-1                 0266741
105968                                     IM-SC-ACCESS                 9715464
105970                                     DUMMY-RECORD.                1004962
105971     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
105972     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
105973     CALL 'IMODSMV' USING I-O-CONTROL-AREA,                       9915749
105974                          DUMMY-RECORD.                           9915749
105980     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
105981     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
105982     CALL 'IMODLMV' USING I-O-CONTROL-AREA,                       9915749
105983                          TRANSFER-BALANCE-RECORD.                9915749
105990     MOVE 'O' TO I-O-CONTROL-ACCESS.                              9915749
105991     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
105992     CALL 'IMBRRMS' USING I-O-CONTROL-AREA,                       9915749
105993                          BANK-REPORTING-RECORD.                  9915749
105994     IF I-O-88-END-OF-FILE                                        9915749
105995         MOVE 501 TO  SIMESS-MESS-NO                              9915749
105996         MOVE SIMESS-OPTIONAL-MESS12 TO SIMESS-OPTIONAL-MESSAGE   9915749
105997         CALL 'SIMESS'  USING SIMESS-AREA.                        9915749
106000     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
106001     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106002     CALL 'IMFEEMV' USING I-O-CONTROL-AREA                        9915749
106003                          MULTIPLE-PRICE-FEE-TABLE.               9915749
106010     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
106011     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106012     CALL 'IMFTCMS' USING I-O-CONTROL-AREA                        9915749
106013                          FTC-RECORD.                             9915749
106020     MOVE 'O' TO I-O-CONTROL-ACCESS.                              9915749
106021     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106022     CALL 'IMACMTS' USING I-O-CONTROL-AREA                        9915749
106023                          IM-ACM-ABM-MONETARY.                    9915749
106030     MOVE 'O' TO I-O-CONTROL-ACCESS.                              9915749
106031     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106032     CALL 'IMACDTS' USING I-O-CONTROL-AREA                        9915749
106033                          IM-ACM-ABM-TRAN.                        9915749
106034     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915845
106035     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915845
106036     CALL 'IMLKPMV' USING I-O-CONTROL-AREA,                       9915845
106037                          DUMMY-RECORD.                           9915845
106040     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
106041     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106042     CALL 'IMRTEMV' USING I-O-CONTROL-AREA                        9915749
106043                          RATE-MASTER-AREA.                       9915749
106045     MOVE 'I' TO I-O-CONTROL-ACCESS.                              9915749
106046     MOVE 'O' TO I-O-CONTROL-OPERATOR.                            9915749
106047     CALL 'IMRTEWV' USING I-O-CONTROL-AREA                        9915749
106048                          RATE-WORK-FILE.                         9915749
106050     MOVE 'I'                  TO I-O-CONTROL-ACCESS.             9915855
106052     MOVE 'O'                  TO I-O-CONTROL-OPERATOR.           9915855
106054     CALL 'IMLMTMS' USING I-O-CONTROL-AREA                        9915855
106056                          OD-LIMIT-REC.                           9915855
106058     MOVE 'O'                  TO I-O-CONTROL-ACCESS.             9915855
106060     MOVE 'O'                  TO I-O-CONTROL-OPERATOR.           9915855
106062     CALL 'IMLMTMV' USING I-O-CONTROL-AREA                        9915855
106064                          OD-LIMIT-REC-OUT.                       9915855
106072     MOVE 'O'             TO  I-O-CONTROL-ACCESS.                 9915855
106074     MOVE 'O'             TO  I-O-CONTROL-OPERATOR.               9915855
106076     CALL 'IMIBTTS'    USING  I-O-CONTROL-AREA                    9915855
106078                              BALANCE-HISTORY-REC.                9915855
106080     COPY IMPD31U1.                                               IMIB056
106100     PERFORM C2180 THRU C2183.                                    9915855
106120     MOVE ZERO TO OD-CTR                                          9915855
106122                  ATM-POS-OD-CTR                                  1020116
106123                  ATM-POS-NSF-CTR                                 1020116
106124                  ATM-POS-DAU-CTR                                 1020116
106130                  DAU-CTR                                         9915855
106140                  NSF-CTR                                         9915855
106150                  CUR-BAL
106160                  COLL-BAL                                        0726713
106170                  CUST-BAL                                        IM003
106200                  TRANSFER-AMT
106250                  NSF-TOTAL
106300                  ACCR-NO-HOLD
106350                  LOAN-TODAY.
106400     MOVE '0' TO PAST-ACCR.
106470 A0010.                                                           1004554
106480     MOVE SPACES TO IM-MEMO-OL-KEY.                               1004554
106490     MOVE SPACES TO OD-LIMIT-REC.                                 9915855
106495     MOVE SPACES TO EXTENDED-FLOAT-REC.                           0927817
106500     MOVE SPACES TO MASTER-AREA
106550                    EXCEPTION-AREA
106600                    STATEMENT-REQUEST-TBL
106650                    EXCEPTION-INFORMATION
106700                    IM31-TOTALS.
106750     MOVE '1'    TO DDA-TOT-REC-ID.
106800     MOVE '2'    TO LOAN-TOT-REC-ID.
106850     MOVE '3'    TO T3-TOT-REC-ID.
106900     PERFORM Q0010 THRU Q0080.
106920     SET PM-INDX TO +1.                                           IM002
106930     SET PN-INDX TO +1.                                           1004015
106940 CLEAR-IM31-TOTALS.                                               9915855
106960     MOVE '1'  TO DDA-TOT-REC-ID.                                 0902297
106962     MOVE '0' TO FUNDING-FLAG                                     1105504
106965                 DB-WAITING.                                      1105504
106970     MOVE ZERO TO WS-FUNDING-USED.                                1105504
106975     MOVE SPACES TO SAVE-FUNDING-TRANS                            1105504
106980                    HOLD-FOR-FUNDING.                             1105504
106985     MOVE ZERO TO FUNDING-AMT.                                    1105504
107000     MOVE ZERO TO
107050             DDA-END-NO-ACCTS
107100             DDA-END-BAL
107150             DDA-END-ZERO-BAL
107200             DDA-END-CLOSED
107250             DDA-END-TERMIN
107300             DDA-END-DORM-NO
107350             DDA-END-DORM-BAL
107400             DDA-END-INACT-NO
107450             DDA-END-INACT-BAL
107500             DDA-END-MKT-NO
107550             DDA-END-MKT-BAL
107600             DDA-END-INT-NO
107650             DDA-END-INT-BAL
107700             DDA-END-BANK-AVAIL                                   IM007
107720             DDA-END-CUST-AVAIL                                   IM007
107800             DDA-ANALYSIS-NO
107850             DDA-ARP-NO
107900             DDA-NEW-ACCTS
107950             DDA-CLSD-ACCTS
108000             DDA-TERM-ACCTS
108050             DDA-DROP-ACCTS
108100             DDA-DB-NO
108150             DDA-DB-AMT
108200             DDA-UP-DB-NO
108250             DDA-UP-DB-AMT
108300             DDA-CR-NO
108350             DDA-CR-AMT
108400             DDA-UP-CR-NO
108450             DDA-UP-CR-AMT
108500             DDA-SVC-CHG-NO
108550             DDA-SVC-CHG-AMT
108600             DDA-CHK-CHG-NO
108650             DDA-CHK-CHG-AMT
108700             DDA-LIMIT-TRAN-NO
108750             DDA-LIMIT-TRAN-AMT
108800             DDA-OD-CHG-NO
108850             DDA-OD-CHG-AMT
108900             DDA-NSF-CHG-NO
108950             DDA-NSF-CHG-AMT
109000             DDA-INT-PAID-NO
109050             DDA-INT-PAID-AMT
109100             DDA-LOAN-NO
109150             DDA-LOAN-AMT
109200             DDA-LOAN-OVRPMT-NO
109250             DDA-LOAN-OVRPMT-AMT
109300             DDA-LOAN-PMT-NO
109350             DDA-LOAN-PMT-AMT
109400             DDA-MAINT-ACC
109450             DDA-MAINT-REJ
109500             DDA-INT-ACC-TODAY
109550             DDA-INT-PAID-TODAY
109600             DDA-INT-ACC-MTD
109650             DDA-INT-PAID-MTD
109700             DDA-INT-ACC-CY
109750             DDA-INT-PAID-YTD
109760             DDA-INT-ACC-YTD                                      1105132
109800             DDA-INT-RPTD-YTD
109850             DDA-INT-ACC-ADJ-EXT
109900             DDA-INT-ACC-ADJ-INT
109950             DDA-INT-YTD-ADJ
110000             DDA-BANK-AVAIL-AMT                                   IM007
110030             DDA-BANK-AVAIL-BUMP                                  IM007
110060             DDA-CUST-AVAIL-AMT                                   IM007
110090             DDA-CUST-AVAIL-BUMP                                  IM007
110120             DDA-BANK-AVAIL-ADJ                                   IM007
110150             DDA-CUST-AVAIL-ADJ                                   IM007
110300             DDA-SVC-CHG-WAV-NO
110350             DDA-SVC-CHG-WAV-AMT
110400             DDA-END-OD-NO
110450             DDA-END-OD-AMT
110500             DDA-BEG-OD-NO
110550             DDA-BEG-OD-AMT
110600             DDA-TARGET-PARNT-AMT-CR
110650             DDA-TARGET-PARNT-AMT-DB
110700             DDA-TARGET-PARNT-NO-CR
110750             DDA-TARGET-PARNT-NO-DB
110800             DDA-TARGET-SUBAC-AMT-CR
110850             DDA-TARGET-SUBAC-AMT-DB
110900             DDA-TARGET-SUBAC-NO-CR
110950             DDA-TARGET-SUBAC-NO-DB
111000             DDA-STMT-FORMAT (1)
111050             DDA-STMT-FORMAT (2)
111100             DDA-STMT-FORMAT (3)
111150             DDA-STMT-FORMAT (4)
111200             DDA-STMT-FORMAT (5)
111250             DDA-STMT-FORMAT (6)
111300             DDA-NO-ACTIVE
111350             IOD-INT-ACC-TODAY
111400             IOD-INT-PAID-TODAY
111450             IOD-INT-ACC-MTD
111500             IOD-INT-PAID-MTD
111550             IOD-INT-ACC-CY
111600             IOD-INT-PAID-YTD
111650             IOD-INT-RPTD-YTD
111660             IOD-INT-ACC-YTD                                      1105132
111700             IOD-INT-ACC-ADJ-EXT
111750             IOD-INT-ACC-ADJ-INT
111800             IOD-INT-YTD-ADJ
111850             IOD-END-NO-ACCTS
111900             IOD-END-INT-BAL
111950             IOD-END-INT-NO
111958             DDA-GEN-CLS-DR-NO                                    IM002
111966             DDA-GEN-CLS-DR-AMT                                   IM002
111974             DDA-GEN-CLS-CR-NO                                    IM002
111982             DDA-GEN-CLS-CR-AMT                                   IM002
111984             DDA-CMA-FEES-NBR                                     9916072
111986             DDA-CMA-FEES-AMT                                     9916072
111988             DDA-CMA-FEES-NBR-WV                                  9916072
111990             DDA-CMA-FEES-AMT-WV                                  9916072
112000             IOD-INT-PAID-NO
112050             IOD-INT-PAID-AMT
112100             IOD-TRANSFER-TO-NO
112150             IOD-TRANSFER-FROM-NO
112200             IOD-TRANSFER-TO-AMT
112250             IOD-TRANSFER-FROM-AMT
112300             IOD-DB-NO
112350             IOD-CR-NO
112400             IOD-CR-AMT
112450             IOD-DB-AMT
112500             IOD-END-BAL
112550             IOD-NEW-ACCTS
112600             IOD-DROP-ACCTS                                       IM007
112606             SERV-CHG-DORM-NO                                     1105504
112607             SERV-CHG-DORM-AMT                                    1105504
112608             DDA-END-CASH-AVAIL                                   IM007
112616             DDA-CASH-AVAIL-AMT                                   IM007
112624             DDA-CASH-AVAIL-BUMP                                  IM007
112632             DDA-CASH-AVAIL-ADJ                                   9915858
112634             DUAL-SV-INT-PAID-YTD                                 9915858
112636             DUAL-SV-INT-YTD-ADJ                                  9915858
112638             DUAL-IO-INT-PAID-YTD                                 9915858
112640             DUAL-IO-INT-YTD-ADJ                                  2016639
112642             T3-XINV-SD-IN-NO        T3-XINV-ND-IN-NO             2016639
112644             T3-XINV-SD-IN-AMT       T3-XINV-ND-IN-AMT            2016639
112646             T3-XINV-SD-OUT-NO       T3-XINV-ND-OUT-NO            2016639
112648             T3-XINV-SD-OUT-AMT      T3-XINV-ND-OUT-AMT           2016639
112650             T3-XINV-SD-PUR-AMT      T3-XINV-ND-PUR-AMT           2016639
112652             T3-XINV-SD-RDM-AMT      T3-XINV-ND-RDM-AMT           2016639
112654             T3-XINV-SD-EXT-ADJ-AMT  T3-XINV-ND-EXT-ADJ-AMT       2016639
112656             T3-XINV-SD-INT-ADJ-AMT  T3-XINV-ND-INT-ADJ-AMT       2016639
112658             T3-XINV-SD-END-NO       T3-XINV-ND-END-NO            2016639
112660             T3-XINV-SD-END-AMT      T3-XINV-ND-END-AMT           2016639
112662             T3-XINV-PUR-GEN-NO      T3-XINV-PUR-GEN-AMT          2016639
112664             T3-XINV-RDM-GEN-NO      T3-XINV-RDM-GEN-AMT.         2016639
112690 CLEAR-DDA-EXIT.                                                  2016639
112695     EXIT.                                                        2016639
112700 CLEAR-LOAN-TOTALS.
112710     MOVE '2'  TO LOAN-TOT-REC-ID.                                0902297
112750     MOVE ZERO TO
112800             LOAN-END-NO-ACCTS
112850             LOAN-END-PRIN
112900             LOAN-END-INTRST
112950             LOAN-END-OTHER
113000             LOAN-END-FEES
113050             LOAN-END-INS1
113100             LOAN-END-INS2
113150             LOAN-NO-ACTIVE
113200             LOAN-NO-ZERO-BAL
113250             LOAN-END-DDA-BAL
113300             LOAN-END-ACC-INT
113350             LOAN-END-APPR-CR
113400             LOAN-END-AVAL-CR
113450             LOAN-END-MTD-ERND
113500             LOAN-END-MTD-COLL
113550             LOAN-END-YTD-PAID
113600             LOAN-END-YTD-RPTD
113620             LOAN-END-YTD-ERND                                    1105132
113650             LOAN-YTD-INS1
113700             LOAN-YTD-INS2
113750             LOAN-YTD-FEES
113800             LOAN-END-OVR-NO
113850             LOAN-END-OVR-AMT
113900             LOAN-END-PD-NO
113950             LOAN-END-PD-AMT
114000             LOAN-CHG-OFF-NO
114050             LOAN-CHG-OFF-AMT
114100             LOAN-INT-ACC
114150             LOAN-NEW-NO
114200             LOAN-NEW-CR-LIM
114250             LOAN-TERM
114300             LOAN-PRIN-BILL
114350             LOAN-INT-BILL
114400             LOAN-OTH-BILL
114450             LOAN-PRIN-PAID
114500             LOAN-INT-PAID
114550             LOAN-OTH-PAID
114600             LOAN-MTD-FEES-BILL
114650             LOAN-MTD-INS1-BILL
114700             LOAN-MTD-INS2-BILL
114750             LOAN-DB-NO
114800             LOAN-DB-AMT
114850             LOAN-UP-DB-NO
114900             LOAN-UP-DB-AMT
114950             LOAN-CR-NO
115000             LOAN-CR-AMT
115050             LOAN-UP-CR-NO
115100             LOAN-UP-CR-AMT
115150             LOAN-TODAY-NO
115200             LOAN-TODAY-AMT
115250             LOAN-OVRPMT-NO
115300             LOAN-OVRPMT-AMT
115350             LOAN-FEES-CALCD-NOT-BLD
115400             LOAN-INS1-CALCD-NOT-BLD
115450             LOAN-INS2-CALCD-NOT-BLD
115500             LOAN-INTR-CALCD-NOT-BLD
115550             LOAN-GEN-FEE-NO
115600             LOAN-GEN-FEE-AMT
115650             LOAN-GEN-INT-NO
115700             LOAN-GEN-INT-AMT
115750             LOAN-GEN-INS1-NO
115800             LOAN-GEN-INS1-AMT
115850             LOAN-GEN-INS2-NO
115900             LOAN-GEN-INS2-AMT
115950             LOAN-AUTO-PMT-NO
116000             LOAN-AUTO-PMT-AMT
116050             LOAN-INT-ACC-ADJ-EXT
116100             LOAN-INT-ACC-ADJ-INT
116150             LOAN-INT-ACC-WAV
116200             LOAN-INT-YTD-ADJ
116250             LOAN-PRIME-NO
116300             LOAN-PRIME-AMT
116350             SAV-END-NO-ACCTS
116400             SAV-END-BALANCE
116450             SAV-DR-NO
116500             SAV-DR-AMT
116550             SAV-UN-DR-NO
116600             SAV-UN-DR-AMT
116650             SAV-CR-NO
116700             SAV-CR-AMT
116750             SV-NO-ZERO-BAL
116800             SAV-UN-CR-NO
116850             SAV-UN-CR-AMT
116900             DDA-GEN-TRAN-DR-NO
116950             DDA-GEN-TRAN-DR-AMT
117000             MTD-DDA-EXTERNAL-NO
117050             MTD-DDA-EXTERNAL-AMT
117100             MTD-DDA-INTERNAL-NO
117150             DDA-GEN-TRAN-CR-NO
117200             DDA-GEN-TRAN-CR-AMT
117250             MTD-DDA-INTERNAL-AMT
117300             MTD-SAV-INTERNAL-NO
117350             MTD-SAV-INTERNAL-AMT
117400             PLANA-ACCTS
117450             DDA-GEN-TRANS-CHG-NO
117500             DDA-GEN-TRANS-CHG-AMT
117550             SAV-NEW-NO
117600             SAV-TERM
117650             AFFIL-TRLR-NO
117700             AFFIL-TRLR-ACCTS
117750             BANK-AVAIL-TRLR-NO                                   IM007
117800             ZERO-BAL-TRLR-NO
117850             LN-GEN-CLS-ADJ-NO
117900             LN-GEN-CLS-ADJ-AMT
117950             DDA-DESC-NO
118000             DDA-ACH-NO
118050             DDA-ADDENDA-NO
118100             DDA-ATM-NO
118150             LOAN-DR-PRIN
118200             LOAN-DR-INT
118250             LOAN-DR-OTH
118300             LOAN-CR-PRIN
118350             LOAN-CR-INT
118400             LOAN-CR-OTH
118450             IOD-TAX-NO
118460             IOD-TAX-NO-ST                                        2012254
118470             IOD-TAX-NO-LOC                                       2012254
118500             IOD-TAX-AMT
118510             IOD-TAX-AMT-ST                                       2012254
118520             IOD-TAX-AMT-LOC                                      2012254
118550             IOD-TAX-ADJ-UP-NO
118560             IOD-TAX-ADJ-UP-NO-ST                                 2012254
118570             IOD-TAX-ADJ-UP-NO-LOC                                2012254
118600             IOD-TAX-ADJ-UP-AMT
118610             IOD-TAX-ADJ-UP-AMT-ST                                2012254
118620             IOD-TAX-ADJ-UP-AMT-LOC                               2012254
118650             IOD-TAX-ADJ-DN-NO
118660             IOD-TAX-ADJ-DN-NO-ST                                 2012254
118670             IOD-TAX-ADJ-DN-NO-LOC                                2012254
118700             IOD-TAX-ADJ-DN-AMT
118710             IOD-TAX-ADJ-DN-AMT-ST                                2012254
118720             IOD-TAX-ADJ-DN-AMT-LOC                               2012254
118750             IOD-TAX-YTD-END
118760             IOD-TAX-YTD-END-ST                                   2012254
118770             IOD-TAX-YTD-END-LOC                                  2012254
118800             IOD-TAX-CY
118810             IOD-TAX-CY-ST                                        2012254
118820             IOD-TAX-CY-LOC                                       2012254
118850             IOD-TAX-MTD
118860             IOD-TAX-MTD-ST                                       2012254
118870             IOD-TAX-MTD-LOC                                      2012254
118900             IOD-TAX-YTD-PREV
118910             IOD-TAX-YTD-PREV-ST                                  2012254
118920             IOD-TAX-YTD-PREV-LOC                                 2012254
118950             SAV-TAX-NO
118960             SAV-TAX-NO-ST                                        2012254
118970             SAV-TAX-NO-LOC                                       2012254
119000             SAV-TAX-AMT
119010             SAV-TAX-AMT-ST                                       2012254
119020             SAV-TAX-AMT-LOC                                      2012254
119050             SAV-TAX-ADJ-UP-NO
119060             SAV-TAX-ADJ-UP-NO-ST                                 2012254
119070             SAV-TAX-ADJ-UP-NO-LOC                                2012254
119100             SAV-TAX-ADJ-UP-AMT
119110             SAV-TAX-ADJ-UP-AMT-ST                                2012254
119120             SAV-TAX-ADJ-UP-AMT-LOC                               2012254
119150             SAV-TAX-ADJ-DN-NO
119160             SAV-TAX-ADJ-DN-NO-ST                                 2012254
119170             SAV-TAX-ADJ-DN-NO-LOC                                2012254
119200             SAV-TAX-ADJ-DN-AMT
119210             SAV-TAX-ADJ-DN-AMT-ST                                2012254
119220             SAV-TAX-ADJ-DN-AMT-LOC                               2012254
119250             SAV-TAX-YTD-END
119260             SAV-TAX-YTD-END-ST                                   2012254
119270             SAV-TAX-YTD-END-LOC                                  2012254
119300             SAV-TAX-CY
119310             SAV-TAX-CY-ST                                        2012254
119320             SAV-TAX-CY-LOC                                       2012254
119350             SAV-TAX-MTD
119360             SAV-TAX-MTD-ST                                       2012254
119370             SAV-TAX-MTD-LOC                                      2012254
119400             SAV-TAX-YTD-PREV                                     IM003
119402             SAV-TAX-YTD-PREV-ST                                  2012254
119404             SAV-TAX-YTD-PREV-LOC                                 2012254
119410             DDA-DAU-CHG-NO                                       IM003
119420             DDA-DAU-CHG-AMT                                      IM005
119426             LOAN-PRIN-AMT-WV                                     IM005
119432             LOAN-INT-AMT-WV                                      IM005
119438             LOAN-OTH-AMT-WV                                      IM006
119440             IOD-CHECKS-NO                                        IM006
119442             IOD-CHECKS-AMT                                       IM006
119444             SAV-CHECKS-NO                                        IM006
119446             SAV-CHECKS-AMT                                       9715253
119448             SERV-CHG-EC-NO                                       9715253
119450             SERV-CHG-EC-AMT                                      9915828
119455             YTD-IOD-INT-1042                                     9915828
119460             YTD-SAV-INT-1042                                     9915858
119462             DUAL-IO-TAX-ADJ-UP-NO                                9915858
119464             DUAL-IO-TAX-ADJ-UP-NO-ST                             2012254
119466             DUAL-IO-TAX-ADJ-UP-NO-LOC                            2012254
119468             DUAL-IO-TAX-ADJ-UP-AMT                               2012254
119470             DUAL-IO-TAX-ADJ-UP-AMT-ST                            2012254
119472             DUAL-IO-TAX-ADJ-UP-AMT-LOC                           2012254
119474             DUAL-IO-TAX-ADJ-DN-NO                                2012254
119476             DUAL-IO-TAX-ADJ-DN-NO-ST                             2012254
119478             DUAL-IO-TAX-ADJ-DN-NO-LOC                            2012254
119480             DUAL-IO-TAX-ADJ-DN-AMT                               2012254
119482             DUAL-IO-TAX-ADJ-DN-AMT-ST                            2012254
119484             DUAL-IO-TAX-ADJ-DN-AMT-LOC                           2012254
119486             DUAL-IO-TAX-YTD-END                                  2012254
119488             DUAL-IO-TAX-YTD-END-ST                               2012254
119490             DUAL-IO-TAX-YTD-END-LOC                              2012254
119492             DUAL-IO-TAX-YTD-PREV                                 2012254
119494             DUAL-IO-TAX-YTD-PREV-ST                              2012254
119496             DUAL-IO-TAX-YTD-PREV-LOC                             2012254
119498             DUAL-SV-TAX-ADJ-UP-NO                                2012254
119500             DUAL-SV-TAX-ADJ-UP-NO-ST                             2012254
119502             DUAL-SV-TAX-ADJ-UP-NO-LOC                            2012254
119504             DUAL-SV-TAX-ADJ-UP-AMT                               2012254
119506             DUAL-SV-TAX-ADJ-UP-AMT-ST                            2012254
119508             DUAL-SV-TAX-ADJ-UP-AMT-LOC                           2012254
119510             DUAL-SV-TAX-ADJ-DN-NO                                2012254
119512             DUAL-SV-TAX-ADJ-DN-NO-ST                             2012254
119514             DUAL-SV-TAX-ADJ-DN-NO-LOC                            2012254
119516             DUAL-SV-TAX-ADJ-DN-AMT                               2012254
119518             DUAL-SV-TAX-ADJ-DN-AMT-ST                            2012254
119520             DUAL-SV-TAX-ADJ-DN-AMT-LOC                           2012254
119522             DUAL-SV-TAX-YTD-END                                  2012254
119524             DUAL-SV-TAX-YTD-END-ST                               2012254
119526             DUAL-SV-TAX-YTD-END-LOC                              2012254
119528             DUAL-SV-TAX-YTD-PREV                                 2012254
119530             DUAL-SV-TAX-YTD-PREV-ST                              2012254
119532             DUAL-SV-TAX-YTD-PREV-LOC                             0336977
119534             YTD-DIV-INT-1042.                                    0336977
119545 CLEAR-LOAN-EXIT.                                                 9915828
119547     EXIT.                                                        9915828
119550 CLEAR-INOUT-TOTALS.
119560     MOVE '3'  TO T3-TOT-REC-ID.                                  0902297
119600     MOVE ZERO TO
119650         OD-ACCRD-CY                 OD-ACCRD-TODAY
119700         OD-ACCRL-ADJ-EXTRNL         OD-ACCRL-ADJ-INTRNL
119750         OD-ACCRUED-MTD              OD-CHARGED-CY
119800         OD-BEG-ACCT-BAL             OD-END-ACCT-BAL
119850         OD-BEG-ACCT-NO              OD-END-ACCT-NO
119900         OD-CHARGED-YTD              OD-CHARGED-MTD
119950         OD-CHRGS-ADJ-YTD            OD-CHARGED-TODAY
119960         OD-CHARGED-TODAY-NO         OD-ACCRUED-YTD               1105132
120000         IN-DDA-END-NO-ACCTS         OUT-DDA-END-NO-ACCTS
120050         IN-DDA-END-BAL              OUT-DDA-END-BAL
120100         IN-LN-END-NO-ACCTS          OUT-LN-END-NO-ACCTS
120150         IN-LN-END-PRIN              OUT-LN-END-PRIN
120200         IN-LN-END-INTRST            OUT-LN-END-INTRST
120250         IN-LN-END-OTHER             OUT-LN-END-OTHER
120300         IN-LN-END-ACC-INT           OUT-LN-END-ACC-INT
120350         IN-LN-END-YTD-PAID          OUT-LN-END-YTD-PAID
120400         IN-SAV-END-NO-ACCTS         OUT-SAV-END-NO-ACCTS
120450         IN-SAV-END-BALANCE          OUT-SAV-END-BALANCE
120500         IN-DDA-INT-ACC              OUT-DDA-INT-ACC
120550         IN-DDA-INT-PAID-YTD         OUT-DDA-INT-PAID-YTD
120600         IN-IOD-END-NO-ACCTS         OUT-IOD-END-NO-ACCTS
120650         IN-IOD-END-BAL              OUT-IOD-END-BAL
120700         IN-IOD-INT-ACC              OUT-IOD-INT-ACC
120750         IN-IOD-PAID-YTD             OUT-IOD-PAID-YTD
120800         IN-IOD-YTD-TAX              OUT-IOD-YTD-TAX
120810         IN-IOD-YTD-TAX-ST           OUT-IOD-YTD-TAX-ST           2012254
120820         IN-IOD-YTD-TAX-LOC          OUT-IOD-YTD-TAX-LOC          2012254
120850         IN-LN-END-FEES              OUT-LN-END-FEES
120900         IN-LN-END-INS1              OUT-LN-END-INS1
120950         IN-LN-END-INS2              OUT-LN-END-INS2
121000         IN-OD-ACCRL-ACCT-BAL        OUT-OD-ACCRL-ACCT-BAL
121050         IN-OD-ACCRL-CHGD-YTD        OUT-OD-ACCRL-CHGD-YTD
121100         IN-OD-ACCRL-CHRGD-CY        OUT-OD-ACCRL-CHRGD-CY
121150         IN-OD-ACCRL-INT-BAL         OUT-OD-ACCRL-INT-BAL
121200         IN-OD-ACCRL-NO-ACCTS        OUT-OD-ACCRL-NO-ACCTS
121250         IN-OD-END-BAL               OUT-OD-END-BAL
121300         IN-OD-END-NO-ACCTS          OUT-OD-END-NO-ACCTS
121350         IN-SV-YTD-TAX               OUT-SV-YTD-TAX               IM003
121352         IN-SV-YTD-TAX-ST            OUT-SV-YTD-TAX-ST            2012254
121354         IN-SV-YTD-TAX-LOC           OUT-SV-YTD-TAX-LOC           2012254
121360         DDA-STOP-CHGS-POSTED        DDA-STOP-CHGS-NO             IM003
121370         DDA-STOP-CHGS-WAIVED        DDA-STOP-CHGS-NO-WV          IM006
121372         DDA-CLOSE-CHG-NO            DDA-CLOSE-CHG-AMT            0527322
121376         LOAN-BEG-COSTS              LOAN-NEW-COSTS               IM006
121382         LOAN-AMORT-COSTS            LOAN-ADJ-COSTS               IM006
121388         LOAN-END-COSTS              LOAN-AMORT-TODAY             IM006
121392         LOAN-NEG-AMORT              USER-AMOUNT-1                0902297
121393         USER-AMOUNT-2   USER-AMOUNT-3   USER-AMOUNT-4            0902297
121394         USER-AMOUNT-5   USER-AMOUNT-6   USER-AMOUNT-7            0902297
121395         USER-AMOUNT-8   USER-AMOUNT-9   USER-AMOUNT-10           0902297
121396         USER-COUNT-1    USER-COUNT-2    USER-COUNT-3             0902297
121397         USER-COUNT-4    USER-COUNT-5    USER-COUNT-6             0902297
121398         USER-COUNT-7    USER-COUNT-8    USER-COUNT-9             0902297
121399         USER-COUNT-10                INV-BEG-SVC-ACCRD           1004554
121400         INV-SVC-ADJ-EXTL             INV-SVC-ADJ-INTL            1004554
121401         INV-SVC-ACCRD-TDY            INV-SVC-ACCRD-CYC           1004554
121402         INV-SVC-ACCRD-MTD            INV-SVC-COLL-TDY            1004554
121403         INV-SVC-COLL-CYC             INV-SVC-COLL-MTD            1004554
121404         INV-SVC-COLL-YTD             INV-SVC-RPTD-YTD            1004554
121405         INV-SVC-ADJ-YTD              INV-BEG-AMT                 1004554
121406         INV-END-NO                   INV-END-AMT                 1004554
121407         INV-XFER-IN-AMT              INV-XFER-OUT-AMT            1004554
121408         INV-IN-SVC-ACCRD             INV-OUT-SVC-ACCRD           1004554
121409         INV-IN-SVC-YTD               INV-OUT-SVC-YTD             1004554
121410         INV-IN-DIV-ACCRD             INV-OUT-DIV-ACCRD           1004554
121411         INV-IN-DIV-YTD               INV-OUT-DIV-YTD             1004554
121412         INV-DIV-ACCRD-BEG            INV-DIV-ACCRD-END           1004554
121413         INV-DIV-ACCRD-TDY            INV-DIV-EXTL-ADJ            1004554
121414         INV-DIV-INTL-ADJ             INV-DIV-PAID-TDY            1004554
121415         INV-DIV-ACCRD-MTD            INV-DIV-PAID-MTD            1004554
121416         INV-DIV-PAID-YTD-BEG         INV-DIV-PAID-YTD-END        1004554
121417         INV-DIV-PAID-YTD-ADJ         INV-DIV-RPTD-YTD            1004554
121418         INV-DIV-ACCRD-YTD                                        1105132
121419         INV-TAX-YTD-BEG              INV-TAX-YTD-END             1105132
121420         INV-TAX-YTD-BEG-ST           INV-TAX-YTD-END-ST          2012254
121421         INV-TAX-YTD-BEG-LOC          INV-TAX-YTD-END-LOC         2012254
121422         INV-TAX-ADJ-UP               INV-TAX-ADJ-DN              2012254
121423         INV-TAX-ADJ-UP-ST            INV-TAX-ADJ-DN-ST           2012254
121424         INV-TAX-ADJ-UP-LOC           INV-TAX-ADJ-DN-LOC          2012254
121425         INV-TAX-COLL-TDY             INV-TAX-YTD-RPTD            2012254
121426         INV-TAX-COLL-TDY-ST          INV-TAX-YTD-RPTD-ST         2012254
121427         INV-TAX-COLL-TDY-LOC         INV-TAX-YTD-RPTD-LOC        2012254
121428         INV-CR-AMT                   INV-DR-AMT                  2012254
121429         INV-CR-NO                    INV-DR-NO                   2012254
121430         LOAN-EXT-NO                  LOAN-EXT-CHRG               2012254
121431         IBT-DDA-DR-NO-IN            IBT-BNK-NO-IN                2012254
121432         IBT-DDA-DR-AMT-IN           IBT-BNK-AMT-IN               9915845
121433         IBT-SAV-DR-NO-IN            IBT-CUS-NO-IN                2012254
121434         IBT-SAV-DR-AMT-IN           IBT-CUS-AMT-IN               2012254
121435         IBT-LON-DR-NO-IN            IBT-BNK-ADJ-NO-IN            2012254
121436         IBT-LON-DR-AMT-IN           IBT-BNK-ADJ-AM-IN            2012254
121437         IBT-DDA-CR-NO-IN            IBT-CUS-ADJ-NO-IN            2012254
121438         IBT-DDA-CR-AMT-IN           IBT-CUS-ADJ-AM-IN            2012254
121439         IBT-SAV-CR-NO-IN            IBT-NW-ACCT-POSTD            2012254
121440         IBT-SAV-CR-AMT-IN           IBT-96-TRAN-POSTD            2012254
121441         IBT-LON-CR-NO-IN            IBT-LON-CR-AMT-IN            2012254
121442         IBT-DDA-DR-NO-TRN           IBT-DDA-CR-NO-TRN            2012254
121443         IBT-DDA-DR-AMT-TRN          IBT-DDA-CR-AMT-TRN           2012254
121444         IBT-SAV-DR-NO-TRN           IBT-SAV-CR-NO-TRN            2012254
121445         IBT-SAV-DR-AMT-TRN          IBT-SAV-CR-AMT-TRN           2012254
121446         IBT-LON-DR-NO-TRN           IBT-LON-CR-NO-TRN            2012254
121447         IBT-LON-DR-AMT-TRN          IBT-LON-CR-AMT-TRN           2012254
121448         IBT-CAS-ADJ-NO-IN           IBT-CAS-ADJ-AM-IN            2012254
121449         DUAL-IN-SV-INT-PAID-YTD     DUAL-OUT-SV-INT-PAID-YTD     2012254
121450         DUAL-IN-IO-INT-PAID-YTD     DUAL-OUT-IO-INT-PAID-YTD     2012254
121451         DUAL-IN-SV-YTD-TAX          DUAL-OUT-SV-YTD-TAX          2012254
121452         DUAL-IN-SV-YTD-TAX-ST       DUAL-OUT-SV-YTD-TAX-ST       2012254
121453         DUAL-IN-SV-YTD-TAX-LOC      DUAL-OUT-SV-YTD-TAX-LOC      2012254
121454         DUAL-IN-IOD-YTD-TAX         DUAL-OUT-IOD-YTD-TAX         2012254
121455         DUAL-IN-IOD-YTD-TAX-ST      DUAL-OUT-IOD-YTD-TAX-ST      2012254
121456         DUAL-IN-IOD-YTD-TAX-LOC     DUAL-OUT-IOD-YTD-TAX-LOC     0617360
121457         T3-PLAN-BEG-NO              T3-PLAN-BEG-AMT              0617360
121458         T3-PLAN-END-NO              T3-PLAN-END-AMT              0617360
121459         T3-PLAN-NEW-NO                                           0617360
121460         T3-PLAN-CRD-AMT             T3-PLAN-DEB-AMT              0617360
121461         T3-PLAN-BEG-ACC             T3-PLAN-END-ACC              0617360
121462         T3-PLAN-MTD-ACC             T3-PLAN-MTD-PAID             0617360
121463         T3-PLAN-YTD-ACC             T3-PLAN-YTD-PAID             0617360
121464         T3-PLAN-BEG-YTD-TAX         T3-PLAN-END-YTD-TAX          0617360
121465         IN-PLN-END-NO-ACCTS         OUT-PLN-END-NO-ACCTS         0617360
121466         IN-PLN-END-BALANCE          OUT-PLN-END-BALANCE          0617360
121467         IN-PLN-INT-ACC              OUT-PLN-INT-ACC              0617360
121468         IN-PLN-INT-PAID-YTD         OUT-PLN-INT-PAID-YTD         0737661
121469         USER-AMOUNT-11  USER-AMOUNT-12  USER-AMOUNT-13           0737661
121470         USER-AMOUNT-14  USER-AMOUNT-15  USER-AMOUNT-16           0737661
121471         USER-AMOUNT-17  USER-AMOUNT-18  USER-AMOUNT-19           0737661
121472         USER-AMOUNT-20  USER-AMOUNT-21  USER-AMOUNT-22           0737661
121473         USER-AMOUNT-23  USER-AMOUNT-24  USER-AMOUNT-25           0737661
121474         USER-AMOUNT-26  USER-AMOUNT-27  USER-AMOUNT-28           0737661
121475         USER-AMOUNT-29  USER-AMOUNT-30  USER-AMOUNT-31           0737661
121476         USER-AMOUNT-32  USER-AMOUNT-33  USER-AMOUNT-34           0737661
121477         USER-AMOUNT-35  USER-AMOUNT-36  USER-AMOUNT-37           0737661
121478         USER-AMOUNT-38  USER-AMOUNT-39  USER-AMOUNT-40           0737661
121479         USER-AMOUNT-41  USER-AMOUNT-42  USER-AMOUNT-43           0737661
121480         USER-AMOUNT-44                                           0737661
121483         USER-COUNT-11   USER-COUNT-12   USER-COUNT-13            0737661
121484         USER-COUNT-14   USER-COUNT-15   USER-COUNT-16            0737661
121485         USER-COUNT-17   USER-COUNT-18   USER-COUNT-19            0737661
121486         USER-COUNT-20   USER-COUNT-21   USER-COUNT-22            0737661
121487         USER-COUNT-23   USER-COUNT-24   USER-COUNT-25            0737661
121488         USER-COUNT-26   USER-COUNT-27   USER-COUNT-28            0737661
121489         USER-COUNT-29   USER-COUNT-30   USER-COUNT-31            0737661
121490         USER-COUNT-32   USER-COUNT-33   USER-COUNT-34            0737661
121491         USER-COUNT-35   USER-COUNT-36   USER-COUNT-37            0737661
121492         USER-COUNT-38   USER-COUNT-39   USER-COUNT-40            0737661
121493         USER-COUNT-41   USER-COUNT-42   USER-COUNT-43            0737661
121494         USER-COUNT-44.                                           0737661
121498 CLEAR-TOTALS-EXIT.                                               0737661
121499     EXIT.                                                        0737661
121500     EJECT
121505 CLEAR-TFR-TOTALS.                                                1004773
121510     MOVE ZERO TO                                                 1004773
121515         WK-RCK06A0-AMT              WK-RCK06D0-AMT               1004773
121520         WK-RCK06A0-NO               WK-RCK06D0-NO                1004773
121525         WK-RCK06A0-AVG              WK-RCK06D0-AVG               1004773
121530         WK-RCK06E0-AMT              WK-RCK1000-AMT               1004773
121535         WK-RCK06E0-NO               WK-RCK1000-NO                1004773
121540         WK-RCK06E0-AVG              WK-RCK1000-AVG               1004773
121542         WK-RCK11A0-AMT              WK-RCK11A0-NO                1004773
121544         WK-RCK11A0-AVG.                                          1004773
121545     PERFORM Y5000-10-TFRCSI-CLEAR-TOTALS THRU Y5000-10-EXIT.     2015719
121546 CLEAR-TFR-EXIT.                                                  1004773
121548     EXIT.                                                        1004773
121549     EJECT                                                        1004773
121550 CLEAR-INTERNATIONAL-TOTALS.                                      9915845
121552     MOVE ZERO TO                                                 9915845
121554                  NO-LN-GEN-DR-CAP-INT                            9915852
121556                  AMT-LN-GEN-DR-CAP-INT                           9915852
121558                  NO-LN-GEN-CR-CAP-INT                            9915852
121560                  AMT-LN-GEN-CR-CAP-INT.                          9915852
121570 CLEAR-INTL-EXIT. EXIT.                                           9915845
121575     EJECT                                                        9915845
121590 A0050.                                                           9915845
121600     MOVE ZEROS TO WS-GL-AMT (1).                                 0902970
121700     MOVE WS-GL-AMOUNTS TO WS-GL-AMT-2-437.                       0737661
121800     MOVE ZEROS TO WS-GL-CNT (1).                                 0902970
121900     MOVE WS-GL-COUNTS TO WS-GL-CNT-2-213.                        0737661
121950 A0050-EXIT.                                                      0902970
121960     EXIT.                                                        0902970
122350 A0099.
123800     EJECT
123850 ROOT-SECTION-A      SECTION 1.
123950 C0500.                                                           9915845
124000     SKIP1                                                        9915845
124050*  --THE MASTER READ ROUTINE RESETS THE SKIP-READ-SW IF IT IS '1' 9915845
124100     SKIP1                                                        9915845
124150     MOVE '0' TO NEW-ACCT-REJ-SW, OL-DELETE-SW.                   9915845
124170     MOVE '0' TO TIS-STMT-SW, TIS-SV-STMT-SW.                     9915845
124200     IF  MST-EOF EQUAL TO HIGH-VALUE, GO TO C0600.                9915845
124250     IF  SKIP-READ-SW NOT EQUAL '1'                               9915845
124300         MOVE 'R' TO I-O-CONTROL-OPERATOR                         9915845
124350         CALL 'IMACTM' USING I-O-CONTROL-AREA,                    9915845
124400                             MASTER-AREA,                         9915845
124450                             SI-ENVIRONMENT-AREA                  9915845
124500         IF I-O-88-END-OF-FILE                                    9915845
124550             MOVE 'E' TO SKIP-READ-SW                             9915845
124600         ELSE                                                     9915845
124650             MOVE '0' TO SKIP-READ-SW                             9915845
124700     ELSE                                                         9915845
124750         MOVE  'N'    TO I-O-CONTROL-OPERATOR                     9915845
124800         CALL  'IMACTM'  USING  I-O-CONTROL-AREA,                 9915845
124850                                MASTER-AREA,                      9915845
124900                                SI-ENVIRONMENT-AREA               9915845
124950         MOVE '0' TO SKIP-READ-SW.                                9915845
125000     IF  SKIP-READ-SW EQUAL TO 'E'                                9915845
125050         MOVE HIGH-VALUES TO MST-CONTROL, WMS-CONTROL-KEY         9915845
125100     ELSE                                                         9915845
125150         MOVE WMS-CONTROL-KEY TO MST-CONTROL.                     9915845
125200     SKIP3                                                        9915845
125250 C0600.
125260*    MOVE 'N' TO WS-MAINT-ON-0660-TDY.                            ~~~0179
125300* --   "SKIP-READ-MEMO" CONTROLS ON-LINE MEMO-FILE PROCESSING :
125350* --        '1' = NO MEMO RECORD FOUND.
125400* --        '0' = MEMO RECORD FOUND.
125450     SKIP2
125500     MOVE '1' TO SKIP-READ-MEMO.
125550* --   IF THERE IS A NEW ACCOUNT THAT'S NOT ON THE MASTER FILE,
125600* --   MOVE A '1' TO SKIP-READ-SW AND SKIP GETTING A MEMO FILE
125650* --   BECAUSE THERE SHOULD BE DIRECT RELATIONSHIP BETWEEN THE
125700* --   MASTER AND THE MEMO.
125750     IF  MST-CONTROL  GREATER  THAN  TRN-CONTROL
125800         MOVE TRN-CONTROL        TO  LOW-CONTROL
125850         MOVE  '1'               TO  SKIP-READ-SW
125900         GO TO C0700.                                             0927817
125950     SKIP2
126000     MOVE MST-CONTROL  TO  LOW-CONTROL.
126011     IF  WMS-EXC-CODE EQUAL '1'                                   9915845
126012         IF (WMS-IBT-FLAG EQUAL '1' OR '3')                       9915845
126013             MOVE WMS-IBT-FLAG TO SAVE-IBT-FLG                    9915845
126014             MOVE '1' TO IBT-ACCT-IND                             9915845
126016         ELSE                                                     9915845
126018         IF  WMS-IBT-FLAG EQUAL '2'                               9915845
126020             MOVE '2' TO IBT-ACCT-IND, SAVE-IBT-FLG               9915857
126021         ELSE                                                     9915857
126022             MOVE '0' TO IBT-ACCT-IND, SAVE-IBT-FLG.              9915857
126024******************************************************************9915845
126026***   IBT-ACCT-IND VALUES AND MEANINGS ARE:                       9915845
126028***    0 - NOT AN IBT ACCOUNT                                     9915845
126030***    1 - IBT ACCOUNT AWAITING CONFIRMATION (OLD OR NEW ACCT)    9915845
126032***    2 - OLD IBT ACCOUNT AWAITING PURGE (EXPIRATION OF RET DAYS)9915845
126034***    3 - OLD IBT ACCOUNT ON DAY OF CONFIRMATION AFTER CONFIRMED 9915845
126038******************************************************************9915845
126050     IF  NOT SI-88-ENVIRONMENT-ONLINE OR
126150         MST-EOF EQUAL HIGH-VALUES
126200         GO TO C0700.                                             0927817
126300 C0610.
127205     IF  NOT IM-MEMO-OL-NEW-ACCT                                  IM003
127210         GO TO C0700.                                             0927817
127215     IF  TRN-CONTROL GREATER THAN WMS-CONTROL-KEY                 IM008
127220         MOVE '1' TO OL-DELETE-SW                                 IM003
127225         GO TO R0010.                                             IM003
127230     IF  TRN-CONTROL EQUAL WMS-CONTROL-KEY                        IM008
127235         IF  TR-CLASS EQUAL '01'                                  IM003
127240         AND UPLINE-REJ-SW NOT EQUAL '0'                          IM003
127245             MOVE '1' TO OL-DELETE-SW.                            IM003
127250     SKIP2
127300     COPY IM31FFRD.                                               0927817
127350 C0800.
127355     MOVE '0000000000'      TO WMS-IT-TRAN-FLAGS.                 9915749
127370     COPY IM31BHRD.                                               0902213
127400     SKIP1
127405 C0850-OD-LIMIT-FILE-PROCESSING.                                  9915855
127414     IF  OD-LIMIT-CONTROLS EQUAL HIGH-VALUES                      9915855
127416         GO TO C0860-EXIT.                                        9915855
127418     IF  OD-LIMIT-KEY GREATER THAN LOW-CONTROL                    9915855
127420         MOVE '0' TO WS-OD-LIMIT-MATCH-SW                         9915855
127422         GO TO C0860-EXIT.                                        9915855
127424     IF  OD-LIMIT-KEY EQUAL LOW-CONTROL                           9915855
127426         MOVE '1' TO WS-OD-LIMIT-MATCH-SW                         9915855
127428         GO TO C0860-EXIT.                                        9915855
127429     IF  WS-OD-LIMIT-MATCH-SW EQUAL '0'                           9915855
127430         GO TO C0852.                                             9915855
127431 C0851-OD-READ.                                                   9915855
127432     MOVE 'I'                  TO I-O-CONTROL-ACCESS.             9915855
127434     MOVE 'R' TO I-O-CONTROL-OPERATOR.                            9915855
127436     CALL 'IMLMTMS' USING I-O-CONTROL-AREA                        9915855
127438                          OD-LIMIT-REC.                           9915855
127440     IF  I-O-88-END-OF-FILE                                       9915855
127442         MOVE HIGH-VALUES TO OD-LIMIT-KEY, OD-LIMIT-REC-ID        9915855
127444         MOVE '0' TO WS-OD-LIMIT-MATCH-SW                         9915855
127445         GO TO C0860-EXIT.                                        9915855
127446     IF  OD-LIMIT-KEY EQUAL LOW-VALUES OR ZEROES                  0516946
127447         GO TO C0851-OD-READ.                                     0516946
127448 C0852.                                                           0516946
127449     IF  OD-LIMIT-KEY GREATER THAN  LOW-CONTROL                   0516946
127450         MOVE '0' TO WS-OD-LIMIT-MATCH-SW                         0516946
127451         GO TO C0860-EXIT.                                        0516946
127454     IF  OD-LIMIT-KEY  LESS THAN  LOW-CONTROL                     9915855
127455         IF WBC-PROCESS-FLAG EQUAL TO '0' OR '2'                  0266741
127456             PERFORM C2472-WRITE-OD-FILE  THRU C2472-EXIT         9915855
127457             GO TO C0851-OD-READ                                  9915855
127458         ELSE                                                     9915855
127459         IF  OD-LIMIT-REC-CHG-TODAY EQUAL '4'                     9915855
127460         AND OD-LIMIT-DELETE NOT  EQUAL 'A'                       9915855
127461             MOVE 'OK'            TO IMEX-CODE-1                  9915855
127462             PERFORM C0854-WRT-EX THRU C0854-EXIT                 9915855
127464             MOVE 'A'             TO  OD-LIMIT-DELETE             9915855
127466             PERFORM C2472-WRITE-OD-FILE  THRU C2472-EXIT         9915855
127468             GO TO C0851-OD-READ                                  9915855
127470         ELSE                                                     9915855
127472             MOVE 'OP'            TO  IMEX-CODE-1                 9915855
127474             PERFORM C0854-WRT-EX THRU C0854-EXIT                 9915855
127476             MOVE 002             TO  SIMESS-MESS-NO              9915855
127478             MOVE OD-LIMIT-KEY    TO  SIMESS-OPTIONAL-MESS13      9915855
127480             MOVE SIMESS-MESS13   TO  SIMESS-OPTIONAL-MESSAGE     9915855
127482             CALL 'SIMESS'     USING  SIMESS-AREA                 9915855
127486             GO TO C0851-OD-READ.                                 9915855
127488     MOVE '1' TO WS-OD-LIMIT-MATCH-SW.                            9915855
127490     IF  OD-LIMIT-DELETE EQUAL 'A'                                9915855
127492         MOVE 'N'                 TO  OD-LIMIT-DELETE.            9915855
127494     GO TO C0860-EXIT.                                            9915855
127496 C0854-WRT-EX.                                                    9915855
127500     MOVE OD-LIMIT-KEY     TO IMEX-KEY.                           9915855
127502     MOVE '46'             TO IMEX-REC-NO.                        9915855
127504     MOVE HIGH-VALUES      TO IMEX-CODE-2.                        9915855
127506     MOVE OD-LIMIT-FIXED-AREA TO EX46-DATA.                       9915855
127508     PERFORM CALL-IM31RDWR THRU WRITE-EX-EXIT.                    9915855
127510 C0854-EXIT.  EXIT.                                               9915855
127512 C0860-EXIT.  EXIT.                                               9915855
127514     SKIP1                                                        9915855
127520 C0870.                                                           9915855
127530     IF  NEW-BK-NO-TRN-FLAG EQUAL '1'                             9915855
127540         MOVE HOLD-1-3      TO IMEX-KEY                           9915855
127550         PERFORM C1004      THRU C1009-EXIT                       0902970
127600         MOVE SPACES        TO IMEX-INFO, GL-CURRENT-COST-CTR     0902970
127650         GO                 TO Y0300.                             IM008
127700     IF LOW-1-3 EQUAL TO PREV-1-3, GO TO C2010.
127750     SKIP3
127800 CONTROL-BREAK-SECT  SECTION 48.
127850     SKIP3
127900 C1000.
127950     IF HDR-FLAG EQUAL TO '1'
128000     AND HDR-ID EQUAL TO '1'
128050         MOVE '0' TO HDR-FLAG
128100         MOVE LOW-1-3 TO PREV-1-3
128150         GO TO C2010.
128200     IF FIRST-READ-SW EQUAL TO '1'
128250         MOVE '0' TO FIRST-READ-SW
128300         MOVE LOW-1-3 TO PREV-1-3
128350         GO TO Y0200.                                             IM008
128413     IF WBC-PROCESS-FLAG EQUAL TO '0' OR '2', GO TO C1010.        0266741
128415*----------------------------------------------------------------*1003625
128420*    THE FOLLOWING TWO LINES ARE INSERTED TO WRITE EXCEPTIONS    *1003625
128421*    OUT OF THE TRIAL BALANCE PHASE IN THE CORRECT SEQUENCE      *IM004
128428*----------------------------------------------------------------*IM004
128435     MOVE '6' TO TRIAL-CODE.                                      IM004
128442     PERFORM CALL-TRIAL-BAL THRU CALL-TRIAL-END.                  IM004
128450     MOVE PREV-1-3 TO IMEX-KEY.
128500 C1003.
128950 C1004.
129000     MOVE ZEROES TO IMEX-CTL4, IMEX-ACCT-NO.
129250     MOVE '20' TO IMEX-REC-NO.
129300     MOVE 'ST31' TO IMEX-EX-CODE.
129350     MOVE EX-20 TO IMEX-LENGTH.
129351     MOVE TOTAL-RECORD-1 TO IMEX-RECORD.                          0902970
129400     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.
129410     MOVE SPACES         TO IMEX-RECORD.                          0326947
129450     MOVE TOTAL-RECORD-2 TO IMEX-RECORD.                          0902970
129600     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.
129610     MOVE SPACES         TO IMEX-RECORD.                          0326947
129650     MOVE TOTAL-RECORD-3 TO IMEX-RECORD.                          0902970
129800     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.
130150     MOVE '17' TO IMEX-REC-NO.
130200     MOVE 'DY' TO IMEX-CODE-1.
130250     MOVE HIGH-VALUES TO IMEX-CODE-2.
130300     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.
130400     MOVE '0' TO EX-MST-CTL.
130410     PERFORM CLEAR-IM31-TOTALS THRU CLEAR-DDA-EXIT.               0902970
130420     PERFORM CLEAR-LOAN-TOTALS THRU CLEAR-LOAN-EXIT.              0902970
130430     PERFORM CLEAR-INOUT-TOTALS THRU CLEAR-TOTALS-EXIT.           0902970
130440     PERFORM CLEAR-INTERNATIONAL-TOTALS THRU CLEAR-INTL-EXIT.     9915845
130450 C1008-EXIT.
130500     EXIT.
130510 C1009.                                                           0902970
130511     ADD +1  TO  GL-TOTAL-CTR.                                    0902970
130512     IF  GL-TOTAL-CTR  GREATER THAN RECAP-CODE-AMT-SIZE           9715253
130515         MOVE +0 TO GL-TOTAL-CTR                                  0902970
130517         GO TO C1009-CHECK-COUNTS.                                0902970
130518     IF  WS-GL-AMT (GL-TOTAL-CTR) NOT EQUAL ZERO                  0902970
130519       IF  GL-AMT-CODES (GL-TOTAL-CTR) NOT EQUAL SPACES           0902970
130520         ADD +1  TO  GL-WRITE-TOTAL-CTR                           0902970
130522         MOVE '*****'  TO  GL-RECAP-ACCT (GL-WRITE-TOTAL-CTR)     0902970
130524         MOVE WS-GL-AMT (GL-TOTAL-CTR) TO                         0902970
130526                               GL-RECAP-AMT (GL-WRITE-TOTAL-CTR)  0902970
130528         MOVE GL-AMT-CODES (GL-TOTAL-CTR) TO                      0902970
130530                               GL-RECAP-CODE (GL-WRITE-TOTAL-CTR) 0902970
130532         IF  GL-WRITE-TOTAL-CTR  GREATER THAN 49                  0902970
130534             MOVE 'IM' TO GL-APPL-ID                              0902970
130535             MOVE WBC-CURR-CODE   TO GL-CURR-CD                   0266741
130536             MOVE WBC-CURR-DEC    TO GL-CURR-DEC                  0266741
130537             MOVE GL-COST-CTR (1) TO GL-APPL-CTL1                 0902970
130538             MOVE GL-CURRENT-COST-CTR TO GL-APPL-GL-KEY           0902970
130540             PERFORM C1009-GL-DATE THRU C1009-GL-DATE-EXIT        0266688
130542             MOVE 'R' TO GL-REC-KEY                               0902970
130543             MOVE WK-GL-ORIG-ACCT TO GL-ORIG-ACCT                 0902970
130546             MOVE GL-WRITE-TOTAL-CTR TO GL-CURR-NO                0902970
130547             COMPUTE GL-REC-LNGTH = (GL-CURR-NO * 22) + 100       9915845
130548             COMPUTE GL-REC-LENGTH = GL-REC-LNGTH + 4             0902970
130549             MOVE 'L'  TO  I-O-CONTROL-OPERATOR                   0902970
130550             CALL 'IMGLTTS'  USING  I-O-CONTROL-AREA,             0902970
130551                                    GL-EXTRACT-RECORD             0902970
130552             MOVE ZEROS TO GL-WRITE-TOTAL-CTR                     0902970
130553                 GO TO C1009                                      0902970
130554         ELSE                                                     0902970
130555             GO TO C1009                                          0902970
130556       ELSE                                                       0902970
130557           GO TO C1009                                            0902970
130558     ELSE                                                         0902970
130559         GO TO C1009.                                             0902970
130560 C1009-CHECK-COUNTS.                                              0902970
130561     ADD +1  TO  GL-TOTAL-CTR.                                    0902970
130562     IF  GL-TOTAL-CTR  GREATER THAN RECAP-CODE-CNT-SIZE           9715253
130563         MOVE +0 TO GL-TOTAL-CTR                                  0902970
130564         GO TO C1009-CHECK-WRITE.                                 0902970
130566     IF  WS-GL-CNT (GL-TOTAL-CTR) NOT EQUAL ZERO                  0902970
130567       IF  GL-CNT-CODES (GL-TOTAL-CTR) NOT EQUAL SPACES           0902970
130568         ADD +1  TO  GL-WRITE-TOTAL-CTR                           0902970
130570         MOVE '*****'  TO  GL-RECAP-ACCT (GL-WRITE-TOTAL-CTR)     0902970
130571         MOVE  ZEROS   TO  GL-RECAP-AMT (GL-WRITE-TOTAL-CTR)      0902970
130572         MOVE WS-GL-CNT (GL-TOTAL-CTR) TO                         0902970
130574                               GL-RECAP-CNT (GL-WRITE-TOTAL-CTR)  0902970
130576         MOVE GL-CNT-CODES (GL-TOTAL-CTR) TO                      0902970
130578                               GL-RECAP-CODE (GL-WRITE-TOTAL-CTR) 0902970
130580         IF  GL-WRITE-TOTAL-CTR  GREATER THAN 49                  0902970
130582             MOVE 'IM' TO GL-APPL-ID                              0902970
130583             MOVE WBC-CURR-CODE   TO GL-CURR-CD                   0266741
130584             MOVE WBC-CURR-DEC    TO GL-CURR-DEC                  0266741
130585             MOVE GL-COST-CTR (1) TO GL-APPL-CTL1                 0902970
130587             MOVE GL-CURRENT-COST-CTR TO GL-APPL-GL-KEY           0902970
130588             PERFORM C1009-GL-DATE THRU C1009-GL-DATE-EXIT        0266688
130590             MOVE 'R' TO GL-REC-KEY                               0902970
130592             MOVE WK-GL-ORIG-ACCT TO GL-ORIG-ACCT                 0902970
130594             MOVE GL-WRITE-TOTAL-CTR TO GL-CURR-NO                0902970
130595             COMPUTE GL-REC-LNGTH = (GL-CURR-NO * 22) + 100       9915845
130596             COMPUTE GL-REC-LENGTH = GL-REC-LNGTH + 4             0902970
130597             MOVE 'L'  TO  I-O-CONTROL-OPERATOR                   0902970
130598             CALL 'IMGLTTS'  USING  I-O-CONTROL-AREA,             0902970
130600                                    GL-EXTRACT-RECORD             0902970
130602             MOVE ZEROS TO GL-WRITE-TOTAL-CTR                     0902970
130606                 GO TO C1009-CHECK-COUNTS                         0902970
130612         ELSE                                                     0902970
130614             GO TO C1009-CHECK-COUNTS                             0902970
130615       ELSE                                                       0902970
130616           GO TO C1009-CHECK-COUNTS                               0902970
130617     ELSE                                                         0902970
130618         GO TO C1009-CHECK-COUNTS.                                0902970
130620 C1009-CHECK-WRITE.                                               0902970
130622     IF  GL-WRITE-TOTAL-CTR  GREATER THAN ZERO                    0902970
130624         MOVE 'IM' TO GL-APPL-ID                                  0902970
130625         MOVE WBC-CURR-DEC    TO GL-CURR-DEC                      0266741
130626         MOVE GL-COST-CTR (1) TO GL-APPL-CTL1                     9915845
130627         MOVE GL-COST-CTR (1) TO GL-APPL-CTL1                     0902970
130629         MOVE GL-CURRENT-COST-CTR TO GL-APPL-GL-KEY               0902970
130630         PERFORM C1009-GL-DATE THRU C1009-GL-DATE-EXIT            0266688
130632         MOVE 'R' TO GL-REC-KEY                                   0902970
130633         MOVE WK-GL-ORIG-ACCT TO GL-ORIG-ACCT                     0902970
130636         MOVE GL-WRITE-TOTAL-CTR TO GL-CURR-NO                    0902970
130637         COMPUTE GL-REC-LNGTH = (GL-CURR-NO * 22) + 100           9915845
130638         COMPUTE GL-REC-LENGTH = GL-REC-LNGTH + 4                 0902970
130639         MOVE 'L'  TO  I-O-CONTROL-OPERATOR                       0902970
130640         CALL 'IMGLTTS'  USING  I-O-CONTROL-AREA,                 0902970
130641                                GL-EXTRACT-RECORD                 0902970
130642         MOVE ZEROS TO GL-WRITE-TOTAL-CTR.                        0902970
130643     PERFORM A0050 THRU A0050-EXIT.                               0902970
130644 C1009-EXIT.                                                      0902970
130646     EXIT.                                                        0902970
130650 C1009-GL-DATE.                                                   0266688
130652     MOVE WBC-CAPTURE-MO         TO  GL-APPL-EFF-MO.              0266741
130654     MOVE WBC-CAPTURE-DA         TO  GL-APPL-EFF-DA.              0266741
130656     MOVE WBC-CAPTURE-YR         TO  GL-APPL-EFF-YR.              0266741
130658     IF WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                 0266741
130660         MOVE '20'               TO  GL-APPL-EFF-CENT             0266688
130662     ELSE                                                         0266688
130664         MOVE '19'               TO  GL-APPL-EFF-CENT.            0266688
130666 C1009-GL-DATE-EXIT.                                              0266688
130668     EXIT.                                                        0266688
130670 C1010.                                                           0266688
130675     MOVE LOW-1-3 TO PREV-1-3.                                    0266688
130680     MOVE SPACES TO IMEX-INFO.                                    0266688
130700 C1020.
130750     IF LOW-1 NOT EQUAL TO HOLD-1 AND
130800         NEW-BK-NO-TRN-FLAG EQUAL '0'
130820             MOVE '9' TO TRIAL-CODE                               IM004
130850             GO TO Y0100.                                         IM008
130900     IF WBC-CTL2-FLAG NOT EQUAL TO '2', GO TO C1040.              0266741
130950     IF LOW-2 NOT EQUAL TO HOLD-2 AND
131000         NEW-BK-NO-TRN-FLAG EQUAL '0'
131020             MOVE '8' TO TRIAL-CODE                               IM004
131050             GO TO Y0100.                                         IM008
131100 C1040.
131150     IF WBC-CTL3-FLAG NOT EQUAL TO '2', GO TO C2000.              0266741
131200     IF LOW-3 NOT EQUAL TO HOLD-3 AND
131250         NEW-BK-NO-TRN-FLAG EQUAL '0'
131270             MOVE '7' TO TRIAL-CODE                               IM004
131300             GO TO Y0100.                                         IM008
131350 C2000.
131360     PERFORM UO-TABLE-LOAD THRU UO-TABLE-LOAD-EXIT.               2010732
131400     MOVE WBC-LEAP-YEAR TO LEAP-YEAR-FLAG.                        0266741
131450     IF  BCR-BRK-SW EQUAL '0'
131500         GO TO C2010.
131550     MOVE '0' TO BCR-BRK-SW.
131560     MOVE '0' TO MASS-PROD-MAINT.                                 IM002
131565     MOVE '0' TO MASS-NOTICES-SW.                                 1004015
131570     MOVE +0 TO PMT-TBL-CTR.                                      IM002
131575     MOVE +0 TO PNT-TBL-CTR.                                      1004015
131580     SET PM-INDX TO +1.                                           IM002
131590     SET PN-INDX TO +1.                                           1004015
131600     IF NEW-BANK-SW EQUAL '0' GO TO C2003.
131650     MOVE '0' TO NEW-BANK-SW.
131700     IF HDR-ID EQUAL '1' OR MST-EOF EQUAL HIGH-VALUE
131750         GO TO C2001.
131800     IF MST-1 GREATER THAN HOLD-1 GO TO C2001.
131850     IF WBC-CTL2-FLAG EQUAL '2' AND MST-2 GREATER THAN HOLD-2     0266741
131900         GO TO C2001.
131950     IF WBC-CTL3-FLAG EQUAL '2' AND MST-3 GREATER THAN HOLD-3     0266741
132000         GO TO C2001.
132050     GO TO Z2400.
132100 C2001.
132150     MOVE '1' TO SKIP-READ-SW.
132200     MOVE SPACES TO DDA-HEADER-RECORD.
132250     MOVE WS-MSTR-HEADER-LNGTH TO WMS-LENGTH.                     0903291
132300     MOVE LOW-VALUES TO WMS-BIN0.
132350     MOVE HOLD-CONTROL TO HDR-KEY.
132400     MOVE '0' TO HDR-ID.
132450     MOVE '1' TO HDR-FLAG.
132452     MOVE 'N' TO RW-SW.                                           0817741
132454     IF WBC-BAL-HIST-FLAG NOT EQUAL '0'                           0266741
132458         IF WBC-PROCESS-FLAG EQUAL '1'                            0266741
132462             MOVE WBC-CURR-FILE-SEQ TO BHH-FILE-SEQ               0266741
132466         ELSE                                                     0903152
132470             MOVE WBC-PREV-FILE-SEQ TO BHH-FILE-SEQ.              0266741
132474     IF WBC-BAL-HIST-FLAG NOT EQUAL '0'                           0266741
132478         MOVE +31 TO BH-LENGTH                                    0903152
132482         MOVE 'O' TO I-O-CONTROL-ACCESS                           0903152
132486         MOVE 'L' TO I-O-CONTROL-OPERATOR                         0903152
132490         CALL 'IMBALM'     USING  I-O-CONTROL-AREA                9915845
132492                                  BALANCE-HISTORY-REC             9915845
132494                                  BAL-HIST-LENGTHS                9915845
132496                                  SI-ENVIRONMENT-AREA             0447266
132498                                  DDA-WRKBCR-1.                   0447266
132502     IF  WBC-EXTEND-FLOAT-OPT GREATER THAN '0'                    0927817
132504         IF  WBC-PROCESS-FLAG EQUAL '1'                           0927817
132506             MOVE WBC-CURR-FILE-SEQ  TO FFH-FILE-SEQ              0927817
132508         ELSE                                                     0927817
132510             MOVE WBC-PREV-FILE-SEQ  TO FFH-FILE-SEQ.             0927817
132512     IF  WBC-EXTEND-FLOAT-OPT GREATER THAN '0'                    0927817
132514         MOVE +30                TO FF-LENGTH                     0927817
132516         MOVE 'O'                TO I-O-CONTROL-ACCESS            0927817
132518         MOVE 'L'                TO I-O-CONTROL-OPERATOR          0927817
132520         CALL 'IMAFFMV'       USING I-O-CONTROL-AREA              0927817
132522                                    EXTENDED-FLOAT-REC.           0927817
132540     GO TO C2005.                                                 0927817
132550 C2003.
132600     IF HDR-ID NOT EQUAL TO '0'
132650         IF WBC-PROCESS-FLAG EQUAL TO '1'                         0266741
132700             GO TO Z2400
132750         ELSE
132800             GO TO C2010.
132850     MOVE '1' TO HDR-FLAG.
132900     MOVE WBC-PREV-FILE-SEQ       TO HOLD-NO5.                    0266741
133100     IF HOLD-NO5 NOT EQUAL TO HDR-FILE-SEQ, GO TO Z2400.
133115     IF  WBC-BAL-HIST-FLAG EQUAL '1'                              0266741
133130         IF  HOLD-NO5 NOT EQUAL BHH-FILE-SEQ                      0902213
133145             GO TO Z2700.                                         0902213
133146     IF  WBC-BAL-HIST-FLAG NOT EQUAL '0'                          0266741
133147         IF WBC-PROCESS-FLAG EQUAL '1'                            0266741
133148             MOVE WBC-CURR-FILE-SEQ TO BHH-FILE-SEQ.              0266741
133149     IF  WBC-BAL-HIST-FLAG NOT EQUAL '0'                          0266741
133150         MOVE +31 TO BH-LENGTH                                    0903152
133152         MOVE 'O' TO I-O-CONTROL-ACCESS                           0903152
133154         MOVE 'L' TO I-O-CONTROL-OPERATOR                         0903152
133155         CALL 'IMBALM'     USING  I-O-CONTROL-AREA                0447266
133156                                  BALANCE-HISTORY-REC             0447266
133157                                  BAL-HIST-LENGTHS                0447266
133158                                  SI-ENVIRONMENT-AREA             0447266
133159                                  DDA-WRKBCR-1.                   0447266
133160     IF  OD-LIMIT-REC-ID EQUAL '0'                                9915855
133161     AND OD-LIMIT-CONTROLS EQUAL HOLD-CONTROL                     9915855
133162         IF  HOLD-NO5 NOT EQUAL OD-LIMIT-HDR-FILE-SEQ             9915855
133164             GO TO Z2750.                                         9915855
133166     IF  WBC-EXTEND-FLOAT-OPT EQUAL '1'                           0927817
133168         IF  HOLD-NO5     NOT EQUAL FFH-FILE-SEQ                  0927817
133170             GO TO Z2760.                                         0927817
133172     IF  WBC-EXTEND-FLOAT-OPT NOT EQUAL '0' AND ' '               0927817
133174         IF  WBC-PROCESS-FLAG EQUAL '1'                           0927817
133176             MOVE WBC-CURR-FILE-SEQ TO FFH-FILE-SEQ.              0927817
133178     IF  WBC-EXTEND-FLOAT-OPT GREATER THAN '0'                    0927817
133180         MOVE +30 TO FF-LENGTH                                    0927817
133182         MOVE 'O' TO I-O-CONTROL-ACCESS                           0927817
133184         MOVE 'L' TO I-O-CONTROL-OPERATOR                         0927817
133186         CALL 'IMAFFMV'    USING  I-O-CONTROL-AREA                0927817
133188                                  EXTENDED-FLOAT-REC.             0927817
133190     IF  WBC-PROCESS-FLAG  EQUAL '0' OR '2'                       0927817
133192         GO TO C2010.                                             0927817
133200 C2005.
133220     IF WBC-IM28-COMP EQUAL TO '0' OR ' ' , GO TO Z2600.          0266741
133300     MOVE WBC-DATA-CENTER-ID TO HDR-DATA-CENTER-ID.               0266741
133350     MOVE WBC-GROUP TO HDR-GROUP.                                 0266741
133400     MOVE WBC-CURR-FILE-SEQ TO HDR-FILE-SEQ.                      0266741
133450     MOVE WBC-SYSTEM-DATE TO HDR-SYSTEM-DATE.                     0266741
133500     MOVE WBC-SYSTEM-TIME TO HDR-SYSTEM-TIME.                     0266741
133550     MOVE WBC-MONTH-END TO HDR-EOM.                               0266741
133600     MOVE WBC-QUARTER-END TO HDR-EOQ.                             0266741
133650     MOVE WBC-YEAR-END TO HDR-EOY.                                0266741
133651     IF  WBC-ALT-DUAL-YEAR-END EQUAL '1'                          0266741
133652         IF  WBC-YEAR-END EQUAL '1'                               0266741
133653             MOVE '3'  TO HDR-EOY                                 9915858
133654         ELSE MOVE '2' TO HDR-EOY.                                9915858
133655     MOVE WBC-PROCESS-THRU-DATE TO HDR-PROCESS-THRU-DATE.         0266741
133660     MOVE SPACES TO IM-MEMO-HEADER-RECORD.                        1003624
133670     MOVE HDR-AREA-FIXED TO IM-MEMO-HEADER-RECORD.                1003624
133680     MOVE '1' TO EX-MST-CTL.                                      1004470
133690     MOVE '3' TO SAVE-MASTER-FLAG.                                1004470
133700     PERFORM WRITE-DDA-MASTER THRU WRITE-DDA-EXIT.
133720     MOVE HDR-AREA-FIXED       TO OD-LMT-OUT-HEADER.              9915855
133730     MOVE WS-MSTR-HEADER-LNGTH TO OD-LMT-OUT-LENGTH.              9915855
133740     MOVE LOW-VALUES           TO OD-LMT-OUT-LNGTH-LOW.           9915855
133750     PERFORM C2476-WRITE-OD-LMT THRU C2476-EXIT.                  9915855
133790 C2005-EXIT. EXIT.                                                0902213
133800 C2006.
133805     IF WBC-GL-RC-PHASE  EQUAL  SPACES                            0266741
133810         MOVE PROGRAM-NAME TO SIMESS-PROGRAM                      0902970
133815         MOVE 505 TO SIMESS-MESS-NO                               0902970
133820         MOVE 'NO GL RECAP PHASE' TO SIMESS-OPTIONAL-MESSAGE      0902970
133825         CALL 'SIMESS' USING SIMESS-AREA                          0902970
133830         GO TO Z9900.                                             0902970
133835     MOVE WBC-GL-RC-PHASE  TO  IM31-PH2.                          0266741
133840     CALL 'SILINK' USING IM31-PHASE                               0902970
133845                         RECAP-CODE-TABLE.                        0902970
133850     MOVE TRIAL-FORM TO TRIAL-PREV.
133900     IF WBC-IM31-FORM EQUAL TO TRIAL-FORM, GO TO C0500.           0266741
133920     MOVE WBC-IM31-FORM TO TRIAL-FORM.                            0266741
134000*****************************************************************
134050*    MOVE BC-IM31-FORM TO F01-TR.                               * IM008
134100*    MOVE HOLD-1 TO F01-C1.                                     *
134150*    MOVE HOLD-2 TO F01-C2.                                     *
134200*    MOVE HOLD-3 TO F01-C3.                                     *
134250*****************************************************************
134300     GO TO C0500.
134350     SKIP3
134400 ROOT-SECTION-O      SECTION 1.
134450     SKIP3
134500 C2010.
134550     MOVE '0' TO HDR-FLAG.
134600     IF WBC-PROCESS-FLAG EQUAL TO '0' OR '2'                      0266741
134606         IF  TR-CLASS EQUAL '22' AND                              IM002
134612             TRN-CONTROL EQUAL LOW-CONTROL                        IM002
134618             PERFORM Z2200 THRU Z2200-EXIT                        IM002
134624             PERFORM Q4600 THRU Q0080                             0447268
134630             MOVE '0' TO SKIP-READ-SW                             IM002
134636             GO  TO  C0600                                        IM002
134642         ELSE                                                     IM002
134650         IF MST-EOF NOT EQUAL TO HIGH-VALUE
134700             GO TO WRITE-DDA-MASTER.
134750     IF SKIP-READ-SW EQUAL TO '1' OR IM-MEMO-OL-NEW-ACCT
134800         GO TO G0010.
134810     IF  IBT-ACCT-IND EQUAL '1'                                   9915845
134811     AND SAVE-IBT-FLG EQUAL '3'                                   0316973
134812         GO  TO  C3000.                                           9915845
134850 C2100.
134900******************************************************************
134910***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE INCOMING   1003625
134920***  MASTER RECORDS PRIOR TO POSTING.                             1003625
134930***                                                               1003625
134940     COPY IM31UBWR.                                               IMIB004
134950***                                                               1003625
134960***  END OF USER EXIT.                                            1003625
134970******************************************************************1003625
134981     MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE.                        0627537
134982     PERFORM X0100-6-TO-8-LO.                                     0617360
134984     MOVE C-LOW-DATE TO HOLD-CAPT-DATE.                           0617360
135000     IF WMS-STATUS EQUAL TO '05'                                  1003625
135005         MOVE '99' TO WMS-STATUS                                  1003625
135010         GO TO C2180.                                             1003625
135013     MOVE 'Y' TO EXISTING-ACCT-SW.                                0627539
135014     IF  WMS-LEAP-YEAR-FLG EQUAL 'X'                              0627539
135015         MOVE WMS-DATE-OPENED TO WK-OPEN-DATE                     0627539
135016         PERFORM CHECK-366 THRU C366-EXIT                         0627539
135017         MOVE WK-RETURN-FLG TO WMS-LEAP-YEAR-FLG.                 0627539
135018     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0627539
135019         IF  WMS-INT-LEAP-YEAR-FLG EQUAL 'X'                      0627539
135020             MOVE WMS-INT-DATE-OPENED TO WK-OPEN-DATE             0627539
135021             PERFORM CHECK-366 THRU C366-EXIT                     0627539
135022             MOVE WK-RETURN-FLG TO WMS-INT-LEAP-YEAR-FLG.         0627539
135023 C2100-CHECK-RATE.                                                0817657
135024     IF (WMS-DAILY-RATE-CODE EQUAL '0' OR '2')                    0817657
135025         IF  WMS-LEAP-YEAR-FLG EQUAL '0'                          0817657
135026             MOVE WS-365-DDA-TABLE TO WS-RWF-DDA-TABLE            0817657
135027             MOVE WS-365-TIER-TABLE TO WS-RWF-TIER-TABLE          0817657
135028     ELSE                                                         0627539
135029             MOVE WS-366-DDA-TABLE TO WS-RWF-DDA-TABLE            0817657
135030             MOVE WS-366-TIER-TABLE TO WS-RWF-TIER-TABLE.         0817657
135031     IF  WMS-DAILY-RATE-CODE EQUAL '1'                            0817657
135032         MOVE WS-360-DDA-TABLE TO WS-RWF-DDA-TABLE                0817657
135033         MOVE WS-360-TIER-TABLE TO WS-RWF-TIER-TABLE.             0817657
135034     IF  WMS-DAILY-RATE-CODE EQUAL '3'                            0817657
135035         MOVE WS-365-DDA-TABLE TO WS-RWF-DDA-TABLE                9715519
135036         MOVE WS-365-TIER-TABLE TO WS-RWF-TIER-TABLE.             0817657
135037     IF  WMS-SAVINGS-TRLR NOT EQUAL '1'                           0817657
135038         GO TO C2100-CHECK-RATE-LOAN.                             0817657
135039     IF (WMS-DAILY-RATE-CODE EQUAL '0' OR '2')                    0817657
135040         IF  WMS-INT-LEAP-YEAR-FLG EQUAL '0'                      0817657
135041             MOVE WS-365-SAV-TABLE TO WS-RWF-SAV-TABLE            0817657
135042             MOVE WS-365-SAVT-TABLE TO WS-RWF-SAVT-TABLE          0817657
135043         ELSE                                                     0817657
135044             MOVE WS-366-SAV-TABLE TO WS-RWF-SAV-TABLE            0817657
135045             MOVE WS-366-SAVT-TABLE TO WS-RWF-SAVT-TABLE.         0817657
135046     IF  WMS-DAILY-RATE-CODE EQUAL '1'                            0817657
135047         MOVE WS-360-SAV-TABLE TO WS-RWF-SAV-TABLE                0817657
135048         MOVE WS-360-SAVT-TABLE TO WS-RWF-SAVT-TABLE.             0817657
135049     IF  WMS-DAILY-RATE-CODE EQUAL '3'                            0817657
135050         MOVE WS-365-SAV-TABLE TO WS-RWF-SAV-TABLE                0817657
135051         MOVE WS-365-SAVT-TABLE TO WS-RWF-SAVT-TABLE.             0817657
135052                                                                  0817657
135053 C2100-CHECK-RATE-LOAN.                                           0817657
135054     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '0'                        0817657
135055         IF  WMS-LEAP-YEAR-FLG EQUAL '0'                          0817657
135056             MOVE WS-365-OD-TABLE TO WS-RWF-OD-TABLE              0817657
135057             MOVE WS-365-LOAN-TABLE TO WS-RWF-LOAN-TABLE          0817657
135058             MOVE WS-365-PRIME-TABLE TO WS-RWF-PRIME-TABLE        0817657
135059             MOVE WS-365-SPLIT-TABLE TO WS-RWF-SPLIT-TABLE        0817657
135060     ELSE                                                         0817657
135061             MOVE WS-366-OD-TABLE TO WS-RWF-OD-TABLE              0817657
135062             MOVE WS-366-LOAN-TABLE TO WS-RWF-LOAN-TABLE          0817657
135063             MOVE WS-366-PRIME-TABLE TO WS-RWF-PRIME-TABLE        0817657
135064             MOVE WS-366-SPLIT-TABLE TO WS-RWF-SPLIT-TABLE.       0817657
135065     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '1'                        0817657
135066         MOVE WS-360-OD-TABLE TO WS-RWF-OD-TABLE                  0817657
135067         MOVE WS-360-LOAN-TABLE TO WS-RWF-LOAN-TABLE              0817657
135068         MOVE WS-360-PRIME-TABLE TO WS-RWF-PRIME-TABLE            0817657
135069         MOVE WS-360-SPLIT-TABLE TO WS-RWF-SPLIT-TABLE.           0817657
135070     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '2'                        0817657
135071         MOVE WS-365-OD-TABLE TO WS-RWF-OD-TABLE                  0817657
135072         MOVE WS-365-LOAN-TABLE TO WS-RWF-LOAN-TABLE              0817657
135073         MOVE WS-365-PRIME-TABLE TO WS-RWF-PRIME-TABLE            0817657
135074         MOVE WS-365-SPLIT-TABLE TO WS-RWF-SPLIT-TABLE.           0817657
135075 C2100-CHECK-RATE-EXIT. EXIT.                                     0817657
135076 C2100-SKIP-LEAP.                                                 0817657
135077     PERFORM C2100-SET-FLAGS THRU C2100-SET-FLAGS-END.            0817657
135078     PERFORM C2101 THRU C2102A-END.                               0817657
135079     IF  WS-RATE-DELETED EQUAL 'Y'                                0817657
135080         PERFORM R0015-FM-DDA THRU R0015-FM-DDA-END               0817657
135081         MOVE 'N' TO WS-RATE-DELETED.                             0817657
135082     GO TO C2100-CONT.                                            0817657
135083*                                                                 0817657
135084 C2100-SET-FLAGS.                                                 0817657
135085     MOVE WMS-CONTROL-1   TO RHW-CTL1.                            0817657
135086     MOVE WMS-CURR-CODE   TO RHW-CURR-CODE.                       0817657
135087     MOVE WMS-RATE-REGION TO RHW-REGION.                          0817657
135088     MOVE WMS-ACCT-TYPE   TO RHW-PRODUCT.                         0817657
135089     MOVE 'N' TO  TIER-CHG-FLG                                    0817657
135090                  IOD-CHG-FLG                                     0817657
135091                  DFLT-IOD-CHG-FLG                                0817657
135092                  SAV-CHG-FLG                                     0817657
135093                  LOAN-CHG-FLG                                    0817657
135094                  OD-CHG-FLG                                      0817657
135095                  OD-TRLR-CHG-FLG (1)                             0817657
135096                  OD-TRLR-CHG-FLG (2)                             0817657
135097                  OD-TRLR-CHG-FLG (3)                             0817657
135098                  OD-TRLR-CHG-FLG (4)                             0817657
135099                  OD-TRLR-CHG-FLG (5)                             0817657
135100                  OD-TRLR-CHG-FLG (6)                             0817657
135101                  OD-TRLR-CHG-FLG (7)                             0817657
135102                  OD-TRLR-CHG-FLG (8)                             0817657
135103                  OD-TRLR-CHG-FLG (9)                             0817657
135104                  PRIME-CHG-FLG                                   0817657
135105                  SPLIT-CHG-FLG                                   1003625
135106                  WS-MAINT-ON-0660-TDY                            ~~~0179
135107                  WS-MAINT-ON-0689-TDY                            ~~~0179
135108                  SAV-TIER-CHG-FLG                                0316967
135110                  PREV-LOAN-CHG-FLG                               1003625
135115                  PREV-SPLIT-CHG-FLG                              2012254
135116                  FED-TAX-CHG-FLG                                 2012254
135117                  ST-TAX-CHG-FLG                                  2012254
135118                  LOC-TAX-CHG-FLG.                                2012254
135120     MOVE ZERO TO TIER-SUB           TIER-FUT                     9915856
135122                  IOD-SUB            IOD-FUT                      9915856
135124                  DFLT-IOD-SUB       DFLT-IOD-FUT                 9915856
135126                  SAV-SUB            SAV-FUT                      9915856
135127                  SAV-TIER-SUB       SAV-TIER-FUT                 0316967
135128                  LOAN-SUB           LOAN-FUT                     9915856
135130                  OD-SUB             OD-FUT                       9915856
135132                  OD-TRLR-SUB (1)    OD-TRLR-FUT (1)              9915856
135134                  OD-TRLR-SUB (2)    OD-TRLR-FUT (2)              9915856
135136                  OD-TRLR-SUB (3)    OD-TRLR-FUT (3)              9915856
135138                  OD-TRLR-SUB (4)    OD-TRLR-FUT (4)              9915856
135140                  OD-TRLR-SUB (5)    OD-TRLR-FUT (5)              9915856
135142                  OD-TRLR-SUB (6)    OD-TRLR-FUT (6)              9915856
135144                  OD-TRLR-SUB (7)    OD-TRLR-FUT (7)              9915856
135146                  OD-TRLR-SUB (8)    OD-TRLR-FUT (8)              9915856
135148                  OD-TRLR-SUB (9)    OD-TRLR-FUT (9)              9915856
135150                  PRIME-SUB          PRIME-FUT                    9915856
135152                  SPLIT-SUB          SPLIT-FUT                    9915856
135154                  PREV-LOAN-SUB      PREV-LOAN-FUT                9915856
135155                  PREV-SPLIT-SUB     PREV-SPLIT-FUT               2012254
135156                  FED-TAX-FUT        ST-TAX-FUT                   2012254
135157                  LOC-TAX-FUT        FED-TAX-SUB                  2012254
135158                  ST-TAX-SUB         LOC-TAX-SUB                  2016683
135159                  CMA-AGGR-DAYS      CMA-PAST-AGGR-DAYS.          2016683
135160*                                                                 2016683
135165*TREAT A BKDT NEW ACCT AS EXISTING TO GET THE RATE UPDATE INFO    1020057
135166     IF  BKDT-DAYS-FLAG EQUAL '1'                                 1020057
135167         MOVE 'Y' TO EXISTING-ACCT-SW.                            1020057
135168*----------------------------------------------------------------*1020057
135169*    SET SWITCH TO PREVENT LOAN RATE INCREASES FOR CREDIT CARDS. *1020057
135170*----------------------------------------------------------------*1020057
135171     MOVE '0' TO RATE-CHG-SW NEW-LOAN-SW.                         1020057
135172     IF  WMS-LOAN-TRLR NOT EQUAL '1'                              1020057
135173         GO TO C2100-SET-FLAGS-END.                               1020057
135174     IF  WMS-TIS-CONSUMER-FLAG EQUAL 'Y'                          1020057
135175     AND WMS-CRED-CARD-IND EQUAL 'Y'                              1020057
135176     AND WBC-REG-Z EQUAL '1'                                      1020057
135177         NEXT SENTENCE                                            1020057
135178     ELSE                                                         1020057
135179         GO TO C2100-SET-FLAGS-END.                               1020057
135180     MOVE WMS-APPROVAL-MO TO DT-L-MO.                             1020057
135181     MOVE WMS-APPROVAL-DA TO DT-L-DA.                             1020057
135182     MOVE WMS-APPROVAL-YR TO DT-L-YR.                             1020057
135183     MOVE +12 TO RET-DAYS.                                        1020057
135184     CALL 'SIDMHI' USING DATE-AREA.                               1020057
135185     MOVE '11'          TO SICOMPDT-DATE-FORMATS.                 1020057
135186     CALL 'SICOMPDT' USING DT-HIGH-DATE                           1020057
135187                           WBC-CAPTURE-DATE                       1020057
135188                           SICOMPDT-RETURN-FLAG                   1020057
135189                           SICOMPDT-DATE-FORMATS.                 1020057
135190     IF  SICOMPDT-RETURN-FLAG EQUAL 'L'                           1020057
135191         GO TO C2100-SET-FLAGS-END.                               1020057
135192     MOVE '1' TO RATE-CHG-SW.                                     1020057
135196 C2100-SET-FLAGS-END.                                             1020057
135197     EXIT.                                                        1020057
135198*                                                                 1020057
135199* UPDATE TIERED RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY  1020057
135200*                                                                 1003625
135201 C2101.                                                           2012254
135202     IF  WMS-HIFI-INDICATOR EQUAL +0                              2012254
135203         GO TO C2101-END.                                         2012254
135204     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      2012254
135205     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     2012254
135206     MOVE WMS-HIFI-INDICATOR TO HOLD-PTR.                         2012254
135207     IF  WMS-TIER-RATE-KEY-LEVEL EQUAL '2'                        2012254
135208         MOVE SPACES TO HOLD-PRODUCT                              2012254
135209     ELSE                                                         2012254
135210         IF  WMS-TIER-RATE-KEY-LEVEL EQUAL '1'                    2012254
135211             MOVE SPACES TO HOLD-PRODUCT                          2012254
135212                            HOLD-REGION.                          2012254
135213     MOVE 'N' TO TIER-CHG-FLG.                                    2012254
135214     MOVE +0  TO WORK-SUB,                                        2012254
135215                 TIER-SUB,                                        2012254
135216                 TIER-FUT.                                        2012254
135217 C2101-TIER.                                                      2012254
135218     ADD +1 TO WORK-SUB.                                          2012254
135219     IF  WS-RWF-TIER-KEY (WORK-SUB) EQUAL HIGH-VALUES             2012254
135220     OR  WS-RWF-TIER-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY    2012254
135221         GO TO C2101-END.                                         2012254
135222     IF  WS-RWF-TIER-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY       2012254
135223         GO TO C2101-TIER.                                        2012254
135224     IF  WS-RWF-TIER-PERIOD (WORK-SUB) EQUAL 'F'                  2012254
135225         MOVE WORK-SUB TO TIER-FUT                                2012254
135226         GO TO C2101-END.                                         2012254
135227     IF  NOT EXISTING-ACCT                                        2012254
135228         GO TO C2101-TIER.                                        2012254
135229     IF  WS-RWF-TIER-CHG (WORK-SUB) EQUAL '6' OR '7'              2012254
135230         MOVE 'Y' TO WS-RATE-DELETED                              2012254
135237         GO TO C2101-TIER.                                        2012254
135238     IF  WS-RWF-TIER-PERIOD (WORK-SUB) EQUAL 'C'                  2012254
135239         MOVE 'Y'      TO TIER-CHG-FLG                            2012254
135240         MOVE WORK-SUB TO TIER-SUB.                               2012254
135241     IF  WS-RWF-TIER-CHG (WORK-SUB) NOT EQUAL '4'                 2012254
135242         MOVE WMS-TIER-CUR-DATA       TO WMS-TIER-PREV-DATA.      2012254
135243     MOVE WS-RWF-TIER-DATA (WORK-SUB) TO WMS-TIER-CUR-DATA.       2012254
135244     GO TO C2101-TIER.                                            2012254
135245 C2101-END.                                                       2012254
135246     EXIT.                                                        2012254
135247*                                                                 2012254
135248* UPDATE FED TX RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY  2012254
135249*                                                                 2012254
135250 C2101A.                                                          2012254
135251     IF  WMS-TAX-FED-PTR EQUAL +0                                 2012254
135252         GO TO C2101A-END.                                        2012254
135253     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      2012254
135254     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     2012254
135255     MOVE WMS-TAX-FED-PTR    TO HOLD-PTR.                         2012254
135256     IF  WMS-FED-TAX-RATE-KEY-LEVEL EQUAL '2'                     2012254
135257         MOVE SPACES TO HOLD-PRODUCT                              2012254
135258     ELSE                                                         2012254
135259         IF  WMS-FED-TAX-RATE-KEY-LEVEL EQUAL '1'                 2012254
135260             MOVE SPACES TO HOLD-PRODUCT                          2012254
135261                            HOLD-REGION.                          2012254
135262     MOVE 'N' TO FED-TAX-CHG-FLG.                                 2012254
135263     MOVE +0  TO WORK-SUB,                                        2012254
135264                 FED-TAX-SUB,                                     2012254
135265                 FED-TAX-FUT.                                     2012254
135266 C2101A-FED-TAX.                                                  2012254
135267     ADD +1 TO WORK-SUB.                                          2012254
135268     IF  WS-RWF-TAX-KEY (WORK-SUB) EQUAL HIGH-VALUES              2012254
135269     OR  WS-RWF-TAX-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     2012254
135270         GO TO C2101A-END.                                        2012254
135271     IF  WS-RWF-TAX-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        2012254
135272         GO TO C2101A-FED-TAX.                                    2012254
135273     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'F'                   2012254
135274         MOVE WORK-SUB TO FED-TAX-FUT                             2012254
135275         GO TO C2101A-END.                                        2012254
135276     IF  NOT EXISTING-ACCT                                        2012254
135277         GO TO C2101A-FED-TAX.                                    2012254
135278     IF  WS-RWF-TAX-CHG (WORK-SUB) EQUAL '6' OR '7'               2012254
135279         MOVE 'Y' TO WS-RATE-DELETED                              2012254
135280         GO TO C2101A-FED-TAX.                                    2012254
135281     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'C'                   2012254
135282         MOVE 'Y'      TO FED-TAX-CHG-FLG                         2012254
135283         MOVE WORK-SUB TO FED-TAX-SUB.                            2012254
135284     MOVE WS-RWF-TAX-DATA (WORK-SUB) TO WMS-FED-TAX-CUR-DATA.     2012254
135285     GO TO C2101A-FED-TAX.                                        2012254
135286 C2101A-END.                                                      2012254
135287     EXIT.                                                        2012254
135288*                                                                 2012254
135289* UPDATE STATE TX RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY2012254
135290*                                                                 2012254
135291 C2101B.                                                          2012254
135292     IF  WMS-TAX-STATE-PTR EQUAL +0                               2012254
135293         GO TO C2101B-END.                                        2012254
135294     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      2012254
135295     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     2012254
135296     MOVE WMS-TAX-STATE-PTR  TO HOLD-PTR.                         2012254
135297     IF  WMS-ST-TAX-RATE-KEY-LEVEL EQUAL '2'                      2012254
135298         MOVE SPACES TO HOLD-PRODUCT                              2012254
135299     ELSE                                                         2012254
135300         IF  WMS-ST-TAX-RATE-KEY-LEVEL EQUAL '1'                  2012254
135301             MOVE SPACES TO HOLD-PRODUCT                          2012254
135302                            HOLD-REGION.                          2012254
135303     MOVE 'N' TO ST-TAX-CHG-FLG.                                  2012254
135304     MOVE +0  TO WORK-SUB,                                        2012254
135305                 ST-TAX-SUB,                                      2012254
135306                 ST-TAX-FUT.                                      2012254
135307 C2101B-ST-TAX.                                                   2012254
135308     ADD +1 TO WORK-SUB.                                          2012254
135309     IF  WS-RWF-TAX-KEY (WORK-SUB) EQUAL HIGH-VALUES              2012254
135310     OR  WS-RWF-TAX-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     2012254
135311         GO TO C2101B-END.                                        2012254
135312     IF  WS-RWF-TAX-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        2012254
135313         GO TO C2101B-ST-TAX.                                     2012254
135314     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'F'                   2012254
135315         MOVE WORK-SUB TO ST-TAX-FUT                              2012254
135316         GO TO C2101B-END.                                        2012254
135317     IF  NOT EXISTING-ACCT                                        2012254
135318         GO TO C2101B-ST-TAX.                                     2012254
135319     IF  WS-RWF-TAX-CHG (WORK-SUB) EQUAL '6' OR '7'               2012254
135320         MOVE 'Y' TO WS-RATE-DELETED                              2012254
135321         GO TO C2101B-ST-TAX.                                     2012254
135322     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'C'                   2012254
135323         MOVE 'Y'      TO ST-TAX-CHG-FLG                          2012254
135324         MOVE WORK-SUB TO ST-TAX-SUB.                             2012254
135365     MOVE WS-RWF-TAX-DATA (WORK-SUB) TO WMS-ST-TAX-CUR-DATA.      2012254
135366     GO TO C2101B-ST-TAX.                                         2012254
135367 C2101B-END.                                                      2012254
135368     EXIT.                                                        2012254
135369*                                                                 2012254
135370* UPDATE LOCAL TX RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY2012254
135371*                                                                 2012254
135372 C2101C.                                                          2012254
135373     IF  WMS-TAX-LOCAL-PTR EQUAL +0                               2012254
135374         GO TO C2101C-END.                                        2012254
135375     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      2012254
135376     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     2012254
135377     MOVE WMS-TAX-LOCAL-PTR  TO HOLD-PTR.                         2012254
135378     IF  WMS-LOC-TAX-RATE-KEY-LEVEL EQUAL '2'                     2012254
135379         MOVE SPACES TO HOLD-PRODUCT                              2012254
135380     ELSE                                                         2012254
135381         IF  WMS-LOC-TAX-RATE-KEY-LEVEL EQUAL '1'                 2012254
135382             MOVE SPACES TO HOLD-PRODUCT                          2012254
135383                            HOLD-REGION.                          2012254
135384     MOVE 'N' TO LOC-TAX-CHG-FLG.                                 2012254
135385     MOVE +0  TO WORK-SUB,                                        2012254
135386                 LOC-TAX-SUB,                                     2012254
135387                 LOC-TAX-FUT.                                     2012254
135388 C2101C-LOC-TAX.                                                  2012254
135389     ADD +1 TO WORK-SUB.                                          2012254
135390     IF  WS-RWF-TAX-KEY (WORK-SUB) EQUAL HIGH-VALUES              2012254
135391     OR  WS-RWF-TAX-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     2012254
135392         GO TO C2101C-END.                                        2012254
135393     IF  WS-RWF-TAX-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        2012254
135394         GO TO C2101C-LOC-TAX.                                    2012254
135395     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'F'                   2012254
135396         MOVE WORK-SUB TO LOC-TAX-FUT                             2012254
135397         GO TO C2101C-END.                                        2012254
135398     IF  NOT EXISTING-ACCT                                        2012254
135399         GO TO C2101C-LOC-TAX.                                    2012254
135400     IF  WS-RWF-TAX-CHG (WORK-SUB) EQUAL '6' OR '7'               2012254
135401         MOVE 'Y' TO WS-RATE-DELETED                              2012254
135402         GO TO C2101C-LOC-TAX.                                    2012254
135403     IF  WS-RWF-TAX-PERIOD (WORK-SUB) EQUAL 'C'                   2012254
135404         MOVE 'Y'      TO LOC-TAX-CHG-FLG                         2012254
135405         MOVE WORK-SUB TO LOC-TAX-SUB.                            2012254
135406     MOVE WS-RWF-TAX-DATA (WORK-SUB) TO WMS-LOC-TAX-CUR-DATA.     2012254
135407     GO TO C2101C-LOC-TAX.                                        2012254
135408 C2101C-END.                                                      2012254
135409     EXIT.                                                        2012254
135410*                                                                 2012254
135411* UPDATE IOD RATE ON TRAILER IF ANY RATES HAVE CHANGED TODAY      2012254
135412*                                                                 2012254
135413 C2102.                                                           2012254
135414     IF  WMS-IOD-RATE-PTR EQUAL +0                                2012254
135415         GO TO C2102-END.                                         2012254
135416     IF  WMS-HIFI-INDICATOR NOT EQUAL +0                          2012254
135417         GO TO C2102-END.                                         2012254
135418     MOVE WMS-IOD-RATE-PTR   TO HOLD-PTR                          2012254
135419     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      2012254
135420     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     2012254
135421     IF  WMS-IOD-RATE-KEY-LEVEL EQUAL '2'                         2012254
135422         MOVE SPACES TO HOLD-PRODUCT                              2012254
135423     ELSE                                                         2012254
135424         IF  WMS-IOD-RATE-KEY-LEVEL EQUAL '1'                     2012254
135425             MOVE SPACES TO HOLD-PRODUCT                          2012254
135426                            HOLD-REGION.                          2012254
135427     MOVE 'N' TO IOD-CHG-FLG.                                     2012254
135428     MOVE +0  TO WORK-SUB,                                        2012254
135429                 IOD-SUB,                                         2012254
135430                 IOD-FUT.                                         1003625
135432 C2102-IOD.                                                       1003625
135434     ADD +1 TO WORK-SUB.                                          1003625
135436     IF  WS-RWF-DDA-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
135438     OR  WS-RWF-DDA-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
135440         GO TO C2102-END.                                         1003625
135442     IF  WS-RWF-DDA-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
135444         GO TO C2102-IOD.                                         1003625
135446     IF  WS-RWF-DDA-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
135448         MOVE WORK-SUB TO IOD-FUT                                 1003625
135450         GO TO C2102-END.                                         1003625
135451     IF  NOT EXISTING-ACCT                                        1003625
135452         GO TO C2102-IOD.                                         1003625
135453     IF  WS-RWF-DDA-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
135454         MOVE 'Y' TO WS-RATE-DELETED                              1003625
135455         GO TO C2102-IOD.                                         1003625
135456     IF  WS-RWF-DDA-PERIOD (WORK-SUB) EQUAL 'C'                   1003625
135457         MOVE 'Y'      TO IOD-CHG-FLG                             1003625
135458         MOVE WORK-SUB TO IOD-SUB.                                1003625
135460     IF  WS-RWF-DDA-CHG (WORK-SUB) NOT EQUAL '4'                  1003625
135462         MOVE WMS-IOD-CUR-DATA       TO WMS-IOD-PREV-DATA.        1003625
135464     MOVE WS-RWF-DDA-DATA (WORK-SUB) TO WMS-IOD-CUR-DATA.         1003625
135466     GO TO C2102-IOD.                                             1003625
135468 C2102-END.                                                       1003625
135470     EXIT.                                                        1003625
135472*                                                                 1003625
135474* UPDATE DFLT IOD RATE ON TRAILER IF ANY RATES HAVE CHANGED TODAY 1003625
135476*                                                                 1003625
135478 C2102A.                                                          1003625
135480     IF  WMS-HIFI-INDICATOR GREATER THAN +0                       1003625
135482     OR  WMS-IOD-RATE-PTR GREATER THAN +0                         1003625
135484         MOVE 001 TO HOLD-PTR                                     1003625
135486     ELSE                                                         1003625
135488         GO TO C2102A-END.                                        1003625
135490     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      1003625
135492     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     1003625
135494     IF  WMS-IOD-RATE-KEY-LEVEL EQUAL '2'                         1003625
135496         MOVE SPACES TO HOLD-PRODUCT                              1003625
135498     ELSE                                                         1003625
135500         IF  WMS-IOD-RATE-KEY-LEVEL EQUAL '1'                     1003625
135502             MOVE SPACES TO HOLD-PRODUCT                          1003625
135504                            HOLD-REGION.                          1003625
135506     MOVE 'N' TO DFLT-IOD-CHG-FLG.                                1003625
135508     MOVE +0  TO WORK-SUB,                                        1003625
135510                 DFLT-IOD-SUB,                                    1003625
135512                 DFLT-IOD-FUT.                                    1003625
135514 C2102A-DFLT-IOD.                                                 1003625
135516     ADD +1 TO WORK-SUB.                                          1003625
135518     IF  WS-RWF-DDA-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
135520     OR  WS-RWF-DDA-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
135522         GO TO C2102A-END.                                        1003625
135524     IF  WS-RWF-DDA-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
135526         GO TO C2102A-DFLT-IOD.                                   1003625
135528     IF  WS-RWF-DDA-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
135530         MOVE WORK-SUB TO DFLT-IOD-FUT                            1003625
135532         GO TO C2102A-END.                                        1003625
135533     IF  NOT EXISTING-ACCT                                        1003625
135534         GO TO C2102A-DFLT-IOD.                                   1003625
135535     IF  WS-RWF-DDA-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
135536         MOVE 'Y' TO WS-RATE-DELETED                              1003625
135537         GO TO C2102A-DFLT-IOD.                                   1003625
135538     IF  WS-RWF-DDA-PERIOD (WORK-SUB) EQUAL 'C'                   1003625
135539         MOVE 'Y'      TO DFLT-IOD-CHG-FLG                        1003625
135540         MOVE WORK-SUB TO DFLT-IOD-SUB.                           1003625
135542     IF  WS-RWF-DDA-CHG (WORK-SUB) NOT EQUAL '4'                  1003625
135544         MOVE WMS-DFLT-IOD-CUR-DATA  TO WMS-DFLT-IOD-PREV-DATA.   1003625
135546     MOVE WS-RWF-DDA-DATA (WORK-SUB) TO WMS-DFLT-IOD-CUR-DATA.    1003625
135548     GO TO C2102A-DFLT-IOD.                                       1003625
135550 C2102A-END.                                                      1003625
135552     EXIT.                                                        1003625
135630*                                                                 1003625
135635* UPDATE SAV RATE ON TRAILER IF ANY RATES HAVE CHANGED TODAY      1003625
135640*                                                                 1003625
135645 C2103.                                                           1003625
135650     IF  WMS-SAVINGS-TRLR EQUAL '0'                               1003625
135651     OR  WMS-SAV-TIER-PTR GREATER +0                              0316967
135655         GO TO C2103-END.                                         1003625
135660     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      1003625
135665     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     1003625
135670     MOVE WMS-INT-RATE       TO HOLD-PTR.                         1003625
135675     IF  WMS-SAV-RATE-KEY-LEVEL EQUAL '2'                         1003625
135680         MOVE SPACES TO HOLD-PRODUCT                              1003625
135685     ELSE                                                         1003625
135690         IF  WMS-SAV-RATE-KEY-LEVEL EQUAL '1'                     1003625
135695             MOVE SPACES TO HOLD-PRODUCT                          1003625
135700                            HOLD-REGION.                          1003625
135705     MOVE 'N' TO SAV-CHG-FLG.                                     1003625
135710     MOVE +0  TO WORK-SUB,                                        1003625
135715                 SAV-SUB,                                         1003625
135720                 SAV-FUT.                                         1003625
135725 C2103-SAV.                                                       1003625
135730     ADD +1 TO WORK-SUB.                                          1003625
135735     IF  WS-RWF-SAV-KEY (WORK-SUB) EQUAL HIGH-VALUES              9715519
135740     OR  WS-RWF-SAV-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     9715519
135745         GO TO C2103-END.                                         1003625
135750     IF  WS-RWF-SAV-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        9715519
135755         GO TO C2103-SAV.                                         1003625
135760     IF  WS-RWF-SAV-PERIOD (WORK-SUB) EQUAL 'F'                   9715519
135765         MOVE WORK-SUB TO SAV-FUT                                 1003625
135770         GO TO C2103-END.                                         1003625
135775     IF  NOT EXISTING-ACCT                                        1003625
135776         GO TO C2103-SAV.                                         1003625
135777     IF  WS-RWF-SAV-CHG (WORK-SUB) EQUAL '6' OR '7'               9715519
135778         MOVE 'Y' TO WS-RATE-DELETED                              1003625
135779         GO TO C2103-SAV.                                         1003625
135780     IF  WS-RWF-SAV-PERIOD (WORK-SUB) EQUAL 'C'                   9715519
135785         MOVE 'Y'      TO SAV-CHG-FLG                             1003625
135790         MOVE WORK-SUB TO SAV-SUB.                                1003625
135795     IF  WS-RWF-SAV-CHG (WORK-SUB) NOT EQUAL '4'                  9715519
135800         MOVE WMS-SAV-CUR-DATA       TO WMS-SAV-PREV-DATA.        1003625
135805     MOVE WS-RWF-SAV-DATA (WORK-SUB) TO WMS-SAV-CUR-DATA.         9715519
135806     GO TO C2103-SAV.                                             0316967
135807 C2103-END.                                                       0316967
135808     EXIT.                                                        0316967
135809*                                                                 0316967
135810* UPDATE SAV TIER RATE ON TRAILER IF ANY RATES HAVE CHANGED TODAY 0316967
135811*                                                                 0316967
135812 C2103A.                                                          0316967
135813     IF  WMS-SAVINGS-TRLR EQUAL '0'                               0316967
135814     OR  WMS-SAV-TIER-PTR EQUAL +0                                0316967
135815         GO TO C2103A-END.                                        0316967
135816     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      0316967
135817     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     0316967
135818     MOVE WMS-SAV-TIER-PTR TO HOLD-PTR.                           0316967
135819     IF  WMS-SAV-RATE-KEY-LEVEL EQUAL '2'                         0316967
135820         MOVE SPACES TO HOLD-PRODUCT                              0316967
135825     ELSE                                                         0316967
135826         IF  WMS-SAV-RATE-KEY-LEVEL EQUAL '1'                     0316967
135827             MOVE SPACES TO HOLD-PRODUCT, HOLD-REGION.            0316967
135828     MOVE 'N' TO SAV-CHG-FLG.                                     0316967
135829     MOVE +0  TO WORK-SUB,                                        0316967
135830                 SAV-TIER-SUB,                                    0316967
135831                 SAV-TIER-FUT.                                    0316967
135832 C2103A-SAV.                                                      0316967
135833     ADD +1 TO WORK-SUB.                                          0316967
135834     IF  WS-RWF-SAVT-KEY (WORK-SUB) EQUAL HIGH-VALUES             0316967
135835     OR  WS-RWF-SAVT-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY    0316967
135836         GO TO C2103A-END.                                        0316967
135837     IF  WS-RWF-SAVT-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY       0316967
135838         GO TO C2103A-SAV.                                        0316967
135839     IF  WS-RWF-SAVT-PERIOD (WORK-SUB) EQUAL 'F'                  0316967
135840         MOVE WORK-SUB TO SAV-TIER-FUT                            0316967
135841         GO TO C2103A-END.                                        0316967
135842     IF  NOT EXISTING-ACCT                                        0316967
135843         GO TO C2103A-SAV.                                        0316967
135844     IF  WS-RWF-SAVT-CHG (WORK-SUB) EQUAL '6' OR '7'              0316967
135845         MOVE 'Y' TO WS-RATE-DELETED                              0316967
135846         GO TO C2103A-SAV.                                        0316967
135847     IF  WS-RWF-SAVT-PERIOD (WORK-SUB) EQUAL 'C'                  0316967
135848         MOVE 'Y'      TO SAV-TIER-CHG-FLG                        0316967
135849         MOVE WORK-SUB TO SAV-TIER-SUB.                           0316967
135850     IF  WS-RWF-SAVT-CHG (WORK-SUB) NOT EQUAL '4'                 0316967
135851         MOVE WMS-SAV-CUR-DATA         TO WMS-SAV-PREV-DATA.      0316967
135852     MOVE WS-RWF-SAVT-DATE (WORK-SUB)  TO WMS-SAV-CUR-DATE.       0316967
135853     MOVE WS-RWF-SAVT-ANN (WORK-SUB 1) TO WMS-SAV-CUR-ANN.        0316967
135854     MOVE WS-RWF-SAVT-DAF (WORK-SUB 1) TO WMS-SAV-CUR-DAF.        0316967
135855     GO TO C2103A-SAV.                                            0316967
135856 C2103A-END.                                                      0316967
135857     EXIT.                                                        0316967
135858*                                                                 0316967
135859* UPDATE OD RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY      0316967
135860*                                                                 0316967
135861 C2104.                                                           0316967
135862     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'                            0316967
135863         GO TO C2104-END.                                         0316967
135864     MOVE 'N' TO OD-CHG-FLG.                                      0316967
135865     MOVE +0 TO V.                                                0316967
135866*                                                                 0316967
135867 C2104-SET-SUB.                                                   0316967
135868     ADD +1                     TO V.                             0316967
135869*                                                                 0316967
135870     IF  V GREATER THAN +9                                        9915856
135871         MOVE 'N' TO OD-CHG-FLG                                   0266274
135872         GO TO C2104-END.                                         9915856
135874*                                                                 9915856
135876     IF  V EQUAL +1                                               9915856
135878         MOVE WMS-OD-INT-PTR1   TO HOLD-PTR                       9915856
135880         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135882         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135884                                   OD-TRLR-FUT (V)                9915856
135886     ELSE                                                         9915856
135888     IF  V EQUAL +2                                               9915856
135890         MOVE WMS-OD-INT-PTR2   TO HOLD-PTR                       9915856
135892         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135894         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135896                                   OD-TRLR-FUT (V)                9915856
135898     ELSE                                                         9915856
135900     IF  V EQUAL +3                                               9915856
135902         MOVE WMS-OD-INT-PTR3   TO HOLD-PTR                       9915856
135904         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135906         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135908                                   OD-TRLR-FUT (V)                9915856
135910     ELSE                                                         1003625
135912     IF  V EQUAL +4                                               9915856
135914         MOVE WMS-OD-INT-PTR4   TO HOLD-PTR                       9915856
135916         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135918         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135920                                   OD-TRLR-FUT (V)                9915856
135922     ELSE                                                         9915856
135924     IF  V EQUAL +5                                               9915856
135926         MOVE WMS-OD-INT-PTR5   TO HOLD-PTR                       9915856
135928         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135930         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135932                                   OD-TRLR-FUT (V)                9915856
135934     ELSE                                                         9915856
135936     IF  V EQUAL +6                                               9915856
135938         MOVE WMS-OD-INT-PTR6   TO HOLD-PTR                       9915856
135940         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135942         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135944                                   OD-TRLR-FUT (V)                9915856
135946     ELSE                                                         9915856
135948     IF  V EQUAL +7                                               9915856
135950         MOVE WMS-OD-INT-PTR7   TO HOLD-PTR                       9915856
135952         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135954         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135956                                   OD-TRLR-FUT (V)                9915856
135958     ELSE                                                         9915856
135960     IF  V EQUAL +8                                               9915856
135962         MOVE WMS-OD-INT-PTR8   TO HOLD-PTR                       9915856
135964         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135966         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135968                                   OD-TRLR-FUT (V)                9915856
135970     ELSE                                                         9915856
135972     IF  V EQUAL +9                                               9915856
135974         MOVE WMS-OD-INT-PTR9   TO HOLD-PTR                       9915856
135976         MOVE 'N'               TO OD-TRLR-CHG-FLG (V)            9915856
135978         MOVE +0                TO OD-TRLR-SUB (V)                9915856
135980                                   OD-TRLR-FUT (V).               9915856
135982*                                                                 9915856
135984     IF  HOLD-PTR EQUAL +0                                        9915856
135986         GO TO C2104-SET-SUB.                                     9915856
135988*                                                                 9915856
135990     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      9915856
135992     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     9915856
135994*                                                                 9915856
135996     IF  WMS-OD-RATE-KEY-LEVEL EQUAL '2'                          9915856
135998         MOVE SPACES TO HOLD-PRODUCT                              9915856
136000     ELSE                                                         1003625
136005         IF  WMS-OD-RATE-KEY-LEVEL EQUAL '1'                      1003625
136010             MOVE SPACES TO HOLD-PRODUCT                          1003625
136015                            HOLD-REGION.                          1003625
136020     MOVE +0  TO WORK-SUB.                                        1003625
136021* ONLY PROCESS PRIME 1 TIME FOR AN ACCOUNT                        0266274
136022     IF  HOLD-PTR EQUAL +6                                        0266274
136023         IF  OD-CHG-FLG EQUAL 'P'                                 0266274
136024             GO TO C2104-SET-SUB.                                 0266274
136025     IF  HOLD-PTR EQUAL +6                                        1003625
136027         MOVE 001 TO HOLD-PTR                                     9715570
136030         MOVE 'N' TO PRIME-CHG-FLG                                1003625
136033         MOVE 'P' TO OD-CHG-FLG                                   0266274
136035         MOVE +0  TO PRIME-SUB                                    1003625
136040         MOVE +0  TO PRIME-FUT                                    1003625
136045         GO TO C2104-OD-PRIME.                                    1003625
136050 C2104-OD.                                                        1003625
136055     ADD +1 TO WORK-SUB.                                          1003625
136057*                                                                 9915856
136060     IF  WS-RWF-OD-KEY (WORK-SUB) EQUAL HIGH-VALUES               1003625
136065     OR  WS-RWF-OD-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY      1003625
136070         GO TO C2104-SET-SUB.                                     1003625
136072*                                                                 9915856
136075     IF  WS-RWF-OD-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY         1003625
136080         GO TO C2104-OD.                                          1003625
136085*                                                                 9915856
136090     IF  WS-RWF-OD-PERIOD (WORK-SUB) EQUAL 'F'                    9915856
136095         MOVE WORK-SUB           TO OD-TRLR-FUT (V)               9915856
136100         GO TO C2104-SET-SUB.                                     9915856
136105*                                                                 9915856
136110     IF  NOT EXISTING-ACCT                                        9915856
136115         GO TO C2104-OD.                                          9915856
136120*                                                                 9915856
136125     IF  WS-RWF-OD-CHG (WORK-SUB) EQUAL '6' OR '7'                9915856
136130         MOVE 'Y'                TO WS-RATE-DELETED               9915856
136135         GO TO C2104-OD.                                          9915856
136140*                                                                 9915856
136145     IF  WS-RWF-OD-PERIOD (WORK-SUB) EQUAL 'C'                    9915856
136150         MOVE 'Y'                TO OD-TRLR-CHG-FLG (V)           9915856
136160         MOVE WORK-SUB           TO OD-TRLR-SUB (V).              9915856
136165*                                                                 9915856
136170     IF  WS-RWF-OD-CHG (WORK-SUB) NOT EQUAL '4'                   9915856
136175         MOVE WMS-OD-CUR-DATA (V)    TO WMS-OD-PREV-DATA (V).     9915856
136180*                                                                 9915856
136220     MOVE WS-RWF-OD-DATA (WORK-SUB)  TO WMS-OD-CUR-DATA (V).      1003625
136225     GO TO C2104-OD.                                              1003625
136230                                                                  1003625
136235 C2104-OD-PRIME.                                                  1003625
136240     ADD +1 TO WORK-SUB.                                          1003625
136245     IF  WS-RWF-PRM-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
136250     OR  WS-RWF-PRM-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
136255         GO TO C2104-SET-SUB.                                     1003625
136260     IF  WS-RWF-PRM-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
136265         GO TO C2104-OD-PRIME.                                    1003625
136270     IF  WS-RWF-PRM-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
136275         MOVE WORK-SUB TO PRIME-FUT                               1003625
136280         GO TO C2104-SET-SUB.                                     1003625
136285     IF  NOT EXISTING-ACCT                                        1003625
136286         GO TO C2104-OD-PRIME.                                    1003625
136287     IF  WS-RWF-PRM-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
136288         MOVE 'Y' TO WS-RATE-DELETED                              1003625
136289         GO TO C2104-OD-PRIME.                                    1003625
136290     IF  WS-RWF-PRM-PERIOD (WORK-SUB) EQUAL 'C'                   1003625
136295         MOVE 'Y'      TO PRIME-CHG-FLG                           1003625
136300         MOVE WORK-SUB TO PRIME-SUB.                              1003625
136305     IF  WS-RWF-PRM-CHG (WORK-SUB) NOT EQUAL '4'                  1003625
136310         MOVE WMS-OD-PRM-CUR-DATA    TO WMS-OD-PRM-PREV-DATA.     1003625
136312     MOVE WS-RWF-PRM-DATE (WORK-SUB) TO WMS-OD-PRM-CUR-DATE.      9715570
136315     MOVE WS-RWF-PRM-ANN (WORK-SUB)  TO WMS-OD-PRM-CUR-ANN.       1003625
136320     MOVE WS-RWF-PRM-DAF (WORK-SUB)  TO WMS-OD-PRM-CUR-DAF.       1003625
136325     GO TO C2104-OD-PRIME.                                        1003625
136330 C2104-END.                                                       1003625
136335     EXIT.                                                        1003625
136340                                                                  1003625
136345*                                                                 1003625
136350* UPDATE LOAN RATES ON TRAILER IF ANY RATES HAVE CHANGED TODAY    1003625
136355*                                                                 1003625
136360 C2105.                                                           1003625
136365     IF  WMS-LOAN-TRLR EQUAL +0                                   1003625
136370         GO TO C2109-END.                                         1003625
136371*--- SKIP AUTOBORROW ACCOUNTS -----------------------------------*9915749
136372     IF  WMS-NB-DC-ABM EQUAL TO '1'                               9915749
136373         GO TO C2107-END.                                         9915749
136375     IF  WMS-INT-RATE-PTR GREATER +5                              1003625
136380         GO TO C2107.                                             1003625
136385     IF  WMS-SPLIT-RATE-SCHD GREATER +0                           1003625
136390         GO TO C2106.                                             1003625
136395     IF  WMS-INT-RATE-PTR EQUAL +0                                1003625
136400         GO TO C2107-END.                                         1003625
136405     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      1003625
136410     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     1003625
136415     MOVE WMS-INT-RATE-PTR   TO HOLD-PTR.                         1003625
136420     IF  WMS-LN-RATE-KEY-LEVEL EQUAL '2'                          1003625
136425         MOVE SPACES TO HOLD-PRODUCT                              1003625
136430     ELSE                                                         1003625
136435         IF  WMS-LN-RATE-KEY-LEVEL EQUAL '1'                      1003625
136440             MOVE SPACES TO HOLD-PRODUCT                          1003625
136445                            HOLD-REGION.                          1003625
136450     MOVE 'N' TO LOAN-CHG-FLG.                                    1003625
136455     MOVE +0  TO WORK-SUB,                                        1003625
136460                 LOAN-SUB,                                        1003625
136465                 LOAN-FUT.                                        1003625
136470 C2105-LOAN.                                                      1003625
136475     ADD +1 TO WORK-SUB.                                          1003625
136480     IF  WS-RWF-LN-KEY (WORK-SUB) EQUAL HIGH-VALUES               1003625
136485     OR  WS-RWF-LN-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY      1003625
136490         GO TO C2107-END.                                         1003625
136495     IF  WS-RWF-LN-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY         1003625
136500         GO TO C2105-LOAN.                                        1003625
136505     IF  WS-RWF-LN-PERIOD (WORK-SUB) EQUAL 'F'                    1003625
136510         MOVE WORK-SUB TO LOAN-FUT                                1003625
136515         GO TO C2107-END.                                         1003625
136520     IF  NOT EXISTING-ACCT                                        1003625
136521         GO TO C2105-LOAN.                                        1003625
136522     IF  WS-RWF-LN-CHG (WORK-SUB) EQUAL '6' OR '7'                1003625
136523         MOVE 'Y' TO WS-RATE-DELETED                              1003625
136524         GO TO C2105-LOAN.                                        1003625
136525*----------------------------------------------------------------*1020057
136526*    DO NOT ALLOW RATE INCREASES IN THE FIRST YEAR FOR LOANS     *1020057
136527*    SUBJECT TO CREDIT CARD RULES.                               *1020057
136528*----------------------------------------------------------------*1020057
136529     IF  WS-RWF-LN-CHG (WORK-SUB) NOT EQUAL '4'                   1020057
136530         IF  RATE-CHG-SW EQUAL '1'                                1020057
136531             IF  WS-RWF-LN-ANN (WORK-SUB)                         1020057
136532                             GREATER THAN WMS-ANNUAL-RATE         1020057
136533                 GO TO C2105-LOAN.                                1020057
136534     IF  WS-RWF-LN-PERIOD (WORK-SUB) EQUAL 'C'                    1020057
136535         MOVE 'Y'      TO LOAN-CHG-FLG                            1020057
136536         MOVE WORK-SUB TO LOAN-SUB.                               1020057
136540     IF  WS-RWF-LN-CHG (WORK-SUB) NOT EQUAL '4'                   1003625
136545         MOVE WMS-LN-CUR-DATA       TO WMS-LN-PREV-DATA.          1003625
136550     MOVE WS-RWF-LN-DATA (WORK-SUB) TO WMS-LN-CUR-DATA.           1003625
136555     MOVE WS-RWF-LN-ANN (WORK-SUB)  TO WMS-ANNUAL-RATE.           1003625
136560     MOVE WS-RWF-LN-DAF (WORK-SUB)  TO WMS-DAILY-RATE.            1003625
136565     PERFORM C2302 THRU C2304-EXIT.                               1003625
136570     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.          0266741
136575     GO TO C2105-LOAN.                                            1003625
136580                                                                  1003625
136585 C2106.                                                           1003625
136590     MOVE WMS-RATE-REGION     TO HOLD-REGION.                     1003625
136595     MOVE WMS-ACCT-TYPE       TO HOLD-PRODUCT.                    1003625
136600     MOVE WMS-SPLIT-RATE-SCHD TO HOLD-PTR.                        1003625
136605     IF  WMS-SPL-RATE-KEY-LEVEL EQUAL '2'                         1003625
136610         MOVE SPACES TO HOLD-PRODUCT                              1003625
136615     ELSE                                                         1003625
136620         IF  WMS-SPL-RATE-KEY-LEVEL EQUAL '1'                     1003625
136625             MOVE SPACES TO HOLD-PRODUCT                          1003625
136630                            HOLD-REGION.                          1003625
136635     MOVE 'N' TO SPLIT-CHG-FLG.                                   1003625
136640     MOVE +0  TO WORK-SUB,                                        1003625
136645                 SPLIT-SUB,                                       1003625
136650                 SPLIT-FUT.                                       1003625
136655 C2106-SPLIT.                                                     1003625
136660     ADD +1 TO WORK-SUB.                                          1003625
136665     IF  WS-RWF-SPL-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
136670     OR  WS-RWF-SPL-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
136675         GO TO C2107-END.                                         1003625
136680     IF  WS-RWF-SPL-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
136685         GO TO C2106-SPLIT.                                       1003625
136690     IF  WS-RWF-SPL-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
136695         MOVE WORK-SUB TO SPLIT-FUT                               1003625
136700         GO TO C2107-END.                                         1003625
136705     IF  NOT EXISTING-ACCT                                        1003625
136706         GO TO C2106-SPLIT.                                       1003625
136707     IF  WS-RWF-SPL-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
136708         MOVE 'Y' TO WS-RATE-DELETED                              1003625
136709         GO TO C2106-SPLIT.                                       1003625
136710*----------------------------------------------------------------*1020057
136711*    DO NOT ALLOW RATE INCREASES IN THE FIRST YEAR FOR LOANS     *1020057
136712*    SUBJECT TO CREDIT CARD RULES.                               *1020057
136713*----------------------------------------------------------------*1020057
136714     IF  WS-RWF-SPL-CHG (WORK-SUB) NOT EQUAL '4'                  1020057
136715         IF  RATE-CHG-SW EQUAL '1'                                1020057
136716             IF (WS-RWF-SPL-ANN (WORK-SUB 1)                      1020057
136717                             GREATER THAN WMS-RATE1-ANNUAL        1020057
136718             OR  WS-RWF-SPL-ANN (WORK-SUB 2)                      1020057
136719                             GREATER THAN WMS-RATE2-ANNUAL        1020057
136720             OR  WS-RWF-SPL-ANN (WORK-SUB 3)                      1020057
136721                             GREATER THAN WMS-RATE3-ANNUAL)       1020057
136722                 GO TO C2106-SPLIT.                               1020057
136723     IF  WS-RWF-SPL-PERIOD (WORK-SUB) EQUAL 'C'                   1020057
136724         MOVE 'Y'      TO SPLIT-CHG-FLG                           1020057
136725         MOVE WORK-SUB TO SPLIT-SUB.                              1020057
136726     IF  WS-RWF-SPL-CHG (WORK-SUB) NOT EQUAL '4'                  1020057
136730         MOVE WMS-SPL-CUR-DATA        TO WMS-SPL-PREV-DATA.       1003625
136735     MOVE WS-RWF-SPL-DATA (WORK-SUB)  TO WMS-SPL-CUR-DATA.        1003625
136740     MOVE WS-RWF-SPL-ANN (WORK-SUB 1) TO WMS-RATE1-ANNUAL.        1003625
136745     MOVE WS-RWF-SPL-DAF (WORK-SUB 1) TO WMS-RATE1-DAILY.         1003625
136750     MOVE WS-RWF-SPL-ANN (WORK-SUB 2) TO WMS-RATE2-ANNUAL.        1003625
136755     MOVE WS-RWF-SPL-DAF (WORK-SUB 2) TO WMS-RATE2-DAILY.         1003625
136760     MOVE WS-RWF-SPL-ANN (WORK-SUB 3) TO WMS-RATE3-ANNUAL.        1003625
136765     MOVE WS-RWF-SPL-DAF (WORK-SUB 3) TO WMS-RATE3-DAILY.         1003625
136770     MOVE WS-RWF-SPL-LMT (WORK-SUB 1) TO WMS-RATE1-LIMIT.         1003625
136775     MOVE WS-RWF-SPL-LMT (WORK-SUB 2) TO WMS-RATE2-LIMIT.         1003625
136780     PERFORM C2302 THRU C2302-EXIT.                               1003625
136785     PERFORM C2306 THRU C2306-EXIT.                               1003625
136790     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.          0266741
136795     GO TO C2106-SPLIT.                                           1003625
136800                                                                  1003625
136805 C2107.                                                           1003625
136810     MOVE WMS-RATE-REGION     TO HOLD-REGION.                     1003625
136815     MOVE WMS-ACCT-TYPE       TO HOLD-PRODUCT.                    1003625
136820     MOVE 001                 TO HOLD-PTR.                        1003625
136825     IF  WMS-PRM-RATE-KEY-LEVEL EQUAL '2'                         1003625
136830         MOVE SPACES TO HOLD-PRODUCT                              1003625
136835     ELSE                                                         1003625
136840         IF  WMS-PRM-RATE-KEY-LEVEL EQUAL '1'                     1003625
136845             MOVE SPACES TO HOLD-PRODUCT                          1003625
136850                            HOLD-REGION.                          1003625
136855     MOVE 'N' TO PRIME-CHG-FLG.                                   1003625
136860     MOVE +0  TO WORK-SUB,                                        1003625
136865                 PRIME-SUB,                                       1003625
136870                 PRIME-FUT.                                       1003625
136875 C2107-PRIME.                                                     1003625
136880     ADD +1 TO WORK-SUB.                                          1003625
136885     IF  WS-RWF-PRM-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
136890     OR  WS-RWF-PRM-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
136895         GO TO C2107-END.                                         1003625
136900     IF  WS-RWF-PRM-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
136905         GO TO C2107-PRIME.                                       1003625
136910     IF  WS-RWF-PRM-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
136915         MOVE WORK-SUB TO PRIME-FUT                               1003625
136920         GO TO C2107-END.                                         1003625
136925     IF  NOT EXISTING-ACCT                                        1003625
136926         GO TO C2107-PRIME.                                       1003625
136927     IF  WS-RWF-PRM-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
136928         MOVE 'Y' TO WS-RATE-DELETED                              1003625
136929         GO TO C2107-PRIME.                                       1003625
136930*----------------------------------------------------------------*1020057
136931*    DO NOT ALLOW RATE INCREASES IN THE FIRST YEAR FOR LOANS     *1020057
136932*    SUBJECT TO CREDIT CARD RULES.                               *1020057
136933*----------------------------------------------------------------*1020057
136934     IF  WS-RWF-PRM-CHG (WORK-SUB) NOT EQUAL '4'                  1020057
136935         IF  RATE-CHG-SW EQUAL '1'                                1020057
136936             IF  WS-RWF-PRM-ANN (WORK-SUB)                        1020057
136937                             GREATER THAN WMS-PRM-CUR-ANN         1020057
136938                 GO TO C2107-PRIME.                               1020057
136939     IF  WS-RWF-PRM-PERIOD (WORK-SUB) EQUAL 'C'                   1020057
136940         MOVE 'Y'      TO PRIME-CHG-FLG                           1020057
136941         MOVE WORK-SUB TO PRIME-SUB.                              1020057
136945     IF  WS-RWF-PRM-CHG (WORK-SUB) NOT EQUAL '4'                  1003625
136950         MOVE WMS-PRM-CUR-DATA        TO WMS-PRM-PREV-DATA.       1003625
136955     MOVE WS-RWF-PRM-DATA (WORK-SUB)  TO WMS-PRM-CUR-DATA.        1003625
136960     GO TO C2107-PRIME.                                           1003625
136962 C2107-END.                                                       1003625
136963     EXIT.                                                        1003625
136965                                                                  1003625
136970 C2108.                                                           1003625
136972     IF  WMS-NB-DC-ABM EQUAL TO '1'                               9915749
136973         GO TO C2109-END.                                         9915749
136975     IF WMS-PREV-SPLIT-RATE-PTR GREATER +0                        1003625
136980         GO TO C2109.                                             1003625
136985     IF WMS-PREV-INT-PTR EQUAL +0                                 1003625
136990         GO TO C2109-END.                                         1003625
136995     MOVE WMS-RATE-REGION    TO HOLD-REGION.                      1003625
137000     MOVE WMS-ACCT-TYPE      TO HOLD-PRODUCT.                     1003625
137005     MOVE WMS-PREV-INT-PTR   TO HOLD-PTR.                         1003625
137010     IF  WMS-LN-OLD-RATE-KEY-LEVEL EQUAL '2'                      1003625
137015         MOVE SPACES TO HOLD-PRODUCT                              1003625
137020     ELSE                                                         1003625
137025         IF  WMS-LN-OLD-RATE-KEY-LEVEL EQUAL '1'                  1003625
137030             MOVE SPACES TO HOLD-PRODUCT                          1003625
137035                            HOLD-REGION.                          1003625
137040     MOVE 'N' TO PREV-LOAN-CHG-FLG.                               1003625
137045     MOVE +0  TO WORK-SUB,                                        1003625
137050                 PREV-LOAN-SUB,                                   1003625
137055                 PREV-LOAN-FUT.                                   1003625
137060 C2108-PREV-LOAN.                                                 1003625
137065     ADD +1 TO WORK-SUB.                                          1003625
137070     IF  WS-RWF-LN-KEY (WORK-SUB) EQUAL HIGH-VALUES               1003625
137075     OR  WS-RWF-LN-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY      1003625
137080         GO TO C2109-END.                                         1003625
137085     IF  WS-RWF-LN-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY         1003625
137090         GO TO C2108-PREV-LOAN.                                   1003625
137095     IF  WS-RWF-LN-PERIOD (WORK-SUB) EQUAL 'F'                    1003625
137100         MOVE WORK-SUB TO PREV-LOAN-FUT                           1003625
137105         GO TO C2109-END.                                         1003625
137110     IF  NOT EXISTING-ACCT                                        1003625
137111         GO TO C2108-PREV-LOAN.                                   1003625
137112     IF  WS-RWF-LN-CHG (WORK-SUB) EQUAL '6' OR '7'                1003625
137113         MOVE 'Y' TO WS-RATE-DELETED                              1003625
137114         GO TO C2108-PREV-LOAN.                                   1003625
137115*----------------------------------------------------------------*1020057
137116*    DO NOT ALLOW RATE INCREASES IN THE FIRST YEAR FOR LOANS     *1020057
137118*    SUBJECT TO CREDIT CARD RULES.                               *1020057
137119*----------------------------------------------------------------*1020057
137120     IF  WS-RWF-LN-CHG (WORK-SUB) NOT EQUAL '4'                   1020057
137121         IF  RATE-CHG-SW EQUAL '1'                                1020057
137122             IF  WS-RWF-LN-ANN (WORK-SUB)                         1020057
137123                             GREATER THAN WMS-PREV-ANNUAL         1020057
137124                 GO TO C2108-PREV-LOAN.                           1020057
137125     IF  WS-RWF-LN-PERIOD (WORK-SUB) EQUAL 'C'                    1020057
137126         MOVE 'Y'      TO PREV-LOAN-CHG-FLG                       1020057
137127         MOVE WORK-SUB TO PREV-LOAN-SUB.                          1020057
137130     IF  WS-RWF-LN-CHG (WORK-SUB) NOT EQUAL '4'                   1003625
137135         MOVE WMS-LN-OLD-CUR-DATA   TO WMS-LN-OLD-PREV-DATA.      1003625
137140     MOVE WS-RWF-LN-DATA (WORK-SUB) TO WMS-LN-OLD-CUR-DATA.       1003625
137145     MOVE WS-RWF-LN-ANN (WORK-SUB)  TO WMS-PREV-ANNUAL.           1003625
137150     MOVE WS-RWF-LN-DAF (WORK-SUB)  TO WMS-PREV-DAILY.            1003625
137155     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.          0266741
137160     GO TO C2108-PREV-LOAN.                                       1003625
137165                                                                  1003625
137170 C2109.                                                           1003625
137175     MOVE WMS-RATE-REGION     TO HOLD-REGION.                     1003625
137180     MOVE WMS-ACCT-TYPE       TO HOLD-PRODUCT.                    1003625
137185     MOVE WMS-PREV-SPLIT-RATE-PTR TO HOLD-PTR.                    1003625
137190     IF  WMS-SPL-OLD-RATE-KEY-LEVEL EQUAL '2'                     1003625
137195         MOVE SPACES TO HOLD-PRODUCT                              1003625
137200     ELSE                                                         1003625
137205         IF  WMS-SPL-OLD-RATE-KEY-LEVEL EQUAL '1'                 1003625
137210             MOVE SPACES TO HOLD-PRODUCT                          1003625
137215                            HOLD-REGION.                          1003625
137220     MOVE 'N' TO PREV-SPLIT-CHG-FLG.                              1003625
137225     MOVE +0  TO WORK-SUB,                                        1003625
137230                 PREV-SPLIT-SUB,                                  1003625
137235                 PREV-SPLIT-FUT.                                  1003625
137240 C2109-PREV-SPLIT.                                                1003625
137245     ADD +1 TO WORK-SUB.                                          1003625
137250     IF  WS-RWF-SPL-KEY (WORK-SUB) EQUAL HIGH-VALUES              1003625
137255     OR  WS-RWF-SPL-KEY (WORK-SUB) GREATER HOLD-WORK-RATE-KEY     1003625
137260         GO TO C2109-END.                                         1003625
137265     IF  WS-RWF-SPL-KEY (WORK-SUB) LESS HOLD-WORK-RATE-KEY        1003625
137270         GO TO C2109-PREV-SPLIT.                                  1003625
137275     IF  WS-RWF-SPL-PERIOD (WORK-SUB) EQUAL 'F'                   1003625
137280         MOVE WORK-SUB TO PREV-SPLIT-FUT                          1003625
137285         GO TO C2109-END.                                         1003625
137290     IF  NOT EXISTING-ACCT                                        1003625
137291         GO TO C2109-PREV-SPLIT.                                  1003625
137292     IF  WS-RWF-SPL-CHG (WORK-SUB) EQUAL '6' OR '7'               1003625
137293         MOVE 'Y' TO WS-RATE-DELETED                              1003625
137294         GO TO C2109-PREV-SPLIT.                                  1003625
137295*----------------------------------------------------------------*1020057
137296*    DO NOT ALLOW RATE INCREASES IN THE FIRST YEAR FOR LOANS     *1020057
137298*    SUBJECT TO CREDIT CARD RULES.                               *1020057
137299*----------------------------------------------------------------*1020057
137300     IF  WS-RWF-SPL-CHG (WORK-SUB) NOT EQUAL '4'                  1020057
137301         IF  RATE-CHG-SW EQUAL '1'                                1020057
137302             IF (WS-RWF-SPL-ANN (WORK-SUB 1)                      1020057
137303                             GREATER THAN WMS-SPL-OLD-CUR-ANN (1) 1020057
137304             OR  WS-RWF-SPL-ANN (WORK-SUB 2)                      1020057
137305                             GREATER THAN WMS-SPL-OLD-CUR-ANN (2) 1020057
137306             OR  WS-RWF-SPL-ANN (WORK-SUB 3)                      1020057
137307                             GREATER THAN WMS-SPL-OLD-CUR-ANN (3))1020057
137309                 GO TO C2109-PREV-SPLIT.                          1020057
137310     IF  WS-RWF-SPL-PERIOD (WORK-SUB) EQUAL 'C'                   1020057
137311         MOVE 'Y'      TO PREV-SPLIT-CHG-FLG                      1020057
137312         MOVE WORK-SUB TO PREV-SPLIT-SUB.                         1020057
137313     IF  WS-RWF-SPL-CHG (WORK-SUB) NOT EQUAL '4'                  1020057
137315         MOVE WMS-SPL-OLD-CUR-DATA   TO WMS-SPL-OLD-PREV-DATA.    1003625
137320     MOVE WS-RWF-SPL-DATA (WORK-SUB) TO WMS-SPL-OLD-CUR-DATA.     1003625
137325     GO TO C2109-PREV-SPLIT.                                      1003625
137330 C2109-END.                                                       1003625
137335     EXIT.                                                        1003625
137340                                                                  1003625
137345 C2100-CONT.                                                      1003625
137350     IF  WMS-EXPANSION-IND EQUAL TO '0', GO TO C2180.             1003625
137355     IF  WMS-DC-TRLR EQUAL TO '1'                                 1003625
137360         IF  WMS-DC-DELETE EQUAL TO '1'                           1003625
137365             MOVE '9' TO WMS-DC-DELETE.                           1003625
137370     IF  WMS-MARKET-TRLR EQUAL TO '1'                             1003625
137375         IF  WMS-MARKET-DELETE EQUAL TO '1'                       1003625
137380             MOVE '9' TO WMS-MARKET-DELETE.                       1003625
137385     IF  WMS-TARGET-AMT-TRLR EQUAL TO '1'                         1003625
137390         IF  WMS-TARGET-DELETE EQUAL TO '1'                       1003625
137395             MOVE '9' TO WMS-TARGET-DELETE.                       1003625
137400     IF  WMS-SAVINGS-TRLR EQUAL TO '1'                            1003625
137405         IF  WMS-INT-STATUS EQUAL TO '8'                          1003625
137410             MOVE '9' TO WMS-INT-STATUS                           1003625
137415         ELSE                                                     1003625
137420             PERFORM C2103 THRU C2103A-END                        0316967
137421             IF  WS-RATE-DELETED EQUAL 'Y'                        1003625
137422                 PERFORM R0015-FM-SAV THRU R0015-FM-SAV-END       1003625
137423                 MOVE 'N' TO WS-RATE-DELETED.                     1003625
137424     IF  WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
137425         IF  WMS-LOAN-TRLR EQUAL TO '1'                           1105504
137430             IF  WMS-LOAN-STATUS EQUAL TO '4'                     1105504
137435                 MOVE '9' TO WMS-LOAN-STATUS                      1105504
137440             ELSE                                                 1105504
137445                 PERFORM C2105 THRU C2109-END                     1105504
137446                 IF  WS-RATE-DELETED EQUAL 'Y'                    1105504
137447                     PERFORM R0015-FM-LN                          1105504
137448                        THRU R0015-FM-PREV-LN-END                 1105504
137449                     MOVE 'N' TO WS-RATE-DELETED.                 1105504
137450     IF  WMS-LIMIT-TRANSFER EQUAL TO '1'                          1003625
137455         IF  WMS-LIMIT-TRAN-DELETE EQUAL TO '1'                   1003625
137460             MOVE '9' TO WMS-LIMIT-TRAN-DELETE.                   1003625
137465     IF WMS-SOC-SEC-NA EQUAL TO '1'                               1003625
137470         IF WMS-SSN-DELETE EQUAL TO '1'                           1003625
137475             MOVE '9' TO WMS-SSN-DELETE.                          1003625
137480     IF  WMS-DCD-TAX-DATA-TRLR EQUAL '1'                          1003625
137485         IF  WMS-DCD-STATUS EQUAL '1'                             1003625
137490             MOVE '9' TO WMS-DCD-STATUS.                          1003625
137495     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            1003625
137500         IF  WMS-OD-STATUS EQUAL '2'                              1003625
137505             MOVE '9' TO WMS-OD-STATUS                            1003625
137510         ELSE                                                     1003625
137515             PERFORM C2104 THRU C2104-END                         1003625
137516             IF  WS-RATE-DELETED EQUAL 'Y'                        1003625
137517                 PERFORM R0015-FM-OD THRU R0015-FM-OD-END         1003625
137518                 MOVE 'N' TO WS-RATE-DELETED.                     1003625
137520     IF  WMS-INFO-TRLR EQUAL '1'                                  1003625
137525         IF  WMS-INFO-DELETE EQUAL '1'                            1003625
137530             MOVE '9' TO WMS-INFO-DELETE.                         1003625
137535     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                           1003625
137540         IF  WMS-SC-DELETE EQUAL '1'                              1003625
137545             MOVE '9' TO WMS-SC-DELETE.                           1003625
137550     IF  WMS-EFA-TRLR EQUAL TO '1'                                1003625
137555         IF  WMS-EFA-DELETE EQUAL TO '1'                          1003625
137560             MOVE '9' TO WMS-EFA-DELETE.                          1003625
137648******************************************************************9915850
137649*    THIS AREA HANDLES THE SWAPPING OF THE PRIMARY AND SECONDARY *9915850
137650*    NAME/ADDRESS TRAILERS BASED ON THE START DATE IN TRAILER 2. *9915850
137651******************************************************************9915850
137652     IF  WMS-NME-ADDR-TLRS LESS THAN +2                           9915850
137653         GO TO C2180.                                             9915850
137654     MOVE +0 TO X.                                                9915850
137655     MOVE SPACES TO HOLD-ZIP.                                     9915850
137656 C2110.                                                           9915850
137657     ADD +1 TO X.                                                 9915850
137658     IF  X EQUAL +9 OR GREATER THAN WMS-NA-NO-LINES-2             9915850
137659         GO TO C2180.                                             9915850
137660     IF  WMS-NAME-ADDR-TYPE-2 (X) EQUAL '3'                       9915850
137661     AND WMS-LINE-NO-2 (X) EQUAL '1'                              9915850
137662         MOVE WMS-NA-ZIP-CODE-2 (X) TO HOLD-ZIP                   9915850
137663         GO TO C2110.                                             9915850
137664     IF  WMS-NAME-ADDR-TYPE-2 (X) EQUAL '5'                       9915850
137665     AND WMS-NA-START-DATE-2 (X) NOT EQUAL SPACES                 9915850
137666         SUBTRACT WBC-PAST-ACCR-DAYS FROM WMS-NA-REMAIN-DAYS-2 (X)0266741
137667         SUBTRACT WBC-ACCRUAL-DAYS FROM WMS-NA-REMAIN-DAYS-2 (X)  0266741
137668     ELSE                                                         9915850
137669         GO TO C2110.                                             9915850
137670     IF  WMS-NA-REMAIN-DAYS-2 (X) GREATER THAN ZERO               9915850
137671         GO TO C2180.                                             9915850
137672 C2120.                                                           9915850
137673     MOVE HOLD-ZIP TO WMS-ZIP-SAVE.                               9915850
137674     MOVE +0 TO X.                                                9915850
137675     MOVE SPACES TO IMEX-REC-12.                                  9915850
137676     MOVE +1 TO EX12-NA-PTR.                                      9915850
137677     MOVE WMS-NA-COUNTRY TO EX12-NA-COUNTRY.                      9915850
137678 C2130.                                                           9915850
137679     ADD +1 TO X.                                                 9915850
137680     IF  X NOT GREATER THAN WMS-NA-NO-LINES-1                     9915850
137681         MOVE WMS-NA-LINE (X) TO EX12-NA-LINE (X)                 9915850
137682         GO TO C2130.                                             9915850
137683     PERFORM C2150 THRU C2150-EXIT.                               9915850
137684     MOVE +0 TO X.                                                9915850
137685     MOVE SPACES TO IMEX-REC-12.                                  9915850
137686     MOVE +2 TO EX12-NA-PTR.                                      9915850
137687     MOVE WMS-NA-COUNTRY-2 TO EX12-NA-COUNTRY.                    9915850
137688 C2140.                                                           IM005
137689     ADD +1 TO X.                                                 IM005
137690     IF  X NOT GREATER THAN WMS-NA-NO-LINES-2                     IM005
137691         MOVE WMS-NA-LINE-2 (X) TO EX12-NA-LINE (X)               IM005
137692         GO TO C2140.                                             IM005
137693 C2150.                                                           IM005
137694     MOVE WMS-DATE-LAST-MAINT    TO  EX12-DATE-LAST-MAINT.        0266748
137696     MOVE 'B0B2' TO IMEX-EX-CODE.                                 IM006
137697     MOVE '12' TO IMEX-REC-NO.                                    IM006
137698     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     IM006
137699 C2150-EXIT.                                                      IM006
137700     EXIT.                                                        IM006
137701 C2160.                                                           IM006
137702     MOVE WMS-NAME-ADDRESS-TRAILER-2 TO WORK-NAME-ADDRESS.        IM006
137703     MOVE WMS-NB-STMT-SPECL-HANDL-2  TO WORK-STMT-SPECL-HANDL.    9915749
137704     MOVE WMS-NAME-ADDRESS-TRAILER-1                              1105504
137705         TO WMS-NAME-ADDRESS-TRAILER-2.                           1105504
137706     MOVE WMS-STMT-SPECL-HANDL TO WMS-NB-STMT-SPECL-HANDL-2.      1105504
137707     MOVE WORK-NAME-ADDRESS TO WMS-NAME-ADDRESS-TRAILER-1.        1105504
137708     MOVE WORK-STMT-SPECL-HANDL TO WMS-STMT-SPECL-HANDL.          1105504
137709     MOVE WMS-NA-NO-LINES-1 TO X.                                 1105504
137710     MOVE ZERO TO WMS-NA-REMAIN-DAYS-1 (X).                       1105504
137711     MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE.                        0266741
137712     MOVE WMS-NA-START-DATE-1 (X) TO DT-HIGH-DATE.                1105504
137713     CALL 'SIDIF1' USING DATE-AREA.                               1105504
137714     IF  RET-DAYS NOT EQUAL ZERO                                  1105504
137715         GO TO C2170.                                             1105504
137716     MOVE WMS-NA-START-YR-1 (X) TO HOLD-Y.                        1105504
137717     ADD +1 TO HOLD-9Y.                                           1105504
137718     MOVE HOLD-Y TO WMS-NA-START-YR-1 (X).                        1105504
137719 C2170.                                                           1105504
137720     MOVE +0 TO X.                                                1105504
137721     IF WBC-SHORT-NAME-PHASE EQUAL SPACES                         0266741
137722         GO TO C2175.                                             1105504
137723     CALL 'SILINK' USING      IM22-SHORT-NAME-PHASE               1105504
137724                              WMS-SYS-TYPE                        1105504
137725                              WMS-NAME-ADDRESS (1)                1105504
137726                              WORK-SHORT-NAME                     0266741
137727                              SIWS-LANG-SUB.                      0266741
137728     MOVE '15'                TO IMEX-REC-NO.                     0266741
137729     MOVE 'B0  '              TO IMEX-EX-CODE.                    0266741
137730     MOVE WMS-SHORT-NAME      TO EX15-MST-OLD-DATA.               0266741
137731     MOVE WORK-SHORT-NAME     TO WMS-SHORT-NAME,                  0266741
137732                                 IM-EXC15-FM-NEW-DATA.            0266741
137733     MOVE IM-EXC15-FM-TRAN    TO EX15-FM-TRAN.                    0266741
137734     MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT.            0266741
137735     PERFORM WRITE-EX-MST     THRU WRITE-EX-EXIT.                 0266741
137736     MOVE WBC-CAPTURE-DATE     TO WMS-DATE-LAST-MAINT.            0266741
137739 C2175.                                                           0266741
137740     ADD +1 TO X.                                                 0266741
137741     IF  X EQUAL +9 OR GREATER THAN WMS-NA-NO-LINES-2             0266741
137742         GO TO C2180.                                             0266741
137743     IF  WMS-NAME-ADDR-TYPE-2 (X) EQUAL '5'                       0266741
137744     AND WMS-NA-START-DATE-2 (X) NOT EQUAL SPACES                 0266741
137745         MOVE WMS-NA-START-DATE-2 (X) TO DT-HIGH-DATE             0266741
137746         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0266741
137747         CALL 'SIDIF1' USING DATE-AREA                            0266741
137748         MOVE RET-DAYS TO WMS-NA-REMAIN-DAYS-2 (X)                0266741
137749     ELSE                                                         0266741
137750         GO TO C2175.                                             0266741
137755 C2180.                                                           0266741
137756     MOVE 'N' TO EXISTING-ACCT-SW.                                0266741
137757     MOVE ZERO TO WORK-FLAGS                                      0266741
137765                  WMS-NSF-TODAY                                   0266741
137800                  WMS-OD-TODAY
137820                  WMS-UNAVAIL-TODAY                               IM007
137850                  TRIAL-CODE
137900                  WMS-SPEC-INST-TODAY
137910                  SAVE-IOD-TAX-ST                                 0266788
137920                  SAVE-IOD-TAX-LOC                                0266788
137930                  SAVE-SAV-TAX-ST                                 0266788
137940                  SAVE-SAV-TAX-LOC                                0266788
137950                  SEQ-CTR
137952                  OD-CTR-FDIC                                     0927850
137954                  NSF-CTR-FDIC                                    0927850
137956                  BATCH-RUN-FDIC                                  0930077
138000                  EX-SEQ-CTR
138010                  NSF-RVRSL-CTR                                   1104882
138050                  NP-REV-CTR
138100                  TDAY-IOD-PMT
138150                  TDAY-SAV-PMT
138200                  WMS-TODAYS-DEBITS
138250                  WMS-TODAYS-DEBITS-NO
138255                  BATCH-RUN-BALANCE                               2016572
138260                  BATCH-RUN-OD                                    2016572
138300                  HIFI-INEL-FLAG
138350                  FS-DB
138400                  FS-CR
138410                  WXI-SAME-DAY                                    2016639
138420                  WXI-NEXT-DAY                                    2016639
138430                  WXI-PROD-ALLOW                                  2016639
138440                  WXI-EXCLUDE-BAL                                 2016639
138450                  ACCRUAL-DAY
138460                  LOAN-TODAY                                      1002953
138470                  LOAN-ACCRUAL-DAY                                IM005
138480                  LOAN-MIN-BAL                                    IM005
138490                  HOLD-SAV-XFER                                   IM005
138495                  HOLD-EFA-NSF-AMT                                IM007
138497                  WORK-BUSINESS-DAYS                              IM007
138500                  HOLD-ACCRUAL-DAYS.
138505     MOVE WBC-CAPTURE-MO   TO ACCR-MO.                            0266741
138510     MOVE WBC-CAPTURE-DA   TO ACCR-DA.                            0266741
138515     MOVE WBC-CAPTURE-YR   TO ACCR-YR.                            0266741
138520     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
138525         MOVE '20'         TO ACCR-CC                             0902213
138530     ELSE                                                         0902213
138535         MOVE '19'         TO ACCR-CC.                            0902213
138540     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            0902213
138542     MOVE WMS-DAILY-RATE-CODE TO HOLD-DAILY-RATE-CODE.            0817657
138544     MOVE WMS-LOAN-360-DAY-FACTOR TO HOLD-LOAN-360-DAY-FACTOR.    0817657
138546     MOVE 'N' TO WK-STATUS-CHG-SW.                                1017800
138550     MOVE ZERO TO AMT-PD.
138600     MOVE 'F' TO MAX-TRNSFR-FG.
138650     MOVE 'F' TO IOD-FLAG.
138660     MOVE 'F' TO BONUS-CLEAR.                                     2016374
138700     MOVE 'F' TO IOD-CLEAR.
138750     MOVE 'F' TO SAV-CLEAR.
138770     MOVE 'F' TO SUPP-STMT-SW.                                    IM006
138800     MOVE ' ' TO SVCH-CYCLE-DAYX.
138850     MOVE '1' TO STMT-CYCLE-DAY.
138870     MOVE '0' TO LOAN-COSTS-FLAG.                                 IM006
138880     MOVE 'F' TO LOAN-AGGR-SW.                                    IM006
138890     MOVE WBC-ACCRUAL-DAYS TO PYMT-CYCLE-DAY.                     0266741
138893     MOVE '0' TO SKIP-LOAN-ACCR-SW.                               IM006
138894     MOVE '0' TO PRIME-BILL-FLAG.                                 IM008
138895     MOVE '0' TO SAVE-PAST-ACCR-FLAG.                             IM008
138896     MOVE SPACES TO WORK-LOAN-PYMT-DATE.                          IM006
138897     MOVE SPACES TO HOLD-BH-DATE.                                 1004921
138898     MOVE +0  TO ACCR-DAYS-SKIPPED.                               IM006
138899     MOVE SPACES TO STATEMENT-REQUEST-TBL.                        IM006
138900     MOVE +1 TO X.                                                IM007
138901     COPY IMPD31CL.                                               9915851
138902     MOVE '0' TO FUNDING-FLAG                                     9915749
138904                 DB-WAITING.                                      9915749
138906     MOVE SPACES TO SAVE-FUNDING-TRANS                            9915749
138908                    HOLD-FOR-FUNDING.                             9915749
138910     MOVE ZERO TO FUNDING-AMT.                                    9915749
138912     MOVE ZERO TO WS-FUNDING-USED.                                9915749
138914     MOVE 'N' TO WS-FIRST-DEBIT.                                  9915749
138916     MOVE 'N' TO WS-FIRST-LOC-ACT.                                9915749
138918     SET FEE-INX TO +1.                                           9915749
138919     PERFORM C2181 200 TIMES.                                     9915845
138920 C2180-EXIT.                                                      9915845
138921       EXIT.                                                      9915845
138922 C2180A.                                                          9915845
138923     GO TO C2182.                                                 9915845
138924 C2181.                                                           9915749
138926     MOVE ' ' TO FEE-ACCUM-COMPL-IND (FEE-INX).                   9915749
138928     SET FEE-INX UP BY +1.                                        9915749
138949 C2182.                                                           IM007
138956     IF  X LESS THAN +9                                           IM007
138957         MOVE +0 TO WORK-BCA-51-AMT (X).                          IM007
138958     MOVE +0 TO WORK-BCA-52-AMT (X).                              IM007
138970     MOVE +0 TO WORK-BCA-54-AMT (X).                              IM007
138977     MOVE +0 TO WORK-BCA-55-AMT (X).                              IM007
138984     MOVE +0 TO WORK-BCA-56-AMT (X).                              IM007
138991     MOVE +0 TO WORK-BCA-57-REDEP (X).                            IM007
138994     MOVE +0 TO WORK-BCA-57-RCTDC (X).                            IM007
138995     MOVE +0 TO WORK-BCA-57-LWRSK (X).                            IM007
138997     IF  X LESS THAN 13                                           IM007
139005         ADD +1 TO X                                              IM007
139012         GO TO C2182.                                             IM007
139019 C2183.  EXIT.                                                    IM007
139020 C2184.                                                           0902970
139030     IF  WMS-GL-COST-CENTER EQUAL SPACES                          0902970
139035         MOVE 'Y' TO GL-BUILD-MASTER-SW                           0902970
139040         PERFORM K5700 THRU K5700-EXIT.                           0902970
139050     IF  GL-CURRENT-COST-CTR EQUAL SPACES                         0902970
139060         MOVE WMS-CONTROL-KEY TO WK-GL-ORIG-ACCT                  0902970
139100         MOVE WMS-GL-COST-CENTER TO GL-CURRENT-COST-CTR.          0902970
139250     IF  WMS-GL-COST-CENTER NOT EQUAL GL-CURRENT-COST-CTR         0902970
139410         PERFORM C1009 THRU C1009-EXIT                            0902970
139430         MOVE WMS-CONTROL-KEY TO WK-GL-ORIG-ACCT                  0902970
139450         MOVE WMS-GL-COST-CENTER TO GL-CURRENT-COST-CTR.          0902970
139800 C2184-EXIT.                                                      IM007
139850     EXIT.
139900 C2185.
139950     MOVE WBC-STATEMENT-OPTIONS (WMS-STMT-FORMAT) TO STMT-OPT-HOLD0266741
139960     MOVE WBC-LOAN-BILL-FORMAT (WMS-STMT-FORMAT) TO               0266741
139970                                                 LOAN-BILL-FORMAT.1002512
139980     MOVE WBC-CLSD-ACCT-STMT (WMS-STMT-FORMAT) TO CLSD-ACCT-STMT. 0266741
140000     IF WBC-SERIAL-FORMAT (WMS-STMT-FORMAT) EQUAL TO '1'          0266741
140050         MOVE '1' TO SERIAL-STMT.
140100 C2185-EXIT. EXIT.
140150 C2186.
140200     MOVE WMS-CURR-BAL TO ACCT-BAL-IN.
140205     MOVE WMS-CURR-BAL TO WMS-NB-TODAYS-BEGIN-BAL.                1105504
140250     MOVE WMS-DDA-BAL TO DDA-BALANCE-IN.
140300     MOVE WMS-DDA-BAL TO RHA-OLD-DDA-BAL                          IM008
140310                         RHA-OLD-OD-BAL.                          IM008
140314*--------------------------------------------------------------*  2016639
140316*    INITIALIZE EXTERNAL INVESTMENT BEGINNING FIELDS           *  2016639
140318*--------------------------------------------------------------*  2016639
140320     MOVE WMS-XINV-BALANCE       TO  WXI-XINV-BAL-IN              2016639
140322                                     WXI-XINV-BALANCE.            2016639
140324     MOVE WMS-XINV-LINK-IND      TO  WXI-LINK-IND-IN              2016639
140326                                     WXI-LINK-IND-OUT.            2016639
140328     IF  (WMS-XINV-LINK-IND   EQUAL  'L' OR 'P')                  2016639
140330     AND WMS-XINV-PROCESS-IND EQUAL  '1'                          2016639
140332         MOVE '1'                TO  WXI-SAME-DAY.                2016639
140334     IF  WMS-XINV-LINK-IND    EQUAL  'L'                          2016639
140336     AND WMS-XINV-PROCESS-IND EQUAL  '2'                          2016639
140338         MOVE '1'                TO  WXI-NEXT-DAY.                2016639
140350     IF WMS-LARGE-ITEMS NOT EQUAL TO ZERO
140400         MOVE '1' TO LG-ITEM-FLAG
140450         MOVE WBC-LRG-ITEM (WMS-LARGE-ITEMS) TO HOLD-LG-ITEM.     0266741
140500     MOVE WMS-STATUS TO STATUS-IN, WK-IM-STATUS-IN.
140502     MOVE WMS-OD-REGE-OPT-CODE TO OD-REGE-OPT-CODE-IN.            1020116
140520     MOVE WMS-BKUP-WTHLD-FLAG TO SAV-BKUP-WTHLD-FLAG.             IM007
140550     MOVE WMS-DATE-LAST-MONETARY-ACT TO DATE-LAST-ACTIVE.
140600     IF  WMS-DATE-LAST-MONETARY-ACT NOT EQUAL SPACES
140650         MOVE WMS-DATE-LAST-MONETARY-ACT TO RHW-DATE-LAST-ACT
140700     ELSE
140750     IF  WMS-DATE-OPENED NOT EQUAL SPACES
140800         MOVE WMS-DATE-OPENED TO RHW-DATE-LAST-ACT
140850     ELSE
140900         MOVE WBC-CAPTURE-DATE TO RHW-DATE-LAST-ACT.              0266741
140950     MOVE WMS-DATE-LAST-SERV-CHG TO SAVE-SC-DATE.
140952     MOVE WMS-IOD-TIS-AGGR-BAL  TO IOD-TIS-AGGR-BAL (1).          1004015
140954     MOVE WMS-IOD-TIS-AGGR-DAYS TO IOD-TIS-AGGR-DAY (1).          1004015
140956     MOVE WMS-IOD-TIS-EARN-INT  TO IOD-TIS-EARN-INT (1).          1004015
141000     MOVE +0 TO WMS-IOD-ACCRD-TODAY                               1003110
141002                WMS-IOD-ACCRUAL-BAL.                              1003110
141006     MOVE WMS-HOLD-AMT TO SAVE-HOLD-AMT.                          IM004
141012     IF  WMS-BANK-AVAIL-TRLR EQUAL '1'                            IM007
141018         MOVE ZERO TO SAVE-BANK-AMT                               IM007
141021         MOVE WMS-BANK-AVAIL-TRAILER TO SAVE-BANK-TRLR.           IM007
141028     IF  WMS-CUST-AVAIL-TRLR EQUAL '1'                            IM007
141036         MOVE ZERO TO SAVE-CUST-AMT                               IM007
141040         MOVE WMS-CUST-AVAIL-TRAILER TO SAVE-CUST-TRLR.           IM007
141050     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
141100         MOVE WMS-OD-STATUS TO WK-OD-STATUS-IN
141150         MOVE ZERO TO WMS-OD-ACCRD-TDY.
141155     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
141160         MOVE ZERO TO WMS-INV-SVC-ACCRD-TDY                       1004554
141165                      WMS-INV-SVC-COLL-TDY                        1004554
141170         MOVE WMS-DDA-BAL TO WK-INVEST-DDA-BAL.                   1004554
141200     IF  WMS-DCD-TAX-DATA-TRLR EQUAL '1'
141250         MOVE WMS-DCD-STATUS TO WK-DCD-STATUS-IN.
141252     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0316967
141256         MOVE WMS-INT-CUR-BAL TO RHA-OLD-SAV-BAL.                 0316967
141260     IF  WMS-EFA-TRLR EQUAL '1'                                   IM007
141270         MOVE WMS-EFA-STATUS-FLAG TO WK-EFA-STATUS-IN.            IM007
141273******************************************************************IM007
141276***  ALL DDA ACCOUNTS ARE SUBJECT TO REG CC EXCEPT             ***IM007
141279***      MONEY MARKETS (WMS-MMDA-INDICATOR EQUAL 1)            ***0902509
141280***      STMT SAVINGS  (WMS-MMDA-INDICATOR EQUAL 2 OR 3)          0437111
141282***      TREASURY ACCOUNTS   (WMS-SYS-TYP-1-2 EQUAL '03')      ***IM007
141285***      CORRESPONDENT ACCTS (WMS-SYS-TYP-1-2 EQUAL '04')      ***IM007
141286***      UPDATE EFAA PHASE IM31EFAP TO MODIFY THE ACCOUNT      ***0627536
141287***      SELECTION.                                            ***0627536
141288******************************************************************IM007
141290     IF WBC-REG-CC EQUAL '0'                                      0627536
141291         MOVE '1' TO NON-EFAA-ACCOUNT                             0627536
141292     ELSE                                                         0627536
141293         MOVE '3' TO CALL-EFAA-FLAG                               0627536
141294         PERFORM K2157-CALL-PHASE THRU K2157-CALL-PHASE-EXIT      0627536
141295         MOVE '0' TO CALL-EFAA-FLAG.                              0627536
141296                                                                  0627536
141297******************************************************************1020116
141298***  DETERMINE IF ACCOUNT IS SUBJECT TO REG E                  ***1020116
141299***  FOR ATM/POS ONE TIME DEBITS                               ***1020116
141300******************************************************************1020116
141301     COPY IMPDREFF.                                               1020116
141302 C2187.                                                           1020116
141304     MOVE WMS-CONTROL-1          TO RHW-CTL1.                     1020116
141305     MOVE WMS-CURR-CODE          TO RHW-CURR-CODE.                9915845
141310     MOVE WMS-RATE-REGION        TO RHW-REGION.                   1003625
141320     MOVE WMS-ACCT-TYPE          TO RHW-PRODUCT.                  1003625
141325     MOVE SPACES TO RHA-EXCEPTION.                                IM008
141330     MOVE '0'    TO RHA-CHECK-ITEM.                               IM008
141340 C2189.  EXIT.                                                    IM008
141350 C2190.
141352*--- SKIP AUTOBORROW ACCOUNTS -----------------------------------*9915749
141353     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915749
141354         GO TO C2195.                                             9915749
141355     IF  WMS-LOAN-TRLR EQUAL TO '1'                               1003979
141357     AND WMS-LOAN-INCR-PTR NUMERIC                                1003979
141360     AND WMS-LOAN-INCR-PTR GREATER THAN ZERO                      1003979
141365         MOVE WBC-LOAN-INCR OF WBC-LOAN-INCR-TABLE                0266741
141370         (WMS-LOAN-INCR-PTR) TO HOLD-INCRM                        1003979
141375     ELSE                                                         1003979
141380         MOVE ZEROES         TO HOLD-INCRM.                       1003979
141400     IF WMS-LOAN-TRLR EQUAL TO '1'
141450         MOVE WMS-LOAN-STATUS TO LOAN-STATUS-IN,
141500                                 WK-LN-STATUS-IN
141550         MOVE WMS-PRIN-BAL TO LOAN-BAL-IN
141600         MOVE WMS-PREV-BAL TO LOAN-PREV-BAL-IN
141650         MOVE +0 TO WMS-LOAN-ACCR-TODAY
141800         PERFORM CALC-AVAIL-BAL THRU CALC-3
141820         ADD WMS-COSTS-UNEARNED TO LOAN-BEG-COSTS                 IM006
141821                                   WS-GL-LOAN-BEG-COSTS           0902970
141850         IF WMS-PYMT-CLEAR EQUAL TO '1'
141900             MOVE '0' TO WMS-PYMT-CLEAR
141950             MOVE WMS-PAST-DUE TO WMS-PREV-PAST-DUE (1)
142000             MOVE WMS-LOAN-TO-MAKE-PYMT TO WMS-PYMT-LOAN (1)
142050             MOVE WMS-PAYMENT-SUSPECT TO WMS-SUSPECT-FLAG (1)
142100             MOVE WMS-OVER-THIS-CYCLE TO WMS-OVER-FLAG (1)
142150             MOVE '0' TO WMS-OVER-THIS-CYCLE
142200                         WMS-LOAN-TO-MAKE-PYMT
142250                         WMS-PAYMENT-SUSPECT
142300                         WMS-LOAN-NEW-THIS-CYCLE
142350             ADD WMS-PRIN-BAL, WMS-INTRST-BAL, WMS-OTHER-CHGS
142400                 GIVING WMS-HIGH-BAL-THIS-CYCLE
142450             MOVE ZERO TO WMS-DDA-DEPOSITS
142500         ELSE
142550             IF WMS-LOAN-NEW-THIS-CYCLE NOT EQUAL '1'
142600             AND LOAN-BAL-IN EQUAL ZERO
142650                 MOVE '2' TO WMS-LOAN-NEW-THIS-CYCLE.
142700 C2195.
142750     IF WMS-SAVINGS-TRLR NOT EQUAL TO '1'
142800         GO TO C2199.                                             0902213
142850 C2197.
142900     MOVE +0 TO WMS-INT-ACCRD-TODAY                               1003110
142910                WMS-INT-ACCRUAL-BAL.                              1003110
142950     IF  WMS-CMA-INDICATOR EQUAL '1' AND
143000         WMS-CMA-BALANCE-USE EQUAL '1'
143050         MOVE WMS-PREV-INT-BAL TO SAVINGS-BALANCE-IN
143100     ELSE
143150         MOVE WMS-INT-CUR-BAL TO SAVINGS-BALANCE-IN.
143200     MOVE WMS-INT-STATUS TO SAVINGS-STATUS-IN,
143250                            WK-SV-STATUS-IN.
143300     IF WMS-INT-INCREMNT GREATER THAN ZERO
143350         MOVE WBC-TRAN-INCR (WMS-INT-INCREMNT) TO HOLD-SAV-INCR   0266741
143400     ELSE
143450         MOVE ZERO TO HOLD-SAV-INCR.
143460     MOVE WMS-INT-TIS-AGGR-BAL  TO SAV-TIS-AGGR-BAL (1).          1004554
143470     MOVE WMS-INT-TIS-AGGR-DAYS TO SAV-TIS-AGGR-DAY (1).          1004554
143480     MOVE WMS-INT-TIS-EARN-INT  TO SAV-TIS-EARN-INT (1).          1004554
143481     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
143482         ADD +.005 WMS-INV-SVC-ACCRD-CYC GIVING HOLD-ACCR2        1004554
143483         ADD HOLD-ACCR2       TO INV-BEG-SVC-ACCRD                1004554
143484                                 WS-GL-INV-BEG-SVC-ACCRD          1004554
143485         ADD +.005 WMS-ACCR-INT GIVING HOLD-ACCR2                 1004554
143486         ADD HOLD-ACCR2       TO INV-DIV-ACCRD-BEG                1004554
143487                                 WS-GL-INV-DIV-ACCRD-BEG          1004554
143488         ADD WMS-YTD-INT-PAID TO INV-DIV-PAID-YTD-BEG             1004554
143489                                 WS-GL-INV-DIV-PAID-YTD-BEG       1004554
143490         ADD WMS-YTD-SAV-TAX  TO INV-TAX-YTD-BEG                  1004554
143491                                 WS-GL-INV-TAX-YTD-BEG            2012254
143492         ADD WMS-YTD-SAV-STATE-TAX TO INV-TAX-YTD-BEG-ST          2012254
143493                                      WS-GL-INV-TAX-YTD-BEG-ST    2012254
143494         ADD WMS-YTD-SAV-LOCAL-TAX TO INV-TAX-YTD-BEG-LOC         2012254
143495                                      WS-GL-INV-TAX-YTD-BEG-LOC.  2012254
143496     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
143497         ADD WMS-DUAL-YR-CUR-SAV-INT TO DUAL-IN-SV-INT-PAID-YTD   2012254
143498                                  WS-GL-DUAL-IN-SV-INT-PAID-YTD.  2012254
143500     IF  WMS-INT-STMT-CLEAR NOT EQUAL TO '1'                      1004554
143510         GO TO C2198.                                             1004554
143550     MOVE '0' TO WMS-INT-STMT-CLEAR.                              1004554
143600     MOVE ZERO TO WMS-INT-TR-CHG                                  1004554
143650                  WMS-INT-TRAN-NO                                 1004554
143700                  WMS-INT-TRAN-AMT                                1004554
143750                  WMS-DDA-MAX-CYCLE-NO                            1004554
143800                  WMS-DDA-MAX-CYCLE-AMT.                          1004554
143850     MOVE +9999999999999.99 TO WMS-INT-MIN-BALANCE.               9915845
143860     IF  BHW-SAV-FLAG EQUAL 'R'                                   0316967
143870         MOVE '1' TO  WBHS-SAV-CYCLE-TDY (1).                     1004554
143872     IF  BHW-SAV-FLAG EQUAL 'T'                                   0316967
143874         MOVE '1' TO  WBHT-SAVT-CYCLE-TDY (1).                    0316967
143880     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
143890         MOVE ZERO TO WMS-INV-SVC-COLL-CYC.                       1004554
143900 C2198.  EXIT.
143905 C2199.                                                           0902213
143910     IF  WMS-DDA-BAL LESS THAN ZERO                               0902213
143912     AND IBT-SKIP-SW EQUAL 'F'                                    0827814
143915         ADD +1 TO DDA-BEG-OD-NO, WS-GL-DDA-BEG-OD-NO             0902970
143920         ADD WMS-DDA-BAL TO DDA-BEG-OD-AMT, WS-GL-DDA-BEG-OD-AMT. 0902970
143925     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0902213
143930         IF  WMS-OD-ACCRL-BAL LESS THAN ZERO                      0902213
143935             ADD +1 TO OD-BEG-ACCT-NO, WS-GL-OD-BEG-ACCT-NO       0902970
143940             ADD WMS-OD-ACCRL-BAL TO OD-BEG-ACCT-BAL              0902970
143941                                     WS-GL-OD-BEG-ACCT-BAL.       0902970
143942     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
143943             ADD +1           TO T3-PLAN-BEG-NO                   0617360
143944                                 WS-GL-PLAN-BEG-NO                0617360
143945             ADD WMS-CURR-BAL TO T3-PLAN-BEG-AMT                  0617360
143946                                 WS-GL-PLAN-BEG-AMT               0617360
143947             ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1      0617360
143948             ADD HOLD-ACCR1   TO T3-PLAN-BEG-ACC                  0617360
143949                                 WS-GL-PLAN-BEG-ACC               0617360
143950             ADD WMS-IOD-YTD-TAX TO T3-PLAN-BEG-YTD-TAX           0617360
143951                                 WS-GL-PLAN-BEG-YTD-TAX.          0617360
143958 C2200.                                                           0617360
143959     IF WBC-ALT-DUAL-YR-OPTION EQUAL '0' OR '2'                   0617360
143960        IF WBC-PREV-YEAR-END NOT EQUAL '1', GO TO C2212           0617360
143961        ELSE GO TO C2201.                                         0617360
143962     IF WBC-PREV-ALT-DUAL-YEAR-END NOT EQUAL '1', GO TO C2215.    0617360
144000 C2201.                                                           0617360
144015     MOVE ZERO TO WMS-DDA-CHG-OFF-AMT.                            0637525
144020     IF WMS-LOAN-TRLR EQUAL '1'                                   9915858
144030         MOVE ZERO TO WMS-LOAN-AMORT-YTD                          9915858
144040                      WMS-LOAN-CHG-OFF-AMT.                       9915858
144050     IF WMS-YTD-AGGR-BAL NOT EQUAL TO ZERO
144100         DIVIDE WMS-YTD-AGGR-DAYS INTO WMS-YTD-AGGR-BAL
144150             GIVING WMS-AVG-BAL-LAST-YEAR
144200     ELSE MOVE ZERO TO WMS-AVG-BAL-LAST-YEAR.
144250     MOVE ZERO TO WMS-YTD-AGGR-BAL
144300                  WMS-YTD-AGGR-DAYS.
144310     MOVE ZERO TO WMS-XINV-YTD-AGGR                               2016639
144320                  WMS-XINV-YTD-DAYS.                              2016639
144322     MOVE WMS-YTD-ACCUM-SERV-CHG TO WMS-PYTD-ACCUM-SERV-CHG.      0617360
144324     MOVE ZERO TO WMS-YTD-ACCUM-SERV-CHG.                         0617360
144350     MOVE WMS-IOD-YTD-INT-PAID TO WMS-IOD-PRV-YTD-INT-PD.
144360     MOVE WMS-IOD-YTD-INT-PAID-1042 TO                            9915828
144370          WMS-IOD-PRV-YTD-INT-PD-1042.                            9915828
144400     MOVE WMS-IOD-YTD-TAX TO WMS-IOD-PREV-YTD-TAX.
144450     MOVE ZERO TO WMS-IOD-YTD-INT-PAID, WMS-IOD-YTD-INT-PAID-1042.9915828
144500     MOVE ZERO TO WMS-IOD-YTD-TAX.
144502     MOVE WMS-IOD-YTD-STATE-TAX TO WMS-IOD-PREV-YTD-STATE-TAX.    2012254
144504     MOVE ZERO TO WMS-IOD-YTD-STATE-TAX.                          2012254
144506     MOVE WMS-IOD-YTD-LOCAL-TAX TO WMS-IOD-PREV-YTD-LOCAL-TAX.    2012254
144508     MOVE ZERO TO WMS-IOD-YTD-LOCAL-TAX.                          2012254
144510     MOVE +0 TO WMS-CASH-AVAIL-YTD-AGGR.                          IM007
144520     MOVE +0 TO WMS-IOD-YTD-ACC-INT.                              1105132
144521     MOVE WMS-STMT-OVERDRAFT-CHGD-YTD                             0930023
144522                   TO WMS-STMT-OVERDRAFT-CHGD-PYTD.               0930023
144523     MOVE +0 TO WMS-STMT-OVERDRAFT-CHGD-YTD.                      0930023
144524     MOVE WMS-STMT-NSF-CHGD-YTD TO WMS-STMT-NSF-CHGD-PYTD.        0930023
144525     MOVE +0 TO WMS-STMT-NSF-CHGD-YTD.                            0930023
144526     MOVE WMS-OD-REGE-OPT-YTD TO WMS-OD-REGE-OPT-PYTD.            1020116
144527     MOVE +0 TO WMS-OD-REGE-OPT-YTD.                              1020116
144528     IF  WBC-REG-1042 EQUAL '1'                                   1020116
144530         IF  WMS-INFO-TRLR EQUAL '1'                              9916034
144535             IF  WMS-NRA-TAX-COUNTRY NOT EQUAL SPACES             9916034
144540                 IF  WMS-TIN-CERTIFICATION NOT EQUAL '8'          9916034
144545                     MOVE SPACES TO WMS-NRA-TAX-COUNTRY.          9916034
144550     IF WMS-LOAN-TRLR EQUAL TO '1'                                9916034
144560         MOVE WMS-LOAN-YTD-INT TO WMS-LOAN-PREV-YTD-INT           IM003
144590         MOVE WMS-LOAN-YTD-INS1 TO WMS-LOAN-PREV-YTD-INS1         IM003
144620         MOVE WMS-LOAN-YTD-INS2 TO WMS-LOAN-PREV-YTD-INS2         IM003
144650         MOVE WMS-LOAN-YTD-FEES TO WMS-LOAN-PREV-YTD-FEES         IM003
144680         MOVE WMS-YTD-EXTENSIONS TO WMS-PREV-NO-EXT               IM003
144710         MOVE WMS-YTD-EXT-MONTHS TO WMS-PREV-MONTHS-EXT           IM003
144712         MOVE WMS-FINCHG-YTD TO WMS-FINCHG-PYTD                   1020057
144740         MOVE ZERO TO WMS-LOAN-YTD-INT                            IM003
144770                      WMS-LOAN-YTD-INS1                           IM003
144800                      WMS-LOAN-YTD-INS2                           IM003
144830                      WMS-LOAN-YTD-FEES                           IM003
144840                      WMS-LOAN-YTD-AGGR                           IM006
144850                      WMS-LOAN-YTD-AGGR-DAYS                      IM006
144860                      WMS-YTD-EXTENSIONS                          IM003
144890                      WMS-YTD-EXT-MONTHS                          IM003
144900                      WMS-LOAN-YTD-ACC-INT                        1105132
144902                      WMS-YTD-INT-CAP                             9915845
144904                      WMS-FINCHG-YTD                              1020057
144920         IF  WMS-LOAN-STATUS EQUAL '3'                            IM003
144922             MOVE WBC-CAPTURE-YR TO C-HIGH-YR                     0627562
144924             MOVE '20' TO C-HIGH-CENT                             0627562
144926             IF  C-HIGH-YR GREATER THAN WBC-NEXT-CENT-YR          0627562
144928                 MOVE '19' TO C-HIGH-CENT                         0627562
144930                 END-IF                                           0627562
144932             MOVE C-HIGH-YEAR9 TO C-LOW-YEAR9                     0627562
144934             IF  WMS-LOAN-CLOSED-DATE NOT EQUAL SPACE AND ZERO    0627562
144936                 MOVE WMS-LOAN-CLOSED-YR TO C-LOW-YR              0627562
144938                 END-IF                                           0627562
144939             MOVE '20' TO C-LOW-CENT                              0627562
144940             IF  C-LOW-YR GREATER THAN WBC-NEXT-CENT-YR           0627562
144942                 MOVE '19' TO C-LOW-CENT                          0627562
144944                 END-IF                                           0627562
144946             ADD 1 TO C-LOW-YEAR9                                 0627562
144948             IF  C-LOW-YEAR9 LESS THAN C-HIGH-YEAR9               0627562
144950                 MOVE '4' TO WMS-LOAN-STATUS                      0627562
144980                 MOVE 'SU' TO IMEX-CODE-1                         0627562
145010                 MOVE 'SL' TO IMEX-CODE-2                         0627562
145040                 MOVE '09' TO IMEX-REC-NO                         0627562
145070                 MOVE '3' TO EX09-STATUS-IN                       0627562
145100                 MOVE '4' TO EX09-STATUS-OUT, WK-LN-STATUS-IN     0627562
145130                 MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL              0627562
145160                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.         0627562
145161     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
145162         GO TO C2204.                                             0617360
145163     MOVE 'N'                   TO WMS-PLN-TRLR-UPGRADED.         0617360
145164     MOVE WMS-PLN-TRLR-YTD-BEG-BAL TO WMS-PLN-TRLR-PY-BEG-BAL.    0617360
145165     MOVE WMS-PLN-TRLR-FAIR-MKT-VAL-CUR                           0617360
145166                                TO WMS-PLN-TRLR-FAIR-MKT-VAL-PRV. 0617360
145167     MOVE WMS-PLN-TRLR-YR-END-ACCR-CUR                            0617360
145168                                TO WMS-PLN-TRLR-YR-END-ACCR-PRV.  0617360
145169     MOVE WMS-PLN-TRLR-MIN-DIST-AMT                               0617360
145170                                TO WMS-PLN-TRLR-MIN-DIST-AMT-PY.  0617360
145171     MOVE WMS-PLN-TRLR-FEE-COLL-YTD                               0617360
145172                                TO WMS-PLN-TRLR-FEE-COLL-PREV-YTD.0617360
145173     MOVE ZERO                  TO WMS-PLN-TRLR-FAIR-MKT-VAL-CUR  0617360
145174                                   WMS-PLN-TRLR-YR-END-ACCR-CUR   0617360
145175                                   WMS-PLN-TRLR-MIN-DIST-AMT      0617360
145176                                   WMS-PLN-TRLR-FEE-COLL-YTD.     0617360
145177     SET WMS-PLN-TRLR-IND TO 1.                                   0617360
145178     SET WMS-PLN-TRLR-IND2 TO WMS-PLN-TRLR-CTDT-NO.               0617360
145179 C2202.                                                           0617360
145180     IF  WMS-PLN-TRLR-IND GREATER THAN WMS-PLN-TRLR-IND2          0617360
145181         GO TO C2203.                                             0617360
145182     IF  WMS-PLN-TRLR-CAL-YR (WMS-PLN-TRLR-IND) EQUAL '1'         0617360
145183         SET WMS-PLN-TRLR-CTDT-NO TO WMS-PLN-TRLR-IND             0617360
145184         SUBTRACT 1 FROM WMS-PLN-TRLR-CTDT-NO                     0617360
145185         GO TO C2203.                                             0617360
145186     MOVE '1' TO WMS-PLN-TRLR-CAL-YR (WMS-PLN-TRLR-IND).          0617360
145187     SET WMS-PLN-TRLR-IND UP BY 1.                                0617360
145188     GO TO C2202.                                                 0617360
145189 C2203.                                                           0617360
145190     MOVE WMS-CURR-BAL   TO WMS-PLN-TRLR-YTD-BEG-BAL.             0617360
145191     MOVE ZEROS          TO WMS-PLN-TRLR-LAST-DIST-INFO.          0617360
145198 C2204.                                                           0617360
145200     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0617360
145220         MOVE WMS-OD-YTD-CHGD TO WMS-OD-PREV-YTD-CHGD             IM003
145250         MOVE +0.00 TO WMS-OD-YTD-CHGD                            IM004
145251*                      WMS-OD-YTD-ACR                             1105132
145252                       WMS-OD-YTD-ACR.                            IMODTRAI
145257*        IF  WMS-OD-STATUS EQUAL '1'                              IMODTRAI
145264*            MOVE '2' TO WMS-OD-STATUS.                           IMODTRAI
145269     IF  WMS-KITING-SUSP-TRLR EQUAL '1'                           IM006
145274         MOVE ZERO TO WMS-KITE-YTD-SUSP-DAYS.                     IM006
145280     IF  WMS-SAVINGS-TRLR NOT EQUAL TO '1'                        IM003
145310         GO TO C2210.                                             IM007
145340     MOVE WMS-YTD-INT-PAID TO WMS-PREV-YTD-INT.                   IM003
145350     MOVE WMS-YTD-INT-PAID-1042 TO WMS-PREV-YTD-INT-1042.         9915828
145370     MOVE WMS-YTD-SAV-TAX TO WMS-PREV-YTD-SAV-TAX.                IM003
145372     MOVE WMS-YTD-SAV-STATE-TAX TO WMS-PREV-YTD-SAV-STATE-TAX.    2012254
145374     MOVE ZERO TO WMS-YTD-SAV-STATE-TAX.                          2012254
145376     MOVE WMS-YTD-SAV-LOCAL-TAX TO WMS-PREV-YTD-SAV-LOCAL-TAX.    2012254
145378     MOVE ZERO TO WMS-YTD-SAV-LOCAL-TAX.                          2012254
145400     MOVE WMS-CMA-YTD-MGMT-FEES TO WMS-CMA-PREV-YTD-MN-FEES.      IM003
145430     MOVE ZERO TO WMS-YTD-INT-PAID, WMS-CMA-YTD-MGMT-FEES         9915828
145440                  WMS-YTD-INT-PAID-1042.                          9915828
145450     MOVE ZERO TO WMS-CMA-YTD-MGMT-FEES-WV.                       9916072
145460     MOVE ZERO TO WMS-YTD-SAV-TAX                                 1105132
145470                  WMS-YTD-ACCR-INT.                               1105132
145490     IF  WMS-INT-STATUS EQUAL '7'                                 IM003
145520         MOVE '8' TO WMS-INT-STATUS                               IM003
145550         MOVE 'SU' TO IMEX-CODE-1                                 IM003
145580         MOVE 'SS' TO IMEX-CODE-2                                 IM003
145610         MOVE '09' TO IMEX-REC-NO                                 IM003
145640         MOVE '7' TO EX09-STATUS-IN                               IM003
145670         MOVE '8' TO EX09-STATUS-OUT, WK-SV-STATUS-IN             IM003
145700         MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL                     IM003
145730         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM003
145760     IF  WMS-INT-YTD-AGGR-BALS NOT EQUAL TO +0                    IM003
145770         DIVIDE WMS-INT-YTD-AGGR-DAYS INTO WMS-INT-YTD-AGGR-BALS  IM003
145820                GIVING WMS-PREV-YTD-AVG-BAL                       IM003
145850     ELSE                                                         IM003
145880         MOVE +0 TO WMS-PREV-YTD-AVG-BAL.                         IM003
145910     MOVE +0 TO WMS-INT-YTD-AGGR-BALS, WMS-INT-YTD-AGGR-DAYS.     IM003
145912     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
145914         MOVE WMS-INV-SVC-COLL-YTD TO WMS-INV-SVC-COLL-PYTD       1004554
145916         MOVE ZERO                 TO WMS-INV-SVC-COLL-YTD.       1004554
145948 C2210.                                                           9915858
145950     IF  WMS-DCD-TAX-DATA-TRLR NOT EQUAL '1'                      IM007
145970         GO TO C2212.                                             9915858
145990     IF  WMS-DCD-STATUS EQUAL '3'                                 IM007
146010         MOVE '1' TO WMS-DCD-STATUS                               IM007
146030     ELSE                                                         IM007
146050         IF  WMS-DCD-STATUS EQUAL '2'                             IM007
146070             MOVE '3' TO WMS-DCD-STATUS                           IM007
146090         ELSE                                                     IM007
146110             IF  WMS-DCD-STATUS EQUAL '0'                         IM007
146130                 MOVE '2' TO WMS-DCD-STATUS.                      IM007
146150     IF  WK-DCD-STATUS-IN NOT EQUAL WMS-DCD-STATUS                IM007
146170         MOVE 'SU' TO IMEX-CODE-1                                 IM007
146190         MOVE 'SQ' TO IMEX-CODE-2                                 IM007
146210         MOVE '09' TO IMEX-REC-NO                                 IM007
146230         MOVE WK-DCD-STATUS-IN TO EX09-STATUS-IN                  IM007
146250         MOVE WMS-DCD-STATUS   TO EX09-STATUS-OUT                 IM007
146270                                  WK-DCD-STATUS-IN                IM007
146290         COMPUTE DCD-NET-INT   = (WMS-DCD-YTD-INT-IOD +           IM007
146310                                  WMS-DCD-YTD-INT-SAV) -          IM007
146330                                 (WMS-DCD-YTD-TAX-IOD +           IM007
146340                                  WMS-DCD-YTD-TAX-SAV)-           2012254
146342                                 (WMS-DCD-YTD-TAX-IOD-STATE +     2012254
146344                                  WMS-DCD-YTD-TAX-SAV-STATE)-     2012254
146346                                 (WMS-DCD-YTD-TAX-IOD-LOCAL +     2012254
146348                                  WMS-DCD-YTD-TAX-SAV-LOCAL)      2012254
146350         MOVE DCD-NET-INT      TO EX09-CUR-BAL                    9915858
146360         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 9915858
146370 C2212.                                                           9915858
146372     IF WBC-ALT-DUAL-YR-OPTION NOT EQUAL '2', GO TO C2215.        0266741
146374     IF WMS-DUAL-YEAR-TRLR NOT EQUAL '1', GO TO C2215.            9915858
146376     IF WBC-PREV-ALT-DUAL-YEAR-END EQUAL '0', GO TO C2215.        0266741
146378     MOVE WMS-DUAL-YR-CUR-IOD-INT   TO WMS-DUAL-YR-PREV-IOD-INT.  9915858
146380     MOVE WMS-DUAL-YR-CUR-IOD-FED   TO WMS-DUAL-YR-PREV-IOD-FED.  9915858
146382     MOVE WMS-DUAL-YR-CUR-IOD-STATE TO WMS-DUAL-YR-PREV-IOD-STATE.9915858
146384     MOVE WMS-DUAL-YR-CUR-IOD-LOCAL TO WMS-DUAL-YR-PREV-IOD-LOCAL.9915858
146386     MOVE WMS-DUAL-YR-CUR-SAV-INT   TO WMS-DUAL-YR-PREV-SAV-INT.  9915858
146388     MOVE WMS-DUAL-YR-CUR-SAV-FED   TO WMS-DUAL-YR-PREV-SAV-FED.  9915858
146390     MOVE WMS-DUAL-YR-CUR-SAV-STATE TO WMS-DUAL-YR-PREV-SAV-STATE.9915858
146391     MOVE WMS-DUAL-YR-CUR-SAV-LOCAL TO WMS-DUAL-YR-PREV-SAV-LOCAL.9915858
146392     MOVE ZEROS TO WMS-DUAL-YR-CUR-IOD-INT                        9915858
146394          WMS-DUAL-YR-CUR-IOD-FED                                 9915858
146396          WMS-DUAL-YR-CUR-IOD-STATE WMS-DUAL-YR-CUR-IOD-LOCAL     9915858
146398          WMS-DUAL-YR-CUR-SAV-INT   WMS-DUAL-YR-CUR-SAV-FED       9915858
146399          WMS-DUAL-YR-CUR-SAV-STATE WMS-DUAL-YR-CUR-SAV-LOCAL.    9915858
146400 C2215.                                                           1004773
146410     IF WBC-PREV-QUARTER-END NOT EQUAL TO '1', GO TO C2220.       0266741
146412     MOVE +0 TO WMS-QTD-AGGR-BAL                                  0727675
146414                WMS-QTD-AGGR-DAYS                                 0727675
146416                WMS-INT-QTD-AGGR-BAL                              0727675
146418                WMS-INT-QTD-AGGR-DAYS.                            0727675
146500     IF  WMS-LOAN-TRLR EQUAL '1'                                  1004773
146502         MOVE 'N' TO WMS-LOAN-STAT-CHG                            0637636
146510         IF WMS-LOAN-DEBT-RESTRUCT EQUAL '1'                      1004773
146520            MOVE '2' TO WMS-LOAN-DEBT-RESTRUCT                    1004773
146530         ELSE                                                     1004773
146540            IF WMS-LOAN-DEBT-RESTRUCT EQUAL '3'                   1004773
146550               MOVE '4' TO WMS-LOAN-DEBT-RESTRUCT.                1004773
146600 C2220.
146650     IF WBC-PREV-MONTH-END NOT EQUAL TO '1', GO TO C2250.         0266741
146700 C2230.
146710*--------------------------------------------------------------*  0417181
146720* ACCUMULATE BEGINNING-OF-MONTH TOTALS FOR TFR AVERAGES        *  0417181
146730*--------------------------------------------------------------*  0417181
146740     PERFORM Y5000-30-TFRCSI-ACCUM THRU Y5000-30-EXIT.            0417181
146750     MOVE ZERO TO WMS-NEW-THIS-MONTH.
146800     IF  WMS-OD-NSF-TRLR EQUAL '1'
146805         MOVE WMS-NB-CB-MO-TOTALS TO TEMP-22                      9915749
146810         MOVE TEMP-22 TO WMS-NB-CB-PREV-MO                        9915749
146850         MOVE WMS-OD-DAYS-MO TO TEMP-22
146900         MOVE TEMP-22 TO WMS-OD-DAYS-PREV-MO
146950         MOVE WMS-MTD-OD-DAYS TO WMS-DAYS-OD-MO (1)
147000         MOVE WMS-OD-TIMES-MO TO TEMP-22
147050         MOVE TEMP-22 TO WMS-OD-TIMES-PREV-MO
147100         MOVE WMS-MTD-OD-TIMES TO WMS-TIMES-OD-MO (1)
147150         MOVE WMS-NSF-MONTHS TO TEMP-22
147200         MOVE TEMP-22 TO WMS-NSF-PREV-MO
147250         MOVE WMS-MTD-NSF-TIMES TO WMS-TIMES-NSF-MO (1)           IM005
147300         MOVE WMS-UNAVAIL-MONTHS TO TEMP-22                       IM007
147320         MOVE TEMP-22 TO WMS-UNAVAIL-PREV-MO                      IM007
147340         MOVE WMS-MTD-UNAVAIL-TIMES TO WMS-TIMES-UNAVAIL-MO (1)   9915749
147345         IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                       9915845
147350         AND WBC-NB-CB-ACCM GREATER 0                             0266741
147360             MOVE WMS-SC-MISC-NOS(WBC-NB-CB-ACCM)                 0266741
147370                                 TO WMS-NB-TIMES-CB-MO(1).        9915749
147450     MOVE +9999999999999.99 TO WMS-MTD-MIN-BAL.                   9915845
147470     MOVE +9999999999999.99 TO WMS-MTD-DDA-MIN.                   9915845
147550     MOVE ZERO TO WMS-MTD-AGGR-BAL
147600                  WMS-MTD-AGGR-COLL
147620                  WMS-MTD-AGGR-CUST-COLL                          IM003
147630                  WMS-MTD-NEG-AGGR-COLL                           2016654
147640                  WMS-MTD-NEG-AGGR-CUST-COLL                      2016654
147650                  WMS-MTD-AGGR-OD
147700                  WMS-MTD-AGGR-DAYS
147710                  WMS-XINV-MTD-AGGR                               2016639
147720                  WMS-XINV-MTD-DAYS                               2016639
147750                  WMS-MTD-HIGH-BAL
147800                  WMS-MTD-SVC-CHG-DR
147850                  WMS-MTD-SVC-CHG-CR
147862                  WMS-NB-MTD-MIN-WVE                              1105504
147864                  WMS-NB-MTD-WVE-AMT                              1105504
147866                  WMS-NB-MTD-SC-AMT                               1105504
147900                  WMS-MTD-MISC-COSTS
147950                  WMS-MTD-NSF-TIMES
148000                  WMS-MTD-NSF-ITEMS
148050                  WMS-MTD-OD-DAYS
148100                  WMS-MTD-OD-TIMES
148150                  WMS-MTD-OD-ITEMS
148160                  WMS-MTD-UNAVAIL-TIMES                           IM007
148170                  WMS-MTD-UNAVAIL-ITEMS                           IM007
148180                  WMS-MTD-KITING-SUSP                             0902147
148200                  WMS-MTD-CALC-SERV-CHG
148250                  WMS-MTD-ACCUM-SERV-CHG
148300                  WMS-MTD-ACCUM-TRAN-CHG
148350                  WMS-MTD-TRN-NO
148400                  WMS-MTD-TRAN-AMT
148460                  WMS-MTD-NUM-ACH                                 IM004
148470                  WMS-MTD-NUM-ATM                                 IM004
148480                  WMS-MTD-ACCRUAL-DAYS                            IM005
148500                  WMS-IOD-MTD-ACC-INT
148550                  WMS-IOD-MTD-PAID-INT                            IM002
148560                  WMS-IOD-MTD-TAX                                 2012254
148565                  WMS-IOD-MTD-STATE-TAX                           2012254
148570                  WMS-IOD-MTD-LOCAL-TAX.                          2012254
148580     MOVE +0 TO WMS-CASH-AVAIL-MTD-AGGR.                          IM007
148582     MOVE '0' TO WMS-BRT-TERM-CNV.                                0417066
148600     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
148650         MOVE ZERO TO WMS-MTD-LOCAL-ITEMS
148700                      WMS-MTD-FOREIGN-ITEMS
148750                      WMS-MTD-LOCKBOX-ITEMS
148800                      WMS-MTD-NONPAR-ITEMS
148850                      WMS-MTD-CASH-DEPOSITS
148900                      WMS-MTD-NONPAR-AMT
148950                      WMS-MTD-HI-SPEED-ITEMS
149000                      WMS-MTD-LOW-SPEED-ITEMS.
149005     IF  WMS-BIR-FLAG EQUAL '1' OR '2'                            2016374
149010         MOVE ZERO TO WMS-BIR-MTD-WD-NBR                          2016374
149015                      WMS-BIR-MTD-WD-AMT                          2016374
149020                      WMS-BIR-MTD-DP-NBR                          2016374
149025                      WMS-BIR-MTD-DP-AMT.                         2016374
149050     IF  WMS-MARKET-TRLR EQUAL TO '1'                             IM003
149100         MOVE ZERO TO WMS-MRKT-BAL-COUNT
149150                      WMS-MRKT-ITEM-COUNT                         IM003
149160                      WMS-HST-AGGR-BAL                            IM003
149200         MOVE WMS-HST-AVG-BALANCES TO TEMP-120                    9915845
149250         MOVE TEMP-120 TO WMS-HST-PREV-MO-HIST                    9915845
149300         MOVE ZERO TO WMS-HST-AGGR-DAYS (1)
149350         MOVE ZERO TO WMS-HST-AVG-BAL (1).
149400     IF WMS-SAVINGS-TRLR EQUAL TO '1'
149450         MOVE ZERO TO WMS-MTD-ACCR-INT
149470                      WMS-INT-MTD-ACCR-DAYS                       IM005
149500                      WMS-INT-MTD-AGGR
149550                      WMS-INT-MTD-TRANNO
149600                      WMS-INT-MTD-TRNAMT
149650                      WMS-INT-NEW-THIS-MONTH
149700                      WMS-MTD-INT-PAID
149720                      WMS-MTD-CALC-INT                            IM002
149750                      WMS-INT-MTD-TRCHG
149800                      WMS-DDA-MAX-MTD-NO
149850                      WMS-DDA-MAX-MTD-AMT
149870                      WMS-INT-MTD-TAX                             IM002
149880                      WMS-INT-MTD-STATE-TAX                       2012254
149890                      WMS-INT-MTD-LOCAL-TAX                       2012254
149900         MOVE +9999999999999.99 TO WMS-INT-MTD-MIN.               9915845
149910     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
149920         MOVE ZERO               TO WMS-INV-SVC-ACCRD-MTD         1004554
149930                                    WMS-INV-SVC-COLL-MTD.         1004554
149950     IF  WMS-LOAN-TRLR EQUAL TO '1'                               9915749
149960     AND WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
150000         MOVE WMS-PREV-CYC-HISTORY TO TEMP-132                    9915845
150050         MOVE TEMP-132 TO WMS-PREV-CYC-2-12                       9915845
150100         MOVE ZEROES TO WMS-PREV-CYC-HIST (1)
150150         MOVE ZERO TO WMS-PREV-AVG-BAL (1)
150200         MOVE '0' TO WMS-LOAN-NEW-THIS-MONTH
150250         MOVE ZERO TO WMS-LOAN-MTD-AGGR
150300                      WMS-LOAN-MTD-AGGR-DAYS
150350                      WMS-EARNED-INT
150400                      WMS-COLLECT-INT
150450                      WMS-BILLED-INS1
150500                      WMS-BILLED-INS2
150550                      WMS-BILLED-FEES
150600                      WMS-COLL-OTHER
150650                      WMS-MTD-AGGR1
150700                      WMS-MTD-AGGR2
150750                      WMS-MTD-AGGR3                               IM006
150760                      WMS-COSTS-AMORT-MTD.                        IM006
150770     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
150772         MOVE ZERO TO WMS-PLN-TRLR-FEE-COLL-MTD.                  0617360
150800     IF WMS-CLUB-ACCT-CONTROL EQUAL '2'
150850         MOVE '1' TO WMS-CLUB-ACCT-CONTROL.
150900     IF WMS-CLUB-ACCT-STATUS EQUAL '1'
150950         MOVE '2' TO WMS-CLUB-ACCT-STATUS.
151000     MOVE +0 TO WMS-CLUB-TIMES-CHANGED.
151050     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
151100         MOVE ZERO TO WMS-OD-MTD-ACR
151150                      WMS-OD-MTD-CHGD
151200                      WMS-OD-ACR-AGGR-MTD
151250                      WMS-OD-ACR-AGGR-DAYS-MTD.
151251     IF  WMS-KITING-SUSP-TRLR EQUAL '1'                           IM006
151252         MOVE ZERO TO WMS-KITE-LGE-ITEM                           0902147
151254                      WMS-KITING-SUSP-DAYS.                       IM006
151256     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'                           0902147
151260         GO TO C2250.                                             IM004
151265     MOVE +1 TO X.                                                IM004
151270 C2240-LOOP.                                                      IM004
151275     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '3' OR '4'                IM004
151280         MOVE ZERO TO WMS-SC-MISC-NOS (X).                        IM004
151285     IF  X LESS THAN +200                                         9715504
151290         ADD +1 TO X                                              IM004
151295         GO TO C2240-LOOP.                                        IM004
151300 C2250.
151310     IF  WMS-SC-CLEAR NOT EQUAL '1'                               IM007
151320         GO TO C2255-EXIT.                                        IM007
151330     MOVE '0' TO WMS-SC-CLEAR.                                    IM007
151350     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                           IM004
151351         IF  WMS-SC-DELETE EQUAL 'C'                              IM004
151352             MOVE +1 TO X                                         IM004
151353             GO TO C2250-LOOP.                                    IM004
151354     GO TO C2255.                                                 IM007
151356 C2250-LOOP.                                                      IM006
151358     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '1' OR '2'                IM006
151360         MOVE ZERO TO WMS-SC-MISC-NOS (X).                        IM006
151362     IF  X LESS THAN +200                                         9715504
151364         ADD +1 TO X                                              IM006
151366         GO TO C2250-LOOP.                                        IM006
151368     MOVE ' ' TO WMS-SC-DELETE.                                   IM006
151370     MOVE ZERO TO WMS-LOCAL-ITEMS                                 IM006
151372                  WMS-FOREIGN-ITEMS                               IM006
151374                  WMS-LOCKBOX-ITEMS                               IM006
151376                  WMS-NONPAR-ITEMS                                IM006
151378                  WMS-CASH-DEPOSITS                               IM006
151380                  WMS-NON-PAR-DEP                                 IM006
151382                  WMS-CARD-ENTRY                                  IM006
151384                  WMS-HI-SPEED-ITEMS                              IM006
151386                  WMS-LOW-SPEED-ITEMS.                            IM006
151500 C2255.
151550     MOVE ZERO TO WMS-SC-NUM-ACH
151600                  WMS-SC-NUM-ATM
151650                  WMS-SC-AMTTRNSFR-NO
151700                  WMS-SC-CHECK-ITEMS
151750                  WMS-SC-AGGR-BAL
151800                  WMS-SC-AGGR-COLL
151850                  WMS-SC-AGGR-OD-BAL
151870                  WMS-SC-AGGR-CUST-COLL                           IM003
151900                  WMS-SC-AGGR-DAYS
151950                  WMS-SC-DEBITS
152000                  WMS-SC-CREDITS
152050                  WMS-SC-NSF-TIMES
152100                  WMS-SC-NSF-ITEMS
152150                  WMS-SC-OD-TIMES
152200                  WMS-SC-OD-ITEMS
152210                  WMS-SC-UNAVAIL-TIMES                            IM007
152220                  WMS-SC-UNAVAIL-ITEMS                            IM007
152250                  WMS-SC-TRAN-NO
152300                  WMS-SC-TRAN-AMT
152350                  WMS-SC-PAY-PERIOD-CTR
152360                  WMS-SC-AGG-STOPS                                IM003
152370                  WMS-SC-AGG-HOLDS                                IM003
152380                  WMS-SC-MISC-COSTS                               IM003
152400                  WMS-NEW-THIS-CYCLE                              IM007
152410                  WMS-CASH-AVAIL-CTD-AGGR                         9916070
152420                  WMS-SC-AGGR-DDA.                                9916070
152690     IF  BHW-IOD-FLAG EQUAL 'M'                                   0902213
152790         MOVE '1' TO  WBHM-MMDA-CYCLE-TDY (1).                    0902213
152890     IF  BHW-IOD-FLAG EQUAL 'I'                                   0902509
152990         MOVE '1' TO  WBHI-IOD-CYCLE-TDY (1).                     0902509
153000     IF  WMS-IOD-RATE-USE EQUAL 'S'                               1003625
153010         MOVE '1' TO  WBHA-S-T-CYCLE-TDY (1).                     0902509
153100     IF  WMS-SC-CHECK-CHG LESS THAN '2'
153150         MOVE ZERO TO WMS-SC-NO-CHECKS.
153200     MOVE +9999999999999.99 TO WMS-SC-MIN-BAL                     9916070
153210                               WMS-SC-DDA-MIN                     9916070
153215                               WMS-INT-SC-MIN-BAL.                9916070
153220     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9916070
153225         MOVE ZERO TO WMS-CMA-CTD-MGMT-FEES-WV                    9916070
153230                      WMS-INT-SC-AGGR-DAYS                        9916070
153235                      WMS-INT-SC-AGGR-BAL                         9916070
153240                      WMS-INT-SC-AGGR-COLL                        9916070
153245                      CMA-AGGR-DAYS                               2016683
153246                      CMA-PAST-AGGR-DAYS                          2016683
153260         IF  WMS-CMA-INDICATOR EQUAL '1'                          0637523
153264             MOVE WMS-DDA-MAX-BAL-BEG TO WMS-DDA-MAX-BAL          0637523
153265         END-IF                                                   0637523
153270         IF (WMS-SAV-INT-PAY-CYCLE EQUAL '1' OR '4')              9916072
153275             MOVE 'F' TO CLEAR-SAV-CY-SW                          9916072
153280             MOVE ZERO TO WMS-INT-AGGR-DAYS                       9916072
153290                          WMS-INT-AGGR-BAL.                       9916072
153500     IF  WMS-EXTRNL-DEPOSIT-TRLR EQUAL '1'                        IM004
153510         MOVE ZERO TO WMS-AGGR-SAV-BAL                            IM004
153520         IF  WMS-SAVINGS-BAL EQUAL TO ZERO                        IM004
153530             MOVE +9999999999999.99 TO WMS-MIN-SAV-BAL            9915845
153540         ELSE                                                     IM004
153550             MOVE WMS-SAVINGS-BAL TO WMS-MIN-SAV-BAL.             IM004
153650 C2255-EXIT.                                                      IM004
153750     EXIT.                                                        IM004
153900 C2260.
153902     MOVE +0 TO IN-MMDA-CHECKS IN-MMDA-XFERS.                     0266776
153904     IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2'                      0437111
153906         MOVE WMS-SC-CHECK-ITEMS TO IN-MMDA-CHECKS                0266776
153908         MOVE WMS-SC-AMTTRNSFR-NO TO IN-MMDA-XFERS.               0266776
154000     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915749
154010         GO TO C2270.                                             9915749
154200     IF  WMS-LOAN-TRLR NOT EQUAL '1'                              IM003
154270         GO TO C2270.                                             IM003
154340     IF  WMS-LOAN-STATUS EQUAL '9'                                IM003
154410         GO TO C2260-EXIT.                                        1003343
154480     IF  WMS-LOAN-STMT-CLEAR EQUAL TO '1'                         IM003
154550         MOVE '0' TO WMS-LOAN-STMT-CLEAR                          IM003
154620         ADD WMS-PRIN-BAL, WMS-INTRST-BAL, WMS-OTHER-CHGS         IM003
154690                        GIVING WMS-BEGIN-BAL                      IM003
154760         MOVE WMS-INTRST-BAL TO WMS-BEGIN-INT                     IM003
154830         MOVE ZERO TO WMS-LN-STMT-DB-NO                           IM003
154900                      WMS-LN-STMT-DB-AMT                          IM003
154970                      WMS-LN-STMT-CR-NO                           IM003
155040                      WMS-LN-STMT-CR-AMT                          IM003
155110                      WMS-FINCHG-THIS-CY                          IM003
155180                      WMS-INSUR1-THIS-CY                          IM003
155250                      WMS-INSUR2-THIS-CY                          IM003
155320                      WMS-FEE-THIS-CY                             IM008
155340         IF  WMS-PRIME-CHNG-RTE EQUAL '1'                         1003343
155350             GO TO C2260-EXIT                                     1003343
155352         ELSE                                                     1003343
155354             IF  (WMS-INT-RATE-PTR EQUAL +6 OR +7)                1003343
155356                 MOVE '1'        TO CALC-ONLY-FLAG                1003343
155358                 MOVE WMS-PRIME-RATE                              1003343
155359                                 TO SAVE-WMS-PRIME-RATE           1003343
155362                 MOVE WMS-PRM-CUR-ANN                             1003625
155363                                 TO WMS-PRIME-RATE                1003343
155366                 PERFORM PRIME-RATE-CALC THRU PRIME-CALC-ONLY-EXIT1003343
155368                 MOVE SAVE-WMS-PRIME-RATE                         1003343
155369                                 TO WMS-PRIME-RATE                1003343
155372                 MOVE '0'        TO CALC-ONLY-FLAG                1003343
155380                 IF  WMS-PRM-CUR-ANN NOT EQUAL WMS-PRIME-RATE     1003625
155420                     MOVE WMS-ANNUAL-RATE                         1003343
155430                                 TO EX03-OLD-PRIME                1003343
155440                     MOVE WMS-PRM-CUR-ANN                         1003625
155450                                 TO WMS-PRIME-RATE                1003343
155460                     PERFORM PRIME-RATE-CALC THRU PRIME-EXIT      1003343
155480                     PERFORM PRIME-EX THRU PRIME-CHANGE-EXIT.     1003625
155500 C2260-EXIT.                                                      1003343
155626     EXIT.                                                        1003343
155650 C2270.
155700     IF WMS-LOAN-TRLR EQUAL '1' AND WMS-INT-RATE-PTR GREATER +5
155750         IF WMS-PRIME-BAL-CALC EQUAL '0'
155800             MOVE WMS-PRM-CUR-BCL    TO PRIME-CALC-FLAG           1003625
155850         ELSE
155900             MOVE WMS-PRIME-BAL-CALC TO PRIME-CALC-FLAG.
155950 C2270-EXIT. EXIT.
156000 C2300.
156002     IF  WMS-RATE-TRLR EQUAL '0'                                  9915319
156004         GO TO C2301.                                             9915319
156005*                                                                 9915319
156006     MOVE WBC-CAPTURE-YR         TO SV-DT8-YR                     0266741
156008     MOVE WBC-CAPTURE-MO         TO SV-DT8-MO                     0266741
156010     MOVE WBC-CAPTURE-DA         TO SV-DT8-DA                     0266741
156011*                                                                 9915319
156012     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
156014         MOVE '20'               TO SV-DT8-CENT                   9915319
156016     ELSE                                                         9915319
156018         MOVE '19'               TO SV-DT8-CENT.                  9915319
156019*                                                                 9915319
156020     IF  WBC-ACCR-RECALC EQUAL '0'                                0266741
156022         GO TO C2300-OD-RATE-CHANGE.                              9915319
156023*                                                                 9915319
156024     PERFORM CALC-DAF-DAYS-DDA                                    9915319
156026        THRU CALC-DAF-DAYS-DDA-EXIT.                              9915319
156027*                                                                 9915319
156028 C2300-TIER-RATE-CHANGE.                                          9915319
156030     IF  WMS-DDA-RATE-FLAG EQUAL 'N'                              9915319
156032         GO TO C2300-SAV-RATE-CHANGE.                             9915319
156033*                                                                 9915319
156034     IF  WMS-HIFI-INDICATOR EQUAL +0                              9915319
156036         GO TO C2300-IOD-RATE-CHANGE.                             9915319
156037*                                                                 9915319
156038     IF  WMS-TIER-CUR-DATE EQUAL SAVE-DATE-8                      9915319
156040         PERFORM CALC-TIER-CUR-DAF                                9915319
156042            THRU CALC-TIER-CUR-DAF-EXIT                           9915319
156044     ELSE                                                         9915319
156046         MOVE WMS-TIER-CUR-DATA  TO WMS-TIER-PREV-DATA            9915319
156048         MOVE SAVE-DATE-8        TO WMS-TIER-CUR-DATE             9915319
156050         PERFORM CALC-TIER-CUR-DAF                                9915319
156052            THRU CALC-TIER-CUR-DAF-EXIT.                          9915319
156053*                                                                 9915319
156054     IF  WMS-DFLT-IOD-CUR-DATE EQUAL SAVE-DATE-8                  9915319
156056         PERFORM CALC-DFLT-IOD-CUR-DAF                            9915319
156058            THRU CALC-DFLT-IOD-CUR-DAF-EXIT                       9915319
156060     ELSE                                                         9915319
156062         MOVE WMS-DFLT-IOD-CUR-DATA                               9915319
156064                                 TO WMS-DFLT-IOD-PREV-DATA        9915319
156066         MOVE SAVE-DATE-8        TO WMS-DFLT-IOD-CUR-DATE         9915319
156068         PERFORM CALC-DFLT-IOD-CUR-DAF                            9915319
156070            THRU CALC-DFLT-IOD-CUR-DAF-EXIT.                      9915319
156071*                                                                 9915319
156072     GO TO C2300-SAV-RATE-CHANGE.                                 9915319
156073*                                                                 9915319
156074 C2300-IOD-RATE-CHANGE.                                           9915319
156076     IF  WMS-IOD-RATE-PTR EQUAL +0                                9915319
156078         GO TO C2300-SAV-RATE-CHANGE.                             9915319
156079*                                                                 9915319
156080     IF  WMS-IOD-CUR-DATE EQUAL SAVE-DATE-8                       9915319
156082         PERFORM CALC-IOD-CUR-DAF                                 9915319
156084            THRU CALC-IOD-CUR-DAF-EXIT                            9915319
156086     ELSE                                                         9915319
156088         MOVE WMS-IOD-CUR-DATA   TO WMS-IOD-PREV-DATA             9915319
156090         MOVE SAVE-DATE-8        TO WMS-IOD-CUR-DATE              9915319
156092         PERFORM CALC-IOD-CUR-DAF                                 9915319
156094            THRU CALC-IOD-CUR-DAF-EXIT.                           9915319
156095*                                                                 9915319
156096     IF  WMS-DFLT-IOD-CUR-DATE EQUAL SAVE-DATE-8                  9915319
156098         PERFORM CALC-DFLT-IOD-CUR-DAF                            9915319
156100            THRU CALC-DFLT-IOD-CUR-DAF-EXIT                       9915319
156102     ELSE                                                         9915319
156104         MOVE WMS-DFLT-IOD-CUR-DATA                               9915319
156106                                 TO WMS-DFLT-IOD-PREV-DATA        9915319
156108         MOVE SAVE-DATE-8        TO WMS-DFLT-IOD-CUR-DATE         9915319
156110         PERFORM CALC-DFLT-IOD-CUR-DAF                            9915319
156112            THRU CALC-DFLT-IOD-CUR-DAF-EXIT.                      9915319
156113*                                                                 9915319
156114 C2300-SAV-RATE-CHANGE.                                           9915319
156116     IF  WMS-SAVINGS-TRLR EQUAL '0'                               9915319
156118     OR  WMS-SAV-RATE-FLAG EQUAL 'N'                              9915319
156120         GO TO C2300-OD-RATE-CHANGE.                              9915319
156121*                                                                 9915319
156122     PERFORM CALC-DAF-DAYS-SAV                                    9915319
156124        THRU CALC-DAF-DAYS-SAV-EXIT.                              9915319
156125*                                                                 9915319
156126     IF  WMS-SAV-CUR-DATE EQUAL SAVE-DATE-8                       9915319
156128         PERFORM CALC-SAV-CUR-DAF                                 9915319
156130            THRU CALC-SAV-CUR-DAF-EXIT                            9915319
156132     ELSE                                                         9915319
156134         MOVE WMS-SAV-CUR-DATA   TO WMS-SAV-PREV-DATA             9915319
156136         MOVE SAVE-DATE-8        TO WMS-SAV-CUR-DATE              9915319
156138         PERFORM CALC-SAV-CUR-DAF                                 9915319
156140            THRU CALC-SAV-CUR-DAF-EXIT.                           9915319
156141*                                                                 9915319
156142 C2300-OD-RATE-CHANGE.                                            9915319
156144     IF  WBC-RECALC-RATES EQUAL '0'                               0266741
156146         GO TO C2301.                                             9915319
156147*                                                                 9915319
156148     PERFORM CALC-DAF-DAYS-LOAN                                   9915319
156150        THRU CALC-DAF-DAYS-LOAN-EXIT.                             9915319
156151*                                                                 9915319
156152     IF  WMS-OD-ACCRUAL-TRLR EQUAL +0                             9915319
156154     OR  WMS-OD-RATE-FLAG EQUAL 'N'                               9915319
156156         GO TO C2300-LOAN-RATE-CHANGE.                            9915319
156157*                                                                 9915319
156158     IF  WMS-OD-INT-PTR1 GREATER THAN +0 AND LESS THAN +6         9915319
156160         IF  WMS-OD-CUR-DATE (1) EQUAL SAVE-DATE-8                9915319
156162             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (1)            9915319
156164                             GIVING WMS-OD-CUR-DAF (1)            9915319
156166         ELSE                                                     9915319
156168             MOVE WMS-OD-CUR-DATA (1)                             9915319
156170                                 TO WMS-OD-PREV-DATA (1)          9915319
156172             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (1)           9915319
156174             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (1)            9915319
156176                             GIVING WMS-OD-CUR-DAF (1).           9915319
156177*                                                                 9915319
156178     IF  WMS-OD-INT-PTR2 GREATER THAN +0 AND LESS THAN +6         9915319
156180         IF  WMS-OD-CUR-DATE (2) EQUAL SAVE-DATE-8                9915319
156182             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (2)            9915319
156184                             GIVING WMS-OD-CUR-DAF (2)            9915319
156186         ELSE                                                     9915319
156188             MOVE WMS-OD-CUR-DATA (2)                             9915319
156190                                 TO WMS-OD-PREV-DATA (2)          9915319
156192             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (2)           9915319
156194             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (2)            9915319
156196                             GIVING WMS-OD-CUR-DAF (2).           9915319
156197*                                                                 9915319
156198     IF  WMS-OD-INT-PTR3 GREATER THAN +0 AND LESS THAN +6         9915319
156200         IF  WMS-OD-CUR-DATE (3) EQUAL SAVE-DATE-8                9915319
156202             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (3)            9915319
156204                             GIVING WMS-OD-CUR-DAF (3)            9915319
156206         ELSE                                                     9915319
156208             MOVE WMS-OD-CUR-DATA (3)                             9915319
156210                                 TO WMS-OD-PREV-DATA (3)          9915319
156212             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (3)           9915319
156214             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (3)            9915319
156216                             GIVING WMS-OD-CUR-DAF (3).           9915319
156217*                                                                 9915319
156218     IF  WMS-OD-INT-PTR4 GREATER THAN +0 AND LESS THAN +6         9915319
156220         IF  WMS-OD-CUR-DATE (4) EQUAL SAVE-DATE-8                9915319
156222             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (4)            9915319
156224                             GIVING WMS-OD-CUR-DAF (4)            9915319
156226         ELSE                                                     9915319
156228             MOVE WMS-OD-CUR-DATA (4)                             9915319
156230                                 TO WMS-OD-PREV-DATA (4)          9915319
156232             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (4)           9915319
156234             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (4)            9915319
156236                             GIVING WMS-OD-CUR-DAF (4).           9915319
156237*                                                                 9915319
156238     IF  WMS-OD-INT-PTR5 GREATER THAN +0 AND LESS THAN +6         9915319
156240         IF  WMS-OD-CUR-DATE (5) EQUAL SAVE-DATE-8                9915319
156242             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (5)            9915319
156244                             GIVING WMS-OD-CUR-DAF (5)            9915319
156246         ELSE                                                     9915319
156248             MOVE WMS-OD-CUR-DATA (5)                             9915319
156250                                 TO WMS-OD-PREV-DATA (5)          9915319
156252             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (5)           9915319
156254             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (5)            9915319
156256                             GIVING WMS-OD-CUR-DAF (5).           9915319
156257*                                                                 9915319
156258     IF  WMS-OD-INT-PTR6 GREATER THAN +0 AND LESS THAN +6         9915319
156260         IF  WMS-OD-CUR-DATE (6) EQUAL SAVE-DATE-8                9915319
156262             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (6)            9915319
156264                             GIVING WMS-OD-CUR-DAF (6)            9915319
156266         ELSE                                                     9915319
156268             MOVE WMS-OD-CUR-DATA (6)                             9915319
156270                                 TO WMS-OD-PREV-DATA (6)          9915319
156272             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (6)           9915319
156274             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (6)            9915319
156276                             GIVING WMS-OD-CUR-DAF (6).           9915319
156277*                                                                 9915319
156278     IF  WMS-OD-INT-PTR7 GREATER THAN +0 AND LESS THAN +6         9915319
156280         IF  WMS-OD-CUR-DATE (7) EQUAL SAVE-DATE-8                9915319
156282             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (7)            9915319
156284                             GIVING WMS-OD-CUR-DAF (7)            9915319
156286         ELSE                                                     9915319
156288             MOVE WMS-OD-CUR-DATA (7)                             9915319
156290                                 TO WMS-OD-PREV-DATA (7)          9915319
156292             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (7)           9915319
156294             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (7)            9915319
156296                             GIVING WMS-OD-CUR-DAF (7).           9915319
156297*                                                                 9915319
156298     IF  WMS-OD-INT-PTR8 GREATER THAN +0 AND LESS THAN +6         9915319
156300         IF  WMS-OD-CUR-DATE (8) EQUAL SAVE-DATE-8                9915319
156302             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (1)            9915319
156304                             GIVING WMS-OD-CUR-DAF (1)            9915319
156306         ELSE                                                     9915319
156308             MOVE WMS-OD-CUR-DATA (8)                             9915319
156310                                 TO WMS-OD-PREV-DATA (8)          9915319
156312             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (8)           9915319
156314             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (8)            9915319
156316                             GIVING WMS-OD-CUR-DAF (8).           9915319
156317*                                                                 9915319
156318     IF  WMS-OD-INT-PTR9 GREATER THAN +0 AND LESS THAN +6         9915319
156320         IF  WMS-OD-CUR-DATE (9) EQUAL SAVE-DATE-8                9915319
156322             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (9)            9915319
156324                             GIVING WMS-OD-CUR-DAF (9)            9915319
156326         ELSE                                                     9915319
156328             MOVE WMS-OD-CUR-DATA (9)                             9915319
156330                                 TO WMS-OD-PREV-DATA (9)          9915319
156332             MOVE SAVE-DATE-8    TO WMS-OD-CUR-DATE (9)           9915319
156334             DIVIDE DAF-DAYS   INTO WMS-OD-CUR-ANN (9)            9915319
156336                             GIVING WMS-OD-CUR-DAF (9).           9915319
156337*                                                                 9915319
156338     IF  WMS-OD-INT-PTR1 EQUAL +6                                 9915319
156340     OR  WMS-OD-INT-PTR2 EQUAL +6                                 9915319
156342     OR  WMS-OD-INT-PTR3 EQUAL +6                                 9915319
156344     OR  WMS-OD-INT-PTR4 EQUAL +6                                 9915319
156346     OR  WMS-OD-INT-PTR5 EQUAL +6                                 9915319
156348     OR  WMS-OD-INT-PTR6 EQUAL +6                                 9915319
156350     OR  WMS-OD-INT-PTR7 EQUAL +6                                 9915319
156352     OR  WMS-OD-INT-PTR8 EQUAL +6                                 9915319
156354     OR  WMS-OD-INT-PTR9 EQUAL +6                                 9915319
156356         IF  WMS-OD-PRM-CUR-DATE EQUAL SAVE-DATE-8                9915319
156358             DIVIDE DAF-DAYS   INTO WMS-OD-PRM-CUR-ANN            9915319
156360                             GIVING WMS-OD-PRM-CUR-DAF            9915319
156362         ELSE                                                     9915319
156364             MOVE WMS-OD-PRM-CUR-DATA                             9915319
156366                                 TO WMS-OD-PRM-PREV-DATA          9915319
156368             MOVE SAVE-DATE-8    TO WMS-OD-PRM-CUR-DATE           9915319
156370             DIVIDE DAF-DAYS   INTO WMS-OD-PRM-CUR-ANN            9915319
156372                             GIVING WMS-OD-PRM-CUR-DAF.           9915319
156373*                                                                 9915319
156374 C2300-LOAN-RATE-CHANGE.                                          9915319
156376     IF  WMS-LOAN-TRLR EQUAL +0                                   9915319
156378     OR  WMS-LN-RATE-FLAG EQUAL 'N'                               9915319
156380         GO TO C2301.                                             9915319
156381*                                                                 9915319
156382     IF  WMS-INT-RATE-PTR GREATER THAN +5                         9915319
156384         IF  WMS-PRM-CUR-DATE EQUAL SAVE-DATE-8                   9915319
156386             DIVIDE DAF-DAYS   INTO WMS-PRM-CUR-ANN               9915319
156388                             GIVING WMS-PRM-CUR-DAF               9915319
156390             GO TO C2300-PREV-LOAN-RATE-CHANGE                    9915319
156392         ELSE                                                     9915319
156394             MOVE WMS-PRM-CUR-DATA                                9915319
156396                                 TO WMS-PRM-PREV-DATA             9915319
156398             MOVE SAVE-DATE-8    TO WMS-PRM-CUR-DATE              9915319
156400             DIVIDE DAF-DAYS   INTO WMS-PRM-CUR-ANN               9915319
156402                             GIVING WMS-PRM-CUR-DAF               9915319
156404             GO TO C2300-PREV-LOAN-RATE-CHANGE.                   9915319
156405*                                                                 9915319
156406     IF  WMS-INT-RATE-PTR GREATER THAN +0 AND LESS THAN +6        9915319
156408         IF  WMS-LN-CUR-DATE EQUAL SAVE-DATE-8                    9915319
156410             DIVIDE DAF-DAYS   INTO WMS-LN-CUR-ANN                9915319
156412                             GIVING WMS-LN-CUR-DAF                9915319
156414             GO TO C2300-PREV-LOAN-RATE-CHANGE                    9915319
156416         ELSE                                                     9915319
156418             MOVE WMS-LN-CUR-DATA                                 9915319
156420                                 TO WMS-LN-PREV-DATA              9915319
156422             MOVE SAVE-DATE-8    TO WMS-LN-CUR-DATE               9915319
156424             DIVIDE DAF-DAYS   INTO WMS-LN-CUR-ANN                9915319
156426                             GIVING WMS-LN-CUR-DAF                9915319
156428             GO TO C2300-PREV-LOAN-RATE-CHANGE.                   9915319
156429*                                                                 9915319
156430     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      9915319
156432         IF  WMS-SPL-CUR-DATE EQUAL SAVE-DATE-8                   9915319
156434             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (1)           9915319
156436                             GIVING WMS-SPL-CUR-DAF (1)           9915319
156438             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (2)           9915319
156440                             GIVING WMS-SPL-CUR-DAF (2)           9915319
156442             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (3)           9915319
156444                             GIVING WMS-SPL-CUR-DAF (3)           9915319
156446             GO TO C2300-PREV-LOAN-RATE-CHANGE                    9915319
156448         ELSE                                                     9915319
156450             MOVE WMS-SPL-CUR-DATA                                9915319
156452                                 TO WMS-SPL-PREV-DATA             9915319
156454             MOVE SAVE-DATE-8    TO WMS-SPL-CUR-DATE              9915319
156456             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (1)           9915319
156458                             GIVING WMS-SPL-CUR-DAF (1)           9915319
156460             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (2)           9915319
156462                             GIVING WMS-SPL-CUR-DAF (2)           9915319
156464             DIVIDE DAF-DAYS   INTO WMS-SPL-CUR-ANN (3)           9915319
156466                             GIVING WMS-SPL-CUR-DAF (3)           9915319
156468             GO TO C2300-PREV-LOAN-RATE-CHANGE.                   9915319
156469*                                                                 9915319
156470 C2300-PREV-LOAN-RATE-CHANGE.                                     9915319
156472     IF  WMS-PREV-INT-PTR GREATER THAN +0                         9915319
156474         IF  WMS-LN-OLD-CUR-DATE EQUAL SAVE-DATE-8                9915319
156476             DIVIDE DAF-DAYS   INTO WMS-LN-OLD-CUR-ANN            9915319
156478                             GIVING WMS-LN-OLD-CUR-DAF            9915319
156480             GO TO C2301                                          9915319
156482         ELSE                                                     9915319
156484             MOVE WMS-LN-OLD-CUR-DATA                             9915319
156486                                 TO WMS-LN-OLD-PREV-DATA          9915319
156488             MOVE SAVE-DATE-8    TO WMS-LN-OLD-CUR-DATE           9915319
156490             DIVIDE DAF-DAYS   INTO WMS-LN-OLD-CUR-ANN            9915319
156492                             GIVING WMS-LN-OLD-CUR-DAF            9915319
156494             GO TO C2301.                                         9915319
156495*                                                                 9915319
156496     IF  WMS-PREV-SPLIT-RATE-PTR GREATER THAN +0                  9915319
156498         IF  WMS-SPL-OLD-CUR-DATE EQUAL SAVE-DATE-8               9915319
156500             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (1)       9915319
156502                             GIVING WMS-SPL-OLD-CUR-DAF (1)       9915319
156504             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (2)       9915319
156506                             GIVING WMS-SPL-OLD-CUR-DAF (2)       9915319
156508             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (3)       9915319
156510                             GIVING WMS-SPL-OLD-CUR-DAF (3)       9915319
156512             GO TO C2301                                          9915319
156514         ELSE                                                     9915319
156516             MOVE WMS-SPL-OLD-CUR-DATA                            9915319
156518                                 TO WMS-SPL-OLD-PREV-DATA         9915319
156520             MOVE SAVE-DATE-8    TO WMS-SPL-OLD-CUR-DATE          9915319
156522             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (1)       9915319
156524                             GIVING WMS-SPL-OLD-CUR-DAF (1)       9915319
156526             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (2)       9915319
156528                             GIVING WMS-SPL-OLD-CUR-DAF (2)       9915319
156530             DIVIDE DAF-DAYS   INTO WMS-SPL-OLD-CUR-ANN (3)       9915319
156532                             GIVING WMS-SPL-OLD-CUR-DAF (3)       9915319
156534             GO TO C2301.                                         9915319
156535*                                                                 9915319
156536 C2301.                                                           9915319
156538     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915319
156540     OR  WMS-LOAN-TRLR NOT EQUAL '1'                              9915319
156542     OR  WBC-RECALC-RATES NOT EQUAL '1'                           0266741
156544         GO TO C2308.                                             9915319
156545*                                                                 9915319
156550 C2302.                                                           9915319
156555     MOVE '1'                    TO WMS-LOAN-CALC-CODE.           9915319
156560*                                                                 9915319
156565     IF  WBC-LEAP-YEAR EQUAL '1'                                  0266741
156570         MOVE +366               TO HOLD-NO3                      9915319
156575     ELSE                                                         9915319
156580         MOVE +365               TO HOLD-NO3.                     9915319
156585*                                                                 9915319
156590     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '1'                        0817657
156600         MOVE +360 TO HOLD-NO3.
156602     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '2'                        0817657
156604         MOVE +365 TO HOLD-NO3.                                   0627547
156650 C2302-EXIT. EXIT.                                                IM008
156700 C2304.                                                           IM008
156750     MOVE WMS-DAILY-RATE TO ACCRUAL-DAILY-RATE.
156800     DIVIDE HOLD-NO3 INTO WMS-ANNUAL-RATE GIVING WMS-DAILY-RATE.
156808     IF  WMS-MAX-LOAN-INT NOT EQUAL +0                            IM006
156816     AND WMS-ANNUAL-RATE GREATER THAN WMS-MAX-LOAN-INT            IM006
156824         MOVE WMS-ANNUAL-RATE TO HOLD-ANN-RTE                     IM006
156832         MOVE WMS-DAILY-RATE TO HOLD-RATE                         IM006
156840         MOVE '1' TO MAX-EXC                                      IM006
156848         PERFORM MAX-RATE-COMPARE THRU MAX-EXIT                   IM006
156856         MOVE '0' TO MAX-EXC                                      IM006
156864         MOVE HOLD-ANN-RTE TO WMS-ANNUAL-RATE                     IM006
156872         MOVE HOLD-RATE TO WMS-DAILY-RATE.                        IM006
156880     IF  WMS-DAILY-RATE NOT EQUAL ACCRUAL-DAILY-RATE              IM006
156900         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.      0266741
156950 C2304-EXIT. EXIT.                                                IM008
157000 C2306.                                                           IM008
157050     DIVIDE HOLD-NO3 INTO WMS-PREV-ANNUAL  GIVING WMS-PREV-DAILY.
157054     IF  WMS-MAX-LOAN-INT NOT EQUAL +0                            IM006
157058     AND WMS-PREV-ANNUAL GREATER THAN WMS-MAX-LOAN-INT            IM006
157062         MOVE WMS-PREV-ANNUAL TO HOLD-ANN-RTE                     IM006
157066         MOVE WMS-PREV-DAILY TO HOLD-RATE                         IM006
157070         MOVE '1' TO MAX-EXC                                      IM006
157074         PERFORM MAX-RATE-COMPARE THRU MAX-EXIT                   IM006
157078         MOVE '0' TO MAX-EXC                                      IM006
157082         MOVE HOLD-ANN-RTE TO WMS-PREV-ANNUAL                     IM006
157086         MOVE HOLD-RATE TO WMS-PREV-DAILY.                        IM006
157089     MOVE WMS-RATE1-DAILY TO HOLD-RATE1.                          IM008
157092     MOVE WMS-RATE2-DAILY TO HOLD-RATE2.                          IM008
157095     MOVE WMS-RATE3-DAILY TO HOLD-RATE3.                          IM008
157100     DIVIDE HOLD-NO3 INTO WMS-RATE1-ANNUAL GIVING WMS-RATE1-DAILY.
157150     DIVIDE HOLD-NO3 INTO WMS-RATE2-ANNUAL GIVING WMS-RATE2-DAILY.
157200     DIVIDE HOLD-NO3 INTO WMS-RATE3-ANNUAL GIVING WMS-RATE3-DAILY.
157204     IF  WMS-RATE1-DAILY EQUAL HOLD-RATE1                         IM008
157205     AND WMS-RATE2-DAILY EQUAL HOLD-RATE2                         IM008
157206     AND WMS-RATE3-DAILY EQUAL HOLD-RATE3                         IM008
157207         NEXT SENTENCE                                            IM008
157208     ELSE                                                         IM008
157209         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.      0266741
157210     IF  WMS-MAX-LOAN-INT NOT EQUAL +0                            IM008
157211     AND WMS-INT-RATE-PTR EQUAL +0                                IM008
157212     AND WMS-SPLIT-RATE-SCHD EQUAL +0                             IM006
157216     AND (WMS-RATE1-ANNUAL GREATER THAN WMS-MAX-LOAN-INT          IM006
157220     OR  WMS-RATE2-ANNUAL GREATER THAN WMS-MAX-LOAN-INT           IM006
157224     OR  WMS-RATE3-ANNUAL GREATER THAN WMS-MAX-LOAN-INT)          IM006
157228         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO SPLIT-RATE-HOLD     IM006
157232         MOVE '1' TO MAX-EXC                                      IM006
157236         PERFORM SPLIT-MAX-COMPARE THRU SPLIT-MAX-EXIT            IM006
157240         MOVE '0' TO MAX-EXC                                      IM006
157244         MOVE SPLIT-RATE-HOLD TO WMS-LOAN-SPLIT-RATE-SCHEDULE.    IM006
157250     IF  WMS-INT-RATE-PTR EQUAL +0                                IM008
157251     AND WMS-SPLIT-RATE-SCHD GREATER THAN +0                      IM008
157252         NEXT SENTENCE                                            IM008
157253     ELSE                                                         IM008
157254         GO TO C2306-EXIT.                                        IM008
157256     IF  WBC-PAST-ACCR-DAYS GREATER THAN +0                       0266741
157257         IF  SPLIT-CHG-FLG EQUAL 'Y'                              1003625
157258             IF  WS-RWF-SPL-CHG (SPLIT-SUB) EQUAL '1'             1003625
157259             OR (WS-RWF-SPL-CHG (SPLIT-SUB) EQUAL '2'             1003625
157260             AND WBC-PAST-ACCR-DAYS GREATER THAN                  0266741
157262                 WS-RWF-SPL-PRV-DAYS (SPLIT-SUB))                 9915577
157264                 PERFORM PREV-SPLIT-RATE-MOVE                     1003625
157265                    THRU PREV-SPLIT-RATE-MOVE-EXIT                1003625
157277                 GO TO C2306-10.                                  1003625
157278     PERFORM SPLIT-RATE-MOVE THRU SPLIT-RATE-MOVE-EXIT.           1003625
157280                                                                  IM008
157281 C2306-10.                                                        IM008
157282     DIVIDE SAVE-NO3 INTO SR-ANNL-RATE1 GIVING SR-DAILY-RATE1.    IM008
157283     DIVIDE SAVE-NO3 INTO SR-ANNL-RATE2 GIVING SR-DAILY-RATE2.    IM008
157284     DIVIDE SAVE-NO3 INTO SR-ANNL-RATE3 GIVING SR-DAILY-RATE3.    IM008
157285     MOVE '0' TO MAX-EXC.                                         IM008
157286     IF  WMS-MAX-LOAN-INT NOT EQUAL +0                            IM008
157287         MOVE SAVE-NO3 TO HOLD-NO3                                IM008
157288         PERFORM SPLIT-MAX-COMPARE THRU SPLIT-MAX-EXIT            IM008
157289         PERFORM C2302 THRU C2302-EXIT.                           IM008
157290     MOVE SR-DAILY-RATE1 TO HOLD-RATE1.                           IM008
157291     MOVE SR-DAILY-RATE2 TO HOLD-RATE2.                           IM008
157292     MOVE SR-DAILY-RATE3 TO HOLD-RATE3.                           IM008
157293     DIVIDE HOLD-NO3 INTO SR-ANNL-RATE1 GIVING SR-DAILY-RATE1.    IM008
157294     DIVIDE HOLD-NO3 INTO SR-ANNL-RATE2 GIVING SR-DAILY-RATE2.    IM008
157295     DIVIDE HOLD-NO3 INTO SR-ANNL-RATE3 GIVING SR-DAILY-RATE3.    IM008
157296     MOVE '1' TO MAX-EXC.                                         IM008
157297     IF  WMS-MAX-LOAN-INT NOT EQUAL +0                            IM008
157298         PERFORM SPLIT-MAX-COMPARE THRU SPLIT-MAX-EXIT.           IM008
157299     MOVE '0' TO MAX-EXC.                                         IM008
157300     IF  SR-DAILY-RATE1 EQUAL HOLD-RATE1                          IM008
157301     AND SR-DAILY-RATE2 EQUAL HOLD-RATE2                          IM008
157302     AND SR-DAILY-RATE3 EQUAL HOLD-RATE3                          IM008
157303         NEXT SENTENCE                                            IM008
157304     ELSE                                                         IM008
157305         MOVE '1' TO SAVE-PAST-ACCR-FLAG                          IM008
157306         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.      0266741
157307 C2306-EXIT.  EXIT.                                               IM008
157308                                                                  IM008
157309 C2307.                                                           IM008
157310     IF  WBC-PAST-ACCR-DAYS GREATER THAN +0                       0266741
157311     AND WMS-DATE-LAST-RATE-CHANGE EQUAL WBC-CAPTURE-DATE         0266741
157312         NEXT SENTENCE                                            IM008
157313     ELSE                                                         IM008
157314         GO TO C2308.                                             IM008
157315     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
157316     MOVE WBC-PAST-ACCR-DAYS TO RET-DAYS.                         0266741
157317     CALL 'SIDLO' USING DATE-AREA.                                IM008
157318     MOVE DT-L-YR TO WMS-RATE-CHANGE-YR.                          IM008
157319     MOVE DT-L-MO TO WMS-RATE-CHANGE-MO.                          IM008
157320     MOVE DT-L-DA TO WMS-RATE-CHANGE-DA.                          IM008
157321     PERFORM R7700 THRU R7799-EXIT.                               IM008
157322                                                                  IM008
157323 C2308.                                                           IM008
157324     MOVE '0' TO SAVE-PAST-ACCR-FLAG.                             IM008
157350**** BACKDATING ACCRUALS DUE TO A BACKDATED INTEREST CATEGORY ***
157500     IF  WMS-HIFI-INDICATOR GREATER THAN ZERO
157520     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            IM002
157522       IF TIER-CHG-FLG EQUAL 'Y'                                  1003625
157600         IF  WS-RWF-TIER-CHG (TIER-SUB) EQUAL '2' OR '4'          1003625
157750             MOVE 'N' TO IOD-FLAG, RHW-IOD-FLAG
157800             MOVE WS-RWF-TIER-DATE (TIER-SUB)                     1003625
157820                  TO RHW-DATE                                     IM008
157840             MOVE WS-RWF-TIER-DEL-DATE (TIER-SUB)                 1003625
157860                  TO RHW-DATE2                                    IM008
157880             MOVE WS-RWF-TIER-PRV-DAYS (TIER-SUB)                 1003625
157900                  TO RHA-PRV-DAYS                                 IM008
157920             MOVE WS-RWF-TIER-DEL-DAYS (TIER-SUB)                 1003625
157940                  TO RHA-DEL-DAYS                                 IM008
158100             MOVE WMS-IOD-CYC-ACC-INT TO ACCRUED-TO-DATE
158150             MOVE WS-RWF-TIER-INT-ADJ (TIER-SUB)                  1003625
158152                                 TO INTEREST-ADJUST-CODE          1003625
158200             PERFORM R3778
158220             PERFORM C2308-BH-MMDA THRU C2308-BH-MMDA-EXIT        0902213
158250             PERFORM C2309 THRU C2309-EXIT
158300             MOVE 'F' TO IOD-FLAG, RHW-IOD-FLAG.
158350     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
158400     AND WMS-HIFI-INDICATOR EQUAL ZERO
158420     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            IM002
158425       IF IOD-CHG-FLG EQUAL 'Y'                                   1003625
158500         IF  WS-RWF-DDA-CHG (IOD-SUB) EQUAL '2' OR '4'            1003625
158650             MOVE 'N' TO IOD-FLAG, RHW-IOD-FLAG
158700             MOVE WS-RWF-DDA-DATE (IOD-SUB)     TO RHW-DATE       1003625
158730             MOVE WS-RWF-DDA-DEL-DATE (IOD-SUB) TO RHW-DATE2      1003625
158760             MOVE WS-RWF-DDA-PRV-DAYS (IOD-SUB) TO RHA-PRV-DAYS   1003625
158790             MOVE WS-RWF-DDA-DEL-DAYS (IOD-SUB) TO RHA-DEL-DAYS   1003625
158820             MOVE WS-RWF-DDA-DAF  (IOD-SUB)     TO RHA-CUR-DAILY  1003625
158850             MOVE WMS-IOD-PREV-DAF              TO RHA-PRV-DAILY  1003625
158880             MOVE WS-RWF-DDA-DEL-DAF  (IOD-SUB) TO RHA-DEL-DAILY  1003625
158910             MOVE WS-RWF-DDA-INT-ADJ (IOD-SUB)                    1003625
158915                  TO INTEREST-ADJUST-CODE                         1003625
158940             MOVE WMS-IOD-CYC-ACC-INT  TO ACCRUED-TO-DATE         IM008
159150             PERFORM R3778
159170             PERFORM C2308-BH-IOD  THRU C2308-BH-IOD-EXIT         0902213
159200             PERFORM C2309 THRU C2309-EXIT
159250             MOVE 'F' TO IOD-FLAG, RHW-IOD-FLAG.
159300     IF  WMS-SAVINGS-TRLR EQUAL '1'
159320     AND WMS-INT-STATUS LESS THAN '7'                             IM002
159322     AND WMS-SAV-TIER-PTR EQUAL ZERO                              0316967
159325       IF SAV-CHG-FLG EQUAL 'Y'                                   1003625
159400         IF  WS-RWF-SAV-CHG (SAV-SUB) EQUAL '2' OR '4'            9715519
159550             MOVE WS-RWF-SAV-DATE (SAV-SUB)     TO RHW-DATE       9715519
159580             MOVE WS-RWF-SAV-DEL-DATE (SAV-SUB) TO RHW-DATE2      9715519
159610             MOVE WS-RWF-SAV-PRV-DAYS (SAV-SUB) TO RHA-PRV-DAYS   9715519
159640             MOVE WS-RWF-SAV-DEL-DAYS (SAV-SUB) TO RHA-DEL-DAYS   9715519
159670             MOVE WS-RWF-SAV-DAF  (SAV-SUB)     TO RHA-CUR-DAILY  9715519
159700             MOVE WMS-SAV-PREV-DAF              TO RHA-PRV-DAILY  1105594
159730             MOVE WS-RWF-SAV-DEL-DAF (SAV-SUB)  TO RHA-DEL-DAILY  9715519
159760             MOVE WS-RWF-SAV-INT-ADJ (SAV-SUB)                    9715519
159762                                     TO INTEREST-ADJUST-CODE      1003625
159790             MOVE WMS-ACCR-INT       TO ACCRUED-TO-DATE           1003625
160000             MOVE '1' TO CALC-FLAG
160050             PERFORM R4005 THRU R4007
160070             PERFORM C2308-BH-SAV  THRU C2308-BH-SAV-EXIT         0902213
160100             PERFORM C2309 THRU C2309-EXIT.
160102     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0316967
160104     AND WMS-INT-STATUS LESS THAN '7'                             0316967
160106     AND WMS-SAV-TIER-PTR GREATER ZERO                            0316967
160108     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            0316967
160110       IF SAV-TIER-CHG-FLG EQUAL 'Y'                              0316967
160112         IF  WS-RWF-SAVT-CHG (SAV-TIER-SUB) EQUAL '2' OR '4'      0316967
160116             MOVE WS-RWF-SAVT-DATE (SAV-TIER-SUB) TO RHW-DATE     0316967
160120             MOVE WS-RWF-SAVT-DEL-DATE (SAV-TIER-SUB) TO RHW-DATE20316967
160124             MOVE WS-RWF-SAVT-PRV-DAYS (SAV-TIER-SUB)             0316967
160126                  TO RHA-PRV-DAYS                                 0316967
160128             MOVE WS-RWF-SAVT-DEL-DAYS (SAV-TIER-SUB)             0316967
160130                  TO RHA-DEL-DAYS                                 0316967
160132             MOVE WMS-ACCR-INT        TO ACCRUED-TO-DATE          0316967
160134             MOVE WS-RWF-SAVT-INT-ADJ (SAV-TIER-SUB)              0316967
160136                                 TO INTEREST-ADJUST-CODE          0316967
160138             MOVE '1' TO CALC-FLAG                                0316967
160140             PERFORM R4005 THRU R4007                             0316967
160142             PERFORM C2308-BH-SAVT THRU C2308-BH-SAVT-EXIT        0316967
160144             PERFORM C2309 THRU C2309-EXIT.                       0316967
160150     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
160170     AND WMS-OD-STATUS LESS THAN '1'                              IM002
160180     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            1020106
160200         IF  WMS-OD-ACCRL-BAL LESS THAN ZERO
160220         OR  BHW-ODAC-FLAG EQUAL 'N'                              0902213
160250             MOVE '1' TO OD-ACR-PAY-FLAG
160270             MOVE 'N' TO INTEREST-ADJ-SUBCODE                     1003625
160300             PERFORM X0900-RHR-OD-ACCRUAL THRU X0900-RHR-OD-EXIT.
160320     MOVE SPACE TO BHW-TYPE.                                      0902213
160350 C2308-LOAN.
160400     IF  WMS-LOAN-TRLR EQUAL '0'
160410     OR  WMS-NB-DC-ABM EQUAL '1'                                  9915749
160450         GO TO C2310.
160460     IF  WMS-LOAN-STATUS EQUAL '3' OR '4' OR '6' OR '9'           IM002
160470         GO TO C2310.                                             IM002
160500     IF  WMS-INT-RATE-PTR GREATER THAN ZERO
160550     AND WMS-INT-RATE-PTR LESS THAN +6
160555      IF  LOAN-CHG-FLG EQUAL 'Y'                                  1003625
160650         IF  WS-RWF-LN-CHG (LOAN-SUB) EQUAL '2' OR '4'            1003625
160655             MOVE 'L' TO RHW-TYPE                                 1003625
160670             MOVE WMS-INT-RATE-PTR TO RHW-LOAN-IND                IM008
160750                                      RHW-IND                     1003625
160850             MOVE 'N' TO RHW-LOAN
160900             MOVE WMS-LN-CUR-DATE TO RHW-DATE                     1003625
160920             MOVE WS-RWF-LN-DEL-DATE (LOAN-SUB) TO RHW-DATE2      1003625
160940             MOVE WS-RWF-LN-PRV-DAYS (LOAN-SUB)                   1003625
160960                  TO RHA-PRV-DAYS                                 IM008
160980                     RHW-DAYS2                                    IM008
161000             MOVE WS-RWF-LN-DEL-DAYS (LOAN-SUB)                   1003625
161020                  TO RHA-DEL-DAYS                                 IM008
161150             MOVE WMS-LN-CUR-DAF                                  1003625
161160                  TO RHA-CUR-DAILY                                IM008
161190             MOVE WMS-LN-PREV-DAF                                 1003625
161220                  TO RHA-PRV-DAILY                                IM008
161250             MOVE WS-RWF-LN-DEL-DAF (LOAN-SUB)                    1003625
161280                  TO RHA-DEL-DAILY                                IM008
161400             MOVE WMS-LOAN-ACCR-INT TO ACCRUED-TO-DATE
161450             MOVE WS-RWF-LN-INT-ADJ (LOAN-SUB)                    1003625
161455                  TO INTEREST-ADJUST-CODE                         1003625
161500             PERFORM C2309 THRU C2309-EXIT
161550             MOVE RHW-DATE TO C-LOW-DATE
161600             MOVE C-LOW-DA TO WMS-RATE-CHANGE-DA
161650             MOVE C-LOW-MO TO WMS-RATE-CHANGE-MO
161700             MOVE C-LOW-YR TO WMS-RATE-CHANGE-YR
161750             MOVE 'F' TO RHW-LOAN
161800             GO  TO  C2310.
161850     IF  WMS-INT-RATE-PTR EQUAL +6 OR +7
161855         MOVE 'P' TO RHW-TYPE                                     1003625
161900         MOVE 001 TO RHW-IND, RHW-LOAN-IND                        1003625
161910         IF  PRIME-CHG-FLG EQUAL 'Y'                              1003625
161950           IF  WS-RWF-PRM-CHG (PRIME-SUB) EQUAL '2' OR '4'        1003625
162100             MOVE 'N' TO RHW-LOAN
162150             MOVE WMS-PRM-CUR-DATE    TO RHW-DATE                 1003625
162170             MOVE WS-RWF-PRM-DEL-DATE (PRIME-SUB) TO RHW-DATE2    1003625
162190             MOVE WS-RWF-PRM-PRV-DAYS (PRIME-SUB)                 1003625
162192                                      TO RHA-PRV-DAYS             1003625
162210                                         RHW-DAYS2                1003625
162230             MOVE WS-RWF-PRM-DEL-DAYS (PRIME-SUB) TO RHA-DEL-DAYS 1003625
162250             MOVE WS-RWF-PRM-INT-ADJ  (PRIME-SUB)                 1003625
162255                                      TO INTEREST-ADJUST-CODE     1003625
162400             MOVE WMS-LOAN-ACCR-INT   TO ACCRUED-TO-DATE          1003625
162450             PERFORM C2309 THRU C2309-EXIT
162500             MOVE RHW-DATE TO C-LOW-DATE
162550             MOVE C-LOW-DA TO WMS-RATE-CHANGE-DA
162600             MOVE C-LOW-MO TO WMS-RATE-CHANGE-MO
162650             MOVE C-LOW-YR TO WMS-RATE-CHANGE-YR
162700             MOVE 'F' TO RHW-LOAN
162750             GO  TO  C2310.
162800     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0
162850         MOVE WMS-SPLIT-RATE-SCHD TO RHW-SPLIT-RATE-IND
162900                                     RHW-IND                      1003625
162910         MOVE 'S' TO RHW-TYPE                                     1003625
162915         IF  SPLIT-CHG-FLG EQUAL 'Y'                              1003625
162950           IF  WS-RWF-SPL-CHG (SPLIT-SUB) EQUAL '2' OR '4'        1003625
163150             MOVE 'N' TO RHW-LOAN
163200             MOVE WMS-SPL-CUR-DATE                                1003625
163220                  TO RHW-DATE                                     IM008
163240             MOVE WS-RWF-SPL-DEL-DATE (SPLIT-SUB)                 1003625
163260                  TO RHW-DATE2                                    IM008
163280             MOVE WS-RWF-SPL-PRV-DAYS (SPLIT-SUB)                 1003625
163300                  TO RHA-PRV-DAYS                                 IM008
163320                     RHW-DAYS2                                    IM008
163340             MOVE WS-RWF-SPL-DEL-DAYS (SPLIT-SUB)                 1003625
163360                  TO RHA-DEL-DAYS                                 IM008
163380             MOVE WS-RWF-SPL-INT-ADJ (SPLIT-SUB)                  1003625
163385                  TO INTEREST-ADJUST-CODE                         1003625
163600             MOVE WMS-LOAN-ACCR-INT TO ACCRUED-TO-DATE
163650             MOVE 'N' TO RATE-TYPE
163700             PERFORM C2309 THRU C2309-EXIT
163750             MOVE RHW-DATE TO C-LOW-DATE
163800             MOVE C-LOW-DA TO WMS-RATE-CHANGE-DA
163850             MOVE C-LOW-MO TO WMS-RATE-CHANGE-MO
163900             MOVE C-LOW-YR TO WMS-RATE-CHANGE-YR
163950             MOVE 'F' TO RHW-LOAN.
164000     GO TO C2310.
164050 C2308-BH-MMDA.                                                   0902213
164051     MOVE SPACES TO BHW-TYPE                                      0902213
164052                    HOLD-DATE.                                    0902213
164053     IF  BHW-IOD-FLAG EQUAL 'M'                                   0902213
164054     AND WBHM-ENTRIES GREATER THAN ZERO                           0902213
164055         MOVE 'M'                    TO BHW-TYPE                  0902213
164056         MOVE WBHM-DD (WBHM-ENTRIES) TO HOLD-DA                   0902213
164057         MOVE WBHM-MM (WBHM-ENTRIES) TO HOLD-MO                   0902213
164058         MOVE WBHM-YY (WBHM-ENTRIES) TO HOLD-YR.                  0902213
164059 C2308-BH-MMDA-EXIT.  EXIT.                                       0902213
164060 C2308-BH-IOD.                                                    0902213
164061     MOVE SPACES TO BHW-TYPE                                      0902213
164062                    HOLD-DATE.                                    0902213
164063     IF  BHW-IOD-FLAG EQUAL 'I'                                   0902213
164064     AND WBHI-ENTRIES GREATER THAN ZERO                           0902213
164065         MOVE 'I'                    TO BHW-TYPE                  0902213
164066         MOVE WBHI-DD (WBHI-ENTRIES) TO HOLD-DA                   0902213
164067         MOVE WBHI-MM (WBHI-ENTRIES) TO HOLD-MO                   0902213
164068         MOVE WBHI-YY (WBHI-ENTRIES) TO HOLD-YR.                  0902213
164069 C2308-BH-IOD-EXIT.  EXIT.                                        0902213
164070 C2308-BH-SAV.                                                    0902213
164071     MOVE SPACES TO BHW-TYPE                                      0902213
164072                    HOLD-DATE.                                    0902213
164073     IF  BHW-SAV-FLAG EQUAL 'R'                                   0316967
164074     AND WBHS-ENTRIES GREATER THAN ZERO                           0902213
164075         MOVE 'S'                    TO BHW-TYPE                  0902213
164076         MOVE WBHS-DD (WBHS-ENTRIES) TO HOLD-DA                   0902213
164077         MOVE WBHS-MM (WBHS-ENTRIES) TO HOLD-MO                   0902213
164078         MOVE WBHS-YY (WBHS-ENTRIES) TO HOLD-YR.                  0902213
164079 C2308-BH-SAV-EXIT. EXIT.                                         0902213
164080 C2308-BH-SAVT.                                                   0316967
164081     MOVE SPACES TO BHW-TYPE                                      0316967
164082                    HOLD-DATE.                                    0316967
164083     IF  BHW-SAV-FLAG EQUAL 'T'                                   0316967
164084     AND WBHT-ENTRIES GREATER THAN ZERO                           0316967
164085         MOVE 'T'                    TO BHW-TYPE                  0316967
164086         MOVE WBHT-DD (WBHT-ENTRIES) TO HOLD-DA                   0316967
164087         MOVE WBHT-MM (WBHT-ENTRIES) TO HOLD-MO                   0316967
164088         MOVE WBHT-YY (WBHT-ENTRIES) TO HOLD-YR.                  0316967
164089 C2308-BH-SAVT-EXIT. EXIT.                                        0316967
164090 C2309.                                                           0316967
164100     IF (RHA-DEL-DAYS NOT GREATER THAN WBC-PAST-ACCR-DAYS)        0266741
164150     AND (RHA-PRV-DAYS NOT GREATER THAN WBC-PAST-ACCR-DAYS)       0266741
164200         GO TO C2309-EXIT.
164250     IF  RHA-DEL-DAYS GREATER THAN WBC-PAST-ACCR-DAYS             0266741
164300         SUBTRACT WBC-PAST-ACCR-DAYS FROM RHA-DEL-DAYS            0266741
164350     ELSE
164400         MOVE ZERO TO RHA-DEL-DAYS.
164450     IF  RHA-PRV-DAYS GREATER THAN WBC-PAST-ACCR-DAYS             0266741
164500         SUBTRACT WBC-PAST-ACCR-DAYS FROM RHA-PRV-DAYS            0266741
164550     ELSE
164600         MOVE ZERO TO RHA-PRV-DAYS.
164650     IF  RHW-LOAN EQUAL 'N'
164700         MOVE WMS-DATE-LAST-LOAN-ACTIVITY TO HOLD-DATE
164750     ELSE
164800         IF  BHW-TYPE EQUAL SPACE                                 0902213
164810             MOVE WMS-DATE-LAST-MONETARY-ACT  TO HOLD-DATE.       0902213
164850     IF  HOLD-DATE EQUAL SPACES OR ZEROES
164900         GO TO C2309-EXIT.
164950     MOVE HOLD-MO TO RHW-TRAN-MO.
165000     MOVE HOLD-DA TO RHW-TRAN-DA.
165050     MOVE HOLD-YR TO RHW-TRAN-YR.
165100     IF  HOLD-YR GREATER THAN WBC-NEXT-CENT-YR                    0266741
165150         MOVE '19' TO RHW-TRAN-CENT
165200     ELSE
165250         MOVE '20' TO RHW-TRAN-CENT.
165300     IF  INTEREST-ADJUST-CODE EQUAL '6'                           1003625
165350         MOVE RHW-DATE2 TO RHW-DATE.
165400     IF  RHW-TRAN-DATE GREATER THAN RHW-DATE
165450     OR  (RHW-TRAN-DATE EQUAL RHW-DATE
165470     AND BHW-TYPE EQUAL SPACE                                     0902213
165500     AND (HOLD-DATE EQUAL WMS-DATE-LAST-SERV-CHG
165550     OR   HOLD-DATE EQUAL WMS-DATE-LAST-STMT))
165600         MOVE 'KP' TO IMEX-CODE-1
165650         MOVE '1'  TO EX21-REJ-RSN
165700         MOVE ZERO TO ACCRUAL-AMOUNT
165750         IF  RHW-LOAN EQUAL 'F'
165800             IF  RHW-IOD-FLAG EQUAL 'N'
165850                 MOVE 'KQ' TO IMEX-CODE-2
165900                 GO TO C2309-EXC
165950             ELSE
166000                 MOVE 'KR' TO IMEX-CODE-2
166050                 GO TO C2309-EXC
166100         ELSE
166150             MOVE 'KS' TO IMEX-CODE-2
166200             GO TO C2309-EXC.
166250     IF  RHW-LOAN EQUAL 'N'
166300         IF  (WMS-LOAN-STATUS LESS THAN '3' OR EQUAL '5')
166350         AND WMS-PRIN-BAL GREATER THAN ZERO
166400             PERFORM X0500-RHR-LOAN-ACCRUAL THRU
166450                     X0500-RHR-LOAN-EXIT
166500             SUBTRACT ACCRUED-TO-DATE FROM WMS-LOAN-ACCR-INT
166550                 GIVING ACCRUAL-AMOUNT
166600             GO  TO  C2309-A
166650         ELSE
166700             GO  TO  C2309-EXIT.
166750     IF  ACCRUAL-BALANCE NOT GREATER THAN +0.00                   IM007
166770     AND BHW-TYPE EQUAL SPACE                                     0902213
166800         GO TO C2309-EXIT.
166803                                                                  1004795
166806     IF  WMS-DATE-LAST-STMT EQUAL SPACES                          9715595
166809         MOVE WMS-OPENED-YR      TO TISA-RHW-TRAN-YR              9715595
166812         MOVE WMS-OPENED-DA      TO TISA-RHW-TRAN-DA              9715595
166815         MOVE WMS-OPENED-MO      TO TISA-RHW-TRAN-MO              9715595
166818         MOVE ZERO               TO C-NO-DAYS                     9715595
166821     ELSE                                                         9715595
166824         MOVE WMS-LAST-STMT-YR   TO TISA-RHW-TRAN-YR              9715595
166827         MOVE WMS-LAST-STMT-DA   TO TISA-RHW-TRAN-DA              9715595
166830         MOVE WMS-LAST-STMT-MO   TO TISA-RHW-TRAN-MO              9715595
166833         MOVE +1                 TO C-NO-DAYS.                    9715595
166836                                                                  9715595
166839     IF  TISA-RHW-TRAN-YR GREATER THAN WBC-NEXT-CENT-YR           0266741
166842         MOVE '19'               TO TISA-RHW-TRAN-CENT            9715595
166845     ELSE                                                         9715595
166848         MOVE '20'               TO TISA-RHW-TRAN-CENT.           9715595
166851                                                                  9715595
166854     IF  C-NO-DAYS GREATER THAN ZERO                              9715595
166857         MOVE TISA-RHW-TRAN-DATE TO C-LOW-DATE                    9715595
166858         CALL 'SIDCHI'        USING C-DATE-WORK                   9715595
166859         MOVE C-HIGH-DATE        TO TISA-RHW-TRAN-DATE.           9715595
166860*                                                                 1004795
166863*  CALCULATE THE DAYS BETWEEN THE TISA PER DATE AND TODAY.        9715595
166866*                                                                 1004795
166869     MOVE WBC-CAPTURE-MO         TO C-HIGH-MO.                    0266741
166872     MOVE WBC-CAPTURE-DA         TO C-HIGH-DA.                    0266741
166875     MOVE WBC-CAPTURE-YR         TO C-HIGH-YR.                    0266741
166878                                                                  1004795
166881     IF  WBC-CAPTURE-YR GREATER THAN WBC-NEXT-CENT-YR             0266741
166884         MOVE '19' TO C-HIGH-CENT                                 1004795
166887     ELSE                                                         1004795
166890         MOVE '20' TO C-HIGH-CENT.                                1004795
166893                                                                  1004795
166896     MOVE TISA-RHW-TRAN-DATE      TO C-LOW-DATE.                  1004795
166899                                                                  1004795
166902     CALL 'SIDIFC1'           USING C-DATE-WORK.                  1004795
166905                                                                  1004795
166908     MOVE C-NO-DAYS              TO TISA-ACCRUAL-DAYS.            1004795
166911*                                                                 1004795
166914*  SUBTRACT ANY DAYS THAT HAVE NOT BEEN ACCRUED FROM TISA DAYS.*  1004795
166917*                                                                 1004795
166919     SUBTRACT WBC-PAST-ACCR-DAYS FROM TISA-ACCRUAL-DAYS.          0266741
166920                                                                  1004795
166921     IF  TISA-ACCRUAL-DAYS LESS THAN ZERO                         1004795
166922         MOVE ZERO               TO TISA-ACCRUAL-DAYS.            1004795
166923*                                                                 1004795
166926*  IF TISA DAYS GREATER THAN DAYS TO ACCRUE FOR BACKDATE OR    *  1004795
166929*  CORRECTION, MOVE DAYS TO ACCRUE TO TISA DAYS TO ACCRUE.     *  1004795
166932*                                                                 1004795
166935     IF  INTEREST-ADJUST-CODE EQUAL '4' OR '5'                    1004795
166938         IF  TISA-ACCRUAL-DAYS GREATER THAN RHA-PRV-DAYS          1004795
166941             MOVE RHA-PRV-DAYS   TO TISA-ACCRUAL-DAYS.            1004795
166944                                                                  1004795
166947     IF  INTEREST-ADJUST-CODE EQUAL '6'                           1004795
166950         IF  TISA-ACCRUAL-DAYS GREATER THAN RHA-DEL-DAYS          1004795
166953             MOVE RHA-DEL-DAYS   TO TISA-ACCRUAL-DAYS.            1004795
166956                                                                  1004795
166959     PERFORM ADJUST-ACCRUED-INTEREST THRU END-INT-A.              1004795
166960                                                                  1004795
166962 C2309-A.                                                         1004795
166963                                                                  1004795
166975     MOVE 'HC'                   TO IMEX-CODE-1.                  1004795
167000     MOVE '0'  TO EX21-REJ-RSN.
167050     IF  RHW-LOAN EQUAL 'F'
167100         IF  RHW-IOD-FLAG EQUAL 'N'
167150             MOVE 'HD' TO IMEX-CODE-2
167200         ELSE
167250             MOVE 'HE' TO IMEX-CODE-2
167300     ELSE
167350         MOVE 'HF' TO IMEX-CODE-2.
167400 C2309-EXC.
167450     MOVE '21' TO IMEX-REC-NO.
167500     MOVE HOLD-DATE TO EX21-MONETARY-DATE.
167550     MOVE RHW-DATE TO EX21-RATE-DATE.
167600     MOVE ACCRUAL-AMOUNT TO EX21-ACCRUAL-AMOUNT.
167640     MOVE RHW-TYPE TO EX21-RATE-TYPE.                             1003625
167650     MOVE RHW-IND  TO EX21-RATE-PTR.                              1003625
167700     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
167750 C2309-EXIT.
167800     EXIT.
167850 C2310.
167860     MOVE WBC-CURR-PAST-BUS-DAYS TO WORK-BUSINESS-DAYS.           0266741
167870     MOVE WBC-PAST-ACCR-DAYS TO ACCR-NO-HOLD.                     0266741
167900     IF  WBC-PAST-ACCR-DAYS EQUAL ZERO                            0266741
167950         GO TO C2320.                                             IM007
167952     MOVE +0 TO WS-PREV-INT-AGG-ADJ.                              9916070
167954     IF  WMS-INT-COLL-CALC EQUAL '2' OR '5' OR '6'                9916070
167956         ADD WMS-HOLD-AMT       TO WS-PREV-INT-AGG-ADJ.           9916070
167958     IF  WMS-INT-COLL-CALC EQUAL '3' OR '5'                       9916070
167960         ADD WMS-BANK-AVAIL-AMT TO WS-PREV-INT-AGG-ADJ.           9916070
167962     IF  WMS-INT-COLL-CALC EQUAL '4' OR '6'                       9916070
167964         ADD WMS-CUST-AVAIL-AMT TO WS-PREV-INT-AGG-ADJ.           9916070
167966     IF  WMS-INT-COLL-CALC EQUAL '7'                              9916070
167968         ADD WMS-NB-OTH-HLD     TO WS-PREV-INT-AGG-ADJ.           9916070
168000     MOVE '1' TO PAST-ACCR.
168058     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       IM005
168066     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     IM005
168074         ADD WBC-PAST-ACCR-DAYS TO WMS-MTD-ACCRUAL-DAYS.          0266741
168082     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM005
168090         ADD WBC-PAST-ACCR-DAYS TO WMS-INT-MTD-ACCR-DAYS.         0266741
168092     MOVE WBC-PAST-ACCR-DAYS TO HOLD-ACCRUAL-DAYS.                0266741
168094     PERFORM S3010-RCK-AVERAGES THRU S3010-EXIT.                  1005110
168095                                                                  1010099
168096 C2315.                                                           1010099
168097*--------------------------------------------------------------*  1010099
168098*    CALCULATE QTD AGGREGATES ACCORDING TO FDIC RULES.         *  1010099
168099*--------------------------------------------------------------*  1010099
168100     IF  WMS-DDA-BAL GREATER THAN ZERO                            1010099
168101         COMPUTE WMS-QTD-AGGR-BAL = WMS-QTD-AGGR-BAL +            1010099
168102                     (WMS-DDA-BAL * HOLD-ACCRUAL-DAYS).           1010099
168103     COMPUTE WMS-QTD-AGGR-DAYS    = WMS-QTD-AGGR-DAYS             1010099
168104                                  + HOLD-ACCRUAL-DAYS.            1010099
168105     ADD WMS-IOD-CYC-ACC-INT +.005 GIVING WK-ROUND-ACCR.          1010099
168106     COMPUTE WMS-QTD-AGGR-BAL     = WMS-QTD-AGGR-BAL +            1010099
168107                   (WK-ROUND-ACCR * HOLD-ACCRUAL-DAYS).           1010099
168108     IF  WMS-SAVINGS-TRLR NOT EQUAL TO '1'                        1010099
168109         GO TO C2315-EXIT.                                        1010099
168110     IF  WMS-CMA-INDICATOR EQUAL '1' AND                          1010099
168111         WMS-CMA-BALANCE-USE EQUAL '1'                            1010099
168112         MOVE WMS-PREV-INT-BAL TO CUR-BAL                         1010099
168113     ELSE                                                         1010099
168114         MOVE WMS-INT-CUR-BAL TO CUR-BAL.                         1010099
168115     IF  CUR-BAL GREATER THAN ZERO                                1010099
168116         COMPUTE WMS-INT-QTD-AGGR-BAL = WMS-INT-QTD-AGGR-BAL +    1010099
168117                             (CUR-BAL * HOLD-ACCRUAL-DAYS).       1010099
168118     COMPUTE WMS-INT-QTD-AGGR-DAYS = WMS-INT-QTD-AGGR-DAYS        1010099
168119                                   + HOLD-ACCRUAL-DAYS.           1010099
168120     ADD WMS-ACCR-INT +.005 GIVING WK-ROUND-ACCR.                 1010099
168121     COMPUTE WMS-INT-QTD-AGGR-BAL = WMS-INT-QTD-AGGR-BAL +        1010099
168122                   (WK-ROUND-ACCR * HOLD-ACCRUAL-DAYS).           1010099
168123                                                                  1010099
168124 C2315-EXIT.                                                      1010099
168125     EXIT.                                                        1010099
168126                                                                  1010099
168127 C2320.                                                           1010099
168128*--------------------------------------------------------------*  1010099
168129* SET THE ACCRUAL-DATE FOR USE BY THE ACCRUAL PROGRAM.         *  1010099
168130*--------------------------------------------------------------*  1010099
168131     MOVE WBC-CAPTURE-MO TO C-HIGH-MO.                            1010099
168132     MOVE WBC-CAPTURE-DA TO C-HIGH-DA.                            1010099
168133     MOVE WBC-CAPTURE-YR TO C-HIGH-YR.                            1010099
168134     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                1010099
168135         MOVE '20'       TO C-HIGH-CENT                           1010099
168136     ELSE                                                         1010099
168137         MOVE '19'       TO C-HIGH-CENT.                          1010099
168138     MOVE ACCR-NO-HOLD   TO C-NO-DAYS.                            1010099
168139     CALL 'SIDCLO'    USING C-DATE-WORK.                          1010099
168140     MOVE C-LOW-DATE     TO ACCRUAL-DATE.                         1010099
168142     IF  NON-EFAA-ACCOUNT EQUAL '1'                               0902213
168145         GO TO C2325.                                             0902213
168148******************************************************************0902213
168151***  ROLL AVAILABILITY FOR EFAA ACCOUNTS FOR CATCH UP          ***0902213
168154***  BUSINESS DAYS (BC-CURR-PAST-BUS-DAYS GREATER THAN +0)     ***0902213
168155*--- BYPASS FLOAT AGING IF ACCRUAL DAYS EQUALS ZERO -------------*9915749
168157******************************************************************0902213
168158     IF  WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
168159         GO TO C2337.                                             9915749
168160     IF  WORK-BUSINESS-DAYS GREATER THAN +0                       0902213
168163         GO TO C2330                                              0902213
168166     ELSE                                                         0902213
168169         GO TO C2337.                                             0902213
168172 C2325.                                                           0902213
168175     IF  ACCR-NO-HOLD GREATER THAN +0                             0902213
168178         IF  WBC-FLOAT-FLAG EQUAL 'C'                             0266741
168181             GO TO C2330                                          0902213
168184         ELSE                                                     0902213
168187             GO TO C2337.                                         0902213
168190     GO TO C2337.                                                 0902213
168193 C2330.                                                           0902213
168196     MOVE WMS-HOLD-AMT TO HOLD-HOLD-AMT.                          0902213
168220     IF  WMS-BANK-AVAIL-TRLR EQUAL TO '0', GO TO C2334.           IM007
168230     IF  WMS-BANK-AVAIL-AMT EQUAL ZEROES,  GO TO C2334.           IM007
168240     ADD WMS-BANK-AVAIL-TR-AMT (1) TO DDA-BANK-AVAIL-BUMP         0902970
168241                                      WS-GL-DDA-BANK-AVAIL-BUMP.  0902970
168340     MOVE WMS-BANK-AVAIL-2-7 TO WMS-BANK-AVAIL-TRAILER.           IM007
168370     MOVE ZERO TO WMS-BANK-AVAIL-TR-AMT (7).                      IM007
168500     PERFORM C2435 THRU C2435-EXIT.
168520     MOVE ZERO TO SAVE-BANK-AMT.                                  IM007
168530     MOVE WMS-BANK-AVAIL-TRAILER TO SAVE-BANK-TRLR.               IM007
168550 C2334.
168600     IF  WMS-CUST-AVAIL-TRLR EQUAL TO '0', GO TO C2335.           IM007
168610     IF  WMS-CUST-AVAIL-AMT EQUAL ZEROES,  GO TO C2335.           IM007
168620     ADD WMS-CUST-AVAIL-FUNDS (1) TO DDA-CUST-AVAIL-BUMP          0902970
168621                                     WS-GL-DDA-CUST-AVAIL-BUMP.   0902970
168660     IF  WMS-EXTEND-FLOAT     EQUAL '1'                           0927817
168670     OR  AFF-FLAG             EQUAL 'N'                           0927817
168680         PERFORM C2442 THRU C2442-EXIT                            0927817
168690     ELSE                                                         0927817
168700         MOVE WMS-CUST-AVAIL-2-12 TO WMS-CUST-AVAIL-TRAILER       0927817
168720         MOVE ZERO               TO WMS-CUST-AVAIL-FUNDS (12).    0927817
168850     PERFORM C2445 THRU C2445-EXIT.
168870     MOVE ZERO TO SAVE-CUST-AMT.                                  IM007
168872     MOVE WMS-CUST-AVAIL-TRAILER TO SAVE-CUST-TRLR.               IM007
168874 C2335.                                                           IM007
168876     IF  WMS-CASH-AVAIL-TRLR EQUAL TO '0', GO TO C2337.           IM007
168877     IF  WMS-CASH-AVAIL-AMT EQUAL ZEROES,  GO TO C2337.           IM007
168880     ADD WMS-CASH1-AVAIL (1) TO DDA-CASH-AVAIL-BUMP               0902970
168881                                WS-GL-DDA-CASH-AVAIL-BUMP.        0902970
168882     ADD WMS-CASH2-AVAIL (1) TO DDA-CASH-AVAIL-BUMP               0902970
168883                                WS-GL-DDA-CASH-AVAIL-BUMP.        0902970
168884     MOVE WMS-CASH-2-12 TO WMS-CASH-AVAIL-TRAILER.                IM007
168886     MOVE ZERO TO WMS-CASH1-AVAIL (12)                            IM007
168888                  WMS-CASH2-AVAIL (12).                           IM007
168890     PERFORM C2447 THRU C2447-EXIT.                               IM007
168900 C2337.                                                           IM007
168905     MOVE WMS-HOLD-AMT TO HOLD-HOLD-AMT.                          IM008
168910     IF  ACCR-NO-HOLD NOT GREATER THAN +0                         IM007
168920         GO TO C2365.                                             IM007
168930 C2340.                                                           IM007
168940*----------------------------------------------------------------*9915749
168941*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *9915749
168942*----------------------------------------------------------------*9915749
168943     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
168944     AND WBC-ACCRUAL-DAYS EQUAL 0                                 0266741
168945         GO TO C2340-EXIT.                                        9915749
168950     IF WBC-AGGREGATE NOT EQUAL TO 'C', GO TO C2340-EXIT.         0266741
169000     MOVE WMS-CURR-BAL TO CUR-BAL.
169050     MOVE WMS-COLL-CALC TO CALC-FLAG.
169100     PERFORM K0104 THRU K0105.
169150     MOVE CUR-BAL TO COLL-BAL.
169159     MOVE '1' TO WXI-EXCLUDE-BAL.                                 2016639
169160     PERFORM K0106 THRU K0106-EXIT.                               IM003
169161     MOVE '0' TO WXI-EXCLUDE-BAL.                                 2016639
169170     MOVE '0' TO CUST-CALC-FLAG.                                  IM003
169200     PERFORM S1020 THRU S1024.
169250     IF  WMS-DDA-BAL LESS THAN ZERO
169300     AND WMS-SAV-PTR EQUAL TO ZERO                                IM003
169320     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
169350         ADD +1 TO WMS-MTD-OD-DAYS
169400         ADD WMS-DDA-BAL TO WMS-MTD-AGGR-OD.
169450     IF ACCR-SW EQUAL TO 'N'
169510         GO TO C2340-EXIT                                         IM002
169550     ELSE
169600         PERFORM R4001 THRU R4002
169650         IF  WMS-SAVINGS-TRLR EQUAL TO '1'
169700             PERFORM R4005 THRU R4008-EXIT                        9916070
169702             IF  WMS-CMA-INDICATOR EQUAL '0'                      2016683
169704                  ADD WMS-DDA-BAL   TO WMS-SC-AGGR-DDA.           9916070
169710 C2340-EXIT.                                                      IM002
169720     EXIT.                                                        IM002
169750 C2360.
169800     IF  WMS-HIFI-INDICATOR GREATER THAN ZERO
169820     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            IM002
169850         IF  PAST-ACCR EQUAL '1'                                  IM008
169855             MOVE 'T' TO RHW-TYPE                                 1003625
169900             MOVE WMS-HIFI-INDICATOR TO RHW-IND                   1003625
169910             IF  TIER-CHG-FLG EQUAL 'Y'                           1003625
170000                 MOVE WS-RWF-TIER-PRV-DAYS (TIER-SUB)             1003625
170010                     TO RHW-DAYS                                  1003625
170050                 PERFORM R3776 THRU R3785-EXIT                    1003625
170055             ELSE                                                 1003625
170060                 MOVE +0 TO RHW-DAYS                              1003625
170065                 PERFORM R3776 THRU R3785-EXIT.                   1003625
170200     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
170250     AND WMS-HIFI-INDICATOR EQUAL ZERO
170270     AND (WMS-STATUS NOT EQUAL '05' AND '08' AND '99')            IM002
170300         IF  PAST-ACCR EQUAL '1'                                  IM008
170310             MOVE 'I' TO RHW-TYPE                                 1003625
170320             MOVE WMS-IOD-RATE-PTR TO RHW-IND                     IM008
170325             IF  IOD-CHG-FLG EQUAL 'Y'                            1003625
170400                 MOVE WS-RWF-DDA-PRV-DAYS (IOD-SUB) TO RHW-DAYS   1003625
170405                 PERFORM R3776 THRU R3785-EXIT                    1003625
170410             ELSE                                                 1003625
170420                 MOVE +0 TO RHW-DAYS                              1003625
170550                 PERFORM R3776 THRU R3785-EXIT.                   1003625
170600     IF  WMS-SAVINGS-TRLR EQUAL '1'
170620     AND WMS-INT-STATUS LESS THAN '7'                             IM002
170622     AND WMS-SAV-TIER-PTR EQUAL +0                                0316967
170650         IF  PAST-ACCR EQUAL '1'                                  IM008
170660             MOVE 'I' TO RHW-TYPE                                 1003625
170670             MOVE WMS-INT-RATE TO RHW-IND                         IM008
170675             IF  SAV-CHG-FLG EQUAL 'Y'                            1003625
170750                 MOVE WS-RWF-SAV-PRV-DAYS (SAV-SUB) TO RHW-DAYS   9715519
170900                 PERFORM R3820 THRU R3825-EXIT                    1003625
170910             ELSE                                                 1003625
170915                 MOVE +0 TO RHW-DAYS                              1003625
170920                 PERFORM R3820 THRU R3825-EXIT.                   1003625
170922     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0316967
170924     AND WMS-INT-STATUS LESS THAN '7'                             0316967
170926     AND WMS-SAV-TIER-PTR GREATER +0                              0316967
170928         IF  PAST-ACCR EQUAL '1'                                  0316967
170930             MOVE 'T' TO RHW-TYPE                                 0316967
170932             MOVE WMS-SAV-TIER-PTR TO RHW-IND                     0316967
170934             IF  SAV-TIER-CHG-FLG EQUAL 'Y'                       0316967
170936                 MOVE WS-RWF-SAVT-PRV-DAYS (SAV-TIER-SUB)         0316967
170938                                           TO RHW-DAYS            0316967
170940                 PERFORM R3820 THRU R3825-EXIT                    0316967
170942             ELSE                                                 0316967
170944                 MOVE +0 TO RHW-DAYS                              0316967
170946                 PERFORM R3820 THRU R3825-EXIT.                   0316967
170950     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
170970     AND WMS-OD-STATUS LESS THAN '1'                              IM002
171000         IF  WMS-OD-ACCRL-BAL LESS THAN ZERO
171050         OR  BHW-ODAC-FLAG EQUAL 'N'                              0902213
171100             PERFORM R3900 THRU R3920-EXIT.                       0902213
171250 C2364.
171255*--- SKIP AUTOBORROW ACCOUNTS -----------------------------------*9915749
171260     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915749
171265         GO TO C2364-EXIT.                                        9915749
171300     IF  WMS-LOAN-TRLR EQUAL '0'
171350         GO  TO  C2364-EXIT.
171360     IF  WMS-LOAN-STATUS EQUAL '3' OR '4' OR '6' OR '9'           IM002
171370         GO  TO  C2364-EXIT.                                      IM002
171400     IF  PAST-ACCR EQUAL '1'                                      IM008
171450         PERFORM C2369-A THRU C2369-A-EXIT
171500         IF  X GREATER +0                                         1003625
171800             IF  WMS-PRIN-BAL GREATER THAN +0.00                  IM005
171820                 MOVE '3' TO INTEREST-ADJUST-CODE                 IM005
171840                 MOVE X   TO RHW-IND                              IM005
171860                 MOVE 'N' TO RHW-LOAN                             IM005
171880                 PERFORM X0500-RHR-LOAN-ACCRUAL THRU              IM005
171900                         X0500-RHR-LOAN-EXIT                      IM005
171920                 MOVE '1' TO WMS-LOAN-CALC-CODE                   IM005
171940                 MOVE 'F' TO RHW-LOAN                             IM005
171960                 GO  TO  C2364-EXIT                               IM005
171980             ELSE                                                 IM005
172000                 GO  TO  C2364-EXIT.                              IM005
172200     PERFORM C2371 THRU C2400.
172250 C2364-EXIT. EXIT.
172300 C2365.
172310     IF  BANK-AVAIL-CHANGE EQUAL '1'                              IM007
172320     OR  CUST-AVAIL-CHANGE EQUAL '1'                              IM007
172330         PERFORM X4000-ROLL-PREV-AVAIL THRU X4045-EXIT.           IM008
172350     MOVE +0 TO BANK-AVAIL-CHANGE, CUST-AVAIL-CHANGE.             IM007
172400     IF  ACCR-NO-HOLD GREATER THAN +0                             IM007
172410         SUBTRACT +1 FROM ACCR-NO-HOLD.                           IM007
172420     IF  WORK-BUSINESS-DAYS GREATER THAN +0                       IM007
172430         SUBTRACT +1 FROM WORK-BUSINESS-DAYS.                     IM007
172440     IF  ACCR-NO-HOLD GREATER THAN +0                             IM007
172450     OR  WORK-BUSINESS-DAYS GREATER THAN +0                       IM007
172460         GO TO C2320.                                             IM007
172500     MOVE '0' TO PAST-ACCR.
172504*--------------------------------------------------------------*  0902213
172508*  RESET ACCRUAL-DATE TO CAPTURE DATE (AFTER PAST ACCRUALS)    *  0902213
172512*--------------------------------------------------------------*  0902213
172516     MOVE WBC-CAPTURE-MO TO ACCR-MO.                              0266741
172520     MOVE WBC-CAPTURE-DA TO ACCR-DA.                              0266741
172524     MOVE WBC-CAPTURE-YR TO ACCR-YR.                              0266741
172528     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
172532         MOVE '20'       TO ACCR-CC                               0902213
172536     ELSE                                                         0902213
172540         MOVE '19'       TO ACCR-CC.                              0902213
172550 C2369.  EXIT.
172600 C2369-GO-TO.
172650     GO  TO  C2370.
172700 C2369-A.
172750     MOVE +0 TO X.
172800     IF  WMS-INT-RATE-PTR GREATER THAN +5 AND
172850         (PRIME-CALC-FLAG EQUAL '0' OR '1') AND                   1003625
172900         WMS-PRIME-CHNG-RTE EQUAL '1'
172910         IF  PRIME-CHG-FLG EQUAL 'Y'                              1003625
172920             IF  (WS-RWF-PRM-CHG (PRIME-SUB) EQUAL '1')           1003625
172930             OR  ((WS-RWF-PRM-CHG (PRIME-SUB) EQUAL '2')          1003625
172940             AND (ACCR-NO-HOLD GREATER THAN RHW-DAYS2))           1003625
172950                 MOVE 001 TO X                                    1003625
172960                             RHW-LOAN-IND                         1003625
172970                 MOVE 'P' TO RHW-TYPE                             1003625
172975                 GO TO C2369-A-EXIT.                              1003625
173050     IF  WMS-INT-RATE-PTR LESS THAN +1
173100         IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0
173110             IF  SPLIT-CHG-FLG EQUAL 'Y'                          1003625
173120                 IF  (WS-RWF-SPL-CHG (SPLIT-SUB) EQUAL '1')       1003625
173130                 OR  ((WS-RWF-SPL-CHG (SPLIT-SUB) EQUAL '2')      1003625
173140                 AND (ACCR-NO-HOLD GREATER THAN RHW-DAYS2))       1003625
173150                 MOVE WMS-SPLIT-RATE-SCHD TO RHW-SPLIT-RATE-IND   1003625
173152                                             X                    1003625
173170                 MOVE 'S' TO RHW-TYPE                             1003625
173200                 GO TO C2369-A-EXIT.                              1003625
173350     IF  WMS-INT-RATE-PTR LESS THAN +6
173360         IF  LOAN-CHG-FLG EQUAL 'Y'                               1003625
173370             IF  (WS-RWF-LN-CHG (LOAN-SUB) EQUAL '1')             1003625
173380             OR  ((WS-RWF-LN-CHG (LOAN-SUB) EQUAL '2')            1003625
173390             AND (ACCR-NO-HOLD GREATER THAN RHW-DAYS2))           1003625
173400             MOVE WMS-INT-RATE-PTR TO RHW-LOAN-IND                1003625
173410                                      X                           1003625
173420             MOVE 'L' TO RHW-TYPE.                                1003625
173450 C2369-A-EXIT. EXIT.
173500 C2370.
173505     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915749
173510         GO TO C2410.                                             9915749
173550     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO C2410.
173560     IF WMS-LOAN-STATUS EQUAL '9'                                 IM003
173570         GO TO C2410.                                             IM003
173600     IF WMS-DATE-LAST-RATE-CHANGE EQUAL SPACES
173650         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.      0266741
173654     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      IM008
173658         MOVE WMS-SPLIT-RATE-SCHD TO X                            IM008
173660         IF  SPLIT-CHG-FLG EQUAL 'Y'                              1003625
173666           IF  WS-RWF-SPL-CHG (SPLIT-SUB) NOT EQUAL '0'           1003625
173670             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.  0266741
173674     IF  WMS-PREV-SPLIT-RATE-PTR GREATER THAN +0                  IM008
173678         MOVE WMS-PREV-SPLIT-RATE-PTR TO X                        IM008
173682         IF  PREV-SPLIT-CHG-FLG EQUAL 'Y'                         1003625
173684           IF  WS-RWF-SPL-CHG (PREV-SPLIT-SUB) NOT EQUAL '0'      2015873
173690             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.  0266741
173695     IF  PRIME-CHG-FLG EQUAL 'Y'                                  1003625
173696     AND WMS-INT-RATE-PTR GREATER THAN +5                         9715570
173700       IF  WS-RWF-PRM-CHG (PRIME-SUB) GREATER THAN '0'            1003625
173702         MOVE '1'                TO CALC-ONLY-FLAG                1003343
173704         MOVE WMS-PRIME-RATE     TO SAVE-WMS-PRIME-RATE           1003343
173706         MOVE WMS-PRM-CUR-ANN    TO WMS-PRIME-RATE                1003625
173708         PERFORM PRIME-RATE-CALC THRU PRIME-CALC-ONLY-EXIT        1003343
173710         MOVE SAVE-WMS-PRIME-RATE                                 1003343
173712                                 TO WMS-PRIME-RATE                1003343
173714         MOVE '0'                TO CALC-ONLY-FLAG                1003343
173716         IF  (WMS-PRIME-CHNG-RTE EQUAL '1'                        1003343
173718         AND HOLD-ANN-RTE        NOT EQUAL WMS-ANNUAL-RATE)       9915845
173720         OR  (WMS-PRIME-CHNG-RTE EQUAL '3'                        1003343
173722         AND HOLD-ANN-RTE        LESS THAN WMS-ANNUAL-RATE)       9915845
173850             PERFORM PRIME-RATE-CHANGE THRU PRIME-CHANGE-EXIT     9915845
173900             MOVE WMS-PRM-CUR-DATE TO C-HIGH-DATE                 9915845
173910             PERFORM X0130-8-TO-6-HI                              9915845
173950             MOVE SAVE-DATE TO DT-LOW-DATE                        9915845
174000             CALL 'SIDIF1' USING DATE-AREA                        9915845
174050             IF  RET-DAYS GREATER THAN ZERO                       9915845
174100                 MOVE DT-HIGH-DATE TO WMS-DATE-LAST-RATE-CHANGE.  9915845
174150     IF WBC-LOAN-DAILY-ACCRUAL NOT EQUAL TO '0', GO TO C2410.     0266741
174170     ADD +1 TO LOAN-ACCRUAL-DAY.                                  IM008
174200     SKIP3
174250 LOAN-SECTION-F      SECTION 25.
174300     SKIP3
174350 C2371.
174400     IF WMS-LOAN-STATUS GREATER THAN '2'
174450         AND NOT EQUAL '5'
174500             GO TO C2400.
174510     IF  SKIP-LOAN-ACCR-SW EQUAL '1'                              IM006
174515         ADD +1 TO ACCR-DAYS-SKIPPED                              IM006
174520         IF  PYMT-CYCLE-DAY EQUAL LOAN-ACCRUAL-DAY                IM006
174530             MOVE '2' TO SKIP-LOAN-ACCR-SW                        IM006
174540             GO TO C2400                                          IM006
174542         ELSE                                                     IM006
174544             GO TO C2400.                                         IM006
174550     ADD +1 TO WMS-LOAN-AGGR-DAYS, WMS-LOAN-MTD-AGGR-DAYS,        IM006
174560                                   WMS-LOAN-YTD-AGGR-DAYS.        IM006
174600 C2372.
174650     MOVE WMS-PRIN-BAL TO HOLD-AMT9.
174700     SUBTRACT WMS-PREV-BAL FROM HOLD-AMT9.
174750     IF  WMS-LOAN-CALC-CODE EQUAL '4'
174800         MOVE '0' TO WMS-LOAN-CALC-CODE
174850         GO  TO  C2376.
174900     IF WBC-LOAN-ACCR-RECALC EQUAL TO '1'                         0266741
174950         MOVE '1' TO WMS-LOAN-CALC-CODE
175000         GO TO C2373.
175050     IF WMS-LOAN-CALC-CODE EQUAL TO '0', GO TO C2376.
175100     IF  RATE-CALC EQUAL '0', GO TO C2373.
175150     IF  WMS-PRIME-RATE EQUAL ZEROES
175200         MOVE WMS-PRM-CUR-ANN TO WMS-PRIME-RATE.                  1003625
175250     MOVE ZERO TO PRIME-CALC-FLAG.
175300     PERFORM C2270 THRU C2270-EXIT.
175350     PERFORM PRIME-RATE-CALC THRU PRIME-EXIT.
175400     MOVE '0' TO RATE-CALC.
175450 C2373.
175500     MOVE ZERO TO WMS-LOAN-ACCR-AMT.
175550     IF HOLD-AMT9 NOT GREATER THAN ZERO, GO TO C2384.
175600     IF PRIME-CALC-FLAG EQUAL '2' OR '3'
175650         IF LOAN-ACCR-RECALC EQUAL TO '1'
175700             GO TO C2390
175750         ELSE
175800             ADD HOLD-AMT9 TO WMS-CURR-AGGR1 WMS-MTD-AGGR1
175810             COMPUTE WMS-LOAN-YTD-AGGR ROUNDED = WMS-LOAN-YTD-AGGRIM006
175820                                               + HOLD-AMT9        IM006
175850             GO TO C2390.
175900     IF WMS-INT-RATE-PTR EQUAL +6
175950         MOVE WMS-DAILY-RATE TO HOLD-RATE
176000         GO TO C2377.
176050     IF  WMS-INT-RATE-PTR EQUAL +0                                IM006
176059         GO TO C2375.                                             IM006
176068     MOVE WMS-LN-CUR-DAF TO HOLD-RATE.                            1003625
176077     IF  HOLD-RATE EQUAL WMS-DAILY-RATE                           IM006
176086         GO TO C2377.                                             IM006
176095     IF  WMS-MAX-LOAN-INT EQUAL +0                                IM006
176104         GO TO C2374.                                             IM006
176113     IF  WMS-LN-CUR-ANN NOT GREATER THAN                          1003625
176122         WMS-MAX-LOAN-INT                                         IM006
176131         GO TO C2374.                                             IM006
176135     MOVE '1' TO MAX-EXC.                                         IM006
176139     MOVE WMS-ANNUAL-RATE TO HOLD-ANN-RTE.                        IM006
176143     PERFORM MAX-RATE-CALC THRU MAX-EXIT.                         IM006
176147     IF  HOLD-DAILY-MAX NOT EQUAL WMS-DAILY-RATE                  IM006
176155         MOVE HOLD-DAILY-MAX TO WMS-DAILY-RATE                    IM006
176159         MOVE WMS-MAX-LOAN-INT TO WMS-ANNUAL-RATE                 IM006
176163         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.      0266741
176165     MOVE '0' TO MAX-EXC.                                         IM006
176167     GO TO C2377.                                                 IM006
176176 MAX-RATE-HIST.                                                   IM006
176179     IF  WBC-CAPTURE-YR EQUAL HOLD-YEAR                           0266741
176180     OR (WMS-LOAN-360-DAY-FACTOR EQUAL '1' OR '2')                0817657
176181         GO TO MAX-RATE-CALC.                                     IM008
176182     MOVE ZERO TO HOLD-REMAINDER.                                 IM008
176183     DIVIDE +4 INTO HOLD-YEAR9 GIVING HOLD-DIVIDEND               IM008
176184                           REMAINDER HOLD-REMAINDER.              IM008
176185     IF  HOLD-REMAINDER EQUAL ZERO                                IM008
176186         MOVE +366 TO HOLD-NO3                                    IM008
176187     ELSE                                                         IM008
176188         MOVE +365 TO HOLD-NO3.                                   IM008
176189     GO TO MAX-RATE-COMPARE.                                      IM008
176190 MAX-RATE-CALC.                                                   IM008
176191     IF  WMS-MAX-LOAN-INT EQUAL +0                                IM008
176194         GO TO MAX-EXIT.                                          IM006
176203     IF  WBC-LEAP-YEAR EQUAL '1'                                  0266741
176212         MOVE +366 TO HOLD-NO3                                    IM006
176221     ELSE                                                         IM006
176230         MOVE +365 TO HOLD-NO3.                                   IM006
176239     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '1'                        0817657
176240         MOVE +360 TO HOLD-NO3.                                   0627547
176242     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '2'                        0817657
176244         MOVE +365 TO HOLD-NO3.                                   0627547
176249 MAX-RATE-COMPARE.                                                IM006
176257     DIVIDE WMS-MAX-LOAN-INT BY HOLD-NO3 GIVING HOLD-DAILY-MAX.   IM006
176266     IF  HOLD-DAILY-MAX NOT LESS THAN HOLD-RATE                   IM006
176275         MOVE '0' TO MAX-EXC                                      IM006
176284         GO TO MAX-EXIT.                                          IM006
176293     IF  MAX-EXC EQUAL '1'                                        IM006
176302         MOVE HOLD-ANN-RTE TO EX03-OLD-PRIME                      IM006
176311         MOVE '03' TO IMEX-REC-NO                                 IM006
176320         MOVE 'K2' TO IMEX-CODE-1                                 IM006
176329         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM006
176339     MOVE HOLD-DAILY-MAX TO HOLD-RATE.                            IM006
176349     MOVE WMS-MAX-LOAN-INT TO HOLD-ANN-RTE.                       IM006
176374 MAX-EXIT.                                                        IM006
176383     EXIT.                                                        IM006
176392 C2374.                                                           IM006
176401     MOVE WMS-LN-CUR-DAF TO HOLD-RATE.                            1003625
176410     IF  HOLD-RATE NOT EQUAL WMS-DAILY-RATE                       IM006
176419         MOVE HOLD-RATE TO WMS-DAILY-RATE                         IM006
176428         MOVE WMS-LN-CUR-ANN TO WMS-ANNUAL-RATE                   1003625
176437         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE       0266741
176446         GO TO C2377.                                             IM006
176455 C2375.                                                           IM006
176464     IF  WMS-SPLIT-RATE-SCHD NOT EQUAL ZERO                       IM006
176470         PERFORM SPLIT-RATE-MOVE THRU SPLIT-RATE-MOVE-EXIT        1003625
176570         PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT               IM006
176600         MOVE '1' TO SR-HOLD-FLAG
176650         GO TO SPLIT-RATE-CALC.
176700     IF  WMS-SPLIT-RATE-IND EQUAL '1'                             IM006
176750         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO SPLIT-RATE-HOLD
176800         IF  WMS-MAX-LOAN-INT GREATER THAN +0                     IM006
176809             MOVE '1' TO MAX-EXC                                  IM006
176818             PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT           IM006
176827             MOVE '0' TO MAX-EXC                                  IM006
176836             MOVE SPLIT-RATE-HOLD TO WMS-LOAN-SPLIT-RATE-SCHEDULE IM006
176845             MOVE '1' TO SR-HOLD-FLAG                             IM006
176854             GO TO SPLIT-RATE-CALC                                IM006
176863         ELSE                                                     IM006
176872             MOVE '1' TO SR-HOLD-FLAG                             IM006
176881             GO TO SPLIT-RATE-CALC.                               IM006
176900     MOVE WMS-DAILY-RATE TO HOLD-RATE.
176950     GO TO C2377.
177000 PRIME-RATE-CHANGE.
177050     MOVE WMS-ANNUAL-RATE TO EX03-OLD-PRIME.
177060     IF  EX03-OLD-PRIME NOT NUMERIC                               IM002
177070         MOVE +.00000 TO EX03-OLD-PRIME.                          IM002
177100     IF  WMS-PRIME-CHNG-RTE EQUAL '1'                             1003625
177150         MOVE WMS-PRM-CUR-ANN TO WMS-PRIME-RATE                   1003625
177200         PERFORM PRIME-RATE-CALC THRU PRIME-EXIT.
177250     IF  WMS-PRIME-CHNG-RTE EQUAL '2'                             1003625
177300         GO TO PRIME-CHANGE-EXIT.
177350     IF  WMS-PRIME-CHNG-RTE EQUAL '3'                             1003625
177400         IF  WMS-PRM-CUR-ANN LESS THAN WMS-PRIME-RATE             1003625
177420             MOVE WMS-PRM-CUR-ANN TO WMS-PRIME-RATE               1003625
177500             PERFORM PRIME-RATE-CALC THRU PRIME-EXIT
177550         ELSE
177600             GO TO PRIME-CHANGE-EXIT.
177650     MOVE WMS-PRM-CUR-DATE TO C-HIGH-DATE.                        1003625
177660     PERFORM X0130-8-TO-6-HI.                                     IM008
179450 PRIME-EX.
179500     MOVE '03' TO IMEX-REC-NO.
179550     MOVE 'K1' TO IMEX-CODE-1.
179600     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
179650 PRIME-CHANGE-EXIT.
179700     EXIT.
179750 PRIME-RATE-CALC.
179760     IF  PRIME-CALC-FLAG EQUAL '2'                                1003712
179770         MOVE WMS-HIGH-BAL-THIS-CYCLE TO HOLD-AMT9                1003712
179780     ELSE                                                         1003712
179790         MOVE WMS-LN-STMT-AVG-BAL TO HOLD-AMT9.                   1003712
179800     IF  WMS-INT-RATE-PTR EQUAL +6                                IM006
179850         MOVE WMS-PRIME-ADJ TO HOLD-ADJ
179900         MOVE WS-RMA-MAX-LOAN-INT TO HOLD-MAX                     1003625
179950         IF  HOLD-MAX GREATER THAN WMS-MAX-LOAN-INT               IM006
179956         AND WMS-MAX-LOAN-INT GREATER THAN +0                     IM006
179962             MOVE WMS-MAX-LOAN-INT TO HOLD-MAX                    IM006
179968             MOVE '1' TO MAX-EXC                                  IM006
179974             GO TO PRIME-LIMITS                                   IM006
179980         ELSE                                                     IM006
179986             GO TO PRIME-LIMITS.                                  IM006
180000     MOVE +0 TO X.
180250 PRIME-RANGE.
180300     ADD +1 TO X.
180350     IF  X GREATER THAN +4                                        IM006
180360         GO TO PRIME-RANGE5.                                      IM006
180370     IF  HOLD-AMT9 NOT LESS THAN WMS-PRM-CUR-LMT (X)              1003625
180380         GO TO PRIME-RANGE.                                       IM006
180390     MOVE WMS-PRM-CUR-ADJ (X) TO HOLD-ADJ.                        1003625
180396     MOVE WS-RMA-PRIME-MAX-INT (X) TO HOLD-MAX.                   1003625
180410     IF  HOLD-MAX GREATER THAN WS-RMA-MAX-LOAN-INT                1003625
180420         MOVE WS-RMA-MAX-LOAN-INT TO HOLD-MAX.                    1003625
180470     IF  WMS-MAX-LOAN-INT GREATER THAN +0                         IM006
180520     AND HOLD-MAX GREATER THAN WMS-MAX-LOAN-INT                   IM006
180570         MOVE WMS-MAX-LOAN-INT TO HOLD-MAX                        IM006
180620         MOVE '1' TO MAX-EXC.                                     IM006
180670     GO TO PRIME-LIMITS.                                          IM006
180850 PRIME-RANGE5.
180900     MOVE WMS-PRM-CUR-ADJ (5) TO HOLD-ADJ.                        1003625
180950     MOVE WS-RMA-PRIME-MAX-INT (5) TO HOLD-MAX.                   1003625
181000     IF  HOLD-MAX GREATER THAN WS-RMA-MAX-LOAN-INT                1003625
181050         MOVE WS-RMA-MAX-LOAN-INT TO HOLD-MAX.                    1003625
181058     IF  WMS-MAX-LOAN-INT GREATER THAN +0                         IM006
181066     AND HOLD-MAX GREATER THAN WMS-MAX-LOAN-INT                   IM006
181074         MOVE WMS-MAX-LOAN-INT TO HOLD-MAX                        IM006
181082         MOVE '1' TO MAX-EXC.                                     IM006
181100 PRIME-LIMITS.
181110     MOVE +0 TO HOLD-ANN-RTE.                                     0266923
181150     IF WMS-INT-RATE-PTR EQUAL +6
181200         MOVE WMS-PRIME-ADJ-CODE TO HOLD-ADJ-CODE
181250     ELSE
181300         MOVE WMS-PRM-CUR-ADC TO HOLD-ADJ-CODE.                   1003625
181350     IF HOLD-ADJ-CODE EQUAL '1'
181400         ADD HOLD-ADJ WMS-PRIME-RATE GIVING HOLD-ANN-RTE.
181450     IF HOLD-ADJ-CODE EQUAL '2'
181500         SUBTRACT HOLD-ADJ FROM WMS-PRIME-RATE
181550             GIVING HOLD-ANN-RTE.
181600     IF HOLD-ADJ-CODE EQUAL '3'
181650         MULTIPLY HOLD-ADJ BY WMS-PRIME-RATE GIVING HOLD-ANN-RTE.
181700     IF  HOLD-ANN-RTE GREATER THAN HOLD-MAX                       IM006
181710         MOVE HOLD-MAX TO HOLD-ANN-RTE                            IM006
181720         IF  MAX-EXC EQUAL '1'                                    IM006
181725         AND CALC-ONLY-FLAG EQUAL '0'                             1003343
181730             MOVE WMS-ANNUAL-RATE TO EX03-OLD-PRIME               IM006
181740             MOVE '03' TO IMEX-REC-NO                             IM006
181750             MOVE 'K2' TO IMEX-CODE-1                             IM006
181760             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              IM006
181770             MOVE WMS-ANNUAL-RATE TO EX03-OLD-PRIME.              IM006
181780     MOVE '0' TO MAX-EXC.                                         IM006
181790 PRIME-CALC-ONLY-EXIT.                                            1003343
181795                 EXIT.                                            1003343
181797 PRIME-UPDATE-MASTER.                                             1003343
181800     MOVE HOLD-ANN-RTE TO WMS-ANNUAL-RATE.
181850     MOVE WMS-DATE-LAST-RATE-CHANGE TO SAVE-DATE.
181900     PERFORM C2302 THRU C2304-EXIT.                               IM008
181950     MOVE WMS-DAILY-RATE TO HOLD-RATE.
182000 PRIME-EXIT.
182050     EXIT.
182051 SPLIT-MAX-HIST.                                                  IM006
182054     IF  WBC-CAPTURE-YR EQUAL HOLD-YEAR                           0266741
182055     OR (WMS-LOAN-360-DAY-FACTOR EQUAL '1' OR '2')                0817657
182056         GO TO SPLIT-MAX-CALC.                                    IM008
182057     MOVE ZERO TO HOLD-REMAINDER.                                 IM008
182058     DIVIDE +4 INTO HOLD-YEAR9 GIVING HOLD-DIVIDEND               IM008
182059                           REMAINDER HOLD-REMAINDER.              IM008
182060     IF  HOLD-REMAINDER EQUAL ZERO                                IM008
182061         MOVE +366 TO HOLD-NO3                                    IM008
182062     ELSE                                                         IM008
182063         MOVE +365 TO HOLD-NO3.                                   IM008
182064     GO TO SPLIT-MAX-COMPARE.                                     IM008
182065 SPLIT-MAX-CALC.                                                  IM008
182066     IF  WMS-MAX-LOAN-INT EQUAL +0                                IM008
182067         GO TO SPLIT-MAX-EXIT.                                    IM008
182068     IF  WBC-LEAP-YEAR EQUAL '1'                                  0266741
182069         MOVE +366 TO HOLD-NO3                                    IM008
182070     ELSE                                                         IM008
182071         MOVE +365 TO HOLD-NO3.                                   IM008
182072     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '1'                        0817657
182073         MOVE +360 TO HOLD-NO3.                                   IM008
182074     IF  WMS-LOAN-360-DAY-FACTOR EQUAL '2'                        0817657
182075         MOVE +365 TO HOLD-NO3.                                   0627547
182076 SPLIT-MAX-COMPARE.                                               0627547
182077     IF  WMS-MAX-LOAN-INT EQUAL +0                                0627547
182078         GO TO SPLIT-MAX-EXIT.                                    0627547
182080     DIVIDE WMS-MAX-LOAN-INT BY HOLD-NO3 GIVING HOLD-DAILY-MAX.   IM006
182081     IF  HOLD-DAILY-MAX LESS THAN SR-DAILY-RATE1                  IM006
182082         MOVE SR-ANNL-RATE1 TO HOLD-ANN-RTE                       IM006
182083         MOVE WMS-MAX-LOAN-INT TO SR-ANNL-RATE1                   IM006
182084         MOVE HOLD-DAILY-MAX TO SR-DAILY-RATE1                    IM006
182085         IF  MAX-EXC EQUAL '1'                                    IM006
182086             PERFORM SPLIT-MAX-EXC THRU SPLIT-EXC-EXIT.           IM006
182087     IF  HOLD-DAILY-MAX LESS THAN SR-DAILY-RATE2                  IM006
182088         MOVE SR-ANNL-RATE2 TO HOLD-ANN-RTE                       IM006
182089         MOVE WMS-MAX-LOAN-INT TO SR-ANNL-RATE2                   IM006
182090         MOVE HOLD-DAILY-MAX TO SR-DAILY-RATE2                    IM006
182091         IF  MAX-EXC EQUAL '1'                                    IM006
182092             PERFORM SPLIT-MAX-EXC THRU SPLIT-EXC-EXIT.           IM006
182093     IF  HOLD-DAILY-MAX LESS THAN SR-DAILY-RATE3                  IM006
182094         MOVE SR-ANNL-RATE3 TO HOLD-ANN-RTE                       IM006
182095         MOVE WMS-MAX-LOAN-INT TO SR-ANNL-RATE3                   IM006
182096         MOVE HOLD-DAILY-MAX TO SR-DAILY-RATE3                    IM006
182097         IF  MAX-EXC EQUAL '1'                                    IM006
182098             PERFORM SPLIT-MAX-EXC THRU SPLIT-EXC-EXIT.           IM006
182106 SPLIT-MAX-EXIT.                                                  IM006
182107     EXIT.                                                        IM006
182108 SPLIT-MAX-EXC.                                                   IM006
182109     MOVE HOLD-ANN-RTE TO EX03-OLD-PRIME.                         IM006
182110     MOVE '03' TO IMEX-REC-NO.                                    IM006
182111     MOVE 'K2' TO IMEX-CODE-1.                                    IM006
182112     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     IM006
182113     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.          0266741
182114 SPLIT-EXC-EXIT.                                                  IM006
182115     EXIT.                                                        IM006
182116 SPLIT-RATE-CALC.                                                 IM006
182150     IF HOLD-AMT9 GREATER THAN SR-LIMIT1
182200         MOVE SR-LIMIT1 TO ACCR-BAL
182250         MULTIPLY ACCR-BAL BY SR-DAILY-RATE1 GIVING ACCR-AMT1
182300         ADD ACCR-AMT1 TO WMS-LOAN-ACCR-AMT
182350     ELSE
182400         MOVE HOLD-AMT9 TO ACCR-BAL
182450         MULTIPLY ACCR-BAL BY SR-DAILY-RATE1 GIVING ACCR-AMT1
182500         GO TO SPLIT-CALC-2.
182550     IF HOLD-AMT9 GREATER THAN SR-LIMIT2
182600         SUBTRACT SR-LIMIT1 FROM SR-LIMIT2 GIVING ACCR-BAL
182650         MULTIPLY ACCR-BAL BY SR-DAILY-RATE2 GIVING ACCR-AMT1
182700         ADD ACCR-AMT1 TO WMS-LOAN-ACCR-AMT
182750     ELSE
182800         SUBTRACT SR-LIMIT1 FROM HOLD-AMT9 GIVING ACCR-BAL
182850         MULTIPLY ACCR-BAL BY SR-DAILY-RATE2 GIVING ACCR-AMT1
182900         GO TO SPLIT-CALC-2.
182950     SUBTRACT SR-LIMIT2 FROM HOLD-AMT9 GIVING ACCR-BAL.
183000     MULTIPLY ACCR-BAL BY SR-DAILY-RATE3 GIVING ACCR-AMT1.
183050 SPLIT-CALC-2.
183100     ADD ACCR-AMT1 TO WMS-LOAN-ACCR-AMT.
183150 SPLIT-CALC-END.  EXIT.
183200 C2376.
183250     IF LOAN-ACCR-RECALC EQUAL TO '1', GO TO C2384.
183300     IF  SR-HOLD-FLAG NOT EQUAL TO '1', GO TO C2377.
183310     COMPUTE WMS-LOAN-YTD-AGGR ROUNDED = WMS-LOAN-YTD-AGGR        IM006
183320                                       + HOLD-AMT9.               IM006
183350     IF HOLD-AMT9 LESS THAN SR-LIMIT1
183400         ADD HOLD-AMT9 TO WMS-CURR-AGGR1, WMS-MTD-AGGR1
183450         GO TO C2384
183500     ELSE
183550         ADD SR-LIMIT1 TO WMS-CURR-AGGR1, WMS-MTD-AGGR1.
183600     IF HOLD-AMT9 LESS THAN SR-LIMIT2
183650         ADD HOLD-AMT9 TO WMS-CURR-AGGR2, WMS-MTD-AGGR2
183700         SUBTRACT SR-LIMIT1 FROM WMS-CURR-AGGR2, WMS-MTD-AGGR2
183750         GO TO C2384
183800     ELSE
183850         ADD SR-LIMIT2 TO WMS-CURR-AGGR2, WMS-MTD-AGGR2
183900         SUBTRACT SR-LIMIT1 FROM WMS-CURR-AGGR2, WMS-MTD-AGGR2.
183950     ADD HOLD-AMT9 TO WMS-CURR-AGGR3, WMS-MTD-AGGR3.
184000     SUBTRACT SR-LIMIT2 FROM WMS-CURR-AGGR3, WMS-MTD-AGGR3.
184050     GO TO C2384.
184100 C2377.
184150     IF LOAN-ACCR-RECALC EQUAL TO '1', GO TO C2378.
184200     ADD HOLD-AMT9 TO WMS-CURR-AGGR1, WMS-MTD-AGGR1.
184210     COMPUTE WMS-LOAN-YTD-AGGR ROUNDED = WMS-LOAN-YTD-AGGR        IM006
184220                                       + HOLD-AMT9.               IM006
184250     IF  WMS-LOAN-CALC-CODE EQUAL TO '0', GO TO C2384.
184300 C2378.
184350     MOVE HOLD-AMT9 TO ACCR-BAL.
184400     MULTIPLY ACCR-BAL BY HOLD-RATE GIVING ACCR-AMT1.
184450     ADD ACCR-AMT1 TO WMS-LOAN-ACCR-AMT.
184500 C2379.  EXIT.
184550 C2384.
184600     IF WMS-PREV-BAL NOT GREATER THAN ZERO, GO TO C2390.
184650     MOVE WMS-PREV-BAL TO HOLD-AMT9.
184700     IF WMS-LOAN-CALC-CODE EQUAL TO '0', GO TO C2386.
184750     IF  WMS-PREV-INT-PTR EQUAL ZERO                              IM006
184752     OR  (WMS-LN-RATE-FLAG EQUAL ZERO OR SPACE)                   0266274
184760         GO TO C2385.                                             IM006
184770     MOVE WMS-LN-OLD-CUR-ANN TO HOLD-ANN-RTE.                     1003625
184776     MOVE WMS-LN-OLD-CUR-DAF TO HOLD-RATE.                        1003625
184790     IF  HOLD-RATE EQUAL WMS-PREV-DAILY                           IM006
184800         GO TO C2388.                                             IM006
184810     IF  WMS-MAX-LOAN-INT EQUAL +0                                IM006
184820         GO TO C2384-A.                                           IM006
184830     IF  HOLD-RATE NOT GREATER THAN WMS-MAX-LOAN-INT              IM006
184840         GO TO C2384-A.                                           IM006
184850     MOVE WMS-PREV-DAILY TO HOLD-RATE.                            IM006
184860     MOVE WMS-PREV-ANNUAL TO HOLD-ANN-RTE.                        IM006
184870     MOVE '1' TO MAX-EXC.                                         IM006
184880     PERFORM MAX-RATE-CALC THRU MAX-EXIT.                         IM006
184890     IF  MAX-EXC EQUAL '0'                                        IM006
184900         GO TO C2388                                              IM006
184910     ELSE                                                         IM006
184920         MOVE '0' TO MAX-EXC.                                     IM006
184930 C2384-A.                                                         IM006
184940     MOVE HOLD-ANN-RTE TO WMS-PREV-ANNUAL.                        IM006
184950     MOVE HOLD-RATE TO WMS-PREV-DAILY.                            IM006
184960     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.          0266741
184970     GO TO C2388.                                                 IM006
184980 C2385.                                                           IM006
185150     IF WMS-PREV-SPLIT-RATE-PTR NOT EQUAL TO ZERO
185155         PERFORM OLD-SPLIT-RATE-MOVE                              1003625
185160            THRU OLD-SPLIT-RATE-MOVE-EXIT                         1003625
185300         MOVE '1' TO SR-HOLD-FLAG
185350         IF  WMS-MAX-LOAN-INT GREATER THAN +0                     IM006
185370             PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT           IM006
185390             PERFORM SPLIT-RATE-CALC THRU SPLIT-CALC-END          IM006
185400             GO TO C2386                                          IM006
185410         ELSE                                                     IM006
185420             PERFORM SPLIT-RATE-CALC THRU SPLIT-CALC-END          IM006
185430             GO TO C2386.                                         IM006
185450     IF  WMS-SPLIT-RATE-IND EQUAL '2'                             IM006
185500         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO SPLIT-RATE-HOLD
185550         MOVE '1' TO SR-HOLD-FLAG
185600         IF  WMS-MAX-LOAN-INT GREATER THAN +0                     IM006
185609             MOVE '1' TO MAX-EXC                                  IM006
185618             PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT           IM006
185627             MOVE '0' TO MAX-EXC                                  IM006
185636             MOVE SPLIT-RATE-HOLD TO WMS-LOAN-SPLIT-RATE-SCHEDULE IM006
185645             PERFORM SPLIT-RATE-CALC THRU SPLIT-CALC-END          IM006
185654             GO TO C2386                                          IM006
185663         ELSE                                                     IM006
185672             PERFORM SPLIT-RATE-CALC THRU SPLIT-CALC-END          IM006
185681             GO TO C2386.                                         IM006
185700     MOVE WMS-PREV-DAILY TO HOLD-RATE.
185750     GO TO C2388.
185800 C2386.
185850     IF LOAN-ACCR-RECALC EQUAL TO '1', GO TO C2400.
185900     IF  SR-HOLD-FLAG NOT EQUAL TO '1', GO TO C2389.
185910     COMPUTE WMS-LOAN-YTD-AGGR ROUNDED = WMS-LOAN-YTD-AGGR        IM006
185920                                       + HOLD-AMT9.               IM006
185950     IF HOLD-AMT9 LESS THAN SR-LIMIT1
186000         ADD HOLD-AMT9 TO WMS-PREV-AGGR1, WMS-MTD-AGGR1
186050         GO TO C2390
186100     ELSE
186150         ADD SR-LIMIT1 TO WMS-PREV-AGGR1, WMS-MTD-AGGR1.
186200     IF HOLD-AMT9 LESS THAN SR-LIMIT2
186250         ADD HOLD-AMT9 TO WMS-PREV-AGGR2, WMS-MTD-AGGR2
186300         SUBTRACT SR-LIMIT1 FROM WMS-PREV-AGGR2, WMS-MTD-AGGR2
186350         GO TO C2390
186400     ELSE
186450         ADD SR-LIMIT2 TO WMS-PREV-AGGR2, WMS-MTD-AGGR2
186500         SUBTRACT SR-LIMIT1 FROM WMS-PREV-AGGR2, WMS-MTD-AGGR2.
186550     ADD HOLD-AMT9 TO WMS-PREV-AGGR3, WMS-MTD-AGGR3.
186600     SUBTRACT SR-LIMIT2 FROM WMS-PREV-AGGR3, WMS-MTD-AGGR3.
186650     GO TO C2390.
186700 C2388.
186750     PERFORM C2378 THRU C2379.
186800     IF LOAN-ACCR-RECALC EQUAL TO '1', GO TO C2400.
186850 C2389.
186900     ADD HOLD-AMT9 TO WMS-PREV-AGGR1, WMS-MTD-AGGR1.
186910     COMPUTE WMS-LOAN-YTD-AGGR ROUNDED = WMS-LOAN-YTD-AGGR        IM006
186920                                       + HOLD-AMT9.               IM006
186950 C2390.
187000     IF LOAN-ACCR-RECALC EQUAL TO '1', GO TO C2400.
187050     ADD +.005, WMS-LOAN-ACCR-INT GIVING HOLD-ACCR2.
187100     ADD WMS-LOAN-ACCR-AMT TO WMS-LOAN-ACCR-INT.
187150     ADD WMS-LOAN-ACCR-INT, .005 GIVING HOLD-ACCR1.
187200     SUBTRACT HOLD-ACCR2 FROM HOLD-ACCR1.
187250     ADD HOLD-ACCR1 TO WMS-EARNED-INT
187260                       WMS-LOAN-YTD-ACC-INT                       1105132
187300                       WMS-LOAN-ACCR-TODAY
187350                       LOAN-INT-ACC                               0902970
187360                       WS-GL-LOAN-INT-ACC.                        0902970
187400     MOVE '0' TO WMS-LOAN-CALC-CODE.
187450 C2400.  EXIT.
187500     SKIP3
187550 ROOT-SECTION-U      SECTION 1.
187600     SKIP3
187650 C2410.
187660******************************************************************IM007
187670***  ROLL AVAILABILITY ON SATURDAY FOR CALENDAR DAYS OPTION AND***IM007
187680***  ACCOUNTS NOT SUBJECT TO REG CC (NON-EFAA-ACCOUNT = '1')   ***IM007
187690******************************************************************IM007
187695     MOVE WBC-WEEK-DAY TO HOLD-WEEK-DAY.                          0266741
187700     IF  WBC-WEEKDAY-BK (HOLD-WEEK-DAY) EQUAL '2'                 0266741
187750         IF  WBC-FLOAT-FLAG EQUAL TO 'C'                          0266741
187755         AND NON-EFAA-ACCOUNT EQUAL '1'                           IM007
187760             GO TO C2430                                          IM007
187765         ELSE                                                     IM007
187770             GO TO C2450.                                         IM007
187775******************************************************************IM007
187780***  ROLL AVAILABILITY FOR EXPEDITED FUNDS PROCESSING ONLY     ***IM007
187785***  WHEN A FEDERAL RESERVE BUSINESS DAY HAS OCCURRED.         ***IM007
187786*--- BYPASS FLOAT AGING IF ACCRUAL-DAYS = 0. --------------------*9915749
187790******************************************************************IM007
187791     IF  WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
187792         GO TO C2450.                                             9915749
187795     IF  NON-EFAA-ACCOUNT EQUAL '0'                               IM007
187808         IF  WBC-BUSINESS-DAYS EQUAL WBC-PREV-BUS-DAYS            0266741
187815         OR  WBC-BUSINESS-DAYS EQUAL +0                           0266741
187822             GO TO C2450.                                         IM007
187850 C2430.
187900     IF WMS-BANK-AVAIL-TRLR EQUAL TO '0', GO TO C2440.            IM007
187930     IF  WMS-BANK-AVAIL-AMT EQUAL ZEROES, GO TO C2440.            IM007
187960     ADD WMS-BANK-AVAIL-TR-AMT (1) TO DDA-BANK-AVAIL-BUMP         0902970
187961                                      WS-GL-DDA-BANK-AVAIL-BUMP.  0902970
187990     MOVE WMS-BANK-AVAIL-2-7 TO WMS-BANK-AVAIL-TRAILER.           IM007
188020     MOVE ZERO TO WMS-BANK-AVAIL-TR-AMT (7).                      IM007
188150 C2435.
188200     ADD WMS-BANK-AVAIL-TR-AMT (1)                                IM007
188230         WMS-BANK-AVAIL-TR-AMT (2)                                IM007
188260         WMS-BANK-AVAIL-TR-AMT (3)                                IM007
188290         WMS-BANK-AVAIL-TR-AMT (4)                                IM007
188320         WMS-BANK-AVAIL-TR-AMT (5)                                IM007
188350         WMS-BANK-AVAIL-TR-AMT (6) GIVING WMS-BANK-AVAIL-AMT.     IM007
188500     MOVE '1' TO BANK-AVAIL-CHANGE.                               IM007
188550 C2435-EXIT. EXIT.
188600 C2440.
188650     IF WMS-CUST-AVAIL-TRLR EQUAL TO '0', GO TO C2445-EXIT.       IM007
188680     IF  WMS-CUST-AVAIL-AMT EQUAL ZEROES, GO TO C2445-EXIT.       IM007
188710     ADD WMS-CUST-AVAIL-FUNDS (1) TO DDA-CUST-AVAIL-BUMP          0902970
188711                                     WS-GL-DDA-CUST-AVAIL-BUMP.   0902970
188715     IF  WMS-EXTEND-FLOAT     EQUAL '1'                           0927817
188720     OR  AFF-FLAG             EQUAL 'N'                           0927817
188725         PERFORM C2442 THRU C2442-EXIT                            0927817
188730     ELSE                                                         0927817
188740         MOVE WMS-CUST-AVAIL-2-12 TO WMS-CUST-AVAIL-TRAILER       0927817
188750         MOVE ZERO               TO WMS-CUST-AVAIL-FUNDS (12).    0927817
188760     GO TO C2445.                                                 0927817
188765 C2442.                                                           0927817
188770     MOVE WFF-ENTRIES            TO AFF-MAX-ENTRY.                0927817
188775     SUBTRACT WFF-FLOAT-13     FROM WFF-TOTAL-13-99.              0927817
188780     MOVE WFF-FLOAT-02-99        TO WFF-FLOAT-AREA.               0927817
188785     MOVE +0                     TO WFF-FLOAT-AMT (AFF-MAX-ENTRY).0927817
188790     MOVE +0                     TO WFF-FLOAT-AMT (99).           0927817
188795     SUBTRACT +1               FROM AFF-MAX-ENTRY                 0927817
188800                                    WFF-ENTRIES.                  0927817
188805     MOVE WFF-FLOAT-01-12        TO WMS-CUST-AVAIL-TRAILER.       0927817
188810     ADD  WFF-TOTAL-13-99        TO WMS-CUST-AVAIL-FUNDS (12).    0927817
188815 C2442-EXIT.                                                      0927817
188816     EXIT.                                                        0927817
188820 C2445.                                                           IM007
188950     ADD  WMS-CUST-AVAIL-FUNDS (1)                                IM007
188980          WMS-CUST-AVAIL-FUNDS (2)                                IM007
189010          WMS-CUST-AVAIL-FUNDS (3)                                IM007
189040          WMS-CUST-AVAIL-FUNDS (4)                                IM007
189070          WMS-CUST-AVAIL-FUNDS (5)                                IM007
189100          WMS-CUST-AVAIL-FUNDS (6)                                IM007
189130          WMS-CUST-AVAIL-FUNDS (7)                                IM007
189160          WMS-CUST-AVAIL-FUNDS (8)                                IM007
189190          WMS-CUST-AVAIL-FUNDS (9)                                IM007
189196          WMS-CUST-AVAIL-FUNDS (10)                               IM007
189202          WMS-CUST-AVAIL-FUNDS (11) GIVING WMS-CUST-AVAIL-AMT.    IM007
189204     IF  WMS-EXTEND-FLOAT     EQUAL '1'                           0927817
189205     OR  AFF-FLAG             EQUAL 'N'                           0927817
189206         ADD  WMS-CUST-AVAIL-FUNDS (12) TO WMS-CUST-AVAIL-AMT.    0927817
189208     MOVE '1' TO CUST-AVAIL-CHANGE.                               IM007
189214 C2445-EXIT. EXIT.                                                IM007
189220 C2446.                                                           IM007
189226     IF  WMS-CASH-AVAIL-TRLR EQUAL TO '0', GO TO C2447-EXIT.      IM007
189232     IF  WMS-CASH-AVAIL-AMT EQUAL ZEROES, GO TO C2447-EXIT.       IM007
189238     ADD WMS-CASH1-AVAIL (1) TO DDA-CASH-AVAIL-BUMP               0902970
189239                                WS-GL-DDA-CASH-AVAIL-BUMP.        0902970
189244     ADD WMS-CASH2-AVAIL (1) TO DDA-CASH-AVAIL-BUMP               0902970
189245                                WS-GL-DDA-CASH-AVAIL-BUMP.        0902970
189250     MOVE WMS-CASH-2-12 TO WMS-CASH-AVAIL-TRAILER.                IM007
189256     MOVE ZERO TO WMS-CASH1-AVAIL (12).                           IM007
189260     MOVE ZERO TO WMS-CASH2-AVAIL (12).                           IM007
189268 C2447.                                                           IM007
189274     ADD  WMS-CASH1-AVAIL (1)                                     IM007
189280          WMS-CASH2-AVAIL (1)                                     IM007
189286          WMS-CASH1-AVAIL (2)                                     IM007
189292          WMS-CASH2-AVAIL (2)                                     IM007
189298          WMS-CASH1-AVAIL (3)                                     IM007
189304          WMS-CASH2-AVAIL (3)                                     IM007
189310          WMS-CASH1-AVAIL (4)                                     IM007
189316          WMS-CASH2-AVAIL (4)                                     IM007
189322          WMS-CASH1-AVAIL (5)                                     IM007
189328          WMS-CASH2-AVAIL (5)                                     IM007
189334          WMS-CASH1-AVAIL (6)                                     IM007
189340          WMS-CASH2-AVAIL (6)                                     IM007
189346          WMS-CASH1-AVAIL (7)                                     IM007
189352          WMS-CASH2-AVAIL (7)                                     IM007
189358          WMS-CASH1-AVAIL (8)                                     IM007
189364          WMS-CASH2-AVAIL (8)                                     IM007
189370          WMS-CASH1-AVAIL (9)                                     IM007
189376          WMS-CASH2-AVAIL (9)                                     IM007
189382          WMS-CASH1-AVAIL (10)                                    IM007
189388          WMS-CASH2-AVAIL (10)                                    IM007
189394          WMS-CASH1-AVAIL (11)                                    IM007
189400          WMS-CASH2-AVAIL (11) GIVING WMS-CASH-AVAIL-AMT.         IM007
189406 C2447-EXIT. EXIT.                                                IM007
189451 C2450.                                                           IM006
189452     IF WMS-KITING-SUSP-TRLR EQUAL '0', GO TO C2459-EXIT.         IM006
189453     IF WMS-KITE-TOT-CR-NO EQUAL ZERO, GO TO C2452.               IM006
189454     MOVE WMS-KITE-TODAY-CR-NO-2-7 TO WMS-KITE-TODAY-CREDIT-NO.   IM006
189455     MOVE ZERO TO WMS-KITE-TODAY-CR-NO (7).                       IM006
189456     ADD WMS-KITE-TODAY-CR-NO (1)                                 IM006
189457         WMS-KITE-TODAY-CR-NO (2)                                 IM006
189458         WMS-KITE-TODAY-CR-NO (3)                                 IM006
189459         WMS-KITE-TODAY-CR-NO (4)                                 IM006
189460         WMS-KITE-TODAY-CR-NO (5)                                 IM006
189461         WMS-KITE-TODAY-CR-NO (6) GIVING WMS-KITE-TOT-CR-NO.      IM006
189462 C2452.                                                           IM006
189463     IF WMS-KITE-TOT-CR-AMT EQUAL ZERO, GO TO C2454.              IM006
189464     MOVE WMS-KITE-TODAY-CR-AMT-2-7 TO WMS-KITE-TODAY-CREDIT-AMT. IM006
189465     MOVE ZERO TO WMS-KITE-TODAY-CR-AMT (7).                      IM006
189466     ADD WMS-KITE-TODAY-CR-AMT (1)                                IM006
189467         WMS-KITE-TODAY-CR-AMT (2)                                IM006
189468         WMS-KITE-TODAY-CR-AMT (3)                                IM006
189469         WMS-KITE-TODAY-CR-AMT (4)                                IM006
189470         WMS-KITE-TODAY-CR-AMT (5)                                IM006
189471         WMS-KITE-TODAY-CR-AMT (6) GIVING WMS-KITE-TOT-CR-AMT.    IM006
189472 C2454.                                                           IM006
189473     IF WMS-KITE-TOT-DR-NO EQUAL ZERO, GO TO C2456.               IM006
189474     MOVE WMS-KITE-TODAY-DR-NO-2-7 TO WMS-KITE-TODAY-DEBIT-NO.    IM006
189475     MOVE ZERO TO WMS-KITE-TODAY-DR-NO (7).                       IM006
189476     ADD WMS-KITE-TODAY-DR-NO (1)                                 IM006
189477         WMS-KITE-TODAY-DR-NO (2)                                 IM006
189478         WMS-KITE-TODAY-DR-NO (3)                                 IM006
189479         WMS-KITE-TODAY-DR-NO (4)                                 IM006
189480         WMS-KITE-TODAY-DR-NO (5)                                 IM006
189481         WMS-KITE-TODAY-DR-NO (6) GIVING WMS-KITE-TOT-DR-NO.      IM006
189482 C2456.                                                           IM006
189483     IF WMS-KITE-TOT-DR-AMT EQUAL ZERO, GO TO C2459-EXIT.         IM006
189484     MOVE WMS-KITE-TODAY-DR-AMT-2-7 TO WMS-KITE-TODAY-DEBIT-AMT.  IM006
189518     MOVE ZERO TO WMS-KITE-TODAY-DR-AMT (7).                      IM006
189521     ADD WMS-KITE-TODAY-DR-AMT (1)                                IM006
189524         WMS-KITE-TODAY-DR-AMT (2)                                IM006
189527         WMS-KITE-TODAY-DR-AMT (3)                                IM006
189530         WMS-KITE-TODAY-DR-AMT (4)                                IM006
189533         WMS-KITE-TODAY-DR-AMT (5)                                IM006
189536         WMS-KITE-TODAY-DR-AMT (6) GIVING WMS-KITE-TOT-DR-AMT.    IM006
189539 C2459-EXIT. EXIT.                                                IM006
189540*----------------------------------------------------------------*9915855
189541*     CHECK EXPIRATION AND EFFECTIVE DATES TO DETERMINE          *9915855
189542*     VALID OD LIMIT RECORDS.  UPDATE MASTER WITH OD LIMIT.      *9915855
189544*----------------------------------------------------------------*9915855
189546 C2460-OD-LIMIT-FILE-UPDATE.                                      9915855
189548     IF  WS-OD-LIMIT-MATCH-SW EQUAL '0'                           9915855
189550         GO  TO  C2490-EXIT.                                      9915855
189554     MOVE '0'                   TO WS-OD-LIMIT-OCC-DELETE         9915855
189556                                   WS-OD-EXPIRE-TOMORROW.         9915855
189558     MOVE +0                    TO WS-TOTAL-OD-AMT                9915855
189560                                   WS-TOTAL-OD-AMT-ONLINE.        9915855
189562     IF  OD-LIMIT-DELETE EQUAL 'Y'                                9915855
189564         GO TO C2470-CONT.                                        9915855
189566     IF  OD-LIMIT-REC-CHG-TODAY EQUAL '4'                         9915855
189568         MOVE '0'               TO WMS-OD-LIMIT                   9915855
189570         MOVE '1'               TO WMS-OD-LIMIT-FILE.             9915855
189572     MOVE 1 TO X.                                                 9915855
189574 C2462-PROCESS-CONT.                                              9915855
189576     IF  X GREATER THAN OD-LIMIT-OCCURRENCES                      9915855
189578         GO TO C2470.                                             9915855
189580     IF  OD-LIMIT-OCC-CHG-TODAY (X) NOT EQUAL '0'                 9915855
189582     OR  OD-LIMIT-OCC-DEL-TODAY (X) EQUAL 'Y'                     9915855
189584         PERFORM C2484-OD-OCC-EXC   THRU C2486-EXIT.              9915855
189586     IF  OD-LIMIT-OCC-DEL-TODAY (X) EQUAL 'Y'                     9915855
189588         GO TO C2468-PROCESS-END.                                 9915855
189590     IF (OD-LIMIT-STATUS (X)        EQUAL 'E'                     9915855
189592     AND OD-LIMIT-OCC-CHG-TODAY (X) EQUAL '0')                    9915855
189594         IF  OD-LIMIT-EXP-ACTION (X) EQUAL '1'                    9915855
189596             ADD OD-LIMIT-AMT (X)   TO WS-TOTAL-OD-AMT            9915855
189597                                       WS-TOTAL-OD-AMT-ONLINE     9915855
189598             GO TO C2468-PROCESS-END                              9915855
189600         ELSE                                                     9915855
189602             GO TO C2468-PROCESS-END.                             9915855
189604     IF  OD-LIMIT-EXP-DATE (X)      EQUAL '99999999'              9915855
189606         IF  OD-LIMIT-STATUS (X)    EQUAL 'E'                     9915855
189608             MOVE '0'               TO OD-LIMIT-STATUS (X)        9915855
189610             GO TO C2464-PROCESS-EFF                              9915855
189612         ELSE                                                     9915855
189614             GO TO C2464-PROCESS-EFF.                             9915855
189616     MOVE OD-LIMIT-EXP-DATE (X)     TO C-HIGH-DATE.               9915855
189618     MOVE WBC-CAPTURE-MO            TO C-LOW-MO.                  0266741
189620     MOVE WBC-CAPTURE-DA            TO C-LOW-DA.                  0266741
189622     MOVE WBC-CAPTURE-YR            TO C-LOW-YR.                  0266741
189624     IF  WBC-CAPTURE-YR LESS WBC-NEXT-CENT-YR                     0266741
189626         MOVE '20'                  TO C-LOW-CENT                 9915855
189628     ELSE                                                         9915855
189630         MOVE '19'                  TO C-LOW-CENT.                9915855
189632     CALL  'SIDIFC1'                USING  C-DATE-WORK.           9915855
189634     IF  C-NO-DAYS  GREATER THAN ZERO                             9915855
189636     AND OD-LIMIT-STATUS (X)        EQUAL 'E'                     9915855
189638         MOVE '0'                   TO OD-LIMIT-STATUS (X).       9915855
189640     IF  C-NO-DAYS  NOT GREATER THAN ZERO                         9915855
189642     AND OD-LIMIT-STATUS (X)        NOT EQUAL 'E'                 9915855
189644         MOVE 'E'                   TO OD-LIMIT-STATUS (X)        9915855
189646         MOVE '2'                   TO OD-LIMIT-OCC-CHG-TODAY (X) 9915855
189650         MOVE 'OT'                  TO IMEX-CODE-2                9915855
189652         PERFORM C2486-WRITE-OCC-EXC THRU C2486-EXIT.             9915855
189654     IF  OD-LIMIT-STATUS (X)        EQUAL 'E'                     9915855
189656         IF  OD-LIMIT-EXP-ACTION (X) EQUAL '0'                    9915855
189658             MOVE 'Y'               TO OD-LIMIT-OCC-DEL-TODAY (X) 9915855
189660             MOVE '1'               TO WS-OD-LIMIT-OCC-DELETE     9915855
189662             MOVE 'OX'              TO IMEX-CODE-2                9915855
189664             PERFORM C2486-WRITE-OCC-EXC THRU C2486-EXIT          9915855
189666             GO TO C2468-PROCESS-END                              9915855
189668         ELSE                                                     9915855
189670         IF  OD-LIMIT-EXP-ACTION (X) EQUAL '1'                    9915855
189672             ADD OD-LIMIT-AMT (X)    TO WS-TOTAL-OD-AMT           9915855
189673                                        WS-TOTAL-OD-AMT-ONLINE    9915855
189674             GO TO C2468-PROCESS-END                              9915855
189676         ELSE                                                     9915855
189678             GO TO C2468-PROCESS-END.                             9915855
189680     IF  OD-LIMIT-EXP-RPT-LEAD-DAYS GREATER THAN ZERO             9915855
189681     AND C-NO-DAYS NOT GREATER THAN OD-LIMIT-EXP-RPT-LEAD-DAYS    9915855
189682         MOVE 'OV' TO IMEX-CODE-2                                 9915855
189684         PERFORM C2486-WRITE-OCC-EXC THRU C2486-EXIT.             9915855
189686     MOVE WBC-NEXT-CAPTURE-MO       TO C-LOW-MO.                  0266741
189688     MOVE WBC-NEXT-CAPTURE-DA       TO C-LOW-DA.                  0266741
189690     MOVE WBC-NEXT-CAPTURE-YR       TO C-LOW-YR.                  0266741
189692     IF  WBC-NEXT-CAPTURE-YR LESS WBC-NEXT-CENT-YR                0266741
189694         MOVE '20'                  TO C-LOW-CENT                 9915855
189696     ELSE                                                         9915855
189698         MOVE '19'                  TO C-LOW-CENT.                9915855
189700     CALL  'SIDIFC1'                USING  C-DATE-WORK.           9915855
189702     IF  C-NO-DAYS  NOT GREATER THAN ZERO                         9915855
189703     AND C-LOW-DATE NOT EQUAL C-HIGH-DATE                         U22NOV
189704         MOVE '1'                   TO WS-OD-EXPIRE-TOMORROW      9915855
189706         IF  OD-LIMIT-EXP-ACTION (X) EQUAL '1'                    9915855
189708             ADD OD-LIMIT-AMT (X)   TO WS-TOTAL-OD-AMT-ONLINE.    9915855
189710 C2464-PROCESS-EFF.                                               9915855
189712     IF (OD-LIMIT-STATUS (X) EQUAL 'A'                            9915855
189714     AND OD-LIMIT-OCC-CHG-TODAY (X) EQUAL '0')                    9915855
189716         ADD OD-LIMIT-AMT (X) TO WS-TOTAL-OD-AMT                  9915855
189718         IF  WS-OD-EXPIRE-TOMORROW  EQUAL '0'                     9915855
189720             ADD OD-LIMIT-AMT (X)   TO WS-TOTAL-OD-AMT-ONLINE     9915855
189722             GO TO C2468-PROCESS-END                              9915855
189724         ELSE                                                     9915855
189726             GO TO C2468-PROCESS-END.                             9915855
189728     MOVE OD-LIMIT-EFF-DATE (X) TO C-LOW-DATE.                    9915855
189730     MOVE WBC-CAPTURE-MO        TO C-HIGH-MO.                     0266741
189732     MOVE WBC-CAPTURE-DA        TO C-HIGH-DA.                     0266741
189734     MOVE WBC-CAPTURE-YR        TO C-HIGH-YR.                     0266741
189736     IF  WBC-CAPTURE-YR LESS WBC-NEXT-CENT-YR                     0266741
189738         MOVE '20' TO C-HIGH-CENT                                 9915855
189740     ELSE                                                         9915855
189742         MOVE '19' TO C-HIGH-CENT.                                9915855
189744     MOVE '44'                  TO SICOMPDT-DATE-FORMATS.         9915855
189746     CALL  'SICOMPDT'  USING    C-LOW-DATE, C-HIGH-DATE           9915855
189748                                SICOMPDT-RETURN-FLAG              9915855
189750                                SICOMPDT-DATE-FORMATS.            9915855
189752     IF  SICOMPDT-RETURN-FLAG EQUAL 'H'                           9915855
189754*                                                                 9915855
189756*  EFFECTIVE DATE IS NOT YET IN EFFECT                            9915855
189758*                                                                 9915855
189760         MOVE '0' TO OD-LIMIT-STATUS (X)                          9915855
189762     ELSE                                                         9915855
189764         MOVE 'A' TO OD-LIMIT-STATUS (X)                          9915855
189766         MOVE '2' TO OD-LIMIT-OCC-CHG-TODAY (X)                   9915855
189770         MOVE 'OU' TO IMEX-CODE-2                                 9915855
189772         PERFORM C2486-WRITE-OCC-EXC THRU C2486-EXIT              9915855
189774         ADD OD-LIMIT-AMT (X) TO WS-TOTAL-OD-AMT                  9915855
189776         IF  WS-OD-EXPIRE-TOMORROW  EQUAL '0'                     9915855
189778             ADD OD-LIMIT-AMT (X)   TO WS-TOTAL-OD-AMT-ONLINE     9915855
189780             GO TO C2468-PROCESS-END                              9915855
189782         ELSE                                                     9915855
189784             GO TO C2468-PROCESS-END.                             9915855
189786     MOVE WBC-NEXT-CAPTURE-MO       TO C-HIGH-MO.                 0266741
189788     MOVE WBC-NEXT-CAPTURE-DA       TO C-HIGH-DA.                 0266741
189790     MOVE WBC-NEXT-CAPTURE-YR       TO C-HIGH-YR.                 0266741
189792     IF  WBC-NEXT-CAPTURE-YR LESS WBC-NEXT-CENT-YR                0266741
189794         MOVE '20'                  TO C-HIGH-CENT                9915855
189796     ELSE                                                         9915855
189798         MOVE '19'                  TO C-HIGH-CENT.               9915855
189800     CALL  'SICOMPDT'  USING    C-LOW-DATE, C-HIGH-DATE           9915855
189802                                SICOMPDT-RETURN-FLAG              9915855
189804                                SICOMPDT-DATE-FORMATS.            9915855
189806     IF  SICOMPDT-RETURN-FLAG NOT EQUAL 'H'                       9915855
189807         IF  WS-OD-EXPIRE-TOMORROW  EQUAL '0'                     9915855
189808             ADD OD-LIMIT-AMT (X)   TO WS-TOTAL-OD-AMT-ONLINE.    9915855
189810 C2468-PROCESS-END.                                               9915855
189812     MOVE '0'                   TO OD-LIMIT-OCC-CHG-TODAY (X)     9915855
189813                                   WS-OD-EXPIRE-TOMORROW.         9915855
189814     IF  OD-LIMIT-REV-DATE (X) NOT GREATER THAN ZEROS             9915855
189816         ADD 1 TO X                                               9915855
189818         GO TO C2462-PROCESS-CONT.                                9915855
189820     MOVE OD-LIMIT-REV-DATE (X) TO C-HIGH-DATE.                   9915855
189822     MOVE WBC-CAPTURE-MO        TO C-LOW-MO.                      0266741
189824     MOVE WBC-CAPTURE-DA        TO C-LOW-DA.                      0266741
189826     MOVE WBC-CAPTURE-YR        TO C-LOW-YR.                      0266741
189828     IF  WBC-CAPTURE-YR LESS WBC-NEXT-CENT-YR                     0266741
189830         MOVE '20'              TO C-LOW-CENT                     9915855
189832     ELSE                                                         9915855
189834         MOVE '19'              TO C-LOW-CENT.                    9915855
189836     CALL  'SIDIFC1'  USING    C-DATE-WORK.                       9915855
189838     IF  OD-LIMIT-REV-RPT-LEAD-DAYS GREATER THAN ZERO             9915855
189840     AND C-NO-DAYS NOT GREATER THAN OD-LIMIT-REV-RPT-LEAD-DAYS    9915855
189842         MOVE 'OW' TO IMEX-CODE-2                                 9915855
189844         PERFORM C2486-WRITE-OCC-EXC THRU C2486-EXIT.             9915855
189846     ADD 1 TO X.                                                  9915855
189848     GO TO C2462-PROCESS-CONT.                                    9915855
189850*                                                                 9915855
189854 C2470.                                                           9915855
189856     IF  WS-OD-LIMIT-OCC-DELETE EQUAL '0'                         9915855
189858         GO  TO  C2470-CONT.                                      9915855
189860     MOVE 1 TO U.                                                 9915855
189862     MOVE 2 TO Y.                                                 9915855
189864     MOVE OD-LIMIT-OCCURRENCES TO WS-SAVE-OD-OCCURRENCES.         9915855
189866     PERFORM C2478-BUMP-UP-FILE THRU C2478-BUMP-UP-FILE-EXIT.     9915855
189868 C2470-CONT.                                                      9915855
189872     MOVE WS-TOTAL-OD-AMT      TO WMS-OD-LIMIT-AMT                9915855
189874                                  OD-LIMIT-BATCH-TOTAL.           9915855
189876     MOVE WS-TOTAL-OD-AMT-ONLINE TO WMS-OD-LIMIT-AMT-ONLINE       9915855
189878                                    OD-LIMIT-ONLINE-TOTAL.        9915855
189880     IF  OD-LIMIT-REC-CHG-TODAY NOT EQUAL '0'                     9915855
189882     OR  OD-LIMIT-DELETE       EQUAL 'Y'                          9915855
189884         PERFORM C2480-OD-FIXED-EXC THRU C2482-EXIT.              9915855
189886     IF  OD-LIMIT-OCCURRENCES  EQUAL +0                           9915855
189888     OR  OD-LIMIT-DELETE       EQUAL 'Y'                          9915855
189890         MOVE '0'              TO WMS-OD-LIMIT-FILE               9915855
189892         MOVE 'N'              TO WMS-OD-LIMIT                    9915855
189894         GO  TO  C2475-OD-LIMIT-FINISH.                           9915855
189896     MOVE '0' TO OD-LIMIT-REC-CHG-TODAY                           9915855
189898                 OD-LIMIT-REPORT-TODAY.                           9915855
189900     SKIP2                                                        9915855
189902 C2472-WRITE-OD-FILE.                                             9915855
189904     MOVE OD-LIMIT-REC         TO OD-LIMIT-REC-OUT.               9915855
189906     PERFORM C2476-WRITE-OD-LMT THRU C2476-EXIT.                  9915855
189908 C2472-EXIT. EXIT.                                                9915855
189910 C2475-OD-LIMIT-FINISH.                                           9915855
189914     GO  TO  C2490-EXIT.                                          9915855
189916     EJECT                                                        9915855
189918 C2476-WRITE-OD-LMT.                                              9915855
189920     MOVE 'O'                  TO I-O-CONTROL-ACCESS.             9915855
189922     MOVE 'L' TO I-O-CONTROL-OPERATOR.                            9915855
189926     CALL 'IMLMTMV' USING I-O-CONTROL-AREA                        9915855
189928                          OD-LIMIT-REC-OUT.                       9915855
189930 C2476-EXIT.                                                      9915855
189932     EXIT.                                                        9915855
189934     SKIP2                                                        9915855
189936 C2478-BUMP-UP-FILE.                                              9915855
189938     IF  U GREATER THAN OD-LIMIT-OCCURRENCES                      9915855
189940         GO TO C2478-BUMP-UP-FILE-EXIT.                           9915855
189942     IF  OD-LIMIT-OCC-DEL-TODAY (U) EQUAL 'Y'                     9915855
189944         IF  U EQUAL OD-LIMIT-OCCURRENCES                         9915855
189946         OR  Y GREATER THAN WS-SAVE-OD-OCCURRENCES                9915855
189948             SUBTRACT +46 FROM OD-LENGTH                          9915855
189950             MOVE SPACES TO OD-LIMIT-1-12 (U)                     9915855
189952             SUBTRACT +1 FROM OD-LIMIT-OCCURRENCES                9915855
189954             GO TO C2478-BUMP-UP-FILE-EXIT.                       9915855
189956     IF  Y GREATER THAN WS-SAVE-OD-OCCURRENCES                    9915855
189958         ADD 1 TO U                                               9915855
189960         MOVE SPACES TO OD-LIMIT-1-12 (U)                         9915855
189962         GO TO C2478-BUMP-UP-FILE-EXIT.                           9915855
189964     IF  OD-LIMIT-OCC-DEL-TODAY (U) EQUAL 'Y'                     9915855
189966         SUBTRACT +46 FROM OD-LENGTH                              9915855
189968         MOVE OD-LIMIT-1-12 (Y)     TO OD-LIMIT-1-12 (U)          9915855
189970         ADD 1 TO Y                                               9915855
189972         SUBTRACT +1 FROM OD-LIMIT-OCCURRENCES                    9915855
189974         GO TO C2478-BUMP-UP-FILE.                                9915855
189976     ADD 1 TO U.                                                  9915855
189978     IF  Y EQUAL U                                                9915855
189980         ADD 1 TO Y                                               9915855
189982         GO TO C2478-BUMP-UP-FILE.                                9915855
189984     IF  Y GREATER THAN WS-SAVE-OD-OCCURRENCES                    9915855
189986         GO TO C2478-BUMP-UP-FILE.                                9915855
189988     MOVE OD-LIMIT-1-12 (Y)     TO OD-LIMIT-1-12 (U).             9915855
189990     ADD 1 TO Y.                                                  9915855
189992     GO TO C2478-BUMP-UP-FILE.                                    9915855
189994 C2478-BUMP-UP-FILE-EXIT.                                         9915855
189996     EXIT.                                                        9915855
189998 C2480-OD-FIXED-EXC.                                              9915855
190000     IF  OD-LIMIT-DELETE EQUAL 'Y'                                9915855
190002         MOVE 'ON'            TO IMEX-CODE-2                      9915855
190004     ELSE                                                         9915855
190006     IF  OD-LIMIT-REC-CHG-TODAY EQUAL '4'                         9915855
190008         MOVE '1'             TO WMS-OD-LIMIT-FILE                9915855
190010         MOVE '0'             TO WMS-OD-LIMIT                     9915855
190012         MOVE 'OM'            TO IMEX-CODE-2                      9915855
190014     ELSE                                                         9915855
190016*    IF  OD-LIMIT-REC-CHG-TODAY NOT EQUAL '0'                     9915855
190018         MOVE 'OO'            TO IMEX-CODE-2.                     9915855
190020 C2482-WRITE-FIXD-EXC.                                            9915855
190022     MOVE OD-LIMIT-FIXED-AREA TO EX46-DATA.                       9915855
190024     MOVE '46'                TO IMEX-REC-NO.                     9915855
190026     MOVE 'OL'                TO IMEX-CODE-1.                     9915855
190028     PERFORM WRITE-EX-MST     THRU WRITE-EX-EXIT.                 9915855
190030 C2482-EXIT. EXIT.                                                9915855
190032 C2484-OD-OCC-EXC.                                                9915855
190034     IF  OD-LIMIT-OCC-DEL-TODAY (X) EQUAL 'Y'                     9915855
190036         MOVE 'OR'            TO IMEX-CODE-2                      9915855
190038         MOVE '1'             TO WS-OD-LIMIT-OCC-DELETE           9915855
190040         GO  TO  C2486-WRITE-OCC-EXC.                             9915855
190042     IF  OD-LIMIT-OCC-CHG-TODAY (X) EQUAL '4'                     9915855
190044         MOVE 'OQ' TO IMEX-CODE-2                                 9915855
190046         GO  TO  C2486-WRITE-OCC-EXC                              9915855
190048     ELSE                                                         9915855
190050     IF  OD-LIMIT-OCC-CHG-TODAY (X) EQUAL '1' OR '3'              9915855
190052         MOVE 'OS' TO IMEX-CODE-2                                 9915855
190054         GO  TO  C2486-WRITE-OCC-EXC.                             9915855
190056     GO  TO  C2486-EXIT.                                          9915855
190058 C2486-WRITE-OCC-EXC.                                             9915855
190060     MOVE X                 TO EX47-OD-LMT-OCCUR.                 9915855
190062     MOVE OD-LIMIT-1-12 (X) TO EX47-DATA.                         9915855
190064     MOVE '47' TO IMEX-REC-NO.                                    9915855
190066     MOVE 'OL' TO IMEX-CODE-1.                                    9915855
190068     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     9915855
190070 C2486-EXIT. EXIT.                                                9915855
190080 C2490-EXIT. EXIT.                                                9915855
190090 C2495.                                                           9915855
190100     IF WMS-STMT-CLEAR NOT EQUAL TO '1'                           9915855
190102         GO  TO  C2500.                                           9915855
190104     MOVE '0' TO WMS-STMT-CLEAR.                                  9915855
190106     MOVE ZERO TO WMS-STMT-NO-CREDITS                             9915855
190108                  WMS-STMT-CR-AMT                                 9915855
190110                  WMS-STMT-NO-DEBITS                              9915855
190112                  WMS-STMT-DR-AMT                                 9915855
190114                  WMS-STMT-SERV-CHG                               9915855
190115                  WMS-STMT-WAIVED-SC-RP                           0347045
190116                  WMS-STMT-ITEMS                                  9915855
190118                  WMS-STMT-LINES                                  9915855
190120                  WMS-STMT-TRAN-CHG                               9915855
190122                  WMS-STMT-PAGE                                   9915855
190124                  WMS-NEW-THIS-CYCLE                              9915855
190126                  WMS-IOD-TIS-CYC-FEES.                           9915855
190128     MOVE ZERO TO WMS-STMT-EARN-CRED.                             0337109
190130     MOVE ZERO TO WMS-STMT-OVERDRAFT-CHGD-CTD                     0627451
190132                  WMS-STMT-NSF-CHGD-CTD.                          0627451
190140     MOVE SPACES TO WMS-IOD-TIS-INT-DATE.                         1004015
190145     MOVE 'N'    TO WMS-IOD-TIS-INT-RECALC.                       1004015
190146*----------------------------------------------------------------*9915749
190147*    SET 'WMS-NEW-THIS-CYCLE' TO '2' WHEN CYCLE INFO CHANGES.    *9915749
190148*----------------------------------------------------------------*9915749
190150     IF WMS-NEXT-STMT-FORMAT NOT EQUAL TO WMS-STMT-FORMAT
190200         MOVE WMS-NEXT-STMT-FORMAT TO WMS-STMT-FORMAT
190250         MOVE '0' TO SERIAL-STMT
190300         PERFORM C2185 THRU C2185-EXIT.
190305     IF  WMS-NEXT-STMT-PULL NOT EQUAL ' '                         IM003
190310         MOVE WMS-NEXT-STMT-PULL TO WMS-STMT-PULL                 IM003
190312         MOVE '2'   TO WMS-NEW-THIS-CYCLE                         9915749
190315         MOVE SPACE TO WMS-NEXT-STMT-PULL.                        IM003
190316*----------------------------------------------------------------*9915749
190317*    IF NEXT SUPP CODE = 04 MOVE '03' TO STMT-FLD-03, STMT-FLD-04*9915749
190318*----------------------------------------------------------------*9915749
190320     IF  WMS-NEXT-STMT-SUPP NOT EQUAL ' '                         IM003
190325         MOVE WMS-NEXT-STMT-SUPP TO WMS-STMT-SUPP                 IM003
190326         MOVE SPACE TO WMS-NEXT-STMT-SUPP                         9915749
190327         IF  WMS-STMT-SUPP EQUAL '4'                              9915749
190328             MOVE 03 TO WMS-STMT-FLD3, WMS-STMT-FLD4              9915749
190329         ELSE                                                     9915749
190330         IF  WMS-STMT-SUPP EQUAL '0'                              9915749
190331             MOVE 00 TO WMS-STMT-FLD3, WMS-STMT-FLD4.             9915749
190335     IF  WMS-NEXT-STMT-CYCLE NOT EQUAL ' '                        IM003
190340         MOVE WMS-NEXT-STMT-CYCLE TO WMS-STMT-FLD1                IM003
190342         MOVE '2'   TO WMS-NEW-THIS-CYCLE                         9915749
190345         MOVE SPACE TO WMS-NEXT-STMT-CYCLE.                       IM003
190346     IF  WMS-NEXT-BULK-FILE NOT EQUAL ' '                         IM005
190347         MOVE WMS-NEXT-BULK-FILE TO WMS-BULK-FILE                 IM005
190348         MOVE SPACE TO WMS-NEXT-BULK-FILE.                        IM005
190350     IF  WMS-NB-NXT-VEC-SEG-CD NOT EQUAL ' '                      9915749
190352         MOVE WMS-NB-NXT-VEC-SEG-CD TO WMS-NB-VEC-SEG-CD          9915749
190354         MOVE SPACE TO WMS-NB-NXT-VEC-SEG-CD.                     9915749
190360     MOVE WMS-CURR-BAL TO WMS-STMT-BEGIN-BAL.                     1105504
190362     IF  WMS-NEXT-CHK-TRUNC-FLAG NOT EQUAL ' '                    0527261
190364         MOVE WMS-NEXT-CHK-TRUNC-FLAG                             0527261
190366           TO WMS-CHK-TRUNC-FLAG                                  0527261
190368         MOVE SPACE TO WMS-NEXT-CHK-TRUNC-FLAG.                   0527261
190400     IF WMS-STATUS EQUAL TO '04'
190450         ADD +1 TO WMS-STMT-CYCL-CLSD
190500     ELSE MOVE ZERO TO WMS-STMT-CYCL-CLSD.
190550     MOVE WBC-LAST-CAPTURE-DATE TO WMS-DATE-LAST-STMT.            0266741
190560     IF  WMS-LAST-STMT-CY-DAYX GREATER THAN '1'                   IM004
190566         ADD WMS-LAST-STMT-CY-DAY9 TO WMS-LAST-STMT-DA9           IM004
190580         SUBTRACT +1 FROM WMS-LAST-STMT-DA9.                      IM004
190600     MOVE ZERO TO WMS-IOD-CYC-PAID-INT.
190620     MOVE ZERO TO WMS-IOD-CYC-TAX.                                IM002
190623     MOVE ZERO TO WMS-IOD-CYC-STATE-TAX.                          2012254
190627     MOVE ZERO TO WMS-IOD-CYC-LOCAL-TAX.                          2012254
190630     MOVE ZERO TO WMS-OD-STMT-CYC-CHRG.                           9915845
190635     MOVE ZERO TO WMS-XINV-CTD-AGGR                               2016639
190640                  WMS-XINV-CTD-DAYS.                              2016639
190650     IF WMS-SAVINGS-TRLR EQUAL TO '1'
190700         MOVE WMS-INT-CUR-BAL TO WMS-INT-BEG-BAL
190750         MOVE ZERO TO WMS-INT-DR-NUMBER
190800                      WMS-INT-DR-AMT
190850                      WMS-INT-CR-NUMBER
190900                      WMS-INT-CR-AMT
190950                      WMS-INT-ACCUM-INT                           IM002
190960                      WMS-INT-TAX                                 IM008
190961                      WMS-INT-TIS-CYC-FEES                        1004015
190962                      WMS-INT-TAX-STATE                           2012254
190964                      WMS-INT-TAX-LOCAL                           2012254
190965         IF  WMS-SAV-INT-PAY-CYCLE EQUAL '2' OR '3'               9915845
190975             MOVE 'F' TO CLEAR-SAV-CY-SW                          IM008
190980             MOVE ZERO TO WMS-INT-AGGR-DAYS                       IM008
190985                          WMS-INT-AGGR-BAL.                       IM008
191000 C2500.
191002     IF  WBC-FDIC-CTL-OPT EQUAL 'N'                               0927850
191004         MOVE ZERO TO WMS-PROV-HOLD-AMT.                          0927850
191050     IF  WMS-SAVINGS-TRLR EQUAL '1'
191100         MOVE WMS-INT-CUR-BAL TO WMS-PREV-INT-BAL.
191150     MOVE WMS-TODAYS-CREDITS TO WMS-PREV-DAY-CR.
191200     MOVE WMS-TODAYS-CREDITS-NO TO WMS-PREV-DAY-CR-NO.
191250     MOVE WMS-HOLD-AMT TO HOLD-HOLD-AMT.
191300     MOVE ZERO TO WMS-TODAYS-CREDITS
191350                  WMS-TODAYS-CREDITS-NO
191400                  WMS-HOLD-AMT
191410                  WMS-NB-CST-UNAV-HLD                             1105504
191420                  WMS-NB-OTH-HLD                                  1105504
191450                  WMS-BANK-AVAIL-ADJ                              IM007
191460                  WMS-CUST-AVAIL-ADJ                              IM007
191520                  WMS-HOLD-NO                                     IM003
191530                  WMS-DROP-HOLD-AMOUNT                            IM005
191532                  WMS-STOP-PAYS.                                  9915845
191534 C2500-EXIT.                                                      9915845
191536       EXIT.                                                      9915845
191554 C2550.                                                           9915851
191555     IF  WMS-IOD-INT-CLEAR     EQUAL '1'                          9915851
191556         MOVE '0'       TO WMS-IOD-INT-CLEAR.                     9915851
191557     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9915851
191558         IF  WMS-SAV-INT-CLEAR     EQUAL '1'                      9915851
191559             MOVE 'F'   TO CLEAR-SAV-CY-SW                        9915851
191560             MOVE '0'   TO WMS-SAV-INT-CLEAR                      9915851
191561             MOVE ZERO  TO WMS-INT-AGGR-DAYS                      9915851
191562                           WMS-INT-AGGR-BAL.                      9915851
191563     IF  WMS-OD-INT-CLEAR    EQUAL '1'                            9915851
191564         MOVE '0'       TO WMS-OD-INT-CLEAR.                      9915851
191580                                                                  9915851
191584 C2600.                                                           9915851
191585     IF WBC-GL-OR-REGION-CHANGE EQUAL '1' OR '3'                  0266741
191586         IF NEW-MASTER-SW NOT EQUAL '1'                           9915851
191587             MOVE 'Y' TO GL-BUILD-MASTER-SW                       9915851
191590             PERFORM K5700 THRU K5700-EXIT.                       9915851
191600 C2610.                                                           1003625
191610     IF  WBC-GL-OR-REGION-CHANGE EQUAL '2' OR '3'                 0266741
191620         IF  NEW-MASTER-SW NOT EQUAL '1'                          1003625
191630             PERFORM K5750-REGION-CALC THRU K5750-EXIT.           1003625
191640 C2620.                                                           0417078
191650     IF  WBC-ACCT-EDIT-REBUILD EQUAL '1'                          0417078
191660         IF  NEW-MASTER-SW NOT EQUAL '1'                          0417078
191670             PERFORM X0140-BUILD-EDITED-ACCT THRU X0140-EXIT.     0417078
191900 C2700.                                                           9915845
191910     IF  IBT-ACCT-IND EQUAL '2', GO  TO  C2995.                   9915845
191958     IF  MASS-PROD-MAINT EQUAL '0', GO  TO  C2800.                1004015
191959     MOVE TRAN-REC TO SAVE-REC.                                   IM002
191960     SET PM-INDX TO +1.                                           IM002
191961 C2720.                                                           IM002
191962     IF  WMS-ACCT-TYPE EQUAL PMT-TYPE (PM-INDX)                   IM002
191964         MOVE PMT-ENTRY (PM-INDX) TO TRAN-REC                     IM002
191966         PERFORM C2740 THRU C2740-EXIT.                           IM002
191968     SET PM-INDX UP BY +1.                                        IM002
191970     IF  PM-INDX NOT GREATER THAN PMT-TBL-CTR                     IM002
191972         GO  TO  C2720.                                           IM002
191974     MOVE SAVE-REC TO TRAN-REC.                                   IM002
191976     GO  TO  C2800.                                               1004015
191978 C2740.                                                           IM002
191980     IF  TR-FM-MAINT-CODE EQUAL 'O'                               IM002
191981         MOVE TR-FM-FLD-START TO FLD-START                        IM004
191982         MOVE SPACES TO EX15-MST-OLD-DATA                         IM004
191983         PERFORM K5100-CONT                                       9915845
191984         IF  EX15-MST-OLD-DATA NOT EQUAL TR-FM-OLD-DATA           IM002
191985             MOVE SPACES TO EX15-MST-OLD-DATA                     IM002
191986             GO  TO  C2740-EXIT.                                  IM002
191987     MOVE WMS-CONTROL-KEY TO TR-KEY.                              IM002
191988     IF  TR-FM-FLD-NO EQUAL '0692'                                IM006
191989         MOVE 'N' TO GL-MAINT-SW                                  IM006
191990         PERFORM K5600 THRU K5699-EXIT                            IM006
191991     ELSE                                                         IM006
191992         PERFORM K5000 THRU K5500.                                IM006
191993     MOVE '0' TO ACCT-NOT-FOUND.                                  IM006
191994     MOVE 'F' TO GL-MAINT-SW.                                     IM006
191995 C2740-EXIT. EXIT.                                                IM006
192000 C2800.                                                           1004015
192002     IF  MASS-NOTICES-SW EQUAL '0', GO TO C2899-EXIT.             1004015
192003     IF  WMS-TIS-CONSUMER-FLAG NOT EQUAL 'Y', GO TO C2899-EXIT.   1004382
192004     SET PN-INDX TO +1.                                           1004015
192006 C2810.                                                           1004015
192008     IF  WMS-ACCT-TYPE EQUAL PNT-TYPE (PN-INDX)                   1004015
192010         MOVE '17' TO IMEX-REC-NO                                 1004015
192012         MOVE 'CT' TO IMEX-CODE-1                                 1004015
192014         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  1004015
192016         GO TO C2899-EXIT.                                        1004015
192018     SET PN-INDX UP BY +1.                                        1004015
192020     IF  PN-INDX NOT GREATER THAN PNT-TBL-CTR                     1004015
192022         GO TO C2810.                                             1004015
192024 C2899-EXIT.                                                      1004015
192026     EXIT.                                                        1004015
192028 C2900.                                                           1004015
192050     MOVE '0' TO AUTO-DEP-DUE-TODAY.
192100     IF WMS-AUTO-DEP-DA EQUAL TO SPACES GO TO C2995.
192150     MOVE WBC-CAPTURE-DATE TO D1-MO-DA.                           0266741
192200     MOVE WBC-CAPTURE-YR TO D1-YR.                                0266741
192210     IF  D1-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
192220         MOVE '19' TO D1-CC                                       1105729
192230     ELSE                                                         1105729
192240         MOVE '20' TO D1-CC.                                      1105729
192250     MOVE WBC-REPT-THRU-DATE TO D2-MO-DA.                         0266741
192300     MOVE WBC-REPT-YR TO D2-YR.                                   0266741
192310     IF  D2-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
192320         MOVE '19' TO D2-CC                                       1105729
192330     ELSE                                                         1105729
192340         MOVE '20' TO D2-CC.                                      1105729
192350     IF WMS-AUTO-DEP-DA LESS THAN WBC-CAPTURE-DA                  0266741
192400         MOVE DATE-2 TO DATE-3
192450     ELSE
192500         MOVE DATE-1 TO DATE-3.
192550     MOVE WMS-AUTO-DEP-DA TO D3-DA.
192600     IF DATE-3 NOT LESS THAN DATE-1
192650     AND DATE-3 NOT GREATER THAN DATE-2
192700         MOVE '1' TO AUTO-DEP-DUE-TODAY.
192750 C2995.  EXIT.
192800 C3000.
192850     IF TRN-CONTROL NOT EQUAL TO WMS-CONTROL-KEY, GO TO R0010.
192900     GO TO K0010.
192910*                                                                 1003625
192912* NEW ACCOUNT PROCESSING                                          1003625
192914*                                                                 1003625
192950 G0010.
193000     MOVE TRN-CONTROL TO WMS-CONTROL-KEY.
193050 K0010.
193070     IF  UPLINE-REJ-SW EQUAL '1'                                  9915845
193072     AND TR-CLASS EQUAL TO '96'                                   9915845
193074         MOVE '44' TO IMEX-REC-NO                                 9915845
193076         MOVE 'IB' TO IMEX-CODE-1                                 9915845
193077         MOVE 'IW' TO IMEX-CODE-2                                 9915845
193078         MOVE TR-96-IBT-NEW-ACCT TO EX44-IBT-OLD-NEW-ACCT         9915845
193080         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                 9915845
193100     IF UPLINE-REJ-SW EQUAL TO '1'
193150         MOVE '09' TO IMEX-REC-NO
193200         MOVE 'D0' TO IMEX-CODE-1
193250         MOVE HIGH-VALUES TO IMEX-CODE-2
193300         MOVE TR-REJ-PROG TO EX09-REJ-PROG
193350         MOVE TR-REJ-RESN TO EX09-REJ-RESN
193400         MOVE TR-SOURCE TO EX09-SOURCE
193450         MOVE TR-BATCH TO EX09-BATCH
193500         MOVE TR-SEQ TO EX09-SEQ
193550         MOVE TR-CLASS TO EX09-TR-CODE
193600         MOVE TR-UPLINE-REJ TO EX09-REMAINDER
193650         GO TO Q0015.
193700     IF TR-CLASS1 EQUAL TO 'S' AND TR-CLASS2 EQUAL TO 'T'
193750         MOVE '20' TO IMEX-REC-NO
193800         MOVE TR-TOT-ID TO IMEX-EX-CODE
193850         MOVE TR-SYS-TOT TO IMEX-RECORD
193900         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT
193950         MOVE '0' TO EX-MST-CTL
194000         GO TO Q4600.                                             0447268
194003     IF  TR-CLASS1 EQUAL TO '2' AND TR-CLASS2 EQUAL TO '2'        IM002
194005         IF  PM-INDX GREATER THAN +50                             IM002
194007             MOVE TR-FILE-MAINT TO EX09-REMAINDER                 IM002
194009             MOVE '046' TO REJRESN                                0717565
194011             PERFORM K3165 THRU K3168                             IM002
194013             PERFORM UNPOST-EXCEPT THRU WRITE-EX-EXIT             IM002
194015             MOVE '0' TO EX-MST-CTL                               IM002
194017             MOVE SPACES TO EX-INFO                               IM002
194019             MOVE '1' TO TRAN-REWRITE-SW                          IM002
194021             GO  TO  Q4600                                        IM002
194022         ELSE                                                     9915845
194023             MOVE '1' TO MASS-PROD-MAINT                          9915845
194024             MOVE TRAN-REC TO PMT-ENTRY (PM-INDX)                 9915845
194025             SET PM-INDX UP BY +1                                 9915845
194026             ADD +1 TO PMT-TBL-CTR                                9915845
194027             GO  TO  Q4600.                                       9915845
194034     IF  TR-CLASS1 EQUAL '2' AND TR-CLASS2 EQUAL TO '3'           1004015
194035         IF  PN-INDX GREATER THAN +200                            1004015
194036             MOVE '058' TO REJRESN                                0717565
194037             PERFORM K3165 THRU K3168                             1004015
194038             PERFORM UNPOST-EXCEPT THRU WRITE-EX-EXIT             1004015
194039             MOVE '0' TO EX-MST-CTL                               1004015
194040             MOVE SPACES TO EX-INFO                               1004015
194041             MOVE '1' TO TRAN-REWRITE-SW                          1004015
194042             GO TO Q4600                                          1004015
194043         ELSE                                                     1004015
194044             MOVE '1' TO MASS-NOTICES-SW                          1004015
194045             MOVE TR-PROD-TYPE TO PNT-ENTRY (PN-INDX)             1004015
194046             SET PN-INDX UP BY +1                                 1004015
194047             ADD +1 TO PNT-TBL-CTR                                1004015
194048             GO TO Q4600.                                         1004015
194050     IF  TR-CLASS2 NOT EQUAL TO '1' AND '0'                       9915845
194060         GO TO K0020.                                             9915845
194070     IF  TR-CLASS1 NOT EQUAL TO '0'                               9915845
194080         GO TO K0020.                                             9915845
194110     IF  SKIP-READ-SW EQUAL '1'                                   9915845
194112         IF  TR-SCLASS1 EQUAL '2'                                 9915845
194114             MOVE '085' TO REJRESN                                0717565
194116             MOVE '17' TO IMEX-REC-NO                             9915845
194118             MOVE 'IB' TO IMEX-CODE-1                             9915845
194120             MOVE 'IJ' TO IMEX-CODE-2                             9915845
194122             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT              9915857
194124             MOVE '1' TO NEW-ACCT-REJ-SW                          9915845
194126             GO  TO  K3165                                        9915845
194128         ELSE                                                     9915845
194132         IF  TR-SCLASS1 EQUAL '3'                                 9915845
194134             MOVE '085' TO REJRESN                                0717565
194136             MOVE '44' TO IMEX-REC-NO                             9915845
194138             MOVE 'IB' TO IMEX-CODE-1                             9915845
194140             MOVE 'IL' TO IMEX-CODE-2                             9915845
194142             MOVE TR-01-IBT-ACCT TO EX44-IBT-OLD-NEW-ACCT         9915845
194144             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT              9915857
194146             MOVE '1' TO NEW-ACCT-REJ-SW                          9915845
194148             GO  TO  K3165.                                       9915845
194150     IF SKIP-READ-SW EQUAL  TO '1'  GO TO K0012.                  9915845
194160     IF  IBT-ACCT-IND EQUAL '1'                                   9915845
194162     AND SAVE-IBT-FLG EQUAL '3'                                   9915845
194164         IF  TR-SCLASS1 EQUAL '2'                                 9915845
194166             GO  TO  K0012                                        9915845
194168         ELSE                                                     9915845
194169             MOVE '44' TO IMEX-REC-NO                             9915857
194170             MOVE 'IB' TO IMEX-CODE-1                             9915857
194171             MOVE 'IH' TO IMEX-CODE-2                             9915857
194172             MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20      9915857
194173             MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                   9915857
194174             MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT      9915857
194175             MOVE TR-CLASS          TO EX44-CLASS                 9915857
194176             MOVE TR-SOURCE         TO EX44-SOURCE                9915857
194177             MOVE TR-BATCH          TO EX44-BATCH                 9915857
194178             MOVE TR-SEQ            TO EX44-SEQ                   9915857
194179             MOVE TR-TRACE          TO EX44-TRACE                 9915857
194184             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.             9915845
194186     IF  IBT-ACCT-IND EQUAL '1'                                   9915845
194188     AND WMS-IBT-FLAG EQUAL '1'                                   9915845
194190         IF  TR-SCLASS1 EQUAL '3'                                 9915845
194192             GO  TO  K0012                                        9915845
194194         ELSE                                                     9915845
194196             PERFORM X1100-RESET-IBT THRU X1100-EXIT.             9915845
194230     IF IM-MEMO-OL-NEW-ACCT             GO TO K0012.              9915845
194250     SKIP1
194300*  --AT THIS POINT, ACCOUNT NUMBER IS ALREADY ON FILE
194350     MOVE '1' TO NEW-ACCT-REJ-SW.
194370     MOVE '001' TO REJRESN.                                       0717565
194400     SKIP1
194420     IF  TR-SCLASS1 EQUAL '1'                                     9915845
194430         MOVE '17' TO IMEX-REC-NO                                 9915845
194440         MOVE 'IB' TO IMEX-CODE-1                                 9915845
194450         MOVE 'IG' TO IMEX-CODE-2                                 9915857
194460         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                 9915857
194500     GO TO K3165.
194550 K0012.
194600     IF WBC-PROCESS-FLAG EQUAL TO '0' OR '2', GO TO K3130.        0266741
194610     IF  TR-SCLASS1 EQUAL '2'                                     9915845
194612         GO  TO  X1150-IBT-NEW-ACCT.                              9915845
194614     IF  TR-SCLASS1 EQUAL '3'                                     9915845
194616         GO  TO  X1200-IBT-OLD-ACCT.                              9915845
194650     MOVE TR-NEW-MST TO WMS-DDA-MASTER.
194700     MOVE WS-MSTR-FIXED-PORTION TO WMS-LENGTH.                    0903291
194750     MOVE LOW-VALUES TO WMS-BIN0.
194755     PERFORM X0140-BUILD-EDITED-ACCT THRU X0140-EXIT.             0417078
194760     IF  TR-SCLASS1 EQUAL '1'                                     9915845
194762         MOVE '1' TO IBT-NEW-FLAG, NEW-MASTER-SW                  9915857
194764         MOVE '44' TO IMEX-REC-NO                                 9915857
194766         MOVE 'IB' TO IMEX-CODE-1                                 9915857
194768         MOVE 'IA' TO IMEX-CODE-2                                 9915857
194770         MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20          9915857
194772         MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                       9915857
194774         MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT          9915857
194776         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  9915857
194778         ADD +1 TO IBT-NW-ACCT-POSTD                              9915857
194780         MOVE '3' TO WMS-IBT-FLAG                                 9915857
194782         GO  TO  K0015.                                           9915857
194785     MOVE '1' TO NEW-MASTER-SW.                                   9915845
194790     MOVE 'Y' TO GL-BUILD-MASTER-SW.                              9915845
194795     PERFORM K5700 THRU K5700-EXIT.                               9915845
194800     PERFORM C2180 THRU C2189.
194805     PERFORM C2460-OD-LIMIT-FILE-UPDATE THRU C2490-EXIT.          9915855
194810     PERFORM C2800 THRU C2899-EXIT.                               1004015
194850     PERFORM C2900 THRU C2995.
194860     MOVE WMS-DATE-OPENED TO WK-OPEN-DATE.                        9715519
194870     PERFORM CHECK-366 THRU C366-EXIT.                            9715519
194880     MOVE WK-RETURN-FLG TO WMS-LEAP-YEAR-FLG.                     9715519
194900     MOVE ZEROES TO HOLD-HOLD-AMT, DDA-BALANCE-IN.
194920     MOVE +0 TO SAVE-HOLD-AMT.                                    IM004
194950     ADD +1 TO DDA-NEW-ACCTS, WS-GL-DDA-NEW-ACCTS.                0902970
195000     IF WMS-IOD-RATE-PTR GREATER THAN ZERO
195050     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
195100         ADD +1 TO IOD-NEW-ACCTS, WS-GL-IOD-NEW-ACCTS.            0902970
195101     PERFORM REGE-EFF-DATE THRU REGE-EFF-EXIT.                    1020116
195102*                                                                 2016639
195104*--------------------------------------------------------------*  2016639
195106*    ADD TO SYSTEM AND GL TOTALS FOR NEW BANK POSITION ACCOUNTS*  2016639
195108*--------------------------------------------------------------*  2016639
195110     IF  WMS-XINV-LINK-IND    EQUAL  'P'                          2016639
195112         ADD  +1                 TO  T3-XINV-SD-IN-NO             2016639
195114                                     WS-GL-XINV-SD-IN-NO.         2016639
195116*                                                                 2016639
195200     MOVE '17' TO IMEX-REC-NO.
195250     MOVE 'NA' TO IMEX-CODE-1.
195300     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
195350     MOVE '1' TO WMS-SC-FIRST-CHECK.
195359******************************************************************IM008
195360***  BKDT-DAYS-FLAG WILL BE SET TO '1' FOR BACKDATED NEW         *IM008
195362***  ACCOUNTS.  THE FIRST BACKDATED DDA TRANSACTION  WILL        *IM007
195366***  SET THE SERVICE CHARGE, MONTH-TO-DATE, AND YEAR-TO-DATE     *IM007
195370***  AGGREGATE DAYS.                                             *IM007
195374******************************************************************IM007
195378     MOVE WMS-DATE-OPENED TO DT-LOW-DATE.                         IM007
195382     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
195386     CALL 'SIDIF1' USING DATE-AREA.                               IM007
195390     IF  RET-DAYS GREATER THAN +0                                 IM007
195394         MOVE '1' TO BKDT-DAYS-FLAG                               0903490
195396                     OD-BKDT-DAYS-FLAG.                           0903490
195400 INIT-BANK-AVAIL-TRLR.                                            IM007
195450     IF WMS-BANK-AVAIL-FLAG EQUAL TO '1'                          IM007
195470         MOVE '1' TO WMS-BANK-AVAIL-TRLR                          IM007
195550         ADD WS-TRL-BNK-AVAIL-LNGTH TO WMS-LENGTH                 0903291
195600         MOVE '1' TO WMS-EXPANSION-IND
195650         MOVE ZERO TO WMS-BANK-AVAIL-TR-AMT (1)                   IM007
195670                      WMS-BANK-AVAIL-TR-AMT (2)                   IM007
195690                      WMS-BANK-AVAIL-TR-AMT (3)                   IM007
195710                      WMS-BANK-AVAIL-TR-AMT (4)                   IM007
195730                      WMS-BANK-AVAIL-TR-AMT (5)                   IM007
195750                      WMS-BANK-AVAIL-TR-AMT (6)                   IM007
195770                      WMS-BANK-AVAIL-TR-AMT (7)                   IM007
195955                      SAVE-BANK-AMT                               IM007
195965         MOVE WMS-BANK-AVAIL-TRAILER TO SAVE-BANK-TRLR.           IM007
195975 INIT-BANK-AVAIL-END.  EXIT.                                      IM007
195985 INIT-CUST-AVAIL-TRLR.                                            IM007
196100     IF WMS-CUST-AVAIL-FLAG EQUAL TO '1'                          IM007
196120         MOVE '1' TO WMS-CUST-AVAIL-TRLR                          IM007
196200         ADD WS-TRL-CUS-AVAIL-LNGTH TO WMS-LENGTH                 0903291
196250         MOVE '1' TO WMS-EXPANSION-IND
196300         MOVE ZERO TO WMS-CUST-AVAIL-FUNDS (1)                    IM007
196330                      WMS-CUST-AVAIL-FUNDS (2)                    IM007
196360                      WMS-CUST-AVAIL-FUNDS (3)                    IM007
196390                      WMS-CUST-AVAIL-FUNDS (4)                    IM007
196420                      WMS-CUST-AVAIL-FUNDS (5)                    IM007
196450                      WMS-CUST-AVAIL-FUNDS (6)                    IM007
196480                      WMS-CUST-AVAIL-FUNDS (7)                    IM007
196510                      WMS-CUST-AVAIL-FUNDS (8)                    IM007
196540                      WMS-CUST-AVAIL-FUNDS (9)                    IM007
196570                      WMS-CUST-AVAIL-FUNDS (10)                   IM007
196755                      WMS-CUST-AVAIL-FUNDS (11)                   IM007
196758                      WMS-CUST-AVAIL-FUNDS (12)                   IM007
196761                      SAVE-CUST-AMT                               IM007
196764         MOVE WMS-CUST-AVAIL-TRAILER TO SAVE-CUST-TRLR.           IM007
196767 INIT-CUST-AVAIL-END.  EXIT.                                      IM007
196770 INIT-CASH-AVAIL-TRLR.                                            IM007
196773     IF  WMS-CASH-AVAIL-FLAG EQUAL TO '1'                         IM007
196776         MOVE '1' TO WMS-CASH-AVAIL-TRLR                          IM007
196779         ADD WS-TRL-CSH-AVAIL-LNGTH TO WMS-LENGTH                 0903291
196782         MOVE '1' TO WMS-EXPANSION-IND                            IM007
196785         MOVE +0  TO WMS-CASH1-AVAIL (1)  WMS-CASH2-AVAIL (1)     IM007
196788                     WMS-CASH1-AVAIL (2)  WMS-CASH2-AVAIL (2)     IM007
196791                     WMS-CASH1-AVAIL (3)  WMS-CASH2-AVAIL (3)     IM007
196794                     WMS-CASH1-AVAIL (4)  WMS-CASH2-AVAIL (4)     IM007
196797                     WMS-CASH1-AVAIL (5)  WMS-CASH2-AVAIL (5)     IM007
196800                     WMS-CASH1-AVAIL (6)  WMS-CASH2-AVAIL (6)     IM007
196803                     WMS-CASH1-AVAIL (7)  WMS-CASH2-AVAIL (7)     IM007
196806                     WMS-CASH1-AVAIL (8)  WMS-CASH2-AVAIL (8)     IM007
196809                     WMS-CASH1-AVAIL (9)  WMS-CASH2-AVAIL (9)     IM007
196812                     WMS-CASH1-AVAIL (10) WMS-CASH2-AVAIL (10)    IM007
196815                     WMS-CASH1-AVAIL (11) WMS-CASH2-AVAIL (11)    IM007
196818                     WMS-CASH1-AVAIL (12) WMS-CASH2-AVAIL (12).   IM007
196821 INIT-CASH-AVAIL-END.  EXIT.                                      IM007
196830                                                                  0927817
196832 COPY IM31FFIN.                                                   0927817
196834                                                                  0927817
196850 INIT-NSF-OD-TRLR.
196900     IF  WMS-NSF-OD-TRLR-FLAG EQUAL '1'
196950         MOVE '1' TO WMS-OD-NSF-TRLR
197000         ADD WS-TRL-OD-NSF-LNGTH TO WMS-LENGTH                    0903291
197050         MOVE '1' TO WMS-EXPANSION-IND
197100         MOVE ZERO TO WMS-DAYS-OD-MO (01)
197150                      WMS-DAYS-OD-MO (02)
197200                      WMS-DAYS-OD-MO (03)
197250                      WMS-DAYS-OD-MO (04)
197300                      WMS-DAYS-OD-MO (05)
197350                      WMS-DAYS-OD-MO (06)
197400                      WMS-DAYS-OD-MO (07)
197450                      WMS-DAYS-OD-MO (08)
197500                      WMS-DAYS-OD-MO (09)
197550                      WMS-DAYS-OD-MO (10)
197600                      WMS-DAYS-OD-MO (11)
197650                      WMS-DAYS-OD-MO (12)
197660                      WMS-NB-TIMES-CB-MO (1)                      1105504
197661                      WMS-NB-TIMES-CB-MO (2)                      1105504
197662                      WMS-NB-TIMES-CB-MO (3)                      1105504
197663                      WMS-NB-TIMES-CB-MO (4)                      1105504
197664                      WMS-NB-TIMES-CB-MO (5)                      1105504
197665                      WMS-NB-TIMES-CB-MO (6)                      1105504
197666                      WMS-NB-TIMES-CB-MO (7)                      1105504
197667                      WMS-NB-TIMES-CB-MO (8)                      1105504
197668                      WMS-NB-TIMES-CB-MO (9)                      1105504
197669                      WMS-NB-TIMES-CB-MO (10)                     1105504
197670                      WMS-NB-TIMES-CB-MO (11)                     1105504
197671                      WMS-NB-TIMES-CB-MO (12)                     1105504
197700         MOVE WMS-OD-DAYS-MO TO WMS-OD-TIMES-MO
197750                                WMS-NSF-MONTHS
197800                                WMS-UNAVAIL-MONTHS.               IM007
197850 INIT-NSF-OD-END.
197900     EXIT.
197902 INIT-DUAL-TAX-YR-TRLR.                                           9915858
197904     IF  WMS-DUAL-YEAR-FLAG EQUAL TO '1'                          9915858
197906         MOVE '1'  TO WMS-DUAL-YEAR-TRLR                          9915858
197908         ADD WS-TRL-DUAL-YR-LNGTH TO WMS-LENGTH                   9915858
197910         MOVE '1'  TO WMS-EXPANSION-IND                           9915858
197912         MOVE ZERO TO WMS-DUAL-YR-CUR-IOD-INT                     9915858
197914                      WMS-DUAL-YR-CUR-IOD-FED                     9915858
197916                      WMS-DUAL-YR-CUR-IOD-STATE                   9915858
197918                      WMS-DUAL-YR-CUR-IOD-LOCAL                   9915858
197920                      WMS-DUAL-YR-CUR-SAV-INT                     9915858
197922                      WMS-DUAL-YR-CUR-SAV-FED                     9915858
197924                      WMS-DUAL-YR-CUR-SAV-STATE                   9915858
197926                      WMS-DUAL-YR-CUR-SAV-LOCAL                   9915858
197928                      WMS-DUAL-YR-PREV-IOD-INT                    9915858
197930                      WMS-DUAL-YR-PREV-IOD-FED                    9915858
197932                      WMS-DUAL-YR-PREV-IOD-STATE                  9915858
197934                      WMS-DUAL-YR-PREV-IOD-LOCAL                  9915858
197936                      WMS-DUAL-YR-PREV-SAV-INT                    9915858
197938                      WMS-DUAL-YR-PREV-SAV-FED                    9915858
197940                      WMS-DUAL-YR-PREV-SAV-STATE                  9915858
197942                      WMS-DUAL-YR-PREV-SAV-LOCAL.                 9915858
197944 INIT-DUAL-TAX-YR-TRLR-END.  EXIT.                                9915858
197950 INIT-EXT-DEP-TRLR.
198000     IF  WMS-EXTRNL-DEP-FLAG EQUAL '1'
198050         MOVE '1' TO WMS-EXTRNL-DEPOSIT-TRLR
198100         ADD WS-TRL-EXTR-DEP-LNGTH TO WMS-LENGTH                  0903291
198150         MOVE '1' TO WMS-EXPANSION-IND
198200         MOVE ZERO TO WMS-SAVINGS-BAL
198250                      WMS-AGGR-SAV-BAL
198300                      WMS-MIN-SAV-BAL.                            1105504
198350 INIT-EXT-DEP-END.                                                2012254
198352     EXIT.                                                        2012254
198354 INIT-KITE-SUSP-TRLR.                                             2012254
198356     IF (WMS-TARGET-AMT-TRLR EQUAL '1') AND                       2012254
198358        (WMS-TARGET-DELETE NOT EQUAL '2')                         2012254
198360         GO TO INIT-KITE-SUSP-END.                                2012254
198362     IF (WMS-KITING-FLAG EQUAL '2') AND                           2012254
198364        (WBC-KITING-SUSP EQUAL '1' OR '2')                        0266741
198366         MOVE '1' TO WMS-KITING-SUSP-TRLR                         2012254
198368         ADD WS-TRL-KITING-LNGTH TO WMS-LENGTH                    2012254
198370         MOVE '1' TO WMS-EXPANSION-IND                            2012254
198372         MOVE  +0  TO WMS-DEP-TURN-RATIO                          2012254
198374                      WMS-CR-DR-NO-RATIO                          2012254
198376                      WMS-CR-DR-AMT-RATIO                         2012254
198378                      WMS-DR-UNAVAIL-AMT-RATIO                    2012254
198380                      WMS-KITE-BUS-DAYS                           2012254
198382                      WMS-KITING-SUSP-DAYS                        2012254
198384                      WMS-KITE-YTD-SUSP-DAYS                      2012254
198386                      WMS-KITE-LGE-ITEM                           2012254
198388                      WMS-KITE-AGGR-BAL                           2012254
198390                      WMS-KITE-TOT-CR-NO                          2012254
198392                      WMS-KITE-TOT-CR-AMT                         2012254
198394                      WMS-KITE-TOT-DR-NO                          2012254
198396                      WMS-KITE-TOT-DR-AMT                         2012254
198398                      WMS-KITE-TODAY-CR-NO (1)                    2012254
198400                      WMS-KITE-TODAY-CR-NO (2)                    2012254
198402                      WMS-KITE-TODAY-CR-NO (3)                    2012254
198404                      WMS-KITE-TODAY-CR-NO (4)                    2012254
198406                      WMS-KITE-TODAY-CR-NO (5)                    2012254
198408                      WMS-KITE-TODAY-CR-NO (6)                    2012254
198410                      WMS-KITE-TODAY-CR-NO (7)                    2012254
198412                      WMS-KITE-TODAY-CR-AMT (1)                   2012254
198414                      WMS-KITE-TODAY-CR-AMT (2)                   2012254
198416                      WMS-KITE-TODAY-CR-AMT (3)                   2012254
198418                      WMS-KITE-TODAY-CR-AMT (4)                   2012254
198420                      WMS-KITE-TODAY-CR-AMT (5)                   2012254
198422                      WMS-KITE-TODAY-CR-AMT (6)                   2012254
198424                      WMS-KITE-TODAY-CR-AMT (7)                   2012254
198426                      WMS-KITE-TODAY-DR-NO (1)                    2012254
198428                      WMS-KITE-TODAY-DR-NO (2)                    2012254
198430                      WMS-KITE-TODAY-DR-NO (3)                    2012254
198432                      WMS-KITE-TODAY-DR-NO (4)                    2012254
198434                      WMS-KITE-TODAY-DR-NO (5)                    2012254
198436                      WMS-KITE-TODAY-DR-NO (6)                    2012254
198438                      WMS-KITE-TODAY-DR-NO (7)                    2012254
198440                      WMS-KITE-TODAY-DR-AMT (1)                   2012254
198442                      WMS-KITE-TODAY-DR-AMT (2)                   2012254
198444                      WMS-KITE-TODAY-DR-AMT (3)                   2012254
198446                      WMS-KITE-TODAY-DR-AMT (4)                   2012254
198448                      WMS-KITE-TODAY-DR-AMT (5)                   2012254
198450                      WMS-KITE-TODAY-DR-AMT (6)                   2012254
198452                      WMS-KITE-TODAY-DR-AMT (7).                  2012254
198454 INIT-KITE-SUSP-END.                                              2012254
198456     EXIT.                                                        2012254
198458*    COPY IM31BHIN.                                               2012254
198460*                                                                 2012254
198462 INIT-RATE-TRLR.                                                  2012254
198464     PERFORM C2100-CHECK-RATE THRU C2100-CHECK-RATE-EXIT.         0817657
198466     PERFORM C2100-SET-FLAGS THRU C2100-SET-FLAGS-END.            2012254
198468     MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.       2012254
198470*----------------------------------------------------------------*2012254
198472*  INITIALIZE RATE TRAILER FOR FED TAX POINTER                   *2012254
198474*----------------------------------------------------------------*2012254
198476     IF  WMS-TAX-FED-PTR GREATER +0                               2012254
198478         MOVE CRT-FED-TAX-RATES TO WMS-FED-TAX-RATES              2012254
198480         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
198482         PERFORM READ-RATE-TAX-FED THRU READ-RATE-END             2012254
198484         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
198486             MOVE ZEROES TO WMS-TAX-FED-PTR                       2012254
198488             MOVE 'D3' TO IMEX-CODE-2                             2012254
198490             MOVE '060' TO REJRESN                                0717565
198496         ELSE                                                     2012254
198498             MOVE WS-RATE-KEY-LEVEL TO WMS-FED-TAX-RATE-KEY-LEVEL 2012254
198500             MOVE RMA-CUR-TIERED-DT     TO WMS-FED-TAX-CUR-DATE   2012254
198502             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-FED-TAX-CUR-ANN(1) 2012254
198504             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-FED-TAX-CUR-ANN(2) 2012254
198506             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-FED-TAX-CUR-ANN(3) 2012254
198508             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-FED-TAX-CUR-ANN(4) 2012254
198510             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-FED-TAX-CUR-ANN(5) 2012254
198512             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-FED-TAX-CUR-ANN(6) 2012254
198514             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-FED-TAX-CUR-ANN(7) 2012254
198516             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-FED-TAX-CUR-ANN(8) 2012254
198518             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-FED-TAX-CUR-ANN(9) 2012254
198520             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-FED-TAX-CUR-LMT(1) 2012254
198522             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-FED-TAX-CUR-LMT(2) 2012254
198524             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-FED-TAX-CUR-LMT(3) 2012254
198526             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-FED-TAX-CUR-LMT(4) 2012254
198528             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-FED-TAX-CUR-LMT(5) 2012254
198530             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-FED-TAX-CUR-LMT(6) 2012254
198532             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-FED-TAX-CUR-LMT(7) 2012254
198534             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-FED-TAX-CUR-LMT(8) 2012254
198536             MOVE 'Y' TO WMS-FED-TAX-RATE-FLAG                    2012254
198538             IF  WMS-RATE-TRLR NOT EQUAL '1'                      2012254
198540                 MOVE '1' TO WMS-RATE-TRLR                        2012254
198542                 ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH              2012254
198544                 PERFORM C2101A THRU C2101A-END.                  2012254
198546 INIT-RATE-TRLR-TAX-ST.                                           2012254
198548*----------------------------------------------------------------*2012254
198550*  INITIALIZE RATE TRAILER FOR ST TAX POINTER                    *2012254
198552*----------------------------------------------------------------*2012254
198554     IF  WMS-TAX-STATE-PTR GREATER +0                             2012254
198556         MOVE CRT-ST-TAX-RATES TO WMS-ST-TAX-RATES                2012254
198558         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
198560         PERFORM READ-RATE-TAX-ST THRU READ-RATE-END              2012254
198562         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
198564             MOVE ZEROES TO WMS-TAX-STATE-PTR                     2012254
198566             MOVE 'D3' TO IMEX-CODE-2                             2012254
198568             MOVE '060' TO REJRESN                                0717565
198574         ELSE                                                     2012254
198576             MOVE WS-RATE-KEY-LEVEL TO WMS-ST-TAX-RATE-KEY-LEVEL  2012254
198578             MOVE RMA-CUR-TIERED-DT     TO WMS-ST-TAX-CUR-DATE    2012254
198580             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-ST-TAX-CUR-ANN(1)  2012254
198582             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-ST-TAX-CUR-ANN(2)  2012254
198584             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-ST-TAX-CUR-ANN(3)  2012254
198586             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-ST-TAX-CUR-ANN(4)  2012254
198588             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-ST-TAX-CUR-ANN(5)  2012254
198590             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-ST-TAX-CUR-ANN(6)  2012254
198592             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-ST-TAX-CUR-ANN(7)  2012254
198594             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-ST-TAX-CUR-ANN(8)  2012254
198596             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-ST-TAX-CUR-ANN(9)  2012254
198598             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-ST-TAX-CUR-LMT(1)  2012254
198600             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-ST-TAX-CUR-LMT(2)  2012254
198602             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-ST-TAX-CUR-LMT(3)  2012254
198604             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-ST-TAX-CUR-LMT(4)  2012254
198606             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-ST-TAX-CUR-LMT(5)  2012254
198608             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-ST-TAX-CUR-LMT(6)  2012254
198610             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-ST-TAX-CUR-LMT(7)  2012254
198612             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-ST-TAX-CUR-LMT(8)  2012254
198614             MOVE 'Y' TO WMS-ST-TAX-RATE-FLAG                     2012254
198616             IF  WMS-RATE-TRLR NOT EQUAL '1'                      2012254
198618                 MOVE '1' TO WMS-RATE-TRLR                        2012254
198620                 ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH              2012254
198622                 PERFORM C2101B THRU C2101B-END.                  2012254
198624 INIT-RATE-TRLR-TAX-LOC.                                          2012254
198626*----------------------------------------------------------------*2012254
198628*  INITIALIZE RATE TRAILER FOR LOC TAX POINTER                   *2012254
198630*----------------------------------------------------------------*2012254
198632     IF  WMS-TAX-LOCAL-PTR GREATER +0                             2012254
198634         MOVE CRT-LOC-TAX-RATES TO WMS-LOC-TAX-RATES              2012254
198636         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
198638         PERFORM READ-RATE-TAX-LOC THRU READ-RATE-END             2012254
198640         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
198642             MOVE ZEROES TO WMS-TAX-LOCAL-PTR                     2012254
198644             MOVE 'D3' TO IMEX-CODE-2                             2012254
198646             MOVE '060' TO REJRESN                                0717565
198652         ELSE                                                     2012254
198654             MOVE WS-RATE-KEY-LEVEL TO WMS-LOC-TAX-RATE-KEY-LEVEL 2012254
198656             MOVE RMA-CUR-TIERED-DT     TO WMS-LOC-TAX-CUR-DATE   2012254
198658             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-LOC-TAX-CUR-ANN(1) 2012254
198660             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-LOC-TAX-CUR-ANN(2) 2012254
198662             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-LOC-TAX-CUR-ANN(3) 2012254
198664             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-LOC-TAX-CUR-ANN(4) 2012254
198666             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-LOC-TAX-CUR-ANN(5) 2012254
198668             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-LOC-TAX-CUR-ANN(6) 2012254
198670             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-LOC-TAX-CUR-ANN(7) 2012254
198672             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-LOC-TAX-CUR-ANN(8) 2012254
198674             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-LOC-TAX-CUR-ANN(9) 2012254
198676             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-LOC-TAX-CUR-LMT(1) 2012254
198678             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-LOC-TAX-CUR-LMT(2) 2012254
198680             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-LOC-TAX-CUR-LMT(3) 2012254
198682             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-LOC-TAX-CUR-LMT(4) 2012254
198684             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-LOC-TAX-CUR-LMT(5) 2012254
198686             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-LOC-TAX-CUR-LMT(6) 2012254
198688             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-LOC-TAX-CUR-LMT(7) 2012254
198690             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-LOC-TAX-CUR-LMT(8) 2012254
198692             MOVE 'Y' TO WMS-LOC-TAX-RATE-FLAG                    2012254
198694             IF  WMS-RATE-TRLR NOT EQUAL '1'                      2012254
198696                 MOVE '1' TO WMS-RATE-TRLR                        2012254
198698                 ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH              2012254
198700                 PERFORM C2101C THRU C2101C-END.                  2012254
198702 INIT-RATE-TRLR-CONT.                                             2012254
199136*----------------------------------------------------------------*1003625
199137*  INITIALIZE RATE TRAILER FOR DDA PORTION                       *1003625
199138*----------------------------------------------------------------*1003625
199143     IF  WMS-IOD-RATE-PTR EQUAL +0                                0817657
199144     AND WMS-HIFI-INDICATOR EQUAL +0                              0817657
199145         GO TO INIT-RATE-TRLR-END.                                0817657
199146     IF  WMS-LEAP-YEAR-FLG EQUAL '1'                              0817657
199147         MOVE +366 TO DAF-DAYS                                    0817657
199148     ELSE                                                         0817657
199149         MOVE +365 TO DAF-DAYS.                                   0817657
199150     IF  WMS-DAILY-RATE-CODE EQUAL '1'                            0817657
199151         MOVE +360 TO DAF-DAYS.                                   0817657
199152     IF  WMS-DAILY-RATE-CODE EQUAL '3'                            0817657
199153         MOVE +365 TO DAF-DAYS.                                   0627539
199154     IF  (WMS-HIFI-INDICATOR GREATER THAN +0)                     1003625
199156         MOVE CRT-TIER-RATES TO WMS-TIER-RATES                    1003625
199158         MOVE '3' TO WS-RATE-KEY-LEVEL                            1003625
199160         PERFORM READ-RATE-TIER THRU READ-RATE-END                1003625
199161         IF  WS-RATE-NOT-FOUND = 'Y'                              0266796
199162             PERFORM INIT-BALANCE-HISTORY THRU INIT-BAL-HIST-EXIT 0266796
199163             MOVE ZEROES TO WMS-HIFI-INDICATOR                    1003625
199164             MOVE 'D3' TO IMEX-CODE-2                             1003625
199166             MOVE '060' TO REJRESN                                0717565
199168             GO TO K3165                                          1003625
199169         ELSE                                                     9915845
199170             MOVE WS-RATE-KEY-LEVEL    TO WMS-TIER-RATE-KEY-LEVEL 9915845
199171             MOVE RMA-CUR-TIERED-DT    TO WMS-TIER-CUR-DATE       9915845
199172             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-TIER-CUR-ANN(1)    9915845
199173             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-TIER-CUR-ANN(2)    9915845
199174             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-TIER-CUR-ANN(3)    9915845
199175             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-TIER-CUR-ANN(4)    9915845
199176             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-TIER-CUR-ANN(5)    9915845
199177             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-TIER-CUR-ANN(6)    9915845
199178             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-TIER-CUR-ANN(7)    9915845
199179             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-TIER-CUR-ANN(8)    9915845
199180             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-TIER-CUR-ANN(9)    9915845
199181             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-TIER-CUR-LMT(1)    9915845
199182             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-TIER-CUR-LMT(2)    9915845
199183             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-TIER-CUR-LMT(3)    9915845
199184             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-TIER-CUR-LMT(4)    9915845
199185             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-TIER-CUR-LMT(5)    9915845
199186             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-TIER-CUR-LMT(6)    9915845
199187             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-TIER-CUR-LMT(7)    9915845
199188             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-TIER-CUR-LMT(8)    9915845
199189             MOVE RMA-PREV-TIERED-DT    TO WMS-TIER-PREV-DATE     9916251
199190             MOVE RMA-PREV-TIERED-ANN(1) TO WMS-TIER-PREV-ANN(1)  9915845
199191             MOVE RMA-PREV-TIERED-ANN(2) TO WMS-TIER-PREV-ANN(2)  9915845
199192             MOVE RMA-PREV-TIERED-ANN(3) TO WMS-TIER-PREV-ANN(3)  9915845
199193             MOVE RMA-PREV-TIERED-ANN(4) TO WMS-TIER-PREV-ANN(4)  9915845
199194             MOVE RMA-PREV-TIERED-ANN(5) TO WMS-TIER-PREV-ANN(5)  9915845
199195             MOVE RMA-PREV-TIERED-ANN(6) TO WMS-TIER-PREV-ANN(6)  9915845
199196             MOVE RMA-PREV-TIERED-ANN(7) TO WMS-TIER-PREV-ANN(7)  9915845
199197             MOVE RMA-PREV-TIERED-ANN(8) TO WMS-TIER-PREV-ANN(8)  9915845
199198             MOVE RMA-PREV-TIERED-ANN(9) TO WMS-TIER-PREV-ANN(9)  9915845
199199             MOVE RMA-PREV-TIERED-LMT(1) TO WMS-TIER-PREV-LMT(1)  9915845
199200             MOVE RMA-PREV-TIERED-LMT(2) TO WMS-TIER-PREV-LMT(2)  9915845
199201             MOVE RMA-PREV-TIERED-LMT(3) TO WMS-TIER-PREV-LMT(3)  9915845
199202             MOVE RMA-PREV-TIERED-LMT(4) TO WMS-TIER-PREV-LMT(4)  9915845
199203             MOVE RMA-PREV-TIERED-LMT(5) TO WMS-TIER-PREV-LMT(5)  9915845
199204             MOVE RMA-PREV-TIERED-LMT(6) TO WMS-TIER-PREV-LMT(6)  9915845
199205             MOVE RMA-PREV-TIERED-LMT(7) TO WMS-TIER-PREV-LMT(7)  9915845
199206             MOVE RMA-PREV-TIERED-LMT(8) TO WMS-TIER-PREV-LMT(8)  9915845
199207             PERFORM CALC-TIER-CUR-DAF                            9915845
199208                THRU CALC-TIER-PREV-DAF-EXIT                      9915845
199209             PERFORM VERIFY-YR-BOUNDRY-FOR-TIER                   9915845
199210                THRU VERIFY-TIER-EXIT                             9915845
199211             MOVE 'Y' TO WMS-DDA-RATE-FLAG                        9915845
199212             MOVE '1' TO WMS-RATE-TRLR                            9915845
199213             ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                  9915845
199214             PERFORM C2101 THRU C2101-END                         9915845
199215             GO TO INIT-DFLT.                                     9915845
199216                                                                  9915845
199217     IF  (WMS-IOD-RATE-PTR GREATER THAN +0)                       9915845
199218         MOVE CRT-IOD-RATES TO WMS-IOD-RATES                      9915845
199219         MOVE '3' TO WS-RATE-KEY-LEVEL                            9915845
199220         PERFORM READ-RATE-IOD THRU READ-RATE-END                 9915845
199221         IF  WS-RATE-NOT-FOUND = 'Y'                              9915845
199222             PERFORM INIT-BALANCE-HISTORY THRU INIT-BAL-HIST-EXIT 0266796
199223             MOVE ZEROES TO WMS-IOD-RATE-PTR                      0266796
199224             MOVE 'D3' TO IMEX-CODE-2, MOVE '060' TO REJRESN      0717565
199225             GO TO K3165                                          9915845
199226         ELSE                                                     9915845
199227             MOVE WS-RATE-KEY-LEVEL TO WMS-IOD-RATE-KEY-LEVEL     9915845
199228             MOVE RMA-CUR-ILO-DT    TO WMS-IOD-CUR-DATE           9915845
199229             MOVE RMA-CUR-ILO-ANN   TO WMS-IOD-CUR-ANN            9915845
199230             MOVE RMA-PREV-ILO-DT   TO WMS-IOD-PREV-DATE          9915845
199231             MOVE RMA-PREV-ILO-ANN  TO WMS-IOD-PREV-ANN           9915845
199232             PERFORM CALC-DAF-DAYS-DDA                            9915845
199233                THRU CALC-DAF-DAYS-DDA-EXIT                       9915845
199234             PERFORM CALC-IOD-CUR-DAF THRU CALC-IOD-PREV-DAF-EXIT 9915845
199235             PERFORM VERIFY-YR-BOUNDRY-FOR-IOD                    9915845
199236                THRU VERIFY-IOD-EXIT                              9915845
199237*----------------------------------------------------------------*9915845
199238*    ALLOW IOD ACCOUNTS TO HAVE A ZERO INTEREST RATE             *9915845
199239*----------------------------------------------------------------*9915845
199240*            IF  WMS-IOD-CUR-ANN EQUAL TO ZERO                    9915845
199241*                MOVE 'D3' TO IMEX-CODE-2                         9915845
199242*                MOVE '061' TO REJRESN                            0717565
199243*                GO TO K3165                                      9915845
199244*            ELSE                                                 9915845
199245                 MOVE 'Y' TO WMS-DDA-RATE-FLAG                    9915845
199246                 MOVE '1' TO WMS-RATE-TRLR                        9915845
199247                 PERFORM C2102 THRU C2102-END                     9915845
199248                 ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH.             9915845
199249                                                                  9915845
199250 INIT-DFLT.                                                       9915845
199251* FIND THE DEFAULT IOD RATE FOR ACCOUNT.                          9915845
199252     MOVE 'I' TO WRK-TYPE.                                        9915845
199253     MOVE 001 TO WRK-PTR.                                         9915845
199254     MOVE '3' TO WS-RATE-KEY-LEVEL.                               9915845
199255     PERFORM READ-RATE-MASTER THRU READ-RATE-END.                 9915845
199256     IF  WS-RATE-NOT-FOUND = 'Y'                                  1003625
199257         MOVE 'D3' TO IMEX-CODE-2, MOVE '060' TO REJRESN          0717565
199258         PERFORM INIT-BALANCE-HISTORY THRU INIT-BAL-HIST-EXIT     0266796
199259         MOVE CRT-DFLT-IOD-CUR-DATA                               9915845
199260                                TO WMS-DFLT-IOD-CUR-DATA          9915845
199261         MOVE CRT-DFLT-IOD-PREV-DATA                              9915845
199262                                TO WMS-DFLT-IOD-PREV-DATA         9915845
199263         MOVE DEFAULT-RATE-NOT-FND-LIT(SIWS-LANG-SUB)             0266741
199264                                TO EX09-GEN-DESC                  9915845
199265         GO TO K3165                                              9915845
199266     ELSE                                                         9915845
199267         MOVE RMA-CUR-ILO-DT    TO WMS-DFLT-IOD-CUR-DATE          9915845
199268         MOVE RMA-CUR-ILO-ANN   TO WMS-DFLT-IOD-CUR-ANN           9915845
199269         MOVE RMA-PREV-ILO-DT   TO WMS-DFLT-IOD-PREV-DATE         9915845
199270         MOVE RMA-PREV-ILO-ANN  TO WMS-DFLT-IOD-PREV-ANN          9915845
199271         PERFORM CALC-DAF-DAYS-DDA                                9915845
199272            THRU CALC-DAF-DAYS-DDA-EXIT                           1003625
199274         PERFORM CALC-DFLT-IOD-CUR-DAF                            1003625
199276            THRU CALC-DFLT-IOD-PREV-DAF-EXIT                      1003625
199278         PERFORM VERIFY-YR-BOUNDRY-FOR-DFLT-IOD                   1003625
199280                THRU VERIFY-DFLT-IOD-EXIT                         1003625
199281         PERFORM C2102A THRU C2102A-END.                          1003625
199282         MOVE '1' TO WMS-EXPANSION-IND.                           1003625
199283 INIT-RATE-TRLR-END.                                              1003625
199284     EXIT.                                                        1003625
199290*                                                                 9715591
199292     COPY IM31BHIN.                                               9715591
199294*                                                                 9715591
199300 K0015.                                                           1003625
199305     GO TO Q4500.                                                 1003625
199310 K0020.                                                           1003625
199315     IF NEW-MASTER-SW EQUAL TO '1', GO TO K0040.                  1003625
199320* --                                                              1003625
199325* -- WHEN THE 'IM-MEMO-OL-NEW-ACCT' IS ON, A NEW ACCOUNT WAS ADDED1003625
199330* -- ONLINE, BUT NO NEW ACCOUNT TRANSACTION WAS SENT TO BATCH.    IM003
199360* -- THE ACCOUNT SHOULD BE DELETED FROM THE MASTER, MEMO, AND     IM003
199390* -- ALPHA FILES AND ALL OF ITS TRANSACTIONS SHOULD BE REJECTED   IM003
199420* -- WITH AN "ACCOUNT NOT FOUND" MESSAGE.                         IM003
199450* --
199480     IF  SI-88-ENVIRONMENT-ONLINE                                 IM003
199510     AND IM-MEMO-OL-NEW-ACCT                                      IM003
199540         MOVE '1' TO OL-DELETE-SW                                 IM003
199570         MOVE '1' TO ACCT-NOT-FOUND                               IM003
199580         MOVE '0' TO WS-OD-LIMIT-MATCH-SW                         9915855
199800     ELSE
199850         IF  SKIP-READ-SW EQUAL TO '0'
199900             NEXT SENTENCE
199950         ELSE
199960             MOVE '0' TO WS-OD-LIMIT-MATCH-SW                     9915855
200000             MOVE '1' TO ACCT-NOT-FOUND.
200002******************************************************************9915845
200003***   IBT-ACCT-IND VALUES AND MEANINGS ARE:                       9915845
200004***    0 - NOT AN IBT ACCOUNT                                     9915845
200005***    1 - IBT ACCOUNT AWAITING CONFIRMATION (OLD OR NEW ACCT)    9915845
200006***    2 - OLD IBT ACCOUNT AWAITING PURGE (EXPIRATION OF RET DAYS)9915845
200007***    3 - OLD IBT ACCOUNT ON DAY OF CONFIRMATION AFTER CONFIRMED 9915845
200009******************************************************************9915845
200010     IF  IBT-ACCT-IND EQUAL '0'                                   9915845
200015         GO  TO  K0040.                                           9915845
200020     IF  IBT-ACCT-IND EQUAL '1'                                   9915845
200025         IF  WMS-IBT-FLAG EQUAL '1'                               9915845
200030             PERFORM X1100-RESET-IBT THRU X1100-EXIT              9915845
200035             GO  TO  K0040                                        9915845
200040         ELSE                                                     9915845
200050             MOVE '44' TO IMEX-REC-NO                             9915845
200055             MOVE 'IB' TO IMEX-CODE-1                             9915845
200060             MOVE 'IH' TO IMEX-CODE-2                             9915857
200065             MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20      9915845
200070             MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                   9915845
200072             MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT      9915845
200073             MOVE TR-CLASS          TO EX44-CLASS                 9915857
200074             MOVE TR-SOURCE         TO EX44-SOURCE                9915857
200075             MOVE TR-BATCH          TO EX44-BATCH                 9915857
200076             MOVE TR-SEQ            TO EX44-SEQ                   9915857
200077             MOVE TR-TRACE          TO EX44-TRACE                 9915857
200078             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT              9915857
200080             MOVE '086' TO REJRESN                                0717565
200081             IF  TR-CLASS EQUAL '80'                              9915845
200082                 GO  TO  K0045                                    9915845
200083             ELSE                                                 9915845
200085                 GO  TO  K0025.                                   9915845
200090     IF  IBT-ACCT-IND EQUAL '3'                                   9915845
200095         IF  (TR-CLASS EQUAL '20' OR '95')                        9915845
200100         AND (TR-FM-FLD-NO EQUAL '0904' OR '1093' OR '1094'       2016536
200103         OR '1887' OR '1888' OR '0140')                           2016536
200105             GO  TO  K0040                                        9915845
200110         ELSE                                                     9915845
200115         IF  (TR-CLASS EQUAL '97' OR '98' OR '78')                9915845
200117             MOVE '1' TO TR-SCLASS1                               9915845
200120             GO  TO  K0040                                        9915845
200125         ELSE                                                     9915845
200130         IF  (TR-CLASS EQUAL '20'                                 9915845
200135         AND  TR-SCLASS1 EQUAL '1'                                9915845
200140         AND (TR-FM-FLD-NO EQUAL '0008' OR '0265' OR              9915845
200145                                  '0495' OR '0947'))              9915845
200150             PERFORM UNPOST-EXCEPT                                9915845
200155             GO  TO  END-UNPOST                                   9915845
200160         ELSE                                                     9915845
200165             MOVE '086' TO REJRESN                                0717565
200170             MOVE '44' TO IMEX-REC-NO                             9915845
200175             MOVE 'IB' TO IMEX-CODE-1                             9915845
200180             MOVE 'IH' TO IMEX-CODE-2                             9915845
200185             MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20      9915845
200190             MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                   9915845
200192             MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT      9915845
200194             MOVE TR-CLASS          TO EX44-CLASS                 9915845
200196             MOVE TR-SOURCE         TO EX44-SOURCE                9915845
200198             MOVE TR-BATCH          TO EX44-BATCH                 9915845
200200             MOVE TR-SEQ            TO EX44-SEQ                   9915845
200202             MOVE TR-TRACE          TO EX44-TRACE                 9915845
200204             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT              9915845
200205             IF  TR-CLASS EQUAL '80'                              9915845
200206                 GO  TO  K0045                                    9915845
200207             ELSE                                                 9915845
200208                 GO  TO  K0025.                                   9915845
200240     IF  (TR-CLASS EQUAL '20' OR '95')                            9915845
200245     AND (TR-FM-FLD-NO EQUAL '0904' OR '1093' OR '1094'           2016536
200247         OR '1887' OR '1888' OR '0140')                           2016536
200250         GO  TO  K0040.                                           9915845
200255     IF (TR-CLASS EQUAL '97' OR '98' OR '78' OR '79')             9915857
200257     OR (TR-CLASS EQUAL '99' AND  TR-SUB-CLASS EQUAL '50')        9915857
200260         GO  TO  K0040.                                           9915845
200265     MOVE '086' TO REJRESN.                                       0717565
200270     MOVE '44' TO IMEX-REC-NO.                                    9915845
200275     MOVE 'IB' TO IMEX-CODE-1.                                    9915845
200280     MOVE 'IH' TO IMEX-CODE-2.                                    9915845
200282     MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20.             9915845
200284     MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1.                          9915845
200286     MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT.             9915845
200288     MOVE TR-CLASS          TO EX44-CLASS                         9915845
200290     MOVE TR-SOURCE         TO EX44-SOURCE.                       9915845
200292     MOVE TR-BATCH          TO EX44-BATCH.                        9915845
200294     MOVE TR-SEQ            TO EX44-SEQ.                          9915845
200296     MOVE TR-TRACE          TO EX44-TRACE.                        9915845
200298     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     9915845
200300     IF  TR-CLASS EQUAL '80'                                      9915845
200301         GO  TO  K0045.                                           9915845
200302 K0025.                                                           9915845
200303     IF  TR-CLASS EQUAL '20' OR '95'                              9915845
200304         MOVE TR-FILE-MAINT TO EX09-REMAINDER                     9915845
200305         ADD +1 TO DDA-MAINT-REJ                                  9915845
200306     ELSE                                                         9915845
200307     IF  TR-CLASS EQUAL '60' OR '61'                              9915845
200308         MOVE TR-MEMO-TRANS TO EX09-REMAINDER                     9915845
200309     ELSE                                                         9915845
200310         MOVE TR-FILE-MAINT TO EX09-REMAINDER.                    9915845
200315     GO  TO  K3165.                                               9915845
200320     SKIP3                                                        9915845
200321*    ******************************************************       9915845
200322*    *            MONETARY (DB/CR) TRANSACTIONS           *       9915845
200323*    ******************************************************       9915845
200324     SKIP3                                                        9915845
200325 K0040.                                                           9915845
200330     IF  TR-CLASS NOT EQUAL '80', GO TO K2000.                    9915845
200332     IF  TR-IBT-TRANSFER-REC EQUAL '1'                            9915845
200334         IF  TR-TRAN-TYPE EQUAL '1' OR '2'                        9915845
200336             ADD +1 TO IBT-DDA-CR-NO-IN                           9915845
200338             ADD TR-AMOUNT TO IBT-DDA-CR-AMT-IN                   9915845
200340         ELSE                                                     9915845
200342         IF  TR-TRAN-TYPE EQUAL '3' OR '4'                        9915845
200344             ADD +1 TO IBT-DDA-DR-NO-IN                           9915845
200346             ADD TR-AMOUNT TO IBT-DDA-DR-AMT-IN                   9915845
200348         ELSE                                                     9915845
200350         IF  TR-TRAN-TYPE EQUAL '5'                               9915845
200352             ADD +1 TO IBT-LON-CR-NO-IN                           9915845
200354             ADD TR-AMOUNT TO IBT-LON-CR-AMT-IN                   9915845
200356         ELSE                                                     9915845
200358         IF  TR-TRAN-TYPE EQUAL '6'                               9915845
200360             ADD +1 TO IBT-LON-DR-NO-IN                           9915845
200362             ADD TR-AMOUNT TO IBT-LON-DR-AMT-IN                   9915845
200364         ELSE                                                     9915845
200366         IF  TR-TRAN-TYPE EQUAL '7'                               9915845
200368             ADD +1 TO IBT-SAV-CR-NO-IN                           9915845
200370             ADD TR-AMOUNT TO IBT-SAV-CR-AMT-IN                   9915845
200372         ELSE                                                     9915845
200374         IF  TR-TRAN-TYPE EQUAL '8'                               9915845
200376             ADD +1 TO IBT-SAV-DR-NO-IN                           9915845
200378             ADD TR-AMOUNT TO IBT-SAV-DR-AMT-IN.                  9915845
200379*                                                                 9915845
200380     IF  IBT-NEW-FLAG EQUAL '1'                                   9915845
200382         MOVE '086' TO REJRESN                                    0717565
200384         MOVE '44' TO IMEX-REC-NO                                 9915845
200386         MOVE 'IB' TO IMEX-CODE-1                                 9915845
200388         MOVE 'IH' TO IMEX-CODE-2                                 9915845
200392         MOVE SPACES            TO EX44-IBT-OLD-NEW-ACCT          9915845
200394         MOVE TR-CLASS          TO EX44-CLASS                     9915845
200396         MOVE TR-SOURCE         TO EX44-SOURCE                    9915845
200398         MOVE TR-BATCH          TO EX44-BATCH                     9915845
200400         MOVE TR-SEQ            TO EX44-SEQ                       9915845
200402         MOVE TR-TRACE          TO EX44-TRACE                     9915845
200404         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  9915845
200406         GO  TO  K0045.                                           9915845
200420     IF  ACCT-NOT-FOUND EQUAL '1'                                 9915845
200425         MOVE GL-CURRENT-COST-CTR TO SAV-GL-CURRENT-COST-CTR      9915845
200430         MOVE 'N' TO GL-BUILD-MASTER-SW                           9915845
200434         PERFORM K5700 THRU K5700-EXIT                            9915845
200438         PERFORM C1009 THRU C1009-EXIT                            9915845
200439         MOVE TR-KEY  TO  WK-GL-ORIG-ACCT                         9915845
200440         MOVE TRN-NOT-FND-COST-CTR TO GL-CURRENT-COST-CTR.        2016639
200441*                                                                 2016639
200442*--------------------------------------------------------------*  2016639
200443*    EXTERNAL INVESTMENT LINK INDICATOR CHANGED TODAY          *  2016639
200444*--------------------------------------------------------------*  2016639
200445     IF  FM-TODAY EQUAL '1'                                       2016639
200446     AND (WXI-LINK-IND-IN NOT EQUAL  WXI-LINK-IND-OUT)            2016639
200447         PERFORM K5900-XINV    THRU  K5900-EXIT.                  2016639
200448*                                                                 2016639
200450******************************************************************9915845
200455***  IF ACCOUNT HAS HAD FILE MAINTENANCE, CHECK COST CENTER CODE *9915845
200460     IF  FM-TODAY EQUAL '1'                                       9915845
200465         MOVE '0' TO FM-TODAY                                     9915845
200470         MOVE 'Y' TO GL-BUILD-MASTER-SW                           9915845
200475         PERFORM K5700 THRU K5700-EXIT                            9915845
200480         PERFORM K5750-REGION-CALC THRU K5750-EXIT                9915845
200485         PERFORM R0015-FM-DDA THRU R0015-FM-OD-END.               9915845
200487******************************************************************9915845
200490***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE INCOMING   IM002
200580***  MONETARY TRANSACTIONS PRIOR TO POSTING.                      IM002
200670***                                                               IM002
200760***  COPY IM31UBWR.                                               IM002
200850***                                                               IM002
200940***  END OF USER EXIT.                                            IM002
201030******************************************************************IM002
201300     IF  TR-POST-PRIORITY EQUAL '3A' OR '0A'
201350         GO  TO  K2500.
201357*----------------------------------------------------------------*9915749
201375*    ALL TBA PROCESSING HAS BEEN MOVED TO IM30.                  *9915749
201378*----------------------------------------------------------------*9915749
201385*    IF  (TR-SOURCE EQUAL '28' AND TR-80-TYPE EQUAL '01')         9915749
201392*        PERFORM X5000-TARGET-TOTALS THRU X5000-EXIT.             9915749
201400     IF ACCT-NOT-FOUND EQUAL TO '0', GO TO K0050.
201450     MOVE '002' TO REJRESN.                                       0717565
201500 K0045.
201550     IF STOP-HIT-FLAG EQUAL TO '1'
201560     OR HAF-HIT-FLAG EQUAL TO '1'                                 0902008
201600         MOVE '0' TO STOP-HIT-FLAG
201610                     HAF-HIT-FLAG                                 0902008
201650         MOVE 'A4' TO EXCODE-2.
201660     GO TO K0070.                                                 0617360
201670 K0050.                                                           0617360
201696     INSPECT TR-PLN-CAL-YR REPLACING ALL ' ' BY '0'.              0617360
201697     INSPECT TR-PLN-TAX-YR REPLACING ALL ' ' BY '0'.              0617360
201698     MOVE TR-AMOUNT              TO WS-WORK-CTDT-AMT.             0617360
201699     MOVE TR-COMB-PLN-CODES      TO WS-WORK-COMB-PLN-CODES.       0617360
201700     MOVE TR-PLN-CAL-YR          TO WS-WORK-CAL-YR.               0617360
201701     MOVE TR-PLN-TAX-YR          TO WS-WORK-TAX-YR.               0617360
201702     MOVE '0'                    TO WS-WORK-TAX-CODE.             0617360
201712     MOVE '0'                    TO DDA-CLOSING-TRAN-FLAG.        0417110
201714*----------------------------------------------------------------*0417110
201716*    CHECK ONLY FOR DEFAULT VALUES                               *0417110
201718*----------------------------------------------------------------*0417110
201724     MOVE WMS-CHK-TRUNC-FLAG TO TR-CHK-TRUNC-FLAG.                0727499
201726     MOVE '1' TO TRAN-REWRITE-SW.                                 0727499
201728     IF  WMS-BULK-FILE GREATER THAN '0'                           0417110
201730         MOVE WMS-STMT-PULL TO TR-STMT-PULL                       0417110
201732         MOVE WMS-STMT-FLD1 TO TR-STMT-CYCLE                      0417110
201734         MOVE WMS-BULK-FILE TO TR-BULK-FILE                       0417110
201736         MOVE '1'           TO TRAN-REWRITE-SW.                   0417110
201757*----------------------------------------------------------------*1105504
201758*    PROCESS STOP SUSPECTS AS EXCEPTION 13 RECORDS BUT STILL     *1105504
201759*    POST THE TRANSACTION.                                       *1105504
201760*----------------------------------------------------------------*1105504
201761     IF  STOP-HIT-FLAG EQUAL TO '1'                               1105504
201762         IF  TR-REJ-RESN EQUAL 'SU '                              0817735
201763             PERFORM X0710-STOP-SUSPECTS THRU X0710-EXIT          9915749
201764         ELSE                                                     9915749
201765             MOVE '012' TO REJRESN                                0717565
201766             GO TO K0045.                                         1105504
201767     IF  HAF-HIT-FLAG EQUAL TO '1'                                1105504
201768         MOVE '056' TO REJRESN                                    0717565
201769         GO TO K0045.                                             1105504
201770     IF  TR-TRAN-TYPE EQUAL '2'                                   9915845
201771     AND (TR-OPTION (11) EQUAL '1' OR '3' OR '5' OR '7')          1105504
201772         IF  WMS-STATUS NOT EQUAL '05' AND '08' AND '99'          1105504
201773             MOVE '1'            TO DDA-CLOSING-TRAN-FLAG         1105504
201774             GO TO K1990-CLOSE.                                   1105504
201775     IF  TR-TRAN-TYPE EQUAL '4'                                   9915845
201780     AND (TR-OPTION (12) EQUAL '4' OR '6' OR '7')                 1105504
201785         IF  WMS-STATUS NOT EQUAL '05' AND '08' AND '99'          1105504
201787             MOVE '1'            TO DDA-CLOSING-TRAN-FLAG         1105504
201788             GO TO K1990-CLOSE.                                   2012254
201789     MOVE +0 TO TAX-CALC-AMOUNT                                   2012254
201790                TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.          2012254
201792     IF  (SAV-BKUP-WTHLD-FLAG EQUAL '1' OR '2' OR '3')            2016055
201793         NEXT SENTENCE                                            1105504
201796     ELSE                                                         IM007
201798         GO TO K0053-SAV.                                         IM007
201799     IF  (WMS-STATUS EQUAL '05' OR '08' OR '99')                  IM007
201800         GO TO K0053-CONTINUE.                                    IM007
201801     IF  TR-TRAN-TYPE EQUAL '3' OR '4'                            9915845
201802         NEXT SENTENCE                                            IM007
201803     ELSE                                                         2016055
201804         GO TO K0053-SAV.                                         2016055
201805     IF  SAV-BKUP-WTHLD-FLAG EQUAL '1' AND                        2016055
201806         TR-AMOUNT LESS +500.00                                   2016055
201807         GO TO K0053-CONTINUE.                                    2016055
201808     IF  TR-TRAN-TYPE EQUAL '3'                                   2012254
201809     AND (LIST-POST-DR-FLAG EQUAL '1' OR '2')                     0827768
201810         IF  (TR-OPTION (5) EQUAL '1' OR '3' OR '5' OR '7')       2012254
201811         AND (TR-80-TYPE NOT EQUAL '06' AND '08' AND '12' AND     2012254
201812                                   '13' AND '14')                 2012254
201813             GO TO K0053-CONTINUE.                                2012254
201814     IF  TR-TRAN-TYPE EQUAL '4'                                   0827768
201815     AND LIST-POST-DR-FLAG   EQUAL '2'                            0827768
201816         IF  (TR-OPTION (19) EQUAL '1')                           0827768
201817         AND (TR-80-TYPE NOT EQUAL '06' AND '08' AND '12' AND     0827768
201818                                   '13' AND '14')                 0827768
201819             GO TO K0053-CONTINUE.                                0827768
201820     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        0827768
201821     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         0827768
201822         MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT                 0827768
201823         PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT      0827768
201824         SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX           0827768
201826     ELSE                                                         2011366
201827         MOVE ZERO TO TAX-CALC-AMOUNT.                            2011366
201831* * * DO THE SAV PART * * *                                       2011366
201837     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
201838         GO TO K0053-CONTINUE.                                    IM007
201840     IF  WMS-SAV-PEND-TAX GREATER THAN +0                         2011366
201842             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             2011366
201843             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
201844             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
201845     ELSE                                                         2011366
201847             MOVE ZERO             TO TAX-CALC-AMOUNT.            2011366
201853     GO TO K0053-CONTINUE.                                        IM007
201860 K0053-SAV.                                                       IM007
201862     IF  TR-TRAN-TYPE NOT EQUAL '8'                               9915845
201863         GO TO K0053-CONTINUE.                                    IM007
201864     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM007
201866     AND WMS-INT-STATUS LESS THAN '7'                             IM007
201868     AND (SAV-BKUP-WTHLD-FLAG EQUAL '1' OR '2' OR '3')            IM007
201870         NEXT SENTENCE                                            IM007
201874     ELSE                                                         IM007
201876         GO TO K0053-CONTINUE.                                    IM007
201877     IF  (SAV-BKUP-WTHLD-FLAG EQUAL '2' OR '3')                   IM007
201878     OR  ((TR-OPTION (5)  EQUAL '1' OR '3' OR '5' OR '7')         IM007
201879     AND SAV-BKUP-WTHLD-FLAG EQUAL '1') OR                        2016055
201880         (SAV-BKUP-WTHLD-FLAG EQUAL '1' AND                       2016055
201881         TR-AMOUNT GREATER +499.99)                               2016055
201884         NEXT SENTENCE                                            IM007
201886     ELSE                                                         IM007
201888         GO TO K0053-CONTINUE.                                    IM007
201889     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
201890     IF  WMS-SAV-PEND-TAX GREATER THAN +0                         IM007
201892             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             2011366
201894             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
201896             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
201905     ELSE                                                         IM007
201906         MOVE ZERO TO TAX-CALC-AMOUNT.                            IM007
201907* * * DO THE IOD PART * * *                                       2011366
201919     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         2011366
201920         MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT                 2011366
201921         PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT      2011366
201922         SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX           2011366
201923     ELSE                                                         2011366
201924         MOVE ZERO TO TAX-CALC-AMOUNT.                            2011366
201927     GO TO K0053-CONTINUE.                                        IM007
201929     SKIP3                                                        IM007
201930 K0053-IOD-TAX-GT.                                                IM007
201931     IF  TAX-CALC-AMOUNT NOT GREATER THAN ZERO                    IM007
201932         NEXT SENTENCE                                            2012254
201933     ELSE                                                         2012254
201934         MOVE TAX-CALC-AMOUNT TO HOLD-AMT                         2012254
201935         MOVE '4' TO EX01-TYPE                                    2012254
201936         MOVE '1' TO EX01-TAX-TYPE                                2012254
201937         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
201938         ADD +1 TO IOD-TAX-NO WS-GL-IOD-TAX-NO WMS-STMT-NO-DEBITS 2012254
201939         ADD TAX-CALC-AMOUNT TO IOD-TAX-AMT, WS-GL-IOD-TAX-AMT    2012254
201940                      WMS-STMT-DR-AMT   WMS-IOD-YTD-TAX           2012254
201941                      WMS-IOD-CYC-TAX   WMS-IOD-MTD-TAX           2012254
201942         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
201943             ADD TAX-CALC-AMOUNT TO WMS-DUAL-YR-CUR-IOD-FED.      2012254
201944     IF  TAX-CALC-AMOUNT-ST NOT GREATER THAN ZERO                 2012254
201945         NEXT SENTENCE                                            2012254
201946     ELSE                                                         2012254
201947         MOVE TAX-CALC-AMOUNT-ST TO HOLD-AMT                      2012254
201948         MOVE '4' TO EX01-TYPE                                    2012254
201949         MOVE '2' TO EX01-TAX-TYPE                                2012254
201950         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
201951         ADD +1 TO IOD-TAX-NO-ST, WS-GL-IOD-TAX-ST-NO             2012254
201952                   WMS-STMT-NO-DEBITS                             2012254
201953         ADD TAX-CALC-AMOUNT-ST      TO IOD-TAX-AMT-ST            2012254
201954                 WS-GL-IOD-TAX-ST-AMT   WMS-STMT-DR-AMT           2012254
201955                 WMS-IOD-YTD-STATE-TAX  WMS-IOD-CYC-STATE-TAX     2012254
201956                 WMS-IOD-MTD-STATE-TAX                            2012254
201957         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
201958             ADD TAX-CALC-AMOUNT-ST TO WMS-DUAL-YR-CUR-IOD-STATE. 2012254
201959     IF  TAX-CALC-AMOUNT-LOC NOT GREATER THAN ZERO                2012254
201960         GO TO K0053-IOD-TAX-GT-EXIT.                             2012254
201961     MOVE TAX-CALC-AMOUNT-LOC TO HOLD-AMT.                        2012254
201962     MOVE '4' TO EX01-TYPE.                                       2012254
201963     MOVE '3' TO EX01-TAX-TYPE.                                   2012254
201964     PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT.                  2012254
201965     ADD +1 TO IOD-TAX-NO-LOC, WS-GL-IOD-TAX-LOC-NO               2012254
201966               WMS-STMT-NO-DEBITS.                                2012254
201967     ADD TAX-CALC-AMOUNT-LOC     TO IOD-TAX-AMT-LOC               2012254
201968             WS-GL-IOD-TAX-LOC-AMT  WMS-STMT-DR-AMT               2012254
201969             WMS-IOD-YTD-LOCAL-TAX  WMS-IOD-CYC-LOCAL-TAX         2012254
201970             WMS-IOD-MTD-LOCAL-TAX.                               2012254
201971     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
201972         ADD TAX-CALC-AMOUNT-LOC TO WMS-DUAL-YR-CUR-IOD-LOCAL.    2012254
201973 K0053-IOD-TAX-GT-EXIT.                                           2012254
201974     EXIT.                                                        2012254
201975     SKIP3                                                        2012254
201976 K0053-SAV-TAX-GT.                                                2012254
201977     IF  TAX-CALC-AMOUNT NOT GREATER THAN ZERO                    2012254
201978         GO TO K0053-SAV-TAX-GT-ST.                               2012254
201979     MOVE TAX-CALC-AMOUNT TO HOLD-AMT.                            2012254
201980     MOVE '8' TO EX01-TYPE.                                       2012254
201981     MOVE '1' TO EX01-TAX-TYPE.                                   2012254
201982     PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT.                  2012254
201983     ADD +1 TO WMS-INT-DR-NUMBER.                                 2012254
201984     ADD TAX-CALC-AMOUNT TO WMS-INT-DR-AMT    WMS-YTD-SAV-TAX     2012254
201985                            WMS-INT-TAX       WMS-INT-MTD-TAX.    2012254
201986     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
201987         ADD TAX-CALC-AMOUNT TO INV-TAX-COLL-TDY                  2012254
201988                                WS-GL-INV-TAX-COLL-TDY            2012254
201989     ELSE                                                         2012254
201990         ADD +1              TO SAV-TAX-NO                        2012254
201991                                WS-GL-SAV-TAX-NO                  2012254
201992         ADD TAX-CALC-AMOUNT TO SAV-TAX-AMT                       2012254
201993                                WS-GL-SAV-TAX-AMT.                2012254
201994     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
201995         ADD TAX-CALC-AMOUNT TO WMS-DUAL-YR-CUR-SAV-FED.          2012254
201996 K0053-SAV-TAX-GT-ST.                                             2012254
201997     IF  TAX-CALC-AMOUNT-ST NOT GREATER THAN ZERO                 2012254
201998         GO TO K0053-SAV-TAX-GT-LOC.                              2012254
201999     MOVE TAX-CALC-AMOUNT-ST TO HOLD-AMT.                         2012254
202000     MOVE '8' TO EX01-TYPE.                                       2012254
202001     MOVE '2' TO EX01-TAX-TYPE.                                   2012254
202002     PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT.                  2012254
202003     ADD +1 TO WMS-INT-DR-NUMBER.                                 2012254
202004     ADD TAX-CALC-AMOUNT-ST TO WMS-INT-DR-AMT WMS-INT-TAX-STATE   2012254
202005                 WMS-YTD-SAV-STATE-TAX   WMS-INT-MTD-STATE-TAX.   2012254
202006     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
202007         ADD TAX-CALC-AMOUNT-ST TO INV-TAX-COLL-TDY-ST            2012254
202008                                   WS-GL-INV-TAX-COLL-TDY-ST      2012254
202009     ELSE                                                         2012254
202010         ADD +1      TO SAV-TAX-NO-ST    WS-GL-SAV-TAX-ST-NO      2012254
202011         ADD TAX-CALC-AMOUNT-ST TO SAV-TAX-AMT-ST                 2012254
202012                                   WS-GL-SAV-TAX-ST-AMT.          2012254
202013     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
202014         ADD TAX-CALC-AMOUNT-ST TO WMS-DUAL-YR-CUR-SAV-STATE.     2012254
202015 K0053-SAV-TAX-GT-LOC.                                            2012254
202016     IF  TAX-CALC-AMOUNT-LOC NOT GREATER THAN ZERO                2012254
202017         GO TO K0053-SAV-TAX-GT-EXIT.                             2012254
202018     MOVE TAX-CALC-AMOUNT-LOC TO HOLD-AMT.                        2012254
202019     MOVE '8' TO EX01-TYPE.                                       2012254
202020     MOVE '3' TO EX01-TAX-TYPE.                                   2012254
202021     PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT.                  2012254
202022     ADD +1 TO WMS-INT-DR-NUMBER.                                 2012254
202023     ADD TAX-CALC-AMOUNT-LOC TO WMS-INT-DR-AMT  WMS-INT-TAX-LOCAL 2012254
202024               WMS-YTD-SAV-LOCAL-TAX  WMS-INT-MTD-LOCAL-TAX.      2012254
202025     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
202026         ADD TAX-CALC-AMOUNT-LOC TO INV-TAX-COLL-TDY-LOC          2012254
202027                                    WS-GL-INV-TAX-COLL-TDY-LOC    2012254
202028     ELSE                                                         2012254
202029         ADD +1  TO SAV-TAX-NO-LOC   WS-GL-SAV-TAX-LOC-NO         2012254
202030         ADD TAX-CALC-AMOUNT-LOC TO SAV-TAX-AMT-LOC               2012254
202031                                 WS-GL-SAV-TAX-LOC-AMT.           2012254
202032     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
202033         ADD TAX-CALC-AMOUNT-LOC TO WMS-DUAL-YR-CUR-SAV-LOCAL.    2012254
202034 K0053-SAV-TAX-GT-EXIT.  EXIT.                                    2012254
202035     SKIP3                                                        2012254
202036 K0053-CONTINUE.                                                  2012254
202037     IF  WMS-STATUS EQUAL '00' OR '04'                            2012254
202038         GO TO K0080.                                             2012254
202039     IF  WMS-STATUS EQUAL '05'                                    2012254
202050         MOVE '008' TO REJRESN                                    0717565
202100         GO TO K0070.
202150     IF WMS-STATUS EQUAL TO '99'
202200         MOVE '1' TO ACCT-NOT-FOUND
202250         GO TO K0040.
202260*----------------------------------------------------------------*1105504
202262*    DORMANT (06) AND ABANDONED (10) ACCOUNTS POST THE SAME.     *1105504
202264*----------------------------------------------------------------*1105504
202300     IF  WMS-STATUS NOT EQUAL TO '06' AND '10', GO TO K0055.      1105504
202310     IF  WMS-STATUS EQUAL TO '06'                                 1105504
202350         IF  WBC-POST-DORM    EQUAL TO '0'                        0266741
202400             MOVE '006' TO REJRESN                                0717565
202450             MOVE 'A2' TO EXCODE-2                                1105504
202500             GO TO K0070.                                         1105504
202505     IF  WMS-STATUS EQUAL TO '10'                                 1105504
202510         IF  WBC-POST-DORM    EQUAL TO '0'                        0266741
202515             MOVE '006' TO REJRESN                                0717565
202520             MOVE 'A9' TO EXCODE-2                                1105504
202525             GO TO K0070.                                         1105504
202550     GO TO K0080.
202600 K0055.
202650     IF WMS-STATUS NOT EQUAL TO '07', GO TO K0080.
202700     IF WBC-POST-INACTIVE EQUAL TO '0'                            0266741
202750         MOVE '007' TO REJRESN                                    0717565
202800         MOVE 'A3' TO EXCODE-2
202850         GO TO K0070.
202900     GO TO K0080.
202950 K0070.
202952     IF  TR-POST-PRIORITY EQUAL '3A' OR '0A'                      2016556
202954         GO TO K2570.                                             2016556
203000     IF  TR-TRAN-TYPE LESS THAN '3'                               9915845
203010         GO TO K0550-UNPOST.                                      9915845
203020*                                                                 9915845
203050     IF  TR-TRAN-TYPE LESS THAN '5'                               9915845
203060         GO TO K0350-UNPOST.                                      9915845
203070*                                                                 9915845
203100 K0075.
203150     IF  TR-TRAN-TYPE EQUAL '6'                                   9915845
203160         GO TO K1950-UNPOST.                                      9915845
203170*                                                                 9915845
203200     IF  TR-TRAN-TYPE EQUAL '5'                                   9915845
203210         GO TO K1550-UNPOST.                                      9915845
203220*                                                                 9915845
203250 K0076.
203300     IF  TR-TRAN-TYPE EQUAL '7'                                   9915845
203310         GO TO K1975-UNPOST.                                      9915845
203320*                                                                 9915845
203350     GO TO K1989-UNPOST.                                          IM002
203400 K0080.
203405*--- SKIP AUTOBORROW ACCOUNTS -----------------------------------*9915749
203410     IF  WMS-NB-DC-ABM EQUAL '1'                                  9915749
203415         GO TO K0085.                                             9915749
203450     IF  WMS-LOAN-TRLR EQUAL TO '0', GO TO K0085.                 IM003
203460     IF  WMS-PAST-DUE EQUAL ZERO                                  1002953
203465         GO  TO  K0085.                                           1002953
203470     IF  WMS-AUTO-REACTIVATE EQUAL '0' AND                        IM003
203476        (WMS-PAST-DUE EQUAL '1' OR '2' OR '4')                    IM003
203490         GO TO K0085.                                             IM003
203500     IF  AUTO-LOAN-PMT EQUAL TO '1', GO TO K0085.                 IM003
203510     IF  WMS-AUTO-PYMT EQUAL TO '0', GO TO K0085.                 IM003
203520     IF  TR-POST-PRIORITY LESS THAN WMS-PAST-DUE-POST-PRI         IM003
203700         GO TO K0085.
203750     SKIP1
203800*  --AT THIS POINT, A PAST DUE AUTOMATIC LOAN PAYMENT IS ATTEMPTED
203850*  --THE POINT IN THE TRANSACTION SEQUENCE AT WHICH THE ATTEMPT
203900*  --IS MADE DEPENDS UPON THE USER DEFINED PRIORITY FOR THIS
203950*  --FUNCTION (BC-PAST-DUE-POST)
204000     SKIP1
204050     PERFORM R0300 THRU R0495-EXIT.
204100 K0085.
204120     MOVE SPACES TO HOLD-BKDT-DATE.                               IM006
204150     IF TR-80-TYPE EQUAL TO '01'
204200         MOVE TR-01-ITEM-COUNT TO TR-ITEM-COUNT
204250         GO TO K0087.
204300     IF  TR-80-TYPE EQUAL '06'
204350         IF  NP-REV-CTR GREATER THAN +29
204400             MOVE '025' TO REJRESN                                0717565
204450             GO TO K0070
204500         ELSE
204550             MOVE TR-NP-ITEM-COUNT TO TR-ITEM-COUNT
204600             MOVE TR-NP-ORIG-DATE TO HOLD-BKDT-DATE
204650             MOVE TR-NP-DAYS      TO HOLD-BKDT-DAYS
204700             MOVE TR-NP-HOL       TO HOLD-BKDT-HOL
204750             GO TO K0087.
204800     MOVE +1 TO TR-ITEM-COUNT.
204850     IF  TR-80-TYPE EQUAL '08'
204900         IF  TR-TRAN-TYPE EQUAL '7' OR '8'                        9915845
204950             MOVE TR-SAVINGS-DATE TO HOLD-BKDT-DATE
205000             MOVE TR-SAVINGS-DAYS TO HOLD-BKDT-DAYS
205050             MOVE TR-IOD-HOL TO HOLD-BKDT-HOL
205100             GO TO K0087
205150         ELSE
205200             MOVE TR-IOD-DATE TO HOLD-BKDT-DATE
205250             MOVE TR-IOD-DAYS TO HOLD-BKDT-DAYS
205300             MOVE TR-IOD-HOL TO HOLD-BKDT-HOL
205350             GO TO K0087.
205400     IF  TR-80-TYPE EQUAL '12'
205450         MOVE TR-ACH-BKDT-DATE TO HOLD-BKDT-DATE
205500         MOVE TR-ACH-BKDT-DAYS TO HOLD-BKDT-DAYS
205550         MOVE TR-ACH-BKDT-HOL  TO HOLD-BKDT-HOL
205600         GO TO K0087.
205650     IF  TR-80-TYPE EQUAL '13'
205700         MOVE TR-ATM-BKDT-DATE TO HOLD-BKDT-DATE
205750         MOVE TR-ATM-BKDT-DAYS TO HOLD-BKDT-DAYS
205800         MOVE TR-ATM-BKDT-HOL TO HOLD-BKDT-HOL
205850         GO TO K0087.
205900     IF  TR-80-TYPE EQUAL '14'
205950         MOVE TR-ADDEND-BKDT-DATE TO HOLD-BKDT-DATE
206000         MOVE TR-ADDEND-BKDT-DAYS TO HOLD-BKDT-DAYS
206050         MOVE TR-ADDEND-BKDT-HOL TO HOLD-BKDT-HOL.
206096 K0087.                                                           0827785
206098     MOVE WMS-DATE-OPENED TO WK-OPEN-DATE.                        0827785
206100     IF  TR-TRAN-TYPE EQUAL '7' OR '8'                            0827785
206101     AND WMS-SAVINGS-TRLR EQUAL '1'                               0827785
206102         MOVE WMS-INT-DATE-OPENED TO WK-OPEN-DATE.                0827785
206103     IF (HOLD-BKDT-DATE EQUAL SPACES)                             0827785
206104     OR (HOLD-BKDT-DATE EQUAL WK-OPEN-DATE)                       0827785
206105         GO TO K0088.                                             0827785
206106     MOVE WK-OPEN-DATE TO DT-LOW-DATE.                            0827785
206107     PERFORM X0100-6-TO-8-LO.                                     0827785
206108     IF  DT-L-YR GREATER THAN WBC-NEXT-CAPTURE-YR                 0827785
206109         MOVE '19' TO C-LOW-CENT.                                 0827785
206110     MOVE HOLD-BKDT-DATE  TO DT-HIGH-DATE.                        0827785
206111     PERFORM X0110-6-TO-8-HI.                                     0827785
206112     CALL 'SIDIFC1' USING C-DATE-WORK.                            0827785
206113     IF  C-NO-DAYS EQUAL +0                                       0827785
206114         MOVE '038' TO REJRESN                                    0717565
206115         GO TO K0070.                                             0617360
206116 K0088.                                                           0617360
206117     IF  WMS-PLAN-TRLR NOT EQUAL '1'                              0617360
206118         GO TO K0089.                                             0617360
206119     IF  WS-WORK-CAL-YR EQUAL '1'                                 0617360
206120     AND WS-WORK-TAX-YR EQUAL '1'                                 0617360
206121         MOVE '038' TO REJRESN                                    0717565
206122         GO TO K0070.                                             0617360
206123     IF  WS-WORK-CAL-YR EQUAL '1'                                 0617360
206124     AND HOLD-BKDT-DATE EQUAL SPACES                              0617360
206125         MOVE '038' TO REJRESN                                    0717565
206126         GO TO K0070.                                             0617360
206127     IF (HOLD-BKDT-YR GREATER THAN SPACES                         0617360
206128     AND HOLD-BKDT-YR NOT EQUAL WBC-CAPTURE-YR)                   0617360
206129         IF  WS-WORK-CAL-YR EQUAL '0'                             0617360
206130         OR  WS-WORK-TAX-YR EQUAL '1'                             0617360
206131             MOVE '038' TO REJRESN                                0717565
206132             GO TO K0070.                                         0617360
206133     MOVE SPACES TO TR-PLN-CODE2.                                 0617360
206134     IF  HOLD-BKDT-DATE EQUAL SPACES                              0617360
206135         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0617360
206136     ELSE                                                         0617360
206137         MOVE HOLD-BKDT-DATE   TO DT-LOW-DATE.                    0617360
206138     PERFORM X0100-6-TO-8-LO.                                     0617360
206139     MOVE C-LOW-DATE            TO WK-LAST-DATE                   0727606
206140                                   WS-WORK-DATE8.                 0727606
206160     IF  TR-USER-CODE        EQUAL WBC-FDIC-CR-CODE               0927850
206161     AND TR-PLN-CODE         EQUAL SPACES                         0927850
206162         MOVE '77'              TO TR-PLN-CODE.                   0927850
206163     IF  TR-USER-CODE        EQUAL WBC-FDIC-DR-CODE               0927850
206164     AND TR-PLN-CODE         EQUAL SPACES                         0927850
206165         MOVE '37'              TO TR-PLN-CODE.                   0927850
206168     PERFORM PLAN-EDITS-SETUP THRU PLAN-EDITS-SETUP-EXIT.         0937740
206170     PERFORM PLAN-EDITS-SETUP-TRAN THRU                           0937740
206172             PLAN-EDITS-SETUP-TRAN-EXIT.                          0937740
206174     MOVE TR-COMB-PLN-CODES     TO WK-PE-PL-CODES.                0937740
206176     PERFORM PL-CD-EDITS      THRU PL-CD-EDITS-EXIT.              0727606
206178     SET PE-IDX TO +1.                                            0727606
206180 K0088-00-PE-ERRS.                                                0727606
206181     IF  WK-PE-ERR-CD (PE-IDX) NOT GREATER THAN +0                0937740
206182         GO TO K0088-00-PE-NO-ERRS.                               0937740
206183     MOVE SPACES TO REJRESN.                                      0937740
206184     PERFORM PL-ERR-CD-PROC THRU PL-ERR-CD-PROC-EXIT.             0937740
206185     IF  REJRESN NOT EQUAL SPACES                                 0937740
206186         GO TO K0070.                                             0937740
206187     SET PE-IDX UP BY 1.                                          0937740
206188     GO TO K0088-00-PE-ERRS.                                      0937740
206189 K0088-00-PE-NO-ERRS.                                             0937740
206190*                                                                 0727606
206191     MOVE WK-PE-PL-CODES   TO TR-COMB-PLN-CODES                   0727606
206192                              WS-WORK-COMB-PLN-CODES.             0727606
206193*                                                                 0727606
206194     MOVE 'A' TO WS-PLN-TRLR-FULL.                                0727606
206195     PERFORM CHECK-PLAN-REV  THRU CPR-END.                        0727606
206196     PERFORM UPDATE-PLN-CTDT THRU UIC-END.                        0727606
206197     IF  WS-PLN-TRLR-FULL EQUAL 'Y'                               0727606
206198         MOVE '018' TO REJRESN                                    0727606
206199         GO TO K0070.                                             0727606
206200*                                                                 0727606
206201     MOVE WS-WORK-CTDT-AMT       TO WK-PL-AMT.                    0727606
206202     IF  WS-PLN-TRLR-FULL EQUAL 'U'                               0727606
206203         ADD WMS-PLN-TRLR-CTDT-AMT (WMS-PLN-TRLR-IND)             0727606
206204                                 TO WK-PL-AMT.                    0727606
206205     IF  WK-PL-AMT LESS THAN ZERO                                 0727606
206206         MOVE '041' TO REJRESN                                    0727606
206207         GO TO K0070.                                             0617360
206208 K0089.                                                           0617360
206209     IF  TR-TRAN-TYPE EQUAL '3'                                   0617360
206210         GO TO K0090.                                             0617360
206211*                                                                 0617360
206212     IF  TR-TRAN-TYPE EQUAL '4'                                   0617360
206213         GO TO K0800.                                             0617360
206220*                                                                 9915845
206250     IF  TR-TRAN-TYPE EQUAL '1'                                   9915845
206260         GO TO K0400.                                             9915845
206270*                                                                 9915845
206300     IF  TR-TRAN-TYPE EQUAL '2'                                   9915845
206310         GO TO K0600.                                             9915845
206320*                                                                 9915845
206350     IF  WMS-LOAN-TRLR EQUAL '0'                                  9915845
206360     AND TR-TRAN-TYPE LESS THAN '7'                               9915845
206400         MOVE '015' TO REJRESN                                    0717565
206450         GO TO K0075.
206452     IF (TR-TRAN-TYPE EQUAL '5' OR '6')                           0827807
206454     AND TR-80-TYPE EQUAL '11'                                    0827807
206456         MOVE '0'  TO WK-FLAG                                     0827807
206458         MOVE '11' TO WK-FORMAT                                   0827807
206460         CALL 'SICOMPDT' USING WMS-APPROVAL-DATE                  0827807
206462                               TR-LOAN-ORIG-DATE                  0827807
206464                               WK-FLAG                            0827807
206466                               WK-FORMAT                          0827807
206468         IF  WK-FLAG NOT EQUAL 'E' AND 'L'                        0827807
206470             MOVE '100' TO REJRESN                                0827807
206472             GO TO K0075.                                         0827807
206480*                                                                 0827807
206500     IF  TR-TRAN-TYPE EQUAL '5'                                   9915845
206510         GO TO K1200.                                             9915845
206520*                                                                 9915845
206550     IF  TR-TRAN-TYPE EQUAL '6'                                   9915845
206560         GO TO K1600.                                             9915845
206570*                                                                 9915845
206600     IF WMS-SAVINGS-TRLR EQUAL TO '0'
206650         MOVE '015' TO REJRESN                                    0717565
206700         GO TO K0076.
206710*                                                                 9915845
206750     IF  TR-TRAN-TYPE EQUAL '7'                                   9915845
206760         GO TO K1960.                                             9915845
206770*                                                                 9915845
206800     GO TO K1980.
206850     SKIP3
206900*    *****************  CHECK PROCESSING  ******************
206950     SKIP1
207000 K0090.
207050     IF WMS-STATUS EQUAL TO '00', GO TO K0095.
207100     IF WMS-STATUS EQUAL TO '01'
207150         MOVE '010' TO REJRESN                                    0717565
207200         GO TO K0350-UNPOST.
207250     IF WMS-STATUS EQUAL TO '02'
207300         MOVE '011' TO REJRESN                                    0717565
207350         GO TO K0350-UNPOST.
207400     IF WMS-STATUS EQUAL TO '04'
207450         IF TR-OPTION (6) GREATER THAN '3'
207500             GO TO K0095
207550         ELSE
207600             MOVE '019' TO REJRESN                                0717565
207650             GO TO K0350-UNPOST.
207700     IF WMS-STATUS EQUAL TO '06'
207750         IF WBC-POST-DORM    LESS THAN '3'                        0266741
207800             MOVE '006' TO REJRESN                                0717565
207850             MOVE 'A2' TO EXCODE-2
207900             GO TO K0350-UNPOST
207950         ELSE
208000             GO TO K0095.
208050     IF WMS-STATUS EQUAL TO '07'
208100         IF WBC-POST-INACTIVE LESS THAN '3'                       0266741
208150             MOVE '007' TO REJRESN                                0717565
208200             MOVE 'A3' TO EXCODE-2
208250             GO TO K0350-UNPOST.
208300     IF WMS-STATUS EQUAL TO '08'
208350         MOVE '009' TO REJRESN                                    0717565
208400         GO TO K0350-UNPOST.
208410     IF WMS-STATUS EQUAL TO '09'                                  IM006
208420         MOVE '051' TO REJRESN                                    0717565
208430         GO TO K0350-UNPOST.                                      IM006
208431*----------------------------------------------------------------*1105504
208432*    ABANDONED ACCOUNTS -- ALLOW TRANSACTION TO POST THE SAME    *1105504
208433*    AS DORMANT ACCOUNTS.                                        *1105504
208434*----------------------------------------------------------------*1105504
208435     IF  WMS-STATUS EQUAL TO '10'                                 1105504
208436         IF  WBC-POST-DORM    LESS THAN '3'                       0266741
208437             MOVE '006' TO REJRESN                                0717565
208438             MOVE 'A9' TO EXCODE-2                                1105504
208439             GO TO K0350-UNPOST                                   1105504
208440         ELSE                                                     1105504
208441             GO TO K0095.                                         1105504
208450 K0095.
208460*----------------------------------------------------------------*0437111
208461*    RESTRICTED STMT SAVINGS ACCOUNTS CAN NOT ACCEPT MONETARY    *0437111
208462*    TRANS THAT INCREMENT MMDA ELIGIBILITY COUNTERS              *0437111
208463*----------------------------------------------------------------*0437111
208464     IF  WMS-MMDA-INDICATOR EQUAL '3'                             0437111
208465         IF  TR-OPTION (9) LESS THAN '4'                          0437111
208466             MOVE '038' TO REJRESN                                0717565
208467             GO TO K0350-UNPOST.                                  0437111
208500     IF NSF-CALC-FLAG EQUAL TO '1', GO TO K0107.                  IM003
208550 K0100.
208600     MOVE '1' TO NSF-CALC-FLAG.
208650     MOVE WMS-NSF-CALC TO CALC-FLAG.
208700*****    THE SAVINGS-OR-LOAN FLAG OPTIONS ARE ---            *****
208750*****       0 - NO SAVINGS OR LOAN AVAILABLE                 *****
208800*****       1 - SAVINGS ONLY AVAILABLE                       *****
208850*****       2 - BOTH AVAILABLE, BUT SAVINGS FIRST            *****
208900*****       3 - LOAN ONLY AVAILABLE                          *****
208950*****       4 - BOTH AVAILABLE, BUT LOAN FIRST               *****
209000 K0102.
209050     MOVE WMS-DDA-BAL TO CUR-BAL.
209052*--------------------------------------------------------------*  2016639
209053*    INCLUDE EXTERNAL INVESTMENT BALANCE FOR NEXT DAY SWEEPS   *  2016639
209054*--------------------------------------------------------------*  2016639
209055     IF  WMS-XINV-PROCESS-IND EQUAL  '2'                          2016639
209056     AND WMS-XINV-LINK-IND    EQUAL  'L'                          2016639
209057         ADD WMS-XINV-BALANCE    TO  CUR-BAL.                     2016639
209060*----------------------------------------------------------------*9915749
209062*    INCLUDE AVAILABLE BALANCE FOR AUTOBORROW ACCOUNTS.          *9915749
209064*----------------------------------------------------------------*9915749
209066     IF  WMS-NB-DC-ABM EQUAL TO '1'                               9915749
209068         IF  WMS-LOAN-TRLR EQUAL TO '1'                           9915749
209070             ADD WMS-AVAIL-BAL TO CUR-BAL.                        9915749
209100     MOVE ZERO TO LOAN-PRESENT
209150                  SAVINGS-PRESENT.
209160     IF  WMS-NB-DC-ABM NOT EQUAL TO '1'                           9915749
209200         IF  WMS-LOAN-TRLR EQUAL TO '1'                           1105504
209250             IF  WMS-LOAN-STATUS NOT GREATER THAN '1'             1105504
209300                 MOVE '1' TO LOAN-PRESENT.                        1105504
209350     IF  WMS-SAVINGS-TRLR EQUAL '1' AND
209400        (WMS-INT-STATUS EQUAL '0' OR '1' OR '3')
209450         IF  (WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3')         0437111
209460         OR  WMS-HIFI-INDICATOR EQUAL +0                          0902509
209500             MOVE '1' TO SAVINGS-PRESENT
209550         ELSE
209600         IF  WMS-INT-TRAN-NO LESS THAN WMS-MAX-TRAN-FOR-SUPER AND
209650             WMS-INT-CUR-BAL GREATER THAN WMS-MIN-AMT-FOR-SUPER
209700             MOVE '1' TO SAVINGS-PRESENT
209750             SUBTRACT WMS-MIN-AMT-FOR-SUPER FROM WMS-INT-CUR-BAL
209800                                             WMS-CURR-BAL
209850             MOVE '1' TO SAVINGS-MINIMUM.
209900     IF LOAN-PRESENT EQUAL TO '0'
209950         IF SAVINGS-PRESENT EQUAL TO '0'
210000             MOVE '0' TO SAVINGS-OR-LOAN
210050             GO TO K0104
210100         ELSE
210150             MOVE '1' TO SAVINGS-OR-LOAN
210200             GO TO K0104.
210250     IF SAVINGS-PRESENT EQUAL TO '1'
210300         GO TO K0103.
210350     MOVE '3' TO SAVINGS-OR-LOAN.
210400     GO TO K0104.
210450 K0103.
210500     IF WMS-TRANSFER-PRIORITY EQUAL TO '0'
210550         IF WBC-OD-PRIORITY EQUAL TO '0'                          0266741
210600             MOVE '2' TO SAVINGS-OR-LOAN
210650             GO TO K0104
210700         ELSE
210750             MOVE '4' TO SAVINGS-OR-LOAN
210800             GO TO K0104.
210850     IF WMS-TRANSFER-PRIORITY EQUAL TO '1'
210900         MOVE '2' TO SAVINGS-OR-LOAN
210950     ELSE
211000         MOVE '4' TO SAVINGS-OR-LOAN.
211050 K0104.
211052     SUBTRACT WMS-PROV-HOLD-AMT FROM CUR-BAL.                     0927850
211100     IF CALC-FLAG EQUAL TO '1', GO TO K0105.
211150     IF CALC-FLAG EQUAL TO '2'
211200         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL
211250         GO TO K0105.
211300     IF CALC-FLAG EQUAL TO '3'
211350         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUR-BAL                 IM007
211400         GO TO K0105.
211450     IF CALC-FLAG EQUAL TO '4'
211500         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUR-BAL                 IM007
211550         GO TO K0105.
211600     IF CALC-FLAG EQUAL TO '5'
211650         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL
211700         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUR-BAL                 IM007
211750         GO TO K0105.
211800     IF CALC-FLAG EQUAL TO '6'
211850         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL
211900         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUR-BAL                 9915749
211901         GO TO K0105.                                             9915749
211902     MOVE WMS-NB-RSRVE-RT TO WRK-RSRVE-RT.                        9915749
211903     IF  PRD-NBR-MAX EQUAL ZERO                                   9915749
211904         GO TO K0104-CONT.                                        9915749
211905     SET PRD-INX TO 1.                                            9915749
211906     SEARCH PRD-TABLE-ITEM                                        9915749
211907         AT END                                                   9915749
211908             GO TO K0104-CONT                                     9915749
211909         WHEN                                                     9915749
211910             PRD-TYPE (PRD-INX) EQUAL WMS-ACCT-TYPE               9915749
211911             MOVE PRD-RSRVE-RT (PRD-INX) TO WRK-RSRVE-RT.         9915749
211912 K0104-CONT.                                                      9915749
211913     COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT).          9915749
211914     IF CALC-FLAG EQUAL TO '7'                                    9915749
211915         SUBTRACT RESERVE-AMT FROM CUR-BAL                        9915749
211916         GO TO K0105.                                             9915749
211917     IF CALC-FLAG EQUAL TO '8'                                    9915749
211918         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL                       9915749
211919         COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT)       9915749
211920         SUBTRACT RESERVE-AMT FROM CUR-BAL                        9915749
211921         GO TO K0105.                                             9915749
211922     IF CALC-FLAG EQUAL TO '9'                                    9915749
211923         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUR-BAL                 9915749
211924         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL                       9915749
211925         COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT)       9915749
211926         SUBTRACT RESERVE-AMT FROM CUR-BAL                        9915749
211927         GO TO K0105.                                             9915749
211928     IF CALC-FLAG EQUAL TO 'A'                                    9915749
211929         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUR-BAL                 9915749
211930         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL                       9915749
211931         COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT)       9915749
211932         SUBTRACT RESERVE-AMT FROM CUR-BAL                        9915749
211933         GO TO K0105.                                             9915749
211934     IF CALC-FLAG EQUAL TO 'B'                                    9915749
211935         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUR-BAL                 9915749
211936         COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT)       9915749
211937         SUBTRACT RESERVE-AMT FROM CUR-BAL                        9915749
211938         GO TO K0105.                                             9915749
211939     IF CALC-FLAG NOT EQUAL TO 'C'                                9915749
211940         GO TO K0105.                                             9915749
211941     SUBTRACT WMS-CUST-AVAIL-AMT FROM CUR-BAL                     9915749
211942     COMPUTE RESERVE-AMT EQUAL (CUR-BAL * WRK-RSRVE-RT).          9915749
211943     SUBTRACT RESERVE-AMT FROM CUR-BAL.                           9915749
211944     MOVE CUR-BAL TO WMS-NB-INVEST-BAL.                           9915749
211950 K0105.                                                           9915845
211960     EXIT.                                                        9915845
211970 K0106.                                                           2016639
211972     MOVE '1' TO CUST-CALC-FLAG.                                  2016639
211974     MOVE WMS-DDA-BAL TO CUST-BAL.                                2016639
211980*--------------------------------------------------------------*  2016639
211981*    INCLUDE EXTERNAL INVESTMENT BALANCE FOR NEXT DAY SWEEPS   *  2016639
211982*--------------------------------------------------------------*  2016639
211984     IF  WMS-XINV-PROCESS-IND EQUAL  '2'                          2016639
211986     AND WMS-XINV-LINK-IND    EQUAL  'L'                          2016639
211988     AND WXI-EXCLUDE-BAL      EQUAL  '0'                          2016639
211990         ADD WMS-XINV-BALANCE    TO  CUST-BAL.                    2016639
212000*                                                                 2016639
212006     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM003
212007     AND (WMS-INT-STATUS EQUAL '0' OR '1' OR '3')                 IM003
212008         ADD WMS-INT-CUR-BAL TO CUST-BAL                          IM003
212009         IF  SAVINGS-MINIMUM EQUAL '1'                            IM003
212010             ADD WMS-MIN-AMT-FOR-SUPER TO CUST-BAL.               IM003
212014     IF  WMS-CUST-COLL-CALC EQUAL '1'                             IM003
212015         GO TO K0106-EXIT.                                        IM003
212016     IF  WMS-CUST-COLL-CALC EQUAL '2'                             IM003
212017         SUBTRACT WMS-HOLD-AMT FROM CUST-BAL                      IM003
212018         GO TO K0106-EXIT.                                        IM003
212019     IF  WMS-CUST-COLL-CALC EQUAL '3'                             IM003
212020         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUST-BAL                IM007
212021         GO TO K0106-EXIT.                                        IM003
212022     IF  WMS-CUST-COLL-CALC EQUAL '4'                             IM003
212023         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUST-BAL                IM007
212026         GO TO K0106-EXIT.                                        IM003
212028     IF  WMS-CUST-COLL-CALC EQUAL '5'                             IM003
212030         SUBTRACT WMS-HOLD-AMT FROM CUST-BAL                      IM003
212032         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUST-BAL                IM007
212034         GO TO K0106-EXIT.                                        IM003
212036     IF  WMS-CUST-COLL-CALC EQUAL '6'                             IM003
212038         SUBTRACT WMS-HOLD-AMT FROM CUST-BAL                      IM003
212039         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUST-BAL.               1105504
212040     IF  WMS-CUST-COLL-CALC EQUAL '7'                             9915749
212041         SUBTRACT WMS-NB-OTH-HLD FROM CUST-BAL.                   9915749
212042 K0106-EXIT.                                                      IM003
212044     EXIT.                                                        IM003
212046 K0107.                                                           IM003
212048     IF  NSF-CALC-FLAG EQUAL '0'                                  9915749
212050         PERFORM K0100 THRU K0105.                                9915749
212051*                                                                 9915749
212052     IF  CUST-CALC-FLAG EQUAL '0'                                 9915749
212054         PERFORM K0106 THRU K0106-EXIT.                           9915749
212055*                                                                 9915749
212056*--- CALCULATE BATCH RUN BALANCE --------------------------------*9915749
212057*                                                                 9915749
212058     IF  WS-FIRST-DEBIT EQUAL 'N'                                 9915749
212060         MOVE CUR-BAL TO BATCH-RUN-BALANCE  BATCH-RUN-OD          0437237
212062         MOVE ZERO    TO BATCH-OD-LIMIT                           0437237
212064         IF  SAVINGS-PRESENT EQUAL '1'                            9915749
212066             ADD WMS-INT-CUR-BAL TO BATCH-RUN-BALANCE             9915749
212068                                    BATCH-RUN-OD.                 9915749
212069     IF  WS-FIRST-DEBIT EQUAL 'N'                                 0930077
212070         COMPUTE BATCH-RUN-FDIC  =  BATCH-RUN-BALANCE             0930077
212071                                 +  WMS-PROV-HOLD-AMT             0930077
212072         MOVE 'Y'                TO WS-FIRST-DEBIT                9915749
212074         IF  WMS-OD-LIMIT GREATER THAN '0'                        9915749
212076             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-RUN-OD    0266741
212077             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-OD-LIMIT  0437237
212078         ELSE                                                     9915749
212080             IF  WMS-OD-LIMIT EQUAL 'S' OR 'L' OR '0'             9915749
212082                 IF  WMS-OD-LIMIT-AMT GREATER THAN +0             9915749
212084                     ADD WMS-OD-LIMIT-AMT TO BATCH-RUN-OD         9915749
212085                     ADD WMS-OD-LIMIT-AMT TO BATCH-OD-LIMIT       0437237
212086                 ELSE                                             9915749
212088                     MOVE +0.00  TO BATCH-RUN-OD                  9915749
212090             ELSE                                                 9915749
212092                 MOVE +0.00      TO BATCH-RUN-OD.                 9915749
212094*                                                                 9915749
212096     IF  LIST-POST-DR-FLAG EQUAL '1' OR '2'                       0827768
212100         IF (TR-OPTION (5) EQUAL TO '1' OR '3' OR '5' OR '7') AND
212150            (TR-80-TYPE NOT EQUAL '06' AND '08' AND '12' AND
212200                                  '13' AND '14')
212210             MOVE '1'            TO LIST-POST-ITEM                0827768
212250             GO TO K0115.
212289 K0107Z.                                                          9915749
212292     MOVE 'N' TO BATCH-RUN-BAL-OD-UPDATED.                        9916451
212300     IF  CUR-BAL NOT LESS THAN TR-AMOUNT                          9915749
212302         IF  BATCH-RUN-BALANCE NOT LESS THAN TR-AMOUNT            9915749
212304             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9915749
212310             GO TO K0300-POST.                                    9915749
212312     IF  BATCH-RUN-BALANCE NOT LESS THAN TR-AMOUNT                9915749
212314         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
212320         GO TO K0107Z-CONT.                                       9916057
212322     IF  FUNDING-AMT GREATER THAN WS-FUNDING-USED                 9915749
212324         IF  TR-AMOUNT NOT GREATER THAN                           9915749
212326             (FUNDING-AMT - WS-FUNDING-USED)                      9915749
212328             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9915749
212334             GO TO K0300-POST.                                    9915749
212340 K0107Z-CONT.                                                     9916057
212350     IF SAVINGS-OR-LOAN EQUAL TO '0'
212400         GO TO K0200.
212450     MOVE CUR-BAL TO AMT-AVAIL.
212500     IF SAVINGS-PRESENT EQUAL TO '1'
212550         ADD WMS-INT-CUR-BAL TO AMT-AVAIL.
212600     IF LOAN-PRESENT EQUAL TO '1'
212650         ADD WMS-AVAIL-BAL TO AMT-AVAIL.
212700     IF AMT-AVAIL LESS THAN TR-AMOUNT
212750         IF LOAN-PRESENT EQUAL TO '0'
212800             GO TO K0200
212850         ELSE
212900             GO TO K0120.
212950*****    AT THIS POINT THERE IS ENOUGH TO PAY THE TRANSACTION*****
213000*****  AMOUNT, EITHER FROM SAVINGS OR LOAN OR BOTH COMBINED  *****
213050 K0108.
213060     IF SAVINGS-OR-LOAN EQUAL '0'                                 9915845
213070         GO TO K0200.                                             9915845
213100     IF SAVINGS-OR-LOAN LESS THAN '3'
213150         GO TO K0150.
213200     IF CUR-BAL + WMS-AVAIL-BAL LESS THAN TR-AMOUNT
213210         PERFORM K1730 THRU K1730-EXIT                            2015844
213250         ADD WMS-AVAIL-BAL TO CUR-BAL LOAN-TODAY WMS-PRIN-BAL
213270                              CUST-BAL                            IM003
213280                              BATCH-RUN-BALANCE, BATCH-RUN-OD     2016677
213290                              BATCH-RUN-FDIC                      0930077
213300         GO TO K0160.
213350 K0109.
213400     IF TR-OPTION (6) EQUAL TO '2' OR '6' OR '7' OR '3'
213450         GO TO K0132.
213500     GO TO K0131.
213550 K0115.
213600     IF  WBC-LIST-POST-DETAIL EQUAL '1'                           0266741
213650         MOVE HIGH-VALUES TO TR-STMT-SYM
213700         MOVE '1' TO TRAN-REWRITE-SW.
213750     IF  TR-OPTION (7) EQUAL '1' OR '3' OR '5' OR '7'             IM005
213800         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-WITHDRAWAL   0266741
213850                                 WMS-DATE-LAST-CUST-ACTIVITY
213900         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-WITHDRAWAL.
213950     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
214000     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
214002     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
214004         ADD TR-AMOUNT   TO T3-PLAN-DEB-AMT                       0617360
214006                            WS-GL-PLAN-DEB-AMT                    0617360
214008         MOVE 'X'        TO WS-PLN-TRLR-FULL                      0617360
214010         MOVE TR-AMOUNT  TO WS-WORK-CTDT-AMT                      0617360
214011         PERFORM CHECK-PLAN-REV THRU CPR-END                      0617360
214012         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0617360
214014         MOVE 'PT'       TO IMEX-CODE-1                           0617360
214016         PERFORM K0330 THRU K0339.                                0617360
214050     GO TO K0119.
214100 K0116-ACCUM-CTRS.
214150     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'                           IM006
214160         GO TO K0116-EXIT.                                        IM006
214170     IF  TR-ACCUM-PTR-1 EQUAL 000                                 1105504
214180         GO TO K0116-ACCUM-2.                                     IM006
214190     MOVE TR-ACCUM-PTR-1 TO X.                                    IM006
214193     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '0' OR ' '                IM006
214196         GO TO K0116-ACCUM-2.                                     IM006
214200     IF  TR-ACCUM-PTR-1-DEC EQUAL '0'                             IM006
214300         IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '1' OR '3' OR '5'     IM004
214350             ADD TR-AMOUNT TO WMS-SC-MISC-AMTS (X)
214370             GO TO K0116-ACCUM-2                                  IM006
214380         ELSE                                                     IM006
214450             ADD +1 TO WMS-SC-MISC-NOS (X)                        IM006
214460             GO TO K0116-ACCUM-2.                                 IM006
214470     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '1' OR '3' OR '5'         IM006
214480         SUBTRACT TR-AMOUNT FROM WMS-SC-MISC-AMTS (X)             IM006
214490         IF  WMS-SC-MISC-AMTS (X) LESS THAN ZERO                  IM006
214500             MOVE ZERO TO WMS-SC-MISC-AMTS (X).                   IM006
214510     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '2' OR '4' OR '6'         IM006
214520         SUBTRACT +1 FROM WMS-SC-MISC-NOS (X)                     IM006
214530         IF  WMS-SC-MISC-NOS (X) LESS THAN ZERO                   IM006
214540             MOVE ZERO TO WMS-SC-MISC-NOS (X).                    IM006
214560 K0116-ACCUM-2.                                                   IM006
214570     IF  TR-ACCUM-PTR-2 EQUAL 000                                 1105504
214580         GO TO K0116-EXIT.                                        IM006
214590     MOVE TR-ACCUM-PTR-2 TO X.                                    IM006
214593     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '0' OR ' '                IM006
214596         GO TO K0116-EXIT.                                        IM006
214600     IF  TR-ACCUM-PTR-2-DEC EQUAL '0'                             IM006
214650         IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '1' OR '3' OR '5'     IM004
214700             ADD TR-AMOUNT TO WMS-SC-MISC-AMTS (X)
214720             GO TO K0116-EXIT                                     IM006
214750         ELSE
214800             ADD +1 TO WMS-SC-MISC-NOS (X)                        IM006
214804             GO TO K0116-EXIT.                                    IM006
214808     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '1' OR '3' OR '5'         IM006
214812         SUBTRACT TR-AMOUNT FROM WMS-SC-MISC-AMTS (X)             IM006
214816         IF  WMS-SC-MISC-AMTS (X) LESS THAN ZERO                  IM006
214820             MOVE ZERO TO WMS-SC-MISC-AMTS (X).                   IM006
214824     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL '2' OR '4' OR '6'         IM006
214828         SUBTRACT +1 FROM WMS-SC-MISC-NOS (X)                     IM006
214832         IF  WMS-SC-MISC-NOS (X) LESS THAN ZERO                   IM006
214836             MOVE ZERO TO WMS-SC-MISC-NOS (X).                    IM006
214850 K0116-EXIT. EXIT.
214900 K0117.
214950     MOVE HOLD-BKDT-DATE TO DT-HIGH-DATE.
215000     MOVE WMS-DATE-LAST-CUST-WITHDRAWAL TO DT-LOW-DATE.
215050     CALL 'SIDIF1' USING DATE-AREA.
215100     IF RET-DAYS GREATER THAN ZERO OR
215150         WMS-DATE-LAST-CUST-WITHDRAWAL EQUAL SPACES
215200         MOVE HOLD-BKDT-DATE TO WMS-DATE-LAST-CUST-WITHDRAWAL
215250         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-WITHDRAWAL.
215300 K0118.
215350     MOVE HOLD-BKDT-DATE TO DT-HIGH-DATE.
215400     MOVE WMS-DATE-LAST-CUST-ACTIVITY TO DT-LOW-DATE.
215450     CALL 'SIDIF1' USING DATE-AREA.
215500     IF RET-DAYS GREATER THAN ZERO OR
215550         WMS-DATE-LAST-CUST-ACTIVITY EQUAL SPACES
215600         MOVE HOLD-BKDT-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.
215605 K0118-EXIT.                                                      9915845
215606       EXIT.                                                      9915845
215650 K0119.
215700     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
215750     IF  TR-80-TYPE EQUAL '02'
215800         ADD +1 TO DDA-DESC-NO, WS-GL-DDA-DESC-NO.                0902970
215850     IF  TR-80-TYPE EQUAL '03' OR '12'
215900         ADD +1 TO WMS-SC-NUM-ACH, WMS-MTD-NUM-ACH                IM004
215950         ADD +1 TO DDA-ACH-NO, WS-GL-DDA-ACH-NO.                  0902970
216000     IF  TR-80-TYPE EQUAL '10' OR '14'
216050         ADD +1 TO WMS-SC-NUM-ACH, WMS-MTD-NUM-ACH                IM004
216100         ADD +1 TO DDA-ADDENDA-NO, WS-GL-DDA-ADDENDA-NO.          0902970
216150     IF  TR-80-TYPE EQUAL '09' OR '13'
216200         ADD +1 TO WMS-SC-NUM-ATM, WMS-MTD-NUM-ATM                IM004
216250         ADD +1 TO DDA-ATM-NO, WS-GL-DDA-ATM-NO.                  0902970
216300     IF  TR-OPTION (9) LESS THAN '4'                              2016014
216310         ADD +1 TO WMS-SC-CHECK-ITEMS.                            2016014
216350     GO TO Q4200.
216400*****    AT THIS POINT THERE IS NOT ENOUGH AVAILABLE TO PAY  *****
216450*****  THE TRANS, BUT THERE IS A LOAN TRAILER. NOW A DECISION*****
216500*****  HAS TO BE MADE -- TAKE THE ACCOUNT OD, FORCE IT OVER  *****
216550*****  CREDIT LINE, BOTH, OR NSF THE CHECK.                  *****
216600 K0120.
216610     IF WMS-LOAN-BAD-ACCT GREATER THAN '0', GO TO K0130.          IM004
216620     IF WMS-OVERLIM-INCR EQUAL TO '2', GO TO K0125.               IM004
216650     IF OVRLIM-FLAG EQUAL TO '1', GO TO K0130.
216700     IF WBC-OVRLIM-INCR EQUAL TO '0'                              0266741
216750         IF WMS-OVERLIM-INCR EQUAL TO '0'
216800             GO TO K0130.
216850     IF WMS-OVERLIMIT GREATER THAN '0', GO TO K0130.
216900     IF OVER-LINE EQUAL TO '1', GO TO K0130.
217000* WILL OVER-LIMIT AND OD-LIMIT COVER THE TRANSACTION              0265977
217010     IF AMT-AVAIL + HOLD-INCRM + BATCH-OD-LIMIT                   0437237
217020                               LESS THAN TR-AMOUNT                0265977
217030         GO TO K0130.                                             0265977
217100     MOVE '1' TO OVRLIM-FLAG.
217260     PERFORM K1730 THRU K1730-EXIT.                               2015844
217300     ADD WMS-AVAIL-BAL, HOLD-INCRM TO WMS-PRIN-BAL
217350                                      CUR-BAL
217370                                      CUST-BAL                    IM003
217380                      BATCH-RUN-BALANCE  BATCH-RUN-OD             2016677
217385                                      BATCH-RUN-FDIC              0930077
217400                                      LOAN-TODAY.
217405* IF OVER-LIMIT WILL COVER THE TRANSACTION GO POST                0265977
217410     IF AMT-AVAIL + HOLD-INCRM NOT LESS THAN TR-AMOUNT            0265977
217415       IF SAVINGS-PRESENT EQUAL TO '1'                            0265977
217420         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT              0265977
217425         MOVE ZERO TO WMS-INT-CUR-BAL                             0265977
217430         GO TO K0300-POST                                         0265977
217435       ELSE                                                       0265977
217440         GO TO K0300-POST.                                        0265977
217445     GO TO K0290-OD.                                              0265977
217454**** AUTO LOAN INCREMENT FLAG = 2  THE DEBIT WILL BE PAID    *****IM004
217458 K0125.                                                           IM004
217462     SUBTRACT WMS-AVAIL-BAL FROM TR-AMOUNT GIVING HOLD-LOAN-INCR. IM004
217466     IF SAVINGS-PRESENT EQUAL TO '1'                              IM004
217470         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT              IM004
217474         MOVE ZERO TO WMS-INT-CUR-BAL.                            IM004
217476     PERFORM K1730 THRU K1730-EXIT.                               2015844
217478     ADD WMS-AVAIL-BAL, HOLD-LOAN-INCR TO WMS-PRIN-BAL            IM004
217482                                          CUR-BAL                 IM004
217486                                          CUST-BAL                IM004
217487                      BATCH-RUN-BALANCE  BATCH-RUN-OD             2016677
217488                                          BATCH-RUN-FDIC          0930077
217490                                          LOAN-TODAY.             IM004
217494     GO TO K0300-POST.                                            IM004
217500 K0130.
217510* NOT FORCED THE OD-LIMIT WILL NOT COVER THE TRANSACTION          0265977
217515     IF TR-OPTION (4) EQUAL TO '0'                                0265977
217520       IF AMT-AVAIL + BATCH-OD-LIMIT LESS THAN TR-AMOUNT          0437237
217525         GO TO K0200.                                             0265977
217530* NOT FORCED THE OD-LIMIT WILL COVER THE TRANSACTION              0265977
217535     IF TR-OPTION (4) EQUAL TO '0'                                0265977
217540       IF AMT-AVAIL + BATCH-OD-LIMIT    NOT LESS THAN TR-AMOUNT   0437237
217545         IF WMS-AVAIL-BAL GREATER THAN +0                         0265977
217550             PERFORM K1730 THRU K1730-EXIT                        0265977
217555             ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY         0265977
217560                                  CUR-BAL      CUST-BAL           0265977
217562                              BATCH-RUN-FDIC                      0930077
217565                              BATCH-RUN-BALANCE  BATCH-RUN-OD.    0265977
217570     IF TR-OPTION (4) EQUAL TO '0'                                0265977
217575         GO TO K0290-OD.                                          0265977
217600                                                                  0265977
217650     IF TR-OPTION (4) EQUAL TO '1'
217700         IF WMS-AVAIL-BAL GREATER THAN +0
217710             PERFORM K1730 THRU K1730-EXIT                        2015844
217750             ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY         IM003
217760                                  CUR-BAL      CUST-BAL           IM003
217770                              BATCH-RUN-BALANCE  BATCH-RUN-OD     2016677
217775                              BATCH-RUN-FDIC                      0930077
217800             GO TO K0290-OD
217850         ELSE GO TO K0290-OD.
217900     IF SAVINGS-PRESENT EQUAL TO '1'
217950         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT
218000         MOVE ZERO TO WMS-INT-CUR-BAL.
218050     IF  TR-OPTION (4) GREATER THAN '3'
218100         GO  TO  K0132.
218150     PERFORM K0131 THRU K0131-A-EXIT.
218200     GO TO K0131-C.
218250*****    GIVE LOAN BY INCREMENTS    ******************************
218300 K0131.
218350     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
218400 K0131-A.
218410     IF HOLD-INCRM GREATER THAN ZERO                              1003979
218450         DIVIDE HOLD-INCRM INTO HOLD-AMT9 GIVING HOLD-DIVIDEND    1003979
218500             REMAINDER HOLD-REMAINDER                             1003979
218510     ELSE                                                         1003979
218520         MOVE ZEROES TO HOLD-DIVIDEND HOLD-REMAINDER.             1003979
218550     IF  HOLD-REMAINDER GREATER THAN ZERO
218600         ADD +1 TO HOLD-DIVIDEND.
218650     MULTIPLY HOLD-INCRM BY HOLD-DIVIDEND GIVING HOLD-AMT9.
218700 K0131-A-EXIT. EXIT.
218750 K0131-B.
218800     IF WMS-AVAIL-BAL LESS THAN HOLD-AMT9
218850         MOVE WMS-AVAIL-BAL TO HOLD-AMT9.
218900 K0131-B-EXIT. EXIT.
218950 K0131-C.
218960     PERFORM K1730 THRU K1730-EXIT.                               2015844
219000     ADD HOLD-AMT9 TO CUR-BAL, LOAN-TODAY, WMS-PRIN-BAL, CUST-BAL.IM003
219010     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
219015     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
219050     GO  TO  K0300-POST.
219100*****    GIVE LOAN BY AMOUNT NEEDED    ***************************
219150 K0132.
219200     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
219210     PERFORM K1730 THRU K1730-EXIT.                               2015844
219250     ADD HOLD-AMT9 TO CUR-BAL, LOAN-TODAY, WMS-PRIN-BAL, CUST-BAL.IM003
219260     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
219265     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
219300     GO TO K0300-POST.
219350 K0150.
219400     IF CUR-BAL + WMS-INT-CUR-BAL NOT LESS THAN TR-AMOUNT
219450         GO TO K0160.
219500     ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT.
219550     MOVE ZERO TO WMS-INT-CUR-BAL.
219600     GO TO K0109.
219650 K0160.
219700     IF HOLD-SAV-INCR GREATER THAN ZERO
219750         GO TO K0170.
219800     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
219850     ADD HOLD-AMT9 TO CUR-BAL, TRANSFER-AMT.
219900     SUBTRACT HOLD-AMT9  FROM WMS-INT-CUR-BAL.
219950     GO TO K0300-POST.
220000 K0170.
220050     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
220100 K0170-A.
220150     DIVIDE HOLD-SAV-INCR INTO HOLD-AMT9 GIVING HOLD-DIVIDEND
220200         REMAINDER HOLD-REMAINDER.
220250     IF HOLD-REMAINDER NOT EQUAL ZERO,
220300         ADD +1 TO HOLD-DIVIDEND.
220350     MULTIPLY HOLD-SAV-INCR BY HOLD-DIVIDEND GIVING HOLD-AMT9.
220400     IF WMS-INT-CUR-BAL LESS THAN HOLD-AMT9,
220450         MOVE WMS-INT-CUR-BAL TO HOLD-AMT9.
220500 K0170-A-END. EXIT.
220550 K0170-B.
220600     SUBTRACT HOLD-AMT9 FROM WMS-INT-CUR-BAL.
220650     ADD HOLD-AMT9 TO CUR-BAL, TRANSFER-AMT.
220700 K0170-END.  EXIT.
220750 K0180.
220800     GO TO K0300-POST.
220850 K0200.
220852*----------------------------------------------------------------*0927850
220854*    FORCE POST ACCOUNT OPTION IS NOT VALID IF UNDER FDIC CONTROL*0927850
220856*----------------------------------------------------------------*0927850
220858     IF WMS-FORCE-POST EQUAL 'Y'                                  0927850
220860        IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                            0927850
220862        AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                  0927850
220864            NEXT SENTENCE                                         0927850
220866        ELSE                                                      0927850
220868            GO TO K0290-OD.                                       0927850
220870*----------------------------------------------------------------*0927850
220872*    PAY ALL IS TREATED AS PAY NONE IF UNDER FDIC CONTROL        *0927850
220874*----------------------------------------------------------------*0927850
220876     IF WBC-FDIC-CTL-OPT EQUAL 'Y'                                0927850
220878     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO                      0927850
220880         IF  WMS-OD-LIMIT EQUAL TO 'A'                            0927850
220882             GO TO K0220.                                         0927850
220900     IF WMS-OD-LIMIT EQUAL TO 'A', GO TO K0290-OD.
220902                                                                  0927850
220904 K0205.                                                           0927850
220950     IF WMS-OD-LIMIT EQUAL TO 'N', GO TO K0220.
221000 K0210.
221050     IF WMS-OD-LIMIT EQUAL TO '0' OR 'S' OR 'L'                   9915749
221100         MOVE WMS-OD-LIMIT-AMT  TO HOLD-AMT
221150     ELSE
221200         MOVE WBC-OD-LIMIT OF WBC-OVERDRAFT-LIMITS                0266741
221250         (WMS-OD-LIMIT-9) TO HOLD-AMT.
221300 K0212.  EXIT.
221350 K0213.
221400     IF SAVINGS-PRESENT EQUAL TO '1'
221450         ADD WMS-INT-CUR-BAL TO HOLD-AMT.
221500 K0215.  EXIT.
221550 K0216.
221600     IF  WMS-OD-LIMIT EQUAL 'L'                                   9915749
221602         IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-OD              9915749
221604             MOVE ' ' TO TR-PEND-DECISION                         9915749
221606             PERFORM K0290-LOC-FEE THRU K0290-LOC-FEE-EXIT        9915749
221608             SUBTRACT TR-AMOUNT FROM BATCH-RUN-OD                 9915749
221609             MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                 9916451
221610             GO TO K0300-POST.                                    9915749
221620     IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-OD                  9915749
221622         SUBTRACT TR-AMOUNT FROM BATCH-RUN-OD                     9915749
221624         MOVE +0.00 TO BATCH-RUN-BALANCE                          9915749
221626         MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                     9916451
221650         GO TO K0290-OD.
221700 K0220.
221750     IF TR-OPTION (4) EQUAL TO '1' OR '3' OR '5'
221800         GO TO K0290-OD.
221802* SI TRANSACCION FUE ACEPTADA EN LINEA, POSTEAR ASI NO HAYA SALDO IMIBXX
221804     IF TR-SRC-INFO-FLAG = '1' AND                                IMIBXX
221806        (TR-ORIGIN NOT = 'TT' AND 'IT')                           IMIBXX
221808        GO TO K0290-OD.                                           IMIBXX
221810     IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-BALANCE             9915749
221812         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
221818         GO TO K0300-POST.                                        9915749
221820     MOVE 'P' TO TR-PEND-DECISION.                                9915749
221822     MOVE 'P' TO EX13-NB-PEND-DEC-IND.                            9915749
221826     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
221828     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
221830         IF (BATCH-RUN-FDIC + BATCH-OD-LIMIT)                     0930077
221832             NOT LESS THAN TR-AMOUNT                              0930077
221834             ADD +1 TO NSF-CTR-FDIC.                              0930077
221850     ADD +1 TO NSF-CTR.
221900     IF  WMS-SAV-PTR EQUAL TO ZERO                                IM004
221910     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
221950         ADD +1 TO WMS-SC-NSF-ITEMS, WMS-MTD-NSF-ITEMS.
222000     MOVE '1' TO NSF-TODAY.
222050     MOVE '1' TO WMS-NSF-TODAY.
222100     ADD +1 TO WMS-CHECKS-RETURNED.
222150     MOVE '1' TO NSF-TOTAL-SW.
222170     ADD TR-AMOUNT TO HOLD-EFA-NSF-AMT.                           IM007
222200 K0230.
222250     IF WMS-SAV-PTR EQUAL TO ZERO                                 IM004
222260     AND WMS-SAVINGS-TRLR EQUAL '0'                               IM004
222270     AND WMS-CHG-CARD-FLG EQUAL '0'                               IM004
222300         GO TO K0235.
222350     IF  NSF-TOTAL-SW NOT EQUAL TO '1'                            IM004
222360         GO TO K0232.                                             IM004
222370     ADD TR-AMOUNT TO NSF-TOTAL.                                  IM004
222380     IF  WMS-SAV-PTR NOT EQUAL TO ZERO                            IM004
222390         MOVE 'LC' TO IMEX-CODE-1                                 IM004
222400     ELSE                                                         IM004
222410         IF  WMS-SAVINGS-TRLR EQUAL '1'                           IM004
222420             MOVE 'LD' TO IMEX-CODE-1                             IM004
222430         ELSE                                                     IM004
222440             MOVE 'LG' TO IMEX-CODE-1.                            IM004
222450     GO TO K0233.                                                 IM004
222460 K0232.                                                           IM004
222470     IF  WMS-SAV-PTR NOT EQUAL TO ZERO                            IM004
222480         MOVE 'LE' TO IMEX-CODE-1                                 IM004
222490     ELSE                                                         IM004
222500         IF  WMS-SAVINGS-TRLR EQUAL '1'                           IM004
222510             MOVE 'LF' TO IMEX-CODE-1                             IM004
222520         ELSE                                                     IM004
222530             MOVE 'LH' TO IMEX-CODE-1.                            IM004
222540 K0233.                                                           IM004
222900     PERFORM K0330 THRU K0339.
222950 K0235.
223000     MOVE '0' TO NSF-TOTAL-SW.
223050 K0240.  EXIT.
223100 K0250.
223150     MOVE '032' TO REJRESN.                                       0717565
223200     MOVE 'A1' TO EXCODE-2.
223202     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
223204     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
223206         IF (BATCH-RUN-FDIC + BATCH-OD-LIMIT)                     0930077
223208             NOT LESS THAN TR-AMOUNT                              0930077
223210             SUBTRACT TR-AMOUNT FROM BATCH-RUN-FDIC               0930077
223212             MOVE 'HQ' TO EXCODE-2.                               0930077
223250     IF  TR-TRAN-TYPE EQUAL '3'                                   9915845
223260         MOVE '1' TO EX13-REASON-OR-OPT.                          IM003
223270     IF  TR-TRAN-TYPE EQUAL '4'                                   9915845
223280     AND (TR-OPTION (5) EQUAL '2' OR '3' OR '6' OR '7')           IM003
223350         MOVE '1' TO EX13-REASON-OR-OPT
223400     ELSE
223450         MOVE '0' TO EX13-REASON-OR-OPT.
223451*----------------------------------------------------------------*9915749
223452*    IF BCR PAY ALL POST TO LIMIT IS EQUAL 'Y', POST ALL         *9915749
223453*    TRANSACTIONS REGARDLESS OF THE ACCOUNT'S BALANCE.  THESE    *9915749
223454*    ITEMS WILL BE REPORTED AS NSF OR OVERDRAFT TRANSACTIONS.    *9915749
223456*----------------------------------------------------------------*9915749
223457     IF  WMS-PROV-HOLD-AMT GREATER THAN ZERO                      0927850
223458     AND WBC-NB-POST-ALL-PAY-TO-LIM EQUAL 'Y'                     0927850
223459         GO TO K0350-UNPOST.                                      0927850
223464         IF  WMS-OD-LIMIT NOT EQUAL 'N'                           9915749
223466             IF  WBC-NB-POST-ALL-PAY-TO-LIM EQUAL 'Y'             0266741
223468                 MOVE 'A0' TO IMEX-CODE-1                         9915749
223470                 MOVE 'A1' TO IMEX-CODE-2                         9915749
223471                 MOVE '066' TO WK-REJ-REASON                      0717565
223472                 PERFORM X3000-REJ-REASON THRU X3000-EXIT         2015394
223473                 MOVE '1' TO TRAN-REWRITE-SW                      2015394
223474                 IF TR-80-TYPE EQUAL '03' OR '10' OR '12' OR '14' 2015394
223475                     MOVE 'A8' TO IMEX-CODE-1                     2015394
223476                     PERFORM K0330 THRU K0339                     9915749
223478                     MOVE SPACES TO EX-INFO                       9915749
223480                     GO TO K0260-POST                             2015394
223482                 ELSE                                             9915749
223484                     PERFORM K0330 THRU K0339                     9915749
223486                     MOVE SPACES TO EX-INFO                       9915749
223488                     GO TO K0260-POST.                            2015394
223500     GO TO K0350-UNPOST.
223501 K0260-POST.                                                      2015394
223502     IF  TR-TRAN-TYPE EQUAL '4' GO TO K1100-POST                  2015394
223503     ELSE                       GO TO K0300-POST.                 2015394
223505 K0270-DAU.                                                       IM003
223510     MOVE 'P' TO EX13-NB-PEND-DEC-IND.                            9915749
223519     MOVE '1' TO WMS-UNAVAIL-TODAY.                               IM007
223520     IF  HOLD-OPT GREATER THAN +3                                 IM003
223521         SUBTRACT +4 FROM HOLD-OPT                                IM003
223522         MOVE '1' TO DAU-TODAY                                    IM003
223523         MOVE 'HJ' TO IMEX-CODE-1                                 IM003
223524         MOVE 'DU ' TO WK-REJ-REASON                              0817735
223525         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 0817735
223526         MOVE '1' TO TRAN-REWRITE-SW                              0817735
223527         PERFORM K0330 THRU K0339                                 0817735
223528         ADD +1 TO WMS-SC-UNAVAIL-ITEMS                           0817735
223529                   WMS-MTD-UNAVAIL-ITEMS.                         0817735
223530     IF  HOLD-OPT GREATER THAN +1                                 0817735
223531         IF  CUST-BAL LESS THAN WMS-DAU-MIN-AMT                   0817735
223532             ADD +1 TO DAU-CTR.                                   0817735
223533     IF  ((TR-80-TYPE EQUAL '09' OR '13')                         1020116
223534     AND (WS-REGE-EFF EQUAL 'A' OR 'Y')                           1020116
223535     AND (WMS-OD-REGE-OPT-CODE EQUAL '2')                         1020116
223536     AND (TR-ATM-POS-RECUR NOT EQUAL '1'))                        1020116
223537         IF  HOLD-OPT GREATER THAN +1                             1020116
223538             IF  CUST-BAL LESS THAN WMS-DAU-MIN-AMT               1020116
223539                 ADD +1 TO ATM-POS-DAU-CTR.                       1020116
223544 K0270-EXIT.                                                      IM003
223545     EXIT.                                                        IM003
223550 K0290-OD.
223552*----------------------------------------------------------------*9915749
223553*    GENERATE FEE FOR BUSINESS LOC OD TRANSFERS                  *0917815
223554*----------------------------------------------------------------*0917815
223555 K0290-LOC-FEE.                                                   0917815
223556     IF  FUNDING-POSTED                                           0917815
223557         GO TO K0290-LOC-FEE-EXIT.                                0917815
223558     IF  WMS-OD-LIMIT NOT EQUAL 'L'                               0917815
223559         GO TO K0290-LOC-FEE-EXIT.                                9915749
223560     IF  WS-FIRST-LOC-ACT EQUAL 'Y'                               0917815
223561         GO TO K0290-LOC-FEE-EXIT.                                9915749
223562     MOVE 'Y' TO WS-FIRST-LOC-ACT.                                0917815
223563     MOVE WMS-CONTROL-KEY TO TB-CONTROL.                          0917815
223564     MOVE 'I' TO  I-O-CONTROL-ACCESS.                             0917815
223565     MOVE 'K' TO  I-O-CONTROL-OPERATOR.                           0917815
223566     CALL 'IMODLMV' USING I-O-CONTROL-AREA                        0917815
223567                          TRANSFER-BALANCE-RECORD.                0917815
223568     IF  NOT I-O-88-NORMAL-RET                                    0917815
223569         MOVE 401 TO SIMESS-MESS-NO                               0917815
223570         CALL 'SIMESS' USING  SIMESS-AREA                         0917815
223571         GO TO K0290-LOC-FEE-EXIT.                                0917815
223572     IF  TB-FEE-AMT-DFLT EQUAL ZERO                               0917815
223573         GO TO K0290-LOC-FEE-EXIT.                                9915749
223574     IF  TB-FEE-PROC-IND EQUAL 'C'                                9915749
223575         ADD +1 TO WMS-SC-MISC-NOS (TB-FEE-ACCUM)                 9915749
223576         GO TO K0290-LOC-FEE-EXIT.                                9915749
223577     IF  TB-FEE-PROC-IND EQUAL 'W'                                9915749
223578         IF  TB-FEE-WAIVE EQUAL 'O' OR 'F' OR 'L' OR 'P'          9915749
223579             ADD TB-FEE-AMT-DFLT TO WMS-NB-MTD-MIN-WVE            0917815
223580             GO TO K0290-LOC-FEE-EXIT                             9915749
223581        ELSE                                                      9915749
223582             ADD TB-FEE-AMT-DFLT TO WMS-NB-MTD-WVE-AMT            0917815
223583             GO TO K0290-LOC-FEE-EXIT.                            9915749
223584     MOVE TB-FEE-AMT-DFLT TO HOLD-AMT.                            0917815
223585     ADD +1 TO FS-DB.                                             9915749
223586     PERFORM K7500 THRU K8500.                                    9915749
223587     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL.      9915749
223588     ADD HOLD-AMT TO WMS-NB-MTD-SC-AMT.                           9915749
223589     ADD +1       TO WMS-STMT-NO-DEBITS.                          9915749
223590     ADD HOLD-AMT TO WMS-STMT-DR-AMT,                             0527449
223591                     WBC-REG-TFR-AMT (4), WBC-REG-CALL-AMT (13).  0527449
223592     ADD +1       TO DDA-SVC-CHG-NO, WS-GL-DDA-SVC-CHG-NO.        0527449
223593     ADD HOLD-AMT TO DDA-SVC-CHG-AMT                              9915749
223594                     WS-GL-DDA-SVC-CHG-AMT.                       9915749
223595     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       9915749
223596     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     9915749
223597         ADD +1       TO IOD-DB-NO, WS-GL-IOD-DB-NO               9915749
223598         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             9915749
223599     ELSE                                                         9915749
223600         ADD +1       TO DDA-DB-NO, WS-GL-DDA-DB-NO               9915749
223601         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            9915749
223602     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
223603     MOVE 'GY'                    TO IMEX-CODE-2.                 9915749
223604     MOVE '01'                    TO EX01-INT-CODE.               9915749
223605     MOVE '4'                     TO EX01-TYPE.                   9915749
223606     MOVE 'LC'                    TO GT-MNEUMONIC.                9915749
223607     MOVE ZERO                    TO EX01-NUMBER.                 9915749
223608     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 9915749
223609     ADD HOLD-AMT                 TO WMS-IOD-TIS-CYC-FEES.        9915749
223610 K0290-LOC-FEE-EXIT.                                              9915749
223611     EXIT.                                                        9915749
223612                                                                  9915749
223613 K0290-OD-CONT.                                                   9915749
223620     PERFORM K0230 THRU K0240.                                    1105504
223650     IF SAVINGS-PRESENT EQUAL TO '1'
223700         ADD WMS-INT-CUR-BAL TO CUR-BAL, TRANSFER-AMT
223750         MOVE ZERO TO WMS-INT-CUR-BAL.
223800 K0295.  EXIT.
223850 K0296.
223900     IF WMS-SAV-PTR EQUAL TO ZERO
223920     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
223950         ADD +1 TO WMS-SC-OD-ITEMS, WMS-MTD-OD-ITEMS.
224000     MOVE '1' TO OD-TODAY.
224050     MOVE '1' TO WMS-OD-TODAY.
224054     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
224056     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
224058         IF  BATCH-RUN-FDIC NOT LESS THAN TR-AMOUNT               0930077
224060             IF  CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-AMOUNT     0927850
224062                 ADD +1 TO OD-CTR-FDIC.                           0927850
224064     IF WMS-OD-CHG-CODE EQUAL '2'                                 1020109
224066         ADD +1 TO OD-CTR                                         1020109
224068         GO TO K0297.                                             1020109
224100     IF CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-AMOUNT
224150         ADD +1 TO OD-CTR
224200     ELSE
224250         IF WMS-OD-CHG-CODE EQUAL TO '1'
224300             GO TO K0300-POST.
224302                                                                  1020109
224304 K0297.                                                           1020109
224350     MOVE 'H2' TO IMEX-CODE-1.
224352     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
224354     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
224356         IF  BATCH-RUN-FDIC NOT LESS THAN TR-AMOUNT               0930077
224358             MOVE 'HP' TO IMEX-CODE-1.                            0927850
224360     IF  WMS-OD-LIMIT EQUAL TO 'L'                                9915749
224362         MOVE 'HU' TO IMEX-CODE-2                                 9915749
224364     ELSE                                                         9915749
224366         MOVE 'P'  TO EX13-NB-PEND-DEC-IND                        9915749
224368                      TR-PEND-DECISION.                           9915749
224400     MOVE '073' TO WK-REJ-REASON.                                 0717565
224401     IF  TR-TRAN-TYPE EQUAL '3'                                   9915845
224402         MOVE '1' TO EX13-REASON-OR-OPT.                          IM003
224403     IF  TR-TRAN-TYPE EQUAL '4'                                   9915845
224404     AND (TR-OPTION (5) EQUAL '2' OR '3' OR '6' OR '7')           IM003
224405         MOVE '1' TO EX13-REASON-OR-OPT                           IM003
224406     ELSE                                                         IM003
224407         MOVE '0' TO EX13-REASON-OR-OPT.                          IM003
224410     PERFORM X3000-REJ-REASON THRU X3000-EXIT.                    IM008
224450     MOVE '1' TO TRAN-REWRITE-SW.
224452*----------------------------------------------------------------*9915749
224456*   TURN OFF PENDING DECISION FLAG ON FORCE PAY AND              *9915749
224458*   OD-LIMIT EQUAL 0 - 9.                                        *9915749
224460*----------------------------------------------------------------*9915749
224462     IF (TR-TRAN-TYPE EQUAL '3' AND                               0827769
224464        (TR-OPTION (4) EQUAL TO '1' OR '3' OR '5' OR '7'))        0827769
224465     OR  WMS-FORCE-POST EQUAL 'Y'                                 0827769
224466         MOVE ' ' TO TR-PEND-DECISION                             9915749
224468         MOVE ' ' TO EX13-NB-PEND-DEC-IND.                        9915749
224470     IF  WMS-OD-LIMIT GREATER THAN '0' AND                        9915749
224472         WMS-OD-LIMIT NOT GREATER THAN '9'                        9915749
224474         MOVE ' ' TO TR-PEND-DECISION                             9915749
224476         MOVE ' ' TO EX13-NB-PEND-DEC-IND.                        9915749
224500     PERFORM K0330 THRU K0339.
224550 K0300-POST.
224560     IF TR-OPTION (8) EQUAL '4' OR '5' OR '6' OR '7'              1004773
224570         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (9).             0266741
224600     ADD +1 TO FS-DB.
224640     IF  TR-OPTION (9) LESS THAN '4'                              2016014
224650         ADD +1 TO WMS-SC-CHECK-ITEMS.                            2016014
224700     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
224750         PERFORM K7200 THRU K8500.
224760     IF  BATCH-RUN-BAL-OD-UPDATED EQUAL 'N'                       9916451
224765         SUBTRACT TR-AMOUNT FROM BATCH-RUN-BALANCE                9916451
224770                                 BATCH-RUN-OD.                    9916451
224772     SUBTRACT TR-AMOUNT FROM BATCH-RUN-FDIC.                      0930077
224800     SUBTRACT TR-AMOUNT FROM WMS-CURR-BAL                         IM003
224808                             CUR-BAL                              IM003
224816                             CUST-BAL.                            IM003
224818     MOVE '  ' TO TR-REJ-PROG.                                    9915749
224824     IF  CUST-BAL LESS THAN ZERO                                  9915749
224826     AND WMS-OD-TODAY EQUAL '0'                                   9915749
224828         MOVE TR-OPTION9 (7) TO HOLD-OPT                          9915749
224832         PERFORM K0270-DAU THRU K0270-EXIT.                       9915749
224850     ADD TR-AMOUNT TO WMS-TODAYS-DEBITS.
224900     ADD +1 TO WMS-TODAYS-DEBITS-NO.
224950     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
225000     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
225050         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
225100         ADD TR-AMOUNT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT            0902970
225150     ELSE
225200         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
225250         ADD TR-AMOUNT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.           0902970
225260     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
225262         ADD TR-AMOUNT   TO T3-PLAN-DEB-AMT                       0617360
225264                            WS-GL-PLAN-DEB-AMT                    0617360
225266         MOVE 'X'        TO WS-PLN-TRLR-FULL                      0617360
225268         MOVE TR-AMOUNT  TO WS-WORK-CTDT-AMT                      0617360
225269         PERFORM CHECK-PLAN-REV THRU CPR-END                      0617360
225270         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0617360
225272         MOVE 'PT'       TO IMEX-CODE-1                           0617360
225274         PERFORM K0330 THRU K0339.                                0617360
225300     MOVE '1' TO POST-TODAY.
225302     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
225350     IF  WMS-LOAN-TRLR EQUAL TO '1' AND LOAN-TODAY NOT EQUAL ZERO 9915749
225360         IF  WMS-NB-DC-ABM NOT EQUAL '1'                          9915749
225400             PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.         9915749
225450     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
225500         IF  TR-SOURCE2 EQUAL '1'
225550         AND TR-SOURCE1 EQUAL '0'
225600             ADD +1 TO WMS-LOW-SPEED-ITEMS
225650                       WMS-MTD-LOW-SPEED-ITEMS
225700         ELSE
225750             ADD +1 TO WMS-HI-SPEED-ITEMS
225800                       WMS-MTD-HI-SPEED-ITEMS.
225808     IF WMS-KITING-SUSP-TRLR EQUAL '1'                            IM006
225816         IF (TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7') AND    IM006
225818            (TR-80-TYPE NOT EQUAL '06' AND '08'                   IM006
225819                              AND '12' AND '13' AND '14')         IM006
225820             MOVE '1' TO KITE-ITEM-FLAG                           IM006
225824             ADD TR-ITEM-COUNT TO WMS-KITE-TODAY-DR-NO (7)        IM006
225832             ADD TR-AMOUNT TO WMS-KITE-TODAY-DR-AMT (7).          IM006
225850     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
225900     MOVE TR-OPTION9 (3) TO HOLD-OPT.
225950     IF HOLD-OPT GREATER THAN +3
226000         SUBTRACT +4 FROM HOLD-OPT
226010         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
226012                        OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G' 0417110
226050             ADD +1 TO WMS-STMT-ITEMS.                            1105504
226100     IF HOLD-OPT GREATER THAN +1
226150         SUBTRACT +2 FROM HOLD-OPT
226160*        ADD +1 TO WMS-SC-CHECK-ITEMS                             9915749
226200         ADD +1 TO WMS-SC-NO-CHECKS.
226250     IF HOLD-OPT GREATER THAN +0
226300         ADD +1 TO WMS-SC-DEBITS, WMS-MTD-SVC-CHG-DR              2016374
226305         IF  WMS-BIR-FLAG EQUAL '1' OR '2'                        2016374
226310             ADD +1 TO WMS-BIR-MTD-WD-NBR                         2016374
226315             ADD TR-AMOUNT TO WMS-BIR-MTD-WD-AMT.                 2016374
226350     MOVE TR-OPTION9 (6) TO HOLD-OPT.
226400     IF HOLD-OPT GREATER THAN +3
226450         SUBTRACT +4 FROM HOLD-OPT.
226500     IF HOLD-OPT GREATER THAN +1
226550         SUBTRACT +2 FROM HOLD-OPT.
226600     ADD +1 TO SEQ-CTR.
226650     IF  HOLD-OPT GREATER THAN +0
226700         NEXT SENTENCE
226750     ELSE
226800         GO TO K0305-CHECK-FOR-CHK-CHG.
226850     IF  WMS-CHECKS-RETURNED GREATER THAN +0
226900         SUBTRACT +1 FROM WMS-CHECKS-RETURNED.
226950     IF  WMS-SC-NSF-ITEMS GREATER THAN +0
227000         SUBTRACT +1 FROM WMS-SC-NSF-ITEMS.
227050     IF  WMS-MTD-NSF-ITEMS GREATER THAN +0
227100         SUBTRACT +1 FROM WMS-MTD-NSF-ITEMS.
227110     ADD +1 TO NSF-RVRSL-CTR.                                     1104882
227150 K0305-CHECK-FOR-CHK-CHG.
227200     IF  WMS-SC-CHECK-CHG LESS THAN '2', GO  TO  K0312-EXIT.
227250     IF WMS-SC-CHECK-CHG EQUAL TO '2'
227300         ADD +1 TO FS-DB
227350         PERFORM K7200 THRU K8500
227400         MOVE WMS-CHK-CHG TO HOLD-AMT
227450         MOVE ZERO TO WMS-SC-NO-CHECKS
227500         GO TO K0310.
227550     IF WMS-SC-CHECK-CHG EQUAL TO '4'
227600         IF WMS-SC-FIRST-CHECK EQUAL TO '1'
227650             MOVE '0' TO WMS-SC-FIRST-CHECK
227700             SUBTRACT +1 FROM WMS-SC-NO-CHECKS
227750             GO TO K0309.
227800     IF  WMS-SC-NO-CHECKS LESS THAN WMS-CHK-LIMIT
227850         GO  TO  K0312-EXIT.
227900     ADD +1 TO FS-DB.
227950     PERFORM K7200 THRU K8500.
228000     SUBTRACT WMS-CHK-LIMIT FROM WMS-SC-NO-CHECKS.
228050 K0309.
228100     MULTIPLY WMS-CHK-CHG BY WMS-CHK-LIMIT GIVING HOLD-AMT.
228150 K0310.
228200     IF WMS-SC-CHARGE EQUAL TO '0'
228250         ADD +1 TO DDA-SVC-CHG-WAV-NO, WS-GL-DDA-SVC-CHG-WAV-NO   0902970
228300         ADD HOLD-AMT TO DDA-SVC-CHG-WAV-AMT
228301                         WS-GL-DDA-SVC-CHG-WAV-AMT                0902970
228350         GO  TO  K0312-EXIT.
228400     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL.      IM003
228450     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
228500     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
228550         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
228600         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
228650     ELSE
228700         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
228750         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
228800     MOVE WBC-GENERATED-TRANS (5) TO GEN-TRAN-OPTION-HOLD.        0266741
228850     MOVE 'G4' TO IMEX-CODE-2.
228900     MOVE '05' TO EX01-INT-CODE.
228950     MOVE '4' TO EX01-TYPE.
229000     MOVE WMS-CHK-LIMIT TO EX01-NUMBER.
229050     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
229100     ADD +1 TO DDA-CHK-CHG-NO, WS-GL-DDA-CHK-CHG-NO.              0902970
229150     ADD HOLD-AMT TO DDA-CHK-CHG-AMT, WS-GL-DDA-CHK-CHG-AMT.      0902970
229200     ADD HOLD-AMT TO WMS-STMT-SERV-CHG.
229250     ADD HOLD-AMT TO WMS-MTD-ACCUM-SERV-CHG.
229252     ADD HOLD-AMT TO WMS-YTD-ACCUM-SERV-CHG.                      0617360
229260     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1004015
229300 K0312-EXIT. EXIT.
229350 K0315.
229400     IF WMS-STATUS EQUAL TO '00', GO TO K0320.
229450     IF WMS-STATUS EQUAL TO '04'
229460         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
229465         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
229470         MOVE '51' TO EX09-GEN-REASON                             IMIB004
229500         MOVE '00' TO WMS-STATUS
229550         MOVE 'SU' TO IMEX-CODE-1
229600         MOVE 'SD' TO IMEX-CODE-2
229650         MOVE '09' TO IMEX-REC-NO
229700         MOVE '04' TO EX09-STATUS-IN
229750         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
229800         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
229850         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM005
229860         MOVE SPACES TO WMS-DATE-CLOSED                           0902079
229870         MOVE '00' TO WMS-REASON-CLOSED                           0902079
229900         GO TO K0339.
229910*----------------------------------------------------------------*9915749
229912*    ABANDONED ACCOUNTS POST THE SAME AS DORMANT ACCOUNTS.       *9915749
229914*    BUT DO NOT CHANGE THE ACCOUNT STATUS.                       *9915749
229916*----------------------------------------------------------------*9915749
229920     IF  WBC-POST-DORM    EQUAL TO '4'                            0266741
229922     AND WMS-STATUS EQUAL TO '10'                                 9915749
229924         GO TO K0320.                                             9915749
229950     IF WBC-POST-DORM    EQUAL TO '4'                             0266741
230000         AND WMS-STATUS EQUAL TO '06'
230010         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
230015         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
230020         MOVE '51' TO EX09-GEN-REASON                             IMIB004
230050         MOVE '00' TO WMS-STATUS
230100         MOVE 'SU' TO IMEX-CODE-1
230150         MOVE 'SD' TO IMEX-CODE-2
230200         MOVE '09' TO IMEX-REC-NO
230250         MOVE '06' TO EX09-STATUS-IN
230300         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
230350         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
230400         MOVE '*'          TO EX09-GEN-STAT
230450         MOVE DDA-TRANS-REACT-NS-LIT(SIWS-LANG-SUB)               0266741
230500             TO EX09-GEN-DESC
230550         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM005
230600         GO TO K0320.
230650     IF WBC-POST-INACTIVE EQUAL TO '4'                            0266741
230700         AND WMS-STATUS EQUAL TO '07'
230710         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
230715         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
230720         MOVE '51' TO EX09-GEN-REASON                             IMIB004
230750         MOVE '00' TO WMS-STATUS
230800         MOVE 'SU' TO IMEX-CODE-1
230850         MOVE 'SD' TO IMEX-CODE-2
230900         MOVE '09' TO IMEX-REC-NO
230950         MOVE '07' TO EX09-STATUS-IN
231000         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
231050         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
231100         MOVE '*'          TO EX09-GEN-STAT
231150         MOVE DDA-TRANS-REACT-NS-LIT(SIWS-LANG-SUB)               0266741
231200             TO EX09-GEN-DESC
231250         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM005
231300 K0320.
231350     IF  STATUS-IN EQUAL '06' OR WMS-STATUS EQUAL '06'
231400         MOVE 'H0' TO IMEX-CODE-1
231450         MOVE '071' TO WK-REJ-REASON                              0717565
231460         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
231500         MOVE '1' TO TRAN-REWRITE-SW
231550         GO TO K0330.
231600     IF  STATUS-IN EQUAL '07' OR WMS-STATUS EQUAL '07'
231650         MOVE 'H1' TO IMEX-CODE-1
231700         MOVE '072' TO WK-REJ-REASON                              0717565
231710         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
231750         MOVE '1' TO TRAN-REWRITE-SW
231800         GO TO K0330.
231810     IF  STATUS-IN EQUAL '10' OR WMS-STATUS EQUAL '10'            9915749
231812         MOVE 'HK' TO IMEX-CODE-1                                 9915749
231814         MOVE '071' TO WK-REJ-REASON                              0717565
231816         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 9915749
231818         MOVE '1' TO TRAN-REWRITE-SW                              9915749
231820         GO TO K0330.                                             9915749
231850     GO TO K0339.
231900 K0330.
231902*----------------------------------------------------------------*9915749
231904*    CREATE UNIQUE EXCEPTION RECORD FOR ACH TRANSACTIONS         *9915749
231906*    WHICH DO NOT POST.                                          *9915749
231908*----------------------------------------------------------------*9915749
231910     IF  EXCODE-1 EQUAL 'A0'                                      9915749
231912         MOVE '1' TO UNPOST-TODAY                                 9915749
231914         IF TR-80-TYPE EQUAL '03' OR '10' OR '12' OR '14'         9915749
231916             MOVE 'A8' TO EXCODE-1.                               9915749
231950     MOVE '13'        TO IMEX-REC-NO.                             IM002
231970     MOVE TR-TRAN80-A TO IMEX-REC-13A.                            IM002
231972     IF  TR-POST-PRIORITY EQUAL '0A' OR '3A'                      9915749
231973         MOVE TR-LP-TOT-AMT TO EX13-AMT                           9915749
231974     ELSE                                                         9915749
231975         MOVE TR-AMOUNT TO EX13-AMT.                              1105504
231980     MOVE TR-USER-CODE TO EX13-USER-CODE.                         IM006
231981     MOVE TR-COMB-PLN-CODES TO EX13-COMB-PLN-CODES.               0617360
231982     MOVE TR-PLN-CAL-YR     TO EX13-PLN-CAL-YR.                   0617360
231983     MOVE TR-PLN-TAX-YR     TO EX13-PLN-TAX-YR.                   0617360
231985     MOVE TR-TRAN-TYPE           TO EX13-TYPE.                    9915845
231990     MOVE TR-TRAN80-B TO IMEX-REC-13B.                            IM002
232100     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.
232107     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              IM002
232108     OR  TR-CURRENCY-FLAG EQUAL '1'                               9916381
232110         MOVE '1'  TO SRC-INFO-LENGTH-FLG                         IM006
232114         MOVE '22' TO IMEX-REC-NO                                 IM002
232121         SUBTRACT +302 FROM TF-LENGTH GIVING EX-22                0637566
232128         ADD EX-13 TO EX-22                                       IM002
232129         IF  TR-CURRENCY-FLAG EQUAL '1'                           9916381
232130             MOVE TR-CURRENCY-INFO TO EX22-CURRENCY-INFO          9916381
232131         ELSE                                                     9916381
232132             MOVE SPACES           TO EX22-CURRENCY-INFO.         9916381
232133     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              9916381
232135         MOVE TR-UNIV-DESC-TRAN TO EX22-RMDR.                     IM002
232136     IF  ACCT-NOT-FOUND EQUAL '1'                                 9915239
232138         MOVE ZERO TO EX13-AMT-AVAIL                              9915239
232140     ELSE                                                         9915239
232142         MOVE CUR-BAL TO EX13-AMT-AVAIL                           9915239
232144         IF  SAVINGS-PRESENT EQUAL TO '1'                         9915239
232146             ADD WMS-INT-CUR-BAL TO EX13-AMT-AVAIL.               9915239
232150     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
232200 K0339.  EXIT.
232250 K0340.
232300     IF TR-80-TYPE2 NOT EQUAL TO '3', GO TO K0344.
232350     IF TR-80-TYPE1 NOT EQUAL TO '0', GO TO K0344.
232400     IF WBC-EXC-CODE (9) NOT EQUAL TO '1', GO TO K0344.           0266741
232450     MOVE '09' TO IMEX-CODE-1.
232500     PERFORM K0330 THRU K0339.
232550 K0344.  EXIT.
232600 K0345.
232650     MOVE '1' TO RHA-CHECK-ITEM.
232700     PERFORM K0756 THRU K0756-EXIT.
232750     MOVE '0' TO RHA-CHECK-ITEM.
232800     IF TR-80-TYPE EQUAL '06'
232850         PERFORM K0347 THRU K0347-EXIT                            IM002
232950         IF  WMS-HIFI-INDICATOR EQUAL +0
233000         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
233100             PERFORM X0850 THRU X0880-RHR-EXIT                    0903344
233150         ELSE
233200             NEXT SENTENCE
233250     ELSE
233300         ADD +1 TO WMS-STMT-NO-DEBITS
233350         ADD TR-AMOUNT TO WMS-STMT-DR-AMT.
233400     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
233450         IF  WMS-HIFI-INDICATOR EQUAL +0
233500         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
233600             PERFORM X0850 THRU X0880-RHR-EXIT.                   0903344
233650     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
233700     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
233750 K0346.
233800     IF  TR-OPTION (7) EQUAL '1' OR '3' OR '5' OR '7'             IM005
233850         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
233900             MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-WITHDRAWAL
233950            MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-WITHDRAWAL0266741
234000                                     WMS-DATE-LAST-CUST-ACTIVITY
234050         ELSE
234100             PERFORM K0117 THRU K0118-EXIT.                       9915845
234150     GO TO K7000.
234154 K0347.                                                           IM002
234158     SUBTRACT TR-ITEM-COUNT FROM WMS-STMT-NO-CREDITS.             IM002
234162     SUBTRACT TR-AMOUNT FROM WMS-STMT-CR-AMT.                     IM002
234169     IF  WMS-STMT-NO-CREDITS LESS THAN +0                         IM006
234170         ADD TR-ITEM-COUNT TO WMS-STMT-NO-CREDITS                 IM002
234174         ADD +1            TO WMS-STMT-NO-DEBITS.                 IM002
234178     IF  WMS-STMT-CR-AMT LESS THAN +0.00                          IM002
234182         ADD TR-AMOUNT     TO WMS-STMT-CR-AMT                     IM002
234186                              WMS-STMT-DR-AMT.                    IM002
234187     IF (WMS-PLAN-TRLR EQUAL '1')                                 0617360
234188     AND (HOLD-BKDT-YR NOT EQUAL SPACES)                          0617360
234189     AND (HOLD-BKDT-YR NOT EQUAL WBC-CAPTURE-YR)                  0617360
234190         SUBTRACT TR-AMOUNT FROM WMS-PLN-TRLR-YTD-BEG-BAL.        0617360
234191 K0347-EXIT.                                                      0617360
234194     EXIT.                                                        IM002
234200 K0350-UNPOST.
234210*----------------------------------------------------------------*9915749
234212*    SET CAPITAL MARKET IND TO 'Y' IF POSTING PRIORITY IS '59'   *9915749
234214*----------------------------------------------------------------*9915749
234216     IF  TR-POST-PRIORITY EQUAL '59'                              9915749
234218         MOVE 'Y' TO EX13-CAPITAL-MKT-IND                         9915749
234220     ELSE                                                         9915749
234222         MOVE ' ' TO EX13-CAPITAL-MKT-IND.                        9915749
234250     ADD +1 TO DDA-UP-DB-NO, WS-GL-DDA-UP-DB-NO.                  0902970
234300     ADD TR-AMOUNT TO DDA-UP-DB-AMT, WS-GL-DDA-UP-DB-AMT.         0902970
234310*                                                                 2016639
234312 K0380.                                                           2016639
234314*--------------------------------------------------------------*  2016639
234316*    CREATE Q7 EXCEPTION FOR EXTERNAL INVESTMENT REJECTS       *  2016639
234318*--------------------------------------------------------------*  2016639
234320     IF  WBC-XINV-INSTALLED   EQUAL  '1' OR '3'                   0266741
234322         IF  TR-USER-CODE     EQUAL  WBC-XINV-DDA-DR-CODE         0266741
234324                                 OR  WBC-XINV-DDA-CR-CODE         0266741
234326         OR  WMS-XINV-LINK-IND EQUAL 'P'                          2016639
234328             PERFORM R9130-Q7  THRU  R9199-EXIT.                  2016639
234350*                                                                 2016639
234351*----------------------------------------------------------------*9915749
234352*    CREATE UNIQUE EXCEPTION RECORD FOR UNPOSTED ACH TRANSACTION *9915749
234353*----------------------------------------------------------------*9915749
234400     MOVE '1' TO UNPOST-TODAY.
234450     MOVE 'A0' TO EXCODE-1.
234460     IF  TR-80-TYPE EQUAL '03' OR '10' OR '12' OR '14'            9915749
234465         MOVE 'A8' TO EXCODE-1.                                   9915749
234508     MOVE '13' TO RECNO.                                          IM002
234528     MOVE TR-TRAN80-A TO IMEX-REC-13A.                            IM002
234533     MOVE TR-AMOUNT   TO EX13-AMT.                                IM006
234538     MOVE TR-USER-CODE TO EX13-USER-CODE.                         IM006
234539     MOVE TR-COMB-PLN-CODES TO EX13-COMB-PLN-CODES.               0617360
234540     MOVE TR-PLN-CAL-YR     TO EX13-PLN-CAL-YR.                   0617360
234541     MOVE TR-PLN-TAX-YR     TO EX13-PLN-TAX-YR.                   0617360
234543     MOVE TR-TRAN-TYPE           TO EX13-TYPE.                    9915845
234548     MOVE TR-TRAN80-B TO IMEX-REC-13B.                            IM002
234650     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.
234652     IF  WBC-NONPOST-HIST-OPT EQUAL 'Y'                           0737697
234653         MOVE 'R' TO TR-PEND-DECISION                             0737697
234654                     EX13-NB-PEND-DEC-IND                         0737697
234655         ADD +1 TO SEQ-CTR.                                       0737697
234657     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              IM002
234659     OR  TR-CURRENCY-FLAG EQUAL '1'                               9916381
234660         MOVE '1'  TO SRC-INFO-LENGTH-FLG                         0265982
234664         MOVE '22' TO RECNO                                       IM002
234671         SUBTRACT +273 FROM TF-LENGTH GIVING EX-22                2011293
234678         ADD EX-13 TO EX-22                                       IM002
234679         IF  TR-CURRENCY-FLAG EQUAL '1'                           9916381
234680             MOVE TR-CURRENCY-INFO TO EX22-CURRENCY-INFO          9916381
234681         ELSE                                                     9916381
234682             MOVE SPACES           TO EX22-CURRENCY-INFO.         9916381
234683     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              9916381
234685         MOVE TR-UNIV-DESC-TRAN TO EX22-RMDR.                     IM002
234700     IF ACCT-NOT-FOUND EQUAL '1'
234750        MOVE ZERO TO EX13-AMT-AVAIL                               IM002
234800        GO TO UNPOST-EXCEPT.
234850     MOVE CUR-BAL TO EX13-AMT-AVAIL.                              IM002
234900     IF SAVINGS-PRESENT EQUAL TO '1'
234950         ADD WMS-INT-CUR-BAL TO EX13-AMT-AVAIL.                   IM002
235000     GO TO UNPOST-EXCEPT.
235050 K0385.
235052*----------------------------------------------------------------*9915749
235054*    CREATE UNIQUE EXCEPTION RECORD FOR UNPOSTED ACH TRANSACTION *9915749
235056*----------------------------------------------------------------*9915749
235058     IF  EXCODE-1 EQUAL 'A5' OR 'A6'                              9915749
235060         IF  TR-80-TYPE EQUAL '03' OR '10' OR '12' OR '14'        9915749
235062             MOVE 'A8' TO EXCODE-1.                               9915749
235100     MOVE '13' TO RECNO.
235120     MOVE TR-TRAN80-A TO IMEX-REC-13A.                            IM002
235125     MOVE TR-AMOUNT   TO EX13-AMT.                                IM006
235130     MOVE TR-USER-CODE TO EX13-USER-CODE.                         IM006
235131     MOVE TR-COMB-PLN-CODES TO EX13-COMB-PLN-CODES.               0617360
235132     MOVE TR-PLN-CAL-YR     TO EX13-PLN-CAL-YR.                   0617360
235133     MOVE TR-PLN-TAX-YR     TO EX13-PLN-TAX-YR.                   0617360
235135     MOVE TR-TRAN-TYPE           TO EX13-TYPE.                    9915845
235140     MOVE TR-TRAN80-B TO IMEX-REC-13B.                            IM002
235142     IF  WBC-NONPOST-HIST-OPT EQUAL 'Y'                           0737697
235143         MOVE 'R' TO TR-PEND-DECISION                             0737697
235144                     EX13-NB-PEND-DEC-IND                         0737697
235145         ADD +1 TO SEQ-CTR.                                       0737697
235250     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.
235257     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              IM002
235260     OR  TR-CURRENCY-FLAG EQUAL '1'                               9916381
235261         MOVE '1'  TO SRC-INFO-LENGTH-FLG                         0265982
235264         MOVE '22' TO RECNO                                       IM002
235271         SUBTRACT +273 FROM TF-LENGTH GIVING EX-22                2011293
235278         ADD EX-13 TO EX-22                                       IM002
235280         IF  TR-CURRENCY-FLAG EQUAL '1'                           9916381
235281             MOVE TR-CURRENCY-INFO TO EX22-CURRENCY-INFO          9916381
235282         ELSE                                                     9916381
235283             MOVE SPACES           TO EX22-CURRENCY-INFO.         9916381
235284     IF  TR-UNIV-DESC-FLAG EQUAL '1'                              9916381
235285         MOVE TR-UNIV-DESC-TRAN TO EX22-RMDR.                     IM002
235300     GO TO UNPOST-EXCEPT.
235350     SKIP3
235400*    ****************  DEPOSIT PROCESSING  *****************
235450     SKIP1
235500 K0400.
235550     IF WMS-STATUS EQUAL TO '00', GO TO K0450.
235600     IF WMS-STATUS EQUAL TO '01'
235650         MOVE '010' TO REJRESN                                    0717565
235700         GO TO K0550-UNPOST.
235750     IF WMS-STATUS EQUAL TO '03'
235800         MOVE '005' TO REJRESN                                    0717565
235850         GO TO K0550-UNPOST.
235852     IF WMS-STATUS EQUAL TO '11'                                  1010046
235854         IF (TR-OPTION (7) NOT EQUAL '1' AND '3' AND '5' AND '7') 1010046
235856         MOVE '005' TO REJRESN                                    1010046
235858         GO TO K0550-UNPOST.                                      1010046
235900     IF WMS-STATUS EQUAL TO '04'
235950         IF TR-OPTION (4) LESS THAN '4'
236000             MOVE '019' TO REJRESN                                0717565
236050             GO TO K0550-UNPOST.
236100     IF WMS-STATUS EQUAL TO '08'
236150         MOVE '009' TO REJRESN                                    0717565
236200         GO TO K0550-UNPOST.
236250 K0450.
236300     IF WMS-MTD-ANALYSIS EQUAL '3' OR '4' OR '5'                  9915749
236350         MOVE SPACES TO IMEX-REC-13
236400         MOVE '13' TO IMEX-REC-NO
236450         MOVE 'FA' TO IMEX-CODE-1
236500         MOVE 'F3' TO IMEX-CODE-2
236550         MOVE TR-REJ-PROG TO EX13-REJ-PROG
236600         MOVE TR-REJ-RESN TO EX13-REJ-RESN
236650         MOVE TR-BATCH TO EX13-BATCH
236700         MOVE TR-SEQ TO EX13-SEQ
236750         MOVE TR-AMOUNT TO EX13-AMT
236800         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
236850     IF NSF-CALC-FLAG EQUAL TO '0'
236900         PERFORM K0100 THRU K0105.
236910     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
236920         PERFORM K0106 THRU K0106-EXIT.                           IM003
236950     IF  LIST-POST-CR-FLAG  EQUAL '1' OR '2'                      0827768
237000         IF  (TR-OPTION (5) EQUAL TO '1' OR '3' OR '5' OR '7') AND
237050             (TR-80-TYPE NOT EQUAL '06' AND '08' AND '12' AND '13'
237100             AND '14')
237110             MOVE '1'            TO LIST-POST-ITEM                0827768
237150             GO TO K0545.
237200     ADD +1 TO FS-CR.
237250     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
237300         PERFORM K7200 THRU K8500.
237350     ADD TR-AMOUNT TO WMS-CURR-BAL                                IM003
237360                      CUR-BAL                                     IM003
237365                      CUST-BAL.                                   1020116
237366     IF WMS-CURR-BAL NOT LESS THAN ZERO                           1020116
237367         MOVE +0   TO WMS-OD-REGE-SUST-CTR.                       1020116
237371*----------------------------------------------------------------*9915749
237372*    ZERO FEE CHRG OFF FIELDS WHEN WMS-CURR-BAL IS NOT NEGATIVE  *9915749
237373*    AND REDUCE FEE CHRG OFF FIELDS FOR REVERSAL TRANSACTIONS.   *9915749
237374*                                                                *9915749
237375*    CREATE EXCEPTION RECORD FOR THE POSTED FUNDING TRANSACTION. *9915749
237376*    THIS EXCEPTION RECORD MAY BE USED TO PRODUCE ODP NOTICES.   *9915749
237377*                                                                *9915749
237378*    CHANGE STATUS OF FUNDING FLAG TO SHOW THAT THE FUNDING      *9915749
237379*    CREDIT HAS BEEN POSTED TO THIS ACCOUNT.                     *9915749
237380*----------------------------------------------------------------*9915749
237381*    ADD A COUNT INTO THE DEPOSIT COUNTER SC ACCM BUCKET         *9915749
237382*    TO AUTOMATIC COUNT OF ALL DEPOSITS.                         *9915749
237383*----------------------------------------------------------------*9915749
237384     IF  WMS-CURR-BAL LESS THAN ZERO                              9915749
237385         NEXT SENTENCE                                            9915749
237386     ELSE                                                         9915749
237387         MOVE ZERO TO WMS-NB-CHRG-OFF-NSF                         9915749
237388                      WMS-NB-CHRG-OFF-SC.                         9915749
237390     IF  TR-USER-CODE EQUAL WBC-FUND-IM-CR-CODE                   0266741
237391         MOVE 'FT' TO IMEX-CODE-1                                 9915749
237392         MOVE 'F4' TO IMEX-CODE-2                                 9915749
237393         PERFORM K0330 THRU K0339                                 9915749
237394         MOVE TRAN-REC TO SAVE-FUNDING-TRANS                      9915749
237395         MOVE '2' TO FUNDING-FLAG.                                9915749
237400     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
237450     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
237500         ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                     0902970
237550         ADD TR-AMOUNT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT            0902970
237600     ELSE
237650         ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                     0902970
237700         ADD TR-AMOUNT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.           0902970
237750     MOVE '1' TO POST-TODAY.
237752     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0717614
237758     IF WMS-KITING-SUSP-TRLR EQUAL '1'                            IM006
237766         IF (TR-OPTION (5) EQUAL '2' OR '3' OR '6' OR '7') AND    IM006
237768            (TR-80-TYPE NOT EQUAL '06' AND '08'                   IM006
237769                              AND '12' AND '13' AND '14')         IM006
237770             MOVE '1' TO KITE-ITEM-FLAG                           IM006
237774             ADD TR-ITEM-COUNT TO WMS-KITE-TODAY-CR-NO (7)        IM006
237782             ADD TR-AMOUNT TO WMS-KITE-TODAY-CR-AMT (7).          IM006
237800     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
237805         IF  WK-DEP-ACCM NUMERIC                                  9915749
237810         AND WK-DEP-ACCM GREATER THAN ZERO                        9915749
237815             ADD +1              TO WMS-SC-MISC-NOS (WK-DEP-ACCM).9915749
237820*                                                                 9915749
237825     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                           9915749
237850         IF  TR-SOURCE2 EQUAL '1'
237900         AND TR-SOURCE1 EQUAL '0'
237950             ADD +1 TO WMS-LOW-SPEED-ITEMS
238000                       WMS-MTD-LOW-SPEED-ITEMS
238050             ADD TR-AMOUNT TO WMS-CARD-ENTRY
238100         ELSE
238150             ADD +1 TO WMS-HI-SPEED-ITEMS, WMS-MTD-HI-SPEED-ITEMS.
238200     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
238250     MOVE TR-OPTION9 (3) TO HOLD-OPT.
238300     IF HOLD-OPT GREATER THAN +3
238350         SUBTRACT +4 FROM HOLD-OPT
238400         MOVE '1' TO AUTO-DEP-REC-TODAY
238450         IF AUTO-DEP-DUE-TODAY NOT EQUAL TO '1'
238500             MOVE 'GD' TO IMEX-CODE-1
238550             PERFORM K0330 THRU K0339.
238600     IF HOLD-OPT GREATER THAN +1
238650         SUBTRACT +2 FROM HOLD-OPT
238700         ADD +1 TO WMS-SC-CREDITS, WMS-MTD-SVC-CHG-CR             2016374
238705         IF  WMS-BIR-FLAG EQUAL '1' OR '2'                        2016374
238710             ADD +1 TO WMS-BIR-MTD-DP-NBR                         2016374
238715             ADD TR-AMOUNT TO WMS-BIR-MTD-DP-AMT.                 2016374
238750     IF HOLD-OPT GREATER THAN +0
238760         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R'        0417110
238762                                      OR 'U' OR 'E'               0417110
238800             ADD +1 TO WMS-STMT-ITEMS.                            1105504
238850     IF TR-OPTION (4) EQUAL '1' OR '3' OR '5' OR '7'
238900         ADD +1 TO WMS-SC-TRAN-NO, WMS-MTD-TRN-NO
238950         ADD TR-AMOUNT TO WMS-SC-TRAN-AMT, WMS-MTD-TRAN-AMT.
239000 K0500.
239050     ADD +1 TO SEQ-CTR.
239100     PERFORM K0756 THRU K0756-EXIT.
239150     IF TR-80-TYPE EQUAL '06'
239200         PERFORM K0751 THRU K0751-EXIT                            IM002
239300         IF  WMS-HIFI-INDICATOR EQUAL +0
239350         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
239450             PERFORM X0850 THRU X0880-RHR-EXIT                    0903344
239500         ELSE
239550             NEXT SENTENCE
239600     ELSE
239650         ADD +1 TO WMS-STMT-NO-CREDITS
239700         ADD TR-AMOUNT TO WMS-STMT-CR-AMT.
239750     ADD TR-AMOUNT TO WMS-TODAYS-CREDITS.
239800     ADD +1 TO WMS-TODAYS-CREDITS-NO.
239850     PERFORM K0320 THRU K0344.
239900     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
239950         IF  WMS-HIFI-INDICATOR EQUAL +0
240000         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
240100             PERFORM X0850 THRU X0880-RHR-EXIT.                   0903344
240150     IF  WMS-YR2-LD EQUAL SPACE
240200         MOVE TR-AMOUNT TO WMS-OPENING-DEPOSIT.
240250 K0505.
240252     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
240254         ADD TR-AMOUNT   TO T3-PLAN-CRD-AMT                       0617360
240256                            WS-GL-PLAN-CRD-AMT                    0617360
240258         MOVE 'X'        TO WS-PLN-TRLR-FULL                      0617360
240260         MOVE TR-AMOUNT  TO WS-WORK-CTDT-AMT                      0617360
240261         PERFORM CHECK-PLAN-REV THRU CPR-END                      0617360
240262         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0617360
240264         PERFORM UPDATE-PLN-LTD THRU UPLT-EXIT                    0617360
240266         MOVE 'PT'       TO IMEX-CODE-1                           0617360
240268         PERFORM K0330 THRU K0339.                                0617360
240300     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
240350     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
240400     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
240450         GO TO K0510.
240500     MOVE TR-AMOUNT TO WMS-AMT-LAST-DEPOSIT.
240550     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-DEPOSIT.              0266741
240600     GO TO K0520.
240650 K0510.
240700     MOVE HOLD-BKDT-DATE TO DT-HIGH-DATE.
240750     MOVE WMS-DATE-LAST-DEPOSIT TO DT-LOW-DATE.
240800     CALL 'SIDIF1' USING DATE-AREA.
240850     IF RET-DAYS GREATER THAN ZERO OR
240900         WMS-DATE-LAST-DEPOSIT EQUAL SPACES
240950         MOVE HOLD-BKDT-DATE TO WMS-DATE-LAST-DEPOSIT
241000         MOVE TR-AMOUNT TO WMS-AMT-LAST-DEPOSIT.
241005 K0510-EXIT.                                                      9915845
241010       EXIT.                                                      9915845
241050 K0520.
241055     IF WMS-SAVINGS-TRLR EQUAL '1'                                1004773
241060     AND WMS-INT-INV-IND EQUAL 'Y'                                1004773
241065         NEXT SENTENCE                                            1004773
241070     ELSE                                                         1004773
241075         IF TR-OPTION (7) EQUAL '4' OR '5' OR '6' OR '7'          1004773
241080             ADD TR-AMOUNT TO WBC-REG-TFR-AMT (9).                0266741
241100     IF TR-OPTION (4) EQUAL '2' OR '3' OR '6' OR '7'
241150         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
241200         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-DEPOSIT
241250         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-DEPOSIT      0266741
241300                                 WMS-DATE-LAST-CUST-ACTIVITY.
241310     IF  TR-OPTION (7) EQUAL '2' OR '3'                           IM007
241320         MOVE '1' TO SEND-EFAA-NOTICE.                            IM007
241325 K0520-EXIT.                                                      9915845
241330       EXIT.                                                      9915845
241350 K0521.
241400     IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
241450         GO TO K0530.
241500     IF TR-OPTION (4) EQUAL '2' OR '3' OR '6' OR '7'
241550         NEXT SENTENCE
241600     ELSE GO TO K0530.
241650     PERFORM K0118 THRU K0118-EXIT.                               9915845
241700 K0525.
241750     MOVE HOLD-BKDT-DATE TO DT-HIGH-DATE.
241800     MOVE WMS-DATE-LAST-CUST-DEPOSIT TO DT-LOW-DATE.
241850     CALL 'SIDIF1' USING DATE-AREA.
241900     IF RET-DAYS GREATER THAN ZERO OR
241950         WMS-DATE-LAST-CUST-DEPOSIT EQUAL SPACES
242000         MOVE HOLD-BKDT-DATE TO WMS-DATE-LAST-CUST-DEPOSIT
242050         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-DEPOSIT.
242055 K0525-EXIT.                                                      9915845
242060       EXIT.                                                      9915845
242100 K0530.
242150     IF WMS-STATUS EQUAL TO '04'
242160         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
242165         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
242170         MOVE '51' TO EX09-GEN-REASON                             IMIB004
242200         MOVE '00' TO WMS-STATUS
242250         MOVE 'SU' TO IMEX-CODE-1
242300         MOVE 'SD' TO IMEX-CODE-2
242350         MOVE '09' TO IMEX-REC-NO
242400         MOVE '04' TO EX09-STATUS-IN
242450         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
242500         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
242550         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM005
242560         MOVE SPACES TO WMS-DATE-CLOSED                           0902079
242570         MOVE '00' TO WMS-REASON-CLOSED                           0902079
242600         GO  TO  K0540-EXIT.
242610*----------------------------------------------------------------*9915749
242612*    POST ABANDONED ACCOUNTS THE SAME AS DORMANT.                *9915749
242614*    DO NOT ALLOW THE ACCOUNT STATUS TO CHANGE                   *9915749
242616*----------------------------------------------------------------*9915749
242618     IF  WBC-POST-DORM    EQUAL TO '2' OR '4'                     0266741
242620         IF  WMS-STATUS EQUAL TO '10'                             9915749
242622             GO TO K0540-EXIT.                                    9915749
242650     IF WBC-POST-DORM    EQUAL TO '2' OR '4'                      0266741
242700         IF WMS-STATUS EQUAL TO '06'
242710         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
242715         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
242720         MOVE '51' TO EX09-GEN-REASON                             IMIB004
242750         MOVE '00' TO WMS-STATUS
242800         MOVE 'SU' TO IMEX-CODE-1
242850         MOVE 'SD' TO IMEX-CODE-2
242900         MOVE '09' TO IMEX-REC-NO
242950         MOVE '06' TO EX09-STATUS-IN
243000         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
243050         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
243100         MOVE '*'          TO EX09-GEN-STAT
243150         MOVE DDA-TRANS-REACT-NS-LIT(SIWS-LANG-SUB)               0266741
243200             TO EX09-GEN-DESC
243250         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM005
243300         GO  TO  K0540-EXIT.
243350     IF WBC-POST-INACTIVE EQUAL TO '2' OR '4'                     0266741
243400         IF WMS-STATUS EQUAL TO '07'
243410             MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE    IMIB004
243415             MOVE '51' TO WMS-REASON-CLOSED                       IMIB004
243420             MOVE '51' TO EX09-GEN-REASON                         IMIB004
243450             MOVE '00' TO WMS-STATUS
243500             MOVE 'SU' TO IMEX-CODE-1
243550             MOVE 'SD' TO IMEX-CODE-2
243600             MOVE '09' TO IMEX-REC-NO
243650             MOVE '07' TO EX09-STATUS-IN
243700             MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
243750             MOVE WMS-CURR-BAL TO EX09-CUR-BAL
243800             MOVE '*'          TO EX09-GEN-STAT
243850             MOVE DDA-TRANS-REACT-NS-LIT(SIWS-LANG-SUB)           0266741
243900                 TO EX09-GEN-DESC
243950             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             IM005
244000 K0540-EXIT. EXIT.
244050 K0542.
244100     IF  WMS-LOAN-TRLR EQUAL TO '1'                               9915749
244110         IF  WMS-NB-DC-ABM NOT EQUAL '1'                          9915749
244150             ADD TR-AMOUNT TO WMS-DDA-DEPOSITS.                   1105504
244200     GO TO K7000.
244250 K0545.
244300     PERFORM K0505 THRU K0520-EXIT.                               9915845
244350     IF  WBC-LIST-POST-DETAIL EQUAL '1'                           0266741
244400         MOVE HIGH-VALUES TO TR-STMT-SYM
244450         MOVE '1' TO TRAN-REWRITE-SW.
244500     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.                    IM005
244510     GO TO K7000.                                                 IM005
244550 K0550-UNPOST.
244600     ADD TR-AMOUNT TO DDA-UP-CR-AMT, WS-GL-DDA-UP-CR-AMT.         0902970
244650     ADD +1 TO DDA-UP-CR-NO, WS-GL-DDA-UP-CR-NO.                  0902970
244700     GO TO K0380.
244750     SKIP3
244800 INCORE-SECTION-A    SECTION 20.
244850     SKIP3
244900*    *****************  CREDIT PROCESSING  *****************
244950     SKIP1
245000 K0600.
245005     IF  LIST-POST-CR-FLAG    EQUAL '2'                           0827768
245010         IF  (TR-OPTION (18)  EQUAL '4' OR '5' OR '6')            0827768
245015         AND (TR-80-TYPE  NOT EQUAL '06' AND '08' AND '12'        0827768
245020         AND '13' AND '14')                                       0827768
245025             MOVE '1'            TO LIST-POST-ITEM                0827768
245030             GO TO K0612.                                         0827768
245050     IF WMS-STATUS EQUAL TO '00', GO TO K0610.
245100     IF WMS-STATUS EQUAL TO '01'
245150         IF  TR-OPTION (10) EQUAL '1' OR '5' OR '7'
245200             NEXT SENTENCE
245250         ELSE
245300             MOVE '010' TO REJRESN                                0717565
245350             GO TO K0550-UNPOST.
245400     IF WMS-STATUS EQUAL TO '03'
245450         MOVE '005' TO REJRESN                                    0717565
245500         GO TO K0550-UNPOST.
245502     IF WMS-STATUS EQUAL TO '11'                                  1010046
245504         IF (TR-OPTION (17) NOT EQUAL '4' AND '5' AND '6')        1010046
245506         MOVE '005' TO REJRESN                                    1010046
245508         GO TO K0550-UNPOST.                                      1010046
245550     IF WMS-STATUS EQUAL TO '04'
245600         IF TR-OPTION (7) LESS THAN '4'
245650         MOVE '019' TO REJRESN                                    0717565
245700         GO TO K0550-UNPOST.
245750     IF WMS-STATUS EQUAL TO '08'
245800         MOVE '009' TO REJRESN                                    0717565
245850         GO TO K0550-UNPOST.
245852 K0610.                                                           0617360
245910     IF  TR-OPTION (14) EQUAL '4' OR '5' OR '6' OR '7'            1004773
245920         IF (WMS-CURR-BAL + TR-AMOUNT) NOT EQUAL ZERO             1004773
245930             MOVE '038' TO REJRESN                                0717565
245940             GO TO K0550-UNPOST.                                  1004773
245950     IF  TR-OPTION (9) EQUAL '4' OR '5' OR '7'
246000         IF  WMS-ACH-FLAG EQUAL '2' OR '3'
246050             NEXT SENTENCE
246100         ELSE
246150             MOVE '013' TO REJRESN                                0717565
246200             GO TO K0550-UNPOST.
246210 K0612.                                                           0827768
246250     IF  TR-OPTION (9) EQUAL '4' OR '5' OR '7'
246300         IF  TR-AMOUNT EQUAL ZERO
246350             MOVE 'PN' TO IMEX-CODE-1                             0903034
246400             PERFORM K0330 THRU K0339.                            0903034
246450     IF NSF-CALC-FLAG EQUAL TO '0'
246500         PERFORM K0100 THRU K0105.
246506     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
246512         PERFORM K0106 THRU K0106-EXIT.                           IM003
246513     IF  LIST-POST-CR-FLAG    EQUAL '2'                           0827768
246514     AND (TR-OPTION (18)      EQUAL '4' OR '5' OR '6')            0827768
246515     AND (TR-80-TYPE      NOT EQUAL '06' AND '08' AND '12'        0827768
246516     AND '13' AND '14')                                           0827768
246517         MOVE '1'                TO LIST-POST-ITEM                0827768
246518     ELSE                                                         0827768
246519         GO TO K0615.                                             0827768
246520***  PROCESS LIST POST ITEMS                                      0827768
246521     IF  WMS-PLAN-TRLR        EQUAL '1'                           0827768
246522         ADD TR-AMOUNT           TO T3-PLAN-CRD-AMT               0827768
246523                                    WS-GL-PLAN-CRD-AMT            0827768
246524         MOVE 'X'                TO WS-PLN-TRLR-FULL              0827768
246525         MOVE TR-AMOUNT          TO WS-WORK-CTDT-AMT              0827768
246526         PERFORM CHECK-PLAN-REV  THRU CPR-END                     0827768
246527         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0827768
246528         PERFORM UPDATE-PLN-LTD  THRU UPLT-EXIT                   0827768
246529         MOVE 'PT'               TO IMEX-CODE-1                   0827768
246530         PERFORM K0330 THRU K0339.                                0827768
246531     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.                    0827768
246532     IF  WBC-LIST-POST-DETAIL EQUAL '1'                           0827768
246533         MOVE HIGH-VALUES        TO TR-STMT-SYM                   0827768
246534         MOVE '1'                TO TRAN-REWRITE-SW.              0827768
246540     GO TO K0761.                                                 0827768
246545 K0615.                                                           0827768
246550     ADD +1 TO FS-CR.
246600     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
246650         PERFORM K7200 THRU K8500.
246700     ADD TR-AMOUNT TO WMS-CURR-BAL                                IM003
246710                      CUR-BAL                                     IM003
246720                      CUST-BAL.                                   IM003
246722     IF WMS-CURR-BAL NOT LESS THAN ZERO                           1020116
246723         MOVE +0   TO WMS-OD-REGE-SUST-CTR.                       1020116
246750     ADD TR-AMOUNT TO WMS-TODAYS-CREDITS.
246751*----------------------------------------------------------------*9915749
246752*    ZERO FEE CHRG OFF FIELDS WHEN WMS-CURR-BAL IS NOT NEGATIVE  *9915749
246753*    AND REDUCE FEE CHRG OFF FIELDS FOR REVERSAL TRANSACTIONS.   *9915749
246754*----------------------------------------------------------------*9915749
246755     IF  WMS-CURR-BAL LESS THAN ZERO                              9915749
246756         NEXT SENTENCE                                            9915749
246757     ELSE                                                         9915749
246758         MOVE ZERO TO WMS-NB-CHRG-OFF-NSF                         9915749
246759                      WMS-NB-CHRG-OFF-SC                          9915749
246760         GO TO K0616.                                             9915749
246761     IF  TR-OPTION (13) EQUAL '1' OR '3' OR '5' OR '7'            9915749
246762         MOVE ZERO TO WMS-NB-CHRG-OFF-NSF.                        9915749
246763     IF  TR-OPTION (15) EQUAL '1' OR '3' OR '5'                   2016014
246764         MOVE ZERO TO WMS-NB-CHRG-OFF-SC.                         9915749
246765 K0616.                                                           9915749
246766*----------------------------------------------------------------*9915749
246767*    CREATE EXCEPTION RECORD FOR THE POSTED FUNDING TRANSACTION. *9915749
246768*    EXCEPTIONS MAY BE USED TO PRODUCE ODP NOTICES.              *9915749
246769*----------------------------------------------------------------*9915749
246770*    CHANGE STATUS OF FUNDING FLAG TO SHOW THAT THE FUNDING      *9915749
246771*    CREDIT HAS BEEN POSTED TO THE ACCOUNT.                      *9915749
246772*----------------------------------------------------------------*9915749
246773     IF  TR-USER-CODE EQUAL WBC-FUND-IM-CR-CODE                   0266741
246774         MOVE 'FT' TO IMEX-CODE-1                                 9915749
246775         MOVE 'F4' TO IMEX-CODE-2                                 9915749
246776         PERFORM K0330 THRU K0339                                 9915749
246777         MOVE TRAN-REC TO SAVE-FUNDING-TRANS                      9915749
246778         MOVE '2' TO FUNDING-FLAG.                                9915749
246779     IF  TR-USER-CODE  EQUAL WBC-FDIC-CR-CODE                     0927850
246780         MOVE 'FB' TO IMEX-CODE-1                                 0927850
246781         PERFORM K0330 THRU K0339.                                0927850
246782*----------------------------------------------------------------*0927850
246783*    SUBTRACT FROM SC CHECK ITEMS FOR POS PINLESS DEBITS OR      *0927850
246784*    SUBTRACT FROM SC CHECK ITEMS FOR MMDA CHECKS                *0927850
246785*----------------------------------------------------------------*0927850
246786     IF  TR-OPTION (15) EQUAL '2' OR '3' OR '4' OR '5'            2016014
246788         IF  WMS-SC-CHECK-ITEMS GREATER THAN ZERO                 9915749
246790             SUBTRACT +1 FROM WMS-SC-CHECK-ITEMS.                 9915749
246800     ADD +1 TO WMS-TODAYS-CREDITS-NO.
246802     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
246804         ADD TR-AMOUNT   TO T3-PLAN-CRD-AMT                       0617360
246806                            WS-GL-PLAN-CRD-AMT                    0617360
246808         MOVE 'X'        TO WS-PLN-TRLR-FULL                      0617360
246810         MOVE TR-AMOUNT  TO WS-WORK-CTDT-AMT                      0617360
246811         PERFORM CHECK-PLAN-REV THRU CPR-END                      0617360
246812         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0617360
246814         PERFORM UPDATE-PLN-LTD  THRU UPLT-EXIT                   0617360
246816         MOVE 'PT'       TO IMEX-CODE-1                           0617360
246818         PERFORM K0330 THRU K0339.                                0617360
246850     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
246900     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
246950         ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                     0902970
247000         ADD TR-AMOUNT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT            0902970
247050     ELSE
247100         ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                     0902970
247150         ADD TR-AMOUNT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.           0902970
247160*--------------------------------------------------------------*  2016639
247162*    ADD TO EXTERNAL INVESTMENT TOTAL AND GL FIELDS            *  2016639
247164*--------------------------------------------------------------*  2016639
247166     IF  WMS-XINV-PROCESS-IND EQUAL '1'                           2016639
247168         IF  (TR-USER-CODE EQUAL WBC-XINV-DDA-CR-CODE             0266741
247170         AND WMS-XINV-LINK-IND EQUAL 'L')                         2016639
247172         OR  WMS-XINV-LINK-IND EQUAL 'P'                          2016639
247174             ADD TR-AMOUNT       TO  T3-XINV-SD-RDM-AMT           2016639
247176                                     WS-GL-XINV-SD-RDM-AMT        2016639
247178             SUBTRACT TR-AMOUNT FROM WXI-XINV-BALANCE             2016639
247180             PERFORM R9120-Q5  THRU  R9199-EXIT.                  2016639
247182*                                                                 2016639
247200     MOVE '1' TO POST-TODAY.
247202     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0717614
247250     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
247300     IF TR-OPTION (3) EQUAL TO '0', GO TO K0620.
247310     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0417110
247350         IF  TR-OPTION (3) EQUAL '1' OR '3' OR '5' OR '7'         1105504
247400             ADD +1 TO WMS-STMT-ITEMS.                            1105504
247410     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0417110
247412                               OR 'C' OR 'K' OR 'T' OR 'W' OR 'G' 0417110
247450         IF  TR-OPTION (3) EQUAL TO '2' OR '3' OR '6' OR '7'      1105504
247500             SUBTRACT +1 FROM WMS-STMT-ITEMS                      1105504
247510         ELSE                                                     1105504
247550         IF  TR-OPTION (3) EQUAL '4' OR '5' OR '6' OR '7'         1105504
247600             SUBTRACT TR-ITEM-COUNT FROM WMS-STMT-ITEMS.          1105504
247650     IF  WMS-STMT-ITEMS LESS THAN +0
247700         MOVE +0 TO WMS-STMT-ITEMS.
247750 K0620.
247800     IF TR-OPTION (4) EQUAL TO '0'
247850         GO TO K0640.
247900     MOVE TR-OPTION9 (4) TO HOLD-OPT.
247950     IF HOLD-OPT LESS THAN +4                                     2016596
247955        GO TO K0620-A.                                            2016596
248000     SUBTRACT +4 FROM HOLD-OPT.                                   2016596
248010     IF  TR-ITEM-COUNT NOT GREATER THAN WMS-MTD-SVC-CHG-DR        2016596
248050         SUBTRACT TR-ITEM-COUNT FROM WMS-MTD-SVC-CHG-DR
248055     ELSE                                                         2016596
248060         MOVE ZERO TO WMS-MTD-SVC-CHG-DR.                         2016596
248070     IF  TR-ITEM-COUNT NOT GREATER THAN WMS-SC-DEBITS             2016596
248100         SUBTRACT TR-ITEM-COUNT FROM WMS-SC-DEBITS                2016374
248105     ELSE                                                         2016596
248110         MOVE ZERO TO WMS-SC-DEBITS.                              2016596
248120     IF  WMS-BIR-FLAG NOT EQUAL '1' AND '2'                       2016596
248125         GO TO K0620-A.                                           2016596
248130     IF  TR-ITEM-COUNT NOT GREATER THAN WMS-BIR-MTD-WD-NBR        2016596
248132         SUBTRACT TR-ITEM-COUNT FROM WMS-BIR-MTD-WD-NBR           2016596
248134     ELSE                                                         2016596
248136         MOVE ZERO TO WMS-BIR-MTD-WD-NBR.                         2016596
248138     IF  TR-AMOUNT NOT GREATER THAN WMS-BIR-MTD-WD-AMT            2016596
248140         SUBTRACT TR-AMOUNT FROM WMS-BIR-MTD-WD-AMT               2016596
248142     ELSE                                                         2016596
248144         MOVE ZERO TO WMS-BIR-MTD-WD-AMT.                         2016596
248145 K0620-A.                                                         2016596
248150     IF HOLD-OPT GREATER THAN +1
248200         SUBTRACT +2 FROM HOLD-OPT
248250         SUBTRACT +1 FROM WMS-SC-DEBITS, WMS-MTD-SVC-CHG-DR       2016374
248255         IF  WMS-BIR-FLAG NOT EQUAL '1' AND '2'                   2016596
248260             GO TO K0620-B.                                       2016596
248265     IF  WMS-BIR-MTD-WD-NBR GREATER ZERO                          2016596
248270         SUBTRACT +1 FROM WMS-BIR-MTD-WD-NBR.                     2016596
248275     IF  TR-AMOUNT NOT GREATER WMS-BIR-MTD-WD-AMT                 2016596
248280         SUBTRACT TR-AMOUNT FROM WMS-BIR-MTD-WD-AMT               2016596
248285     ELSE                                                         2016596
248290         MOVE ZERO TO WMS-BIR-MTD-WD-AMT.                         2016596
248295 K0620-B.                                                         2016596
248300     IF HOLD-OPT GREATER THAN +0
248350         ADD +1 TO WMS-SC-CREDITS, WMS-MTD-SVC-CHG-CR             2016374
248355         IF  WMS-BIR-FLAG EQUAL '1' OR '2'                        2016374
248360             ADD +1 TO WMS-BIR-MTD-DP-NBR                         2016374
248365             ADD TR-AMOUNT TO WMS-BIR-MTD-DP-AMT.                 2016374
248400 K0640.
248450     IF TR-OPTION (5) EQUAL TO '0', GO TO K0660.
248500     IF TR-OPTION (5) EQUAL TO '1' OR '5'
248550         SUBTRACT +1 FROM WMS-SC-NO-CHECKS
248600         GO TO K0650.
248650     IF TR-OPTION (5) EQUAL TO '2' OR '6'
248700         SUBTRACT TR-ITEM-COUNT FROM WMS-SC-NO-CHECKS
248750         GO TO K0660.
248800 K0650.
248850     IF TR-OPTION (5) GREATER THAN '3'
248900         ADD +1 TO WMS-SC-NSF-ITEMS, WMS-MTD-NSF-ITEMS
248950         ADD +1 TO WMS-CHECKS-RETURNED
249000         MOVE '1' TO NSF-TODAY.
249050 K0660.
249100     ADD +1 TO SEQ-CTR.
249150     IF TR-OPTION (6) EQUAL TO '0'
249200         GO TO K0670.
249250     IF TR-OPTION (6) EQUAL TO '1'
249300         SUBTRACT TR-AMOUNT FROM WMS-MTD-ACCUM-SERV-CHG
249302         SUBTRACT TR-AMOUNT FROM WMS-YTD-ACCUM-SERV-CHG           0617360
249350         SUBTRACT TR-AMOUNT FROM WMS-STMT-SERV-CHG,
249400         GO TO K0755.
249450     IF TR-OPTION (6) EQUAL TO '2'
249500         IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
249550             ADD +1 TO WMS-LOCKBOX-ITEMS WMS-MTD-LOCKBOX-ITEMS
249600             GO TO K0670
249650         ELSE
249700             GO TO K0670.
249750     IF TR-OPTION (6) EQUAL TO '4'
249800         ADD +1 TO WMS-SC-PAY-PERIOD-CTR.
249850 K0670.
249900     IF TR-OPTION (7) EQUAL TO '0'
249950         GO TO K0750.
250000     IF TR-OPTION (7) EQUAL TO '1' OR '5'
250050         SUBTRACT TR-AMOUNT FROM WMS-STMT-TRAN-CHG
250100                                 WMS-MTD-ACCUM-TRAN-CHG
250150         GO TO K0755.
250200     IF TR-OPTION (7) EQUAL TO '2' OR '6'
250250         ADD +1 TO WMS-SC-TRAN-NO WMS-MTD-TRN-NO
250300         ADD TR-AMOUNT TO WMS-SC-TRAN-AMT WMS-MTD-TRAN-AMT.
250350 K0750.
250400     PERFORM K0756 THRU K0756-EXIT.
250450     IF TR-80-TYPE EQUAL TO '06'
250500         PERFORM K0751 THRU K0751-EXIT                            IM002
250600         IF  WMS-HIFI-INDICATOR EQUAL +0
250650         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
250750             PERFORM X0850 THRU X0880-RHR-EXIT                    0903344
250800         ELSE
250850             NEXT SENTENCE
250900     ELSE
250950         ADD +1 TO WMS-STMT-NO-CREDITS
251000         ADD TR-AMOUNT TO WMS-STMT-CR-AMT.
251050     GO TO K0760.
251054 K0751.                                                           IM002
251058     SUBTRACT TR-ITEM-COUNT FROM WMS-STMT-NO-DEBITS.              IM002
251062     SUBTRACT TR-AMOUNT FROM WMS-STMT-DR-AMT.                     IM002
251066     IF  WMS-STMT-NO-DEBITS LESS THAN +0                          IM002
251070         ADD TR-ITEM-COUNT TO WMS-STMT-NO-DEBITS                  IM002
251074         ADD +1            TO WMS-STMT-NO-CREDITS.                IM002
251078     IF  WMS-STMT-DR-AMT LESS THAN +0.00                          IM002
251082         ADD TR-AMOUNT     TO WMS-STMT-DR-AMT                     IM002
251086                              WMS-STMT-CR-AMT.                    IM002
251087     IF (WMS-PLAN-TRLR EQUAL '1')                                 0617360
251088     AND (HOLD-BKDT-YR NOT EQUAL SPACES)                          0617360
251089     AND (HOLD-BKDT-YR NOT EQUAL WBC-CAPTURE-YR)                  0617360
251090         ADD TR-AMOUNT TO WMS-PLN-TRLR-YTD-BEG-BAL.               0617360
251091 K0751-EXIT.                                                      0617360
251094     EXIT.                                                        IM002
251100 K0755.
251150     IF TR-80-TYPE EQUAL TO '06'
251200         IF  WMS-HIFI-INDICATOR EQUAL +0
251250         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
251350             PERFORM X0850 THRU X0880-RHR-EXIT.                   0903344
251400 K0756.
251450     IF  TR-80-TYPE EQUAL '06' OR '08' OR '12' OR '13' OR '14'
251500         NEXT SENTENCE
251550     ELSE
251600         GO TO K0756-EXIT.
251650     IF WMS-IOD-RATE-PTR NOT EQUAL ZERO
251700     OR  WMS-HIFI-INDICATOR NOT EQUAL ZERO
251750         MOVE 'N' TO IOD-FLAG
251800         PERFORM ADJ-SC-AGGR THRU ADJ-YTD-AGGR
251850         PERFORM TRAN-ADJUST THRU END-INT-ADJUST
251900     ELSE
251950         MOVE ZERO TO ACCRUAL-AMOUNT
252000         MOVE ZERO TO RHW-IND
252050         PERFORM ADJ-SC-AGGR THRU ADJ-YTD-AGGR.
252052     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            9915577
252054         IF  WMS-ODAC-BAL-HIST EQUAL '0'                          9915577
252056             MOVE 'N' TO INTEREST-ADJ-SUBCODE                     9915577
252058         ELSE                                                     9915577
252100             MOVE 'T' TO INTEREST-ADJ-SUBCODE.                    9915577
252150     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            9915577
252200         PERFORM X0900-TRAN-ADJUST THRU X0900-RHR-OD-EXIT         9915845
252205         MOVE 'N' TO INTEREST-ADJ-SUBCODE.                        9915845
252206     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
252207     AND (HOLD-BKDT-YR NOT EQUAL SPACES)                          0617360
252208     AND (HOLD-BKDT-YR NOT EQUAL WBC-CAPTURE-YR)                  0617360
252209         IF  TR-TRAN-TYPE EQUAL '1' OR '2'                        0617360
252210             ADD TR-AMOUNT TO WMS-PLN-TRLR-YTD-BEG-BAL            0617360
252211         ELSE                                                     0617360
252212             SUBTRACT TR-AMOUNT FROM WMS-PLN-TRLR-YTD-BEG-BAL.    0617360
252214     IF (WMS-KITING-SUSP-TRLR EQUAL '0') OR                       0617360
252218        (TR-TRAN-TYPE GREATER THAN '4')                           9915845
252226         GO TO K0756-EXIT.                                        IM006
252234     PERFORM ADJ-KITE-AGGR THRU ADJ-KITE-AGGR-EXIT.               IM006
252250 K0756-EXIT.
252300     EXIT.
252350 K0760.
252400     IF TR-OPTION (8) EQUAL '2' OR '3' OR '6' OR '7'
252450         SUBTRACT +1 FROM WMS-SC-OD-ITEMS, WMS-MTD-OD-ITEMS.
252500     PERFORM K0320 THRU K0344.
252510 K0761.                                                           0827768
252550     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
252600     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
252650     IF  WMS-YR2-LD EQUAL SPACE
252670         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-DEPOSIT           0266741
252700         MOVE TR-AMOUNT TO WMS-OPENING-DEPOSIT.
252750     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
252800         GO TO K0765.
252850     IF TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7'
252900         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
252950     IF TR-OPTION (8) EQUAL '4' OR '5' OR '6' OR '7'
253000         MOVE TR-AMOUNT TO WMS-AMT-LAST-DEPOSIT
253050         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-DEPOSIT.          0266741
253100     IF TR-OPTION (8) EQUAL '5' OR '7'
253150         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-DEPOSIT
253200         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-DEPOSIT.     0266741
253250     GO TO K0770.
253300 K0765.
253350     IF TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7'
253400         PERFORM K0118 THRU K0118-EXIT.                           9915845
253450     IF TR-OPTION (8) EQUAL '4' OR '5' OR '6' OR '7'
253500         PERFORM K0510 THRU K0510-EXIT.                           9915845
253550     IF TR-OPTION (8) EQUAL '5' OR '7'
253600         PERFORM K0525 THRU K0525-EXIT.                           9915845
253620 K0770.                                                           1004773
253622     IF  TR-OPTION (14) EQUAL '4' OR '5' OR '6' OR '7'            1004773
253624         MOVE TR-AMOUNT TO WMS-DDA-CHG-OFF-AMT                    1004773
253628         IF  WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                1010064
253630             ADD +.005 WMS-IOD-CYC-ACC-INT GIVING EX02-BAL        1010064
253631             SUBTRACT EX02-BAL FROM IOD-INT-ACC-ADJ-INT           1010064
253632                                    WS-GL-IOD-INT-ACC-ADJ-INT     1010064
253633                                    WMS-IOD-MTD-ACC-INT           1010064
253634                                    WMS-IOD-YTD-ACC-INT           1010064
253635             SUBTRACT WMS-IOD-CYC-ACC-INT                         1010064
253636                 FROM WMS-IOD-TIS-EARN-INT                        1010064
253638             MOVE 'K8' TO IMEX-CODE-1                             1004773
253640             MOVE '02' TO IMEX-REC-NO                             1004773
253642             MULTIPLY -1 BY EX02-BAL                              1010064
253644             MOVE ZEROS TO WMS-IOD-CYC-ACC-INT                    1004773
253646             ADD +1 TO SEQ-CTR                                    1004773
253648             MOVE SEQ-CTR TO EX02-SEQ-NO                          1004773
253650             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              1004773
253652             IF  WMS-IOD-TIS-EARN-INT LESS THAN ZERO              1004773
253654                 MOVE ZERO TO WMS-IOD-TIS-EARN-INT                1010064
253656             END-IF                                               1010064
253658             IF  WMS-IOD-MTD-ACC-INT LESS THAN ZERO               1010064
253660                 MOVE ZERO TO WMS-IOD-MTD-ACC-INT                 1010064
253662             END-IF                                               1010064
253664             IF  WMS-IOD-YTD-ACC-INT LESS THAN ZERO               1010064
253666                 MOVE ZERO TO WMS-IOD-YTD-ACC-INT.                1010064
253668     IF  TR-OPTION (14) EQUAL '4' OR '5' OR '6' OR '7'            1010064
253670         IF  (WMS-SYS-TYPE GREATER THAN '019'                     1004773
253671         AND WMS-SYS-TYPE LESS THAN '030')                        1004773
253672         OR  (WMS-SYS-TYPE GREATER THAN '049'                     1004773
253673         AND WMS-SYS-TYPE LESS THAN '070')                        1004773
253674             ADD WMS-DDA-CHG-OFF-AMT TO WBC-REG-TFR-AMT (6)       0266741
253675         ELSE                                                     1004773
253676             ADD WMS-DDA-CHG-OFF-AMT TO WBC-REG-TFR-AMT (5).      0266741
253677     IF  TR-OPTION (14) EQUAL '1' OR '3' OR '5' OR '7'            1004773
253678         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (4)              0266741
253679                                 WBC-REG-CALL-AMT (13).           0266741
253680     IF  WMS-SAVINGS-TRLR EQUAL '1'                               1004773
253681     AND WMS-INT-INV-IND EQUAL 'Y'                                1004773
253682         NEXT SENTENCE                                            1004773
253683     ELSE                                                         1004773
253684         IF  TR-OPTION (14) EQUAL '4' OR '5' OR '6' OR '7'        1004773
253685             ADD TR-AMOUNT TO WBC-REG-TFR-AMT (9).                0266741
253700     IF  TR-OPTION (9) EQUAL '1' OR '3' OR '5' OR '7'
253750         ADD TR-AMOUNT TO WMS-IOD-YTD-INT-PAID IOD-INT-YTD-ADJ    0902970
253751                                         WS-GL-IOD-INT-YTD-ADJ    9915828
253755         IF  WMS-PLAN-TRLR EQUAL '1'                              0617360
253756             ADD TR-AMOUNT TO WMS-PLN-TRLR-PR-LTD-INT-PD          0617360
253757             END-IF                                               0617360
253765         PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT               9915828
253770         IF  CERT-NAME-W8-STATUS EQUAL '1'                        9915828
253775             ADD TR-AMOUNT TO WMS-IOD-YTD-INT-PAID-1042.          9915828
253777     IF  TR-OPTION (9) EQUAL '1' OR '3' OR '5' OR '7'             9915858
253780         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         9915858
253785             ADD TR-AMOUNT TO WMS-DUAL-YR-CUR-IOD-INT             9915858
253786                              DUAL-IO-INT-YTD-ADJ                 9915858
253788                              WS-GL-DUAL-IO-INT-YTD-ADJ.          9915858
253800     IF  TR-OPTION (9) EQUAL '3' OR '7'
253850         ADD TR-AMOUNT TO WMS-IOD-CYC-PAID-INT
253900                          WMS-IOD-MTD-PAID-INT.
253910*---------------------------------------------------------------* 0627451
253911*    SUBTRACT FROM OVERDRAFT CYCLE-TO-DATE                      * 0627451
253912*    IF OPTION 17 VALUE 1 IS ON                                 * 0627451
253913*---------------------------------------------------------------* 0627451
253914     IF  TR-OPTION (17) EQUAL '1'                                 0627451
253915         IF  WMS-STMT-OVERDRAFT-CHGD-CTD NOT LESS TR-AMOUNT       0627451
253916             SUBTRACT TR-AMOUNT FROM                              0627451
253917                                 WMS-STMT-OVERDRAFT-CHGD-CTD      0627451
253918         ELSE                                                     0627451
253919             MOVE ZERO TO WMS-STMT-OVERDRAFT-CHGD-CTD.            0627451
253920*---------------------------------------------------------------* 0627451
253921*    SUBTRACT FROM NSF CYCLE-TO-DATE                            * 0627451
253922*    IF OPTION 17 VALUE 2 IS ON                                 * 0627451
253923*---------------------------------------------------------------* 0627451
253924     IF  TR-OPTION (17) EQUAL '2'                                 0627451
253925         IF  WMS-STMT-NSF-CHGD-CTD NOT LESS TR-AMOUNT             0627451
253926             SUBTRACT TR-AMOUNT FROM                              0627451
253927                                 WMS-STMT-NSF-CHGD-CTD            0627451
253928         ELSE                                                     0627451
253929             MOVE ZERO TO WMS-STMT-NSF-CHGD-CTD.                  0627451
253930*---------------------------------------------------------------* 0627451
253931*    SUBTRACT FROM OVERDRAFT YEAR-TO-DATE                       * 0627451
253932*    IF OPTION 18 VALUE 1 IS ON                                 * 0627451
253933*---------------------------------------------------------------* 0627451
253934     IF  TR-OPTION (18) EQUAL '1'                                 0627451
253935         IF  WMS-STMT-OVERDRAFT-CHGD-YTD NOT LESS TR-AMOUNT       0627451
253936             SUBTRACT TR-AMOUNT FROM                              0627451
253937                                 WMS-STMT-OVERDRAFT-CHGD-YTD      0627451
253938         ELSE                                                     0627451
253939             MOVE ZERO TO WMS-STMT-OVERDRAFT-CHGD-YTD.            0627451
253940*---------------------------------------------------------------* 0627451
253941*    SUBTRACT FROM NSF YEAR-TO-DATE                             * 0627451
253942*    IF OPTION 18 VALUE 2 IS ON                                 * 0627451
253943*---------------------------------------------------------------* 0627451
253944     IF  TR-OPTION (18) EQUAL '2'                                 0627451
253945         IF  WMS-STMT-NSF-CHGD-YTD NOT LESS TR-AMOUNT             0627451
253946             SUBTRACT TR-AMOUNT FROM                              0627451
253947                                 WMS-STMT-NSF-CHGD-YTD            0627451
253948         ELSE                                                     0627451
253949             MOVE ZERO TO WMS-STMT-NSF-CHGD-YTD.                  0627451
253950     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
254000         IF  TR-OPTION (10) EQUAL '4' OR '5' OR '6' OR '7'
254050             SUBTRACT TR-AMOUNT FROM WMS-OD-YTD-CHGD
254100                                     OD-CHRGS-ADJ-YTD
254101                                     WS-GL-OD-CHRGS-ADJ-YTD       0902970
254150             IF  TR-OPTION (10) EQUAL '6' OR '7'                  1004773
254200                 SUBTRACT TR-AMOUNT FROM WMS-OD-CYC-CHGD          1004773
254250                                         WMS-OD-MTD-CHGD.         1004773
254258     IF  TR-OPTION (11) EQUAL '2' OR '3' OR '6' OR '7'            IM003
254266         SUBTRACT TR-AMOUNT FROM WMS-IOD-YTD-TAX                  IM003
254274                                 WMS-IOD-CYC-TAX                  IM003
254282                                 WMS-IOD-MTD-TAX                  IM003
254283         ADD TR-AMOUNT TO        IOD-TAX-ADJ-DN-AMT               9915858
254284                                 WS-GL-IOD-TAX-ADJ-DN-AMT         9915858
254285         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         9915858
254286             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-IOD-FED      9915858
254287             ADD TR-AMOUNT TO WS-GL-DUAL-IO-TAX-ADJ-DN-AMT        9915858
254288                              DUAL-IO-TAX-ADJ-DN-AMT.             9915858
254289     IF  (TR-OPTION (16) EQUAL '1' OR '3' OR '5' OR '7')          2012254
254290     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
254291         SUBTRACT TR-AMOUNT FROM WMS-IOD-YTD-STATE-TAX            2012254
254292                                 WMS-IOD-CYC-STATE-TAX            2012254
254293                                 WMS-IOD-MTD-STATE-TAX            2012254
254294         ADD TR-AMOUNT TO        IOD-TAX-ADJ-DN-AMT-ST            2012254
254295                                 WS-GL-IOD-TAX-ADJ-DN-ST-AMT      2012254
254296         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
254297             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-IOD-STATE    2012254
254298             ADD TR-AMOUNT TO WS-GL-DUAL-IO-TX-ADJ-DN-ST-A        2012254
254299                              DUAL-IO-TAX-ADJ-DN-AMT-ST.          2012254
254300     IF  (TR-OPTION (16) EQUAL '2' OR '3' OR '6' OR '7')          2012254
254301     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
254302         SUBTRACT TR-AMOUNT FROM WMS-IOD-YTD-LOCAL-TAX            2012254
254303                                 WMS-IOD-CYC-LOCAL-TAX            2012254
254304                                 WMS-IOD-MTD-LOCAL-TAX            2012254
254305         ADD TR-AMOUNT TO        IOD-TAX-ADJ-DN-AMT-LOC           2012254
254306                                 WS-GL-IOD-TAX-ADJ-DN-LOC-AMT     2012254
254307         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
254308             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-IOD-LOCAL    2012254
254309             ADD TR-AMOUNT TO WS-GL-DUAL-IO-TX-ADJ-DN-LOC-A       2012254
254310                              DUAL-IO-TAX-ADJ-DN-AMT-LOC.         2012254
254311     IF WMS-KITING-SUSP-TRLR EQUAL '1'                            2012254
254312         IF (TR-OPTION (11) EQUAL '4' OR '5' OR '6' OR '7') AND   2012254
254313            (TR-80-TYPE NOT EQUAL '06' AND '08'                   2012254
254314                              AND '12' AND '13' AND '14')         2012254
254315             MOVE '1' TO KITE-ITEM-FLAG                           2012254
254316             ADD TR-ITEM-COUNT TO WMS-KITE-TODAY-CR-NO (7)        2012254
254317             ADD TR-AMOUNT TO WMS-KITE-TODAY-CR-AMT (7).          2012254
254318     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'            2012254
254350         IF  WMS-HIFI-INDICATOR EQUAL +0
254400         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
254500             PERFORM X0850 THRU X0880-RHR-EXIT.                   0903344
254550     PERFORM K0530 THRU K0540-EXIT.                               IM004
254650     IF  TR-OPTION (13) EQUAL '2' OR '3' OR '6' OR '7'            1103704
254750         MOVE '1' TO SEND-EFAA-NOTICE.                            IM007
254760     IF  TR-OPTION (13) GREATER THAN '3'                          1103704
254762     AND WMS-SC-AMTTRNSFR-NO GREATER THAN +0                      1103704
254764         SUBTRACT +1 FROM WMS-SC-AMTTRNSFR-NO.                    1103704
254800     IF  TR-OPTION (14) EQUAL '1' OR '3' OR '5' OR '7'            1004015
254810         SUBTRACT TR-AMOUNT FROM WMS-IOD-TIS-CYC-FEES             1004015
254820         IF  WMS-IOD-TIS-CYC-FEES LESS THAN ZERO                  1004015
254830             MOVE ZERO TO WMS-IOD-TIS-CYC-FEES.                   1004015
254960 K0770-EXIT.                                                      IM002
254970     EXIT.                                                        IM002
254980 K0780.                                                           IM002
255000     GO TO K7000.
255050     SKIP3
255100*    *****************  DEBIT PROCESSING  ******************
255150     SKIP1
255200 K0800.
255250     IF WMS-STATUS EQUAL TO '00', GO TO K0810.
255300     IF WMS-STATUS EQUAL TO '01'
255350         IF TR-OPTION (10) GREATER THAN '3'
255400             NEXT SENTENCE
255450         ELSE
255500             MOVE '010' TO REJRESN                                0717565
255550             GO TO K1150-UNPOST.
255600     IF WMS-STATUS EQUAL TO '04'
255650         IF TR-OPTION (9) LESS THAN '4'
255700             MOVE '019' TO REJRESN                                0717565
255750             GO TO K1150-UNPOST.
255800     IF WMS-STATUS EQUAL TO '06'
255850         IF WBC-POST-DORM    LESS THAN '3'                        0266741
255900             MOVE '006' TO REJRESN                                0717565
255950             MOVE 'A2' TO EXCODE-2
256000             GO TO K1150-UNPOST.
256050     IF WMS-STATUS EQUAL TO '07'
256100         IF WBC-POST-INACTIVE LESS THAN '3'                       0266741
256150             MOVE '007' TO REJRESN                                0717565
256200             MOVE 'A3' TO EXCODE-2
256250             GO TO K1150-UNPOST.
256300     IF WMS-STATUS EQUAL TO '08'
256350         MOVE '009' TO REJRESN                                    0717565
256400         GO TO K1150-UNPOST.
256410     IF WMS-STATUS EQUAL TO '09'                                  IM006
256420         MOVE '051' TO REJRESN                                    0717565
256430         GO TO K1150-UNPOST.                                      IM006
256432     IF  WMS-STATUS EQUAL TO '10'                                 9915749
256434         IF  WBC-POST-DORM    LESS THAN '3'                       0266741
256436             MOVE '006' TO REJRESN                                0717565
256438             MOVE 'A9' TO EXCODE-2                                9915749
256440             GO TO K1150-UNPOST.                                  9915749
256450 K0810.
256456     IF  (TR-SOURCE EQUAL '28' AND TR-80-TYPE EQUAL '02')         IM003
256462         IF  WMS-STOP-WAIVE EQUAL '1'                             IM003
256468             MOVE '047'     TO REJRESN                            0717565
256474             MOVE 'A7'     TO EXCODE-2                            IM003
256480             ADD +1        TO DDA-STOP-CHGS-NO-WV                 IM003
256481                              WS-GL-DDA-STOP-CHGS-NO-WV           0902970
256486             ADD TR-AMOUNT TO DDA-STOP-CHGS-WAIVED                IM003
256487                              WS-GL-DDA-STOP-CHGS-WAIVED          0902970
256492             GO TO K1150-UNPOST.                                  IM003
256500     IF  TR-OPTION (8) EQUAL '2' OR '3' OR '6' OR '7'
256550         IF  WMS-ACH-FLAG EQUAL '1' OR '3'
256600             NEXT SENTENCE
256650         ELSE
256700             MOVE '013' TO REJRESN                                0717565
256750             GO TO K1150-UNPOST.
256800     IF  TR-OPTION (8) EQUAL '2' OR '3' OR '6' OR '7'
256850         IF  TR-AMOUNT EQUAL ZERO
256900             MOVE 'PN' TO IMEX-CODE-1                             0903034
256950             PERFORM K0330 THRU K0339.                            0903034
256961*----------------------------------------------------------------*0437111
256962*    RESTRICTED STMT SAVINGS ACCOUNTS CAN NOT ACCEPT MONETARY    *0437111
256963*    TRANS THAT INCREMENT MMDA ELIGIBILITY COUNTERS              *0437111
256964*----------------------------------------------------------------*0437111
256965     IF  WMS-MMDA-INDICATOR EQUAL '3'                             0437111
256966         IF  (TR-OPTION (14) GREATER THAN '3')                    0437111
256967         OR  (TR-OPTION (15) EQUAL '4' OR '5' OR '6' OR '7')      0437111
256968             MOVE '038' TO REJRESN                                0717565
256969             GO TO K1150-UNPOST.                                  0437111
257000     IF NSF-CALC-FLAG EQUAL TO '0'
257050         PERFORM K0100 THRU K0105.
257060     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
257061         PERFORM K0106 THRU K0106-EXIT.                           0827768
257065*--- CALCULATE BATCH RUN BALANCE --------------------------------*0930077
257070     IF  WS-FIRST-DEBIT EQUAL 'N'                                 0930077
257071         MOVE CUR-BAL TO BATCH-RUN-BALANCE  BATCH-RUN-OD          0930077
257072         MOVE ZERO    TO BATCH-OD-LIMIT                           0930077
257073         IF  SAVINGS-PRESENT EQUAL '1'                            0930077
257074             ADD WMS-INT-CUR-BAL TO BATCH-RUN-BALANCE             0930077
257075                                    BATCH-RUN-OD.                 0930077
257076*                                                                 0930077
257077     IF  WS-FIRST-DEBIT EQUAL 'N'                                 0930077
257078         COMPUTE BATCH-RUN-FDIC  =  BATCH-RUN-BALANCE             0930077
257079                                 +  WMS-PROV-HOLD-AMT             0930077
257080         MOVE 'Y'                TO WS-FIRST-DEBIT                9915749
257081         IF  WMS-OD-LIMIT GREATER THAN '0'                        9915749
257082             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-RUN-OD    0266741
257083             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-OD-LIMIT  0437237
257084         ELSE                                                     0437237
257085             IF  WMS-OD-LIMIT EQUAL 'S' OR 'L' OR '0'             0437237
257086                 IF  WMS-OD-LIMIT-AMT GREATER THAN +0             0437237
257087                     ADD WMS-OD-LIMIT-AMT TO BATCH-RUN-OD         0437237
257088                     ADD WMS-OD-LIMIT-AMT TO BATCH-OD-LIMIT       0437237
257089                 ELSE                                             0437237
257090                     MOVE +0.00 TO BATCH-RUN-OD                   0437237
257091             ELSE                                                 0437237
257092                 MOVE +0.00 TO BATCH-RUN-OD.                      0437237
257093     IF  LIST-POST-DR-FLAG NOT EQUAL '2'                          0827768
257094         GO TO K0810Z                                             0827768
257095     ELSE                                                         0827768
257096     IF  TR-OPTION (19)   NOT EQUAL '1'                           0827768
257097         GO TO K0810Z                                             0827768
257098     ELSE                                                         0827768
257099     IF  TR-80-TYPE   EQUAL '06' OR '08' OR '12' OR '13' OR '14'  0827768
257100         GO TO K0810Z.                                            0827768
257102***  PROCESS LIST POST ITEMS                                      0827768
257104     MOVE '1'                    TO LIST-POST-ITEM.               0827768
257106     IF  WBC-LIST-POST-DETAIL EQUAL '1'                           0827768
257108         MOVE HIGH-VALUES        TO TR-STMT-SYM                   0827768
257110         MOVE '1'                TO TRAN-REWRITE-SW.              0827768
257112     IF  WMS-PLAN-TRLR        EQUAL '1'                           0827768
257114         ADD TR-AMOUNT           TO T3-PLAN-DEB-AMT               0827768
257116                                    WS-GL-PLAN-DEB-AMT            0827768
257118         MOVE 'X'                TO WS-PLN-TRLR-FULL              0827768
257120         MOVE TR-AMOUNT          TO WS-WORK-CTDT-AMT              0827768
257122         PERFORM CHECK-PLAN-REV  THRU CPR-END                     0827768
257124         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0827768
257126         MOVE 'PT'               TO IMEX-CODE-1                   0827768
257128         PERFORM K0330 THRU K0339.                                0827768
257129     GO TO K1120.                                                 0827768
257130 K0810Z.                                                          9915749
257131     MOVE 'N' TO BATCH-RUN-BAL-OD-UPDATED.                        9916451
257132     IF  CUR-BAL NOT LESS THAN TR-AMOUNT                          9916451
257133         IF  BATCH-RUN-BALANCE NOT LESS THAN TR-AMOUNT            9916451
257134             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9916451
257136             GO TO K1100-POST.                                    9915749
257137     IF  BATCH-RUN-BALANCE NOT LESS THAN TR-AMOUNT                9915749
257138         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
257141         GO TO K0812.                                             9915749
257142     IF  FUNDING-AMT GREATER THAN WS-FUNDING-USED                 9915749
257143         IF  TR-AMOUNT NOT GREATER THAN                           9915749
257144                                 (FUNDING-AMT - WS-FUNDING-USED)  9915749
257145             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9915749
257148             GO TO K1100-POST.                                    9915749
257149 K0812.                                                           9915749
257150     IF SAVINGS-OR-LOAN EQUAL TO '0'
257200         GO TO K0950.
257250     MOVE CUR-BAL TO AMT-AVAIL.
257300     IF SAVINGS-PRESENT EQUAL TO '1'
257350         ADD WMS-INT-CUR-BAL TO AMT-AVAIL.
257400     IF LOAN-PRESENT EQUAL TO '0' OR
257450         TR-OPTION (7) EQUAL TO '0' OR '4'
257500             MOVE '1' TO NO-LOAN
257550     ELSE
257600         MOVE '0' TO NO-LOAN
257650         ADD WMS-AVAIL-BAL TO AMT-AVAIL.
257700     IF AMT-AVAIL LESS THAN TR-AMOUNT
257750         IF NO-LOAN EQUAL TO '1'
257800             GO TO K0950
257850         ELSE
257900             GO TO K0840.
257950*****    AT THIS POINT THERE IS ENOUGH AVAILABLE TO PAY TRANS*****
258000*****  AMOUNT, EITHER IN SAVINGS OR LOAN OR BOTH.            *****
258050     IF SAVINGS-OR-LOAN LESS THAN '3'
258100         GO TO K0900.
258110     IF  SAVINGS-OR-LOAN EQUAL '3'                                9916372
258120         IF  NO-LOAN EQUAL TO '1'                                 9916372
258130             GO TO K0950.                                         9916372
258150     IF NO-LOAN EQUAL TO '1'
258200         GO TO K0910.
258250     IF CUR-BAL + WMS-AVAIL-BAL LESS THAN TR-AMOUNT
258260         PERFORM K1730 THRU K1730-EXIT                            2015844
258300         ADD WMS-AVAIL-BAL TO LOAN-TODAY WMS-PRIN-BAL             IM003
258310                              CUR-BAL    CUST-BAL                 IM003
258320                          BATCH-RUN-BALANCE  BATCH-RUN-OD         2016677
258325                          BATCH-RUN-FDIC                          0930077
258350         GO TO K0910.
258400 K0815.
258450     IF TR-OPTION (7) EQUAL TO '2' OR '6'
258500         GO TO K0830.
258550 K0820.
258600     IF HOLD-INCRM GREATER THAN WMS-AVAIL-BAL
258650         AND WMS-AVAIL-BAL NOT LESS THAN ZERO
258660         PERFORM K1730 THRU K1730-EXIT                            2015844
258700         ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY             IM003
258710                              CUR-BAL      CUST-BAL               IM003
258720                          BATCH-RUN-BALANCE  BATCH-RUN-OD         2016677
258725                          BATCH-RUN-FDIC                          0930077
258750         GO TO K1100-POST.
258800 K0825.
258850     PERFORM K0131 THRU K0131-A-EXIT.
258900     IF HOLD-AMT9 GREATER THAN WMS-AVAIL-BAL
258950         MOVE WMS-AVAIL-BAL TO HOLD-AMT9.
258960     PERFORM K1730 THRU K1730-EXIT.                               2015844
259000     ADD HOLD-AMT9 TO WMS-PRIN-BAL LOAN-TODAY CUR-BAL CUST-BAL.   IM003
259010     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
259015     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
259050     GO TO K1100-POST.
259100 K0830.
259150     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
259160     PERFORM K1730 THRU K1730-EXIT.                               2015844
259200     ADD HOLD-AMT9 TO WMS-PRIN-BAL, LOAN-TODAY, CUR-BAL, CUST-BAL.IM003
259210     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
259215     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
259250     GO TO K1100-POST.
259300*****    AT THIS POINT THERE IS NOT ENOUGH AVAILABLE TO PAY  *****
259350*****  THE TRANS. CHOICES ARE TO NSF, FORCE OD, OR FORCE LOAN*****
259400 K0840.
259410     IF WMS-LOAN-BAD-ACCT GREATER THAN '0', GO TO K0850.          IM004
259420     IF WMS-OVERLIM-INCR EQUAL '2', GO TO K0845.                  IM004
259450     IF OVRLIM-FLAG EQUAL TO '1', GO TO K0850.
259500     IF WBC-OVRLIM-INCR EQUAL TO '0'                              0266741
259550         IF WMS-OVERLIM-INCR EQUAL TO '0'
259600             GO TO K0850.
259650     IF WMS-OVERLIMIT GREATER THAN '0', GO TO K0850.
259700     IF OVER-LINE EQUAL TO '1', GO TO K0850.
259800* WILL OVER-LIMIT AND OD-LIMIT COVER THE TRANSACTION              0265977
259810     IF AMT-AVAIL + HOLD-INCRM + BATCH-OD-LIMIT                   0437237
259820                               LESS THAN TR-AMOUNT                0265977
259830         GO TO K0850.                                             0265977
259840     MOVE '1' TO OVRLIM-FLAG.                                     0265977
259850     PERFORM K1730 THRU K1730-EXIT.                               0265977
259860     ADD WMS-AVAIL-BAL, HOLD-INCRM TO WMS-PRIN-BAL                0265977
259870                                      CUR-BAL                     0265977
259880                                      CUST-BAL                    0265977
259890                      BATCH-RUN-BALANCE  BATCH-RUN-OD             0265977
259895                                      BATCH-RUN-FDIC              0930077
259900                                      LOAN-TODAY.                 0265977
259910* IF OVER-LIMIT WILL COVER THE TRANSACTION GO POST                0265977
259920     IF AMT-AVAIL + HOLD-INCRM NOT LESS THAN TR-AMOUNT            0265977
259930       IF SAVINGS-PRESENT EQUAL TO '1'                            0265977
259940         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT              0265977
259950         MOVE ZERO TO WMS-INT-CUR-BAL                             0265977
259960         GO TO K1100-POST                                         0265977
259970       ELSE                                                       0265977
259980         GO TO K1100-POST.                                        0265977
259990     GO TO K1090-OD.                                              0265977
260254**** AUTO LOAN INCREMENT FLAG = 2  THE DEBIT WILL BE PAID    *****IM004
260258 K0845.                                                           IM004
260262     SUBTRACT WMS-AVAIL-BAL FROM TR-AMOUNT GIVING HOLD-LOAN-INCR. IM004
260266     IF SAVINGS-PRESENT EQUAL TO '1'                              IM004
260270         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT              IM004
260274         MOVE ZERO TO WMS-INT-CUR-BAL.                            IM004
260276     PERFORM K1730 THRU K1730-EXIT.                               2015844
260278     ADD WMS-AVAIL-BAL, HOLD-LOAN-INCR TO WMS-PRIN-BAL            IM004
260282                                          CUR-BAL                 IM004
260286                                          CUST-BAL                IM004
260287                      BATCH-RUN-BALANCE  BATCH-RUN-OD             2016677
260288                                          BATCH-RUN-FDIC          0930077
260290                                          LOAN-TODAY.             IM004
260294     GO TO K1100-POST.                                            IM004
260300 K0850.
260310* NOT FORCED THE OD-LIMIT WILL NOT COVER THE TRANSACTION          0265977
260315     IF TR-OPTION (6) EQUAL TO '0'                                0265977
260320       IF AMT-AVAIL + BATCH-OD-LIMIT  LESS THAN TR-AMOUNT         0437237
260325         GO TO K0950.                                             0265977
260330* NOT FORCED THE OD-LIMIT WILL COVER THE TRANSACTION              0265977
260335     IF TR-OPTION (6) EQUAL TO '0'                                0265977
260340       IF AMT-AVAIL + BATCH-OD-LIMIT NOT LESS THAN TR-AMOUNT      0437237
260345         IF WMS-AVAIL-BAL GREATER THAN +0                         0265977
260350             PERFORM K1730 THRU K1730-EXIT                        0265977
260355             ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY         0265977
260360                                  CUR-BAL      CUST-BAL           0265977
260362                              BATCH-RUN-FDIC                      0930077
260365                              BATCH-RUN-BALANCE  BATCH-RUN-OD.    0265977
260370     IF TR-OPTION (6) EQUAL TO '0'                                0265977
260375         GO TO K1090-OD.                                          0265977
260380                                                                  0265977
260400     IF TR-OPTION (6) EQUAL TO '1'
260450         IF WMS-AVAIL-BAL GREATER THAN +0
260460             PERFORM K1730 THRU K1730-EXIT                        2015844
260500             ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY         IM003
260510                                  CUR-BAL      CUST-BAL           IM003
260520                         BATCH-RUN-BALANCE  BATCH-RUN-OD          2016677
260525                         BATCH-RUN-FDIC                           0930077
260550             GO TO K1090-OD
260600         ELSE GO TO K1090-OD.
260650     IF SAVINGS-PRESENT EQUAL TO '1'
260700         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT
260750         MOVE ZERO TO WMS-INT-CUR-BAL.
260800     IF TR-OPTION (6) LESS THAN '4'
260850         GO TO K0880.
260900 K0860.
260950*  --FORCE OVERLINE BY AMOUNT REQUIRED
261000     GO TO K0830.
261050 K0880.
261100*  --FORCE OVERLINE BY INCREMENTS
261150     PERFORM K0131 THRU K0131-A-EXIT.
261160     PERFORM K1730 THRU K1730-EXIT.                               2015844
261200     ADD HOLD-AMT9 TO WMS-PRIN-BAL LOAN-TODAY CUR-BAL CUST-BAL.   IM003
261210     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
261215     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
261250     GO TO K1100-POST.
261300 K0900.
261350     IF CUR-BAL + WMS-INT-CUR-BAL NOT LESS THAN TR-AMOUNT
261400         GO TO K0910.
261450     ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT.
261500     MOVE ZERO TO WMS-INT-CUR-BAL.
261550     GO TO K0815.
261600 K0910.
261650     IF  WMS-INT-INCREMNT GREATER THAN ZERO                       IM006
261660         IF  HOLD-SAV-INCR GREATER THAN +0                        IM006
261670             GO TO K0920.                                         IM006
261750     SUBTRACT CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
261800     ADD HOLD-AMT9 TO CUR-BAL TRANSFER-AMT.
261850     SUBTRACT HOLD-AMT9 FROM WMS-INT-CUR-BAL.
261900     GO TO K1100-POST.
261950 K0920.
262000     PERFORM K0170 THRU K0170-END.
262050     GO TO K1100-POST.
262100 K0950.
262102*----------------------------------------------------------------*0927850
262104*    FORCE POST ACCOUNT OPTION IS NOT VALID IF UNDER FDIC CONTROL*0927850
262106*----------------------------------------------------------------*0927850
262108     IF WMS-FORCE-POST EQUAL 'Y'                                  0927850
262110        IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                            0927850
262112        AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                  0927850
262114            NEXT SENTENCE                                         0927850
262116        ELSE                                                      0927850
262118            GO TO K1090-OD.                                       0927850
262120*----------------------------------------------------------------*0927850
262122*    PAY ALL IS TREATED AS PAY NONE IF UNDER FDIC CONTROL        *0927850
262124*----------------------------------------------------------------*0927850
262126     IF WBC-FDIC-CTL-OPT EQUAL 'Y'                                0927850
262128     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO                      0927850
262130         IF  WMS-OD-LIMIT EQUAL TO 'A'                            0927850
262132             GO TO K0970.                                         0927850
262150     IF WMS-OD-LIMIT EQUAL TO 'A', GO TO K1090-OD.
262152                                                                  0927850
262154 K0955.                                                           0927850
262200     IF WMS-OD-LIMIT EQUAL TO 'N', GO TO K0970.
262250     PERFORM K0210 THRU K0215.
262300     IF  WMS-OD-LIMIT EQUAL 'L'                                   9915749
262302         IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-OD              9915749
262304             MOVE ' ' TO TR-PEND-DECISION                         9915749
262306             PERFORM K0290-LOC-FEE THRU K0290-LOC-FEE-EXIT        9915749
262308             SUBTRACT TR-AMOUNT FROM BATCH-RUN-OD                 9915749
262309             MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                 9916451
262310             GO TO K1100-POST.                                    9915749
262322     IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-OD                  9915749
262324         SUBTRACT TR-AMOUNT FROM BATCH-RUN-OD                     9915749
262326         MOVE +0.00 TO BATCH-RUN-BALANCE                          9915749
262328         MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                     9916451
262350         GO TO K1090-OD.
262400 K0970.
262450     IF TR-OPTION (6) EQUAL TO '1' OR '3' OR '5'
262500         GO TO K1090-OD.
262502* SI TRANSACCION FUE ACEPTADA EN LINEA, POSTEAR ASI NO HAYA SALDO IMIBXX
262504     IF TR-SRC-INFO-FLAG = '1'           AND                      IMIBXX
262506        (TR-ORIGIN NOT = 'TT' AND 'IT')                           IMIBXX
262508        GO TO K1090-OD.                                           IMIBXX
262510     IF  TR-AMOUNT NOT GREATER THAN BATCH-RUN-BALANCE             9915749
262512         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
262520         GO TO K1100-POST.                                        9915749
262522     MOVE 'P' TO TR-PEND-DECISION.                                9915749
262524     MOVE 'P' TO EX13-NB-PEND-DEC-IND.                            9915749
262550     MOVE '1' TO WMS-NSF-TODAY.
262600     MOVE TR-OPTION9 (5) TO HOLD-OPT.
262650     IF HOLD-OPT GREATER THAN +3
262700         SUBTRACT +4 FROM HOLD-OPT.
262750     IF HOLD-OPT GREATER THAN +1
262800         SUBTRACT +2 FROM HOLD-OPT
262850         MOVE '1' TO NSF-TODAY
262900         ADD +1 TO WMS-CHECKS-RETURNED
262950         IF WMS-SAV-PTR EQUAL TO ZERO
262970         AND WMS-CHG-CARD-FLG EQUAL ZERO                          IM004
263000             ADD +1 TO WMS-SC-NSF-ITEMS, WMS-MTD-NSF-ITEMS.
263004     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
263006     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
263008         IF (BATCH-RUN-FDIC + BATCH-OD-LIMIT)                     0930077
263009             NOT LESS THAN TR-AMOUNT                              0930077
263010             IF  HOLD-OPT GREATER THAN +0                         0927850
263012                 ADD +1 TO NSF-CTR-FDIC                           1020116
263013                 IF  (TR-80-TYPE EQUAL '09' OR '13')              1020116
263014                     GO TO K0970-CONT.                            1020116
263018     IF  ((TR-80-TYPE EQUAL '09' OR '13')                         1020116
263020     AND (WS-REGE-EFF EQUAL 'A' OR 'Y')                           1020116
263021     AND (WMS-OD-REGE-OPT-CODE EQUAL '2')                         1020116
263022     AND (TR-ATM-POS-RECUR NOT EQUAL '1'))                        1020116
263024         IF HOLD-OPT GREATER THAN +0                              1020116
263026             ADD +1 TO ATM-POS-NSF-CTR.                           1020116
263028 K0970-CONT.                                                      1020116
263050     IF HOLD-OPT GREATER THAN +0
263100         ADD +1 TO NSF-CTR.
263150     MOVE '1' TO NSF-TOTAL-SW.
263170     ADD TR-AMOUNT TO HOLD-EFA-NSF-AMT.                           IM007
263200     GO TO K0230.
263250 K1090-OD.
263252*----------------------------------------------------------------*9915749
263254*    SET EX13-NB-FORCE-PAY-IND TO 'Y' IF THE TRANSACTION UPDATES *9915749
263256*    THE DATE LAST CUSTOMER ACTIVITY AND DOES NOT GENERATE       *9915749
263258*    NSF/OD CHRG OR UPDATE NSF/OD CTRS.                          *9915749
263260*----------------------------------------------------------------*9915749
263262     IF  TR-OPTION (6) EQUAL TO '1'                               9915749
263264         IF  TR-OPTION (10) EQUAL TO '1' OR '3' OR '7'            9915749
263266             IF  TR-OPTION (5) EQUAL '0' OR '4'                   9915749
263268                 MOVE 'Y' TO EX13-NB-FORCE-PAY-IND.               9915749
263270     IF (TR-OPTION (6) EQUAL TO '1' OR '3' OR '5')                0827769
263271     OR  WMS-FORCE-POST EQUAL 'Y'                                 0827769
263272         NEXT SENTENCE                                            9915749
263274     ELSE                                                         9915749
263276         MOVE 'P' TO EX13-NB-PEND-DEC-IND.                        9915749
263280     MOVE '0' TO EX13-REASON-OR-OPT.                              0337129
263300     MOVE '1' TO WMS-OD-TODAY.
263350     PERFORM K0290-OD THRU K0295.
263400     MOVE TR-OPTION9 (5) TO HOLD-OPT.
263450     IF HOLD-OPT GREATER THAN +3
263500         SUBTRACT +4 FROM HOLD-OPT.
263510     IF  HOLD-OPT NOT GREATER THAN +0                             0337129
263520         GO TO K1100-POST.                                        0337129
263530*----------------------------------------------------------------*0337129
263540*    THE FOLLOWING HAS BEEN MODELED AFTER K0296 DEPENDING        *0337129
263550*    ON OPTIONS +1 AND +2 OF TRANSACTION OPTION #5.              *0337129
263560*----------------------------------------------------------------*0337129
263570     IF  WMS-SAV-PTR EQUAL TO ZERO                                0337129
263580     AND WMS-CHG-CARD-FLG EQUAL ZERO                              0337129
263590         ADD +1 TO WMS-SC-OD-ITEMS, WMS-MTD-OD-ITEMS.             0337129
263600     MOVE '1' TO OD-TODAY.                                        0337129
263602     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
263603     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
263604         IF  BATCH-RUN-FDIC NOT LESS THAN TR-AMOUNT               0930077
263606             IF  (CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-AMOUNT)   0930077
263607             AND (HOLD-OPT EQUAL +1 OR +3)                        0930077
263608                 ADD +1 TO OD-CTR-FDIC                            1020116
263609                 IF  (TR-80-TYPE EQUAL '09' OR '13')              1020116
263610                     GO TO K1090-OD-CONT.                         1020116
263612     IF  ((TR-80-TYPE EQUAL '09' OR '13')                         1020116
263613     AND (WS-REGE-EFF EQUAL 'A' OR 'Y')                           1020116
263614     AND (WMS-OD-REGE-OPT-CODE EQUAL '2')                         1020116
263615     AND (TR-ATM-POS-RECUR NOT EQUAL '1'))                        1020116
263616         IF  (CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-AMOUNT)       1020116
263617         AND (HOLD-OPT EQUAL +1 OR +3)                            1020116
263618             ADD +1 TO ATM-POS-OD-CTR.                            1020116
263619 K1090-OD-CONT.                                                   1020116
263620     IF  WMS-OD-CHG-CODE EQUAL '2'                                1020109
263621         IF  HOLD-OPT EQUAL +1 OR +3                              1020109
263622             ADD +1 TO OD-CTR                                     1020109
263623             GO TO K1095                                          1020109
263624         ELSE                                                     1020109
263625             GO TO K1095.                                         1020109
263626     IF  CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-AMOUNT             1020109
263627         IF  HOLD-OPT EQUAL +1 OR +3                              1020109
263635             ADD +1 TO OD-CTR                                     1020116
263640         ELSE                                                     0337129
263650             NEXT SENTENCE                                        0337129
263660     ELSE                                                         0337129
263670         IF  WMS-OD-CHG-CODE EQUAL '1'                            0337129
263680             GO TO K1100-POST.                                    0337129
263682                                                                  1020109
263684 K1095.                                                           1020109
263690     IF  HOLD-OPT LESS THAN +2                                    0337129
263700         GO TO K1100-POST.                                        0337129
263710     SUBTRACT +2 FROM HOLD-OPT.                                   0337129
263720     MOVE 'H2' TO IMEX-CODE-1.                                    0337129
263722     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
263724     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
263726         IF  BATCH-RUN-FDIC NOT LESS THAN TR-AMOUNT               0930077
263728             MOVE 'HP' TO IMEX-CODE-1.                            0927850
263730*----------------------------------------------------------------*0337129
263740*   SET EXCEPTION CODE TWO IF THE ACCOUNT HAS A LINE-OF-CREDIT.  *0337129
263750*   THIS EXCEPTION CAN BE USED TO GENERATE NOTICES.              *0337129
263760*----------------------------------------------------------------*0337129
263770*   MOVE 'P' TO EX13-NB-PEND-DEC-IND FOR ALL ODS EXCEPT LOCS.    *0337129
263780*----------------------------------------------------------------*0337129
263790     IF  WMS-OD-LIMIT EQUAL TO 'L'                                0337129
263800         MOVE 'HU'  TO  IMEX-CODE-2                               0337129
263810     ELSE                                                         0337129
263820         MOVE 'P'   TO  EX13-NB-PEND-DEC-IND                      0337129
263830                        TR-PEND-DECISION.                         0337129
263840     MOVE '073' TO WK-REJ-REASON.                                 0717565
263850     MOVE '1' TO EX13-REASON-OR-OPT.                              0337129
263860     PERFORM X3000-REJ-REASON THRU X3000-EXIT.                    0337129
263870     MOVE '1' TO TRAN-REWRITE-SW.                                 0337129
263880*----------------------------------------------------------------*0337129
263890*    TURN OFF PENDING DECISION FLAG ON FORCE PAY ITEMS AND       *0337129
263900*    OD-LIMIT EQUAL L, OR 1-9.                                   *0337129
263910*----------------------------------------------------------------*0337129
263911     IF (TR-OPTION (6) EQUAL '1' OR '3' OR '5')                   0827769
263912     OR  WMS-FORCE-POST EQUAL 'Y'                                 0827769
263913         MOVE ' ' TO TR-PEND-DECISION                             0827769
263914         MOVE ' ' TO EX13-NB-PEND-DEC-IND.                        0827769
263920     IF  WMS-OD-LIMIT GREATER THAN '0'                            0337129
263930     AND WMS-OD-LIMIT NOT GREATER THAN '9'                        0337129
263940         MOVE ' ' TO TR-PEND-DECISION                             0337129
263950         MOVE ' ' TO EX13-NB-PEND-DEC-IND.                        0337129
263960     PERFORM K0330 THRU K0339.                                    0337129
264000                                                                  0337129
264100 K1100-POST.
264121*----------------------------------------------------------------*9915749
264122*    ADD TO CHECK COUNTER IF TRAN CODE OPTION 15 VALUE 4 ON FOR  *9915749
264123*    POS PINLESS DEBITS.                                         *9915749
264124*----------------------------------------------------------------*9915749
264130     IF  TR-OPTION (15) EQUAL '4' OR '5' OR '6' OR '7'            9915749
264131         ADD +1 TO WMS-SC-CHECK-ITEMS.                            9915749
264150     ADD +1 TO FS-DB.
264152*----------------------------------------------------------------*0627451
264154*    ADD TO OVERDRAFT CYCLE-TO-DATE AND OVERDRAFT YEAR-TO-DATE   *0627451
264156*    IF OPTION 18 VALUE 2 IS ON.                                 *0627451
264158*----------------------------------------------------------------*0627451
264160     IF TR-OPTION (18) EQUAL '2' OR '3'                           0627451
264162        ADD TR-AMOUNT TO WMS-STMT-OVERDRAFT-CHGD-CTD              0627451
264164        ADD TR-AMOUNT TO WMS-STMT-OVERDRAFT-CHGD-YTD.             0627451
264166*----------------------------------------------------------------*0627451
264168*    ADD TO NSF CYCLE-TO-DATE AND NSF                            *0627451
264170*    YEAR-TO-DATE IF OPTION 18 VALUE 4 IS ON.                    *0627451
264172*----------------------------------------------------------------*0627451
264174     IF TR-OPTION (18) EQUAL '4' OR '5'                           0627451
264176        ADD TR-AMOUNT TO WMS-STMT-NSF-CHGD-CTD                    0627451
264178        ADD TR-AMOUNT TO WMS-STMT-NSF-CHGD-YTD.                   0627451
264200     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
264250         PERFORM K7200 THRU K8500.
264252*----------------------------------------------------------------*9915749
264254*    ADD TO FEE CHRG OFF FIELD WHEN NSF/OD FEE IS CAUSING        *9915749
264256*    WMS-CURR-BAL TO BE NEGATIVE.                                *9915749
264258*----------------------------------------------------------------*9915749
264260     IF  TR-TRAN-TYPE EQUAL '4' AND                               9915845
264262         (TR-OPTION (14) EQUAL '2' OR '3' OR '6' OR '7')          9915749
264264         IF  WMS-CURR-BAL LESS THAN ZERO                          9915749
264266             ADD TR-AMOUNT          TO  WMS-NB-CHRG-OFF-NSF       9915749
264268         ELSE                                                     9915749
264270             COMPUTE WK-NEG-FEE-AMT  =  WMS-CURR-BAL              9915749
264272                                     -  TR-AMOUNT                 9915749
264274             IF  WK-NEG-FEE-AMT LESS THAN ZERO                    9915749
264276                 COMPUTE WMS-NB-CHRG-OFF-NSF =                    9915749
264278                     WMS-NB-CHRG-OFF-NSF + (WK-NEG-FEE-AMT * -1). 9915749
264280     IF  BATCH-RUN-BAL-OD-UPDATED EQUAL 'N'                       9916451
264285         SUBTRACT TR-AMOUNT FROM BATCH-RUN-BALANCE                9916451
264290                                 BATCH-RUN-OD.                    9916451
264292     SUBTRACT TR-AMOUNT FROM BATCH-RUN-FDIC.                      0930077
264300     SUBTRACT TR-AMOUNT FROM WMS-CURR-BAL                         IM003
264307                             CUR-BAL                              IM003
264308                             CUST-BAL.                            1020116
264309     IF  (TR-80-TYPE EQUAL '09' OR '13')                          1020116
264310     AND (TR-ATM-POS-RECUR NOT EQUAL '1')                         1020116
264311     AND (WMS-CURR-BAL LESS THAN ZERO)                            1020116
264312         ADD +1 TO WMS-OD-REGE-SUST-CTR.                          1020116
264315     MOVE '  ' TO TR-REJ-PROG.                                    9915749
264321     IF  CUST-BAL LESS THAN ZERO                                  9915749
264324     AND WMS-OD-TODAY EQUAL '0'                                   9915749
264328         MOVE TR-OPTION9 (13) TO HOLD-OPT                         9915749
264335         PERFORM K0270-DAU THRU K0270-EXIT.                       9915749
264350     ADD TR-AMOUNT TO WMS-TODAYS-DEBITS.
264400     ADD +1 TO WMS-TODAYS-DEBITS-NO.
264402     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
264404         ADD TR-AMOUNT   TO T3-PLAN-DEB-AMT                       0617360
264406                            WS-GL-PLAN-DEB-AMT                    0617360
264408         MOVE 'X'        TO WS-PLN-TRLR-FULL                      0617360
264410         MOVE TR-AMOUNT  TO WS-WORK-CTDT-AMT                      0617360
264411         PERFORM CHECK-PLAN-REV THRU CPR-END                      0617360
264412         PERFORM UPDATE-PLN-CTDT THRU UIC-END                     0617360
264414         MOVE 'PT'       TO IMEX-CODE-1                           0617360
264416         PERFORM K0330 THRU K0339.                                0617360
264418     IF  TR-USER-CODE  EQUAL WBC-FDIC-DR-CODE                     0927850
264420         MOVE 'FB' TO IMEX-CODE-1                                 0927850
264422         PERFORM K0330 THRU K0339.                                0927850
264450     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
264500     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
264550         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
264600         ADD TR-AMOUNT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT            0902970
264650     ELSE
264700         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
264750         ADD TR-AMOUNT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.           0902970
264752*----------------------------------------------------------------*2010732
264754*    ADD EXTERNAL OD/NSF FEE TO GL TOTALS                         2010732
264756*----------------------------------------------------------------*2010732
264758     IF  (UB-OPTION-FLAG(1) EQUAL 'Y')                            2010732
264760     AND (TR-USER-CODE EQUAL UB-FLD1-4 (1 1) OR UB-FLD1-4 (1 2))  2010732
264762         ADD +1        TO WS-GL-USER-COUNT-1                      2010732
264764         ADD TR-AMOUNT TO WS-GL-USER-AMOUNT-1.                    2010732
264766*                                                                 2010732
264767     IF  UB-OPTION-FLAG(3) EQUAL 'Y'                              2015774
264768         PERFORM UO-OPT0003-A THRU UO-OPT0003-A-EXIT.             2015774
264770*                                                                 2015774
264772     IF  UB-OPTION-FLAG(4) EQUAL 'Y'                              2015774
264773         PERFORM UO-OPT0004-A THRU UO-OPT0004-A-EXIT.             2015774
264774*                                                                 2015774
264800     MOVE '1' TO POST-TODAY.
264802     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
264810*--------------------------------------------------------------*  2016639
264812*    ADD TO EXTERNAL INVESTMENT TOTAL AND GL FIELDS            *  2016639
264814*--------------------------------------------------------------*  2016639
264816     IF  WMS-XINV-PROCESS-IND  EQUAL '1'                          2016639
264818         IF  (TR-USER-CODE     EQUAL WBC-XINV-DDA-DR-CODE         0266741
264820         AND WMS-XINV-LINK-IND EQUAL 'L')                         2016639
264822         OR  WMS-XINV-LINK-IND EQUAL 'P'                          2016639
264824             ADD TR-AMOUNT       TO  T3-XINV-SD-PUR-AMT           2016639
264826                                     WS-GL-XINV-SD-PUR-AMT        2016639
264828             ADD TR-AMOUNT       TO  WXI-XINV-BALANCE             2016639
264830             PERFORM R9120-Q5  THRU  R9199-EXIT.                  2016639
264832*                                                                 2016639
264850     IF WMS-LOAN-TRLR EQUAL TO '1' AND LOAN-TODAY NOT EQUAL ZERO
264900         PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
264950     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
264960*                                                                 1004143
264962*----------------------------------------------------------------*1004143
264964*                                                                *1004143
264966*  DO NOT ACCUMULATE ACH PRE-NOTE TRANSACTIONS                   *1004143
264968*                                                                *1004143
264970*----------------------------------------------------------------*1004143
264972*                                                                 1004143
264975     IF  TR-OPTION (8) EQUAL '2' OR '6'                           1004143
264980         IF  TR-AMOUNT EQUAL ZERO                                 1004143
264985             GO TO K1100-CONTINUE.                                1004143
265000     MOVE TR-OPTION9 (3) TO HOLD-OPT.
265050     IF HOLD-OPT LESS +4                                          2016596
265055         GO TO K1100-CONT-A.                                      2016596
265100     SUBTRACT +4 FROM HOLD-OPT.                                   2016596
265145     IF  WMS-SC-CREDITS GREATER ZERO                              2016596
265150         SUBTRACT +1 FROM WMS-SC-CREDITS.                         2016596
265155     IF  WMS-MTD-SVC-CHG-CR GREATER ZERO                          2016596
265160         SUBTRACT +1 FROM WMS-MTD-SVC-CHG-CR.                     2016596
265165     IF  WMS-BIR-FLAG NOT EQUAL '1' AND '2'                       2016596
265167         GO TO K1100-CONT-A.                                      2016596
265170     IF  WMS-BIR-MTD-DP-NBR GREATER ZERO                          2016596
265175         SUBTRACT +1 FROM WMS-BIR-MTD-DP-NBR.                     2016596
265180     IF  WMS-BIR-MTD-DP-AMT NOT LESS TR-AMOUNT                    2016596
265185         SUBTRACT TR-AMOUNT FROM WMS-BIR-MTD-DP-AMT               2016596
265187     ELSE                                                         2016596
265190         MOVE ZERO TO WMS-BIR-MTD-DP-AMT.                         2016596
265195 K1100-CONT-A.                                                    2016596
265200     IF HOLD-OPT GREATER THAN +1
265250         SUBTRACT +2 FROM HOLD-OPT
265300         ADD TR-ITEM-COUNT TO WMS-MTD-SVC-CHG-DR
265350         ADD TR-ITEM-COUNT TO WMS-SC-DEBITS                       2016374
265355         IF  WMS-BIR-FLAG EQUAL '1' OR '2'                        2016374
265360             ADD TR-ITEM-COUNT TO WMS-BIR-MTD-WD-NBR              2016374
265365             ADD TR-AMOUNT TO WMS-BIR-MTD-WD-AMT.                 2016374
265400     IF HOLD-OPT GREATER THAN +0
265405         ADD +1 TO WMS-SC-DEBITS, WMS-MTD-SVC-CHG-DR              2016374
265410         IF  WMS-BIR-FLAG EQUAL '1' OR '2'                        2016374
265415             ADD +1 TO WMS-BIR-MTD-WD-NBR                         2016374
265420             ADD TR-AMOUNT TO WMS-BIR-MTD-WD-AMT.                 2016374
265460 K1100-CONTINUE.                                                  1003625
265500     MOVE TR-OPTION9 (4) TO HOLD-OPT.
265550     IF HOLD-OPT GREATER THAN +3
265600         SUBTRACT +4 FROM HOLD-OPT
265610         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
265612                        OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G' 0417110
265650             IF WMS-STMT-ITEMS GREATER THAN +0                    1105504
265700                SUBTRACT +1 FROM WMS-STMT-ITEMS.                  1105504
265750     IF HOLD-OPT GREATER THAN +1
265800         SUBTRACT +2 FROM HOLD-OPT
265810         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
265812                     OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G'    0417110
265850             ADD TR-ITEM-COUNT TO WMS-STMT-ITEMS.                 1105504
265900     IF HOLD-OPT GREATER THAN +0
265910         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
265912                        OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G' 0417110
265950             ADD +1 TO WMS-STMT-ITEMS.                            1105504
265958* ---UPDATE SYSTEM TOTALS FOR POSTED STOP/HOLD CHARGES            IM003
266000 K1110.
266050     IF TR-OPTION (5) GREATER THAN '3'
266100         ADD TR-ITEM-COUNT TO WMS-SC-NO-CHECKS.
266150     MOVE TR-OPTION9 (9) TO HOLD-OPT.
266200     IF HOLD-OPT GREATER THAN +3
266250         SUBTRACT +4 FROM HOLD-OPT.
266300     IF HOLD-OPT GREATER THAN +1
266350         SUBTRACT +1 FROM WMS-SC-TRAN-NO WMS-MTD-TRN-NO
266400         SUBTRACT TR-AMOUNT FROM WMS-SC-TRAN-AMT WMS-MTD-TRAN-AMT
266450         SUBTRACT +2 FROM HOLD-OPT.
266500     IF  HOLD-OPT GREATER THAN +0
266550         NEXT SENTENCE
266600     ELSE
266650         GO TO K1115.
266700     IF  WMS-CHECKS-RETURNED GREATER THAN +0
266750         SUBTRACT +1 FROM WMS-CHECKS-RETURNED.
266800     IF  WMS-SC-NSF-ITEMS GREATER THAN +0
266850         SUBTRACT +1 FROM WMS-SC-NSF-ITEMS.
266900     IF  WMS-MTD-NSF-ITEMS GREATER THAN +0
266950         SUBTRACT +1 FROM WMS-MTD-NSF-ITEMS.
266960     ADD +1 TO NSF-RVRSL-CTR.                                     1104882
267000 K1115.
267050     ADD +1 TO SEQ-CTR.
267100     IF TR-OPTION (8) EQUAL TO '1' OR '3' OR '5' OR '7'
267150         ADD TR-AMOUNT TO WMS-MTD-ACCUM-SERV-CHG,
267152         ADD TR-AMOUNT TO WMS-YTD-ACCUM-SERV-CHG                  0617360
267200         ADD TR-AMOUNT TO WMS-STMT-SERV-CHG                       1004525
267250             GO TO K1120.
267300     IF TR-OPTION (7) GREATER THAN '3'
267350         ADD TR-AMOUNT TO WMS-STMT-TRAN-CHG
267400         ADD TR-AMOUNT TO WMS-MTD-ACCUM-TRAN-CHG
267450         GO TO K1120.
267455*--------------------------------------------------------------*  0902213
267460*  IF BALANCE HISTORY IS BEING USED, THE ACCRUAL PHASE WILL    *  0902213
267465*  DETERMINE WHETHER TO ADD TO THE CURRENT OR THE PREVIOUS     *  0902213
267470*  CYCLES PREAUTHORIZED TRANSFERS COUNTER.  THIS IS USED TO    *  0902213
267475*  DETERMINE INELIGIBLE HIGH RATE ACCOUNTS.                    *  0902213
267480*--------------------------------------------------------------*  0902213
267485     MOVE ZERO TO ACCR-INT-TRAN-NO.                               0902213
267490     IF  TR-OPTION (14) GREATER THAN '3'                          1103704
267495         MOVE +1 TO ACCR-INT-TRAN-NO.                             0902213
267500     PERFORM K0756 THRU K0756-EXIT.
267520     MOVE ZERO TO ACCR-INT-TRAN-NO.                               0902213
267550     IF TR-80-TYPE EQUAL TO '06'
267600         PERFORM K0347 THRU K0347-EXIT                            IM002
267700         IF  WMS-HIFI-INDICATOR EQUAL +0
267750         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
267850             PERFORM X0850 THRU X0880-RHR-EXIT                    0903344
267900         ELSE
267950             NEXT SENTENCE
268000     ELSE
268050         ADD +1 TO WMS-STMT-NO-DEBITS
268100         ADD TR-AMOUNT TO WMS-STMT-DR-AMT.
268150 K1120.
268200     PERFORM K0315 THRU K0344.                                    IM004
268250     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
268300     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
268350     IF TR-OPTION (10) EQUAL TO '0'
268400         GO TO K1130.
268450     IF TR-OPTION (10) EQUAL TO '2' OR '3' OR '6' OR '7'          IM004
268455     AND (LIST-POST-ITEM  NOT EQUAL '1')                          0827768
268460         ADD +1 TO WMS-SC-NO-CHECKS                               2015748
268500         PERFORM K0305-CHECK-FOR-CHK-CHG THRU K0312-EXIT.         IM004
268550     IF TR-OPTION (10) EQUAL TO '2' OR '6'                        IM004
268600         GO TO K1130.                                             IM004
268650     IF TR-OPTION (10) EQUAL TO '1' OR '3' OR '5' OR '7'          IM004
268700         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'        IM005
268750             PERFORM K0118 THRU K0118-EXIT                        9915845
268800         ELSE                                                     IM004
268850             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.0266741
269050 K1130.
269100     IF TR-OPTION (11) EQUAL '1' OR '3' OR '5' OR '7'
269150         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
269200         PERFORM K0117 THRU K0118-EXIT.                           9915845
269250     IF TR-OPTION (11) EQUAL '1' OR '3' OR '5' OR '7'
269300         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
269350         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-WITHDRAWAL   0266741
269400                                 WMS-DATE-LAST-CUST-ACTIVITY
269450         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-WITHDRAWAL.
269500     IF  TR-OPTION (11) GREATER THAN '1'
269550         SUBTRACT TR-AMOUNT FROM WMS-IOD-YTD-INT-PAID,            0902970
269600                      IOD-INT-YTD-ADJ, WS-GL-IOD-INT-YTD-ADJ      9915858
269601         IF  WMS-PLAN-TRLR EQUAL '1'                              0617360
269602             SUBTRACT TR-AMOUNT FROM WMS-PLN-TRLR-PR-LTD-INT-PD   0617360
269603             END-IF                                               0617360
269604         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         0617360
269605             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-IOD-INT      0617360
269606                  DUAL-IO-INT-YTD-ADJ, WS-GL-DUAL-IO-INT-YTD-ADJ. 9915858
269610     IF  TR-OPTION (11) GREATER THAN '1'                          9915828
269620         PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT               9915828
269630         IF  CERT-NAME-W8-STATUS EQUAL '1'                        9915828
269640             SUBTRACT TR-AMOUNT FROM WMS-IOD-YTD-INT-PAID-1042.   9915828
269650     IF  TR-OPTION (11) GREATER THAN '3'
269700         SUBTRACT TR-AMOUNT FROM WMS-IOD-CYC-PAID-INT
269750                                 WMS-IOD-MTD-PAID-INT.
269800     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
269850     AND (TR-OPTION (12) EQUAL TO '2' OR '3')                     1004922
269900         ADD TR-AMOUNT TO WMS-OD-YTD-CHGD                         1004922
269950                          OD-CHRGS-ADJ-YTD                        1004922
269951                          WS-GL-OD-CHRGS-ADJ-YTD.                 1004922
269970     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            1004922
270000     AND (TR-OPTION (12) EQUAL TO '1' OR '3')                     1004922
270002         ADD TR-AMOUNT TO WMS-OD-CYC-CHGD                         2012254
270004                          WMS-OD-MTD-CHGD.                        2012254
270006     IF  TR-OPTION (13) EQUAL '1' OR '3' OR '5' OR '7'            2012254
270008         ADD TR-AMOUNT TO        WMS-IOD-YTD-TAX                  2012254
270010                                 WMS-IOD-CYC-TAX                  2012254
270012                                 WMS-IOD-MTD-TAX                  2012254
270014                                 IOD-TAX-ADJ-UP-AMT               2012254
270016                                 WS-GL-IOD-TAX-ADJ-UP-AMT         2012254
270018         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
270020             ADD TR-AMOUNT TO    WMS-DUAL-YR-CUR-IOD-FED          2012254
270022                                 DUAL-IO-TAX-ADJ-UP-AMT           2012254
270024                                 WS-GL-DUAL-IO-TAX-ADJ-UP-AMT.    2012254
270026     IF  (TR-OPTION (2) EQUAL '4' OR '5' OR '6' OR '7')           2012254
270028     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
270030         ADD TR-AMOUNT        TO WMS-IOD-YTD-STATE-TAX            2012254
270032                                 WMS-IOD-CYC-STATE-TAX            2012254
270034                                 WMS-IOD-MTD-STATE-TAX            2012254
270036                                 IOD-TAX-ADJ-UP-AMT-ST            2012254
270038                                 WS-GL-IOD-TAX-ADJ-UP-ST-AMT      2012254
270040         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
270042             ADD TR-AMOUNT    TO WMS-DUAL-YR-CUR-IOD-STATE        2012254
270044                                 DUAL-IO-TAX-ADJ-UP-AMT-ST        2012254
270046                                 WS-GL-DUAL-IO-TX-ADJ-UP-ST-A.    2012254
270048     IF  (TR-OPTION (16) EQUAL '4' OR '5' OR '6' OR '7')          2012254
270050     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
270052         ADD TR-AMOUNT TO        WMS-IOD-YTD-LOCAL-TAX            2012254
270054                                 WMS-IOD-CYC-LOCAL-TAX            2012254
270056                                 WMS-IOD-MTD-LOCAL-TAX            2012254
270058                                 IOD-TAX-ADJ-UP-AMT-LOC           2012254
270060                                 WS-GL-IOD-TAX-ADJ-UP-LOC-AMT     2012254
270062         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
270064             ADD TR-AMOUNT TO    WMS-DUAL-YR-CUR-IOD-LOCAL        2012254
270066                                 DUAL-IO-TAX-ADJ-UP-AMT-LOC       2012254
270068                                 WS-GL-DUAL-IO-TX-ADJ-UP-LOC-A.   2012254
270141     IF WMS-KITING-SUSP-TRLR EQUAL '1'                            IM006
270142         IF (TR-OPTION (14) EQUAL '1' OR '3' OR '5' OR '7') AND   IM006
270143            (TR-80-TYPE NOT EQUAL '06' AND '08'                   IM006
270144                              AND '12' AND '13' AND '14')         IM006
270145             MOVE '1' TO KITE-ITEM-FLAG                           IM006
270146             ADD TR-ITEM-COUNT TO WMS-KITE-TODAY-DR-NO (7)        IM006
270147             ADD TR-AMOUNT TO WMS-KITE-TODAY-DR-AMT (7).          IM006
270650     IF  TR-OPTION (14) GREATER THAN '3'                          1103704
270700         ADD +1 TO WMS-SC-AMTTRNSFR-NO.
270750 K1140.
270760     IF  TR-OPTION (15) EQUAL '1' OR '3' OR '5' OR '7'            1004773
270770         ADD TR-AMOUNT TO WBC-REG-TFR-AMT (4)                     0266741
270780                          WBC-REG-CALL-AMT (13).                  0266741
270790     IF  TR-OPTION (14) EQUAL '4' OR '5' OR '6' OR '7'            1004773
270795         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (9).             0266741
270800     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
270850         IF  WMS-HIFI-INDICATOR EQUAL +0
270900         AND WMS-IOD-RATE-PTR EQUAL +0                            IM008
271000             PERFORM X0850 THRU X0880-RHR-EXIT.                   0903344
271100     IF  TR-OPTION (15) EQUAL '1' OR '3' OR '5' OR '7'            1004015
271110         ADD TR-AMOUNT TO WMS-IOD-TIS-CYC-FEES.                   1004015
271460 K1140-EXIT.                                                      IM002
271470     EXIT.                                                        IM002
271480 K1145.                                                           IM002
271500     GO TO K7000.
271550 K1150-UNPOST.
271600*  --PRE-EXISTING CODE IS UTILIZED FOR UNPOSTING
271650     GO TO K0350-UNPOST.
271700     SKIP3
271750 LOAN-SECTION-A      SECTION 24.
271800     SKIP3
271850*    ***************  LOAN CREDIT PROCESSING  **************
271900     SKIP1
271950 K1200.
272000     IF WMS-LOAN-STATUS EQUAL '6'
272005         IF  TR-OPTION (5) EQUAL '1' OR '3' OR '5' OR '7'         1105132
272010             GO TO K1201                                          1105132
272015         ELSE                                                     1105132
272050             MOVE '010' TO REJRESN                                0717565
272100             GO TO K1550-UNPOST.                                  1105132
272150     IF WMS-LOAN-STATUS GREATER THAN '2' AND NOT EQUAL '5'
272200         MOVE '014' TO REJRESN                                    0717565
272250         GO TO K1550-UNPOST.
272260 K1201.                                                           1105132
272300***  PREVENT OVERPAYMENT TO PURGED, TERMINATED, OR FROZEN ACCOUNT IM005
272302*    OR NO CREDIT ACCOUNT                                         1010046
272310     IF (WMS-STATUS EQUAL '08' OR '01' OR '03' OR '11')           1010046
272320         ADD WMS-PRIN-BAL, WMS-INTRST-BAL, WMS-OTHER-CHGS         IM005
272330             GIVING PAYOFF-AMT                                    IM005
272340         ADD +.005, WMS-LOAN-ACCR-INT GIVING ACCR-AMT1            IM005
272350         ADD ACCR-AMT1 TO PAYOFF-AMT                              IM005
272360         IF  TR-AMOUNT GREATER THAN PAYOFF-AMT                    IM005
272370             MOVE '041' TO REJRESN                                0717565
272450             GO TO K1550-UNPOST.
272500     MOVE ZERO TO PRIN-DISB
272550                  INT-DISB
272600                  OTH-DISB
272650                  PRIN-OLD-DISB
272700                  ADDL-CR-DISB.
272750     MOVE TR-AMOUNT TO HOLD-AMT11.
272800     MOVE SPACE TO BACKDATE-SW.                                   IM005
272820     MOVE 'F' TO TOLERANCE-SW.                                    IM002
272850     GO TO K1205
272900           K1280
272950           K1300
273000           K1320
273050           K1380
273100           K1400
273150           K1410
273200           K1420
273220           K1430                                                  IM006
273250                 DEPENDING ON TR-OPTION9 (2).
273300 K1205.
273350     IF  TR-80-TYPE EQUAL '11'                                    IM002
273360         PERFORM K1240-PRIN-DISB THRU K1240-PRIN-DISB-EXIT        9915845
273370         MOVE 'N' TO BACKDATE-SW.                                 IM005
273400     MOVE TR-AMOUNT TO HOLD-AMT.
273450     MOVE TR-OPTION9 (3) TO HOLD-OPT.
273500     PERFORM K1350 THRU K1350-EXIT.
273550     IF  TOLERANCE-SW EQUAL 'N'
273600         PERFORM K1360 THRU K1360-EXIT.
273650 K1207.
273700     IF WBC-PYMT-APPL NOT EQUAL TO '1', GO TO K1250.              0266741
273750     SKIP3
273800 ROOT-SECTION-V      SECTION 1.
273850     SKIP3
273900 K1210-INTEREST.
273950     IF HOLD-AMT11 NOT GREATER THAN ZERO, GO TO K1210-EXIT.
274000     IF HOLD-AMT11 GREATER THAN WMS-INTRST-BAL
274050         SUBTRACT WMS-INTRST-BAL FROM HOLD-AMT11
274100         ADD WMS-INTRST-BAL TO LOAN-INT-PAID, INT-DISB,           0902970
274101                               WS-GL-LOAN-INT-PAID                0902970
274150         ADD WMS-INTRST-BAL TO WMS-LOAN-YTD-INT, WMS-COLLECT-INT
274200         MOVE ZERO TO WMS-INTRST-BAL
274250     ELSE
274300         ADD HOLD-AMT11 TO LOAN-INT-PAID, INT-DISB,               0902970
274301                           WS-GL-LOAN-INT-PAID                    0902970
274350         ADD HOLD-AMT11 TO WMS-LOAN-YTD-INT, WMS-COLLECT-INT
274400         SUBTRACT HOLD-AMT11 FROM WMS-INTRST-BAL
274450         MOVE ZERO TO HOLD-AMT11.
274500     IF CURR-PMT-AUTO NOT EQUAL TO '1'
274550         IF WMS-INTRST-BAL LESS THAN WMS-LOAN-DLAY-INT
274600             MOVE WMS-INTRST-BAL TO WMS-LOAN-DLAY-INT.
274650 K1210-EXIT. EXIT.
274700 K1220-OTHER.
274750     IF HOLD-AMT11 NOT GREATER THAN ZERO, GO TO K1220-EXIT.
274800     IF HOLD-AMT11 GREATER THAN WMS-OTHER-CHGS
274850         SUBTRACT WMS-OTHER-CHGS FROM HOLD-AMT11
274900         ADD WMS-OTHER-CHGS TO LOAN-OTH-PAID, OTH-DISB,           0902970
274901                               WS-GL-LOAN-OTH-PAID                0902970
274950         MOVE ZERO TO WMS-OTHER-CHGS
275000                      WMS-INS1
275050                      WMS-INS2
275100                      WMS-FEES
275150         GO  TO  K1220-EXIT.
275200     SUBTRACT HOLD-AMT11 FROM WMS-OTHER-CHGS.
275250     ADD HOLD-AMT11 TO LOAN-OTH-PAID, OTH-DISB,                   0902970
275251                       WS-GL-LOAN-OTH-PAID.                       0902970
275300     IF  HOLD-AMT11 GREATER THAN WMS-INS1
275350         SUBTRACT WMS-INS1 FROM HOLD-AMT11
275400         MOVE ZERO TO WMS-INS1
275450     ELSE
275500         SUBTRACT HOLD-AMT11 FROM WMS-INS1
275550         MOVE ZERO TO HOLD-AMT11
275600         GO  TO  K1220-EXIT.
275650     IF  HOLD-AMT11 GREATER THAN WMS-INS2
275700         SUBTRACT WMS-INS2 FROM HOLD-AMT11
275750         MOVE ZERO TO WMS-INS2
275800     ELSE
275850         SUBTRACT HOLD-AMT11 FROM WMS-INS2
275900         MOVE ZERO TO HOLD-AMT11
275950         GO  TO  K1220-EXIT.
276000     SUBTRACT HOLD-AMT11 FROM WMS-FEES.
276050     MOVE ZERO TO HOLD-AMT11.
276100 K1220-EXIT. EXIT.
276150 K1240-PRINCIPAL.
276200     IF  WBC-PYMT-APPL EQUAL '3'                                  0266741
276250         IF  HOLD-AMT11 GREATER THAN WMS-PRIN-BAL
276300             SUBTRACT WMS-PRIN-BAL FROM HOLD-AMT11
276350             PERFORM K1220-OTHER THRU K1220-EXIT
276400             ADD WMS-PRIN-BAL TO HOLD-AMT11.
276450     IF WMS-ADDITIONAL-CREDIT EQUAL TO ZERO, GO TO K1240-EXIT-A.
276500     IF HOLD-AMT11 GREATER THAN WMS-ADDL-PYMT-AMT
276550         ADD WMS-ADDL-PYMT-AMT TO ADDL-CR-DISB
276600         SUBTRACT WMS-ADDL-PYMT-AMT FROM WMS-ADDITIONAL-CREDIT
276650     ELSE
276700         ADD HOLD-AMT11 TO ADDL-CR-DISB
276750         SUBTRACT HOLD-AMT11 FROM WMS-ADDITIONAL-CREDIT.
276800     IF WMS-ADDITIONAL-CREDIT NOT GREATER THAN ZERO
276850         ADD WMS-ADDITIONAL-CREDIT TO ADDL-CR-DISB
276900         MOVE ZERO TO WMS-ADDITIONAL-CREDIT
276950                      WMS-ADDL-PYMT-AMT
277000                      WMS-ADDL-PYMT-CODE.
277050
277100 K1240-EXIT-A.
277150 K1240-PRIN-DISB.
277200     MOVE TR-LOAN-NEW-FIRST TO CALC-FLAG.
277250     IF (TR-80-TYPE EQUAL '11') AND
277300         (BACKDATE-SW NOT EQUAL 'N') AND                          IM005
277350         (PRIME-CALC-FLAG NOT EQUAL '2' AND '3')
277400         IF CALC-FLAG NOT EQUAL '1'
277450             PERFORM K1586-BACKDATE-OLD-FIRST THRU
277500                     K1587-BACK-OLD-EXIT
277550         ELSE
277600             PERFORM K1588-BACKDATE-NEW-FIRST THRU
277650                     K1589-BACK-NEW-EXIT.
277655 K1240-PRIN-DISB-EXIT.                                            9915845
277660     EXIT.                                                        9915845
277700 K1245.
277750     IF  PAYOFF-SW EQUAL 'N'                                      IM005
277753         IF  HOLD-AMT11 GREATER THAN WMS-PRIN-BAL                 IM005
277756             SUBTRACT WMS-PRIN-BAL FROM HOLD-AMT11                IM005
277759             ADD WMS-PRIN-BAL TO LOAN-PRIN-PAID, PRIN-DISB,       0902970
277760                                 WS-GL-LOAN-PRIN-PAID             0902970
277762             MOVE +0.00 TO WMS-PRIN-BAL                           IM005
277765         ELSE                                                     IM005
277768             ADD HOLD-AMT11 TO LOAN-PRIN-PAID, PRIN-DISB,         0902970
277769                               WS-GL-LOAN-PRIN-PAID               0902970
277771             SUBTRACT HOLD-AMT11 FROM WMS-PRIN-BAL                IM005
277774             MOVE +0.00 TO HOLD-AMT11                             IM005
277777     ELSE                                                         IM005
277780         SUBTRACT HOLD-AMT11 FROM WMS-PRIN-BAL                    IM005
277783         ADD HOLD-AMT11 TO LOAN-PRIN-PAID, PRIN-DISB,             0902970
277784                           WS-GL-LOAN-PRIN-PAID.                  0902970
277800     PERFORM K1596 THRU K1596-EXIT.                               9915845
277900     IF WMS-PRIN-BAL NOT GREATER THAN ZERO
277950         MOVE ZERO TO WMS-PREV-BAL
278000                      WMS-ADDITIONAL-CREDIT
278050                      WMS-ADDL-PYMT-AMT
278100                      WMS-ADDL-PYMT-CODE
278150         GO TO K1247.
278200     IF CALC-FLAG EQUAL TO '1'
278250         IF WMS-PRIN-BAL LESS THAN WMS-PREV-BAL
278300             SUBTRACT WMS-PRIN-BAL FROM WMS-PREV-BAL
278350                 GIVING HOLD-AMT9
278400             ADD HOLD-AMT9 TO PRIN-OLD-DISB
278450             MOVE WMS-PRIN-BAL TO WMS-PREV-BAL
278500             GO TO K1240-EXIT
278550         ELSE
278600             GO TO K1240-EXIT.
278650     SUBTRACT HOLD-AMT11 FROM WMS-PREV-BAL.
278700     IF WMS-PREV-BAL LESS THAN ZERO
278750         MOVE ZERO TO WMS-PREV-BAL.
278800 K1247.
278850     IF WBC-LOAN-OVER-PMT NOT EQUAL TO '1', GO TO K1240-EXIT.     0266741
278900     IF WMS-PRIN-BAL NOT LESS THAN ZERO, GO TO K1240-EXIT.
278950     MOVE EX-LOAN-DISB TO TEMP-48.                                9915845
279000     IF  WMS-PRIN-BAL + WMS-LOAN-ACCR-INT NOT GREATER THAN ZERO   IM005
279050         PERFORM R3670 THRU R3674                                 IM005
279100         MOVE '0' TO R3670-ALREADY                                IM005
279150     ELSE                                                         IM005
279200         MULTIPLY -1 BY WMS-PRIN-BAL GIVING HOLD-AMT              IM005
279250         SUBTRACT HOLD-AMT FROM WMS-LOAN-ACCR-INT                 IM005
279300         PERFORM R3671 THRU R3674.                                IM005
279350     MOVE TEMP-48 TO EX-LOAN-DISB.                                9915845
279400     SUBTRACT HOLD-AMT FROM LOAN-PRIN-PAID, PRIN-DISB,            0902970
279401                            WS-GL-LOAN-PRIN-PAID.                 0902970
279450     ADD HOLD-AMT TO WMS-PRIN-BAL.
279500     PERFORM K1596 THRU K1596-EXIT.                               9915845
279550     MOVE HOLD-AMT TO HOLD-AMT11.
279600     PERFORM K1210-INTEREST THRU K1210-EXIT.
279620     PERFORM K1220-OTHER    THRU K1220-EXIT.                      IM002
279630     IF  HOLD-AMT11 GREATER THAN +0.00                            IM002
279640         MULTIPLY -1 BY HOLD-AMT11 GIVING WMS-PRIN-BAL            IM002
279643         ADD HOLD-AMT11 TO LOAN-PRIN-PAID, PRIN-DISB,             0902970
279644                           WS-GL-LOAN-PRIN-PAID.                  0902970
279650 K1240-EXIT. EXIT.
279700     SKIP3
279750 LOAN-SECTION-G      SECTION 24.
279800     SKIP3
279850 K1248.
279900     GO TO K1450.
279950 K1250.
280000     IF WBC-PYMT-APPL EQUAL TO '2'                                0266741
280050         PERFORM K1220-OTHER THRU K1220-EXIT
280100         PERFORM K1210-INTEREST THRU K1210-EXIT
280150         GO TO K1240-PRINCIPAL.
280200     IF  WBC-PYMT-APPL EQUAL TO '3'                               0266741
280250         PERFORM K1210-INTEREST THRU K1210-EXIT
280300         PERFORM K1240-PRINCIPAL THRU K1240-EXIT
280350         GO TO K1450.
280400     GO TO K1210-INTEREST.
280450 K1280.
280500*  --THIS PARAGRAPH HANDLES OPTION TO DECREASE PRINCIPAL ONLY
280501     IF WBC-LOAN-OVER-PMT NOT EQUAL TO '1'                        0266741
280502        GO TO K1240-PRIN-DISB.                                    IM002
280505     IF  TR-80-TYPE EQUAL '11'                                    IM002
280510         PERFORM K1240-PRIN-DISB THRU K1240-PRIN-DISB-EXIT        9915845
280515         MOVE 'N' TO BACKDATE-SW.                                 IM005
280520     MOVE TR-AMOUNT TO HOLD-AMT.                                  IM002
280525     MOVE TR-OPTION9 (3) TO HOLD-OPT.                             IM002
280530     PERFORM K1350 THRU K1350-EXIT.                               IM002
280535     IF  TOLERANCE-SW EQUAL 'N'                                   IM002
280540         GO TO K1385.                                             1002318
280550     GO TO K1240-PRIN-DISB.
280600 K1300.
280650     SUBTRACT HOLD-AMT11 FROM WMS-ADDITIONAL-CREDIT.
280700     IF WMS-ADDITIONAL-CREDIT LESS THAN ZERO
280750         MOVE ZERO TO WMS-ADDITIONAL-CREDIT.
280800     GO TO K1240-PRIN-DISB.
280850 K1320.
280900     IF TR-LOAN-INT NOT EQUAL TO ZERO
280950         MOVE TR-LOAN-INT TO HOLD-AMT11
281000         PERFORM K1210-INTEREST THRU K1210-EXIT
281050         IF HOLD-AMT11 GREATER THAN ZERO
281100             PERFORM K1240-PRIN-DISB THRU K1240-EXIT.
281150     IF TR-LOAN-OTHER NOT EQUAL TO ZERO
281200         MOVE TR-LOAN-OTHER TO HOLD-AMT11
281250         PERFORM K1220-OTHER THRU K1220-EXIT
281300         IF HOLD-AMT11 GREATER THAN ZERO
281350             PERFORM K1240-PRIN-DISB THRU K1240-EXIT.
281400     IF TR-LOAN-OLD-PRIN GREATER THAN WMS-PREV-BAL
281450         ADD WMS-PREV-BAL TO PRIN-OLD-DISB
281500         MOVE ZERO TO WMS-PREV-BAL
281550     ELSE
281650         ADD TR-LOAN-OLD-PRIN TO PRIN-OLD-DISB.
281700     IF TR-LOAN-ADDL-CR NOT LESS THAN WMS-ADDITIONAL-CREDIT
281750         ADD WMS-ADDITIONAL-CREDIT TO ADDL-CR-DISB
281800         MOVE ZERO TO WMS-ADDITIONAL-CREDIT
281850                      WMS-ADDL-PYMT-AMT
281900                      WMS-ADDL-PYMT-CODE
281950     ELSE
282000         ADD TR-LOAN-ADDL-CR TO ADDL-CR-DISB
282050         SUBTRACT TR-LOAN-ADDL-CR FROM WMS-ADDITIONAL-CREDIT.
282100     MOVE TR-LOAN-PRIN TO HOLD-AMT11.
282150     GO TO K1240-PRIN-DISB.
282200 K1350.
282250     MOVE WMS-INTRST-BAL TO WK-HOLD-AMT13.                        9915845
282300     IF  HOLD-OPT NOT GREATER THAN +1
282350         MOVE WMS-LOAN-ACCR-INT TO ACCR-AMT1
282400         ADD +.005 TO ACCR-AMT1
282450         ADD ACCR-AMT1 TO WK-HOLD-AMT13.                          9915845
282500     ADD WK-HOLD-AMT13 WMS-OTHER-CHGS WMS-PRIN-BAL                9915845
282520         GIVING PAYOFF-AMT.                                       0902477
282550     IF  HOLD-AMT LESS THAN PAYOFF-AMT                            IM002
282590         SUBTRACT HOLD-AMT FROM PAYOFF-AMT GIVING AMT-SHORT       IM002
282630     ELSE                                                         IM002
282670         MOVE ZERO TO AMT-SHORT                                   IM002
282680         MOVE 'N'  TO TOLERANCE-SW                                IM002
282710         GO TO K1350-EXIT.                                        IM002
282750     IF  WBC-PAYOFF-TOL-FLAG EQUAL TO '0'                         0266741
282790         GO TO K1350-EXIT.                                        IM002
282950     IF  WBC-PAYOFF-TOL-FLAG EQUAL TO '1' OR '3'                  0266741
283000         IF  WBC-PAYOFF-TOL-AMT NOT LESS THAN AMT-SHORT           0266741
283050             MOVE 'N' TO TOLERANCE-SW
283100             GO TO K1350-EXIT.
283150     IF  WBC-PAYOFF-TOL-FLAG EQUAL TO '2' OR '3'                  0266741
283200         MULTIPLY WBC-PAYOFF-TOL-NO-DAYS BY WMS-LOAN-ACCR-AMT     0266741
283250             GIVING TOL-INT-AMT ROUNDED
283300         IF  TOL-INT-AMT NOT LESS THAN AMT-SHORT
283350             MOVE 'N' TO TOLERANCE-SW.
283400 K1350-EXIT.
283450     EXIT.
283500 K1360.
283550     IF  WMS-LOAN-ACCR-INT LESS THAN +.005, GO TO K1360-10.
283600     IF  HOLD-OPT GREATER THAN +1
283650         ADD +.005, WMS-LOAN-ACCR-INT GIVING WK-HOLD-AMT13        9915845
283700         ADD WK-HOLD-AMT13 TO LOAN-INT-ACC-WAV                    9915845
283701                              WS-GL-LOAN-INT-ACC-WAV              0902970
283750         MOVE '02' TO IMEX-REC-NO
283800         MOVE 'K0K2' TO IMEX-EX-CODE
283850         ADD +.005 WMS-LOAN-ACCR-INT GIVING EX02-BAL              9915255
283860         ADD +1 TO SEQ-CTR                                        IM004
283870         MOVE SEQ-CTR TO EX02-SEQ-NO                              IM004
283900         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM006
283950         SUBTRACT WK-HOLD-AMT13 FROM AMT-SHORT                    9915845
284000     ELSE
284050         PERFORM R3670 THRU R3674
284100         MOVE '0' TO R3670-ALREADY
284150         MOVE ZEROES TO INT-DISB                                  IM002
284160                        PRIN-OLD-DISB                             IM002
284170                        ADDL-CR-DISB.                             IM002
284175 K1360-10.                                                        IM002
284200     IF  AMT-SHORT EQUAL TO ZERO OR
284250         AMT-SHORT LESS THAN ZERO
284300         MOVE 'F' TO TOLERANCE-SW
284350         MOVE ZERO TO PRIN-OLD-DISB
284400                      ADDL-CR-DISB.
284500     MOVE ZERO TO WMS-LOAN-ACCR-INT.
284550 K1360-EXIT.
284600     EXIT.
284650 K1380.
284700     MOVE WMS-LOAN-ACCR-INT TO HOLD-ACCR-INT.
284750     IF  TR-80-TYPE EQUAL '11'
284800         PERFORM K1240-PRIN-DISB THRU K1240-PRIN-DISB-EXIT        9915845
284850         MOVE 'N' TO BACKDATE-SW.                                 IM005
284900     MOVE TR-AMOUNT TO HOLD-AMT.
284950     MOVE TR-OPTION9 (3) TO HOLD-OPT.
285000     PERFORM K1350 THRU K1350-EXIT.
285050     IF  TOLERANCE-SW EQUAL 'N'
285100         GO TO K1385.
285150     IF  WK-HOLD-AMT13 GREATER THAN TR-AMOUNT                     9915845
285200         MOVE '033' TO REJRESN                                    0717565
285250         MOVE HOLD-ACCR-INT TO WMS-LOAN-ACCR-INT
285300         GO TO K1550-UNPOST.
285350 K1385.
285400     PERFORM K1360 THRU K1360-EXIT.
285402     MOVE ZERO       TO WMS-LOAN-AGGR-DAYS                        2016432
285404                        WMS-CURR-AGGR1   WMS-PREV-AGGR1           2016432
285406                        WMS-CURR-AGGR2   WMS-PREV-AGGR2           2016432
285408                        WMS-CURR-AGGR3   WMS-PREV-AGGR3.          2016432
285420     MOVE 'N' TO PAYOFF-SW.                                       IM005
285450     PERFORM K1240-PRINCIPAL THRU K1240-EXIT.                     IM005
285460     PERFORM K1220-OTHER     THRU K1220-EXIT.                     IM005
285470     PERFORM K1210-INTEREST  THRU K1210-EXIT.                     IM005
285472     IF  HOLD-AMT11 GREATER THAN +0.00                            IM005
285474         MULTIPLY -1 BY HOLD-AMT11 GIVING WMS-PRIN-BAL            IM005
285476         ADD HOLD-AMT11 TO LOAN-PRIN-PAID, PRIN-DISB,             0902970
285477                           WS-GL-LOAN-PRIN-PAID.                  0902970
285478     MOVE 'F' TO PAYOFF-SW.                                       IM005
285480     GO TO K1450.                                                 IM005
285500 K1400.
285550     ADD +.005, WMS-LOAN-ACCR-INT GIVING WK-HOLD-AMT13.           9915845
285600     ADD WMS-PRIN-BAL, WMS-INTRST-BAL, WMS-OTHER-CHGS
285650         GIVING HOLD-AMT9.
285700     IF WK-HOLD-AMT13 + HOLD-AMT9 LESS THAN TR-AMOUNT             9915845
285750         MOVE '033' TO REJRESN                                    0717565
285800         GO TO K1550-UNPOST.
285850     ADD +1 TO LOAN-CHG-OFF-NO, WS-GL-LOAN-CHG-OFF-NO.            0902970
285900     ADD TR-AMOUNT TO LOAN-CHG-OFF-AMT, WS-GL-LOAN-CHG-OFF-AMT.   0902970
285950     MOVE '1' TO WMS-LOAN-BAD-ACCT.
285960     MOVE TR-AMOUNT TO WMS-LOAN-CHG-OFF-AMT.                      1004773
285970     IF WMS-LOAN-REG-CODE EQUAL '303'                             1004773
285980        ADD TR-AMOUNT TO WBC-REG-TFR-AMT (5).                     0266741
285990     IF WMS-LOAN-REG-CODE EQUAL '330'                             0417181
285995        ADD TR-AMOUNT TO WBC-REG-TFR-AMT (6).                     0266741
286000     GO TO K1380.
286050 K1410.
286100     IF TR-LOAN-OTHER GREATER THAN WMS-OTHER-CHGS
286150         MOVE '034' TO REJRESN                                    0717565
286200         GO TO K1550-UNPOST.
286250     SUBTRACT TR-LOAN-OTHER FROM WMS-OTHER-CHGS.
286300     SUBTRACT TR-LOAN-INS1 FROM WMS-INSUR1-THIS-CY WMS-INS1.
286350     SUBTRACT TR-LOAN-INS1 FROM WMS-BILLED-INS1 WMS-LOAN-YTD-INS1.
286400     SUBTRACT TR-LOAN-INS2 FROM WMS-INSUR2-THIS-CY WMS-INS2.
286450     SUBTRACT TR-LOAN-INS2 FROM WMS-BILLED-INS2 WMS-LOAN-YTD-INS2.
286500     SUBTRACT TR-LOAN-FEES FROM WMS-FEE-THIS-CY WMS-FEES.
286550     SUBTRACT TR-LOAN-FEES FROM WMS-BILLED-FEES WMS-LOAN-YTD-FEES.
286600     MOVE TR-LOAN-OTHER TO OTH-DISB.
286650     GO TO K1450.
286700 K1420.
286750*  --ADVANCE REVERSAL APPLIED TO PRINCIPAL ONLY
286760     IF  WMS-LOAN-REG-CODE EQUAL '303'                            9715796
286770         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (7)              0266741
286780     ELSE                                                         9715796
286781         IF  WMS-LOAN-REG-CODE EQUAL '330'                        0417181
286782             SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (8).         0266741
286800     GO TO K1240-PRIN-DISB.
286805 K1430.                                                           IM006
286810*  --LOAN ORIGINATION FEES CREDIT                                 IM006
286815     ADD TR-AMOUNT TO WMS-COSTS-ORIG-AMT,                         IM006
286820                      WMS-COSTS-UNEARNED.                         IM006
286825     IF  WMS-COSTS-ORIG-DATE EQUAL SPACES                         IM006
286830         MOVE WBC-CAPTURE-DATE TO WMS-COSTS-ORIG-DATE             0266741
286835         MOVE '1' TO LOAN-COSTS-FLAG.                             IM006
286840     ADD TR-AMOUNT TO LOAN-NEW-COSTS, WS-GL-LOAN-NEW-COSTS.       0902970
286841     IF  WMS-LOAN-REG-CODE EQUAL '303'                            9715796
286842         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (7)              0266741
286843     ELSE                                                         9715796
286844         IF  WMS-LOAN-REG-CODE EQUAL '330'                        0417181
286845             SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (8).         0266741
286846     GO TO Q3000.                                                 9715796
286850 K1450.
286900     IF TR-OPTION (3) EQUAL TO '1' OR '3'
286950         MOVE '1' TO WMS-WAIVE-PYMT.
286960     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0417110
287000         IF  TR-OPTION (4) EQUAL '1' OR '3' OR '5' OR '7'         1105504
287050             ADD +1 TO WMS-STMT-ITEMS                             1105504
287100             GO TO K1500-POST.                                    1105504
287110     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0417110
287150         IF  TR-OPTION (4) EQUAL '2' OR '6' OR '7'                1105504
287200         AND WMS-STMT-ITEMS GREATER THAN +0                       1105504
287250             SUBTRACT +1 FROM WMS-STMT-ITEMS.                     1105504
287300 K1500-POST.
287350     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
287400     IF TR-OPTION (4) EQUAL TO '4' OR '5' OR '6' OR '7'           1105504
287450         IF TR-80-TYPE NOT EQUAL '11'
287500             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY 0266741
287550         ELSE
287600             PERFORM K1590 THRU K1590-EXIT.                       9915845
287650     IF TR-OPTION (2) EQUAL TO '8'
287700         SUBTRACT +1 FROM WMS-LN-STMT-DB-NO
287750         SUBTRACT TR-AMOUNT FROM WMS-LN-STMT-DB-AMT
287800     ELSE
287810       IF TR-OPTION (2) NOT EQUAL TO '7'                          1020057
287850         ADD +1 TO WMS-LN-STMT-CR-NO
287900         ADD TR-AMOUNT TO WMS-LN-STMT-CR-AMT.
287950     IF TR-OPTION (2) LESS THAN '4' OR EQUAL '5'
288000         IF TR-80-TYPE NOT EQUAL '11'
288050             MOVE TR-AMOUNT TO WMS-LAST-PYMT-AMT
288100             MOVE WBC-CAPTURE-DATE TO WMS-LAST-PMT-DATE           0266741
288150         ELSE
288200             PERFORM K1594 THRU K1594-EXIT.                       9915845
288250     ADD +1 TO LOAN-CR-NO, WS-GL-LOAN-CR-NO.                      0902970
288300     ADD TR-AMOUNT TO LOAN-CR-AMT, WS-GL-LOAN-CR-AMT.             0902970
288350     ADD PRIN-DISB TO LOAN-CR-PRIN, WS-GL-LOAN-CR-PRIN.           0902970
288400     ADD INT-DISB  TO LOAN-CR-INT, WS-GL-LOAN-CR-INT.             0902970
288450     ADD OTH-DISB  TO LOAN-CR-OTH, WS-GL-LOAN-CR-OTH.             0902970
288500     IF TR-80-TYPE EQUAL '11'
288550         IF  LOAN-AGGR-DONE EQUAL 'F'
288600             PERFORM ADJ-SC-AGGR THRU ADJ-MTD-AGGR-EXIT           9915845
288650         ELSE
288700             MOVE 'F' TO LOAN-AGGR-DONE.
288750     IF TR-80-TYPE EQUAL TO '05' OR '07' OR '11'
288800         MOVE '1' TO TRAN-REWRITE-SW
288850         MOVE EX-LOAN-DISB TO TR-LOAN-FIELDS.
288900     IF  TR-OPTION (2) EQUAL '8'
288950         GO  TO  K1520.
289000     MOVE TR-AMOUNT TO AMT-PD.                                    9915845
289005 K1502.                                                           1002953
289010     MOVE +8 TO Z.                                                1002953
289015 K1502-01.                                                        1002953
289020     SUBTRACT +1 FROM Z.                                          1002953
289025     IF  Z EQUAL ZERO                                             1002953
289030         GO TO K1502-04.                                          1002953
289035     IF  WMS-BILL-DUE-AMT (Z) EQUAL ZERO                          1002953
289040         GO TO K1502-01.                                          1002953
289045     IF  AMT-PD LESS THAN WMS-BILL-DUE-AMT (Z)                    1002953
289050         SUBTRACT AMT-PD FROM WMS-BILL-DUE-AMT (Z)                1002953
289055                              WMS-PYMT-DUE-AMT                    1002953
289060         IF  WMS-BILL-DUE-STAT (Z) NOT EQUAL ZERO                 1002953
289065             SUBTRACT AMT-PD FROM WMS-PAST-DUE-AMT                1002953
289070             GO  TO  K1502-04                                     1002953
289075         ELSE                                                     1002953
289080             GO  TO  K1502-04.                                    1002953
289085     SUBTRACT WMS-BILL-DUE-AMT (Z) FROM AMT-PD.                   1002953
289090 K1502-02.                                                        1002953
289095     SUBTRACT WMS-BILL-DUE-AMT (Z)     FROM WMS-PYMT-DUE-AMT.     1002953
289100     IF  WMS-BILL-DUE-STAT (Z) NOT EQUAL ZERO                     1002953
289105         SUBTRACT WMS-BILL-DUE-AMT (Z) FROM WMS-PAST-DUE-AMT.     1002953
289110     MOVE ZERO                   TO  WMS-BILL-DUE-AMT  (Z).       9915640
289125 K1502-02-EXIT.                                                   1002953
289126          EXIT.                                                   1002953
289130 K1502-03.                                                        1002953
289135     GO  TO  K1502-01.                                            1002953
289140 K1502-04.                                                        1002953
289145     IF  WMS-PYMT-DUE-AMT LESS THAN ZERO                          1002953
289150         MOVE ZERO               TO  WMS-PYMT-DUE-AMT.            1002953
289155     IF  WMS-PAST-DUE-AMT LESS THAN ZERO                          1002953
289160         MOVE ZERO               TO  WMS-PAST-DUE-AMT.            1002953
289165     MOVE ZERO                   TO  AMT-PD.                      1002953
289170 K1502-EXIT.                                                      1002953
289171       EXIT.                                                      1002953
289350 K1504.
289360     IF  WMS-PAST-DUE EQUAL ZERO                                  2015442
289370         GO  TO  K1519.                                           2015442
289400     IF  WMS-PAST-DUE-AMT GREATER THAN ZERO                       1002953
289410         GO  TO  K1505.                                           1002953
289415     PERFORM R0349-A THRU R0349-A-EXIT.                           1002953
289600 K1505.
289650     MOVE TR-AMOUNT TO EX10-PMT-AMT.
289700     MOVE 'E' TO EX10-REASON.
289750 K1510.
289800     MOVE '10' TO IMEX-REC-NO.
289850     MOVE 'PD' TO IMEX-CODE-1.
289900     MOVE EX-LOAN-DISB TO EX10-DISTRIBUTION.
289950     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
290000 K1519.  EXIT.
290050 K1520.
290100     IF TR-80-TYPE NOT EQUAL '11'
290150         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-LOAN-ACTIVITY     0266741
290200     ELSE
290250         PERFORM K1592 THRU K1592-EXIT.                           9915845
290300     MOVE '1' TO LOAN-POST-TODAY.
290350     MOVE '1' TO WMS-LOAN-CALC-CODE.
290400     PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
290450     MOVE 'LT' TO IMEX-CODE-1.
290500     MOVE '13' TO IMEX-REC-NO.
290550     MOVE TR-TRAN80-A TO IMEX-REC-13A.
290560     MOVE TR-AMOUNT   TO EX13-AMT.                                IM006
290570     MOVE TR-USER-CODE TO EX13-USER-CODE.                         IM006
290580     MOVE TR-TRAN-TYPE           TO EX13-TYPE.                    9915845
290600     MOVE TR-TRAN80-B TO IMEX-REC-13B.
290650     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.
290700     IF  TR-TRAN-TYPE EQUAL '5'                                   9915845
290750         IF TR-80-TYPE EQUAL '05' OR '07' OR '11'
290800             MOVE EX-LOAN-DISB TO EX13-LOAN-DISB.
290850     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
290900     ADD +1 TO SEQ-CTR.
290950     PERFORM K0320 THRU K0339.
291300     IF  TOLERANCE-SW EQUAL TO 'N'
291350         MOVE 'F' TO TOLERANCE-SW
291400         GO TO K1580.
291450     GO TO Q3000.
291500 K1550-UNPOST.
291550     ADD +1 TO LOAN-UP-CR-NO, WS-GL-LOAN-UP-CR-NO.                0902970
291600     ADD TR-AMOUNT TO LOAN-UP-CR-AMT, WS-GL-LOAN-UP-CR-AMT.       0902970
291650 K1570.
291700     MOVE 'A5' TO EXCODE-1.
291750     GO TO K0385.
291800*    ******  PAYOFF TOLERANCE GENERATED TRANSACTION    *****
291850*    ******  THIS SECTION IS USED WHEN THE PAYOFF   ******
291900*    ******  TRANSACTION IS SHORT OF THE PAYOFF     ******
291950*    ******  AMOUNT. IT WILL GENERATE A TRANSACTION ******
292000*    ******  TO BRING THE LOAN BALANCE TO ZERO IF   ******
292050*    ******  THE AMOUNT NEEDED IS WITHIN THE BANKS  ******
292100*    ******  TOLERANCE LIMITS.                      ******
292150 K1580.
292200******************************************************************
292290***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE GENERATED  IM002
292380***  PAYOFF TOLERANCE TRANSACTION PRIOR TO ITS BEING WRITTEN.     IM002
292470***                                                               IM002
292560***  COPY IM31UBWR.                                               IM002
292650***                                                               IM002
292740***  END OF USER EXIT.                                            IM002
292830******************************************************************IM002
293100     PERFORM R0345 THRU R0346.
293150     ADD +1 TO LN-GEN-CLS-ADJ-NO, WS-GL-LN-GEN-CLS-ADJ-NO         0902970
293200               WMS-LN-STMT-CR-NO.
293250     ADD AMT-SHORT TO LN-GEN-CLS-ADJ-AMT,                         IM006
293300               WMS-LN-STMT-CR-AMT, WS-GL-LN-GEN-CLS-ADJ-AMT.      0902970
293350     IF WMS-PRIN-BAL GREATER THAN +0
293450         MOVE WMS-PRIN-BAL TO PRIN-DISB.
293500     IF WMS-INTRST-BAL GREATER THAN +0
293600         MOVE WMS-INTRST-BAL TO INT-DISB.
293650     IF WMS-OTHER-CHGS GREATER THAN +0
293750         MOVE WMS-OTHER-CHGS TO OTH-DISB.
293800     MOVE ZERO TO WMS-PRIN-BAL,   WMS-INTRST-BAL,
293850                  WMS-INS1, WMS-INS2, WMS-FEES,
293900                  WMS-OTHER-CHGS.                                 1002953
293910     IF  WMS-PYMT-DUE-AMT GREATER THAN ZERO                       1002953
293920         MOVE WMS-PYMT-DUE-AMT   TO  AMT-PD                       1002953
293930         PERFORM K1502 THRU K1502-EXIT.                           1002953
293950     IF  AUTO-LOAN-PMT NOT EQUAL '1'
294000         PERFORM K1596 THRU K1596-EXIT.                           9915845
294050     PERFORM R0349-A THRU R0349-A-EXIT.                           1002953
294100     MOVE 'GT' TO IMEX-CODE-1
294150     MOVE 'G5' TO IMEX-CODE-2
294200     MOVE WBC-GENERATED-TRANS (19) TO GEN-TRAN-OPTION-HOLD.       0266741
294250     MOVE '19' TO EX01-INT-CODE.
294300     MOVE '5' TO EX01-TYPE.
294350     MOVE ZERO TO EX01-NUMBER.
294400     MOVE AMT-SHORT TO HOLD-AMT.
294450     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
294500     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
294550     MOVE '1' TO LOAN-POST-TODAY.
294600     ADD PRIN-DISB TO LOAN-PRIN-AMT-WV, WS-GL-LOAN-PRIN-AMT-WV.   0902970
294620     ADD INT-DISB  TO LOAN-INT-AMT-WV, WS-GL-LOAN-INT-AMT-WV.     0902970
294640     ADD OTH-DISB  TO LOAN-OTH-AMT-WV, WS-GL-LOAN-OTH-AMT-WV.     0902970
294750     MOVE ZERO TO PRIN-DISB
294800                  INT-DISB
294850                  OTH-DISB.
294900 K1580-EXIT.
294950     GO  TO  Q3000.
295000 K1581-BACKDATED-LOAN-TRANS.
295050     IF  ACCRUAL-BALANCE EQUAL +0
295100         GO TO K1585-BACKDATE-LOAN-EXIT.
295150     IF  WMS-INT-RATE-PTR NOT EQUAL ZERO
295200         GO  TO  K1582.
295250     IF  WMS-SPLIT-RATE-SCHD GREATER THAN ZERO
295300         MOVE WMS-DATE-LAST-LOAN-ACTIVITY TO DT-HIGH-DATE
295350         MOVE TR-LOAN-ORIG-DATE TO DT-LOW-DATE
295400         CALL 'SIDIF1' USING DATE-AREA
295450         IF  RET-DAYS GREATER THAN ZERO
295500             MOVE 'N' TO RHW-LOAN
295550             MOVE '4' TO EX13-REASON-OR-OPT
295600             PERFORM X0800-RHR-EXC-K THRU X0880-RHR-EXIT
295650             MOVE 'F' TO RHW-LOAN
295700             GO  TO  K1585-BACKDATE-LOAN-EXIT
295750         ELSE
295800             GO  TO  K1582.
295850     GO  TO  K1583-BKDT-LN-TRN-NON-HIST.
295900 K1582.
295950     IF (PRIME-CALC-FLAG EQUAL '2' OR '3')                        9915845
296000     OR (WMS-PRIME-CHNG-RTE NOT EQUAL '1')                        9915845
296050         MOVE 'N' TO RHW-LOAN
296100         MOVE '5' TO EX13-REASON-OR-OPT
296150         PERFORM X0800-RHR-EXC-K THRU X0880-RHR-EXIT
296200         MOVE 'F' TO RHW-LOAN
296250         GO  TO  K1585-BACKDATE-LOAN-EXIT.
296400     MOVE TR-LOAN-ORIG-DATE TO HOLD-BKDT-DATE.
296450     IF  RATE-TYPE EQUAL 'N'
296500         IF  WMS-INT-RATE-PTR GREATER THAN +5
296510             MOVE 'P' TO RHW-TYPE                                 1003625
296550             MOVE 001 TO RHW-IND                                  1003625
296560                         RHW-LOAN-IND                             IM008
296600         ELSE
296650         IF  WMS-INT-RATE-PTR NOT EQUAL ZERO
296700             MOVE WMS-INT-RATE-PTR TO RHW-LOAN-IND                IM008
296710                                      RHW-IND                     1003625
296720             MOVE 'L' TO RHW-TYPE                                 1003625
296800         ELSE
296850         IF  WMS-SPLIT-RATE-SCHD NOT EQUAL ZERO
296900             MOVE WMS-SPLIT-RATE-SCHD TO RHW-SPLIT-RATE-IND       IM008
296910                                         RHW-IND                  1003625
296920             MOVE 'S' TO RHW-TYPE                                 1003625
297000         ELSE
297050             GO  TO  K1583-BKDT-LN-TRN-NON-HIST.
297100     IF  RATE-TYPE EQUAL 'O'
297150         IF  WMS-PREV-INT-PTR GREATER THAN +5
297200             MOVE 001 TO RHW-IND                                  1003625
297210                         RHW-LOAN-IND                             IM008
297220             MOVE 'P' TO RHW-TYPE                                 1003625
297250         ELSE
297300         IF  WMS-PREV-INT-PTR NOT EQUAL ZERO
297350             MOVE WMS-PREV-INT-PTR TO RHW-LOAN-IND                IM008
297370                                      RHW-IND                     1003625
297380             MOVE 'L' TO RHW-TYPE                                 1003625
297450         ELSE
297500         IF  WMS-PREV-SPLIT-RATE-PTR NOT EQUAL ZERO
297550             MOVE WMS-PREV-SPLIT-RATE-PTR TO RHW-SPLIT-RATE-IND   IM008
297570                                             RHW-IND              1003625
297575             MOVE 'S' TO RHW-TYPE                                 1003625
297650         ELSE
297700             GO  TO  K1583-BKDT-LN-TRN-NON-HIST.
297750     MOVE '2' TO INTEREST-ADJUST-CODE.
297800     MOVE 'N' TO RHW-LOAN, LOAN-AGGR-DONE.
297850     MOVE TR-LOAN-ORIG-DATE TO HOLD-BKDT-DATE.
297900     PERFORM X0200-RATE-HIST-RETRIEVAL THRU X0880-RHR-EXIT.
297920     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            9915845
297950     MOVE 'F' TO RHW-LOAN.
298000     GO  TO  K1585-BACKDATE-LOAN-EXIT.
298050 K1583-BKDT-LN-TRN-NON-HIST.
298100     MOVE WMS-DATE-LAST-RATE-CHANGE TO DT-HIGH-DATE.
298150     MOVE TR-LOAN-ORIG-DATE TO DT-LOW-DATE.
298200     CALL 'SIDIF1' USING DATE-AREA.
298250     IF  RET-DAYS GREATER THAN ZERO
298300         MOVE 'N' TO RHW-LOAN
298350         MOVE '6' TO EX13-REASON-OR-OPT
298400         PERFORM X0800-RHR-EXC-K THRU X0880-RHR-EXIT
298450         MOVE 'F' TO RHW-LOAN
298500         GO  TO  K1585-BACKDATE-LOAN-EXIT.
298550     IF (RATE-TYPE EQUAL 'N'                                      IM008
298600     AND WMS-SPLIT-RATE-IND EQUAL '1')                            IM008
298650     OR (RATE-TYPE EQUAL 'O'                                      IM008
298700     AND WMS-SPLIT-RATE-IND EQUAL '2')                            IM008
298850         MOVE 'N' TO RHW-LOAN, LOAN-AGGR-DONE, RHW-NON-HIST
298900         MOVE '2' TO INTEREST-ADJUST-CODE
298950         MOVE 'E' TO RHW-SW
299000         MOVE TR-LOAN-ORIG-DATE TO HOLD-BKDT-DATE
299050         PERFORM X0200-RATE-HIST-RETRIEVAL THRU X0880-RHR-EXIT
299100         MOVE 'F' TO RHW-LOAN, RHW-NON-HIST
299150         GO  TO  K1585-BACKDATE-LOAN-EXIT.
299200     IF  RATE-TYPE EQUAL 'N'
299250         MOVE WMS-DAILY-RATE TO HOLD-RATE.                        IM008
299450     IF  RATE-TYPE EQUAL 'O'
299500         MOVE WMS-PREV-DAILY TO HOLD-RATE.                        IM008
299700     MOVE TR-LN-BK-DAYS TO ACCRUAL-DAYS.
299750     MULTIPLY ACCRUAL-BALANCE BY HOLD-RATE GIVING ACCR-AMT1.
299800     MULTIPLY ACCR-AMT1 BY ACCRUAL-DAYS GIVING HOLD-AMT.
299850     IF  TR-TRAN-TYPE EQUAL '5'                                   9915845
299900         MULTIPLY -1 BY HOLD-AMT.
299950 K1584-BACK-ACC.
300000     ADD +.005  WMS-LOAN-ACCR-INT GIVING WK-HOLD-AMT13.           9915845
300050     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915845
300100         MOVE WK-HOLD-AMT13 TO HOLD-AMT                           9915845
300150         MULTIPLY -1 BY HOLD-AMT.
300200     ADD HOLD-AMT TO WMS-LOAN-ACCR-INT LOAN-INT-ACC-ADJ-INT       0902970
300201                                       WS-GL-LOAN-INT-ACC-ADJ-INT.0902970
300202     MOVE '02' TO IMEX-REC-NO.                                    0325952
300204     MOVE 'K0K6' TO IMEX-EX-CODE.                                 0325952
300206     MOVE HOLD-AMT       TO EX02-BAL.                             0325952
300208     ADD +1 TO SEQ-CTR.                                           0325952
300210     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 0325952
300212     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0417193
300520     MOVE 'N'         TO RHW-LOAN.                                0735951
300530     MOVE HOLD-AMT    TO ACCRUAL-AMOUNT.                          0735951
300540     PERFORM X0850  THRU X0880-RHR-EXIT.                          0735951
300545     MOVE 'F'         TO RHW-LOAN.                                0735951
300550 K1585-BACKDATE-LOAN-EXIT.
300600     EXIT.
300650 K1586-BACKDATE-OLD-FIRST.
300700     IF WMS-PREV-BAL NOT GREATER THAN +0
300750         MOVE 'N' TO RATE-TYPE
300800         IF HOLD-AMT11 GREATER THAN WMS-PRIN-BAL
300850             MOVE WMS-PRIN-BAL TO ACCRUAL-BALANCE
300900             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
300950                     K1585-BACKDATE-LOAN-EXIT
301000             GO  TO  K1587-BACK-OLD-EXIT
301050         ELSE
301100             MOVE HOLD-AMT11 TO ACCRUAL-BALANCE
301150             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
301200                     K1585-BACKDATE-LOAN-EXIT
301250             GO  TO  K1587-BACK-OLD-EXIT.
301300     SUBTRACT HOLD-AMT11 FROM WMS-PREV-BAL GIVING HOLD-AMT13.
301350     IF HOLD-AMT13 NOT LESS THAN ZERO
301400         MOVE HOLD-AMT11 TO ACCRUAL-BALANCE
301450     ELSE
301500         MOVE WMS-PREV-BAL TO ACCRUAL-BALANCE.
301550     MOVE 'O' TO RATE-TYPE.
301600     PERFORM K1581-BACKDATED-LOAN-TRANS THRU
301650             K1585-BACKDATE-LOAN-EXIT
301700     IF HOLD-AMT13 LESS THAN ZERO
301750         MOVE 'N' TO RATE-TYPE
301800         MULTIPLY -1 BY HOLD-AMT13
301850         SUBTRACT WMS-PREV-BAL FROM WMS-PRIN-BAL GIVING HOLD-AMT9
301900         IF HOLD-AMT13 GREATER THAN HOLD-AMT9
301950             MOVE HOLD-AMT9 TO ACCRUAL-BALANCE
302000             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
302050                     K1585-BACKDATE-LOAN-EXIT
302100         ELSE
302150             MOVE HOLD-AMT13 TO ACCRUAL-BALANCE
302200             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
302250                     K1585-BACKDATE-LOAN-EXIT.
302300 K1587-BACK-OLD-EXIT.
302350     EXIT.
302400 K1588-BACKDATE-NEW-FIRST.
302450     IF WMS-PRIN-BAL NOT GREATER THAN WMS-PREV-BAL
302500         SUBTRACT HOLD-AMT11 FROM WMS-PREV-BAL GIVING HOLD-AMT9
302550         MOVE 'O' TO RATE-TYPE
302600         IF HOLD-AMT9 LESS THAN +0
302650             MOVE WMS-PREV-BAL TO ACCRUAL-BALANCE
302700             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
302750                     K1585-BACKDATE-LOAN-EXIT
302800             GO  TO  K1589-BACK-NEW-EXIT
302850         ELSE
302900             MOVE HOLD-AMT11 TO ACCRUAL-BALANCE
302950             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
303000                     K1585-BACKDATE-LOAN-EXIT
303050             GO  TO  K1589-BACK-NEW-EXIT.
303100     SUBTRACT WMS-PREV-BAL FROM WMS-PRIN-BAL GIVING HOLD-AMT13.
303150     IF HOLD-AMT11 NOT GREATER THAN HOLD-AMT13
303200         MOVE HOLD-AMT11 TO ACCRUAL-BALANCE
303250         MOVE 'N' TO RATE-TYPE
303300         PERFORM K1581-BACKDATED-LOAN-TRANS THRU
303350                 K1585-BACKDATE-LOAN-EXIT
303400         GO  TO  K1589-BACK-NEW-EXIT.
303450     SUBTRACT HOLD-AMT13 FROM HOLD-AMT11 GIVING HOLD-AMT9.
303500     MOVE HOLD-AMT13 TO ACCRUAL-BALANCE.
303550     MOVE 'N' TO RATE-TYPE.
303600     PERFORM K1581-BACKDATED-LOAN-TRANS THRU
303650             K1585-BACKDATE-LOAN-EXIT.
303700     IF HOLD-AMT9 NOT GREATER THAN WMS-PREV-BAL
303750         MOVE HOLD-AMT9 TO ACCRUAL-BALANCE
303800     ELSE
303850         MOVE WMS-PREV-BAL TO ACCRUAL-BALANCE.
303900     MOVE 'O' TO RATE-TYPE.
303950     PERFORM K1581-BACKDATED-LOAN-TRANS THRU
304000             K1585-BACKDATE-LOAN-EXIT.
304050 K1589-BACK-NEW-EXIT.
304100     EXIT.
304150 K1590.
304200     MOVE TR-LOAN-ORIG-DATE TO DT-HIGH-DATE.
304250     MOVE WMS-DATE-LAST-CUST-ACTIVITY TO DT-LOW-DATE.
304300     CALL 'SIDIF1' USING DATE-AREA.
304350     IF RET-DAYS GREATER THAN ZERO OR
304400         WMS-DATE-LAST-CUST-ACTIVITY EQUAL SPACES
304450         MOVE TR-LOAN-ORIG-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.
304455 K1590-EXIT.                                                      9915845
304460       EXIT.                                                      9915845
304500 K1592.
304550     MOVE TR-LOAN-ORIG-DATE TO DT-HIGH-DATE.
304600     MOVE WMS-DATE-LAST-LOAN-ACTIVITY TO DT-LOW-DATE.
304650     CALL 'SIDIF1' USING DATE-AREA.
304700     IF RET-DAYS GREATER THAN ZERO OR
304750         WMS-DATE-LAST-LOAN-ACTIVITY EQUAL SPACES
304800         MOVE TR-LOAN-ORIG-DATE TO WMS-DATE-LAST-LOAN-ACTIVITY.
304840 K1592-EXIT.                                                      9915845
304845       EXIT.                                                      9915845
304850 K1594.
304900     MOVE TR-LOAN-ORIG-DATE TO DT-HIGH-DATE.
304950     MOVE WMS-LAST-PMT-DATE TO DT-LOW-DATE.
305000     CALL 'SIDIF1' USING DATE-AREA.
305050     IF RET-DAYS GREATER THAN ZERO OR
305100         WMS-LAST-PMT-DATE EQUAL SPACES
305150         MOVE TR-AMOUNT TO WMS-LAST-PYMT-AMT
305200         MOVE TR-LOAN-ORIG-DATE TO WMS-LAST-PMT-DATE.
305240 K1594-EXIT.                                                      9915845
305245       EXIT.                                                      9915845
305250 K1596.
305300     IF TR-80-TYPE NOT EQUAL '11'
305350         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-BAL-CHANGE        0266741
305400     ELSE
305450         MOVE TR-LOAN-ORIG-DATE TO DT-HIGH-DATE
305500         MOVE WMS-DATE-LAST-BAL-CHANGE TO DT-LOW-DATE
305550         CALL 'SIDIF1' USING DATE-AREA
305600         IF RET-DAYS GREATER THAN ZERO OR
305650             WMS-DATE-LAST-BAL-CHANGE EQUAL SPACES
305700             MOVE TR-LOAN-ORIG-DATE TO WMS-DATE-LAST-BAL-CHANGE.
305740 K1596-EXIT.                                                      9915845
305745       EXIT.                                                      9915845
305750     SKIP3
305800*    ***************  LOAN DEBIT PROCESSING  ***************
305850     SKIP1
305900 K1600.
305950     IF WMS-LOAN-STATUS EQUAL '2'
306000         IF TR-OPTION (5) EQUAL TO '1'
306050             GO TO K1640.
306100     IF WMS-LOAN-STATUS EQUAL '2' OR '6'                          0265999
306150         MOVE '010' TO REJRESN                                    0717565
306200         GO TO K1950-UNPOST.
306250     IF WMS-LOAN-STATUS GREATER THAN '1' AND NOT EQUAL '5'
306300         MOVE '014' TO REJRESN                                    0717565
306350         GO TO K1950-UNPOST.
306400 K1640.
306450     IF TR-OPTION (4) EQUAL TO '0' OR '2'
306470     OR TR-OPTION (2) EQUAL TO '6'                                IM006
306500         GO TO K1700.
306550     IF TR-AMOUNT NOT GREATER THAN WMS-AVAIL-BAL
306600         GO TO K1700.
306650     IF TR-OPTION (4) EQUAL TO '4' OR '6'
306700         MOVE '003' TO REJRESN                                    0717565
306750         GO TO K1950-UNPOST.
306800     IF OVER-LINE EQUAL TO '1'
306850         MOVE '003' TO REJRESN                                    0717565
306900         GO TO K1950-UNPOST.
306950     IF WMS-LOAN-BAD-ACCT GREATER THAN '0'
307000         MOVE '032' TO REJRESN                                    0717565
307050         GO TO K1950-UNPOST.
307100     IF TR-AMOUNT GREATER THAN WMS-AVAIL-BAL + HOLD-INCRM
307150         MOVE '032' TO REJRESN                                    0717565
307200         GO TO K1950-UNPOST.
307250     MOVE '1' TO OVRLIM-FLAG
307300     ADD WMS-AVAIL-BAL, HOLD-INCRM
307350         GIVING TR-AMOUNT.
307360     MOVE TR-AMOUNT TO TR-LOAN-PRIN.                              IM003
307370     SUBTRACT TR-LOAN-INT FROM TR-LOAN-PRIN.                      IM003
307380     SUBTRACT TR-LOAN-OTHER FROM TR-LOAN-PRIN.                    IM003
307400 K1700.
307450     IF TR-OPTION (2) EQUAL TO '1'
307500         PERFORM K1596 THRU K1596-EXIT                            9915845
307502         PERFORM K1730 THRU K1730-EXIT                            2016432
307550         ADD TR-AMOUNT TO WMS-PRIN-BAL
307600         IF TR-80-TYPE EQUAL '11'
307650             MOVE 'N' TO RATE-TYPE
307700             MOVE TR-AMOUNT TO ACCRUAL-BALANCE
307702             MOVE WMS-LOAN-ACCR-INT TO HOLD-LOAN-INT              0827796
307750             PERFORM K1581-BACKDATED-LOAN-TRANS THRU
307800                     K1585-BACKDATE-LOAN-EXIT
307802             PERFORM K1725 THRU K1725-EXIT                        0827796
307850             GO TO K1800
307900         ELSE
307950             GO TO K1800.
308000     IF TR-OPTION (2) NOT EQUAL TO '2', GO TO K1740.
308050 K1710.
308055     IF  TR-LOAN-OLD-PRIN NOT NUMERIC                             9916471
308060         MOVE '041' TO REJRESN                                    0717565
308065         GO TO K1950-UNPOST.                                      9916471
308100     ADD TR-LOAN-PRIN TO WMS-PRIN-BAL.
308150     PERFORM K1596 THRU K1596-EXIT.                               9915845
308200     ADD TR-LOAN-INT TO WMS-INTRST-BAL.
308250     ADD TR-LOAN-OTHER TO WMS-OTHER-CHGS.
308300     ADD TR-LOAN-OLD-PRIN TO WMS-PREV-BAL.
308350     ADD TR-LOAN-ADDL-CR TO WMS-ADDITIONAL-CREDIT.
308400     IF TR-80-TYPE EQUAL '11'
308450         MOVE 'N' TO RATE-TYPE
308500         SUBTRACT TR-LOAN-OLD-PRIN FROM TR-LOAN-PRIN
308550             GIVING ACCRUAL-BALANCE
308600         PERFORM K1581-BACKDATED-LOAN-TRANS THRU
308650                 K1585-BACKDATE-LOAN-EXIT
308700         MOVE 'O' TO RATE-TYPE
308750         MOVE TR-LOAN-OLD-PRIN TO ACCRUAL-BALANCE
308800         PERFORM K1581-BACKDATED-LOAN-TRANS THRU
308850                 K1585-BACKDATE-LOAN-EXIT.
308870     GO TO K1800.                                                 0827796
308871 K1725.                                                           0827796
308872     IF  K1725-ALREADY EQUAL '1'                                  0827796
308874         GO TO K1725-EXIT.                                        0827796
308876     IF  WMS-LOAN-ACCR-INT EQUAL HOLD-LOAN-INT                    0827796
308878         GO TO K1725-EXIT.                                        0827796
308880     IF  WMS-LN-BILL-CY-DAYS NOT EQUAL ZERO                       0827796
308882         GO TO K1725-EXIT.                                        0827796
308884     MOVE WMS-DATE-LAST-BILLING TO DT-HIGH-DATE.                  0827796
308886     MOVE TR-LN-BK-DAYS TO RET-DAYS.                              0827796
308888     CALL 'SIDLO' USING DATE-AREA.                                0827796
308890     MOVE DT-LOW-DATE TO WMS-DATE-LAST-BILLING.                   0827796
308892     IF  WMS-LOAN-STATUS EQUAL '0'                                0827796
308894         MOVE TR-LOAN-ORIG-DATE TO WMS-DATE-LAST-RATE-CHANGE.     0827796
308896     MOVE '1' TO K1725-ALREADY.                                   0827796
308898 K1725-EXIT.                                                      0827796
308899     EXIT.                                                        0827796
308900                                                                  0827796
308902 K1730.                                                           2016432
308904     IF  K1725-ALREADY EQUAL '1'                                  0827796
308906         GO TO K1730-EXIT.                                        0827796
308908     IF  WMS-PAYOFF-AMT     EQUAL ZERO                            0827796
308910     AND WMS-FINCHG-THIS-CY EQUAL ZERO                            2016432
308912         NEXT SENTENCE                                            2016432
308914     ELSE                                                         2016432
308916         GO TO K1730-EXIT.                                        2016432
308918     MOVE WBC-LAST-PROC-THRU-DATE TO WMS-DATE-LAST-BILLING.       0266741
308920     MOVE ZERO                   TO WMS-LN-BILL-CY-DAYS.          2016432
308922 K1730-EXIT.                                                      2016432
308924     EXIT.                                                        2016432
308950 K1740.
309000     IF TR-OPTION (2) NOT EQUAL TO '3', GO TO K1760.
309050     ADD TR-AMOUNT TO WMS-PRIN-BAL.
309100     IF TR-80-TYPE EQUAL '11'
309150         MOVE 'N' TO RATE-TYPE
309200         MOVE TR-AMOUNT TO ACCRUAL-BALANCE
309250         PERFORM K1581-BACKDATED-LOAN-TRANS THRU
309300                 K1585-BACKDATE-LOAN-EXIT.
309350     PERFORM K1596 THRU K1596-EXIT.                               9915845
309400     ADD TR-AMOUNT TO WMS-ADDITIONAL-CREDIT.
309450     IF WBC-EXC-CODE (5) EQUAL TO '1'                             0266741
309500         MOVE '05' TO IMEX-CODE-1
309550         PERFORM K0330 THRU K0339.
309600     GO TO K1800.
309650 K1760.
309700     IF TR-OPTION (2) NOT EQUAL TO '5', GO TO K1770.              IM006
309750     ADD TR-LOAN-INS1 TO WMS-INSUR1-THIS-CY, WMS-BILLED-INS1
309800                         WMS-LOAN-YTD-INS1,  WMS-INS1.
309850     ADD TR-LOAN-INS2 TO WMS-INSUR2-THIS-CY, WMS-BILLED-INS2
309900                         WMS-LOAN-YTD-INS2,  WMS-INS2.
309950     ADD TR-LOAN-FEES TO WMS-FEE-THIS-CY,    WMS-BILLED-FEES
310000                         WMS-LOAN-YTD-FEES,  WMS-FEES.
310050     ADD TR-LOAN-OTHER TO WMS-OTHER-CHGS.
310100     GO TO K1800.
310106 K1770.                                                           IM006
310112     IF  TR-OPTION (2) NOT EQUAL TO '6', GO TO K1780.             IM006
310118     SUBTRACT TR-AMOUNT FROM WMS-COSTS-ORIG-AMT,                  IM006
310120                             WMS-COSTS-UNEARNED.                  IM006
310124     IF  WMS-COSTS-ORIG-DATE EQUAL SPACES                         IM006
310127         MOVE WBC-CAPTURE-DATE TO WMS-COSTS-ORIG-DATE             0266741
310130         MOVE '1' TO LOAN-COSTS-FLAG.                             IM006
310136     SUBTRACT TR-AMOUNT FROM LOAN-NEW-COSTS, WS-GL-LOAN-NEW-COSTS.0902970
310137     IF  WMS-LOAN-REG-CODE EQUAL '303'                            9715796
310138         ADD TR-AMOUNT TO WBC-REG-TFR-AMT (7)                     0266741
310139     ELSE                                                         9715796
310140         IF  WMS-LOAN-REG-CODE EQUAL '330'                        0417181
310141             ADD TR-AMOUNT TO WBC-REG-TFR-AMT (8).                0266741
310142     GO TO Q3000.                                                 IM006
310150 K1780.
310200*  --AT THIS POINT, TRANSACTION MUST BE A NON-PRINTING REVERSAL
310250     IF  TR-LN-ORIG-YR NOT EQUAL WBC-CAPTURE-YR                   0266741
310260         GO TO K1710.                                             IM004
310270     IF  (TR-LOAN-INT GREATER THAN WMS-LOAN-YTD-INT)              IM004
310280     OR  (TR-LOAN-INT GREATER THAN WMS-COLLECT-INT AND            IM004
310290          TR-LN-ORIG-MO EQUAL WBC-CAPTURE-MO)                     0266741
310300          MOVE '041' TO REJRESN                                   0717565
310310          GO TO K1950-UNPOST.                                     IM004
310320     SUBTRACT TR-LOAN-INT FROM WMS-LOAN-YTD-INT,                  IM004
310330                               LOAN-INT-YTD-ADJ,                  0902970
310331                               WS-GL-LOAN-INT-YTD-ADJ.            0902970
310340     IF  TR-LN-ORIG-MO EQUAL WBC-CAPTURE-MO                       0266741
310350         SUBTRACT TR-LOAN-INT FROM WMS-COLLECT-INT.               IM004
310600     GO TO K1710.
310650 K1800.
310652     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0827747
310700         IF  TR-OPTION (3) EQUAL '1' OR '5'                       0827747
310750             ADD +1 TO WMS-STMT-ITEMS                             0827747
310800             GO TO K1900-POST.                                    0827747
310802     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0827747
310850         IF  TR-OPTION (3) EQUAL '2' OR '6'                       0827747
310900         AND WMS-STMT-ITEMS GREATER THAN +0
310950             SUBTRACT +1 FROM WMS-STMT-ITEMS.                     0827747
311000 K1900-POST.
311050     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
311100     IF TR-OPTION (2) EQUAL TO '4'
311150         SUBTRACT +1 FROM WMS-LN-STMT-CR-NO
311200         SUBTRACT TR-AMOUNT FROM WMS-LN-STMT-CR-AMT
311240     ELSE                                                         1004773
311242     IF TR-OPTION (2) NOT EQUAL TO '5'                            1020057
311250         ADD +1 TO WMS-LN-STMT-DB-NO                              1004773
311280         ADD TR-AMOUNT TO WMS-LN-STMT-DB-AMT.                     1004773
311300     IF TR-OPTION (2) LESS THAN '4'                               1004773
311310        IF WMS-LOAN-REG-CODE EQUAL '303'                          1004773
311320            ADD TR-AMOUNT TO WBC-REG-TFR-AMT (7)                  0266741
311330        ELSE                                                      1004773
311340            IF WMS-LOAN-REG-CODE EQUAL '330'                      0417181
311400                ADD TR-AMOUNT TO WBC-REG-TFR-AMT (8).             0266741
311410     IF TR-OPTION (2) LESS THAN '4'                               1004773
311450         IF TR-80-TYPE NOT EQUAL '11'
311500             MOVE TR-AMOUNT TO WMS-AMT-LAST-ADVANCE
311550             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-ADVANCE       0266741
311600         ELSE
311650             PERFORM K1952 THRU K1952-EXIT.                       9915845
311700     IF TR-80-TYPE EQUAL '11'
311750         IF  LOAN-AGGR-DONE EQUAL 'F'
311800             PERFORM ADJ-SC-AGGR THRU ADJ-MTD-AGGR-EXIT           9915845
311850         ELSE
311900             MOVE 'F' TO LOAN-AGGR-DONE.
311950     ADD +1 TO LOAN-DB-NO, WS-GL-LOAN-DB-NO.                      0902970
312000     ADD TR-AMOUNT TO LOAN-DB-AMT, WS-GL-LOAN-DB-AMT.             0902970
312050     ADD TR-LOAN-PRIN  TO LOAN-DR-PRIN, WS-GL-LOAN-DR-PRIN.       0902970
312100     ADD TR-LOAN-INT   TO LOAN-DR-INT, WS-GL-LOAN-DR-INT.         0902970
312150     ADD TR-LOAN-OTHER TO LOAN-DR-OTH, WS-GL-LOAN-DR-OTH.         0902970
312200     MOVE WMS-PRIN-BAL TO WMS-PRIN-LAST-ADVANCE.
312250     MOVE WMS-INTRST-BAL TO WMS-INT-LAST-ADVANCE.
312300     MOVE WMS-OTHER-CHGS TO WMS-CHGS-LAST-ADVANCE.
312350     IF TR-OPTION (3) EQUAL TO '4' OR '5' OR '6'
312400         IF TR-80-TYPE NOT EQUAL '11'
312450             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY 0266741
312500         ELSE
312550             PERFORM K1590 THRU K1590-EXIT.                       9915845
312555     IF  TR-OPTION (2) NOT EQUAL TO '4'                           9915640
312600         GO TO K1520.                                             9915640
312605     COPY IMPD31RV.                                               9915640
312650 K1950-UNPOST.
312700     ADD +1  TO LOAN-UP-DB-NO, WS-GL-LOAN-UP-DB-NO.               0902970
312750     ADD TR-AMOUNT TO LOAN-UP-DB-AMT, WS-GL-LOAN-UP-DB-AMT.       0902970
312800     GO TO K1570.
312850 K1952.
312900     MOVE TR-LOAN-ORIG-DATE TO DT-HIGH-DATE.
312950     MOVE WMS-DATE-LAST-ADVANCE TO DT-LOW-DATE.
313000     CALL 'SIDIF1' USING DATE-AREA.
313050     IF RET-DAYS GREATER THAN ZERO OR
313100         WMS-DATE-LAST-ADVANCE EQUAL SPACES
313150         MOVE TR-LOAN-ORIG-DATE TO WMS-DATE-LAST-ADVANCE
313200         MOVE TR-AMOUNT TO WMS-AMT-LAST-ADVANCE.
313240 K1952-EXIT.                                                      9915845
313245       EXIT.                                                      9915845
313250     SKIP3
313300 INTRST-SECTION-A    SECTION 21.
313350     SKIP3
313400*    ************* SAVINGS CREDIT PROCESSING *************
313450     SKIP1
313500 K1960.
313550     IF WMS-INT-STATUS GREATER THAN '6'                           IM003
313600         MOVE '028' TO REJRESN                                    0717565
313650         GO TO K1975-UNPOST.
313700     IF WMS-STATUS EQUAL TO '00'
313720     AND WMS-INT-STATUS EQUAL '1'                                 IM003
313750         GO TO K1962.
313800     IF WMS-STATUS EQUAL TO '04'
313850         IF TR-OPTION (5) LESS THAN '4'
313900             MOVE '019' TO REJRESN                                0717565
313950             GO TO K1975-UNPOST.
314000     IF WMS-STATUS EQUAL TO '08'
314050         MOVE '009' TO REJRESN                                    0717565
314100         GO TO K1975-UNPOST.
314108     IF WMS-INT-STATUS EQUAL TO '6'                               IM003
314116         IF WBC-POST-DORM    EQUAL TO '0'                         0266741
314124             MOVE '006' TO REJRESN                                0717565
314132             MOVE 'A2' TO EXCODE-2                                IM003
314140             GO TO K1975-UNPOST.                                  IM003
314150 K1962.
314200     IF NSF-CALC-FLAG EQUAL TO '0'
314250         PERFORM K0100 THRU K0105.
314260     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
314270         PERFORM K0106 THRU K0106-EXIT.                           IM003
314300     ADD +1 TO FS-CR.
314350     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
314400         PERFORM K7200 THRU K8500.
314450     ADD TR-AMOUNT TO WMS-CURR-BAL WMS-INT-CUR-BAL CUST-BAL.      IM003
314452     IF WMS-CURR-BAL NOT LESS THAN ZERO                           1020116
314454         MOVE +0   TO WMS-OD-REGE-SUST-CTR.                       1020116
314500     ADD TR-AMOUNT TO WMS-TODAYS-CREDITS.                         1004554
314505     ADD +1 TO WMS-TODAYS-CREDITS-NO.                             1004554
314510     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
314515         ADD TR-AMOUNT TO INV-CR-AMT                              1004554
314520                          WS-GL-INV-CR-AMT                        1004554
314525         ADD +1        TO INV-CR-NO                               1004554
314530                          WS-GL-INV-CR-NO                         1004554
314535     ELSE                                                         1004554
314540         ADD TR-AMOUNT TO SAV-CR-AMT                              1004554
314545                          WS-GL-SAV-CR-AMT                        1004554
314550         ADD +1        TO SAV-CR-NO                               1004554
314555                          WS-GL-SAV-CR-NO.                        1004554
314600     MOVE '1' TO SAVINGS-POST-TODAY.
314602     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
314620     MOVE ZERO TO ACCR-INT-TRAN-NO.                               0902213
314650     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
314700     IF TR-OPTION (3) EQUAL TO '0'
314750         GO TO K1964.
314800     IF TR-OPTION (3) GREATER THAN '3'
314820         MOVE -1 TO ACCR-INT-TRAN-NO                              0902213
314850         SUBTRACT +1 FROM WMS-INT-TRAN-NO WMS-INT-MTD-TRANNO
314900         SUBTRACT TR-AMOUNT FROM WMS-INT-TRAN-AMT
314950                                 WMS-INT-MTD-TRNAMT.
314968     IF  WMS-CHK-TRUNC-FLAG EQUAL 'N' OR 'I' OR 'R' OR 'U' OR 'E' 0417110
315000         IF  TR-OPTION (3) EQUAL TO '1' OR '3' OR '5' OR '7'      1105504
315050             ADD +1 TO WMS-STMT-ITEMS                             1105504
315100             GO TO K1964                                          1105504
315110         ELSE                                                     1105504
315150         IF  TR-OPTION (3) NOT EQUAL TO '4'                       1105504
315200         AND WMS-STMT-ITEMS NOT EQUAL TO +0                       1105504
315250             SUBTRACT +1 FROM WMS-STMT-ITEMS.                     1105504
315300 K1964.
315350     IF  TR-OPTION (4) NOT EQUAL TO '1' AND '3' AND '5' AND '7'   0265717
315400         GO TO K1964-CONT.                                        0265717
315450     ADD TR-AMOUNT TO WMS-YTD-INT-PAID.                           1004554
315452     PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT.                  0617360
315454     IF  CERT-NAME-W8-STATUS EQUAL '1'                            0617360
315455         ADD TR-AMOUNT TO WMS-YTD-INT-PAID-1042.                  0617360
315456     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            0617360
315460         ADD TR-AMOUNT TO INV-DIV-PAID-YTD-ADJ                    1004554
315465                          WS-GL-INV-DIV-PAID-YTD-ADJ              1004554
315470     ELSE                                                         1004554
315475         ADD TR-AMOUNT TO DDA-INT-YTD-ADJ                         1004554
315480                          WS-GL-DDA-INT-YTD-ADJ.                  1004554
315482     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
315484         ADD TR-AMOUNT TO WMS-DUAL-YR-CUR-SAV-INT                 9915858
315486                          DUAL-SV-INT-YTD-ADJ                     9915858
315488                          WS-GL-DUAL-SV-INT-YTD-ADJ.              9915858
315490 K1964-CONT.                                                      0265717
315500     IF  TR-OPTION (4) EQUAL '2' OR '3' OR '6' OR '7'             0265717
315550         ADD TR-AMOUNT TO WMS-INT-ACCUM-INT
315600                          WMS-MTD-INT-PAID.
315650 K1966.
315700     ADD +1 TO SEQ-CTR.
315750     IF TR-80-TYPE EQUAL TO '06'
315800         PERFORM TRAN-ADJUST THRU END-INT-ADJUST
315850         PERFORM ADJ-SC-AGGR THRU ADJ-YTD-AGGR
315900         SUBTRACT TR-ITEM-COUNT FROM WMS-INT-DR-NUMBER
315950         SUBTRACT TR-AMOUNT FROM WMS-INT-DR-AMT
316200     ELSE
316250         ADD +1 TO WMS-INT-CR-NUMBER
316300         ADD TR-AMOUNT TO WMS-INT-CR-AMT.
316350 K1968.
316400     IF  WMS-YR2-LD EQUAL SPACE
316450         MOVE TR-AMOUNT TO WMS-OPENING-DEPOSIT.
316460     IF  TR-OPTION (7) EQUAL '2' OR '3' OR '6' OR '7'             1004773
316470         IF WMS-INT-INV-IND EQUAL 'N'                             1004773
316480             ADD TR-AMOUNT TO WBC-REG-TFR-AMT (9).                0266741
316500     IF  TR-OPTION (6) EQUAL '1' OR '3'                           IM003
316550         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
316600         MOVE TR-AMOUNT TO WMS-AMT-LAST-DEPOSIT
316650         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-DEPOSIT.          0266741
316700     IF  TR-OPTION (6) EQUAL '1' OR '3'                           IM003
316750         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
316800             PERFORM K0510 THRU K0510-EXIT.                       9915845
316801     IF  TR-OPTION (6) EQUAL '2' OR '3'                           9915858
316802         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         9915858
316804             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-SAV-FED      9915858
316806             ADD TR-AMOUNT TO    DUAL-SV-TAX-ADJ-DN-AMT           9915858
316807                                 WS-GL-DUAL-SV-TAX-ADJ-DN-AMT.    9915858
316808     IF  TR-OPTION (6) EQUAL '2' OR '3'                           IM003
316816         SUBTRACT TR-AMOUNT FROM WMS-YTD-SAV-TAX                  IM003
316824                                 WMS-INT-TAX                      IM003
316832                                 WMS-INT-MTD-TAX                  IM003
316836         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
316837             ADD TR-AMOUNT TO    INV-TAX-ADJ-DN                   1004554
316838                                 WS-GL-INV-TAX-ADJ-DN             1004554
316839         ELSE                                                     1004554
316840             ADD TR-AMOUNT TO    SAV-TAX-ADJ-DN-AMT               1004554
316841                                 WS-GL-SAV-TAX-ADJ-DN-AMT.        0902970
316842     IF  (TR-OPTION (7) EQUAL '4' OR '5' OR '6' OR '7')           2012254
316843     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
316844         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
316845             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-SAV-STATE    2012254
316846             ADD TR-AMOUNT TO    DUAL-SV-TAX-ADJ-DN-AMT-ST        2012254
316847                                 WS-GL-DUAL-SV-TX-ADJ-DN-ST-A.    2012254
316848     IF  (TR-OPTION (7) EQUAL '4' OR '5' OR '6' OR '7')           2012254
316849     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
316850         SUBTRACT TR-AMOUNT FROM WMS-YTD-SAV-STATE-TAX            2012254
316851                                 WMS-INT-TAX-STATE                2012254
316852                                 WMS-INT-MTD-STATE-TAX            2012254
316853         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
316854             ADD TR-AMOUNT TO    INV-TAX-ADJ-DN-ST                2012254
316855                                 WS-GL-INV-TAX-ADJ-DN-ST          2012254
316856         ELSE                                                     2012254
316857             ADD TR-AMOUNT TO    SAV-TAX-ADJ-DN-AMT-ST            2012254
316858                                 WS-GL-SAV-TAX-ADJ-DN-ST-AMT.     2012254
316859     IF  (TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7')           2012254
316860     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
316861         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
316862             SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-SAV-LOCAL    2012254
316863             ADD TR-AMOUNT TO    DUAL-SV-TAX-ADJ-DN-AMT-LOC       2012254
316864                                 WS-GL-DUAL-SV-TX-ADJ-DN-LOC-A.   2012254
316865     IF  (TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7')           2012254
316866     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
316867         SUBTRACT TR-AMOUNT FROM WMS-YTD-SAV-LOCAL-TAX            2012254
316868                                 WMS-INT-TAX-LOCAL                2012254
316869                                 WMS-INT-MTD-LOCAL-TAX            2012254
316870         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
316871             ADD TR-AMOUNT TO    INV-TAX-ADJ-DN-LOC               2012254
316872                                 WS-GL-INV-TAX-ADJ-DN-LOC         2012254
316873         ELSE                                                     2012254
316874             ADD TR-AMOUNT TO    SAV-TAX-ADJ-DN-AMT-LOC           2012254
316875                                 WS-GL-SAV-TAX-ADJ-DN-LOC-AMT.    2012254
316876     IF  TR-OPTION (7) EQUAL '1' OR '3' OR '5' OR '7'             2012254
316877         SUBTRACT TR-AMOUNT FROM WMS-INT-TIS-CYC-FEES             2012254
316878         IF  WMS-INT-TIS-CYC-FEES LESS THAN ZERO                  2012254
316879             MOVE ZEROS TO WMS-INT-TIS-CYC-FEES.                  2012254
316880 K1970.                                                           2012254
316900     IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
316950         PERFORM ADJ-SC-AGGR THRU ADJ-YTD-AGGR
317000         PERFORM TRAN-ADJUST THRU END-INT-ADJUST.                 0617360
317020     MOVE ZERO TO ACCR-INT-TRAN-NO.                               0902213
317050     MOVE 'I0' TO IMEX-CODE-1.
317100     PERFORM K0330 THRU K0339.
317150     IF  SAVINGS-STATUS-IN EQUAL '6' OR WMS-INT-STATUS EQUAL '6'  IM003
317155         MOVE 'H0' TO IMEX-CODE-1                                 IM003
317160         MOVE 'HK' TO IMEX-CODE-2                                 9915845
317165         MOVE '071' TO WK-REJ-REASON                              0717565
317166         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
317170         MOVE '1' TO TRAN-REWRITE-SW                              IM003
317175         PERFORM K0330 THRU K0339                                 IM003
317180     ELSE                                                         IM003
317185         PERFORM K0320 THRU K0344.                                IM003
317200     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
317250     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
317300     IF TR-OPTION (5) EQUAL '2' OR '6'
317350         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
317400         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY     0266741
317410                                 WMS-INT-DATE-LAST-CUST-ACT       IM003
317450         IF  TR-OPTION (6) EQUAL '1'                              9915845
317460         AND TR-TRAN-TYPE EQUAL '7'                               9915845
317500             MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-DEPOSIT
317550             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-DEPOSIT. 0266741
317600     IF TR-OPTION (5) EQUAL '2' OR '6'
317650         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
317700         PERFORM K0118 THRU K0118-EXIT                            9915845
317750         IF  TR-OPTION (6) EQUAL '1'                              IM008
317800             PERFORM K0525 THRU K0525-EXIT.                       9915845
317950     IF  WMS-STATUS EQUAL '04'
317960         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
317965         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
317970         MOVE '51' TO EX09-GEN-REASON                             IMIB004
318000         MOVE '00' TO WMS-STATUS
318050         MOVE 'SU' TO IMEX-CODE-1
318100         MOVE 'SD' TO IMEX-CODE-2
318150         MOVE '09' TO IMEX-REC-NO
318200         MOVE '04' TO EX09-STATUS-IN
318250         MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
318300         MOVE WMS-CURR-BAL TO EX09-CUR-BAL                        0902079
318310         MOVE SPACES TO WMS-DATE-CLOSED                           0902079
318320         MOVE '00' TO WMS-REASON-CLOSED                           0902079
318350         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
318352     IF  WMS-INT-STATUS EQUAL '6'                                 IM006
318354         IF  WBC-POST-DORM    EQUAL TO '2' OR '4'                 0266741
318356             MOVE '1' TO WMS-INT-STATUS                           IM006
318362             MOVE 'SU' TO IMEX-CODE-1                             IM003
318365             MOVE 'SS' TO IMEX-CODE-2                             IM003
318368             MOVE '09' TO IMEX-REC-NO                             IM003
318371             MOVE '6' TO EX09-STATUS-IN                           IM003
318374             MOVE '1' TO EX09-STATUS-OUT, WK-SV-STATUS-IN         IM003
318377             MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL                 IM003
318380             MOVE '*' TO EX09-GEN-STAT                            IM003
318383             MOVE SAV-TRANS-REACT-NS-LIT(SIWS-LANG-SUB)           0266741
318386                  TO EX09-GEN-DESC                                IM003
318389             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             IM003
318400     GO TO K7000.
318450 K1975-UNPOST.
318500     ADD TR-AMOUNT TO SAV-UN-CR-AMT, WS-GL-SAV-UN-CR-AMT.         0902970
318550     ADD +1 TO SAV-UN-CR-NO, WS-GL-SAV-UN-CR-NO.                  0902970
318600     MOVE 'A6' TO EXCODE-1.
318650     GO TO K0385.
318700     SKIP3
318750*    ************* SAVINGS DEBIT PROCESSING **************
318800     SKIP1
318850 K1980.
318900     IF WMS-INT-STATUS EQUAL TO '3' OR GREATER THAN '6'           IM003
318950         MOVE '029' TO REJRESN                                    0717565
319000         GO TO K1989-UNPOST.                                      IM002
319050     IF WMS-STATUS EQUAL TO '00'
319070     AND WMS-INT-STATUS LESS THAN '3'                             IM003
319100         GO TO K1982.
319150     IF WMS-STATUS EQUAL TO '04'
319200         IF TR-OPTION (5) LESS THAN '4'
319250             MOVE '019' TO REJRESN                                0717565
319300             GO TO K1989-UNPOST.                                  IM002
319350     IF WMS-STATUS EQUAL TO '06' OR WMS-INT-STATUS EQUAL TO '6'   IM003
319400         IF WBC-POST-DORM    LESS THAN '3'                        0266741
319450             MOVE '006' TO REJRESN                                0717565
319500             MOVE 'A2' TO EXCODE-2
319550             GO TO K1989-UNPOST.                                  IM002
319600     IF WMS-STATUS EQUAL TO '07'
319650         IF WBC-POST-INACTIVE LESS THAN '3'                       0266741
319700             MOVE '007' TO REJRESN                                0717565
319750             MOVE 'A3' TO EXCODE-2
319800             GO TO K1989-UNPOST.                                  IM002
319850     IF WMS-STATUS EQUAL '08'
319900         MOVE '009' TO REJRESN                                    0717565
319950         GO TO K1989-UNPOST.                                      IM002
319960     IF  WMS-STATUS EQUAL TO '10'                                 9915749
319962         IF  WBC-POST-DORM    LESS THAN '3'                       0266741
319964             MOVE '006' TO REJRESN                                0717565
319966             MOVE 'A9' TO EXCODE-2                                9915749
319968             GO TO K1989-UNPOST.                                  9915749
320000 K1982.
320050     IF NSF-CALC-FLAG EQUAL '0'
320100         PERFORM K0100 THRU K0105.
320110     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
320120         PERFORM K0106 THRU K0106-EXIT.                           IM003
320150     IF TR-OPTION (5) EQUAL '1' OR '3' OR '5' OR '7'
320200         MOVE '1'                TO SAV-CLOSING-TRAN-FLAG         1003634
320210         MOVE '0'                TO WMS-SAV-DIST-CD               ~~~0183
320250     ELSE
320275         MOVE '0'                TO SAV-CLOSING-TRAN-FLAG         1003634
320300        GO TO K1984.
320350     MOVE WMS-INT-CUR-BAL TO HOLD-AMT11.                          IM002
320430     IF WBC-INTRST-PAY-PHASE(WMS-INTRST-CALC) NOT EQUAL SPACES    0266741
320460         IF  WMS-ACCR-INT NOT EQUAL +0.00                         IM002
320490             MOVE '7' TO WMS-INT-STATUS                           IM002
320520             MOVE 'N' TO IOD-CLOSE-FLAG                           IM002
320550             PERFORM R3835 THRU R3835-EXIT                        9915845
320580             MOVE 'F' TO IOD-CLOSE-FLAG                           IM002
320590             MOVE 'F' TO IOD-CLEAR                                IM002
320610             MOVE WK-SV-STATUS-IN TO WMS-INT-STATUS               IM002
320640             ADD TODAYS-INTRST-PYMT TO HOLD-AMT11.                IM002
320650     IF  WMS-BKUP-WTHLD-FLAG EQUAL ZERO                           IM002
320655     AND WMS-STATE-LOCAL-TX-CD EQUAL ZERO                         2012254
320660         GO TO K1983.                                             IM002
320670     MOVE IOD-FLAG           TO TAX-CALC-IOD-FLAG.                IM002
320680     MOVE TODAYS-INTRST-PYMT TO TAX-CALC-PAYMENT.                 IM002
320690     MOVE ZERO               TO TAX-CALC-AMOUNT                   2012254
320691                                TAX-CALC-AMOUNT-ST                2012254
320692                                TAX-CALC-AMOUNT-LOC.              2012254
320700     MOVE '0'                TO TAX-CALC-REASON.                  IM002
320710     PERFORM R3899-CALC-TAX-DAYS THRU R3899-EXIT.                 IM002
320720     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.                 IM002
320730     SUBTRACT TAX-CALC-AMOUNT              TAX-CALC-AMOUNT-ST     2012254
320732              TAX-CALC-AMOUNT-LOC     FROM HOLD-AMT11.            2012254
320735     SUBTRACT WMS-SAV-PEND-TAX FROM HOLD-AMT11.                   IM007
320740 K1983.                                                           IM002
320800     IF  SAVINGS-MINIMUM EQUAL '1'
320850         ADD WMS-MIN-AMT-FOR-SUPER TO HOLD-AMT11.
320900     IF  TR-AMOUNT NOT EQUAL HOLD-AMT11
320950         MOVE '033' TO REJRESN                                    0717565
321000         GO TO K1989-UNPOST.                                      IM002
321050     MOVE '7' TO WMS-INT-STATUS.                                  IM002
321140     MOVE 'N' TO IOD-CLOSE-FLAG.                                  IM002
321230     PERFORM R3835 THRU R3864.                                    IM002
321320     MOVE 'F' TO IOD-CLOSE-FLAG.                                  IM002
321700     MOVE '1' TO SYS-REQ-STMT.
322150     MOVE 'SU' TO IMEX-CODE-1.
322200     MOVE 'SS' TO IMEX-CODE-2.
322250     MOVE '09' TO IMEX-REC-NO.
322300     MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN.
322350     MOVE WMS-INT-STATUS  TO EX09-STATUS-OUT
322400                             WK-SV-STATUS-IN.
322450     MOVE +0 TO EX09-CUR-BAL.
322500     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
322550     IF  SAVINGS-MINIMUM EQUAL '1'
322600         ADD WMS-MIN-AMT-FOR-SUPER TO WMS-INT-CUR-BAL
322650                                  WMS-CURR-BAL
322700                                  CUR-BAL
322750         MOVE '0' TO SAVINGS-MINIMUM, NSF-CALC-FLAG.
322800     GO  TO  K1985-POST.
322850 K1984.
322900     IF WMS-INT-CUR-BAL NOT LESS THAN TR-AMOUNT
322950     AND WMS-INT-CUR-BAL + CUR-BAL NOT LESS THAN TR-AMOUNT
323000         GO  TO  K1985-POST.
323050     IF  SAVINGS-MINIMUM EQUAL '1'
323100         IF (WMS-INT-CUR-BAL + WMS-MIN-AMT-FOR-SUPER)
323150             NOT LESS THAN TR-AMOUNT
323200         AND
323250            (WMS-INT-CUR-BAL + WMS-MIN-AMT-FOR-SUPER + CUR-BAL)
323300             NOT LESS THAN TR-AMOUNT
323350             ADD WMS-MIN-AMT-FOR-SUPER TO WMS-INT-CUR-BAL
323400                                      WMS-CURR-BAL
323450                                      CUR-BAL
323500             MOVE '0' TO SAVINGS-MINIMUM, NSF-CALC-FLAG.
323550     IF CUR-BAL + WMS-INT-CUR-BAL LESS THAN TR-AMOUNT
323600       OR WMS-INT-STATUS GREATER THAN '1'
323650         MOVE '032' TO REJRESN                                    0717565
323700         GO TO K1989-UNPOST.                                      IM002
323750     SUBTRACT WMS-INT-CUR-BAL FROM TR-AMOUNT GIVING HOLD-AMT9.
323800     SUBTRACT HOLD-AMT9 FROM CUR-BAL TRANSFER-AMT.
323850     ADD HOLD-AMT9 TO WMS-INT-CUR-BAL.
323900 K1985-POST.
323950     IF  TR-OPTION (6) EQUAL '1' OR '3' OR '5' OR '7'             IM003
324000         IF  TR-80-TYPE NOT EQUAL '08' AND '12' AND '13' AND '14'
324050         MOVE TR-AMOUNT TO WMS-AMT-LAST-CUST-WITHDRAWAL
324100         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-WITHDRAWAL   0266741
324150                                 WMS-DATE-LAST-CUST-ACTIVITY.
324350     MOVE TR-AMOUNT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
324400     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
324450     ADD +1 TO FS-DB.
324500     IF WMS-STMT-FULL-SHEET GREATER THAN '0'
324550         PERFORM K7200 THRU K8500.
324600     PERFORM K0116-ACCUM-CTRS THRU K0116-EXIT.
324650     IF  TR-OPTION (6) EQUAL '1' OR '3' OR '5' OR '7'             IM003
324700         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
324750         PERFORM K0117 THRU K0118-EXIT.                           9915845
324800     IF TR-OPTION (5) EQUAL '2' OR '6'
324850         IF  TR-80-TYPE EQUAL '08' OR '12' OR '13' OR '14'
324900         PERFORM K0118 THRU K0118-EXIT.                           9915845
324950     SUBTRACT TR-AMOUNT FROM WMS-CURR-BAL WMS-INT-CUR-BAL         IM003
324956                             CUST-BAL.                            IM003
324962     IF  CUST-BAL LESS THAN ZERO                                  IM003
324968     AND WMS-OD-TODAY EQUAL '0'                                   IM005
324974         MOVE TR-OPTION9 (6) TO HOLD-OPT                          IM003
324980         PERFORM K0270-DAU THRU K0270-EXIT.                       IM003
324986 K1986.                                                           IM003
325000     ADD +1 TO WMS-TODAYS-DEBITS-NO.                              1004554
325005     ADD TR-AMOUNT TO WMS-TODAYS-DEBITS.                          1004554
325010     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
325015         ADD TR-AMOUNT TO INV-DR-AMT                              1004554
325020                          WS-GL-INV-DR-AMT                        1004554
325025         ADD +1        TO INV-DR-NO                               1004554
325030                          WS-GL-INV-DR-NO                         1004554
325035     ELSE                                                         1004554
325040         ADD TR-AMOUNT TO SAV-DR-AMT                              1004554
325045                          WS-GL-SAV-DR-AMT                        1004554
325050         ADD +1        TO SAV-DR-NO                               1004554
325055                          WS-GL-SAV-DR-NO.                        1004554
325100     MOVE '1' TO SAVINGS-POST-TODAY.
325102     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
325120     MOVE ZERO TO ACCR-INT-TRAN-NO.                               0902213
325150     IF TR-OPTION (3) EQUAL TO '0'
325200         GO TO K1987.
325250     IF TR-OPTION (3) GREATER THAN '3'
325270         MOVE +1 TO ACCR-INT-TRAN-NO                              0902213
325300         ADD +1 TO WMS-INT-TRAN-NO WMS-INT-MTD-TRANNO
325350        ADD TR-AMOUNT TO WMS-INT-TRAN-AMT WMS-INT-MTD-TRNAMT.
325360     IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U'     0417110
325362                    OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G'     0417110
325400         IF  TR-OPTION (3) EQUAL TO '1' OR '3' OR '5' OR '7'      1105504
325450             ADD +1 TO WMS-STMT-ITEMS                             1105504
325500             GO TO K1987.                                         1105504
325510     IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U'     0417110
325512                    OR 'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G'     0417110
325550         IF  TR-OPTION (3) NOT EQUAL TO '4'                       1105504
325600             AND WMS-STMT-ITEMS NOT EQUAL TO +0                   1105504
325650             SUBTRACT +1 FROM WMS-STMT-ITEMS.                     1105504
325700 K1987.
325750     ADD +1 TO SEQ-CTR.
325858     IF  TR-OPTION (4) GREATER THAN '3'                           IM003
325866         ADD TR-AMOUNT TO WMS-YTD-SAV-TAX                         IM003
325874                          WMS-INT-TAX                             IM003
325882                          WMS-INT-MTD-TAX                         IM003
325884         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
325886             ADD TR-AMOUNT TO INV-TAX-ADJ-UP                      1004554
325888                              WS-GL-INV-TAX-ADJ-UP                1004554
325890         ELSE                                                     1004554
325892             ADD TR-AMOUNT TO SAV-TAX-ADJ-UP-AMT                  1004554
325894                              WS-GL-SAV-TAX-ADJ-UP-AMT.           1004554
325895     IF  TR-OPTION (4) GREATER THAN '3'                           9915858
325896         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         9915858
325897             ADD TR-AMOUNT TO WMS-DUAL-YR-CUR-SAV-FED             9915858
325898                              DUAL-SV-TAX-ADJ-UP-AMT              9915858
325899                              WS-GL-DUAL-SV-TAX-ADJ-UP-AMT.       2012254
325900     IF  (TR-OPTION (7) EQUAL '4' OR '5' OR '6' OR '7')           2012254
325901     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
325902         ADD TR-AMOUNT TO WMS-YTD-SAV-STATE-TAX                   2012254
325903                          WMS-INT-TAX-STATE                       2012254
325904                          WMS-INT-MTD-STATE-TAX                   2012254
325905         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
325906             ADD TR-AMOUNT TO INV-TAX-ADJ-UP-ST                   2012254
325907                              WS-GL-INV-TAX-ADJ-UP-ST             2012254
325908         ELSE                                                     2012254
325909             ADD TR-AMOUNT TO SAV-TAX-ADJ-UP-AMT-ST               2012254
325910                              WS-GL-SAV-TAX-ADJ-UP-ST-AMT.        2012254
325911     IF  (TR-OPTION (7) EQUAL '4' OR '5' OR '6' OR '7')           2012254
325912     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
325913         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
325914             ADD TR-AMOUNT TO WMS-DUAL-YR-CUR-SAV-STATE           2012254
325915                              DUAL-SV-TAX-ADJ-UP-AMT-ST           2012254
325916                              WS-GL-DUAL-SV-TX-ADJ-UP-ST-A.       2012254
325917     IF  (TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7')           2012254
325918     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
325919         ADD TR-AMOUNT TO WMS-YTD-SAV-LOCAL-TAX                   2012254
325920                          WMS-INT-TAX-LOCAL                       2012254
325921                          WMS-INT-MTD-LOCAL-TAX                   2012254
325922         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
325923             ADD TR-AMOUNT TO INV-TAX-ADJ-UP-LOC                  2012254
325924                              WS-GL-INV-TAX-ADJ-UP-LOC            2012254
325925         ELSE                                                     2012254
325926             ADD TR-AMOUNT TO SAV-TAX-ADJ-UP-AMT-LOC              2012254
325927                              WS-GL-SAV-TAX-ADJ-UP-LOC-AMT.       2012254
325928     IF  (TR-OPTION (8) EQUAL '1' OR '3' OR '5' OR '7')           2012254
325929     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
325930         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
325931             ADD TR-AMOUNT TO WMS-DUAL-YR-CUR-SAV-LOCAL           2012254
325932                              DUAL-SV-TAX-ADJ-UP-AMT-LOC          2012254
325933                              WS-GL-DUAL-SV-TX-ADJ-UP-LOC-A.      2012254
325934     IF  TR-OPTION (4) NOT EQUAL TO '1' AND '3' AND '5' AND '7'   0265717
325935         GO TO K1987-CONT.                                        0265717
325936     SUBTRACT TR-AMOUNT FROM WMS-YTD-INT-PAID.                    2012254
325939     PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT.                  0617360
325940     IF  CERT-NAME-W8-STATUS EQUAL '1'                            0617360
325941         SUBTRACT TR-AMOUNT FROM WMS-YTD-INT-PAID-1042.           0617360
325942     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            0617360
325943         SUBTRACT TR-AMOUNT FROM INV-DIV-PAID-YTD-ADJ             0617360
325944                                 WS-GL-INV-DIV-PAID-YTD-ADJ       0617360
325945     ELSE                                                         0617360
325946         SUBTRACT TR-AMOUNT FROM DDA-INT-YTD-ADJ                  0617360
325947                                 WS-GL-DDA-INT-YTD-ADJ.           0617360
325948     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             0617360
325949         SUBTRACT TR-AMOUNT FROM WMS-DUAL-YR-CUR-SAV-INT          0617360
325950             DUAL-SV-INT-YTD-ADJ WS-GL-DUAL-SV-INT-YTD-ADJ.       0617360
325951 K1987-CONT.                                                      0617360
325960     IF  TR-OPTION (4) EQUAL '2' OR '3' OR '6' OR '7'             0265717
326050         SUBTRACT TR-AMOUNT FROM WMS-INT-ACCUM-INT                0265717
326100                                 WMS-MTD-INT-PAID.                0265717
326550 K1988.                                                           IM002
326600     IF TR-80-TYPE EQUAL TO '06'
326650         PERFORM TRAN-ADJUST THRU END-INT-ADJUST
326700         PERFORM ADJ-SC-AGGR THRU ADJ-YTD-AGGR
326750         SUBTRACT TR-ITEM-COUNT FROM WMS-INT-CR-NUMBER
326800         SUBTRACT TR-AMOUNT FROM WMS-INT-CR-AMT
327050     ELSE
327100         ADD +1 TO WMS-INT-DR-NUMBER
327150         ADD TR-AMOUNT TO WMS-INT-DR-AMT.
327160     IF  TR-OPTION (7) EQUAL '1' OR '3' OR '5' OR '7'             1004015
327170         ADD TR-AMOUNT TO WMS-INT-TIS-CYC-FEES.                   1004015
327180     IF  TR-OPTION (7) EQUAL '2' OR '3' OR '6' OR '7'             1004773
327190         SUBTRACT TR-AMOUNT FROM WBC-REG-TFR-AMT (9).             0266741
327200     GO TO K1970.
327202 K1989-UNPOST.                                                    0527322
327204     ADD TR-AMOUNT TO SAV-UN-DR-AMT, WS-GL-SAV-UN-DR-AMT.         0527322
327206     ADD +1 TO SAV-UN-DR-NO, WS-GL-SAV-UN-DR-NO.                  0527322
327208     MOVE 'A6' TO EXCODE-1.                                       0527322
327210     GO TO K0385.                                                 0527322
327212     SKIP3                                                        0527322
327214*    ************* CLOSING TRANSACTION PROCESSING **************  0527322
327216     SKIP1                                                        0527322
327218 K1990-CLOSE.                                                     0527322
327220*   ***********************************************************   0527322
327222*  ASSESS ANY PENDING TAXES                                   *   0527322
327224*   ***********************************************************   0527322
327226     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        0527322
327227*----------------------------------------------------------------*~~~0183
327228*  INSURE INTEREST IS INCLUDED IN THE CLOSING AMOUNT             *~~~0183
327229*----------------------------------------------------------------*~~~0183
327230     MOVE ZERO TO WMS-IOD-DIST-CD.                                ~~~0183
327231     IF  WMS-SAVINGS-TRLR EQUAL '1'                               ~~~0183
327232         MOVE ZERO TO WMS-SAV-DIST-CD.                            ~~~0183
327233     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         ~~~0183
327234         MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT                 ~~~0183
327235         PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT      ~~~0183
327236         MOVE +0 TO WMS-IOD-PEND-TAX.                             ~~~0183
327237     IF  WMS-SAVINGS-TRLR EQUAL '1'                               ~~~0183
327238         IF  WMS-SAV-PEND-TAX GREATER THAN +0                     0527322
327240             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             0527322
327242             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  0527322
327244             MOVE +0 TO WMS-SAV-PEND-TAX.                         0527322
327246     MOVE ZERO TO CLS-ADJUSTMENT       CLS-IOD-INT-PAY            0527322
327248                  CLS-SAV-INT-PAY      CLS-OD-INT-CHG             0527322
327250                  CLS-IOD-INT-WAV      CLS-SAV-INT-WAV            0527322
327251                  CLS-OD-INT-WAV       CLS-IOD-TAX                0527322
327252                  CLS-SAV-TAX          TAX-CALC-AMOUNT-ST         0527322
327253                  CLS-CLOSE-CHG        TAX-CALC-AMOUNT-LOC.       0527322
327254     IF  TR-TRAN-TYPE EQUAL '4'                                   0527322
327255         MULTIPLY TR-AMOUNT BY -1 GIVING CLS-TR-AMOUNT            0527322
327256     ELSE                                                         0527322
327257         MOVE TR-AMOUNT TO CLS-TR-AMOUNT.                         0527322
327258     MOVE WMS-CURR-BAL TO CLS-ADJUSTMENT.                         0527322
327259     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0527322
327260         IF  SAVINGS-MINIMUM EQUAL '1'                            0527322
327261             ADD WMS-MIN-AMT-FOR-SUPER TO CLS-ADJUSTMENT          0527322
327262                                          WMS-INT-CUR-BAL         0527322
327263                                          WMS-CURR-BAL            0527322
327264             MOVE '0' TO SAVINGS-MINIMUM.                         0527322
327265     ADD CLS-TR-AMOUNT TO CLS-ADJUSTMENT.                         0527322
327266     IF  WMS-CLOSE-AMT EQUAL +0                                   0527322
327267         GO TO K1990-CLOSE-END.                                   0527322
327268     MOVE '0'  TO WK-FLAG.                                        0527322
327269     MOVE '14' TO WK-FORMAT.                                      0527322
327270     CALL 'SICOMPDT' USING WBC-CAPTURE-DATE                       0527322
327271                           WMS-CLOSE-EXP-DTE                      0527322
327272                           WK-FLAG                                0527322
327273                           WK-FORMAT.                             0527322
327274     IF  WK-FLAG EQUAL 'H' OR 'E'                                 0527322
327275         GO TO K1990-CLOSE-END.                                   0527322
327276     IF  WMS-CLOSE-WVE EQUAL '1'                                  0527322
327277         ADD +1 TO DDA-SVC-CHG-WAV-NO, WS-GL-DDA-SVC-CHG-WAV-NO   0527322
327278         ADD WMS-CLOSE-AMT TO DDA-SVC-CHG-WAV-AMT                 0527322
327279                              WS-GL-DDA-SVC-CHG-WAV-AMT           0527322
327280         GO TO K1990-CLOSE-END.                                   0527322
327281     SUBTRACT WMS-CLOSE-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL. 0527322
327282     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       0527322
327283     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     0527322
327284         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0527322
327285         ADD WMS-CLOSE-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT        0527322
327286     ELSE                                                         0527322
327287         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0527322
327288         ADD WMS-CLOSE-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.       0527322
327289     MOVE WBC-GENERATED-TRANS (31) TO GEN-TRAN-OPTION-HOLD.       0527322
327290     MOVE WMS-CLOSE-AMT TO HOLD-AMT.                              0527322
327291     MOVE 'GJ' TO IMEX-CODE-2.                                    0527322
327292     MOVE '31' TO EX01-INT-CODE.                                  0527322
327293     MOVE '4'  TO EX01-TYPE.                                      0527322
327294     MOVE +1   TO EX01-NUMBER.                                    0527322
327295     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 0527322
327296     ADD +1 TO DDA-CLOSE-CHG-NO, WS-GL-DDA-CLOSE-CHG-NO.          0527322
327297     ADD WMS-CLOSE-AMT        TO DDA-CLOSE-CHG-AMT                0527322
327298                                 WS-GL-DDA-CLOSE-CHG-AMT          0527322
327299                                 WMS-STMT-SERV-CHG                0527322
327300                                 WMS-MTD-ACCUM-SERV-CHG           0527322
327301                                 WMS-YTD-ACCUM-SERV-CHG           0617360
327302                                 WMS-IOD-TIS-CYC-FEES.            0617360
327303     MOVE WMS-CLOSE-AMT       TO CLS-CLOSE-CHG.                   0617360
327304     SUBTRACT WMS-CLOSE-AMT FROM CLS-ADJUSTMENT.                  0617360
327305 K1990-CLOSE-END.                                                 0617360
327306     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'                            0617360
327307         GO TO K1990-WAIVE.                                       0617360
327308 K1990-OD.                                                        IM007
327309     IF  WMS-OD-STATUS EQUAL '1' OR '2'                           IM007
327310         GO TO K1990-OD-EXIT.                                     IM007
327311     IF  WMS-OD-CYC-ACR EQUAL ZERO                                IM007
327312         GO TO K1990-OD-STATUS.                                   0346771
327313     IF  WMS-OD-CYC-ACR GREATER THAN ZERO                         IM007
327314         ADD +.005 WMS-OD-CYC-ACR GIVING CLS-ACCR-INT             IM007
327315     ELSE                                                         IM007
327316         ADD -.005 WMS-OD-CYC-ACR GIVING CLS-ACCR-INT.            IM007
327317     IF  (WMS-OD-INT-WAIVE EQUAL '1')                             0346771
327318     OR  (WBC-OD-MIN-CHG-AMT GREATER THAN CLS-ACCR-INT)           0346771
327319         MOVE CLS-ACCR-INT TO CLS-OD-INT-WAV                      0346771
327320         MOVE ZERO TO WMS-OD-CYC-CHGD                             0346771
327321         GO TO K1990-OD-PAY.                                      0346771
327322     MOVE CLS-ACCR-INT TO WMS-OD-CYC-CHGD.                        0346771
327327     MOVE WMS-OD-CYC-CHGD TO CLS-OD-INT-CHG.                      IM007
327328     SUBTRACT WMS-OD-CYC-CHGD FROM CLS-ADJUSTMENT.                IM007
327329 K1990-OD-PAY.                                                    IM007
327330     SUBTRACT CLS-OD-INT-WAV FROM OD-ACCRL-ADJ-INTRNL             0902970
327331                                  WS-GL-OD-ACCRL-ADJ-INTRNL.      0902970
327332     MOVE WMS-OD-CYC-CHGD TO SC-AMT-OD-CHG.                       0902970
327333     MOVE SPACES TO SC-STMT-SYM-OD.                               0902970
327334     MOVE '4' TO OD-ACR-PAY-FLAG.                                 0902970
327335     PERFORM R4012-B THRU R4013-EXIT.                             0902970
327336 K1990-OD-STATUS.                                                 0902970
327337*    IF  WMS-OD-YTD-CHGD GREATER THAN ZERO                        IMODTRAI
327338*        MOVE '1' TO WMS-OD-STATUS                                IMODTRAI
327339*    ELSE                                                         IMODTRAI
327340*        MOVE '2' TO WMS-OD-STATUS.                               IMODTRAI
327341     MOVE 'SU' TO IMEX-CODE-1.                                    0902970
327342     MOVE 'SA' TO IMEX-CODE-2.                                    0902970
327343     MOVE '09' TO IMEX-REC-NO.                                    0902970
327344     MOVE WK-OD-STATUS-IN TO EX09-STATUS-IN.                      0902970
327345     MOVE WMS-OD-STATUS TO EX09-STATUS-OUT, WK-OD-STATUS-IN.      0902970
327346     MOVE ZERO TO EX09-CUR-BAL.                                   IM007
327347     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     IM007
327348 K1990-OD-EXIT.                                                   IM007
327349     EXIT.                                                        IM007
327350     SKIP1                                                        IM007
327351 K1990-WAIVE.                                                     IM007
327352     MULTIPLY -1 BY CLS-ADJUSTMENT.                               IM007
327353     IF  CLS-ADJUSTMENT GREATER THAN ZERO                         IM007
327354         GO TO K1991-SAV.                                         IM007
327355     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM007
327356     AND (WMS-INT-STATUS NOT EQUAL '7' AND '8')                   IM007
327357         MOVE ZERO TO TODAYS-INTRST-PYMT                          IM007
327358         IF  WMS-ACCR-INT GREATER THAN ZERO                       IM007
327359             ADD +.005 WMS-ACCR-INT GIVING CLS-SAV-INT-WAV        IM007
327360             PERFORM K1991-PAY THRU K1991-EXIT                    IM007
327361         ELSE                                                     IM007
327362             ADD -.005 WMS-ACCR-INT GIVING CLS-SAV-INT-WAV        IM007
327363             PERFORM K1991-PAY THRU K1991-EXIT.                   IM007
327364     IF  WMS-HIFI-INDICATOR EQUAL +0                              IM007
327365     AND WMS-IOD-RATE-PTR   EQUAL +0                              IM007
327366         GO TO K1994-ADJ.                                         IM007
327367     MOVE ZERO TO TODAYS-INTRST-PYMT.                             IM007
327368     IF  WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                    IM007
327369         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING CLS-IOD-INT-WAV     IM007
327370     ELSE                                                         IM007
327371         ADD -.005 WMS-IOD-CYC-ACC-INT GIVING CLS-IOD-INT-WAV.    IM007
327372     GO TO K1992-PAY.                                             IM007
327373     SKIP1                                                        IM007
327374 K1991-SAV.                                                       IM007
327375     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
327376         GO TO K1992-IOD.                                         IM007
327377     IF  (WMS-INT-STATUS EQUAL '7' OR '8')                        IM007
327378     AND WMS-INT-CUR-BAL EQUAL ZERO                               IM007
327379         GO TO K1992-IOD.                                         IM007
327380     IF  WMS-ACCR-INT EQUAL ZERO                                  IM007
327381         GO TO K1991-SAV-STATUS.                                  2012254
327382     IF  WMS-ACCR-INT GREATER THAN ZERO                           2012254
327383         ADD +.005 WMS-ACCR-INT GIVING CLS-ACCR-INT               2012254
327384     ELSE                                                         2012254
327385         ADD -.005 WMS-ACCR-INT GIVING CLS-ACCR-INT.              2012254
327386     IF  WMS-BKUP-WTHLD-FLAG GREATER THAN '0'                     2012254
327387     OR  WMS-STATE-LOCAL-TX-CD GREATER '0'                        2012254
327388         MOVE 'F' TO TAX-CALC-IOD-FLAG                            IM007
327389         PERFORM K1993-BKUP THRU K1993-EXIT                       IM007
327390     ELSE                                                         IM007
327391         MOVE CLS-ADJUSTMENT TO TODAYS-INTRST-PYMT.               IM007
327392     IF  TODAYS-INTRST-PYMT GREATER THAN CLS-ACCR-INT             IM007
327393         MOVE CLS-ACCR-INT TO TODAYS-INTRST-PYMT                  IM007
327394     ELSE                                                         IM007
327395         SUBTRACT TODAYS-INTRST-PYMT FROM CLS-ACCR-INT            IM007
327396             GIVING CLS-SAV-INT-WAV.                              IM007
327397     MOVE TODAYS-INTRST-PYMT TO CLS-SAV-INT-PAY.                  IM007
327398     SUBTRACT TODAYS-INTRST-PYMT FROM CLS-ADJUSTMENT.             IM007
327399 K1991-PAY.                                                       IM007
327400     MOVE 'F' TO IOD-FLAG.                                        IM007
327401     MOVE 'N' TO SAV-CLEAR.                                       IM007
327402     MOVE 'N' TO IOD-CLOSE-FLAG.                                  IM007
327403     PERFORM R3837 THRU R3864.                                    IM007
327404     MOVE 'F' TO IOD-CLOSE-FLAG.                                  IM007
327405     MOVE ZERO TO CLS-ACCR-INT.                                   IM007
327406 K1991-SAV-STATUS.                                                IM007
327407     IF  WMS-INT-CUR-BAL GREATER THAN ZERO                        IM007
327408         ADD WMS-INT-CUR-BAL TO TRANSFER-AMT                      IM007
327409         MOVE ZERO TO WMS-INT-CUR-BAL.                            IM007
327410     MOVE '7' TO WMS-INT-STATUS.                                  IM007
327411     MOVE 'SU' TO IMEX-CODE-1.                                    IM007
327412     MOVE 'SS' TO IMEX-CODE-2.                                    IM007
327413     MOVE '09' TO IMEX-REC-NO.                                    IM007
327414     MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN.                      IM007
327415     MOVE WMS-INT-STATUS  TO EX09-STATUS-OUT                      IM007
327416                             WK-SV-STATUS-IN.                     IM007
327417     MOVE +0 TO EX09-CUR-BAL.                                     IM007
327418     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     IM007
327419 K1991-EXIT.                                                      IM007
327420     EXIT.                                                        IM007
327421     SKIP1                                                        IM007
327422 K1992-IOD.                                                       IM007
327423     IF  WMS-HIFI-INDICATOR EQUAL +0                              IM007
327424     AND WMS-IOD-RATE-PTR   EQUAL +0                              IM007
327434         GO TO K1994-ADJ.                                         IM002
327436     IF  WMS-IOD-CYC-ACC-INT EQUAL ZERO                           IM002
327437     AND WMS-IOD-PEND-TAX    EQUAL ZERO                           IM007
327438         GO TO K1994-ADJ.                                         IM002
327442     IF  WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                    IM002
327444         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING CLS-ACCR-INT        IM002
327446     ELSE                                                         IM002
327448         ADD -.005 WMS-IOD-CYC-ACC-INT GIVING CLS-ACCR-INT.       IM002
327450     IF  WMS-BKUP-WTHLD-FLAG GREATER THAN '0'                     IM002
327451     OR  WMS-STATE-LOCAL-TX-CD GREATER '0'                        2012254
327452         MOVE 'N' TO TAX-CALC-IOD-FLAG                            IM002
327454         PERFORM K1993-BKUP THRU K1993-EXIT                       IM002
327456         MOVE 'F' TO TAX-CALC-IOD-FLAG                            IM002
327458     ELSE                                                         IM002
327460         MOVE CLS-ADJUSTMENT TO TODAYS-INTRST-PYMT.               IM002
327462     IF  TODAYS-INTRST-PYMT GREATER THAN CLS-ACCR-INT             IM002
327464         MOVE CLS-ACCR-INT TO TODAYS-INTRST-PYMT                  IM002
327465     ELSE                                                         IM002
327466         SUBTRACT TODAYS-INTRST-PYMT FROM CLS-ACCR-INT            IM002
327467             GIVING CLS-IOD-INT-WAV.                              IM002
327468     MOVE TODAYS-INTRST-PYMT TO CLS-IOD-INT-PAY.                  IM002
327469     SUBTRACT TODAYS-INTRST-PYMT FROM CLS-ADJUSTMENT.             IM002
327470 K1992-PAY.                                                       IM002
327471     MOVE 'N' TO IOD-FLAG IOD-CLEAR IOD-CLOSE-FLAG.               2016735
327472     PERFORM R3837 THRU R3864.                                    2016735
327473     MOVE 'F' TO IOD-FLAG IOD-CLOSE-FLAG.                         2016735
327474     GO TO K1994-ADJ.                                             2016735
327475 K1993-BKUP.                                                      2016735
327476     MOVE ZERO TO WK-TAX-RT WK-TAX-RT-ST WK-TAX-RT-LOC WK-TAX-RTS.2016735
327477     MOVE CLS-ACCR-INT              TO TAX-CALC-PAYMENT.          2016735
327478     IF  WMS-BKUP-WTHLD-FLAG   GREATER THAN ZERO                  2016735
327479         IF  WMS-FED-TAX-RATE-FLAG EQUAL 'Y'                      2016735
327480             MOVE WMS-FED-TAX-RATES TO WORK-TAX-RATES             2016735
327481             PERFORM TXCL-00-CHK-RATES THRU TXCL-99-CHK-RATES-EXIT2016735
327482             MOVE WORK-TAX-RATE     TO WK-TAX-RT.                 2016735
327483     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2'                   2016735
327484         IF  WMS-ST-TAX-RATE-FLAG EQUAL 'Y'                       2016735
327485             MOVE WMS-ST-TAX-RATES  TO WORK-TAX-RATES             2016735
327486             PERFORM TXCL-00-CHK-RATES THRU TXCL-99-CHK-RATES-EXIT2016735
327487             MOVE WORK-TAX-RATE     TO WK-TAX-RT-ST.              2016735
327488     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3'                   2016735
327489         IF  WMS-LOC-TAX-RATE-FLAG EQUAL 'Y'                      2016735
327490             MOVE WMS-LOC-TAX-RATES TO WORK-TAX-RATES             2016735
327491             PERFORM TXCL-00-CHK-RATES THRU TXCL-99-CHK-RATES-EXIT2016735
327492             MOVE WORK-TAX-RATE     TO WK-TAX-RT-LOC.             2016735
327493     ADD WK-TAX-RT WK-TAX-RT-ST WK-TAX-RT-LOC TO WK-TAX-RTS.      2016735
327494     MULTIPLY CLS-ACCR-INT BY WK-TAX-RTS                          2016735
327495            GIVING TODAYS-WTHLD-AMT ROUNDED.                      2016735
327496     ADD TODAYS-WTHLD-AMT TO CLS-ADJUSTMENT                       2016735
327497            GIVING TODAYS-INTRST-PYMT.                            2016735
327498     IF  TODAYS-INTRST-PYMT GREATER THAN CLS-ACCR-INT             2016735
327499         MOVE CLS-ACCR-INT TO TODAYS-INTRST-PYMT.                 2016735
327500     MOVE TODAYS-INTRST-PYMT TO TAX-CALC-PAYMENT.                 2016735
327501     MOVE '1' TO TAX-CALC-REASON.                                 2016735
327502     PERFORM R3899-CALC-TAX-DAYS THRU R3899-EXIT.                 2016735
327503     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.                 2016735
327504     IF  TAX-CALC-AMOUNT     EQUAL ZERO                           2016735
327505     AND TAX-CALC-AMOUNT-ST  EQUAL ZERO                           2016735
327506     AND TAX-CALC-AMOUNT-LOC EQUAL ZERO                           2016735
327507         MOVE CLS-ADJUSTMENT TO TODAYS-INTRST-PYMT                2016735
327508         GO TO K1993-EXIT                                         2016735
327509     ELSE                                                         2016735
327510         ADD TAX-CALC-AMOUNT            TAX-CALC-AMOUNT-ST        2016735
327511             TAX-CALC-AMOUNT-LOC     TO CLS-ADJUSTMENT.           2016735
327512     IF  TAX-CALC-IOD-FLAG EQUAL 'N'                              2016735
327513         MOVE TAX-CALC-AMOUNT TO CLS-IOD-TAX                      2016735
327514         ADD  TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC              2016735
327515                             TO CLS-IOD-TAX                       2016735
327516     ELSE                                                         2016735
327517         MOVE TAX-CALC-AMOUNT TO CLS-SAV-TAX                      2016735
327518         ADD  TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC              2016735
327519                             TO CLS-SAV-TAX.                      2016735
327520     GO TO K1993-EXIT.                                            2016735
327521 K1993-EXIT.                                                      2016735
327522     EXIT.                                                        2016735
327523 K1994-ADJ.                                                       2016735
327524     IF  CLS-ADJUSTMENT EQUAL ZERO                                2016735
327525         GO TO K1995-DDA-POST.                                    2016735
327526     IF  CLS-ADJUSTMENT GREATER THAN ZERO                         2016735
327527         ADD +1 TO DDA-GEN-CLS-CR-NO WS-GL-DDA-GEN-CLS-CR-NO FS-CR2016735
327528         ADD CLS-ADJUSTMENT TO DDA-GEN-CLS-CR-AMT                 2016735
327529                               WS-GL-DDA-GEN-CLS-CR-AMT           2016735
327530         IF  (WMS-HIFI-INDICATOR GREATER THAN ZERO                2016735
327531         OR  WMS-IOD-RATE-PTR GREATER THAN ZERO)                  2016735
327532             ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                 2016735
327533             ADD CLS-ADJUSTMENT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT   2016735
327534         ELSE                                                     2016735
327535             ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                 2016735
327536             ADD CLS-ADJUSTMENT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.  0902970
327538     IF  CLS-ADJUSTMENT LESS THAN ZERO                            IM002
327539         MULTIPLY CLS-ADJUSTMENT BY -1 GIVING CLS-POS-ADJUST      IM002
327540         ADD +1 TO DDA-GEN-CLS-DR-NO, WS-GL-DDA-GEN-CLS-DR-NO     0902970
327542                   FS-DB                                          IM002
327544         ADD CLS-POS-ADJUST TO DDA-GEN-CLS-DR-AMT                 IM002
327545                               WS-GL-DDA-GEN-CLS-DR-AMT           0902970
327546         IF  (WMS-HIFI-INDICATOR GREATER THAN ZERO                IM002
327548         OR  WMS-IOD-RATE-PTR GREATER THAN ZERO)                  IM002
327550             ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                 0902970
327552             ADD CLS-POS-ADJUST TO IOD-DB-AMT, WS-GL-IOD-DB-AMT   0902970
327554         ELSE                                                     IM002
327556             ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                 0902970
327558             ADD CLS-POS-ADJUST TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.  0902970
327560     PERFORM K7200 THRU K8500.                                    IM002
327562     IF  CLS-ADJUSTMENT GREATER THAN ZERO                         IM002
327564         ADD +1 TO WMS-STMT-NO-CREDITS                            IM002
327565         ADD CLS-ADJUSTMENT TO WMS-STMT-CR-AMT                    IM002
327568     ELSE                                                         IM002
327570         ADD +1 TO WMS-STMT-NO-DEBITS                             IM002
327571         ADD CLS-POS-ADJUST TO WMS-STMT-DR-AMT.                   IM002
327574     ADD CLS-ADJUSTMENT TO WMS-CURR-BAL.                          IM003
327578     MOVE WBC-GENERATED-TRANS (19) TO GEN-TRAN-OPTION-HOLD.       0266741
327580     MOVE '19' TO EX01-INT-CODE.                                  IM002
327582     MOVE 'G9' TO IMEX-CODE-2.                                    IM002
327584     IF  CLS-ADJUSTMENT GREATER THAN ZERO                         IM002
327586         MOVE '2' TO EX01-TYPE                                    IM002
327587         MOVE CLS-ADJUSTMENT TO HOLD-AMT                          IM002
327588     ELSE                                                         IM002
327590         MOVE '4' TO EX01-TYPE                                    IM002
327591         MOVE CLS-POS-ADJUST TO HOLD-AMT.                         IM002
327592     MOVE ZERO TO EX01-NUMBER.                                    IM002
327594     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 IM002
327595 K1995-DDA-POST.                                                  0917846
327596     IF  CUST-CALC-FLAG EQUAL '0'                                 0917846
327597         PERFORM K0106 THRU K0106-EXIT.                           0917846
327598     MOVE WMS-CURR-BAL TO CUR-BAL.                                IM003
327600     IF  TR-80-TYPE EQUAL '01'                                    IM005
327601         MOVE TR-01-ITEM-COUNT TO TR-ITEM-COUNT                   IM005
327602     ELSE                                                         IM005
327603         MOVE +1 TO TR-ITEM-COUNT.                                IM005
327604     IF  TR-TRAN-TYPE EQUAL '2'                                   9915845
327605         PERFORM K0615 THRU K0770-EXIT.                           IM005
327606     IF  TR-TRAN-TYPE EQUAL '4'                                   9915845
327607         PERFORM K1100-POST THRU K1140-EXIT.                      IM005
327608 K1996-EXC.                                                       IM002
327610     MOVE 'H9' TO IMEX-CODE-1.                                    IM002
327612     MOVE '23' TO IMEX-REC-NO.                                    IM002
327614     MOVE TR-TRAN80-A     TO IMEX-REC-13A.                        IM002
327616     MOVE TR-USER-CODE    TO EX13-USER-CODE.                      IM007
327617     MOVE TR-TRAN-TYPE           TO EX13-TYPE.                    9915845
327618     MOVE TR-80-TYPE      TO EX13-TR-TYPE.                        IM006
327619     MOVE CLS-TR-AMOUNT   TO EX13-AMT.                            IM006
327620     MOVE CLS-ADJUSTMENT  TO EX23-ADJUSTMENT.                     IM002
327622     MOVE CLS-IOD-INT-PAY TO EX23-IOD-INT-PAY.                    IM002
327624     MOVE CLS-SAV-INT-PAY TO EX23-SAV-INT-PAY.                    IM002
327625     MOVE CLS-OD-INT-CHG  TO EX23-OD-INT-CHG.                     IM002
327626     MOVE CLS-IOD-INT-WAV TO EX23-IOD-INT-WAV.                    IM002
327627     MOVE CLS-SAV-INT-WAV TO EX23-SAV-INT-WAV.                    IM002
327628     MOVE CLS-OD-INT-WAV  TO EX23-OD-INT-WAV.                     IM002
327630     MOVE CLS-IOD-TAX     TO EX23-IOD-TAX.                        IM002
327631     MOVE CLS-SAV-TAX     TO EX23-SAV-TAX.                        IM002
327632     MOVE CLS-CLOSE-CHG   TO EX23-CLOSING-CHG.                    0527322
327633     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0527322
327634 K1997-DDA-STATUS.                                                0527322
327635     MOVE '04' TO WMS-STATUS.                                     0527322
327636     MOVE 'SU' TO IMEX-CODE-1.                                    IM002
327637     MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE.           IMIB004
327638     MOVE 'SD' TO IMEX-CODE-2.                                    IM002
327640     MOVE '09' TO IMEX-REC-NO.                                    IM002
327641     MOVE '51' TO WMS-REASON-CLOSED.                              IMIB004
327642     MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN.                      IM002
327643     MOVE '51' TO EX09-GEN-REASON.                                IMIB004
327644     MOVE WMS-STATUS TO EX09-STATUS-OUT                           IM002
327646                        WK-IM-STATUS-IN.                          IM002
327648     MOVE +0 TO EX09-CUR-BAL.                                     IM002
327650*                                                                 0902079
327651*    SET REASON CLOSED FOR CLOSING TRANSACTION                    0902079
327652*                                                                 0902079
327653     MOVE WBC-CAPTURE-MO TO WMS-CLOSED-MO.                        0266741
327654     MOVE WBC-CAPTURE-DA TO WMS-CLOSED-DA.                        0266741
327655     MOVE WBC-CAPTURE-YR TO WMS-CLOSED-YR.                        0266741
327656     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
327657         MOVE '20' TO WMS-CLOSED-CENT                             1004775
327658     ELSE                                                         0902079
327659         MOVE '19' TO WMS-CLOSED-CENT.                            0902079
327660     IF  WMS-REASON-CLOSED EQUAL '00' OR '  '                     9915749
327661         MOVE '01' TO WMS-REASON-CLOSED.                          1105504
327662     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     1105504
327663     IF  WBC-STMT-ON-CLOSED EQUAL '1'                             0266741
327664         MOVE '10' TO IMEX-CODE-2                                 1105504
327674         MOVE '1' TO EX07-RESET                                   IM006
327682         MOVE '   ' TO EX07-REQ-BY                                IM006
327690         PERFORM R5020 THRU R5045                                 IM006
327698         MOVE '1' TO WMS-STMT-CLEAR                               IM006
327699         MOVE '1' TO WMS-IT-TRAN-FLAG1                            9915749
327706         PERFORM R5196 THRU R5200.                                IM006
327714     GO TO K7000.                                                 IM006
327722 K1999-EXIT.                                                      IM006
327730     EXIT.                                                        IM006
327733     COPY IMPDTAX.                                                2016735
327738     SKIP3                                                        IM006
327746 ROOT-SECTION-C      SECTION 1.                                   IM006
327754     SKIP3                                                        IM006
327762*    *******  NON-MONETARY-TRAN-DETERMINATION  *******            IM006
327770     SKIP1                                                        IM006
327778 K2000.                                                           IM006
327780     IF  TR-IBT-TRANSFER-REC EQUAL '1'                            9915845
327782     AND (TR-CLASS EQUAL '58' OR '59')                            9915845
327784         IF  WBC-POST-AMT-SEQ EQUAL '1'                           0266741
327786             MULTIPLY -1 BY TR-NO-AMT GIVING HOLD-AMT             9915845
327788         ELSE                                                     9915845
327790             MOVE TR-NO-AMT TO HOLD-AMT.                          9915845
327792     IF  TR-IBT-TRANSFER-REC EQUAL '1'                            9915845
327794         IF  TR-CLASS EQUAL '51'                                  9915845
327796             ADD +1 TO IBT-BNK-NO-IN                              9915845
327798             ADD TR-BCA-AMT (1) TR-BCA-AMT (2) TR-BCA-AMT (3)     9915845
327800                 TR-BCA-AMT (4) TR-BCA-AMT (5) TR-BCA-AMT (6)     9915845
327802                 TR-BCA-AMT (7) TR-BCA-AMT (8) TO IBT-BNK-AMT-IN  9915845
327804         ELSE                                                     9915845
327806         IF  TR-CLASS EQUAL '52' OR '54' OR '55' OR '56' OR '57'  0927817
327808             ADD +1 TO IBT-CUS-NO-IN                              9915845
327810             ADD TR-BCA-AMT (1) TR-BCA-AMT (2) TR-BCA-AMT (3)     9915845
327812                 TR-BCA-AMT (4) TR-BCA-AMT (5) TR-BCA-AMT (6)     9915845
327814                 TR-BCA-AMT (7) TR-BCA-AMT (8) TR-BCA-AMT (9)     9915845
327815                 TR-BCA-AMT (10) TR-BCA-AMT (11) TR-BCA-AMT (12)  9915845
327816                 TR-BCA-AMT (13) TO IBT-CUS-AMT-IN                9915845
327817         IF  TR-CLASS EQUAL '53'                                  0927817
327818             ADD +1              TO IBT-CUS-NO-IN                 0927817
327819             ADD TR-FLOAT-AMT    TO IBT-CUS-AMT-IN                0927817
327820         ELSE                                                     0927817
327821         IF  TR-CLASS EQUAL '58'                                  0927817
327822             IF  TR-BCA-ADJ-TYPE EQUAL '1'                        9915845
327824                 ADD +1 TO IBT-BNK-ADJ-NO-IN                      9915845
327826                 ADD HOLD-AMT TO IBT-BNK-ADJ-AM-IN                9915845
327828             ELSE                                                 9915845
327829             IF  TR-BCA-ADJ-TYPE EQUAL '2'                        9915845
327830                 ADD +1 TO IBT-CUS-ADJ-NO-IN                      9915845
327831                 ADD HOLD-AMT TO IBT-CUS-ADJ-AM-IN                9915845
327832             ELSE                                                 9915845
327833                 ADD +1 TO IBT-CAS-ADJ-NO-IN                      9915845
327834                 ADD HOLD-AMT TO IBT-CAS-ADJ-AM-IN                9915845
327835         ELSE                                                     9915845
327836         IF  TR-CLASS EQUAL '59'                                  9915845
327838             IF  TR-BCA-ADJ-TYPE EQUAL '1'                        9915845
327840                 ADD +1 TO IBT-BNK-ADJ-NO-IN                      9915845
327842                 SUBTRACT HOLD-AMT FROM IBT-BNK-ADJ-AM-IN         9915845
327844             ELSE                                                 9915845
327845             IF  TR-BCA-ADJ-TYPE EQUAL '2'                        9915845
327846                 ADD +1 TO IBT-CUS-ADJ-NO-IN                      9915845
327847                 SUBTRACT HOLD-AMT FROM IBT-CUS-ADJ-AM-IN         9915845
327848             ELSE                                                 9915845
327849                 ADD +1 TO IBT-CAS-ADJ-NO-IN                      9915845
327850                 SUBTRACT HOLD-AMT FROM IBT-CAS-ADJ-AM-IN.        9915845
327851     IF  IBT-NEW-FLAG EQUAL '1'                                   9915845
327854         MOVE '086' TO REJRESN                                    0717565
327856         MOVE '44' TO IMEX-REC-NO                                 9915845
327858         MOVE 'IB' TO IMEX-CODE-1                                 9915845
327860         MOVE 'IH' TO IMEX-CODE-2                                 9915845
327862         MOVE SPACES            TO EX44-IBT-OLD-NEW-ACCT          9915845
327864         MOVE TR-CLASS          TO EX44-CLASS                     9915845
327866         MOVE TR-SOURCE         TO EX44-SOURCE                    9915845
327868         MOVE TR-BATCH          TO EX44-BATCH                     9915845
327870         MOVE TR-SEQ            TO EX44-SEQ                       9915845
327872         MOVE TR-TRACE          TO EX44-TRACE                     9915845
327874         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  9915857
327876         GO  TO  K3165.                                           9915845
327877     IF  TR-CLASS EQUAL '97'                                      9915845
327878     AND TR-SCLASS1 EQUAL 'A'                                     9915845
327879         PERFORM UNPOST-EXCEPT                                    9915845
327880         GO  TO  END-UNPOST.                                      9915845
327885******************************************************************9915845
327890***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE INCOMING   IM002
327980***  NON-MONETARY TRANSACTION PRIOR TO POSTING.                   IM002
328070***                                                               IM002
328160***  COPY IM31UBWR.                                               IM002
328250***                                                               IM002
328340***  END OF USER EXIT.                                            IM002
328430******************************************************************IM002
328700     IF WMS-STATUS EQUAL TO '99'
328750         IF TR-CLASS EQUAL TO '20' OR '95'
328800             GO TO K5000
328850         ELSE
328900             MOVE '1' TO ACCT-NOT-FOUND.
328910     IF  ACCT-NOT-FOUND EQUAL '1'                                 0902970
328915         MOVE GL-CURRENT-COST-CTR TO SAV-GL-CURRENT-COST-CTR      0902970
328920         MOVE 'N' TO GL-BUILD-MASTER-SW                           0902970
328934         PERFORM K5700 THRU K5700-EXIT                            0902970
328938         PERFORM C1009 THRU C1009-EXIT                            0902970
328939         MOVE TR-KEY  TO  WK-GL-ORIG-ACCT                         0902970
328945         MOVE TRN-NOT-FND-COST-CTR TO GL-CURRENT-COST-CTR.        0902970
328950     IF TR-CLASS EQUAL TO '51', GO TO K2080.
329000     IF TR-CLASS EQUAL TO '50', GO TO K4900.
329050     IF TR-CLASS EQUAL TO '60' OR '61', GO TO K4400.
329100     IF TR-CLASS EQUAL TO '58' OR '59', GO TO K2200.              IM007
329110     IF TR-CLASS EQUAL TO '23'                                    IMIB004
329120         MOVE '0008'   TO TR-FM-FLD-NO                            IMIB004
329130         GO TO K5011.                                             IMIB004
329150     IF TR-CLASS EQUAL TO '78', GO TO K2400.
329160     IF TR-CLASS EQUAL TO '79', GO TO K2450.                      0902008
329161*    IF  TR-CLASS EQUAL TO '20'                                   ~~~0179
329162*    AND TR-FM-FLD-NO EQUAL '0660'                                ~~~0179
329163*        NEXT SENTENCE                                            ~~~0179
329164*    ELSE                                                         ~~~0179
329165*        GO TO K2000-CONT.                                        ~~~0179
329166*                                                                 ~~~0179
329167***************************************************************   2016628
329168* IF MAINTENANCE HAS BEEN DONE TO THE IOD-INT-RATE-PTR TODAY  *   2016628
329169* TO CHANGE IT TO A NON-ZERO VALUE, DO NOT ALLOW ANOTHER      *   2016628
329170* MAINTENANCE TO THE SAME FIELD TO RESET THE FIELD TO ZEROES. *   2016628
329171***************************************************************   2016628
329172*                                                                 ~~~0179
329173*    IF  WS-MAINT-ON-0660-TDY EQUAL 'Y'                           ~~~0179
329174*        MOVE '093' TO REJRESN                                    ~~~0179
329175*        GO TO K3165.                                             ~~~0179
329177*    IF  TR-FM-NEW-COMP-3 GREATER THAN ZERO                       ~~~0179
329178*        MOVE 'Y' TO WS-MAINT-ON-0660-TDY                         ~~~0179
329179*        GO TO K5000.                                             ~~~0179
329180*K2000-CONT.                                                      ~~~0179
329200     IF TR-CLASS EQUAL TO '20' OR '95', GO TO K5000.
329250     IF TR-CLASS EQUAL TO '02', GO TO K2800.
329300     IF TR-CLASS EQUAL TO '03', GO TO K4100.
329310     IF TR-CLASS EQUAL TO '04', GO TO K3350.                      0617360
329350     IF TR-CLASS EQUAL TO '05', GO TO K3000.
329400     IF TR-CLASS GREATER THAN '18', GO TO K2010.
329450     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
329500     IF  COMB-STMT-DEL    NOT EQUAL TO '0'                        0917821
329550         PERFORM R0070 THRU R0089.                                0917821
329600     MOVE TR-CLASS9 TO GO-TO-INDEX.
329650     SUBTRACT +5 FROM GO-TO-INDEX.
329700     GO  TO  K3700
329750           K3300
329800           K3400
329850           K3500
329900           K3450                                                  IM007
329950           K3200
330000           K3800
330050           K3900
330100           K4000
330150           K3600
330200           K3650
330250           K3750
330300           K3950
330350           DEPENDING ON GO-TO-INDEX.
330400 K2010.
330430     IF TR-CLASS EQUAL TO '96', GO TO K4250.                      9915845
330450     IF TR-CLASS EQUAL TO '97', GO TO K4200.
330500     IF TR-CLASS EQUAL TO '99'
330550         IF TR-SUB-CLASS EQUAL TO '50'
330600             GO TO K4800
330650         ELSE GO TO K4300.
330700     IF TR-CLASS GREATER THAN '51' AND LESS THAN '58' GO TO K2100.IM007
330750     IF TR-CLASS EQUAL TO '98', GO TO K4700.
330760     IF TR-CLASS EQUAL TO '29', GO TO K4350.                      0617360
330800     IF TR-CLASS EQUAL TO '25', GO TO K5800.
330810     IF TR-CLASS EQUAL TO '24', GO TO K2470.                      0427139
330850     IF TR-CLASS EQUAL TO '19', GO TO K5600.
330900 K2015.
330950     MOVE '31' TO TR-REJ-PROG.
331000     MOVE '1' TO TRAN-REWRITE-SW.                                 IM002
331010     GO TO Q4600.                                                 IM002
331050     SKIP3
331100 INCORE-SECTION-B    SECTION 20.
331150     SKIP3
331200*    ****** BANK AVAILABILITY TRANSACTION PROCESSING  ******      IM007
331250     SKIP1
331300 K2080.
331350     IF ACCT-NOT-FOUND EQUAL TO '1'
331400         MOVE '002' TO REJRESN                                    0717565
331450         GO TO K2130.
331452     IF WMS-STATUS EQUAL TO '03' OR '04'                          0446348
331454         MOVE '019' TO REJRESN                                    0717565
331456         GO TO K2120.                                             0446348
331458     IF WMS-STATUS EQUAL '08'                                     0446348
331460         MOVE '009' TO REJRESN                                    0717565
331462         GO TO K2120.                                             0446348
331500     IF WMS-BANK-AVAIL-TRLR EQUAL TO '1', GO TO K2090.            IM007
331550     MOVE '015' TO REJRESN.                                       0717565
331600     GO TO K2120.
331650 K2090.
331700     MOVE ZERO TO HOLD-AMT.                                       9916311
331750     MOVE +1 TO X.                                                IM007
331790 K2091.                                                           IM007
331830     IF  X LESS THAN +8                                           IM007
331840         ADD TR-BCA-AMT (X) TO WORK-BCA-51-AMT (X), HOLD-AMT      9916311
331910         ADD +1 TO X                                              IM007
331950         GO TO K2091.                                             IM007
331970     ADD TR-BCA-AMT (X) TO WORK-BCA-51-AMT (X).                   IM007
331990     ADD HOLD-AMT TO WMS-BANK-AVAIL-AMT DDA-BANK-AVAIL-AMT        9916311
331991                                        WS-GL-DDA-BANK-AVAIL-AMT. 0902970
332030     MOVE '1' TO BANK-AVAIL-CHANGE.                               IM007
332200     IF TR-SOURCE NOT EQUAL TO '01', GO TO Q4600.                 0447268
332250     MOVE +1 TO X.
332300 K2092.
332350     PERFORM K2170 THRU K2179.
332400     ADD +1 TO X.
332450     IF X LESS THAN +9,  GO TO K2092.                             IM007
332500     GO TO Q4500.
332550     SKIP3
332600 AVAIL-SECTION-A     SECTION 36.                                  IM007
332650     SKIP3
332700*    ***** CUSTOMER AVAILABILITY TRANSACTION PROCESSING  *****    IM007
332750     SKIP1
332800 K2100.
332850     IF ACCT-NOT-FOUND EQUAL TO '1'
332900         MOVE '002' TO REJRESN                                    0717565
332950         GO TO K2130.
332952     IF WMS-STATUS EQUAL TO '03' OR '04'                          0446348
332954         MOVE '019' TO REJRESN                                    0717565
332956         GO TO K2120.                                             0446348
332958     IF WMS-STATUS EQUAL '08'                                     0446348
332960         MOVE '009' TO REJRESN                                    0717565
332962         GO TO K2120.                                             0446348
333000     IF WMS-CUST-AVAIL-TRLR EQUAL TO '1', GO TO K2150.            IM007
333050     MOVE '015' TO REJRESN.                                       0717565
333100 K2120.
333150     IF TR-SOURCE EQUAL TO '01'
333200         MOVE TR-BANK-CUST-AVAILABLE TO EX09-REMAINDER            IM007
333250         GO TO K3165.
333300 K2130.
333350     IF TR-SOURCE NOT EQUAL TO '01'
333400         IF WBC-EXC-CODE (10) EQUAL TO '1'                        0266741
333450             MOVE '10' TO EXCODE-1
333500             PERFORM K3167 THRU K3168
333550             MOVE EX-INFO TO IMEX-INFO
333600             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT
333650             MOVE SPACES TO EX-INFO
333700             GO TO Q4500
333750         ELSE
333800             GO TO Q4500.
333850     GO TO K2120.
333900 K2150.
333920     MOVE TR-CLASS9 TO WORK-BCA-INDEX.                            IM007
333950     MOVE ZERO TO HOLD-AMT.                                       9916311
334000     MOVE +1 TO X.                                                IM007
334010     GO TO K2160  K2152  K2153  K2154                             0927817
334020           K2155  K2156  K2157                                    IM007
334030           DEPENDING ON WK-BCA-INDEX.                             IM007
334032******************************************************************IM007
334034***  LOCAL/NONLOCAL         (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334036******************************************************************IM007
334040 K2152.                                                           IM007
334050     IF  X LESS THAN +13                                          IM007
334056         ADD TR-BCA-AMT (X) TO WORK-BCA-52-AMT (X), HOLD-AMT      9916311
334060         IF  AFF-FLAG         EQUAL 'N'                           0927817
334062             ADD TR-BCA-AMT (X)  TO WFF-FLOAT-AMT (X)             0927817
334064             END-IF                                               0927817
334070         ADD +1 TO X                                              IM007
334080         GO TO K2152.                                             IM007
334085     ADD TR-BCA-AMT (X) TO WORK-BCA-52-AMT (X).                   IM007
334090     GO TO K2160.                                                 IM007
334092******************************************************************0927817
334094***  EXTENDED FLOAT - NOT REGULATION CC COMPLIANT              ***0927817
334096******************************************************************0927817
334098 K2153.                                                           0927817
334100     IF  WBC-EXTEND-FLOAT-OPT EQUAL ' ' OR '0'                    0927817
334102         MOVE '038'              TO REJRESN                       0927817
334103         GO TO K2120.                                             0927817
334104     IF  AFF-FLAG             EQUAL 'F'                           0927817
334105     AND TR-FLOAT-DAY  GREATER THAN +12                           0927817
334106         PERFORM INIT-EXT-FLOAT THRU INIT-EXT-FLOAT-EXIT.         0927817
334108     IF  TR-FLOAT-DAY         EQUAL +0                            0927817
334110         ADD TR-FLOAT-AMT        TO WORK-BCA-52-AMT (13)          0927817
334112         GO TO K2160.                                             0927817
334114     ADD TR-FLOAT-AMT            TO HOLD-AMT.                     0927817
334116     MOVE TR-FLOAT-DAY           TO X.                            0927817
334118     IF  AFF-FLAG             EQUAL 'F'                           0927817
334120         ADD TR-FLOAT-AMT        TO WORK-BCA-52-AMT (X)           0927817
334122         GO TO K2160.                                             0927817
334124     IF  X             GREATER THAN WBC-EXTEND-FLOAT-DAYS         0927817
334126         MOVE WBC-EXTEND-FLOAT-DAYS TO X.                         0927817
334128     ADD TR-FLOAT-AMT            TO WFF-FLOAT-AMT (X).            0927817
334130     IF  TR-FLOAT-AMT     NOT EQUAL ZERO                          0927817
334132     AND X             GREATER THAN AFF-MAX-ENTRY                 0927817
334134         MOVE X                  TO AFF-MAX-ENTRY                 0927817
334135                                    WFF-ENTRIES.                  0927817
334136     IF  X             GREATER THAN +12                           0927817
334138         ADD TR-FLOAT-AMT        TO WFF-TOTAL-13-99               0927817
334140         MOVE +12                TO X.                            0927817
334142     ADD TR-FLOAT-AMT            TO WORK-BCA-52-AMT (X).          0927817
334143**** UNCOMMENT TO CALL EFA ROUTINE TO PRODUCE NOTICE              0927817
334144**** REQUIRES CUSTOMIZATION TO THE USER ROUTINE                   0927817
334145**** IF  TR-FLOAT-RSN     NOT EQUAL SPACES                        0927817
334146****     MOVE '2'                TO CALL-EFAA-FLAG                0927817
334147****     GO TO K2157-CALL-PHASE.                                  0927817
334148     GO TO K2160.                                                 0927817
334150                                                                  0927817
334152******************************************************************IM007
334154***  LOW RISK 1             (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334156******************************************************************IM007
334160 K2154.                                                           IM007
334170     IF  X LESS THAN +13                                          IM007
334176         ADD TR-BCA-AMT (X) TO WORK-BCA-54-AMT (LR-DAY) HOLD-AMT  9916311
334190         ADD +1 TO X                                              IM007
334200         GO TO K2154.                                             IM007
334205     ADD TR-BCA-AMT (X) TO WORK-BCA-54-AMT (X).                   IM007
334210     GO TO K2160.                                                 IM007
334212******************************************************************IM007
334214***  LOW RISK 2             (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334216******************************************************************IM007
334220 K2155.                                                           IM007
334230     IF  X LESS THAN +13                                          IM007
334236         ADD TR-BCA-AMT (X) TO WORK-BCA-55-AMT (LR-DAY) HOLD-AMT  9916311
334250         ADD +1 TO X                                              IM007
334260         GO TO K2155.                                             IM007
334265     ADD TR-BCA-AMT (X) TO WORK-BCA-55-AMT (X).                   IM007
334270     GO TO K2160.                                                 IM007
334272******************************************************************IM007
334274***  NONPROPRIETARY ATM DEP (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334276******************************************************************IM007
334280 K2156.                                                           IM007
334290     IF  X LESS THAN +13                                          IM007
334296         ADD TR-BCA-AMT (X) TO WORK-BCA-56-AMT (X) HOLD-AMT       9916311
334310         ADD +1 TO X                                              IM007
334320         GO TO K2156.                                             IM007
334325     ADD TR-BCA-AMT (X) TO WORK-BCA-56-AMT (X).                   IM007
334330     GO TO K2160.                                                 IM007
334340 K2157.                                                           IM007
334350     MOVE '2' TO CALL-EFAA-FLAG.                                  IM007
334351     IF  TR-BCA-REASON EQUAL 'L'                                  IM007
334352         GO TO K2157-LWRSK-ITEM.                                  IM007
334353     IF  TR-BCA-REASON EQUAL 'M'                                  IM007
334354         GO TO K2157-REDEP-ITEM.                                  IM007
334355******************************************************************IM007
334356***  RSN CAUSE TO DOUBT COL (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334357******************************************************************IM007
334358 K2157-RCTDC-ITEM.                                                IM007
334359     IF  X LESS THAN +13                                          IM007
334360         ADD TR-BCA-AMT (X) TO WORK-BCA-57-RCTDC (X) HOLD-AMT     9916311
334361         ADD +1 TO X                                              IM007
334362         GO TO K2157-RCTDC-ITEM.                                  IM007
334363     ADD TR-BCA-AMT (X) TO WORK-BCA-57-RCTDC (X).                 IM007
334364     GO TO K2157-CALL-PHASE.                                      IM007
334365******************************************************************IM007
334366***  LOW RISK AT UNSTAFFED  (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334367******************************************************************IM007
334368 K2157-LWRSK-ITEM.                                                IM007
334369     IF  X LESS THAN +13                                          IM007
334370         ADD TR-BCA-AMT (X) TO WORK-BCA-57-LWRSK (1) HOLD-AMT     9916311
334371         ADD +1 TO X                                              IM007
334372         GO TO K2157-LWRSK-ITEM.                                  IM007
334373     ADD TR-BCA-AMT (X) TO WORK-BCA-57-LWRSK (X).                 IM007
334374     GO TO K2160.                                                 IM007
334375******************************************************************IM007
334376***  REDEPOSITED ITEM       (TEMPORARY SCHEDULE) PROCESSING    ***IM007
334377******************************************************************IM007
334378 K2157-REDEP-ITEM.                                                IM007
334379     IF  X LESS THAN +13                                          IM007
334380         ADD TR-BCA-AMT (X) TO WORK-BCA-57-REDEP (X) HOLD-AMT     9916311
334381         ADD +1 TO X                                              IM007
334382         GO TO K2157-REDEP-ITEM.                                  IM007
334383     ADD TR-BCA-AMT (X) TO WORK-BCA-57-REDEP (X).                 IM007
334384 K2157-CALL-PHASE.                                                IM007
334385     IF  WBC-EFA-PHASE EQUAL SPACES                               0266741
334386         GO TO K2157-CALL-PHASE-EXIT.                             0627536
334387     MOVE WBC-EFA-PHASE TO IM31-PH2.                              0266741
334388     CALL 'SILINK' USING IM31-PHASE                               IM007
334389                         MASTER-AREA                              IM007
334390                         WORK-BCA-AGGREGATES-AREA                 IM007
334391                         DDA-WRKBCR-1                             0266741
334392                         DDA-WRKBCR-5                             0266741
334393                         OD-CTR                                   IM007
334394                         NSF-CTR                                  IM007
334395                         NSF-RVRSL-CTR                            1104882
334396                         HOLD-EFA-NSF-AMT                         1104882
334397                         SEND-EFAA-NOTICE                         1104882
334398                         EXCEPTION-AREA                           1104882
334399                         EX-SEQ-CTR                               1104882
334400                         TRIAL-CONTROL                            1104882
334401                         DDA-CASH-AVAIL-AMT                       1104882
334402                         WS-GL-DDA-CASH-AVAIL-AMT                 1104882
334403                         DDA-CUST-AVAIL-AMT                       1104882
334404                         WS-GL-DDA-CUST-AVAIL-AMT                 1104882
334405                         CALL-EFAA-FLAG                           1104882
334406                         TRAN-1                                   0627536
334407                         NON-EFAA-ACCOUNT                         0927817
334408                         WFF-EXTENDED-FLOAT-REC.                  0927817
334420 K2157-CALL-PHASE-EXIT.                                           0927817
334422     EXIT.                                                        0927817
334424 K2160.                                                           0927817
334426     ADD HOLD-AMT TO WMS-CUST-AVAIL-AMT DDA-CUST-AVAIL-AMT,       0927817
334428                                        WS-GL-DDA-CUST-AVAIL-AMT. 0927817
334430     MOVE '1' TO CUST-AVAIL-CHANGE.                               0927817
334500     MOVE '1' TO CALL-EFAA-FLAG.                                  IM007
334600     IF TR-SOURCE NOT EQUAL TO '01', GO TO Q4500.
334650     MOVE +1 TO X.
334700 K2170.
334705     IF  TR-TRAN-CODE         EQUAL '53'                          0927817
334710         IF  TR-FLOAT-AMT     EQUAL ZERO                          0927817
334715             GO TO K2179                                          0927817
334720         ELSE                                                     0927817
334725             MOVE TR-FLOAT-AMT  TO EX04-AMT.                      0927817
334730     IF  TR-TRAN-CODE     NOT EQUAL '53'                          0927817
334735         IF  TR-BCA-AMT (X)   EQUAL ZERO                          0927817
334740             GO TO K2179                                          0927817
334745         ELSE                                                     0927817
334750             MOVE TR-BCA-AMT (X) TO EX04-AMT.                     0927817
334800     MOVE '05'                   TO IMEX-REC-NO.                  0927817
334850     MOVE 'B0B4'                 TO IMEX-EX-CODE.                 0927817
334950     MOVE TR-CLASS               TO EX04-TR-CODE.                 0927817
335010     MOVE SPACES                 TO EX05-TR50.                    0927817
335050     MOVE TR-BATCH               TO EX04-BATCH.                   0927817
335100     MOVE TR-SEQ                 TO EX04-SEQ.                     0927817
335110     MOVE TR-TRACE               TO EX04-TRACE.                   0927817
335150     MOVE TR-SOURCE              TO EX04-SOURCE.                  0927817
335160     PERFORM K2181 THRU K2181-EXIT.                               0927817
335200     MOVE WMS-MTD-ANALYSIS       TO EX05-ANALYSIS.                0927817
335250     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0927817
335300 K2179.  EXIT.
335350 K2180.
335360     IF  TR-CLASS             EQUAL '53'                          0927817
335370         GO TO Q4500.                                             0927817
335400     ADD +1 TO X.
335450     IF X LESS THAN +14, GO TO K2170.                             IM007
335500     GO TO Q4500.
335505 K2181.                                                           1105504
335506     IF  TR-CLASS EQUAL '53'                                      0927817
335507         MOVE TR-FLOAT-DAY      TO EX04-FIELD-9                   0927817
335508     ELSE                                                         0927817
335509         MOVE X                 TO EX04-FIELD-9.                  0927817
335510     IF  TR-CLASS EQUAL '51'                                      1105504
335515         IF  TR-FLT-REF-NO NUMERIC                                9915749
335520             MOVE TR-FLT-REF-NO TO EX05-REF-NUM                   9915749
335525         ELSE                                                     9915749
335530             MOVE ZEROES        TO EX05-REF-NUM                   9915749
335535     ELSE                                                         9915749
335540         IF  TR-BCA-REF-NO NUMERIC                                9915749
335545             MOVE TR-BCA-REF-NO TO EX05-REF-NUM                   9915749
335550         ELSE                                                     9915749
335555             MOVE ZEROES        TO EX05-REF-NUM.                  9915749
335560*                                                                 9915749
335565 K2181-EXIT.                                                      9915749
335570     EXIT.                                                        9915749
335575*                                                                 9915749
335600*    ** BANK/CUSTOMER/CASH ADJUSTMENT TRANSACTION PROCESSING **   IM007
335650*                                                                 9915749
335700 K2200.
335750     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K2280.
335800     MOVE TR-NO-AMT TO WORK-BCA-AMOUNT.                           IM007
335810     MOVE WMS-MTD-AGGR-DAYS  TO TR-MTD-AGGR-DAYS.                 9915749
335815     MOVE '1'                TO TRAN-REWRITE-SW.                  9915749
335820     IF  WBC-POST-AMT-SEQ EQUAL '1'                               0266741
335840         MULTIPLY -1 BY WORK-BCA-AMOUNT.                          IM007
335860******************************************************************IM007
335867***  FOR CALENDAR DAYS OPTION ON NON-EFAA ACCOUNTS, USE        ***IM007
335874***  OCCURRENCE 2 (ADJUSTMENTS CALCULATED WITH CALENDAR DAYS). ***IM007
335881******************************************************************IM007
335888     IF  WBC-FLOAT-FLAG EQUAL TO 'C'                              0266741
335895     AND NON-EFAA-ACCOUNT EQUAL '1'                               IM007
335902         MOVE TR-BCA-ADJUSTMENTS (2) TO WORK-BCA-ADJUSTMENTS      IM007
335920     ELSE                                                         IM007
335940         MOVE TR-BCA-ADJUSTMENTS (1) TO WORK-BCA-ADJUSTMENTS.     IM007
335950     MOVE TR-BCA-ADJUSTMENTS (2) TO WORK-TIS-ADJUSTMENTS.         1004015
335960     IF  TR-CLASS EQUAL '59'                                      IM007
335970         MULTIPLY -1 BY WORK-TIS-ADJ-AMT                          1004015
335975         MULTIPLY -1 BY WORK-TIS-ADJ-MTD                          1004015
335980         MULTIPLY -1 BY WORK-BCA-ADJ-AMT                          IM007
336000         MULTIPLY -1 BY WORK-BCA-ADJ-MTD                          IM007
336020         MULTIPLY -1 BY WORK-BCA-AMOUNT.                          IM007
336030     MOVE WORK-BCA-AMOUNT TO WORK-BCA-AMOUNT2.                    0902970
336040     IF  TR-BCA-ADJ-TYPE NOT EQUAL TO '1'                         IM007
336300         GO TO K2210.
336350     IF  WMS-BANK-AVAIL-TRLR EQUAL TO '0'                         IM007
336400         GO TO K2300.
336403     IF  WORK-BCA-ADJ-BUC LESS THAN 01                            IM007
336406         GO TO K2205.                                             IM007
336410     IF  TR-CLASS EQUAL '59'                                      IM007
336416         IF  WORK-BCA-AMOUNT2 +                                   1002484
336420             WMS-BANK-AVAIL-TR-AMT (WORK-BCA-ADJ-BUC) LESS THAN +0IM007
336430             MOVE '041' TO REJRESN                                0717565
336440             GO TO K2320.                                         IM002
336550     MOVE '1' TO BANK-AVAIL-CHANGE.                               IM007
336560     ADD WORK-BCA-AMOUNT TO                                       IM007
336570                         WMS-BANK-AVAIL-TR-AMT (WORK-BCA-ADJ-BUC) IM007
336580                         WMS-BANK-AVAIL-ADJ                       IM007
336590                         WMS-BANK-AVAIL-AMT                       IM007
336600                         DDA-BANK-AVAIL-ADJ.                      IM007
336640     ADD WORK-BCA-AMOUNT2 TO WS-GL-DDA-BANK-AVAIL-ADJ.            0902970
336750 K2205.
336760     IF  WMS-MARKET-TRLR EQUAL '1'                                IM003
336770         IF  (WMS-HISTORY-BAL-CALC EQUAL '3' OR '5')              IM003
336772         OR  (WMS-HISTORY-BAL-CALC EQUAL '0'                      IM003
336774         AND (WMS-COLL-CALC EQUAL '3' OR '5'))                    IM003
336780             SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-HST-AGGR-BAL.     IM007
336785     IF  WMS-CUST-COLL-CALC EQUAL '3' OR '5'                      IM003
336790         SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-MTD-AGGR-CUST-COLL    IM007
336793         SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-SC-AGGR-CUST-COLL.    IM007
336795     IF  WMS-SAVINGS-TRLR EQUAL '1'                               2016653
336797         IF (WMS-INT-COLL-CALC EQUAL '3' OR '5')                  9916070
336799            SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-INT-SC-AGGR-COLL.  9916070
336800     IF WMS-COLL-CALC NOT EQUAL TO '3' AND '5'
336850         GO TO K2220.
336900     SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-MTD-AGGR-COLL.            IM007
336920     IF  WBC-CAPTURE-YR NOT EQUAL TR-BCA-YR                       0266741
336940         SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-YTD-AGGR-BAL          IM007
336960     ELSE                                                         IM007
336980         SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-YTD-AGGR-BAL.         IM007
337000     SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-SC-AGGR-COLL.             IM007
337150     GO TO K2220.
337200 K2210.
337210     IF  TR-BCA-ADJ-TYPE NOT EQUAL TO '2'                         IM007
337220         GO TO K2228.                                             IM007
337250     IF WMS-CUST-AVAIL-TRLR EQUAL TO '0'                          IM007
337300         GO TO K2300.
337303     IF  WORK-BCA-ADJ-BUC LESS THAN 01                            IM007
337306         GO TO K2215.                                             IM007
337310     IF  WBC-EXTEND-FLOAT-OPT EQUAL '0' OR ' '                    0927817
337315             GO TO K2212.                                         0927817
337320**** EXTENDED FLOAT PROCESSING                                    0927817
337325     IF  AFF-FLAG             EQUAL 'F'                           0927817
337330         IF  WORK-BCA-ADJ-BUC GREATER THAN +12                    0927817
337335             PERFORM INIT-EXT-FLOAT THRU INIT-EXT-FLOAT-EXIT      0927817
337340         ELSE                                                     0927817
337345             GO TO K2212.                                         0927817
337350     IF  TR-CLASS             EQUAL '59'                          0927817
337355         IF  WFF-FLOAT-AMT (WORK-BCA-ADJ-BUC)                     0927817
337360          +  WORK-BCA-AMOUNT2  LESS THAN +0                       0927817
337365             MOVE '041'          TO REJRESN                       0927817
337370             GO TO K2320.                                         0927817
337375     IF  WORK-BCA-ADJ-BUC   GREATER THAN AFF-MAX-ENTRY            0927817
337380         MOVE WORK-BCA-ADJ-BUC   TO AFF-MAX-ENTRY                 0927817
337385                                    WFF-ENTRIES.                  0927817
337390     ADD WORK-BCA-AMOUNT TO WFF-FLOAT-AMT (WORK-BCA-ADJ-BUC).     0927817
337395     MOVE WORK-BCA-ADJ-BUC       TO X.                            0927817
337400     IF  WORK-BCA-ADJ-BUC   GREATER THAN +12                      0927817
337405         MOVE +12                TO WORK-BCA-ADJ-BUC              0927817
337410         ADD WORK-BCA-AMOUNT     TO WFF-TOTAL-13-99.              0927817
337415 K2212.                                                           0927817
337420     IF  AFF-FLAG EQUAL 'F'                                       0927817
337435     AND TR-CLASS EQUAL '59'                                      0927817
337440         IF  WORK-BCA-AMOUNT2 +                                   0927817
337445             WMS-CUST-AVAIL-FUNDS (WORK-BCA-ADJ-BUC) LESS THAN +0 0927817
337450             MOVE '041' TO REJRESN                                0927817
337455             GO TO K2320.                                         0927817
337460     MOVE '1' TO CUST-AVAIL-CHANGE.                               0927817
337470     ADD WORK-BCA-AMOUNT  TO                                      IM007
337490                          WMS-CUST-AVAIL-FUNDS (WORK-BCA-ADJ-BUC) IM007
337510                          WMS-CUST-AVAIL-ADJ                      IM007
337530                          WMS-CUST-AVAIL-AMT                      IM007
337550                          DDA-CUST-AVAIL-ADJ.                     IM007
337590     ADD WORK-BCA-AMOUNT2 TO WS-GL-DDA-CUST-AVAIL-ADJ.            0902970
337700 K2215.
337710     IF  WMS-MARKET-TRLR EQUAL '1'                                IM003
337720         IF  (WMS-HISTORY-BAL-CALC EQUAL '4' OR '6')              IM003
337722         OR  (WMS-HISTORY-BAL-CALC EQUAL '0'                      IM003
337724         AND (WMS-COLL-CALC EQUAL '4' OR '6'))                    IM003
337730             SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-HST-AGGR-BAL.     IM007
337735     IF  WMS-CUST-COLL-CALC EQUAL '4' OR '6'                      IM003
337740         SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-MTD-AGGR-CUST-COLL    IM007
337743         SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-SC-AGGR-CUST-COLL.    IM007
337745     IF  WMS-SAVINGS-TRLR EQUAL '1'                               2016653
337747         IF (WMS-INT-COLL-CALC EQUAL '4' OR '6')                  9916070
337749            SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-INT-SC-AGGR-COLL.  9916070
337750     IF WMS-COLL-CALC NOT EQUAL TO '4' AND '6'
337800         GO TO K2220.
337850     SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-MTD-AGGR-COLL.            IM007
337870     IF  WBC-CAPTURE-YR NOT EQUAL TR-BCA-YR                       0266741
337890         SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-YTD-AGGR-BAL          IM007
337910     ELSE                                                         IM007
337930         SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-YTD-AGGR-BAL.         IM007
337950     SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-SC-AGGR-COLL.             IM007
338100 K2220.
338150     IF WMS-SAVINGS-TRLR NOT EQUAL '1'
338200         GO TO K2222.                                             0902213
338204*--------------------------------------------------------------*  0902213
338208*  IF BALANCE HISTORY IS BEING USED FOR SAVINGS, CALL THE      *  0902213
338212*  ACCRUAL ROUTINE TO ADJUST ACCRUALS FOR BANK/CUST UNAVAIL.   *  0902213
338213*--------------------------------------------------------------*  0316967
338214     IF  WMS-SAV-TIER-PTR EQUAL +0                                0316967
338215         MOVE 'S'              TO BHW-TYPE                        0316967
338216     ELSE                                                         0316967
338220         MOVE 'T'              TO BHW-TYPE.                       0316967
338224     IF  BHW-SAV-FLAG EQUAL 'R' OR 'T'                            0316967
338228         PERFORM K2226-CALL-PHASE THRU K2226-EXIT                 0902213
338232         MOVE SPACE        TO BHW-TYPE                            0902213
338236         GO TO K2222.                                             0902213
338250     IF WBC-ACCRUAL-CALC EQUAL '0'                                0266741
338300         GO TO K2222.                                             0902213
338350     IF WBC-ACCRUAL-CALC EQUAL TO '1'                             0266741
338400         MOVE WMS-COLL-CALC TO CALC-FLAG
338450     ELSE
338500         MOVE WMS-NSF-CALC TO CALC-FLAG.
338550     PERFORM K2226 THRU K2226-EXIT.
338600     SUBTRACT WORK-BCA-ADJ-AMT FROM WMS-INT-AGGR-BAL.             IM007
338610     SUBTRACT WORK-TIS-ADJ-AMT FROM WMS-INT-TIS-AGGR-BAL.         1004015
338612     IF  WMS-INT-TIS-AGGR-BAL LESS THAN ZERO                      1004015
338614         MOVE ZERO TO WMS-INT-TIS-AGGR-BAL.                       1004015
338620     SUBTRACT WORK-BCA-ADJ-MTD FROM WMS-INT-MTD-AGGR.             IM007
338625 K2222.                                                           0902213
338630     IF  WMS-OD-ACCRUAL-TRLR NOT EQUAL '1'                        0902213
338635         GO TO K2225.                                             0902213
338640     MOVE WMS-OD-CALC-FLAG TO CALC-FLAG.                          0902213
338645*--------------------------------------------------------------*  0902213
338650*  IF BALANCE HISTORY IS BEING USED FOR OD ACCRUALS, CALL THE  *  0902213
338655*  ACCRUAL ROUTINE TO ADJUST ACCRUALS FOR BANK/CUST UNAVAIL.   *  0902213
338660*--------------------------------------------------------------*  0902213
338665     MOVE 'O'              TO BHW-TYPE.                           0902213
338670     IF  BHW-ODAC-FLAG EQUAL 'N'                                  0902213
338675         PERFORM K2226-CALL-PHASE THRU K2226-EXIT                 0902213
338680         MOVE SPACE        TO BHW-TYPE                            0902213
338685         GO TO K2225.                                             0902213
338690*** MAY ONLY ADJUST FOR FLOAT/UNCOLLECTED IF USING BALANCE HISTORY0902213
338695*    PERFORM K2226 THRU K2226-EXIT.                               0902213
338700 K2225.
338750     IF  WMS-IOD-RATE-PTR EQUAL +0 AND WMS-HIFI-INDICATOR EQUAL +0
338800         GO TO K2250.                                             IM007
338850     MOVE WMS-IOD-CALC TO CALC-FLAG.
338855*    IF  TR-BCA-ADJ-TYPE EQUAL TO '2'                             1004593
338860*        IF  CALC-FLAG EQUAL TO '4' OR '6'                        1004593
338865*            SUBTRACT WORK-TIS-ADJ-AMT FROM WMS-IOD-TIS-AGGR-BAL. 1004593
338870*    IF  TR-BCA-ADJ-TYPE EQUAL '1'                                1004595
338875*        IF  CALC-FLAG EQUAL TO '3' OR '5'                        1004593
338880*            SUBTRACT WORK-TIS-ADJ-AMT FROM WMS-IOD-TIS-AGGR-BAL. 1004593
338885     IF  WMS-IOD-TIS-AGGR-BAL LESS THAN ZERO                      1004015
338890         MOVE ZERO TO WMS-IOD-TIS-AGGR-BAL.                       1004015
338900     MOVE 'N' TO IOD-FLAG.
338906*--------------------------------------------------------------*  0902213
338912*  IF BALANCE HISTORY IS BEING USED FOR IOD/MMDA, CALL THE     *  0902213
338918*  ACCRUAL ROUTINE TO ADJUST ACCRUALS FOR BANK/CUST UNAVAIL.   *  0902213
338924*--------------------------------------------------------------*  0902213
338930     MOVE 'I' TO BHW-TYPE.                                        0902213
338936     IF  BHW-IOD-FLAG EQUAL 'I' OR 'M'                            0902213
338942             GO TO K2226-CALL-PHASE.                              0902213
338950 K2226.
339000     IF  TR-BCA-ADJ-TYPE EQUAL TO '2'                             IM007
339050         IF CALC-FLAG NOT EQUAL TO '4' AND '6'
339100             GO TO K2226-EXIT.
339150     IF  TR-BCA-ADJ-TYPE EQUAL '1'                                IM007
339200         IF CALC-FLAG NOT EQUAL TO '3' AND '5'
339250             GO TO K2226-EXIT.
339258 K2226-CALL-PHASE.                                                0902213
339266     IF  TR-BCA-ADJ-TYPE EQUAL '2'                                0902213
339274         MOVE 'U' TO INTEREST-ADJ-SUBCODE.                        0902213
339282     IF TR-BCA-ADJ-TYPE EQUAL '1'                                 0902213
339290         MOVE 'F' TO INTEREST-ADJ-SUBCODE.                        0902213
339300     MOVE '2' TO INTEREST-ADJUST-CODE.
339350     MOVE TR-BCA-ADJ-DATE TO HOLD-BKDT-DATE.                      IM007
339370     MULTIPLY WORK-BCA-AMOUNT BY -1 GIVING ACCRUAL-BALANCE.       IM007
339390     MOVE TR-BCA-DAYS TO ACCRUAL-DAYS                             0902213
339410                         HOLD-BKDT-DAYS.                          0902213
339500     IF  ACCRUAL-BALANCE LESS THAN ZERO
339550         MOVE -.005 TO ACCRUAL-ROUND
339600     ELSE
339650         MOVE +.005 TO ACCRUAL-ROUND.
339700     IF  BHW-TYPE EQUAL 'O'                                       0902213
339707         PERFORM X0900-TRAN-ADJUST THRU X0900-RHR-OD-EXIT         0902213
339714     ELSE                                                         0902213
339721         PERFORM ADJUST-ACCRUED-BAL-HIST THRU END-INT-ADJUST.     0902213
339728     MOVE 'N'   TO INTEREST-ADJ-SUBCODE.                          0902213
339735     MOVE SPACE TO BHW-TYPE.                                      0902213
339750     MOVE 'F' TO IOD-FLAG.
339800 K2226-EXIT.
339850     EXIT.
339852 K2227.                                                           IM007
339854     GO TO K2250.                                                 IM007
339856 K2228.                                                           IM007
339858     IF WMS-CASH-AVAIL-TRLR EQUAL TO '0'                          IM007
339860         GO TO K2300.                                             IM007
339862     IF  WORK-BCA-ADJ-BUC LESS THAN 01                            IM007
339863         GO TO K2240.                                             IM007
339864     IF  TR-CLASS EQUAL '58'                                      IM007
339865         GO TO K2230.                                             IM007
339866     IF  TR-BCA-ADJ-TYPE EQUAL '3'                                IM007
339867         IF  WORK-BCA-AMOUNT + WMS-CASH1-AVAIL (WORK-BCA-ADJ-BUC) IM007
339868             LESS THAN +0                                         IM007
339869             MOVE '041' TO REJRESN                                0717565
339870             GO TO K2320                                          IM007
339871         ELSE                                                     IM007
339872             NEXT SENTENCE                                        IM007
339873     ELSE                                                         IM007
339874         IF  WORK-BCA-AMOUNT + WMS-CASH2-AVAIL (WORK-BCA-ADJ-BUC) IM007
339875             LESS THAN +0                                         IM007
339876             MOVE '041' TO REJRESN                                0717565
339877             GO TO K2320.                                         IM007
339878 K2230.                                                           IM007
339879     IF  TR-BCA-ADJ-TYPE EQUAL TO '3'                             IM007
339880         ADD WORK-BCA-AMOUNT TO                                   IM007
339881                             WMS-CASH1-AVAIL (WORK-BCA-ADJ-BUC)   IM007
339882     ELSE                                                         IM007
339883         ADD WORK-BCA-AMOUNT TO                                   IM007
339884                             WMS-CASH2-AVAIL (WORK-BCA-ADJ-BUC).  IM007
339885     ADD WORK-BCA-AMOUNT  TO WMS-CASH-AVAIL-AMT                   IM007
339888                             DDA-CASH-AVAIL-ADJ.                  IM007
339890     ADD WORK-BCA-AMOUNT2 TO WS-GL-DDA-CASH-AVAIL-ADJ.            0902970
339892 K2240.                                                           0902970
339899     ADD WORK-BCA-ADJ-MTD TO WMS-CASH-AVAIL-MTD-AGGR.             IM007
339909     IF  WBC-CAPTURE-YR NOT EQUAL TR-BCA-YR                       0266741
339919         ADD WORK-BCA-ADJ-MTD TO WMS-CASH-AVAIL-YTD-AGGR          IM007
339929     ELSE                                                         IM007
339939         ADD WORK-BCA-ADJ-AMT TO WMS-CASH-AVAIL-YTD-AGGR.         IM007
339949     ADD WORK-BCA-ADJ-AMT TO WMS-CASH-AVAIL-CTD-AGGR.             IM007
339959 K2250.                                                           IM007
339969     MOVE '05' TO IMEX-REC-NO.                                    IM007
340000     MOVE 'B0B4' TO IMEX-EX-CODE.
340050     MOVE WORK-BCA-AMOUNT  TO EX04-AMT.                           1002484
340100     MOVE TR-CLASS TO EX04-TR-CODE.
340150     MOVE TR-SUB-CLASS TO EX04-FIELD.
340350     MOVE TR-TRAN50 TO EX05-TR50.
340370     IF TR-AMOUNT IS NUMERIC                                      IM006
340376        MOVE TR-AMOUNT    TO EX04-NEW-AMT                         IM006
340382     ELSE                                                         IM006
340388        MOVE TR-AMOUNTX   TO EX04-NEW-AMTX.                       IM006
340400     MOVE TR-BCA-ADJ-DATE  TO EX05-ORIG-DATE.                     IM007
340430     MOVE TR-BCA-ADJ-DA-WK TO EX05-ORIG-DA-WK.                    IM007
340460     MOVE TR-BCA-ADJ-HOL   TO EX05-ORIG-HOL.                      IM007
340490     MOVE TR-BCA-ADJ-TYPE  TO EX05-TYPE.                          IM007
340520     MOVE WORK-BCA-ADJ-AMT TO EX05-ADJ-AMT.                       IM007
340600     MOVE TR-BCA-ADJ-REF-NO TO EX05-REF-NUM.                      9915749
340650     MOVE WMS-MTD-ANALYSIS TO EX05-ANALYSIS.
340652     MOVE WMS-DATE-LAST-MAINT    TO  EX05-DATE-LAST-MAINT.        0266748
340700     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
340750     GO TO Q4500.
340800 K2280.
340850     MOVE '002' TO REJRESN.                                       0717565
340900     GO TO K2320.
340950 K2300.
341000     MOVE '015' TO REJRESN.                                       0717565
341050 K2320.
341100     MOVE '10' TO EXCODE-1.                                       0827824
341150     MOVE TR-BANK-CUST-AVAILABLE TO EX09-REMAINDER.               IM007
341200     GO TO K3167.
341250     SKIP3
341300 ROOT-SECTION-P      SECTION 1.
341350     SKIP3
341400*    ********  STOP/HOLD TRANSACTION PROCESSING  ***********
341450     SKIP1
341500 K2400.
341510     IF WMS-STATUS EQUAL '04', GO TO K2410.                       IMIB60
341550     IF ACCT-NOT-FOUND EQUAL TO '0', GO TO K2420.
341600 K2410.
341650     MOVE '1' TO SH-REJ-FLAG.
341700     MOVE '002' TO REJRESN.                                       0717565
341750     MOVE 'I' TO EX03-RESN.
341800 K2415.
341850     MOVE '03' TO RECNO.
341900     IF TR-SH-NEW EQUAL TO '1' OR '3'
341950         MOVE 'E1' TO EXCODE-1
342000     ELSE MOVE 'E0' TO EXCODE-1.
342050     GO TO UNPOST-EXCEPT.
342100 K2420.
342150     IF TR-SH-NEW EQUAL TO '2' OR '3'
342160     AND WBC-DLCA-FLAG EQUAL '0'                                  0266741
342200         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
342210     ADD TR-CUST-UNAVAIL-HOLDS TO WMS-NB-CST-UNAV-HLD.            9915749
342220     ADD TR-OTHER-HOLDS        TO WMS-NB-OTH-HLD.                 9915749
342250     ADD TR-HOLD-AMT TO WMS-HOLD-AMT.
342270     ADD TR-HOLD-NO TO WMS-HOLD-NO.                               IM003
342300     ADD TR-STOP-NO TO WMS-STOP-PAYS.
342320     ADD TR-DROP-AMT TO WMS-DROP-HOLD-AMOUNT.                     IM005
342350     GO TO Q4600.
342355                                                                  0902008
342360*    ********  STOP/HOLD HOLD ALL FUNDS FLAG     ***********      0902008
342365                                                                  0902008
342370 K2450.                                                           0902008
342372     IF WMS-STATUS EQUAL '04', GO TO Q4600.                       IMIB60
342375     IF ACCT-NOT-FOUND NOT EQUAL TO '0', GO TO Q4600.             0902008
342380 K2460.                                                           0902008
342385     MOVE TR-ALL-FUNDS-FLAG      TO WMS-HOLD-ALL-FUNDS-FLAG.      0902008
342390     GO TO Q4600.                                                 0902008
342400     SKIP3
342450 LIST-POST-SECT-A    SECTION 22.
342451                                                                  0427139
342452*    ********  PASSBOOK PROCESSING               ***********      0427139
342453                                                                  0427139
342454 K2470.                                                           0427139
342455     IF  ACCT-NOT-FOUND EQUAL TO '1', GO TO K2480.                0427139
342456     IF  WMS-PASSBOOK-ACCT NOT EQUAL TO '1', GO TO Q4600.         0427139
342459     IF  TR-PSBK-DATE GREATER THAN WMS-PASSBOOK-DATE              0427139
342460         MOVE WMS-PASSBOOK-DATE TO EX15-MST-OLD-DATA              0427139
342461         MOVE '1' TO FM-TODAY                                     0427139
342462         ADD +1 TO DDA-MAINT-ACC, WS-GL-DDA-MAINT-ACC             0427139
342463         MOVE '15' TO IMEX-REC-NO                                 0427139
342464         MOVE 'B0' TO IMEX-CODE-1                                 0427139
342465         MOVE 'B1' TO IMEX-CODE-2                                 0427139
342466         MOVE '18670208708DS C   ' TO PB-EXC15-FM-FIELD           0427139
342467         MOVE PSBK-DATE-LIT(SIWS-LANG-SUB) TO PB-EXC15-FM-DESC    0427139
342468         MOVE TR-PSBK-DATE TO PB-EXC15-NEW-FM-DATE                0427139
342469         MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT         0427139
342470         MOVE PB-EXC15-FM-TRAN TO EX15-FM-TRAN                    0427139
342471         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  0427139
342472         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT             0427139
342473         MOVE TR-PSBK-DATE TO WMS-PASSBOOK-DATE.                  0427139
342474     IF  TR-PSBK-BAL-CHG EQUAL '0' OR '1' OR '2'                  0427139
342475         MOVE WMS-PASSBOOK-BALANCE TO PB-EXC15-MASTER-DATA        0427139
342476         MOVE PB-EXC15-MST-OLD-DATA TO EX15-MST-OLD-DATA          0427139
342477         MOVE '1' TO FM-TODAY                                     0427139
342478         ADD +1 TO DDA-MAINT-ACC, WS-GL-DDA-MAINT-ACC             0427139
342479         MOVE '15' TO IMEX-REC-NO                                 0427139
342480         MOVE 'B0' TO IMEX-CODE-1                                 0427139
342481         MOVE 'B1' TO IMEX-CODE-2.                                0427139
342482     IF  TR-PSBK-BAL-CHG EQUAL '0'                                0427139
342483         MOVE TR-PSBK-AMOUNT TO WMS-PASSBOOK-BALANCE              0427139
342484     ELSE                                                         0427139
342485         IF  TR-PSBK-BAL-CHG EQUAL '1'                            0427139
342486             ADD TR-PSBK-AMOUNT TO WMS-PASSBOOK-BALANCE           0427139
342487         ELSE                                                     0427139
342488             IF TR-PSBK-BAL-CHG EQUAL '2'                         0427139
342489                SUBTRACT TR-PSBK-AMOUNT FROM WMS-PASSBOOK-BALANCE.0427139
342490     IF  TR-PSBK-BAL-CHG EQUAL '0' OR '1' OR '2'                  0427139
342491         MOVE WMS-PASSBOOK-BALANCE TO PB-EXC15-NEW-FM-DATA        0427139
342492         MOVE '18660207908P  C   ' TO PB-EXC15-FM-FIELD           0427139
342493         MOVE PSBK-BAL-LIT(SIWS-LANG-SUB) TO PB-EXC15-FM-DESC     0427139
342494         MOVE PB-EXC15-FM-TRAN TO EX15-FM-TRAN                    0427139
342495         MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT         0427139
342496         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  0427139
342497         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.            0427139
342498     IF  WMS-ACCT-NO EQUAL WK-PSBK-ACCT-NO, GO TO Q4600.          0427139
342499     MOVE WMS-ACCT-NO TO WK-PSBK-ACCT-NO.                         0427139
342500     IF  TR-SOURCE-ORIGIN EQUAL 'TL'                              0427139
342501         MOVE '07'             TO IMEX-REC-NO                     0427139
342502         MOVE 'PB'             TO IMEX-CODE-1                     0427139
342503         MOVE PSBK-REC-07      TO EX07-PSBK-DATA                  0427139
342504         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  0427139
342505         GO TO Q4500.                                             0427139
342506     GO TO Q4500.                                                 0427139
342507 K2480.                                                           0427139
342508     MOVE '31' TO TR-REJ-PROG.                                    0427139
342509     MOVE '1' TO TRAN-REWRITE-SW.                                 0427139
342510     GO TO Q4600.                                                 0427139
342520     SKIP3                                                        0427139
342550*    ******  LIST-POST HEADER TRANSACTION PROCESSING  ******
342600     SKIP1
342650 K2500.
342700     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K2570.
342710***  LIST POST CHECK/DEBIT HEADER PROCESSING                      0827768
342720***  IF LIST POST CHECKS ONLY (NOT DR) ADJUST NUMBER AND AMOUNT   0827768
342730***  AND COMPARE ONLY CHECKS AGAINST BCR MINIMUM NUMBER TO LP     0827768
342740     IF  TR-POST-PRIORITY     EQUAL '3A'                          0827768
342750         IF  (WMS-LIST-POST   EQUAL '0' OR '2' OR '5')            0827768
342760             GO TO K2570                                          0827768
342770         ELSE                                                     0827768
342780         IF  WMS-LIST-POST    EQUAL '1' OR '3'                    0827768
342790             MOVE TR-LP-TOT-NO-CHK   TO TR-LP-TOT-NO              0827768
342800             MOVE TR-LP-TOT-AMT-CHK  TO TR-LP-TOT-AMT             0827768
342810             IF  TR-LP-TOT-NO LESS THAN WBC-LIST-POST-NO          0827768
342820                 GO TO K2570.                                     0827768
342850                                                                  0827768
342900***  LIST POST DEPOSIT/CREDIT HEADER PROCESSING                   0827768
342910***  IF LIST POST DEPOSITS ONLY (NOT CR), ADJUST NUMBER AND AMOUNT0827768
342920***  AND COMPARE ONLY DEPOSITS AGAINST BCR MINIMUM NUMBER TO LP   0827768
342930     IF  TR-POST-PRIORITY     EQUAL '0A'                          0827768
342940         IF  (WMS-LIST-POST   EQUAL '0' OR '1' OR '4')            0827768
342950             GO TO K2570                                          0827768
342960         ELSE                                                     0827768
342970         IF  WMS-LIST-POST    EQUAL '2' OR '3'                    0827768
342980             MOVE TR-LP-TOT-NO-DEP   TO TR-LP-TOT-NO-CR           0827768
342990             MOVE TR-LP-TOT-AMT-DEP  TO TR-LP-TOT-AMT-CR          0827768
343000             IF  TR-LP-TOT-NO-CR   LESS THAN WBC-LIST-POST-NO     0827768
343010                 GO TO K2570.                                     0827768
343020                                                                  0827768
343050     IF WMS-STATUS EQUAL TO '00', GO TO K2580.
343100     IF  WMS-STATUS EQUAL '02'
343150     AND TR-POST-PRIORITY EQUAL '0A'
343200         GO TO K2580.
343250 K2570.
343300     MOVE '31' TO TR-REJ-PROG.
343350     MOVE '1' TO TRAN-REWRITE-SW.                                 IM002
343360     GO TO Q4600.                                                 IM002
343370 K2580.                                                           1105504
343401      IF  TR-POST-PRIORITY     NOT EQUAL '3A'                     IM007
343402          GO  TO  K2581.                                          IM007
343403* **************************************************************  IM007
343404*  DETERMINE IF TAX SHOULD BE ASSESSED ON WITHDRAWALS          *  IM007
343405* **************************************************************  IM007
343406      IF  SAV-BKUP-WTHLD-FLAG EQUAL '2' OR '3'                    IM007
343410          NEXT SENTENCE                                           IM007
343414      ELSE                                                        IM007
343418          GO TO K2581.                                            IM007
343422      MOVE +0 TO TAX-CALC-AMOUNT.                                 IM007
343423      MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.       2012254
343426      IF  WMS-IOD-PEND-TAX GREATER THAN +0                        IM007
343430          IF  WMS-IOD-PEND-TAX GREATER THAN TR-LP-TOT-AMT         IM007
343432              MOVE TR-LP-TOT-AMT TO TAX-CALC-AMOUNT               IM007
343438              PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT IM007
343442              SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX      IM007
343446          ELSE                                                    IM007
343450              MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT            IM007
343454              PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT IM007
343458              SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX.     IM007
343462      IF  WMS-SAVINGS-TRLR EQUAL '0'                              IM007
343466          GO TO K2581.                                            IM007
343470*----------------------------------------------------------------*IM007
343473*    TOTAL TAX WITHHELD CANNOT EXCEED THE TRANSACTION AMOUNT     *IM007
343476*----------------------------------------------------------------*IM007
343482     COMPUTE AMT-AVAIL = TR-LP-TOT-AMT - TAX-CALC-AMOUNT.         IM007
343486     IF  (AMT-AVAIL GREATER THAN +0                               IM007
343490     AND WMS-SAV-PEND-TAX GREATER THAN +0)                        IM007
343494         IF  WMS-SAV-PEND-TAX GREATER THAN AMT-AVAIL              IM007
343498             MOVE AMT-AVAIL TO TAX-CALC-AMOUNT                    IM007
343502             PERFORM K0053-SAV-TAX-GT  THRU K0053-SAV-TAX-GT-EXIT IM007
343506             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
343510         ELSE                                                     IM007
343514             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
343518             PERFORM K0053-SAV-TAX-GT  THRU K0053-SAV-TAX-GT-EXIT IM007
343522             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX.      IM007
343526 K2581.                                                           IM007
343530     MOVE WBC-GENERATED-TRANS (2) TO GEN-TRAN-OPTION-HOLD.        0266741
343534     IF  NSF-CALC-FLAG EQUAL '0'                                  IM007
343550         PERFORM K0100 THRU K0105.
343560     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
343570         PERFORM K0106 THRU K0106-EXIT.                           IM003
343600     IF  TR-POST-PRIORITY EQUAL '0A'
343650         GO TO K2700-POST-CR.
343651*                                                                 9915749
343652*    CALCULATE BATCH RUN BALANCE                                 *9915749
343653*                                                                 9915749
343654     IF  WS-FIRST-DEBIT EQUAL 'N'                                 9915749
343656         MOVE CUR-BAL TO BATCH-RUN-BALANCE  BATCH-RUN-OD          0437237
343658         MOVE ZERO    TO BATCH-OD-LIMIT                           0437237
343660         IF  SAVINGS-PRESENT EQUAL '1'                            9915749
343662             ADD WMS-INT-CUR-BAL TO BATCH-RUN-BALANCE             9915749
343664                                    BATCH-RUN-OD.                 9915749
343665     IF  WS-FIRST-DEBIT EQUAL 'N'                                 0930077
343666         COMPUTE BATCH-RUN-FDIC  =  BATCH-RUN-BALANCE             0930077
343667                                 +  WMS-PROV-HOLD-AMT             0930077
343668         MOVE 'Y'                TO WS-FIRST-DEBIT                9915749
343670         IF  WMS-OD-LIMIT GREATER THAN '0'                        9915749
343672             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-RUN-OD    0437237
343674             ADD WBC-OD-LIMIT (WMS-OD-LIMIT-9) TO BATCH-OD-LIMIT  0437237
343676         ELSE                                                     9915749
343678             IF  WMS-OD-LIMIT EQUAL 'S' OR 'L' OR '0'             9915749
343680                 IF  WMS-OD-LIMIT-AMT GREATER THAN +0             9915749
343682                     ADD WMS-OD-LIMIT-AMT TO BATCH-RUN-OD         0437237
343684                     ADD WMS-OD-LIMIT-AMT TO BATCH-OD-LIMIT       0437237
343686                 ELSE                                             9915749
343688                     MOVE +0.00  TO BATCH-RUN-OD                  9915749
343690             ELSE                                                 9915749
343692                 MOVE +0.00      TO BATCH-RUN-OD.                 9915749
343694*                                                                 9915749
343700     MOVE TR-LP-DB-AMT TO HOLD-AMT11.
343750     MOVE ZERO TO AMT-AVAIL
343800                  HOLD-AMT
343850                  SAVE-AMT.
343900     IF SAVINGS-PRESENT EQUAL TO '0'
343950         GO TO K2582.
344000     SUBTRACT TR-LP-SAV-DR-AMT FROM WMS-INT-CUR-BAL
344050         GIVING SAVE-AMT.
344100     IF SAVE-AMT LESS THAN ZERO
344150         SUBTRACT SAVE-AMT FROM HOLD-AMT11
344200     ELSE
344250         ADD SAVE-AMT TO AMT-AVAIL.
344300 K2582.
344302*----------------------------------------------------------------*9915749
344304*    USE BATCH-RUN-BAL TO DETERMINE WHICH TRANSACTION POST       *9915749
344306*    WITHOUT EXCEPTIONS.                                         *9915749
344308*----------------------------------------------------------------*9915749
344309     MOVE 'N' TO BATCH-RUN-BAL-OD-UPDATED.                        9916451
344310     IF  CUR-BAL NOT LESS THAN TR-LP-TOT-AMT                      9915749
344312         IF  BATCH-RUN-BALANCE NOT LESS THAN TR-LP-TOT-AMT        9915749
344314             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9915749
344320             GO TO K2700-POST.                                    9915749
344322     IF  BATCH-RUN-BALANCE NOT LESS THAN TR-LP-TOT-AMT            9915749
344324         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
344330         GO TO K2583.                                             9915749
344332     IF  FUNDING-AMT GREATER THAN WS-FUNDING-USED                 9915749
344334         IF  TR-LP-TOT-AMT NOT GREATER THAN                       9915749
344336            (FUNDING-AMT - WS-FUNDING-USED)                       9915749
344338             PERFORM X0770-REP-FUNDING THRU X0770-EXIT            9915749
344350             GO TO K2700-POST.                                    9915749
344360                                                                  9915749
344370 K2583.                                                           9915749
344400     IF LOAN-PRESENT EQUAL TO '0'
344450         MOVE '1' TO NO-LOAN
344500         GO TO K2584.
344550     SUBTRACT TR-LP-LOAN-DB-AMT FROM TR-LP-LOAN-CR-AMT
344600         GIVING HOLD-AMT.
344650     ADD WMS-AVAIL-BAL TO HOLD-AMT.
344700     IF HOLD-AMT LESS THAN ZERO
344750         MOVE '1' TO NO-LOAN
344800     ELSE
344850         MOVE '0' TO NO-LOAN
344900         ADD HOLD-AMT TO AMT-AVAIL.
344950 K2584.
345000     ADD CUR-BAL TO AMT-AVAIL.
345050     IF AMT-AVAIL LESS THAN HOLD-AMT11
345100         IF NO-LOAN EQUAL TO '1'
345150             GO TO K2680
345200         ELSE
345250             GO TO K2586.
345300     IF SAVINGS-OR-LOAN EQUAL TO '1' OR '2'
345350         GO TO K2630.
345400     IF NO-LOAN EQUAL TO '1'
345450         GO TO K2632.
345500     IF CUR-BAL + HOLD-AMT LESS THAN HOLD-AMT11
345520         PERFORM K1730 THRU K1730-EXIT                            2015844
345550         ADD HOLD-AMT TO CUR-BAL LOAN-TODAY WMS-PRIN-BAL CUST-BAL IM003
345560         ADD HOLD-AMT TO BATCH-RUN-BALANCE, BATCH-RUN-OD          2016677
345565         ADD HOLD-AMT TO BATCH-RUN-FDIC                           0930077
345600         GO TO K2632.
345650     GO TO K2640.
345700 K2586.
345710     IF WMS-LOAN-BAD-ACCT GREATER THAN '0', GO TO K2590.          IM004
345720     IF WMS-OVERLIM-INCR EQUAL '2'                                IM004
345730         SUBTRACT AMT-AVAIL FROM HOLD-AMT11 GIVING HOLD-AMT9      IM004
345740         GO TO K2660.                                             IM004
345750     IF OVRLIM-FLAG EQUAL TO '1', GO TO K2590.
345800     IF WBC-OVRLIM-INCR EQUAL TO '0'                              0266741
345850         IF WMS-OVERLIM-INCR EQUAL TO '0'
345900             GO TO K2590.
345950     IF WMS-OVERLIMIT GREATER THAN '0', GO TO K2590.
346000     IF OVER-LINE EQUAL TO '1', GO TO K2590.
346100     IF AMT-AVAIL + HOLD-INCRM LESS THAN HOLD-AMT11
346150         GO TO K2680.
346200     MOVE '1' TO OVRLIM-FLAG.
346250     IF SAVINGS-PRESENT EQUAL TO '1'
346300         ADD SAVE-AMT TO CUR-BAL TRANSFER-AMT
346350         SUBTRACT SAVE-AMT FROM WMS-INT-CUR-BAL
346400         IF SAVE-AMT LESS THAN ZERO
346450            ADD SAVE-AMT TO HOLD-AMT11.
346500     GO TO K2650.
346550 K2590.
346600     IF GT-OPTION (2) GREATER THAN '3', GO TO K2620.
346650     IF GT-OPTION (2) GREATER THAN '1', GO TO K2595.
346700         GO TO K2680.
346750 K2595.
346800*  --FORCE OVERLINE BY INCREMENTS
346850     GO TO K2650.
346900 K2620.
346950*  --FORCE OVERLINE BY AMOUNT REQUIRED
347000     GO TO K2670.
347050 K2630.
347100     IF SAVE-AMT LESS THAN ZERO
347150         ADD SAVE-AMT TO CUR-BAL TRANSFER-AMT
347200         SUBTRACT SAVE-AMT FROM WMS-INT-CUR-BAL HOLD-AMT11
347250         MOVE ZERO TO SAVE-AMT
347300         GO TO K2640.
347350     IF CUR-BAL + SAVE-AMT NOT LESS THAN HOLD-AMT11
347400         GO TO K2632.
347450     ADD SAVE-AMT TO CUR-BAL TRANSFER-AMT.
347500     SUBTRACT SAVE-AMT FROM WMS-INT-CUR-BAL.
347550     GO TO K2640.
347600 K2632.
347650     IF  SAVINGS-PRESENT EQUAL '0'
347700         GO TO K2700-POST.
347750     IF WMS-INT-INCREMNT  GREATER THAN ZERO
347800         IF HOLD-SAV-INCR GREATER THAN ZERO
347850             GO TO K2634.
347900     SUBTRACT CUR-BAL SAVE-AMT FROM HOLD-AMT11 GIVING HOLD-AMT9.
347950     ADD HOLD-AMT9 TO CUR-BAL TRANSFER-AMT.
348000     SUBTRACT HOLD-AMT9 FROM WMS-INT-CUR-BAL.
348050     GO TO K2700-POST.
348100 K2634.
348150     SUBTRACT CUR-BAL FROM HOLD-AMT11 GIVING HOLD-AMT9.
348200     DIVIDE HOLD-SAV-INCR INTO HOLD-AMT9 GIVING HOLD-DIVIDEND
348250         REMAINDER HOLD-REMAINDER.
348300     IF HOLD-REMAINDER NOT EQUAL ZERO,
348350         ADD +1 TO HOLD-DIVIDEND.
348400     MULTIPLY HOLD-SAV-INCR BY HOLD-DIVIDEND GIVING HOLD-AMT9.
348450     IF SAVE-AMT LESS THAN HOLD-AMT9,
348500         MOVE SAVE-AMT TO HOLD-AMT9.
348550     SUBTRACT HOLD-AMT9 FROM WMS-INT-CUR-BAL.
348600     ADD HOLD-AMT9 TO CUR-BAL, TRANSFER-AMT.
348650     GO TO K2700-POST.
348700 K2640.
348750     IF  GT-OPTION (3) EQUAL '2' OR '6'                           IM003
348760         GO TO K2670.                                             IM003
348800 K2650.
348850     SUBTRACT CUR-BAL FROM HOLD-AMT11 GIVING HOLD-AMT9.
348860     IF HOLD-INCRM GREATER THAN ZERO                              1003979
348900         DIVIDE HOLD-INCRM INTO HOLD-AMT9 GIVING HOLD-DIVIDEND    1003979
348950             REMAINDER HOLD-REMAINDER                             1003979
348960     ELSE                                                         1003979
348970         MOVE ZEROES TO HOLD-DIVIDEND HOLD-REMAINDER.             1003979
349000     IF HOLD-REMAINDER NOT EQUAL ZERO,
349050         ADD +1 TO HOLD-DIVIDEND.
349100     MULTIPLY HOLD-INCRM BY HOLD-DIVIDEND GIVING HOLD-AMT9.
349150     IF HOLD-AMT LESS THAN HOLD-AMT9,
349200         MOVE HOLD-AMT TO HOLD-AMT9.
349220 K2660.                                                           IM004
349230     PERFORM K1730 THRU K1730-EXIT.                               2015844
349250     ADD HOLD-AMT9 TO CUR-BAL, WMS-PRIN-BAL, LOAN-TODAY, CUST-BAL.IM003
349260     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
349265     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
349300     GO TO K2700-POST.
349350 K2670.
349400     SUBTRACT CUR-BAL FROM HOLD-AMT11 GIVING HOLD-AMT9.
349450 K2675.
349460     PERFORM K1730 THRU K1730-EXIT.                               2015844
349500     ADD HOLD-AMT9 TO CUR-BAL, WMS-PRIN-BAL, LOAN-TODAY, CUST-BAL.IM003
349510     ADD HOLD-AMT9 TO BATCH-RUN-BALANCE, BATCH-RUN-OD.            2016677
349515     ADD HOLD-AMT9 TO BATCH-RUN-FDIC.                             0930077
349550     GO TO K2700-POST.
349600 K2680.
349602*----------------------------------------------------------------*0927850
349604*    FORCE POST ACCOUNT OPTION IS NOT VALID IF UNDER FDIC CONTROL*0927850
349606*----------------------------------------------------------------*0927850
349608     IF WMS-FORCE-POST EQUAL 'Y'                                  0927850
349610        IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                            0927850
349612        AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                  0927850
349614            NEXT SENTENCE                                         0927850
349616        ELSE                                                      0927850
349618            GO TO K2690-OD.                                       0927850
349650     IF  GT-OPTION (2) EQUAL '1' OR '3' OR '5'
349700         GO TO K2690-OD.
349750     IF  WBC-LIST-POST-OD EQUAL '0'                               0266741
349800         GO TO K2570.
349802*----------------------------------------------------------------*0927850
349804*    PAY ALL IS TREATED AS PAY NONE IF UNDER FDIC CONTROL        *0927850
349806*----------------------------------------------------------------*0927850
349808     IF  WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
349810         IF  WMS-PROV-HOLD-AMT GREATER THAN ZERO                  0927850
349812             IF  WMS-OD-LIMIT EQUAL 'A'                           0927850
349814                 GO TO K2570.                                     0927850
349850     IF  WMS-OD-LIMIT EQUAL 'A'
349900         GO TO K2690-OD.
349902                                                                  0927850
349904 K2681.                                                           0927850
349950     IF  WMS-OD-LIMIT EQUAL 'N'
350000         GO TO K2570.
350050     PERFORM K0210 THRU K0212.
350100     IF  SAVINGS-PRESENT EQUAL '1'
350150         ADD SAVE-AMT TO HOLD-AMT.
350152*----------------------------------------------------------------*9915749
350154*    INCLUDE BATCH-RUN-OD VALUE IN THE OD DECISION.  CHECK       *9915749
350156*    BATCH-RUN-BALANCE BEFORE UNPOSTING.                         *9915749
350158*----------------------------------------------------------------*9915749
350160     IF  WMS-OD-LIMIT EQUAL 'L'                                   9915749
350162         IF  HOLD-AMT11 NOT GREATER THAN BATCH-RUN-OD             9915749
350166             PERFORM K0290-LOC-FEE THRU K0290-LOC-FEE-EXIT        9915749
350168             SUBTRACT HOLD-AMT11 FROM BATCH-RUN-OD                9915749
350169             SUBTRACT HOLD-AMT11 FROM BATCH-RUN-FDIC              0930077
350170             MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                 9916451
350172             GO TO K2700-POST.                                    9915749
350182     IF  HOLD-AMT11 NOT GREATER THAN BATCH-RUN-OD                 9915749
350184         SUBTRACT HOLD-AMT11 FROM BATCH-RUN-OD                    9915749
350185         SUBTRACT HOLD-AMT11 FROM BATCH-RUN-FDIC                  0930077
350186         MOVE +0.00 TO BATCH-RUN-BALANCE                          9915749
350187         MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                     9916451
350188         GO TO K2690-OD.                                          1105504
350190     IF  HOLD-AMT11 NOT GREATER THAN BATCH-RUN-BALANCE            9915749
350192         PERFORM X0770-REP-FUNDING THRU X0770-EXIT                9915749
350194         SUBTRACT HOLD-AMT11 FROM BATCH-RUN-BALANCE               9915749
350200         SUBTRACT HOLD-AMT11 FROM BATCH-RUN-OD                    9915749
350201         SUBTRACT HOLD-AMT11 FROM BATCH-RUN-FDIC                  0930077
350205         MOVE 'Y' TO BATCH-RUN-BAL-OD-UPDATED                     9916451
350250         GO TO K2700-POST.                                        9915749
350300     GO TO K2570.
350350 K2690-OD.
350400     IF WMS-SAV-PTR EQUAL TO ZERO                                 IM004
350402     AND WMS-SAVINGS-TRLR EQUAL '0'                               IM004
350404     AND WMS-CHG-CARD-FLG EQUAL '0'                               IM004
350406         GO TO K2695.                                             IM004
350408     MOVE SPACES TO IMEX-REC-13.                                  IM004
350410     MOVE '13' TO IMEX-REC-NO.                                    IM004
350412     IF  WMS-SAV-PTR NOT EQUAL TO ZERO                            IM004
350414         MOVE 'LE' TO IMEX-CODE-1                                 IM004
350416     ELSE                                                         IM004
350418         IF  WMS-SAVINGS-TRLR EQUAL '1'                           IM004
350420             MOVE 'LF' TO IMEX-CODE-1                             IM004
350422         ELSE                                                     IM004
350424             MOVE 'LH' TO IMEX-CODE-1.                            IM004
350426     MOVE ZERO TO EX13-BATCH, EX13-SEQ.                           IM004
350428     MOVE TR-LP-TOT-AMT TO EX13-AMT.                              IM004
350430     MOVE '02' TO EX13-UCODE1.                                    IM004
350432     MOVE GT-USER-CODE TO EX13-UCODE2.                            IM004
350434     MOVE '4' TO EX13-TYPE.                                       IM004
350436     MOVE '02' TO EX13-TR-TYPE.                                   IM005
350438     MOVE TR-LP-TOT-NO TO EX13-ITEM-CNT.                          IM004
350439     MOVE ZERO TO EXC13-02-ITEM-COUNT EXC13-02-REF-NO.            0326987
350440     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.              IM004
350442     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     IM004
350444 K2695.                                                           IM004
350450     IF  SAVINGS-PRESENT EQUAL '1'
350500         ADD SAVE-AMT TO CUR-BAL
350550                         TRANSFER-AMT
350600         SUBTRACT SAVE-AMT FROM WMS-INT-CUR-BAL.
350650     IF  WMS-SAV-PTR EQUAL ZERO
350670     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
350700         ADD +1 TO WMS-SC-OD-ITEMS
350750                   WMS-MTD-OD-ITEMS.
350800     MOVE '1' TO OD-TODAY.
350850     MOVE '1' TO WMS-OD-TODAY.
350854     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
350855     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0930077
350856     AND (CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-LP-TOT-AMT)       0930077
350858         IF  BATCH-RUN-FDIC NOT LESS THAN TR-LP-TOT-AMT           0930077
350860         AND BATCH-RUN-BAL-OD-UPDATED EQUAL 'N'                   0930077
350862             MOVE '1' TO FDIC-CAUSED-OD                           0930077
350864             ADD +1 TO OD-CTR-FDIC                                0930077
350865         ELSE                                                     0930077
350868         IF  (BATCH-RUN-FDIC NOT LESS THAN ZERO)                  0930077
350870         AND BATCH-RUN-BAL-OD-UPDATED EQUAL 'Y'                   0930077
350872             MOVE '1' TO FDIC-CAUSED-OD                           0930077
350874             ADD +1 TO OD-CTR-FDIC.                               0930077
350876     IF  WMS-OD-CHG-CODE EQUAL '2'                                1020109
350878         ADD +1 TO OD-CTR                                         1020109
350880         GO TO K2696.                                             1020109
350900     IF  CUR-BAL + WMS-OD-MIN-AMT LESS THAN TR-LP-TOT-AMT
350950         ADD +1 TO OD-CTR
351000     ELSE
351050         IF  WMS-OD-CHG-CODE EQUAL '1'
351052             MOVE '0' TO FDIC-CAUSED-OD                           0930077
351100             GO TO K2700-POST.
351102                                                                  1020109
351104 K2696.                                                           1020109
351150     MOVE SPACES TO IMEX-REC-13.
351200     MOVE '13' TO IMEX-REC-NO.
351250     MOVE 'H2' TO IMEX-CODE-1.
351252     IF (WBC-FDIC-CTL-OPT EQUAL 'Y'                               0927850
351254     AND WMS-PROV-HOLD-AMT GREATER THAN ZERO)                     0927850
351256         IF  FDIC-CAUSED-OD EQUAL '1'                             0930077
351257             MOVE '0' TO FDIC-CAUSED-OD                           0930077
351258             MOVE 'HP' TO IMEX-CODE-1.                            0927850
351260*----------------------------------------------------------------*9915749
351262*    SET EXCEPTION CODE TWO IF THE ACCOUNT HAS A LINE-OF-CREDIT. *9915749
351264*    THIS EXCEPTION CAN BE USED TO GENERATE NOTICES.             *9915749
351266*    MOVE 'P' TO EX13-NB-PEND-DEC-IND FOR ALL ODS EXCEPT LOC     *9915749
351268*----------------------------------------------------------------*9915749
351270     IF  WMS-OD-LIMIT EQUAL TO 'L'                                9915749
351272         MOVE 'HU' TO IMEX-CODE-2                                 9915749
351274     ELSE                                                         9915749
351276         MOVE 'P'  TO EX13-NB-PEND-DEC-IND.                       9915749
351278*                                                                 9915749
351280     IF  WMS-FORCE-POST EQUAL 'Y'                                 0827769
351282         MOVE ' '  TO EX13-NB-PEND-DEC-IND.                       0827769
351300     MOVE '073' TO TR-REJ-RESN.                                   0817735
351350     MOVE '1' TO TRAN-REWRITE-SW.
351400     MOVE ZERO TO EX13-BATCH
351450                  EX13-SEQ.
351500     MOVE TR-LP-TOT-AMT TO EX13-AMT.
351550     MOVE '02' TO EX13-UCODE1.
351600     MOVE GT-USER-CODE TO EX13-UCODE2.
351650     MOVE '4' TO EX13-TYPE.
351700     MOVE '02' TO EX13-TR-TYPE.                                   IM005
351750     MOVE TR-LP-TOT-NO TO EX13-ITEM-CNT.
351760     MOVE ZERO TO EXC13-02-ITEM-COUNT EXC13-02-REF-NO.            0326987
351800     MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE.
351850     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
351900     GO TO K2700-POST.
351950 K2700-POST-CR.
352000     MOVE '1' TO POST-TODAY.
352002     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
352010     IF  WMS-LIST-POST    EQUAL '5' OR '6'                        0827768
352020         MOVE '2'            TO LIST-POST-CR-FLAG                 0827768
352030     ELSE                                                         0827768
352050         MOVE '1'            TO LIST-POST-CR-FLAG.                0827768
352060     MOVE WMS-LIST-POST      TO TR-LP-CR-ACCT.                    0827768
352070     MOVE '1'                TO TRAN-REWRITE-SW.                  0827768
352100     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
352150     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
352200         ADD TR-LP-TOT-NO-CR TO IOD-CR-NO, WS-GL-IOD-CR-NO        0902970
352250         ADD TR-LP-TOT-AMT-CR TO IOD-CR-AMT, WS-GL-IOD-CR-AMT     0902970
352300     ELSE
352350         ADD TR-LP-TOT-NO-CR TO DDA-CR-NO, WS-GL-DDA-CR-NO        0902970
352400         ADD TR-LP-TOT-AMT-CR TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.    0902970
352450     ADD TR-LP-TOT-AMT-CR TO WMS-CURR-BAL
352500                             WMS-TODAYS-CREDITS
352550                             CUR-BAL                              IM003
352560                             CUST-BAL.                            IM003
352600     ADD +1 TO WMS-STMT-NO-CREDITS, WMS-TODAYS-CREDITS-NO.
352650     ADD TR-LP-TOT-AMT-CR TO WMS-STMT-CR-AMT.
352700     MOVE GT-OPTION9 (4) TO HOLD-OPT.
352750     IF  HOLD-OPT GREATER THAN +3
352800         SUBTRACT +4 FROM HOLD-OPT.
352850     IF  HOLD-OPT GREATER THAN +1
352900         SUBTRACT +2 FROM HOLD-OPT
352910         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
352912                                      OR 'E'                      0417110
352950             ADD TR-LP-TOT-NO-CR TO WMS-STMT-ITEMS.               1105504
353000     IF  HOLD-OPT GREATER THAN +0
353010         IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' 0417110
353012                                      OR 'E'                      0417110
353050             ADD +1 TO WMS-STMT-ITEMS.                            1105504
353100     MOVE GT-OPTION9 (5) TO HOLD-OPT.
353150     IF  HOLD-OPT GREATER THAN +3
353202         SUBTRACT +4 FROM HOLD-OPT.                               IM003
353250     IF  HOLD-OPT GREATER THAN +1
353300         SUBTRACT +2 FROM HOLD-OPT.
353350     IF  HOLD-OPT GREATER THAN +0
353400         ADD +1 TO WMS-MTD-SVC-CHG-CR
353450                   WMS-SC-CREDITS.
353455     MOVE GT-OPTION9 (6) TO HOLD-OPT.                             IM005
353460     IF  HOLD-OPT GREATER THAN +3                                 IM005
353465         SUBTRACT +4 FROM HOLD-OPT.                               IM005
353470     IF  HOLD-OPT GREATER THAN +1                                 IM005
353475         SUBTRACT +2 FROM HOLD-OPT.                               IM005
353480     IF  HOLD-OPT GREATER THAN +0                                 IM005
353485         ADD TR-LP-TOT-NO-CR TO WMS-MTD-SVC-CHG-CR                IM005
353490                                WMS-SC-CREDITS.                   IM005
353500     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
353550     MOVE '02' TO EX01-INT-CODE.
353600     MOVE '2' TO EX01-TYPE.
353650     MOVE TR-LP-TOT-NO-CR TO EX01-NUMBER.
353700     MOVE TR-LP-TOT-AMT-CR TO HOLD-AMT.
353750     PERFORM WRITE-GEN-TRANS THRU WGT-3.                          IM008
353800     IF  GT-OPTION (1) GREATER THAN '0'
353850         MOVE 'N' TO HOLD-X1
353900         MOVE GT-OPTION (1) TO HOLD-X2
353950         MOVE HOLD-X TO IMEX-CODE-1
354000         PERFORM WGT-1 THRU WGT-3.                                IM008
354050     ADD +1 TO FS-CR.
354100     PERFORM K7500 THRU K8500.
354150     GO TO Q4500.
354200 K2700-POST.
354250     MOVE '1' TO POST-TODAY.
354252     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
354260     IF  WMS-LIST-POST    EQUAL '4' OR '6'                        0827768
354270         MOVE '2'            TO LIST-POST-DR-FLAG                 0827768
354280     ELSE                                                         0827768
354300         MOVE '1'            TO LIST-POST-DR-FLAG.                0827768
354310     MOVE WMS-LIST-POST      TO TR-LP-DR-ACCT.                    0827768
354320     MOVE '1'                TO TRAN-REWRITE-SW.                  0827768
354350     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
354400     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
354450         ADD TR-LP-TOT-NO TO IOD-DB-NO, WS-GL-IOD-DB-NO           0902970
354500         ADD TR-LP-TOT-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT        0902970
354550     ELSE
354600         ADD TR-LP-TOT-NO TO DDA-DB-NO, WS-GL-DDA-DB-NO           0902970
354650         ADD TR-LP-TOT-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.       0902970
354700     ADD TR-LP-TOT-AMT TO WMS-TODAYS-DEBITS.
354710     IF  BATCH-RUN-BAL-OD-UPDATED EQUAL 'N'                       9916451
354715         SUBTRACT TR-LP-TOT-AMT FROM BATCH-RUN-BALANCE            9916451
354716         SUBTRACT TR-LP-TOT-AMT FROM BATCH-RUN-FDIC               0930077
354720                                     BATCH-RUN-OD.                9916451
354750     SUBTRACT TR-LP-TOT-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL. IM003
354800     ADD +1 TO WMS-STMT-NO-DEBITS, WMS-TODAYS-DEBITS-NO.
354850     ADD TR-LP-TOT-AMT TO WMS-STMT-DR-AMT.
354860     IF  GT-OPTION (3) GREATER THAN '3'                           IM003
354870     AND CUST-BAL LESS THAN ZERO                                  IM003
354875     AND WMS-OD-TODAY EQUAL '0'                                   IM005
354880         ADD +1 TO DAU-CTR.                                       IM003
354900     MOVE GT-OPTION9 (4) TO HOLD-OPT.
354950     IF  HOLD-OPT GREATER THAN +3
355000         SUBTRACT +4 FROM HOLD-OPT
355050         ADD +1 TO WMS-MTD-SVC-CHG-DR
355100                   WMS-SC-DEBITS.
355150     IF  HOLD-OPT GREATER THAN +1
355200         SUBTRACT +2 FROM HOLD-OPT
355250         ADD TR-LP-TOT-NO-CR TO WMS-STMT-ITEMS.
355260     IF  WMS-CHK-TRUNC-FLAG EQUAL TO 'N' OR 'I' OR 'R' OR 'U' OR  0417110
355262                       'E' OR 'C' OR 'K' OR 'T' OR 'W' OR 'G'     0417110
355300         IF  HOLD-OPT GREATER THAN +0                             1105504
355350             ADD +1 TO WMS-STMT-ITEMS.                            1105504
355400     MOVE GT-OPTION9 (5) TO HOLD-OPT.
355450     IF  HOLD-OPT GREATER THAN +3
355500         SUBTRACT +4 FROM HOLD-OPT
355550         ADD TR-LP-TOT-NO TO WMS-SC-NO-CHECKS.
355600     IF  HOLD-OPT GREATER THAN +1
355650         ADD TR-LP-TOT-NO TO WMS-MTD-SVC-CHG-DR
355700                             WMS-SC-DEBITS.
355702     IF  GT-OPTION (6) GREATER THAN '3'                           IM003
355704     AND CUST-BAL LESS THAN ZERO                                  IM003
355705     AND WMS-OD-TODAY EQUAL '0'                                   IM005
355706         MOVE '1' TO DAU-TODAY                                    IM003
355708         ADD +1 TO WMS-SC-UNAVAIL-ITEMS                           IM007
355709                   WMS-MTD-UNAVAIL-ITEMS                          IM007
355712         MOVE '13' TO IMEX-REC-NO                                 IM003
355714         MOVE 'HJ' TO IMEX-CODE-1                                 IM003
355716         MOVE ZERO TO EX13-BATCH                                  IM003
355718                      EX13-SEQ                                    IM003
355720         MOVE TR-LP-TOT-AMT TO EX13-AMT                           IM003
355722         MOVE '02' TO EX13-UCODE1                                 IM003
355724         MOVE GT-USER-CODE TO EX13-UCODE2                         IM003
355726         MOVE '4' TO EX13-TYPE                                    IM003
355728         MOVE '02' TO EX13-TR-TYPE                                IM005
355730         MOVE TR-LP-TOT-NO TO EX13-ITEM-CNT                       IM003
355731         MOVE ZERO TO EXC13-02-ITEM-COUNT EXC13-02-REF-NO         0326987
355732         MOVE DATE-LAST-ACTIVE TO EX13-DATE-LAST-ACTIVE           IM003
355734         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                 IM003
355750     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
355800     MOVE '02' TO EX01-INT-CODE.
355850     MOVE '4' TO EX01-TYPE.
355900     MOVE TR-LP-TOT-NO TO EX01-NUMBER.
355950     MOVE TR-LP-TOT-AMT TO HOLD-AMT.
356000     PERFORM WRITE-GEN-TRANS THRU WGT-3.                          IM008
356050     IF  GT-OPTION (1) GREATER THAN '0'
356100         MOVE 'N' TO HOLD-X1
356150         MOVE GT-OPTION (1) TO HOLD-X2
356200         MOVE HOLD-X TO IMEX-CODE-1
356250         PERFORM WGT-1 THRU WGT-3.                                IM008
356300     IF WMS-LOAN-TRLR EQUAL TO '1' AND LOAN-TODAY NOT EQUAL ZERO
356320         PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.             IM003
356400 K2780.
356450     ADD +1 TO FS-DB.
356500     PERFORM K7500 THRU K8500.
356550     GO TO Q4500.
356600     SKIP3
356650 ROOT-SECTION-N      SECTION 1.
356700     SKIP3
356750*    ***************  NAME/ADDRESS CHANGES  ****************
356800     SKIP1
356850 K2800.
356900     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
356910     IF  TR-SCLASS1 EQUAL '2'                                     IM003
356915     AND WMS-NME-ADDR-TLRS EQUAL ZERO                             IM003
356920         MOVE '048' TO REJRESN                                    0717565
356930         GO TO K3165.                                             IM003
356950     IF NEW-MASTER-SW EQUAL TO '1', GO TO K2850.
357000     IF NEW-ACCT-REJ-SW EQUAL '1'
357050        MOVE '001' TO REJRESN                                     0717565
357100        GO TO K3165.
357150     MOVE SPACES TO IMEX-REC-12.
357200     MOVE +0 TO X.
357250     IF  WMS-NME-ADDR-TLRS EQUAL ZERO
357300         MOVE +0 TO WMS-NA-NO-LINES-1
357350                    WMS-NA-NO-LINES-2
357360         MOVE +0 TO EX12-NA-PTR                                   IM008
357370         PERFORM K2840 THRU K2844                                 IM008
357400         GO      TO K2850.
357450     IF  WMS-NME-ADDR-TLRS EQUAL +1                               IM003
357452         MOVE +0 TO WMS-NA-NO-LINES-2.                            IM003
357454     IF  TR-SCLASS1 EQUAL '2'                                     IM003
357460         MOVE +2 TO EX12-NA-PTR                                   IM003
357464         MOVE WMS-NA-COUNTRY-2 TO EX12-NA-COUNTRY                 9915850
357470         GO TO K2830.                                             IM003
357480     MOVE +1 TO EX12-NA-PTR.                                      IM003
357490     MOVE WMS-NA-COUNTRY TO EX12-NA-COUNTRY.                      9915850
357500 K2820.
357550     ADD +1 TO X.
357600     IF X GREATER THAN WMS-NA-NO-LINES-1, GO  TO  K2840.
357650     MOVE WMS-NA-LINE (X) TO EX12-NA-LINE (X).
357700     GO TO K2820.
357750 K2830.
357800     ADD +1 TO X.
357850     IF X GREATER THAN WMS-NA-NO-LINES-2, GO  TO  K2840.
357900     MOVE WMS-NA-LINE-2 (X) TO EX12-NA-LINE (X).                  IM006
357950     GO TO K2830.
358000 K2840.
358002     MOVE WMS-DATE-LAST-NA-MAINT TO C-LOW-DATE.                   0837840
358004     PERFORM X0120-8-TO-6-LO.                                     0837840
358010     MOVE DT-LOW-DATE TO EX12-DATE-LAST-MAINT.                    0837840
358050     MOVE 'B0B2' TO IMEX-EX-CODE.
358100 K2842.
358150     MOVE '12' TO IMEX-REC-NO.
358152     MOVE WMS-CUST-LANGUAGE TO EX12-OLD-LANG-CODE.                9915845
358154     IF  TR-LANG-CODE NOT EQUAL WMS-CUST-LANGUAGE                 9915845
358156         MOVE '1' TO EX12-LANG-CODE-CHNG.                         9915845
358200     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
358250 K2844.  EXIT.
358300 K2845.
358350     IF  STATUS-IN EQUAL '06' OR WMS-STATUS EQUAL '06'
358400         MOVE 'DN' TO IMEX-CODE-1
358450         GO TO K2847.
358500     IF  STATUS-IN EQUAL '07' OR WMS-STATUS EQUAL '07'
358550         MOVE 'IN' TO IMEX-CODE-1
358600         GO TO K2847.
358605     IF  STATUS-IN EQUAL '10' OR WMS-STATUS EQUAL '10'            9915749
358610         MOVE 'ZD' TO IMEX-CODE-1                                 9915749
358615         GO TO K2847.                                             9915749
358650     GO TO K2850.
358700 K2847.
358750     PERFORM K2842 THRU K2844.
358800 K2850.
358850     IF  TR-SCLASS1 EQUAL '2', GO  TO  K2860.
358900     IF  NEW-MASTER-SW  EQUAL    '1'
358950         MOVE SPACES             TO  WMS-NAME-ADDRESS-TRAILER-1
359000                                     WMS-NAME-ADDRESS-TRAILER-2
359050         MOVE +0                 TO  WMS-NA-NO-LINES-1
359100                                     WMS-NA-NO-LINES-2.
359150     MULTIPLY WMS-NA-NO-LINES-1 BY WS-TRL-NME-ADD-1-LINE          0903291
359152                            GIVING HOLD-NO3.                      0903291
359200     SUBTRACT HOLD-NO3 FROM WMS-LENGTH.
359250     IF  TR-NAME-ADDR-TYPE (1) EQUAL '1' OR
359300         TR-NAME-ADDR-TYPE (6) EQUAL '3'                          1105504
359350         NEXT SENTENCE
359400     ELSE  GO  TO  K2855.
359402     MOVE SPACES                 TO WORK-NAME-ADDRESS.            0902005
359404     MOVE +0                     TO X.                            0902005
359405     MOVE WMS-NA-COUNTRY         TO WK-NA-COUNTRY.                9915845
359406 K2852.                                                           0902005
359408     ADD +1                      TO X.                            0902005
359409     IF X EQUAL +9                                                9915845
359410     OR X GREATER THAN WMS-NA-NO-LINES-1                          9915845
359412         GO TO K2852-EXIT.                                        0902005
359414     IF WMS-NAME-ADDR-TYPE (X) EQUAL '1' OR '2'                   0902005
359416         MOVE WMS-NA-LINE (X)    TO WK-NAME-LINE (X)              0902005
359418         GO TO K2852.                                             0902005
359420     IF WMS-NAME-ADDR-TYPE (X) EQUAL '3'                          0902005
359422         MOVE WMS-NA-LINE (X)    TO WK-NAME-LINE (6)              1105504
359424         GO TO K2852.                                             0902005
359426     IF WMS-NAME-ADDR-TYPE (X) EQUAL '4'                          0902005
359428         MOVE WMS-NA-LINE (X)    TO WK-NAME-LINE (7)              1105504
359430         GO TO K2852.                                             0902005
359432     IF WMS-NAME-ADDR-TYPE (X) EQUAL '5'                          0902005
359434         MOVE WMS-NA-LINE (X)    TO WK-NAME-LINE (8).             1105504
359436     GO TO K2852.                                                 0902005
359438 K2852-EXIT.                                                      0902005
359450     EXIT.                                                        0902005
359460 K2853.                                                           0902005
359500     IF  TR-NAME-ADDR-TYPE (1) EQUAL '1'
359510         MOVE TR-NA-COUNTRY    TO WK-NA-COUNTRY                   9915845
359550         MOVE TR-NA-ADDR-LINES TO WK-NA-ADDR-LINES.
359600     IF  TR-NAME-ADDR-TYPE (6) EQUAL '3'                          1105504
359650         MOVE TR-NA-LINE (6) TO WK-NAME-LINE (6)                  1105504
359660         IF  TR-LINE-NO (6) EQUAL '1'                             1105504
359670             MOVE TR-NA-ZIP TO WMS-ZIP-SAVE                       IM005
359680         ELSE                                                     IM005
359690             MOVE SPACES TO WMS-ZIP-SAVE.                         IM005
359750     IF  TR-NAME-ADDR-TYPE (7)   EQUAL '4'                        1105504
359760         IF  TR-LINE-NO (7)      EQUAL '*'                        1105504
359810             MOVE SPACES         TO WK-NAME-LINE (7)              1105504
359820         ELSE                                                     IM006
359830             MOVE TR-NA-LINE (7) TO WK-NAME-LINE (7).             1105504
359850     IF  TR-NAME-ADDR-TYPE (8)   EQUAL '5'                        1105504
359860         IF  TR-LINE-NO (8)      EQUAL '*'                        1105504
359910             MOVE SPACES         TO WK-NAME-LINE (8)              1105504
359920         ELSE                                                     IM006
359930             MOVE TR-NA-LINE (8) TO WK-NAME-LINE (8).             1105504
359950     MOVE +8 TO WK-NA-NO-LINES.                                   1105504
360000     IF  SI-88-ENVIRONMENT-ONLINE
360050         MOVE  'D'           TO  I-O-CONTROL-OPERATOR
360100         CALL  'IMALPHA'  USING  I-O-CONTROL-AREA
360120                                 SI-ENVIRONMENT-AREA              IM003
360150                                 MASTER-AREA
360170                                 WBC-ONLINE-ALPHA-RECORD          0266741
360200                                 TR-SCLASS1
360250         MOVE  WORK-NAME-ADDRESS TO WMS-NAME-ADDRESS-TRAILER-1
360300         MOVE  'A'           TO  I-O-CONTROL-OPERATOR
360350         CALL  'IMALPHA'  USING  I-O-CONTROL-AREA
360370                                 SI-ENVIRONMENT-AREA              IM003
360400                                 MASTER-AREA
360420                                 WBC-ONLINE-ALPHA-RECORD          0266741
360450                                 TR-SCLASS1
360500     ELSE
360550         MOVE WORK-NAME-ADDRESS TO WMS-NAME-ADDRESS-TRAILER-1.
360600     IF  WMS-NME-ADDR-TLRS EQUAL ZERO
360650         MOVE +1 TO WMS-NME-ADDR-TLRS.
360700     GO  TO  K2900.
360750 K2855.
360758     IF  TR-NAME-ADDR-TYPE (7)   EQUAL '4'                        1105504
360778             MOVE +0             TO X                             IM006
360788             PERFORM K2857       THRU K2857-EXIT                  IM006
360808         IF  TR-LINE-NO (7)      EQUAL '*'                        1105504
360828             MOVE SPACES         TO WMS-NA-LINE (X)               0902005
360870         ELSE                                                     IM006
360890             MOVE TR-NA-LINE (7) TO WMS-NA-LINE (X).              1105504
360900     IF  TR-NAME-ADDR-TYPE (8)   EQUAL '5'                        1105504
360920             MOVE +0             TO X                             IM006
360930             PERFORM K2858       THRU K2858-EXIT                  IM006
360940         IF  TR-LINE-NO (8)      EQUAL '*'                        1105504
360950             MOVE SPACES         TO WMS-NA-LINE (X)               0902005
360970         ELSE                                                     IM006
360973             MOVE TR-NA-LINE (8) TO WMS-NA-LINE (X).              1105504
361000     IF  WMS-NME-ADDR-TLRS EQUAL ZERO
361050         MOVE +1 TO WMS-NME-ADDR-TLRS.
361100     GO  TO  K2900.
361102 K2857.                                                           IM006
361104     ADD +1 TO X.                                                 IM006
361105     IF  X EQUAL +9                                               9915845
361106     OR  X GREATER THAN WMS-NA-NO-LINES-1                         9915845
361108         GO TO K2857-EXIT.                                        IM006
361110     IF  WMS-NAME-ADDR-TYPE (X) EQUAL '4'                         IM006
361114         GO TO K2857-EXIT.                                        IM006
361116     GO TO K2857.                                                 IM006
361118 K2857-EXIT. EXIT.                                                IM006
361120 K2858.                                                           IM006
361122     ADD +1 TO X.                                                 IM006
361123     IF  X EQUAL +9                                               9915845
361124     OR  X GREATER THAN WMS-NA-NO-LINES-1                         9915845
361126         GO TO K2858-EXIT.                                        IM006
361128     IF  WMS-NAME-ADDR-TYPE (X) EQUAL '5'                         IM006
361132         GO TO K2858-EXIT.                                        IM006
361134     GO TO K2858.                                                 IM006
361136 K2858-EXIT. EXIT.                                                IM006
361150 K2860.
361200     IF  NEW-MASTER-SW  EQUAL    '1'
361250         MOVE SPACES             TO  WMS-NAME-ADDRESS-TRAILER-2
361300         MOVE +0                 TO  WMS-NA-NO-LINES-2.
361350     IF  WMS-NME-ADDR-TLRS EQUAL +1
361400         MOVE +0 TO WMS-NA-NO-LINES-2.
361450     MULTIPLY WMS-NA-NO-LINES-2 BY WS-TRL-NME-ADD-2-LINE          0903291
361452                            GIVING HOLD-NO3.                      0903291
361500     SUBTRACT HOLD-NO3 FROM WMS-LENGTH.
361550     IF  TR-NAME-ADDR-TYPE (1) EQUAL '1' OR
361600         TR-NAME-ADDR-TYPE (6) EQUAL '3'                          1105504
361650         NEXT SENTENCE
361700     ELSE  GO  TO  K2865.
361702     MOVE SPACES                 TO WORK-NAME-ADDRESS.            0902005
361703     MOVE WMS-NA-COUNTRY-2       TO WK-NA-COUNTRY.                9915845
361704     MOVE +0                     TO X.                            0902005
361706 K2862.                                                           0902005
361708     ADD +1                      TO X.                            0902005
361709     IF X EQUAL +9                                                9915845
361710     OR X GREATER THAN WMS-NA-NO-LINES-2                          9915845
361712         GO TO K2862-EXIT.                                        0902005
361714     IF WMS-NAME-ADDR-TYPE-2 (X) EQUAL '1' OR '2'                 0902005
361716         MOVE WMS-NA-LINE-2 (X)  TO WK-NAME-LINE (X)              0902005
361718         GO TO K2862.                                             0902005
361720     IF WMS-NAME-ADDR-TYPE-2 (X) EQUAL '3'                        0902005
361722         MOVE WMS-NA-LINE-2 (X)  TO WK-NAME-LINE (6)              9915845
361724         GO TO K2862.                                             0902005
361726     IF WMS-NAME-ADDR-TYPE-2 (X) EQUAL '4'                        0902005
361728         MOVE WMS-NA-LINE-2 (X)  TO WK-NAME-LINE (7)              9915845
361730         GO TO K2862.                                             0902005
361732     IF WMS-NAME-ADDR-TYPE-2 (X) EQUAL '5'                        0902005
361734         MOVE WMS-NA-LINE-2 (X)  TO WK-NAME-LINE (8).             9915845
361736     GO TO K2862.                                                 0902005
361738 K2862-EXIT.                                                      0902005
361750     EXIT.                                                        0902005
361760 K2863.                                                           0902005
361800     IF  TR-NAME-ADDR-TYPE (1) EQUAL '1'
361810         MOVE TR-NA-COUNTRY    TO WK-NA-COUNTRY                   9915845
361850         MOVE TR-NA-ADDR-LINES TO WK-NA-ADDR-LINES.
361900     IF  TR-NAME-ADDR-TYPE (6) EQUAL '3'                          1105504
361950         MOVE TR-NA-LINE (6) TO WK-NAME-LINE (6).                 1105504
362000     IF  TR-NAME-ADDR-TYPE (7)   EQUAL '4'                        1105504
362010         IF  TR-LINE-NO (7)      EQUAL '*'                        1105504
362060             MOVE SPACES         TO WK-NAME-LINE (7)              1105504
362070         ELSE                                                     IM006
362080             MOVE TR-NA-LINE (7) TO WK-NAME-LINE (7).             1105504
362100     IF  TR-NAME-ADDR-TYPE (8)   EQUAL '5'                        1105504
362110         IF  TR-LINE-NO (8)      EQUAL '*'                        1105504
362155             MOVE SPACES         TO WK-NAME-LINE (8)              1105504
362160         ELSE                                                     IM006
362165             MOVE TR-NA-LINE (8) TO WK-NAME-LINE (8)              1105504
362170             IF  WK-NA-START-DATE NOT EQUAL SPACES                IM006
362172                 MOVE WK-NA-START-DATE TO DT-HIGH-DATE            IM006
362176                 MOVE WBC-PROCESS-THRU-DATE TO DT-LOW-DATE        0266741
362185                 CALL 'SIDIF1' USING DATE-AREA                    IM006
362190                 MOVE RET-DAYS TO WK-NA-REMAIN-DAYS.              IM006
362200     MOVE +8 TO WK-NA-NO-LINES.                                   1105504
362250     IF  SI-88-ENVIRONMENT-ONLINE
362300         MOVE  'D'           TO  I-O-CONTROL-OPERATOR
362350         CALL  'IMALPHA'  USING  I-O-CONTROL-AREA
362370                                 SI-ENVIRONMENT-AREA              IM003
362400                                 MASTER-AREA
362420                                 WBC-ONLINE-ALPHA-RECORD          0266741
362450                                 TR-SCLASS1
362500         MOVE  WORK-NAME-ADDRESS TO WMS-NAME-ADDRESS-TRAILER-2
362550         MOVE  'A'           TO  I-O-CONTROL-OPERATOR
362600         CALL  'IMALPHA'  USING  I-O-CONTROL-AREA
362620                                 SI-ENVIRONMENT-AREA              IM003
362650                                 MASTER-AREA
362670                                 WBC-ONLINE-ALPHA-RECORD          0266741
362700                                 TR-SCLASS1
362750     ELSE
362800         MOVE WORK-NAME-ADDRESS TO WMS-NAME-ADDRESS-TRAILER-2.
362850     MOVE +2 TO WMS-NME-ADDR-TLRS.
362900     GO  TO  K2900.
362950 K2865.
362958     IF  TR-NAME-ADDR-TYPE (7)   EQUAL '4'                        1105504
362978             MOVE +0             TO X                             IM006
362988             PERFORM K2867       THRU K2867-EXIT                  IM006
363008         IF  TR-LINE-NO (7)      EQUAL '*'                        1105504
363028             MOVE SPACES         TO WMS-NA-LINE-2 (X)             0902005
363070         ELSE                                                     0902005
363090             MOVE TR-NA-LINE (7) TO WMS-NA-LINE-2 (X).            1105504
363100     IF  TR-NAME-ADDR-TYPE (8)   EQUAL '5'                        1105504
363120             MOVE +0             TO X                             IM006
363130             PERFORM K2868       THRU K2868-EXIT                  IM006
363135         IF  TR-LINE-NO (8)      EQUAL '*'                        1105504
363140             MOVE SPACES         TO WMS-NA-LINE-2 (X)             0902005
363160         ELSE                                                     0902005
363164             MOVE TR-NA-LINE (8) TO WMS-NA-LINE-2 (X)             1105504
363168             IF  WMS-NA-START-DATE-2 (X) NOT EQUAL SPACES         0902005
363172                 MOVE WMS-NA-START-DATE-2 (X) TO DT-HIGH-DATE     0902005
363180                 MOVE WBC-PROCESS-THRU-DATE TO DT-LOW-DATE        0266741
363185                 CALL 'SIDIF1' USING DATE-AREA                    IM006
363190                 MOVE RET-DAYS TO WMS-NA-REMAIN-DAYS-2 (X).       0902005
363200     MOVE +2 TO WMS-NME-ADDR-TLRS.
363202     GO TO K2900.                                                 IM006
363204 K2867.                                                           IM006
363206     ADD +1 TO X.                                                 IM006
363207     IF  X EQUAL +9                                               9915845
363208     OR  X GREATER THAN WMS-NA-NO-LINES-2                         9915845
363210         GO TO K2867-EXIT.                                        IM006
363212     IF  WMS-NAME-ADDR-TYPE-2 (X) EQUAL '4'                       IM006
363216         GO TO K2867-EXIT.                                        IM006
363218     GO TO K2867.                                                 IM006
363220 K2867-EXIT. EXIT.                                                IM006
363222 K2868.                                                           IM006
363224     ADD +1 TO X.                                                 IM006
363225     IF  X EQUAL +9                                               9915845
363226     OR  X GREATER THAN WMS-NA-NO-LINES-2                         9915845
363228         GO TO K2868-EXIT.                                        IM006
363230     IF  WMS-NAME-ADDR-TYPE-2 (X) EQUAL '5'                       IM006
363234         GO TO K2868-EXIT.                                        IM006
363236     GO TO K2868.                                                 IM006
363238 K2868-EXIT. EXIT.                                                IM006
363250 K2900.
363300     IF  TR-SCLASS1 EQUAL '2'                                     9915845
363310         MOVE +9 TO WMS-NA-NO-LINES-2                             9915845
363320     ELSE                                                         9915845
363330         MOVE +9 TO WMS-NA-NO-LINES-1.                            9915845
363400     IF NEW-MASTER-SW EQUAL TO '0'
363402         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0837840
363404         PERFORM X0100-6-TO-8-LO                                  0837840
363450         MOVE C-LOW-DATE TO WMS-DATE-LAST-NA-MAINT.               0837840
363500     GO TO Q4500.
363550     SKIP1
363600*  -- A '9' IN THE LINE COUNT CONTROL WILL SIGNAL THE MASTER      9915845
363650*  -- WRITE ROUTINE THAT A NEW N/A TRAILER HAS BEEN INSERTED.     9915845
363700*  -- THE BAL ROUTINE WILL THEN REMOVE ANY IMBEDDED BLANK LINES.  9915845
363750     SKIP3                                                        9915845
363800 TRLR-SECTION-A      SECTION 46.
363850     SKIP3
363900*    *******************************************************
363950*    *                TRAILER TRANSACTIONS                 *
364000*    *******************************************************
364050     SKIP3
364100*    *************  TRAILER DELETE PROCESSING  *************
364150     SKIP1
364200 K3000.
364250     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
364300     IF  TR-TRLR-TYPE EQUAL TO 'P'
364350         IF  WMS-DC-TRLR EQUAL TO '1'
364400             MOVE '1' TO WMS-DC-DELETE
364450             GO  TO  K3180
364500         ELSE GO TO K3150.
364550     IF TR-TRLR-TYPE EQUAL TO 'M'
364600         IF WMS-MARKET-TRLR EQUAL TO '1'
364650             MOVE '1' TO WMS-MARKET-DELETE
364700             GO TO K3180
364750         ELSE GO TO K3150.
364800     IF TR-TRLR-TYPE EQUAL TO 'Z'
364850         IF WMS-TARGET-AMT-TRLR EQUAL TO '1'
364900             MOVE '1' TO WMS-TARGET-DELETE
364950             GO TO K3180
365000         ELSE GO TO K3150.
365050     IF TR-TRLR-TYPE EQUAL TO 'L'
365100         IF WMS-LIMIT-TRANSFER EQUAL TO '1'
365150             MOVE '1' TO WMS-LIMIT-TRAN-DELETE
365200             GO TO K3180
365250         ELSE GO TO K3150.
365300     IF TR-TRLR-TYPE EQUAL TO 'N'
365350         IF WMS-SOC-SEC-NA EQUAL TO '1'
365400             MOVE '1' TO WMS-SSN-DELETE
365450             GO TO K3180
365500         ELSE GO TO K3150.
365550     IF  TR-TRLR-TYPE EQUAL 'G'
365600         IF  WMS-INFO-TRLR EQUAL '1'
365650             MOVE '1' TO WMS-INFO-DELETE
365700             GO TO K3180
365750         ELSE
365800             GO TO K3150.
365802     IF  TR-TRLR-TYPE EQUAL 'E'                                   0427053
365804         IF  WMS-MTD-ANALYSIS GREATER THAN '0'                    0427053
365806             GO TO K3160.                                         0427053
365850     IF  TR-TRLR-TYPE EQUAL 'E'
365900         IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
365950             MOVE '1' TO WMS-SC-DELETE
366000             GO TO K3180
366050         ELSE
366100             GO TO K3150.
366107     IF  TR-TRLR-TYPE EQUAL 'F'                                   IM007
366114         IF  WMS-EFA-TRLR EQUAL TO '1'                            IM007
366121             MOVE '1' TO WMS-EFA-DELETE                           IM007
366128             GO TO K3180                                          IM007
366135         ELSE                                                     IM007
366142             GO TO K3150.                                         IM007
366150     IF TR-TRLR-TYPE NOT EQUAL TO 'D'
366200         GO TO K3020.
366250     IF WMS-SAVINGS-TRLR EQUAL TO '0'
366300         GO TO K3150.
366310     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
366320         GO TO K3160.                                             1004554
366350     IF  WMS-INT-STATUS EQUAL '7'
366400         GO TO K3140.
366450     IF  WMS-INT-STATUS EQUAL '8'
366500         GO TO K3145.
366550     IF  WMS-ACCR-INT      NOT EQUAL TO ZERO                      IM003
366560     OR  WMS-YTD-INT-PAID  NOT EQUAL TO ZERO                      IM003
366570     OR  WMS-INT-CUR-BAL   NOT EQUAL TO ZERO                      IM003
366580     OR  WMS-INT-CR-NUMBER NOT EQUAL TO ZERO                      IM003
366590     OR  WMS-INT-DR-NUMBER NOT EQUAL TO ZERO                      IM003
366600     OR  WMS-INT-CR-AMT    NOT EQUAL TO ZERO                      IM003
366610     OR  WMS-INT-DR-AMT    NOT EQUAL TO ZERO                      IM003
366615     OR  (WMS-DUAL-YEAR-TRLR EQUAL '1'                            9915858
366620     AND WMS-DUAL-YR-CUR-SAV-INT NOT EQUAL TO ZERO)               9915858
366700         MOVE '7' TO WMS-INT-STATUS
366750         MOVE 'N' TO IOD-CLOSE-FLAG
366800         PERFORM R3835 THRU R3864
366850         MOVE 'F' TO IOD-CLOSE-FLAG
366900         ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL TRANSFER-AMT
366950         MOVE ZERO TO WMS-INT-CUR-BAL
367000     ELSE
367050         MOVE '8' TO WMS-INT-STATUS.
367100     IF WK-SV-STATUS-IN NOT EQUAL WMS-INT-STATUS
367150         MOVE 'SU' TO IMEX-CODE-1
367200         MOVE 'SS' TO IMEX-CODE-2
367250         MOVE '09' TO IMEX-REC-NO
367300         MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN
367350         MOVE WMS-INT-STATUS TO EX09-STATUS-OUT,
367400                                WK-SV-STATUS-IN
367450         MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL
367500         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
367550     MOVE '1' TO SYS-REQ-STMT.
367600     MOVE 'C8' TO IMEX-CODE-2.
367650     GO TO K3180.
367700 K3020.
367750     IF TR-TRLR-TYPE NOT EQUAL TO 'C', GO TO K3040.
367800     IF WMS-LOAN-TRLR EQUAL TO '0', GO TO K3150.
367810     IF WMS-NB-DC-ABM EQUAL '1'                                   9915749
367820         GO TO K3150.                                             9915749
367850 K3025.
367900     ADD WMS-PRIN-BAL
367950         WMS-INTRST-BAL
368000         WMS-OTHER-CHGS
368050         WMS-LOAN-ACCR-INT
368100         WMS-LOAN-YTD-INT GIVING HOLD-AMT13.
368150 K3029.  EXIT.
368200 K3030.
368250     IF  HOLD-AMT13         NOT EQUAL TO ZERO                     IM003
368257     OR  WMS-LN-STMT-CR-NO  NOT EQUAL TO ZERO                     IM003
368264     OR  WMS-LN-STMT-CR-AMT NOT EQUAL TO ZERO                     IM003
368271     OR  WMS-LN-STMT-DB-NO  NOT EQUAL TO ZERO                     IM003
368278     OR  WMS-LN-STMT-DB-AMT NOT EQUAL TO ZERO                     IM003
368281     OR  WMS-COSTS-UNEARNED NOT EQUAL TO ZERO                     IM006
368285         GO TO K3160.                                             IM003
368300     MOVE '4' TO WMS-LOAN-STATUS.
368350     IF WK-LN-STATUS-IN NOT EQUAL WMS-LOAN-STATUS
368400         MOVE 'SU' TO IMEX-CODE-1
368450         MOVE 'SL' TO IMEX-CODE-2
368500         MOVE '09' TO IMEX-REC-NO
368550         MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
368600         MOVE '4' TO EX09-STATUS-OUT, WK-LN-STATUS-IN
368650         MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
368700         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
368750     MOVE '1' TO SYS-REQ-STMT.
368800     MOVE 'C6' TO IMEX-CODE-2.
368850     GO TO K3180.
368900     SKIP3
368950 K3040.
369000     IF  TR-TRLR-TYPE NOT EQUAL TO 'T' AND 'I'
369050         GO TO K3050.
369100     IF  TR-TRLR-SEQ GREATER THAN WMS-TRNSFR-AFFL-TRLR
369150         GO TO K3150.
369200     MOVE TR-TRLR-SEQ TO X.
369250     IF  TR-TRLR-SEQ EQUAL TO WMS-SAV-PTR
369300     AND WMS-TRNSFR-AFFL-FLAG (X) EQUAL 'A'
369350         MOVE ZERO TO WMS-SAV-PTR
369400         MOVE 'CA' TO IMEX-CODE-1
369450         MOVE WMS-TRANSFER-AFFILIATE-TRAILER (X) TO EX11-TRLR
369500         PERFORM K3175 THRU K3195.
369550     MOVE WMS-TRANSFER-AFFILIATE-TRAILER (X) TO EX11-TRLR.
369600     MOVE HIGH-VALUE TO WMS-LINK-DELETE (X).
369650     MOVE '1' TO AMT-TRANSFER-DEL.
369654     IF  X EQUAL WMS-IOD-XFER-INT-PTR                             IM006
369658         MOVE +0 TO WMS-IOD-XFER-INT-PTR.                         0546393
369674     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM006
369678         IF  X EQUAL WMS-SAV-XFER-INT-PTR                         IM006
369682             MOVE +0 TO WMS-SAV-XFER-INT-PTR.                     0546393
369684     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0817704
369686         IF  X EQUAL WMS-OD-INT-XFER-PTR                          0817704
369688             MOVE +0 TO WMS-OD-INT-XFER-PTR.                      0817704
369700     GO TO K3170.
369750 K3050.
369800     IF  TR-TRLR-TYPE NOT EQUAL 'A'
369850         GO TO K3060.
369900     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'
369950         GO TO K3150.
370000     IF  WMS-OD-YTD-CHGD EQUAL ZERO
370050     AND WMS-OD-CYC-ACR EQUAL ZERO
370100*        MOVE '2' TO WMS-OD-STATUS                                IMODTRAI
370110         NEXT SENTENCE                                            IMODTRAI
370150     ELSE
370200         MOVE '4' TO OD-ACR-PAY-FLAG
370250         PERFORM R4012-A THRU R4013-EXIT
370300         MOVE '1' TO WMS-OD-STATUS.
370350     IF  WK-OD-STATUS-IN NOT EQUAL WMS-OD-STATUS
370400         MOVE 'SU' TO IMEX-CODE-1
370450         MOVE 'SA' TO IMEX-CODE-2
370500         MOVE '09' TO IMEX-REC-NO
370550         MOVE WK-OD-STATUS-IN TO EX09-STATUS-IN
370600         MOVE WMS-OD-STATUS TO EX09-STATUS-OUT
370650                               WK-OD-STATUS-IN
370700         MOVE ZERO TO EX09-CUR-BAL
370750         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
370800     GO TO K3197.
370850 K3060.
370900     IF  TR-TRLR-TYPE NOT EQUAL 'Q'
370950         GO TO K3080.
371000     IF  WMS-DCD-TAX-DATA-TRLR EQUAL '0'
371050         GO TO K3150.
371100     IF  WMS-DCD-YTD-INT-IOD  EQUAL ZERO
371150     AND WMS-DCD-YTD-INT-SAV  EQUAL ZERO
371200     AND WMS-DCD-YTD-INT-LOAN EQUAL ZERO
371250     AND WMS-DCD-YTD-TAX-IOD  EQUAL ZERO
371300     AND WMS-DCD-YTD-TAX-SAV  EQUAL ZERO
371310     AND WMS-DCD-YTD-TAX-IOD-STATE EQUAL ZERO                     2012254
371320     AND WMS-DCD-YTD-TAX-IOD-LOCAL EQUAL ZERO                     2012254
371330     AND WMS-DCD-YTD-TAX-SAV-STATE EQUAL ZERO                     2012254
371340     AND WMS-DCD-YTD-TAX-SAV-LOCAL EQUAL ZERO                     2012254
371350         MOVE '1' TO WMS-DCD-STATUS                               IM007
371400     ELSE
371450         GO TO K3160.                                             IM007
371500     IF  WK-DCD-STATUS-IN NOT EQUAL WMS-DCD-STATUS
371550     AND WMS-DCD-STATUS EQUAL '1'
371600         MOVE 'SU' TO IMEX-CODE-1
371650         MOVE 'SQ' TO IMEX-CODE-2
371700         MOVE '09' TO IMEX-REC-NO
371750         MOVE WK-DCD-STATUS-IN TO EX09-STATUS-IN
371800         MOVE WMS-DCD-STATUS TO EX09-STATUS-OUT
371850                                WK-DCD-STATUS-IN
371900         COMPUTE DCD-NET-INT = (WMS-DCD-YTD-INT-IOD +
371950                               WMS-DCD-YTD-INT-SAV) -
372000                               (WMS-DCD-YTD-TAX-IOD +
372050                               WMS-DCD-YTD-TAX-SAV) -             2012254
372055                               (WMS-DCD-YTD-TAX-IOD-STATE +       2012254
372060                               WMS-DCD-YTD-TAX-SAV-STATE) -       2012254
372065                               (WMS-DCD-YTD-TAX-IOD-LOCAL +       2012254
372070                               WMS-DCD-YTD-TAX-SAV-LOCAL)         2012254
372100         MOVE DCD-NET-INT TO EX09-CUR-BAL
372150         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
372200     GO TO K3197.
372250 K3080.
372300     IF TR-TRLR-TYPE NOT EQUAL TO 'S', GO TO K3090.               IM005
372350     IF TR-TRLR-SEQ GREATER THAN WMS-COMBINED-STAT, GO TO K3150.
372400     MOVE TR-TRLR-SEQ TO X.
372450     MOVE WMS-COMBINED-STATEMENT-TRAILER (X) TO EX11-TRLR.
372500     MOVE HIGH-VALUE TO WMS-COMB-STMT-DELETE (X).
372550     MOVE '1' TO COMB-STMT-DEL.
372575     PERFORM R0070 THRU R0081.                                    0637443
372600     GO TO K3170.
372602 K3090.                                                           IM005
372604     IF  TR-TRLR-TYPE NOT EQUAL 'B', GO TO K3150.                 IM005
372606     IF  WMS-NME-ADDR-TLRS NOT EQUAL +2                           IM005
372608         GO TO K3150.                                             IM005
372610     IF  SI-88-ENVIRONMENT-ONLINE                                 IM005
372612         MOVE 'D' TO I-O-CONTROL-OPERATOR                         IM005
372614         CALL 'IMALPHA' USING I-O-CONTROL-AREA                    IM005
372616                              SI-ENVIRONMENT-AREA                 IM005
372618                              MASTER-AREA                         IM005
372619                              WBC-ONLINE-ALPHA-RECORD             0266741
372620                              TR-SCLASS1                          IM005
372622         MOVE +1 TO WMS-NME-ADDR-TLRS                             IM005
372624         MOVE 'A' TO I-O-CONTROL-OPERATOR                         IM005
372626         CALL 'IMALPHA' USING I-O-CONTROL-AREA                    IM005
372628                              SI-ENVIRONMENT-AREA                 IM005
372630                              MASTER-AREA                         IM005
372631                              WBC-ONLINE-ALPHA-RECORD             0266741
372632                              TR-SCLASS1                          IM005
372634         MOVE +2 TO WMS-NME-ADDR-TLRS.                            IM005
372636     MULTIPLY WMS-NA-NO-LINES-2 BY WS-TRL-NME-ADD-2-LINE          0903291
372637                            GIVING HOLD-NO3.                      0903291
372638     ADD +1 TO HOLD-NO3.                                          IM005
372640     SUBTRACT HOLD-NO3 FROM WMS-LENGTH.                           IM005
372642     MOVE +0 TO WMS-NA-NO-LINES-2.                                IM005
372643     IF  WMS-NB-ALT-NA-IND EQUAL '0'                              9915749
372644         MOVE SPACES TO WMS-NB-STMT-SPECL-HANDL-2.                9915749
372645     GO TO K3180.                                                 1105504
372650     SKIP3
372700 ROOT-SECTION-Q      SECTION 1.
372750     SKIP3
372800 K3130.
372850     MOVE '002' TO REJRESN.                                       0717565
372900     GO TO K3165.
372950 K3140.
373000     MOVE '009' TO REJRESN.                                       0717565
373050     GO TO K3165.
373100 K3145.
373150     MOVE '008' TO REJRESN.                                       0717565
373200     GO TO K3165.
373250 K3150.
373300     MOVE '015' TO REJRESN.                                       0717565
373350     GO TO K3165.
373400 K3160.
373450     MOVE '016' TO REJRESN.                                       0717565
373500 K3165.
373550     MOVE 'D0' TO EXCODE-1.
373600 K3167.
373650     MOVE '09' TO RECNO.
373700     MOVE TR-SOURCE TO EX09-SOURCE.
373750     MOVE TR-BATCH TO EX09-BATCH.
373800     MOVE TR-SEQ TO EX09-SEQ.
373850     MOVE TR-CLASS TO EX09-TR-CODE.
373900 K3168.  EXIT.
373950 K3169.
374000     GO TO UNPOST-EXCEPT.
374050 K3170.
374100     MOVE 'C5C7' TO IMEX-EX-CODE.
374150 K3175.
374200     MOVE '11' TO IMEX-REC-NO.
374250     MOVE 'M' TO EX11-CODE.
374300     GO TO K3190.
374350 K3180.
374400     MOVE 'C5' TO IMEX-CODE-1.
374450     MOVE 'M' TO EX03-CODE.
374500     MOVE '03' TO IMEX-REC-NO.
374550 K3190.
374600     MOVE TR-TRLR-TYPE TO EX03-TYP.
374650     MOVE TR-TRLR-SEQ TO EX03-NO.
374700     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
374750 K3195.
374800     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
374850 K3197.
374900     IF  WMS-TRAILERS EQUAL TO NO-TRAILERS                        9915845
374920     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
374950         MOVE '0' TO WMS-EXPANSION-IND
375000     ELSE MOVE '1' TO WMS-EXPANSION-IND.
375050     GO TO Q4500.
375100     SKIP3
375150 TRLR-SECTION-D      SECTION 46.
375200     SKIP3
375250*    *************  SAVINGS TRAILER ADDITION  *************
375300     SKIP1
375350 K3200.
375400     IF WMS-SAVINGS-TRLR EQUAL TO '1'
375450         MOVE 'D1' TO IMEX-CODE-2
375500         MOVE '017' TO REJRESN                                    0717565
375550         GO TO K3165.
375552     IF WMS-PLAN-TRLR EQUAL TO '1'                                0617360
375554         MOVE 'D1' TO IMEX-CODE-2                                 0617360
375556         MOVE '038' TO REJRESN                                    0717565
375558         GO TO K3165.                                             0617360
375600     IF WBC-INT-PAY EQUAL TO 'N'                                  0266741
375650         MOVE 'D1' TO IMEX-CODE-2
375700         MOVE '024' TO REJRESN                                    0717565
375750         GO TO K3165.
375752     IF  WMS-PASSBOOK-ACCT EQUAL '1'                              0427139
375754         MOVE 'D1' TO IMEX-CODE-2                                 0427139
375756         MOVE '097' TO REJRESN                                    0717565
375758         GO TO K3165.                                             0427139
375800     IF  WMS-STMT-FULL-SHEET EQUAL TO '1'
375850         MOVE 'D1' TO IMEX-CODE-2
375900         MOVE '031' TO REJRESN                                    0717565
375950         GO  TO  K3165.
375960     IF  WMS-MIN-BAL GREATER THAN TR-DDA-MAX-BAL                  IM005
375970         MOVE 'D1' TO IMEX-CODE-2                                 IM005
375980         MOVE '023' TO REJRESN                                    0717565
375990         GO  TO  K3165.                                           IM005
375991     IF  TR-INT-INV-IND EQUAL 'Y'                                 1004554
375992         IF  WMS-MIN-BAL GREATER THAN ZERO                        1004554
375993             MOVE 'D1' TO IMEX-CODE-2                             1004554
375994             MOVE '038' TO REJRESN                                0717565
375995             GO TO K3165.                                         1004554
375996     IF  (WMS-XINV-LINK-IND    NOT EQUAL ' ' AND 'D')             2016639
375998     AND (WMS-XINV-PROCESS-IND NOT EQUAL '0')                     2016639
376000         IF  (TR-INT-INV-IND       EQUAL 'Y')                     2016639
376002         OR  (TR-CMA-INDICATOR     EQUAL '1')                     2016639
376004         OR  (TR-DDA-MAX-FLAG  NOT EQUAL '0')                     2016639
376006             MOVE 'D1' TO IMEX-CODE-2                             2016639
376008             MOVE '095' TO REJRESN                                0717565
376010             GO TO K3165.                                         2016639
376012* STATEMENT SAVINGS                                               0437111
376014     IF  WMS-MMDA-INDICATOR EQUAL '2' OR '3'                      0437111
376016         MOVE 'D1' TO IMEX-CODE-2                                 0437111
376018         MOVE '099' TO REJRESN                                    0717565
376020         GO TO K3165.                                             0437111
376050     IF  WBC-DLCA-FLAG EQUAL '0'                                  0266741
376054         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    1020057
376055     MOVE TR-TRAILER TO WMS-SAVINGS-TRAILER.                      1020057
376056     IF  WMS-CMA-INDICATOR EQUAL '1'                              1020057
376057         IF WMS-LOAN-TRLR EQUAL TO '1'                            1020057
376058         AND WMS-CRED-CARD-IND EQUAL 'Y'                          1020057
376059             MOVE 'D1' TO IMEX-CODE-2                             1020057
376060             MOVE '105' TO REJRESN                                1020057
376061             GO TO K3165.                                         1020057
376062     MOVE '0' TO WK-FLAG.                                         0266928
376064     MOVE WMS-OPENED-YR          TO SV-OP8-YR.                    0266928
376066     MOVE WMS-OPENED-DA          TO SV-OP8-DA.                    0266928
376068     MOVE WMS-OPENED-MO          TO SV-OP8-MO.                    0266928
376070     IF  WMS-OPENED-YR LESS THAN WBC-NEXT-CENT-YR                 0266928
376071     AND (WMS-OPENED-YR LESS THAN OR EQUAL WBC-CAPTURE-YR)        0266928
376072         MOVE '20'               TO SV-OP8-CENT                   0266928
376073     ELSE                                                         0266928
376074         MOVE '19'               TO SV-OP8-CENT.                  0266928
376075     MOVE '41'                   TO SICOMPDT-DATE-FORMATS.        0266928
376076     CALL 'SICOMPDT' USING SAVE-OPEN-8                            0266928
376078                           WMS-INT-DATE-OPENED                    9715519
376080                           WK-FLAG                                9715519
376082                           SICOMPDT-DATE-FORMATS.                 0266928
376084     IF  WK-FLAG EQUAL 'H'                                        9715519
376086         MOVE 'D1' TO IMEX-CODE-2                                 9715519
376088         MOVE '038' TO REJRESN                                    0717565
376090         GO TO K3165.                                             9715519
376091     MOVE '1' TO WMS-SAVINGS-TRLR.                                9715519
376092     MOVE WMS-INT-DATE-OPENED TO WK-OPEN-DATE.                    9715519
376094     PERFORM CHECK-366 THRU C366-EXIT.                            9715519
376100     MOVE WK-RETURN-FLG TO WMS-INT-LEAP-YEAR-FLG.                 9715519
376101     PERFORM C2100-CHECK-RATE THRU C2100-CHECK-RATE-EXIT.         0817657
376102     IF  WMS-RATE-TRLR EQUAL '0'                                  1003625
376104         MOVE '1' TO WMS-RATE-TRLR                                1003625
376105         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      1003625
376106         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   1003625
376107     IF  WMS-INT-RATE GREATER THAN +0                             0326995
376108     AND WMS-SAV-TIER-PTR EQUAL +0                                0326995
376109         MOVE ZEROS TO WRK-RATE-KEY                               0326995
376110         PERFORM READ-RATE-FILE THRU READ-RATE-END                0326995
376111         MOVE WMS-CONTROL-1 TO WK-CTL-1                           0326995
376112         MOVE RMA-PROC-THRU-TBL (WK-CTL-1)                        0326995
376113                            TO WS-RMA-PROC-THRU-DATE-TABLE        0326995
376114         MOVE CRT-SAV-RATES TO WMS-SAV-RATES                      0326995
376115         MOVE '3' TO WS-RATE-KEY-LEVEL                            0326995
376116         PERFORM READ-RATE-SAV THRU READ-RATE-END                 0326995
376117         IF  WS-RATE-NOT-FOUND = 'Y'                              0326995
376118             MOVE '0'  TO WMS-SAVINGS-TRLR                        0326995
376119             MOVE 'D3' TO IMEX-CODE-2                             0326995
376120             MOVE '060' TO REJRESN                                0717565
376121             GO TO K3165                                          9915845
376122         ELSE                                                     9915845
376123             MOVE WS-RATE-KEY-LEVEL TO WMS-SAV-RATE-KEY-LEVEL     9915845
376124             MOVE RMA-CUR-ILO-DT    TO WMS-SAV-CUR-DATE           9915845
376125             MOVE RMA-CUR-ILO-ANN   TO WMS-SAV-CUR-ANN            9915845
376126             MOVE RMA-PREV-ILO-DT   TO WMS-SAV-PREV-DATE          9915845
376127             MOVE RMA-PREV-ILO-ANN  TO WMS-SAV-PREV-ANN           9915845
376128             PERFORM CALC-DAF-DAYS-SAV                            9715519
376129                THRU CALC-DAF-DAYS-SAV-EXIT                       9715519
376130             PERFORM CALC-SAV-CUR-DAF THRU CALC-SAV-PREV-DAF-EXIT 1003625
376131             PERFORM VERIFY-YR-BOUNDRY-FOR-SAV                    1003625
376132                THRU VERIFY-SAV-EXIT                              1003625
376133             IF  WMS-SAV-CUR-ANN LESS THAN WS-RMA-MIN-IOD-INT     0326995
376134                 MOVE 'D3' TO IMEX-CODE-2                         1003625
376135                 MOVE '096' TO REJRESN                            0717565
376136                 MOVE '0'  TO WMS-SAVINGS-TRLR                    9915845
376137                 GO TO K3165                                      9915845
376138             ELSE                                                 9915845
376139                 MOVE 'Y' TO WMS-SAV-RATE-FLAG                    9915845
376140                 PERFORM C2103 THRU C2103-END.                    1003625
376148     IF  WMS-SAV-TIER-PTR GREATER THAN +0                         0316967
376150         MOVE CRT-SAV-RATES TO WMS-SAV-RATES                      0316967
376152         MOVE '3' TO WS-RATE-KEY-LEVEL                            0316967
376154         PERFORM READ-RATE-SAV-TIER THRU READ-RATE-END            0316967
376156         IF  WS-RATE-NOT-FOUND = 'Y'                              0316967
376157             MOVE '0'  TO WMS-SAVINGS-TRLR                        0316967
376158             MOVE 'D3' TO IMEX-CODE-2                             0316967
376160             MOVE '060' TO REJRESN                                0717565
376161             GO TO K3165                                          0316967
376162         ELSE                                                     0316967
376163             MOVE WS-RATE-KEY-LEVEL TO WMS-SAV-RATE-KEY-LEVEL     0316967
376164             MOVE RMA-CUR-TIERED-DT TO WMS-SAV-CUR-DATE           0316967
376165             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-SAV-CUR-ANN        0316967
376166             MOVE RMA-PREV-TIERED-DT TO WMS-SAV-PREV-DATE         0316967
376167             MOVE RMA-PREV-TIERED-ANN(1) TO WMS-SAV-PREV-ANN      0316967
376168             PERFORM CALC-DAF-DAYS-SAV                            0316967
376169                THRU CALC-DAF-DAYS-SAV-EXIT                       0316967
376170             PERFORM CALC-SAV-CUR-DAF THRU CALC-SAV-PREV-DAF-EXIT 0316967
376171             PERFORM VERIFY-YR-BOUNDRY-FOR-SAV                    0316967
376172                THRU VERIFY-SAV-EXIT                              0316967
376173             IF  WMS-SAV-CUR-ANN EQUAL TO ZERO                    0316967
376174                 MOVE 'D3' TO IMEX-CODE-2                         0316967
376175                 MOVE '061' TO REJRESN                            0717565
376176                 MOVE '0'  TO WMS-SAVINGS-TRLR                    0316967
376177                 GO TO K3165                                      0316967
376178             ELSE                                                 0316967
376179                 MOVE 'Y' TO WMS-SAV-RATE-FLAG                    0316967
376180                 PERFORM C2103A THRU C2103A-END.                  0316967
376190     MOVE WMS-INT-STATUS TO SAVINGS-STATUS-IN, WK-SV-STATUS-IN.   0316967
376200     MOVE '1' TO WMS-INT-NEW-THIS-MONTH.
376300     ADD WS-TRL-SAVINGS-LNGTH TO WMS-LENGTH.                      0903291
376310     IF  WMS-INT-INV-IND EQUAL 'N'                                1004554
376350         ADD +1 TO SAV-NEW-NO, WS-GL-SAV-NEW-NO.                  1004554
376400     MOVE '03' TO IMEX-REC-NO.
376450     MOVE 'C0C3' TO IMEX-EX-CODE.                                 9915845
376500     MOVE 'D01' TO EX03-TYP-NO.
376550     PERFORM C2197 THRU C2198.
376552     MOVE NEW-MASTER-SW TO HOLD-NEW-MASTER-SW.                    9715519
376554     MOVE WMS-DATE-OPENED TO HOLD-OPEN-DATE.                      9715519
376556     MOVE '1' TO NEW-MASTER-SW.                                   9715519
376558     MOVE WMS-INT-DATE-OPENED TO WMS-DATE-OPENED.                 9715519
376570     PERFORM INIT-BH-SAV THRU INIT-BH-SAV-EXIT.                   0902213
376572     MOVE HOLD-NEW-MASTER-SW TO NEW-MASTER-SW.                    9715519
376574     MOVE HOLD-OPEN-DATE TO WMS-DATE-OPENED.                      9715519
376580     IF  WMS-INT-INV-IND EQUAL 'Y'                                1004554
376584         MOVE '1' TO WK-INVEST-FUNCTION                           1004554
376586         PERFORM CALL-INVEST-PHASE THRU CALL-INVEST-EXIT.         1004554
376587*----------------------------------------------------------------*9715519
376588*    SAV-BKDT-DAYS-FLAG WILL BE SET TO '1' FOR BACKDATED NEW     *9715519
376589*    SAVINGS TRAILERS.  THE FIRST BACKDATED SAVINGS TRANSACTION  *9715519
376590*    WILL SET THE SERVICE CHARGE, MONTH-TO-DATE, AND YEAR-TO-DATE*9715519
376591*    AGGREGATE DAYS.                                             *9715519
376592*----------------------------------------------------------------*9715519
376593     MOVE '0' TO WK-FLAG.                                         9715519
376594     CALL 'SICOMPDT' USING WMS-INT-DATE-OPENED                    9715519
376595                           WBC-CAPTURE-DATE                       0266741
376596                           WK-FLAG                                9715519
376597                           WK-FORMAT.                             9715519
376598     IF  WK-FLAG EQUAL 'L'                                        9715519
376599         MOVE '1' TO SAV-BKDT-DAYS-FLAG.                          9715519
376600     GO TO K3195.
376650     SKIP3
376700*    **************  LOAN TRAILER ADDITION  ****************
376750     SKIP1
376800 K3300.
376850     IF WMS-LOAN-TRLR EQUAL TO '1'
376900         MOVE '017' TO REJRESN                                    0717565
376910         GO TO K3165.                                             2016639
376920     IF WBC-LOAN-FLAG EQUAL TO '0'                                0266741
376922         MOVE '024' TO REJRESN                                    0717565
376924         GO TO K3165.                                             2016639
376925     IF WMS-PLAN-TRLR EQUAL TO '1'                                0617360
376927         MOVE '038' TO REJRESN                                    0717565
376929         GO TO K3165.                                             0617360
376930     IF  (WMS-XINV-LINK-IND    NOT EQUAL ' ' AND 'D')             2016639
376932     AND (WMS-XINV-PROCESS-IND     EQUAL '1')                     2016639
376934         IF  (TR-AUTO-PYMT         EQUAL '1')                     2016639
376936             MOVE 'D3' TO IMEX-CODE-2                             2016639
376938             MOVE '095' TO REJRESN                                0717565
376940             GO TO K3165.                                         2016639
376942     IF  WMS-PASSBOOK-ACCT EQUAL '1'                              0427139
376944         MOVE 'D1' TO IMEX-CODE-2                                 0427139
376946         MOVE '097' TO REJRESN                                    0717565
376948         GO TO K3165.                                             0427139
376950* STATEMENT SAVINGS                                               0437111
376952     IF  WMS-MMDA-INDICATOR EQUAL '2' OR '3'                      0437111
376954         MOVE 'D3' TO IMEX-CODE-2                                 0437111
376956         MOVE '099' TO REJRESN                                    0717565
376958         GO TO K3165.                                             0437111
376960*                                                                 1020057
376962     MOVE TR-TRAILER TO WMS-LOAN-TRAILER.                         1020057
376964     IF WMS-SAVINGS-TRLR EQUAL '1'                                1020057
376966     AND WMS-CMA-INDICATOR EQUAL '1'                              1020057
376968     AND WMS-CRED-CARD-IND EQUAL 'Y'                              1020057
376970         MOVE '105' TO REJRESN                                    1020057
376972         GO TO K3165.                                             1020057
376974*----------------------------------------------------------------*1020057
376976*    DO NOT ALLOW THE EXTENSION OF CREDIT TO UNDERAGE CONSUMERS. *1020057
376978*----------------------------------------------------------------*1020057
376980     IF  WMS-TIS-CONSUMER-FLAG EQUAL 'Y'                          1020057
376982     AND WMS-CRED-CARD-IND EQUAL 'Y'                              1020057
376984     AND WBC-REG-Z EQUAL '1'                                      1020057
376986         NEXT SENTENCE                                            1020057
376988     ELSE                                                         1020057
376990         GO TO K3300-CONT.                                        1020057
376992     IF  WMS-LOAN-CONSENT EQUAL 'Y'                               1020057
376994         GO TO K3300-CONT.                                        1020057
376996     IF  WMS-BIRTHDATE EQUAL SPACES                               1020057
376998         MOVE '103' TO REJRESN                                    1020057
377000         GO TO K3165.                                             1020057
377001     MOVE WMS-BIRTH-MO TO DT-L-MO.                                1020057
377002     MOVE WMS-BIRTH-DA TO DT-L-DA.                                1020057
377003     MOVE WMS-BIRTH-YR TO DT-L-YR.                                1020057
377004     MOVE +252 TO RET-DAYS.                                       1020057
377005     CALL 'SIDMHI' USING DATE-AREA.                               1020057
377006     MOVE '11'          TO SICOMPDT-DATE-FORMATS.                 1020057
377007     CALL 'SICOMPDT' USING DT-HIGH-DATE                           1020057
377008                           WMS-APPROVAL-DATE                      1020057
377009                           SICOMPDT-RETURN-FLAG                   1020057
377010                           SICOMPDT-DATE-FORMATS.                 1020057
377011     IF  SICOMPDT-RETURN-FLAG NOT EQUAL 'L'                       1020057
377012         MOVE '103' TO REJRESN                                    1020057
377013         GO TO K3165.                                             1020057
377014                                                                  1020057
377015 K3300-CONT.                                                      1020057
377016     IF  WMS-TIS-CONSUMER-FLAG EQUAL 'Y'                          1020057
377017     AND WMS-CRED-CARD-IND EQUAL 'Y'                              1020057
377018     AND WBC-REG-Z EQUAL '1'                                      1020057
377019         MOVE '1' TO RATE-CHG-SW                                  1020057
377020     ELSE                                                         1020057
377021         MOVE '0' TO RATE-CHG-SW.                                 1020057
377022     IF  WMS-RATE-TRLR EQUAL '0'                                  1020057
377023         MOVE '1' TO WMS-RATE-TRLR                                1020057
377024         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      1020057
377025         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   1020057
377026     PERFORM CALC-DAF-DAYS-LOAN THRU CALC-DAF-DAYS-LOAN-EXIT.     1020057
377027     IF  WMS-INT-RATE-PTR EQUAL +6 OR +7                          1020057
377028         MOVE CRT-PRM-RATE TO WMS-PRM-RATE                        1020057
377029         MOVE '3' TO WS-RATE-KEY-LEVEL                            1020057
377030         PERFORM READ-RATE-PRIME THRU READ-RATE-END               1020057
377031         IF  WS-RATE-NOT-FOUND = 'Y'                              1020057
377032             MOVE 'D3' TO IMEX-CODE-2                             1020057
377033             MOVE '060' TO REJRESN                                1020057
377034             GO TO K3165                                          1003625
377036         ELSE                                                     1003625
377038             MOVE WS-RATE-KEY-LEVEL   TO WMS-LN-RATE-KEY-LEVEL    1003625
377040             MOVE RMA-CUR-PRIME-DT        TO WMS-PRM-CUR-DATE     9915845
377041             MOVE RMA-CUR-PRIME-ANN       TO WMS-PRM-CUR-ANN      9915845
377042             MOVE ZEROS                   TO WMS-PRM-CUR-DAF      9915845
377043             MOVE RMA-CUR-PRIME-ADJ-CODE  TO WMS-PRM-CUR-ADC      9915845
377044             MOVE RMA-CUR-PRIME-BAL-CALC  TO WMS-PRM-CUR-BCL      9915845
377045             MOVE RMA-CUR-PRIME-ADJ(1)    TO WMS-PRM-CUR-ADJ(1)   9915845
377046             MOVE RMA-CUR-PRIME-ADJ(2)    TO WMS-PRM-CUR-ADJ(2)   9915845
377047             MOVE RMA-CUR-PRIME-ADJ(3)    TO WMS-PRM-CUR-ADJ(3)   9915845
377048             MOVE RMA-CUR-PRIME-ADJ(4)    TO WMS-PRM-CUR-ADJ(4)   9915845
377049             MOVE RMA-CUR-PRIME-ADJ(5)    TO WMS-PRM-CUR-ADJ(5)   9915845
377050             MOVE RMA-CUR-PRIME-LMT(1)    TO WMS-PRM-CUR-LMT(1)   9915845
377051             MOVE RMA-CUR-PRIME-LMT(2)    TO WMS-PRM-CUR-LMT(2)   9915845
377052             MOVE RMA-CUR-PRIME-LMT(3)    TO WMS-PRM-CUR-LMT(3)   9915845
377053             MOVE RMA-CUR-PRIME-LMT(4)    TO WMS-PRM-CUR-LMT(4)   9915845
377054             MOVE RMA-PREV-PRIME-DT       TO WMS-PRM-PREV-DATE    9915845
377055             MOVE RMA-PREV-PRIME-ANN      TO WMS-PRM-PREV-ANN     9915845
377056             MOVE ZEROS                   TO WMS-PRM-PREV-DAF     9915845
377057             MOVE RMA-PREV-PRIME-ADJ-CODE TO WMS-PRM-PREV-ADC     9915845
377058             MOVE RMA-PREV-PRIME-BAL-CALC TO WMS-PRM-PREV-BCL     9915845
377059             MOVE RMA-PREV-PRIME-ADJ(1)   TO WMS-PRM-PREV-ADJ(1)  9915845
377060             MOVE RMA-PREV-PRIME-ADJ(2)   TO WMS-PRM-PREV-ADJ(2)  9915845
377061             MOVE RMA-PREV-PRIME-ADJ(3)   TO WMS-PRM-PREV-ADJ(3)  9915845
377062             MOVE RMA-PREV-PRIME-ADJ(4)   TO WMS-PRM-PREV-ADJ(4)  9915845
377063             MOVE RMA-PREV-PRIME-ADJ(5)   TO WMS-PRM-PREV-ADJ(5)  9915845
377064             MOVE RMA-PREV-PRIME-LMT(1)   TO WMS-PRM-PREV-LMT(1)  9915845
377065             MOVE RMA-PREV-PRIME-LMT(2)   TO WMS-PRM-PREV-LMT(2)  9915845
377066             MOVE RMA-PREV-PRIME-LMT(3)   TO WMS-PRM-PREV-LMT(3)  9915845
377067             MOVE RMA-PREV-PRIME-LMT(4)   TO WMS-PRM-PREV-LMT(4)  9915845
377068             PERFORM CALC-LOAN-CUR-DAF                            9915845
377069                THRU CALC-LOAN-PREV-DAF-EXIT                      9915845
377070             PERFORM VERIFY-YR-BOUNDRY-FOR-PRIME                  9915845
377071                THRU VERIFY-PRIME-EXIT                            9915845
377072             MOVE 'Y' TO WMS-LN-RATE-FLAG                         9915845
377073             IF  WMS-PRIME-RATE EQUAL ZEROES                      9915845
377074                 MOVE RMA-CUR-PRIME-ANN TO WMS-PRIME-RATE         9915845
377075             ELSE                                                 9915845
377076                 NEXT SENTENCE                                    9915845
377077     ELSE                                                         9915845
377078     IF  WMS-INT-RATE-PTR GREATER THAN +0                         9915845
377079         MOVE CRT-LN-RATES TO WMS-LN-RATES                        9915845
377080         MOVE '3' TO WS-RATE-KEY-LEVEL                            9915845
377081         PERFORM READ-RATE-LOAN THRU READ-RATE-END                9915845
377082         IF  WS-RATE-NOT-FOUND = 'Y'                              9915845
377083             MOVE 'D3' TO IMEX-CODE-2                             9915845
377084             MOVE '060' TO REJRESN                                0717565
377085             GO TO K3165                                          9915845
377086         ELSE                                                     9915845
377087             MOVE WS-RATE-KEY-LEVEL TO WMS-LN-RATE-KEY-LEVEL      9915845
377088             MOVE RMA-CUR-ILO-DT    TO WMS-LN-CUR-DATE            9915845
377089             MOVE RMA-CUR-ILO-ANN   TO WMS-LN-CUR-ANN             9915845
377090             MOVE RMA-PREV-ILO-DT   TO WMS-LN-PREV-DATE           9915845
377091             MOVE RMA-PREV-ILO-ANN  TO WMS-LN-PREV-ANN            9915845
377092             PERFORM CALC-LOAN-CUR-DAF                            9915845
377093                THRU CALC-LOAN-PREV-DAF-EXIT                      9915845
377094             PERFORM VERIFY-YR-BOUNDRY-FOR-LOAN                   9915845
377095                THRU VERIFY-LOAN-EXIT                             9915845
377096             MOVE WMS-LN-CUR-ANN    TO WMS-ANNUAL-RATE            9915845
377097             MOVE WMS-LN-CUR-DAF    TO WMS-DAILY-RATE             9915845
377098             MOVE 'Y' TO WMS-LN-RATE-FLAG                         9915845
377099     ELSE                                                         9915845
377100     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      1003625
377102         MOVE CRT-SPL-RATES TO WMS-SPL-RATES                      1003625
377104         MOVE '3' TO WS-RATE-KEY-LEVEL                            1003625
377106         PERFORM READ-RATE-SPLIT THRU READ-RATE-END               1003625
377108         IF  WS-RATE-NOT-FOUND = 'Y'                              1003625
377110             MOVE 'D3' TO IMEX-CODE-2                             1003625
377112             MOVE '060' TO REJRESN                                0717565
377114             GO TO K3165                                          1003625
377116         ELSE                                                     1003625
377118             MOVE WS-RATE-KEY-LEVEL   TO WMS-SPL-RATE-KEY-LEVEL   1003625
377119             MOVE RMA-CUR-SPLIT-DT  TO WMS-SPL-CUR-DATE           9915845
377120             MOVE RMA-CUR-SPLIT-ANN(1) TO WMS-SPL-CUR-ANN(1)      9915845
377121             MOVE RMA-CUR-SPLIT-ANN(2) TO WMS-SPL-CUR-ANN(2)      9915845
377122             MOVE RMA-CUR-SPLIT-ANN(3) TO WMS-SPL-CUR-ANN(3)      9915845
377123             MOVE RMA-CUR-SPLIT-LMT(1) TO WMS-SPL-CUR-LMT(1)      9915845
377124             MOVE RMA-CUR-SPLIT-LMT(2) TO WMS-SPL-CUR-LMT(2)      9915845
377125             MOVE RMA-PREV-SPLIT-DT  TO WMS-SPL-PREV-DATE         9915845
377126             MOVE RMA-PREV-SPLIT-ANN(1) TO WMS-SPL-PREV-ANN(1)    9915845
377127             MOVE RMA-PREV-SPLIT-ANN(2) TO WMS-SPL-PREV-ANN(2)    9915845
377128             MOVE RMA-PREV-SPLIT-ANN(3) TO WMS-SPL-PREV-ANN(3)    9915845
377129             MOVE RMA-PREV-SPLIT-LMT(1) TO WMS-SPL-PREV-LMT(1)    9915845
377130             MOVE RMA-PREV-SPLIT-LMT(2) TO WMS-SPL-PREV-LMT(2)    9915845
377131             PERFORM CALC-LOAN-CUR-DAF                            9915845
377132                THRU CALC-LOAN-PREV-DAF-EXIT                      9915845
377133             PERFORM VERIFY-YR-BOUNDRY-FOR-SPLIT                  9915845
377134                THRU VERIFY-SPLIT-EXIT                            9915845
377135             MOVE WMS-SPL-CUR-ANN (1)    TO WMS-RATE1-ANNUAL      9915845
377136             MOVE WMS-SPL-CUR-DAF (1)    TO WMS-RATE1-DAILY       9915845
377137             MOVE WMS-SPL-CUR-ANN (2)    TO WMS-RATE2-ANNUAL      9915845
377138             MOVE WMS-SPL-CUR-DAF (2)    TO WMS-RATE2-DAILY       1003625
377140             MOVE WMS-SPL-CUR-ANN (3)    TO WMS-RATE3-ANNUAL      1003625
377142             MOVE WMS-SPL-CUR-DAF (3)    TO WMS-RATE3-DAILY       1003625
377144             MOVE WMS-SPL-CUR-LMT (1)    TO WMS-RATE1-LIMIT       1003625
377146             MOVE WMS-SPL-CUR-LMT (2)    TO WMS-RATE2-LIMIT       1003625
377148             MOVE 'Y' TO WMS-LN-RATE-FLAG.                        1003625
377150                                                                  1003625
377152     IF  WMS-PREV-INT-PTR GREATER THAN +0                         1003625
377154         MOVE CRT-LN-OLD-RATES TO WMS-LN-OLD-RATES                1003625
377156         MOVE '3' TO WS-RATE-KEY-LEVEL                            1003625
377158         PERFORM READ-RATE-LOAN-PREV THRU READ-RATE-END           1003625
377160         IF  WS-RATE-NOT-FOUND = 'Y'                              1003625
377162             MOVE 'D3' TO IMEX-CODE-2                             1003625
377164             MOVE '060' TO REJRESN                                0717565
377166             GO TO K3165                                          1003625
377168         ELSE                                                     1003625
377170             MOVE WS-RATE-KEY-LEVEL TO WMS-LN-OLD-RATE-KEY-LEVEL  1003625
377171             MOVE RMA-CUR-ILO-DT    TO WMS-LN-OLD-CUR-DATE        9915845
377172             MOVE RMA-CUR-ILO-ANN   TO WMS-LN-OLD-CUR-ANN         9915845
377173             MOVE RMA-PREV-ILO-DT   TO WMS-LN-OLD-PREV-DATE       9915845
377174             MOVE RMA-PREV-ILO-ANN  TO WMS-LN-OLD-PREV-ANN        9915845
377176             PERFORM CALC-LOAN-OLD-CUR-DAF                        1003625
377178                THRU CALC-LOAN-OLD-PREV-DAF-EXIT                  1003625
377180             PERFORM VERIFY-YR-BOUNDRY-FOR-OLD-LOAN               1003625
377182                THRU VERIFY-OLD-LOAN-EXIT                         1003625
377184             MOVE WMS-LN-OLD-CUR-ANN    TO WMS-PREV-ANNUAL        1003625
377186             MOVE WMS-LN-OLD-CUR-DAF    TO WMS-PREV-DAILY         1003625
377188             MOVE 'Y' TO WMS-LN-RATE-FLAG                         1003625
377190     ELSE                                                         1003625
377192     IF  WMS-PREV-SPLIT-RATE-PTR GREATER THAN +0                  1003625
377194         MOVE CRT-SPL-OLD-RATES TO WMS-SPL-OLD-RATES              1003625
377196         MOVE '3' TO WS-RATE-KEY-LEVEL                            1003625
377198         PERFORM READ-RATE-SPLIT-PREV THRU READ-RATE-END          1003625
377200         IF  WS-RATE-NOT-FOUND = 'Y'                              1003625
377201             MOVE 'D3' TO IMEX-CODE-2                             9915845
377202             MOVE '060' TO REJRESN                                0717565
377203             GO TO K3165                                          9915845
377204         ELSE                                                     9915845
377205             MOVE WS-RATE-KEY-LEVEL TO WMS-SPL-OLD-RATE-KEY-LEVEL 9915845
377206             MOVE RMA-CUR-SPLIT-DT    TO WMS-SPL-OLD-CUR-DATE     9915845
377207             MOVE RMA-CUR-SPLIT-ANN(1) TO WMS-SPL-OLD-CUR-ANN(1)  9915845
377208             MOVE RMA-CUR-SPLIT-ANN(2) TO WMS-SPL-OLD-CUR-ANN(2)  9915845
377209             MOVE RMA-CUR-SPLIT-ANN(3) TO WMS-SPL-OLD-CUR-ANN(3)  9915845
377210             MOVE RMA-CUR-SPLIT-LMT(1) TO WMS-SPL-OLD-CUR-LMT(1)  9915845
377211             MOVE RMA-CUR-SPLIT-LMT(2) TO WMS-SPL-OLD-CUR-LMT(2)  9915845
377212             MOVE RMA-PREV-SPLIT-DT   TO WMS-SPL-OLD-PREV-DATE    9915845
377213             MOVE RMA-PREV-SPLIT-ANN(1) TO WMS-SPL-OLD-PREV-ANN(1)9915845
377214             MOVE RMA-PREV-SPLIT-ANN(2) TO WMS-SPL-OLD-PREV-ANN(2)9915845
377215             MOVE RMA-PREV-SPLIT-ANN(3) TO WMS-SPL-OLD-PREV-ANN(3)9915845
377216             MOVE RMA-PREV-SPLIT-LMT(1) TO WMS-SPL-OLD-PREV-LMT(1)9915845
377217             MOVE RMA-PREV-SPLIT-LMT(2) TO WMS-SPL-OLD-PREV-LMT(2)9915845
377218             PERFORM CALC-LOAN-OLD-CUR-DAF                        9915845
377219                THRU CALC-LOAN-OLD-PREV-DAF-EXIT                  9915845
377220             PERFORM VERIFY-YR-BOUNDRY-FOR-OLD-SPL                1003625
377222                THRU VERIFY-OLD-SPLIT-EXIT                        1003625
377224             MOVE 'Y' TO WMS-LN-RATE-FLAG.                        1003625
377226                                                                  1003625
377228     PERFORM C2105 THRU C2109-END.                                1003625
377235*                                                                 1003625
377236*----------------------------------------------------------------*1003625
377238*    THE FOLLOWING EDITS WERE MOVED HERE FROM IM22.  BECAUSE     *1003625
377240*    THE RATE TRAILER IS NOT ADDED UNTIL IM31, CERTAIN FIELD     *1003625
377242*    COMBINATIONS WERE NOT AVAILABLE TO VALIDATE UNTIL NOW.      *1003625
377244*----------------------------------------------------------------*1003625
377245*                                                                 1003625
377246     IF  WMS-INT-RATE-PTR GREATER THAN +0 AND LESS THAN +6        1003625
377248         IF  WMS-LN-CUR-ANN EQUAL TO ZERO                         1003625
377250             MOVE '061' TO REJRESN                                0717565
377252             GO TO K3165                                          1003625
377254         ELSE                                                     1003625
377256             GO TO K3300-00.                                      1003625
377258     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      1003625
377260         IF  WMS-SPL-CUR-ANN (1) EQUAL TO ZERO                    1003625
377262         AND WMS-SPL-CUR-ANN (2) EQUAL TO ZERO                    1003625
377264         AND WMS-SPL-CUR-ANN (3) EQUAL TO ZERO                    1003625
377266             MOVE '061' TO REJRESN                                0717565
377268             GO TO K3165                                          1003625
377270         ELSE                                                     1003625
377272             GO TO K3300-00.                                      1003625
377274     IF  WMS-INT-RATE-PTR GREATER THAN +5                         1003625
377276         IF  WMS-PRM-CUR-ANN EQUAL TO ZERO                        1003625
377278             MOVE '061' TO REJRESN                                0717565
377280             GO TO K3165.                                         1003625
377282     IF  WMS-INT-RATE-PTR EQUAL +6                                1003625
377284         IF  WMS-PRIME-BAL-CALC EQUAL '0'                         1003625
377286         AND WMS-PRM-CUR-BCL EQUAL '2'                            1003625
377288             MOVE '063' TO REJRESN                                0717565
377290             GO TO K3165.                                         1003625
377292     IF  WMS-INT-RATE-PTR EQUAL +7                                1003625
377294         IF  WMS-PRM-CUR-LMT (1) EQUAL +9999999999999.99          9915845
377296             MOVE '063' TO REJRESN                                0717565
377298             GO TO K3165                                          1003625
377300         ELSE                                                     1003625
377302             IF  WMS-PRIME-BAL-CALC EQUAL '0'                     1003625
377304             AND WMS-PRM-CUR-BCL EQUAL '1'                        1003625
377306                 MOVE '063' TO REJRESN                            0717565
377308                 GO TO K3165.                                     1003625
377310     IF  WMS-PRIME-BAL-CALC EQUAL '0'                             1003625
377312     AND (WMS-PRM-CUR-BCL EQUAL '2' OR '3')                       1003625
377314         IF  WMS-PYMT-CALC-CODE NOT EQUAL '0'                     1003625
377316             MOVE '063' TO REJRESN                                0717565
377318             GO TO K3165.                                         1003625
377320 K3300-00.                                                        1003625
377322     IF  WMS-MAX-LOAN-INT EQUAL ZERO                              1003625
377324         GO TO K3300-04.                                          1003625
377326     IF  (WMS-INT-RATE-PTR GREATER THAN +0 AND LESS THAN +6)      1003625
377328         IF  WMS-LN-CUR-ANN GREATER THAN WMS-MAX-LOAN-INT         1003625
377330             MOVE '062' TO REJRESN                                0717565
377332             GO TO K3165.                                         1003625
377334     IF  WMS-INT-RATE-PTR NOT EQUAL +6                            1003625
377336         GO TO K3300-01.                                          1003625
377338**** RATE POINTER EQUAL 6 (TIED TO PRIME RATE)                    1003625
377340     MOVE +0 TO HOLD-PRIME-RATE.                                  1003625
377342     IF  WMS-PRIME-ADJ-CODE EQUAL '1'                             1003625
377344         ADD WMS-PRIME-RATE WMS-PRIME-ADJ GIVING HOLD-PRIME-RATE. 1003625
377346     IF  WMS-PRIME-ADJ-CODE EQUAL '2'                             1003625
377348         SUBTRACT WMS-PRIME-ADJ FROM WMS-PRIME-RATE               1003625
377350             GIVING HOLD-PRIME-RATE.                              1003625
377352     IF  WMS-PRIME-ADJ-CODE EQUAL '3'                             1003625
377354         MULTIPLY WMS-PRIME-RATE BY WMS-PRIME-ADJ                 1003625
377356             GIVING HOLD-PRIME-RATE.                              1003625
377358     IF  HOLD-PRIME-RATE GREATER THAN WMS-MAX-LOAN-INT            1003625
377360         MOVE '062' TO REJRESN                                    0717565
377362         GO TO K3165.                                             1003625
377364 K3300-01.                                                        1003625
377366     IF  WMS-INT-RATE-PTR NOT EQUAL +7                            1003625
377368         GO TO K3300-03.                                          9915749
377370     MOVE +1 TO X.                                                1003625
377372     MOVE +0 TO HOLD-PRIME-RATE.                                  1003625
377374**** RATE POINTER EQUAL 7 (TIED TO PRIME RANGES)                  1003625
377376 K3300-02.                                                        1003625
377378     IF  WMS-PRM-CUR-ADC EQUAL '1'                                1003625
377380         ADD WMS-PRIME-RATE WMS-PRM-CUR-ADJ (X)                   1003625
377382             GIVING HOLD-PRIME-RATE.                              1003625
377384     IF  WMS-PRM-CUR-ADC EQUAL '2'                                1003625
377386         SUBTRACT WMS-PRM-CUR-ADJ (X) FROM WMS-PRIME-RATE         1003625
377388             GIVING HOLD-PRIME-RATE.                              1003625
377390     IF  WMS-PRM-CUR-ADC EQUAL '3'                                1003625
377392         MULTIPLY WMS-PRIME-RATE BY WMS-PRM-CUR-ADJ (X)           1003625
377394             GIVING HOLD-PRIME-RATE.                              1003625
377396     IF  HOLD-PRIME-RATE GREATER THAN WMS-MAX-LOAN-INT            1003625
377398         MOVE '062' TO REJRESN                                    0717565
377400         GO TO K3165.                                             1003625
377402     ADD +1 TO X.                                                 1003625
377404     IF  X LESS THAN +6                                           1003625
377406         GO TO K3300-02.                                          1003625
377408 K3300-03.                                                        1003625
377410     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      1003625
377412         IF  WMS-SPL-CUR-ANN (+1) GREATER THAN WMS-MAX-LOAN-INT   1003625
377414         OR  WMS-SPL-CUR-ANN (+2) GREATER THAN WMS-MAX-LOAN-INT   1003625
377416         OR  WMS-SPL-CUR-ANN (+3) GREATER THAN WMS-MAX-LOAN-INT   1003625
377418             MOVE '062' TO REJRESN                                0717565
377420             GO TO K3165.                                         1003625
377422 K3300-04.                                                        1003625
377424     MOVE '1' TO WMS-LOAN-TRLR, WMS-LOAN-NEW-THIS-MONTH.          1003625
377425     MOVE '1' TO NEW-LOAN-SW.                                     1020057
377426     MOVE WMS-LOAN-STATUS TO LOAN-STATUS-IN, WK-LN-STATUS-IN.     1003625
377428     MOVE WMS-PRIN-BAL TO LOAN-BAL-IN.                            1003625
377430     MOVE WMS-PREV-BAL TO LOAN-PREV-BAL-IN.                       1003625
377432     IF  WMS-LOAN-INCR-PTR NUMERIC                                1003625
377434     AND WMS-LOAN-INCR-PTR GREATER THAN ZERO                      1003625
377436         MOVE WBC-LOAN-INCR OF WBC-LOAN-INCR-TABLE                0266741
377438             (WMS-LOAN-INCR-PTR) TO HOLD-INCRM                    1003625
377460     ELSE                                                         1003979
377470         MOVE ZEROES             TO HOLD-INCRM.                   1003979
377500     PERFORM C2270 THRU C2270-EXIT.
377550     PERFORM C2302 THRU C2306-EXIT.                               IM008
377600     PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
377610     MOVE WMS-AVAIL-BAL TO WMS-LOAN-ORIG-AVAIL.                   1004773
377615     IF  WMS-OFF-EMP EQUAL '6'                                    1105132
377620         ADD +1 TO WBC-TFR-SPC900-NO                              0266741
377625         ADD WMS-AVAIL-BAL TO WBC-REG-TFR-AMT (12).               0266741
377650     IF WMS-INT-RATE-PTR EQUAL +6 OR +7
377700         PERFORM PRIME-RATE-CALC THRU PRIME-EXIT.
377750     ADD +1 TO LOAN-NEW-NO, WS-GL-LOAN-NEW-NO.                    0902970
377800     ADD WMS-AVAIL-BAL TO LOAN-NEW-CR-LIM, WS-GL-LOAN-NEW-CR-LIM. 0902970
377850     ADD WS-TRL-LOAN-LNGTH TO WMS-LENGTH.                         0903291
377860*----------------------------------------------------------------*1105504
377870*    IF LOAN OFFICER IS NOT TO BE LINKED TO WMS-OFFICER,         *1105504
377875*    COMMENT NEXT TWO LINES.                                     *1105504
377880*----------------------------------------------------------------*1105504
377900     IF WMS-LOAN-OFFICER EQUAL TO SPACES                          1105504
377950         MOVE WMS-OFFICER TO WMS-LOAN-OFFICER.                    1105504
377960     IF  WBC-DLCA-FLAG EQUAL '0'                                  0266741
378000         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
378010     MOVE WBC-LAST-PROC-THRU-DATE TO WMS-DATE-LAST-BILLING.       0266741
378020     MOVE ZERO                   TO WMS-LN-BILL-CY-DAYS.          1004643
378050     MOVE '03' TO IMEX-REC-NO.
378100     MOVE 'C0C1' TO IMEX-EX-CODE.
378150     MOVE 'C01' TO EX03-TYP-NO.
378160     IF  WMS-CAPITALIZATION EQUAL '1'                             9915852
378162         MOVE ZERO  TO WMS-YTD-INT-CAP                            9915845
378164                       WMS-INT-CAP.                               9915845
378170     GO TO K3195.                                                 0617360
378187                                                                  0617360
378188*    **************  PLAN TRAILER ADDITION  ****************      0617360
378189                                                                  0617360
378190 K3350.                                                           0617360
378191     IF WMS-PLAN-TRLR EQUAL TO '1'                                0617360
378192         MOVE '017' TO REJRESN                                    0717565
378193         GO TO K3165.                                             0617360
378194     IF WMS-SAVINGS-TRLR EQUAL TO '1'                             0617360
378195     OR WMS-LOAN-TRLR EQUAL TO '1'                                0617360
378196     OR WMS-OD-ACCRUAL-TRLR EQUAL TO '1'                          0617360
378197     OR WMS-INVESTMENT-TRLR EQUAL TO '1'                          0617360
378198     OR WMS-TARGET-AMT-TRLR EQUAL TO '1'                          0617360
378199     OR WMS-LIMIT-TRANSFER EQUAL TO '1'                           0617360
378200     OR WMS-LIST-POST GREATER THAN '0'                            0617360
378201     OR WMS-IOD-DIST-CD GREATER THAN '0'                          0617360
378202         MOVE '038' TO REJRESN                                    0717565
378203         GO TO K3165.                                             0617360
378204     MOVE +0 TO X.                                                0617360
378205     MOVE TR-TRAILER TO WMS-PLN-TRLR-INFO.                        0617360
378206     MOVE '1' TO WMS-PLAN-TRLR.                                   0617360
378207     ADD WS-TRL-PLAN-LNGTH TO WMS-LENGTH.                         0617360
378208     MOVE '03' TO IMEX-REC-NO.                                    0617360
378209     MOVE 'C0' TO IMEX-CODE-1.                                    0617360
378210     MOVE 'Y01' TO EX03-TYP-NO.                                   0617360
378211     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0617360
378212     IF  WMS-TRAILERS EQUAL TO NO-TRAILERS                        0617360
378213     AND WMS-DC-TRLR  EQUAL TO '0'                                0617360
378214         MOVE '0' TO WMS-EXPANSION-IND                            0617360
378215     ELSE                                                         0617360
378216         MOVE '1' TO WMS-EXPANSION-IND.                           0617360
378217                                                                  0617360
378218 K3351.                                                           0617360
378219*----------------------------------------------------------------*0617360
378220*  AGE 55 OR 660 MONTHS FROM BIRTHDATE FOR REG MINIMUM DATE.     *0617360
378221*----------------------------------------------------------------*0617360
378222     MOVE WMS-BIRTH-MO   TO WS-BD-MO.                             0617360
378223     MOVE WMS-BIRTH-DA   TO WS-BD-DA.                             0617360
378224     MOVE WMS-BIRTH-YR   TO WS-BD-YR.                             0617360
378225     MOVE WMS-BIRTH-CENT TO WS-BD-CENT.                           0617360
378226     MOVE 660            TO C-NO-DAYS.                            0617360
378227     CALL 'SIDCMHI'   USING WS-BIRTH-DATE                         0617360
378228                            WMS-PLN-TRLR-REG-MIN-DATE             0617360
378229                            C-NO-DAYS.                            0617360
378230*----------------------------------------------------------------*0617360
378231*  AGE 65 OR 780 MONTHS FROM BIRTHDATE FOR REG MAXIMUM DATE.     *0617360
378232*----------------------------------------------------------------*0617360
378233     MOVE 780            TO C-NO-DAYS.                            0617360
378234     CALL 'SIDCMHI'   USING WS-BIRTH-DATE                         0617360
378235                            WMS-PLN-TRLR-REG-MAX-DATE             0617360
378236                            C-NO-DAYS.                            0617360
378237*----------------------------------------------------------------*0617360
378238*    PLAN TRAILER STATUS CODE PROCESSING                         *0617360
378239*----------------------------------------------------------------*0617360
378240     MOVE WBC-CAPTURE-MO  TO WK-CPT-MM.                           0617360
378241     MOVE WBC-CAPTURE-DA  TO WK-CPT-DD.                           0617360
378242     MOVE WBC-CAPTURE-YR  TO WK-CPT-YY.                           0617360
378243     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0617360
378244         MOVE '20'        TO WK-CPT-CC                            0617360
378245     ELSE                                                         0617360
378246         MOVE '19'        TO WK-CPT-CC.                           0617360
378247     MOVE WK-CAPTURE-DATE TO WK-LAST-DATE.                        0617360
378248     MOVE WMS-PLN-TRLR-STATUS-CD TO WK-STATUS-CD.                 1017800
378249     MOVE '0'             TO WMS-PLN-TRLR-STATUS-CD.              1017800
378250     IF  WMS-PLN-TRLR-RMND-YEAR NOT GREATER THAN WK-CPT-YEAR      1017800
378251         MOVE '2'         TO WMS-PLN-TRLR-STATUS-CD.              0617360
378252     IF  WMS-PLN-TRLR-REG-MAX-DATE NOT GREATER THAN               0617360
378253                             WK-CAPTURE-DATE                      0617360
378254         MOVE '4'         TO WMS-PLN-TRLR-STATUS-CD.              0617360
378255     IF (WMS-PLN-TRLR-SNG-FAM-FLG EQUAL 'N' OR 'U')               0827778
378256     OR (WMS-PLN-TRLR-PART-EXC-FLG EQUAL '2')                     0617360
378257         MOVE '1' TO WMS-PLN-TRLR-VALID-CONTR.                    0617360
378258     MOVE '12'                 TO WK-LST-MM.                      0617360
378259     MOVE '31'                 TO WK-LST-DD.                      0617360
378260     IF  WK-LST-YY          EQUAL '00'                            0617360
378261         MOVE '99'             TO WK-LST-YY                       0617360
378262     ELSE                                                         0617360
378263         SUBTRACT 1          FROM WK-LST-YY9.                     0617360
378264     IF  WK-LST-YY LESS THAN WBC-NEXT-CENT-YR                     0617360
378265         MOVE '20'       TO WK-LST-CC                             0617360
378266     ELSE                                                         0617360
378267         MOVE '19'       TO WK-LST-CC.                            0617360
378268     MOVE '0'                  TO WMS-PLN-TRLR-PY-STATUS-CD.      0617360
378269     IF  WMS-PLN-TRLR-REG-MIN-DATE NOT GREATER THAN WK-LAST-DATE  1017800
378270         MOVE '2'              TO WMS-PLN-TRLR-PY-STATUS-CD.      1017800
378271     IF  WMS-PLN-TRLR-REG-MAX-DATE NOT GREATER THAN WK-LAST-DATE  1017800
378272         MOVE '4'              TO WMS-PLN-TRLR-PY-STATUS-CD.      1017800
378273     IF  TR-FM-FLD-NO EQUAL '0100'                                1017800
378274     AND (WMS-PLN-TRLR-STATUS-CD EQUAL WK-STATUS-CD)              1017800
378275         GO TO K3351-CALC-LIMITS-EXIT.                            1017800
378276 K3351-CONT.                                                      1017800
378277     IF  WMS-PLN-TRLR-MAX-CNT-PNT EQUAL ZERO                      1017800
378278         MOVE WMS-PLN-TRLR-MAX-CNT-LIM                            1017800
378279                             TO HOLD-AMT13  HOLD-MAX-CNT-LIM      1017800
378280     ELSE SET WBC-PL-LMT-IND TO WMS-PLN-TRLR-MAX-CNT-PNT          1017800
378281         IF  WMS-PLN-TRLR-STATUS-CD GREATER THAN '1'              0617360
378282             IF  WBC-NEXT-YEAR-END EQUAL '1'                      0617360
378283                 IF  WBC-PL-PY-CU-MAX-CONT (WBC-PL-LMT-IND) > +0  0617360
378284                     MOVE WBC-PL-PY-CU-MAX-CONT (WBC-PL-LMT-IND)  0617360
378285                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM  0617360
378286                 ELSE                                             0617360
378287                     MOVE WBC-PL-PY-MAX-CONT (WBC-PL-LMT-IND)     0617360
378288                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM  0617360
378289             ELSE                                                 0617360
378290             IF  WBC-PL-CY-CU-MAX-CONT (WBC-PL-LMT-IND) > +0      0617360
378291                 MOVE WBC-PL-CY-CU-MAX-CONT (WBC-PL-LMT-IND)      0617360
378292                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM  0617360
378293             ELSE                                                 0617360
378294                 MOVE WBC-PL-CY-MAX-CONT (WBC-PL-LMT-IND)         0617360
378295                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM  0617360
378296         ELSE                                                     0617360
378297         IF  WBC-NEXT-YEAR-END EQUAL '1'                          0617360
378298             MOVE WBC-PL-PY-MAX-CONT (WBC-PL-LMT-IND)             0617360
378299                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM  0617360
378300         ELSE                                                     0617360
378301             MOVE WBC-PL-CY-MAX-CONT (WBC-PL-LMT-IND)             0617360
378302                                 TO HOLD-AMT13  HOLD-MAX-CNT-LIM. 0617360
378303     IF  HOLD-AMT13 GREATER THAN +0                               0617360
378304         COMPUTE HOLD-AMT13 = HOLD-AMT13 / +12                    0617360
378305     ELSE                                                         0617360
378306         MOVE +0 TO HOLD-AMT13.                                   0617360
378307     MOVE WMS-PLN-TRLR-ELIG-MO TO WK-PLN-TRLR-ELIG-MO9.           0617360
378308*                                                                 0617360
378309     IF  WMS-PLN-TRLR-DATE-ELIGIBLE GREATER THAN WK-CAPTURE-DATE  0617360
378310         IF  WMS-PLN-TRLR-ELIG-YEAR GREATER THAN WK-CPT-YEAR      0617360
378311             MOVE +0 TO WMS-PLN-TRLR-ACT-CNT-LIM                  0617360
378312                        WMS-PLN-TRLR-ACC-CNT-LIM                  0617360
378313                        WMS-PLN-TRLR-PY-ACT-CNT-LIM               0617360
378314             GO TO K3351-CALC-LIMITS-EXIT                         0617360
378315         ELSE                                                     0617360
378316             IF  WMS-PLN-TRLR-ELIG-MO GREATER THAN WK-CPT-MM      0617360
378317                 IF  WMS-PLN-TRLR-ELIG-DA EQUAL '01'              0617360
378318                     COMPUTE HOLD-9 = 13 - WK-PLN-TRLR-ELIG-MO9   0617360
378319                     MOVE ZERO TO HOLD-ACC9                       0617360
378320                     GO TO K3351-CALC-LIMITS                      0617360
378321                 ELSE                                             0617360
378322                     COMPUTE HOLD-9 = 12 - WK-PLN-TRLR-ELIG-MO9   0617360
378323                     MOVE ZERO TO HOLD-ACC9                       0617360
378324                     GO TO K3351-CALC-LIMITS                      0617360
378325            ELSE                                                  0617360
378326                COMPUTE HOLD-9 = 12 - WK-PLN-TRLR-ELIG-MO9        0617360
378327                MOVE ZERO TO HOLD-ACC9                            0617360
378328                GO TO K3351-CALC-LIMITS.                          0617360
378329*                                                                 0617360
378330     IF  (TR-CLASS     EQUAL '04')                                0617360
378331     OR  (TR-FM-FLD-NO EQUAL '2325' OR '0100')                    1017800
378332         NEXT SENTENCE                                            0617360
378333     ELSE                                                         0617360
378334         GO TO K3351-CONT2.                                       0617360
378335*                                                                 0617360
378336     IF  WMS-PLN-TRLR-DATE-ELIGIBLE LESS THAN WK-CAPTURE-DATE     0617360
378337         IF  WMS-PLN-TRLR-ELIG-YEAR LESS THAN WK-CPT-YEAR         0617360
378338             MOVE 12         TO HOLD-9                            0617360
378339             MOVE WK-CPT-MM9 TO HOLD-ACC9                         0617360
378340             GO TO K3351-CALC-LIMITS                              0617360
378341         ELSE                                                     0617360
378342            IF  WMS-PLN-TRLR-ELIG-MO LESS THAN WK-CPT-MM          0617360
378343                IF  WMS-PLN-TRLR-ELIG-DA EQUAL '01'               0617360
378344                    COMPUTE HOLD-9 = 13 - WK-PLN-TRLR-ELIG-MO9    0617360
378345                    COMPUTE HOLD-ACC9 = WK-CPT-MM9 + 1 -          0617360
378346                                        WK-PLN-TRLR-ELIG-MO9      0617360
378347                    GO TO K3351-CALC-LIMITS                       0617360
378348                ELSE                                              0617360
378349                    COMPUTE HOLD-9 = 12 - WK-PLN-TRLR-ELIG-MO9    0617360
378350                    COMPUTE HOLD-ACC9 = WK-CPT-MM9 -              0617360
378351                                          WK-PLN-TRLR-ELIG-MO9    0617360
378352                    GO TO K3351-CALC-LIMITS.                      0617360
378353*                                                                 0617360
378354     IF  WMS-PLN-TRLR-ELIG-DA EQUAL '01'                          0617360
378355         COMPUTE HOLD-9 = 13 - WK-PLN-TRLR-ELIG-MO9               0617360
378356         MOVE 01 TO HOLD-ACC9                                     0617360
378357         GO TO K3351-CALC-LIMITS                                  0617360
378358     ELSE                                                         0617360
378359         COMPUTE HOLD-9 = 12 - WK-PLN-TRLR-ELIG-MO9               0617360
378360         MOVE ZERO TO HOLD-ACC9                                   0617360
378361         GO TO K3351-CALC-LIMITS.                                 0617360
378362*                                                                 0617360
378363 K3351-CONT2.                                                     0617360
378364*                                                                 0617360
378365     IF  (WBC-CAPTURE-DA EQUAL '01')                              0617360
378366     AND ((TR-FM-FLD-NO EQUAL  '2213' OR '2221')                  1017800
378367     OR  ((TR-FM-FLD-NO EQUAL '2219')                             0617360
378368     AND (TR-FM-NEW-DATA (2:1) NOT EQUAL                          0617360
378369                               EX15-MST-OLD-DATA (2:1))))         0617360
378370         SUBTRACT WK-CPT-MM9 FROM 13 GIVING HOLD-9                0617360
378371         GO TO K3351-CALC-LIMITS                                  0617360
378372     ELSE                                                         0617360
378373         SUBTRACT WK-CPT-MM9 FROM 12 GIVING HOLD-9                0617360
378374         GO TO K3351-CALC-LIMITS.                                 0617360
378375*                                                                 0617360
378376 K3351-CALC-LIMITS.                                               0617360
378377*                                                                 0617360
378378     IF (WMS-PLN-TRLR-SNG-FAM-FLG EQUAL 'N' OR 'U')               0827778
378379         MOVE WMS-PLN-TRLR-ACC-CNT-LIM TO WMS-PLN-TRLR-ACT-CNT-LIM0617360
378380         GO TO K3351-CALC-LIMITS-EXIT.                            0617360
378381*                                                                 0617360
378382     COMPUTE HOLD-ACT-AMT = HOLD-AMT13 * HOLD-9.                  0617360
378383     MOVE ZERO TO WMS-PLN-TRLR-ACT-CNT-LIM.                       1017800
378384     IF  (HOLD-9 NOT EQUAL 0)                                     1017800
378385         IF  (TR-FM-FLD-NO EQUAL '2213')                          1017800
378386         AND (TR-FM-NEW-DATA (1:1)     EQUAL 'S')                 1017800
378388             ADD WMS-PLN-TRLR-ACC-CNT-LIM TO HOLD-ACT-AMT         1017800
378389             IF  HOLD-ACT-AMT  GREATER THAN HOLD-MAX-CNT-LIM      1017800
378390                 MOVE HOLD-ACT-AMT  TO WMS-PLN-TRLR-ACT-CNT-LIM   1017800
378391             ELSE                                                 1017800
378392                 MOVE HOLD-MAX-CNT-LIM TO WMS-PLN-TRLR-ACT-CNT-LIM1017800
378393         ELSE MOVE HOLD-MAX-CNT-LIM TO WMS-PLN-TRLR-ACT-CNT-LIM.  1017800
378394*                                                                 1017800
378395     IF  (TR-CLASS     EQUAL '04')                                1017800
378396     OR  (TR-FM-FLD-NO EQUAL '2325' OR '0100')                    1017800
378397          COMPUTE HOLD-ACC-AMT = HOLD-AMT13 * HOLD-ACC9           1017800
378398          IF  HOLD-ACC9 EQUAL 12                                  1017800
378399              MOVE HOLD-MAX-CNT-LIM   TO WMS-PLN-TRLR-ACC-CNT-LIM 1017800
378400          ELSE                                                    1017800
378401              MOVE HOLD-ACC-AMT       TO WMS-PLN-TRLR-ACC-CNT-LIM.1017800
378402*                                                                 1017800
378403     IF  ((WBC-CAPTURE-DA EQUAL '01')                             1017800
378404     AND (WMS-PLN-TRLR-SNG-FAM-FLG NOT EQUAL 'N' AND 'U')         1017800
378405     AND (WMS-PLN-TRLR-DATE-ELIGIBLE NOT GREATER THAN             1017800
378406          WK-CAPTURE-DATE))                                       1017800
378408         IF  ((TR-FM-FLD-NO EQUAL '2213' OR '2221')               1017800
378409         OR  ((TR-FM-FLD-NO EQUAL '2219')                         1017800
378410         AND (TR-FM-NEW-DATA (2:1) NOT EQUAL                      1017800
378411                                   EX15-MST-OLD-DATA (2:1))))     1017800
378412         ADD HOLD-AMT13 TO WMS-PLN-TRLR-ACC-CNT-LIM.              1017800
378417 K3351-CALC-LIMITS-EXIT.                                          1017800
378418     EXIT.                                                        1017800
378419*                                                                 1017800
378420 K3352.                                                           0617360
378425     ADD +1 TO T3-PLAN-NEW-NO, WS-GL-PLAN-NEW-NO.                 0617360
378430     GO TO Q4600.                                                 0617360
378435*    *************  MARKETING TRAILER ADDITION  ************      0617360
378440     SKIP1                                                        0617360
378445 K3400.                                                           0617360
378450     IF WMS-MARKET-TRLR EQUAL TO '1'
378500         MOVE '017' TO REJRESN                                    0717565
378550         GO TO K3165.
378600     MOVE TR-TRAILER TO WMS-MARKETING-TRAILER.
378650     MOVE '1' TO WMS-MARKET-TRLR.
378700     ADD WS-TRL-MRKTNG-LNGTH TO WMS-LENGTH.                       0902970
378710*----------------------------------------------------------------*1105504
378720*    IF MARKETING OFFICER IS NOT TO BE LINKED TO WMS-OFFICER,    *1105504
378725*    COMMENT NEXT TWO LINES.                                     *1105504
378730*----------------------------------------------------------------*1105504
378750     IF WMS-MRKT-OFFICER EQUAL TO SPACES                          1105504
378800         MOVE WMS-OFFICER TO WMS-MRKT-OFFICER.                    1105504
378900     MOVE '03' TO IMEX-REC-NO.
378950     MOVE 'C0' TO IMEX-CODE-1.
379000     MOVE 'M01' TO EX03-TYP-NO.
379050     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
379100     IF WMS-TRAILERS EQUAL TO NO-TRAILERS
379120     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
379150         MOVE '0' TO WMS-EXPANSION-IND
379200     ELSE MOVE '1' TO WMS-EXPANSION-IND.
379250     GO TO Q4600.
379300     SKIP3
379302*    ********* EXPEDITED FUNDS TRAILER ADDITION  ************     IM007
379304     SKIP1                                                        IM007
379306 K3450.                                                           IM007
379308     IF  WMS-EFA-TRLR EQUAL TO '1'                                IM007
379310         MOVE '017' TO REJRESN                                    0717565
379312         GO TO K3165.                                             IM007
379314     MOVE TR-TRAILER TO WMS-FUNDS-AVAIL-TRAILER.                  IM007
379316     MOVE '1' TO WMS-EFA-TRLR.                                    IM007
379318     ADD WS-TRL-FND-AVAIL-LNGTH TO WMS-LENGTH.                    0903291
379320     IF  WMS-EFA-NEW-ACCT-DATE EQUAL SPACES                       IM007
379321         MOVE WMS-DATE-OPENED TO WMS-EFA-NEW-ACCT-DATE.           IM007
379323     MOVE '03' TO IMEX-REC-NO.                                    IM007
379324     MOVE 'C0' TO IMEX-CODE-1.                                    IM007
379326     MOVE 'F01' TO EX03-TYP-NO.                                   IM007
379328     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     IM007
379330     IF  WMS-TRAILERS EQUAL TO NO-TRAILERS                        IM007
379331     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
379332         MOVE '0' TO WMS-EXPANSION-IND                            IM007
379334     ELSE                                                         IM007
379336         MOVE '1' TO WMS-EXPANSION-IND.                           IM007
379338     GO TO Q4600.                                                 IM007
379340     SKIP3                                                        IM007
379350*    *********  TRANSFER AFFILIATE TRAILER ADDITION  **********
379400     SKIP1
379450 K3500.
379500     IF WMS-TRNSFR-AFFL-TRLR GREATER THAN +8
379550         MOVE '018' TO REJRESN                                    0717565
379600         GO TO K3165.
379650     MOVE +0 TO X.
379700     MOVE TR-TRAILER TO TEMP-85.                                  9915845
379750 K3520.
379800     ADD +1 TO X.
379850     IF X GREATER THAN WMS-TRNSFR-AFFL-TRLR, GO TO K3540.
379900     IF TEMP-85 EQUAL TO WMS-TRANSFER-AFFILIATE-TRAILER (X)       9915845
379950         MOVE '017' TO REJRESN                                    0717565
380000         GO TO K3165.
380050*****IF  WMS-LINK-DELETE (X) EQUAL HIGH-VALUE, GO  TO  K3550.     0917821
380100     GO TO K3520.
380150 K3540.
380200     ADD +1 WMS-TRNSFR-AFFL-TRLR GIVING X.
380250 K3550.
380300     MOVE TR-TRAILER TO WMS-TRANSFER-AFFILIATE-TRAILER (X).
380350     IF  WMS-TRNSFR-AFFL-FLAG (X) EQUAL 'T'
380400         GO TO K3560.
380450     IF  WMS-LINK-SYS-ID (X) NOT EQUAL TO 'TR'
380500         GO TO K3560.
380550     IF  WMS-SAV-PTR EQUAL TO ZERO
380600         MOVE X TO WMS-SAV-PTR
380650         MOVE '03' TO IMEX-REC-NO
380700         MOVE 'C4' TO IMEX-CODE-1
380750         MOVE 'I' TO  EX03-TYP
380800         MOVE X TO EX03-NO
380850         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT
380900     ELSE
380950         MOVE 'D2' TO IMEX-CODE-2
381000         MOVE '017' TO REJRESN                                    0717565
381050         GO TO K3165.
381100 K3560.
381110************************************************************
381115*    REMOVED CODE THAT REJECTED AN AFFILIATE TRAILOR AND   *
381120*    ADD IF WMS-XFER-INT-PTR WAS NOT EQUAL ZERO.           *
381125************************************************************
381140     IF  WBC-DLCA-FLAG EQUAL '0'                                  0266741
381150         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
381250     ADD +1 TO WMS-TRNSFR-AFFL-TRLR.
381300     ADD WS-TRL-TRNS-AFFL-LNGTH TO WMS-LENGTH.                    0903291
381350     MOVE '03' TO IMEX-REC-NO.
381400     MOVE 'C0C2' TO IMEX-EX-CODE.
381450     IF  WMS-TRNSFR-AFFL-FLAG (X) EQUAL 'T'
381500         MOVE 'T' TO EX03-TYP
381550     ELSE
381600         MOVE 'I' TO EX03-TYP.
381650     MOVE X TO EX03-NO.
381700     GO TO K3195.
381750     SKIP3
381800**********   DECEDENT TAX DATA TRAILER ADDITION   **********
381850     SKIP1
381900 K3600.
381950     IF  WMS-DCD-TAX-DATA-TRLR EQUAL '1'
382000         MOVE '017' TO REJRESN                                    0717565
382050         GO TO K3165.
382060     IF  TR-DCD-NA-PTR GREATER THAN WMS-NME-ADDR-TLRS             IM003
382070         MOVE '049' TO REJRESN                                    0717565
382080         GO TO K3165.                                             IM003
382100     MOVE TR-TRAILER TO WMS-DECEDENT-TAX-DATA-TRAILER.
382103     IF  WMS-DCD-YTD-INT-IOD EQUAL ZERO                           IM003
382106         MOVE WMS-IOD-YTD-INT-PAID TO WMS-DCD-YTD-INT-IOD.        IM003
382109     IF  WMS-DCD-YTD-INT-SAV EQUAL ZERO                           IM003
382112     AND WMS-SAVINGS-TRLR EQUAL '1'                               IM003
382115         MOVE WMS-YTD-INT-PAID TO WMS-DCD-YTD-INT-SAV.            IM003
382118     IF  WMS-DCD-YTD-INT-LOAN EQUAL ZERO                          IM003
382121     AND WMS-LOAN-TRLR EQUAL '1'                                  IM003
382124         MOVE WMS-LOAN-YTD-INT TO WMS-DCD-YTD-INT-LOAN.           IM003
382127     IF  WMS-DCD-YTD-TAX-IOD EQUAL ZERO                           IM003
382130         MOVE WMS-IOD-YTD-TAX TO WMS-DCD-YTD-TAX-IOD.             IM003
382133     IF  WMS-DCD-YTD-TAX-SAV EQUAL ZERO                           IM003
382136     AND WMS-SAVINGS-TRLR EQUAL '1'                               IM003
382139         MOVE WMS-YTD-SAV-TAX TO WMS-DCD-YTD-TAX-SAV.             IM003
382140     IF  WMS-DCD-YTD-TAX-IOD-STATE EQUAL ZERO                     2012254
382141         MOVE WMS-IOD-YTD-STATE-TAX TO WMS-DCD-YTD-TAX-IOD-STATE. 2012254
382142     IF  WMS-DCD-YTD-TAX-SAV-STATE EQUAL ZERO                     2012254
382143     AND WMS-SAVINGS-TRLR EQUAL '1'                               2012254
382144         MOVE WMS-YTD-SAV-STATE-TAX TO WMS-DCD-YTD-TAX-SAV-STATE. 2012254
382145     IF  WMS-DCD-YTD-TAX-IOD-LOCAL EQUAL ZERO                     2012254
382146         MOVE WMS-IOD-YTD-LOCAL-TAX TO WMS-DCD-YTD-TAX-IOD-LOCAL. 2012254
382147     IF  WMS-DCD-YTD-TAX-SAV-LOCAL EQUAL ZERO                     2012254
382148     AND WMS-SAVINGS-TRLR EQUAL '1'                               2012254
382149         MOVE WMS-YTD-SAV-LOCAL-TAX TO WMS-DCD-YTD-TAX-SAV-LOCAL. 2012254
382150     IF  WMS-DCD-YTD-INT-IOD-1042 EQUAL ZERO                      9915828
382155         MOVE WMS-IOD-YTD-INT-PAID-1042 TO                        9915828
382160              WMS-DCD-YTD-INT-IOD-1042.                           9915828
382165     IF  WMS-DCD-YTD-INT-SAV-1042 EQUAL ZERO                      9915828
382170     AND WMS-SAVINGS-TRLR EQUAL '1'                               9915828
382175         MOVE WMS-YTD-INT-PAID-1042 TO WMS-DCD-YTD-INT-SAV-1042.  9915828
382180     IF  WMS-DCD-NRA-CERT-NAME EQUAL SPACE                        9915828
382182         PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT               9915828
382185         MOVE CERT-NAME-W8-STATUS TO WMS-DCD-NRA-CERT-NAME.       9915828
382190     MOVE '1' TO WMS-DCD-TAX-DATA-TRLR.                           9915828
382200     MOVE WMS-DCD-STATUS TO WK-DCD-STATUS-IN.
382240     IF  WBC-DLCA-FLAG EQUAL '0'                                  0266741
382250         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
382350     ADD WS-TRL-DEC-TAX-LNGTH TO WMS-LENGTH.                      0903291
382400     MOVE '03' TO IMEX-REC-NO.
382450     MOVE 'C0' TO IMEX-CODE-1.
382500     MOVE 'Q01' TO EX03-TYP-NO.
382550     GO TO K3195.
382600     SKIP3
382650**********   OVERDRAFT ACCRUAL TRAILER ADDITION   **********
382700     SKIP1
382750 K3650.
382752     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
382754         MOVE '038' TO REJRESN                                    0717565
382756         GO TO K3165.                                             0617360
382800     COPY IMPDODTA.                                               9915856
382850*                                                                 9915856
383500*    ********  DATA CENTER TRAILER ADDITION  ********
383550     SKIP1
383600*    ********  USE THIS AREA TO DO EXTRA INPUT EDITS
383650*    ******** OR MUNIPULATION OF TRAILER FIELDS.
383700*    ******** USE R4285 PARAGRAPH TO PROCESS TRAILER.
383750 K3700.
383800     IF  WMS-DC-TRLR EQUAL TO '1'
383850         MOVE '017' TO REJRESN                                    0717565
383900         GO  TO  K3165.
383950******************************************************************
384040***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE INCOMING   IM002
384130***  DATA CENTER ADDITION TRANSACTION PRIOR TO POSTING.           IM002
384220***                                                               IM002
384310***  COPY IM31UBWR.                                               IM002
384400***                                                               IM002
384490***  END OF USER EXIT.                                            IM002
384580******************************************************************IM002
384850     MOVE TR-TRAILER TO WMS-DC-TRAILER.
384900     ADD WMS-DC-TRLR-LENGTH TO WMS-LENGTH.
384950     MOVE '1' TO WMS-DC-TRLR.
385000     MOVE '03' TO IMEX-REC-NO.
385050     MOVE 'C0' TO IMEX-CODE-1.
385100     MOVE 'P01' TO EX03-TYP-NO.
385150     GO  TO  K3195.
385200     SKIP3
385250**********   INFORMATION TRAILER ADDITION   **********
385300     SKIP1
385350 K3750.
385400     IF  WMS-INFO-TRLR EQUAL '1'
385450         MOVE '017' TO REJRESN                                    0717565
385500         GO TO K3165.
385505*                                                                 0447287
385510     MOVE TR-TRAILER TO WMS-INFORMATION-TRAILER.                  0447287
385515*                                                                 0447287
385520     IF  WBC-REG-1042 NOT EQUAL '1'                               0447287
385525         GO TO K3750-CONT.                                        0447287
385527     IF  WMS-TIN-CERTIFICATION NOT EQUAL '8'                      0637629
385528         GO TO K3750-CONT.                                        0637629
385530*                                                                 0447287
385535     IF  WMS-SOC-SEC-NA EQUAL 1                                   0447287
385540         IF  WMS-SSN-COUNTRY EQUAL 'CA'                           0447287
385545             NEXT SENTENCE                                        0447287
385550         ELSE                                                     0447287
385555             GO TO K3750-CONT                                     0447287
385560     ELSE                                                         0447287
385565         IF  WMS-NME-ADDR-TLRS GREATER THAN 0                     0447287
385570         AND WMS-NA-COUNTRY EQUAL 'CA'                            0447287
385575             NEXT SENTENCE                                        0447287
385580         ELSE                                                     0447287
385585             GO TO K3750-CONT.                                    0447287
385590*                                                                 0447287
385595     IF  WMS-NRA-TAX-PROVINCE EQUAL 'AB' OR 'BC' OR 'NL' OR 'MB'  0837825
385600                                 OR 'NB' OR 'NS' OR 'NT' OR 'NU'  0837825
385605                                 OR 'ON' OR 'PE' OR 'QC' OR 'SK'  0837825
385610                                 OR 'YT'                          0837825
385615         GO TO K3750-CONT.                                        0447287
385620*                                                                 0447287
385625     MOVE '055' TO REJRESN.                                       0717565
385630     GO TO K3165.                                                 0447287
385635*                                                                 0447287
385640 K3750-CONT.                                                      0447287
385645*                                                                 0447287
385650     MOVE '1' TO WMS-INFO-TRLR.                                   0447287
385655     IF  WBC-DLCA-FLAG EQUAL '0'                                  0447287
385660         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0447287
385710     IF WMS-INFO-CENSUS-CODE EQUAL '0'                            IM004
385720        MOVE WMS-ZIP-SAVE TO WMS-INFO-CENSUS-TRACT.               IM004
385750     ADD WS-TRL-INFO-LNGTH TO WMS-LENGTH.                         0903291
385800     MOVE '03' TO IMEX-REC-NO.
385850     MOVE 'C0' TO IMEX-CODE-1.
385900     MOVE 'G01' TO EX03-TYP-NO.
385950     GO TO K3195.
386000     SKIP3
386050*    ********  COMBINED STATEMENT TRAILER ADDITION  ********
386100     SKIP1
386150 K3800.
386200     IF WMS-COMBINED-STAT GREATER THAN +14
386250         MOVE '018' TO REJRESN                                    0717565
386300         GO TO K3165.
386322     IF  WMS-PASSBOOK-ACCT EQUAL '1'                              0427139
386324         MOVE 'D1' TO IMEX-CODE-2                                 0427139
386326         MOVE '097' TO REJRESN                                    0717565
386328         GO TO K3165.                                             0427139
386350     MOVE +0 TO X.
386400     MOVE TR-TRAILER TO TEMP-46.
386450 K3820.
386500     ADD +1 TO X.
386550     IF X GREATER THAN WMS-COMBINED-STAT, GO TO K3840.
386600     IF TEMP-46 EQUAL TO WMS-COMBINED-STATEMENT-TRAILER (X)
386650         MOVE '017' TO REJRESN                                    0717565
386700         GO TO K3165.
386750     GO TO K3820.
386800 K3840.
386850     ADD +1 TO WMS-COMBINED-STAT.
386900     ADD WS-TRL-COMB-STMT-LNGTH TO WMS-LENGTH.                    0903291
386950     MOVE WMS-COMBINED-STAT TO X.
387000     MOVE TR-TRAILER TO WMS-COMBINED-STATEMENT-TRAILER (X).
387100     MOVE '03' TO IMEX-REC-NO.
387150     MOVE 'C0C2' TO IMEX-EX-CODE.
387200     MOVE 'S' TO EX03-TYP.
387250     MOVE X TO EX03-NO.
387300     GO TO K3195.
387350     SKIP3
387400*    *********** TARGET AMOUNT TRAILER ADDITION  ***********
387450     SKIP1
387500 K3900.
387502     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
387504         MOVE '038' TO REJRESN                                    0717565
387506         GO TO K3165.                                             0617360
387550     IF WMS-TARGET-AMT-TRLR EQUAL TO '1'
387600         IF WMS-TARGET-DELETE EQUAL TO '1' OR '9'
387650             SUBTRACT WS-TRL-TARGT-BAL-LNGTH FROM WMS-LENGTH      0903291
387700         ELSE
387750             MOVE '017' TO REJRESN                                0717565
387800             GO TO K3165.
387810     IF (WMS-KITING-SUSP-TRLR EQUAL '1') AND                      IM006
387820        (TR-TARGET-AMT-CNTL NOT EQUAL WMS-CONTROL-KEY)            IM006
387830         MOVE '052' TO REJRESN                                    0717565
387840         GO TO K3165.                                             IM006
387842* RESTRICTED STATEMENT SAVINGS                                    0437111
387844     IF  WMS-MMDA-INDICATOR EQUAL '3'                             0437111
387846         MOVE '099' TO REJRESN                                    0717565
387848         GO TO K3165.                                             0437111
387850     MOVE TR-TRAILER TO WMS-TARGET-AMOUNT-TRAILER.
387900     MOVE '1' TO WMS-TARGET-AMT-TRLR.
387950     IF  WMS-TARGET-CONTROL EQUAL WMS-CONTROL-KEY
388000         MOVE '2' TO WMS-TARGET-DELETE.
388050     ADD WS-TRL-TARGT-BAL-LNGTH TO WMS-LENGTH.                    0903291
388150     MOVE '03' TO IMEX-REC-NO.
388200     MOVE 'C0' TO IMEX-CODE-1.
388250     MOVE 'Z01' TO EX03-TYP-NO.
388300     GO TO K3195.
388350     SKIP3
388400**********   EXTENDED SERVICE CHARGE TRAILER ADDITION   **********
388450     SKIP1
388500 K3950.
388550     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
388600         MOVE '017' TO REJRESN                                    0717565
388650         GO TO K3165.
388700     MOVE TR-TRAILER TO WMS-EXTENDED-SERV-CHG-TRLR.
388750     MOVE '1' TO WMS-EXT-SC-DATA-TRLR.
388900     ADD WS-TRL-EXTR-SC-LNGTH TO WMS-LENGTH.                      0903291
388950     MOVE '03' TO IMEX-REC-NO.
389000     MOVE 'C0' TO IMEX-CODE-1.
389050     MOVE 'E01' TO EX03-TYP-NO.
389100     GO TO K3195.
389150     SKIP3
389200*    **********  LIMIT TRANSFER TRAILER ADDITION  **********
389250     SKIP1
389300 K4000.
389302     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
389304         MOVE '038' TO REJRESN                                    0717565
389306         GO TO K3165.                                             0617360
389350     IF WMS-LIMIT-TRANSFER EQUAL TO '1'
389400         MOVE '017' TO REJRESN                                    0717565
389450         GO TO K3165.
389500     MOVE TR-TRAILER TO WMS-LIMIT-TRANSFER-TRAILER.
389550     IF WMS-LIM-TRAN-AMT LESS THAN WMS-MIN-BAL
389600         MOVE '023' TO REJRESN                                    0717565
389650         GO TO K3165.
389660* RESTRICTED STATEMENT SAVINGS                                    0437111
389670     IF  WMS-MMDA-INDICATOR EQUAL '3'                             0437111
389680         MOVE '099' TO REJRESN                                    0717565
389690         GO TO K3165.                                             0437111
389750     IF  WMS-LIMIT-TRANSFER EQUAL '0'
389800         ADD WS-TRL-LMT-TRNFR-LNGTH TO WMS-LENGTH.                0903291
389850     MOVE '1' TO WMS-LIMIT-TRANSFER.
389900     MOVE '03' TO IMEX-REC-NO.
389950     MOVE 'C0' TO IMEX-CODE-1.
390000     MOVE 'L01' TO EX03-TYP-NO.
390050     GO TO K3195.
390100     SKIP3
390150*    ********  SOCIAL SECURITY N/A TRAILER ADDITION  *******
390200     SKIP1
390250 K4100.
390300     IF ACCT-NOT-FOUND EQUAL TO '1'
390350         MOVE TR-SSN-NA TO EX09-REMAINDER
390400         GO TO K3130.
390450     IF WMS-SOC-SEC-NA EQUAL TO '0'
390500         MOVE SPACES TO WMS-SOC-SEC-NA-TRAILER
390550         MOVE '1' TO WMS-SOC-SEC-NA
390600         ADD WS-TRL-SOC-SEC-LNGTH TO WMS-LENGTH                   0903291
390650         MOVE '0' TO WMS-SSN-DELETE.
390700     IF TR-TRLR-TYPE EQUAL TO '1'
390750         MOVE '01' TO EX11-NOX
390800         MOVE WMS-SSN-NAME TO EX11-TRLR
390850         MOVE TR-SS-TRLR TO WMS-SSN-NAME
390900         GO TO K4150.
390950     IF TR-TRLR-TYPE EQUAL TO '2'
391000         MOVE '02' TO EX11-NOX
391050         MOVE WMS-SSN-ST-ADDR TO EX11-TRLR
391100         MOVE TR-SS-TRLR TO WMS-SSN-ST-ADDR
391150         GO TO K4150.
391200     MOVE '03' TO EX11-NOX.
391242     MOVE SPACES              TO WK-EX11-TRLR.                    0326947
391244     MOVE WMS-SSN-CITY-ST-ZIP TO WK-EX11-SSN-LINE.                0326947
391246     MOVE WMS-SSN-FOREIGN-ADDRESS TO WK-EX11-SSN-FA.              0326947
391248     MOVE WMS-SSN-COUNTRY    TO WK-EX11-SSN-CNTRY.                0326947
391250     MOVE WK-EX11-TRLR       TO EX11-TRLR.                        0326947
391300     MOVE TR-SS-TRLR TO WMS-SSN-CITY-ST-ZIP.
391320     MOVE TR-SS-FOREIGN-ADDR TO WMS-SSN-FOREIGN-ADDRESS.          IM005
391330     MOVE TR-SS-COUNTRY-CODE TO WMS-SSN-COUNTRY.                  9916034
391350 K4150.
391500     MOVE 'N' TO EX11-TYP.
391550     MOVE 'B0B6' TO IMEX-EX-CODE.
391600     MOVE '11' TO IMEX-REC-NO.
391610     MOVE WMS-DATE-LAST-MAINT    TO  EX11-DATE-LAST-MAINT.        0266748
391650     GO TO K3195.
391700     SKIP3
391750 ROOT-SECTION-F      SECTION 1.
391800     SKIP3
391850*    ***********  STATEMENT REQUEST PROCESSING  ************
391900     SKIP1
391950 K4200.
392000     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
392022     IF  WMS-PASSBOOK-ACCT EQUAL '1'                              0427139
392024         MOVE 'D1' TO IMEX-CODE-2                                 0427139
392026         MOVE '097' TO REJRESN                                    0717565
392028         GO TO K3165.                                             0427139
392050     IF TR-SR-TYPE GREATER THAN '2', GO TO K4220.
392100     IF  ST-REQ-TYPE (BIN-1) EQUAL TO ' '
392150         SET REQ-IND TO +1.
392152     IF  REQ-IND GREATER BIN-20                                   9916309
392154         MOVE WMS-CONTROL-KEY TO E07-KEY                          9916309
392156         MOVE 002             TO SIMESS-MESS-NO                   9916309
392158         MOVE EMSG-07         TO SIMESS-OPTIONAL-MESSAGE          9916309
392160         CALL 'SIMESS'     USING SIMESS-AREA                      9916309
392162         GO TO Q4500.                                             9916309
392200     MOVE TR-SR-TYPE TO ST-REQ-TYPE (REQ-IND).
392250     MOVE TR-SR-INIT TO ST-REQ-INIT (REQ-IND).
392300     SET REQ-IND UP BY +1.
392350     GO TO Q4500.
392400 K4220.
392450     IF TR-SR-TYPE EQUAL TO '4', GO TO K4240.
392500     IF SNAP-END EQUAL TO HIGH-VALUE OR
392550         TR-SR-HI-CTL GREATER THAN HIGH-SNAP
392600         MOVE TR-SR-HI-CTL TO HIGH-SNAP
392650         MOVE TR-SR-INIT TO SNAP-INIT.
392700     GO TO Q4500.
392750 K4240.
392800     IF RESET-END EQUAL TO HIGH-VALUE OR
392850         TR-SR-HI-CTL GREATER THAN HIGH-RESET
392900         MOVE TR-SR-HI-CTL TO HIGH-RESET
392950         MOVE TR-SR-INIT TO RESET-INIT.
393000     GO TO Q4500.
393050     SKIP3
393100*    ********** INTERBRANCH TRANSFER PROCESSING  ***********      9915845
393102     SKIP1                                                        9915845
393104 K4250.                                                           9915845
393106     IF ACCT-NOT-FOUND EQUAL TO '1'                               9915845
393108         MOVE '44' TO IMEX-REC-NO                                 9915845
393110         MOVE 'IB' TO IMEX-CODE-1                                 9915845
393112         MOVE TR-96-IBT-NEW-ACCT TO HOLD-WK-ACCT-20               9915845
393113         MOVE WBC1-CONTROL-1 TO HOLD-WK-CTL1                      0266741
393114         MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT          9915845
393116         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT                  9915845
393118         GO TO K3130.                                             9915845
393130     MOVE '1' TO WMS-IBT-FLAG.                                    9915845
393138     MOVE TR-96-IBT-RET-DAYS TO WMS-IBT-RETENTION-DAYS.           9915845
393140     MOVE TR-96-IBT-NEW-ACCT TO WMS-IBT-OLD-NEW-ACCOUNT.          9915845
393152     IF  TR-96-IBT-PASS-TRANS EQUAL '1'                           9915845
393156         MOVE '1' TO WMS-IBT-REROUTE-FLAG.                        9915845
393162     MOVE '1' TO IBT-96-FLAG.                                     9915845
393164     MOVE TR-96-IBT-NEW-ACCT TO HOLD-WK-ACCT-20.                  9915845
393166     MOVE TR-CTL1 TO HOLD-WK-CTL1.                                9915845
393168     MOVE '44' TO IMEX-REC-NO.                                    9915845
393170     MOVE 'IB' TO IMEX-CODE-1.                                    9915845
393172     MOVE 'IV' TO IMEX-CODE-2.                                    9915845
393174     MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT.             9915845
393176     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
393178     IF  TR-96-IBT-STMT-REQ EQUAL '1' OR '2'                      9915845
393180         MOVE TR-96-IBT-STMT-REQ TO SAVE-IBT-STMT-REQ             9915845
393182     ELSE                                                         9915845
393184         MOVE '0' TO SAVE-IBT-STMT-REQ.                           9915845
393186     ADD +1 TO IBT-96-TRAN-POSTD.                                 9915845
393190     GO  TO  K3195.                                               9915845
393191     SKIP3                                                        9915845
393192*    ***********  DELETE TRANSACTION PROCESSING  ***********      9915845
393194     SKIP1                                                        9915845
393200 K4300.
393250     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
393300     IF  WMS-CURR-BAL NOT EQUAL ZERO                              IM005
393320     OR  WMS-IOD-CYC-ACC-INT NOT EQUAL ZERO                       IM005
393340     OR  WMS-IOD-YTD-INT-PAID NOT EQUAL ZERO                      IM005
393360     OR  WMS-COMBINED-STAT NOT EQUAL ZERO                         IM005
393380     OR  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            IM005
393400     OR  WMS-SAVINGS-TRLR EQUAL '1'                               IM005
393420     OR  WMS-LOAN-TRLR EQUAL '1'                                  IM005
393440         MOVE '016' TO REJRESN                                    0717565
393460         GO TO K3165.                                             IM005
393465     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
393470         IF  WMS-DUAL-YR-CUR-IOD-INT NOT EQUAL ZERO               9915858
393475         OR  WMS-DUAL-YR-CUR-SAV-INT NOT EQUAL ZERO               9915858
393480         MOVE '016' TO REJRESN                                    0717565
393485         GO TO K3165.                                             9915858
393500     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
393502         GO TO K4301.                                             0617360
393504     IF  WMS-PLN-TRLR-CTDT-NO GREATER THAN ZERO                   0617360
393506         MOVE '016' TO REJRESN                                    0717565
393508         GO TO K3165.                                             0617360
393510                                                                  0617360
393600 K4301.                                                           0617360
393650     MOVE '03' TO IMEX-REC-NO.
393700     MOVE 'I4' TO IMEX-CODE-1.
393750     MOVE 'D' TO EX03-CODE.
393800     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
393850     MOVE '05' TO WMS-STATUS.
393900     IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
393950         MOVE 'SU' TO IMEX-CODE-1
394000         MOVE 'SD' TO IMEX-CODE-2
394050         MOVE '09' TO IMEX-REC-NO
394100         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
394150         MOVE '05' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
394200         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
394250         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
394300     GO TO Q4500.
394302     SKIP3                                                        0617360
394304*    ***********  PLAN TRANSACTION PROCESSING  *************      0617360
394306     SKIP1                                                        0617360
394308 K4350.                                                           0617360
394310     IF  ACCT-NOT-FOUND EQUAL TO '1'                              0617360
394312         GO TO K3130.                                             0617360
394314     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
394316         GO TO K3150.                                             0617360
394318     MOVE TR-PLAN-CAL-YR     TO WS-WORK-CAL-YR.                   0617360
394320     MOVE TR-PLAN-TAX-YR     TO WS-WORK-TAX-YR.                   0617360
394322     MOVE TR-PLAN-ADJ-TYPE   TO WS-WORK-TAX-CODE.                 0617360
394324     MOVE TR-PLAN-ADJ-AMT    TO WS-WORK-CTDT-AMT.                 0617360
394326     MOVE TR-PLAN-PLN-CODE   TO WS-WORK-PLN-CODE.                 0617360
394328     MOVE TR-PLAN-PLN-CODE2  TO WS-WORK-PLN-CODE2.                0617360
394330     MOVE 'A'                TO WS-PLN-TRLR-FULL.                 0617360
394332     PERFORM UPDATE-PLN-CTDT THRU UIC-END.                        0617360
394334     IF  WS-PLN-TRLR-FULL EQUAL 'Y'                               0617360
394336         MOVE '018'       TO REJRESN                              0717565
394338         GO TO K3165.                                             0617360
394340     IF  WS-PLN-TRLR-FULL EQUAL 'U'                               0617360
394342         GO TO K4351.                                             0617360
394344     IF  WS-WORK-CTDT-AMT LESS THAN ZERO                          0617360
394346         MOVE '041'       TO REJRESN                              0717565
394348         GO TO K3165.                                             0617360
394350     MOVE ZERO             TO EX29-OLD-AMT.                       0617360
394352     MOVE WS-WORK-CTDT-AMT TO EX29-NEW-AMT.                       0617360
394354     IF  WS-WORK-CTDT-AMT EQUAL ZERO                              0617360
394356         GO TO K4352.                                             0617360
394358     IF  WS-PLN-TRLR-FULL EQUAL 'I'                               0617360
394360         PERFORM UIC-INSERT-INIT THRU UIC-INSERT-EXIT.            0617360
394362     ADD 1                  TO WMS-PLN-TRLR-CTDT-NO.              0617360
394364     MOVE WS-WORK-CONT-DIST TO WMS-PLN-TRLR-CTDT-TRLR             0617360
394366                                    (WMS-PLN-TRLR-IND).           0617360
394368     GO TO K4352.                                                 0617360
394370 K4351.                                                           0617360
394372     IF  TR-PLAN-CHG-CD EQUAL '0'                                 0617360
394374         MOVE WS-WORK-CTDT-AMT TO HOLD-AMT                        0617360
394376     ELSE                                                         0617360
394378         ADD WS-WORK-CTDT-AMT WMS-PLN-TRLR-CTDT-AMT               0617360
394380                          (WMS-PLN-TRLR-IND) GIVING HOLD-AMT.     0617360
394382     IF  HOLD-AMT LESS THAN ZERO                                  0617360
394384         MOVE '041' TO REJRESN                                    0717565
394386         GO TO K3165.                                             0617360
394388     MOVE WMS-PLN-TRLR-CTDT-AMT (WMS-PLN-TRLR-IND)                0617360
394390                          TO EX29-OLD-AMT.                        0617360
394392     MOVE HOLD-AMT TO EX29-NEW-AMT.                               0617360
394394     IF  HOLD-AMT    EQUAL ZERO                                   0617360
394396         PERFORM UIC-DELETE THRU UIC-END                          0617360
394398     ELSE                                                         0617360
394400         MOVE HOLD-AMT TO WMS-PLN-TRLR-CTDT-AMT                   0617360
394402                         (WMS-PLN-TRLR-IND).                      0617360
394404 K4352.                                                           0617360
394406     PERFORM UPDATE-PLN-LTD THRU UPLT-EXIT.                       0617360
394408     MOVE WS-WORK-CONT-DIST TO EX29-PLN-CTDT.                     0617360
394410     MOVE TR-PLAN-CHG-CD TO EX29-CHG-CODE.                        0617360
394412     MOVE '29' TO IMEX-REC-NO.                                    0617360
394414     MOVE 'PA' TO IMEX-CODE-1.                                    0617360
394416     MOVE 'PU' TO IMEX-CODE-2.                                    0617360
394418     MOVE TR-SOURCE TO EX29-SOURCE.                               0617360
394420     MOVE TR-BATCH TO EX29-BATCH.                                 0617360
394422     MOVE TR-SEQ TO EX29-SEQ.                                     0617360
394424     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0617360
394426     GO TO Q4500.                                                 0617360
394428 MEMO-SECTION-A      SECTION 34.                                  0617360
394450     SKIP3
394500*    ***********  MEMO TRANSACTION PROCESSING  *************
394550     SKIP1
394600 K4400.
394610*----------------------------------------------------------------*1105504
394612*    ADD PARAGRAPHS FOR 3 NEW FIELDS TO BE UPDATED BY            *1105504
394614*    IM60 AND IM61 TRANSACTIONS. ALSO ADD LOGIC FOR              *1105504
394616*    MAINTENANCE TO 200 MISC ACCUM. IN EXT. SC TRAILER.          *1105504
394618*----------------------------------------------------------------*1105504
394650     IF ACCT-NOT-FOUND EQUAL TO '1'
394700         MOVE '002' TO REJRESN                                    0717565
394750         GO TO K4680.
394800     MOVE TR-MT-AMT TO HOLD-AMT.
394850     IF TR-CLASS EQUAL TO '61'
394900         MULTIPLY -1 BY HOLD-AMT.
394950     GO TO K4420  K4430  K4440  K4450  K4460                      2012254
394960           K4470  K4480  K4480  K4500  K4510                      2012254
394970           K4480  K4480  K4540  K4550  K4560                      2012254
394980           K4570  K4580  K4590  K4600  K4620                      2012254
394990           K4630  K4640  K4642  K4644  K4646                      2012254
395200           K4648  K4650  K4652  K4654  K4656                      2012254
395210           K4658  K4660  K4661  K4662  K4664                      2012254
395220           K4666  K4610  K4615  K4425  K4435                      2012254
395230           K4445  K4455  K4465  K4602  K4604                      2012254
395240           K4606  K4608  K4472  K4474  K4476                      2012254
395250           K4478  K4669                                           2016639
396360                 DEPENDING ON TR-MT-FLD.                          9915828
396361     IF  TR-MT-FLD GREATER THAN 100                               9915828
396362         MOVE TR-MT-FLD TO X                                      1105504
396366         SUBTRACT +100 FROM X                                     1105504
396368         GO TO K4668.                                             1105504
396400     GO TO K4680.
396450 K4420.
396500     MULTIPLY HOLD-AMT BY -1 GIVING CALC-AMT1.
396550     MOVE WMS-SC-MISC-COSTS TO CALC-AMT2.
396600     IF CALC-AMT1 IS GREATER THAN CALC-AMT2
396650         MOVE '041' TO REJRESN                                    0717565
396700         MOVE +0.00 TO CALC-AMT1, CALC-AMT2
396750         GO TO K4680.
396800     MOVE +0.00 TO CALC-AMT1, CALC-AMT2.
396850     ADD HOLD-AMT TO WMS-SC-MISC-COSTS, WMS-MTD-MISC-COSTS.
396900     MOVE WMS-SC-MISC-COSTS TO EX04-NEW-AMT.
396950     GO TO K4670.
396955 K4425.                                                           9915858
396960     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             9915858
396965         MOVE '015' TO REJRESN                                    0717565
396970         GO TO K4680.                                             9915858
396975     ADD +.005, WMS-DUAL-YR-CUR-IOD-INT GIVING WK-HOLD-AMT13.     9915858
396980     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915858
396985         MOVE '041' TO REJRESN                                    0717565
396990         GO TO K4680.                                             9915858
396992     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-IOD-INT DUAL-IO-INT-YTD-ADJ  9915858
396994                     WS-GL-DUAL-IO-INT-YTD-ADJ.                   9915858
396996     MOVE WMS-DUAL-YR-CUR-IOD-INT TO EX04-NEW-AMT.                9915858
396998     GO TO K4670.                                                 9915858
397000 K4430.
397050     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'
397100         MOVE '015' TO REJRESN                                    0717565
397150         GO TO K4680.
397200     MOVE HOLD-NO TO HOLD-CALC1.
397250     MOVE WMS-LOCAL-ITEMS TO HOLD-CALC2.
397300     ADD HOLD-CALC1 TO HOLD-CALC2.
397350     IF HOLD-CALC2 IS LESS THAN +0
397400         MOVE '041' TO REJRESN                                    0717565
397450         MOVE +0 TO HOLD-CALC1, HOLD-CALC2
397500         GO TO K4680.
397550     MOVE +0 TO HOLD-CALC1, HOLD-CALC2.
397600     ADD HOLD-NO TO WMS-LOCAL-ITEMS, WMS-MTD-LOCAL-ITEMS.
397650     MOVE WMS-LOCAL-ITEMS TO EX04-NEW-NO.
397700     GO TO K4670.
397705 K4435.                                                           9915858
397710     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             9915858
397715         MOVE '015' TO REJRESN                                    0717565
397720         GO TO K4680.                                             9915858
397725     ADD +.005, WMS-DUAL-YR-CUR-SAV-INT GIVING WK-HOLD-AMT13.     9915858
397730     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915858
397735         MOVE '041' TO REJRESN                                    0717565
397740         GO TO K4680.                                             9915858
397742     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-SAV-INT DUAL-SV-INT-YTD-ADJ  9915858
397744                     WS-GL-DUAL-SV-INT-YTD-ADJ.                   9915858
397746     MOVE WMS-DUAL-YR-CUR-SAV-INT TO EX04-NEW-AMT.                9915858
397748     GO TO K4670.                                                 9915858
397750 K4440.
397800     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'
397850         MOVE '015' TO REJRESN                                    0717565
397900         GO TO K4680.
397950     MOVE HOLD-NO TO HOLD-CALC1.
398000     MOVE WMS-FOREIGN-ITEMS TO HOLD-CALC2.
398050     ADD HOLD-CALC1 TO HOLD-CALC2.
398100     IF HOLD-CALC2 LESS THAN +0
398150         MOVE '041' TO REJRESN                                    0717565
398200         MOVE +0 TO HOLD-CALC1, HOLD-CALC2
398250         GO TO K4680.
398300     MOVE +0 TO HOLD-CALC1, HOLD-CALC2.
398350     ADD HOLD-NO TO WMS-FOREIGN-ITEMS, WMS-MTD-FOREIGN-ITEMS.
398400     MOVE WMS-FOREIGN-ITEMS TO EX04-NEW-NO.
398450     GO TO K4670.
398452 K4445.                                                           9915858
398454     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             9915858
398456         MOVE '015' TO REJRESN                                    0717565
398458         GO TO K4680.                                             9915858
398460     IF  HOLD-AMT + WMS-DUAL-YR-CUR-IOD-FED LESS THAN ZERO        9915858
398462         MOVE '041' TO REJRESN                                    0717565
398464         GO TO K4680.                                             9915858
398466     IF  TR-CLASS EQUAL '61'                                      9915858
398468         ADD +1 TO DUAL-IO-TAX-ADJ-DN-NO                          9915858
398470                   WS-GL-DUAL-IO-TAX-ADJ-DN-NO                    9915858
398472         SUBTRACT HOLD-AMT FROM DUAL-IO-TAX-ADJ-DN-AMT            9915858
398474                                WS-GL-DUAL-IO-TAX-ADJ-DN-AMT      9915858
398476     ELSE                                                         9915858
398478         ADD +1 TO DUAL-IO-TAX-ADJ-UP-NO                          9915858
398480                   WS-GL-DUAL-IO-TAX-ADJ-UP-NO                    9915858
398482         ADD HOLD-AMT TO DUAL-IO-TAX-ADJ-UP-AMT                   9915858
398484                         WS-GL-DUAL-IO-TAX-ADJ-UP-AMT.            9915858
398486     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-IOD-FED.                     9915858
398490     MOVE WMS-DUAL-YR-CUR-IOD-FED TO EX04-NEW-AMT.                9915858
398492     GO TO K4670.                                                 9915858
398500 K4450.
398550     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'
398600         MOVE '015' TO REJRESN                                    0717565
398650         GO TO K4680.
398700     ADD HOLD-NO TO WMS-NON-PAR-DEP, WMS-MTD-NONPAR-AMT.
398750     MOVE WMS-NON-PAR-DEP TO EX04-NEW-NO.
398800     GO TO K4670.
398802 K4455.                                                           9915858
398804     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             9915858
398806         MOVE '015' TO REJRESN                                    0717565
398808         GO TO K4680.                                             9915858
398810     IF  HOLD-AMT + WMS-DUAL-YR-CUR-SAV-FED LESS THAN ZERO        9915858
398812         MOVE '041' TO REJRESN                                    0717565
398814         GO TO K4680.                                             9915858
398816     IF  TR-CLASS EQUAL '61'                                      9915858
398818         ADD +1 TO DUAL-SV-TAX-ADJ-DN-NO                          9915858
398820                   WS-GL-DUAL-SV-TAX-ADJ-DN-NO                    2012254
398822         SUBTRACT HOLD-AMT FROM DUAL-SV-TAX-ADJ-DN-AMT            9915858
398824                                WS-GL-DUAL-SV-TAX-ADJ-DN-AMT      2012254
398826     ELSE                                                         9915858
398828         ADD +1 TO DUAL-SV-TAX-ADJ-UP-NO                          9915858
398830                   WS-GL-DUAL-SV-TAX-ADJ-UP-NO                    2012254
398832         ADD HOLD-AMT TO DUAL-SV-TAX-ADJ-UP-AMT                   9915858
398834                         WS-GL-DUAL-SV-TAX-ADJ-UP-AMT.            2012254
398836     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-SAV-FED.                     9915858
398838     MOVE WMS-DUAL-YR-CUR-SAV-FED TO EX04-NEW-AMT.                9915858
398840     GO TO K4670.                                                 9915858
398850 K4460.
398900     IF WMS-SAVINGS-TRLR EQUAL TO '0'
398950     OR  WMS-INT-STATUS GREATER THAN '6'
399000         MOVE '015' TO REJRESN                                    0717565
399050         GO TO K4680.
399090     ADD +.005, WMS-ACCR-INT GIVING WK-HOLD-AMT13.                9915845
399100     IF  WK-HOLD-AMT13 + HOLD-SAV-ACCR LESS THAN ZERO             9915845
399170     AND WBC-SAV-NEG-ACCRUAL EQUAL '0'                            0266741
399200         MOVE '041' TO REJRESN                                    0717565
399250         GO TO K4680.
399300     MOVE '02' TO IMEX-REC-NO.
399350     MOVE 'K7' TO IMEX-CODE-1.
399400     MOVE HOLD-SAV-ACCR TO EX02-BAL.                              9915255
399410     ADD +1 TO SEQ-CTR.                                           IM004
399420     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 IM004
399450     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
399500     ADD HOLD-SAV-ACCR TO WMS-ACCR-INT.                           1001985
399505     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
399510         ADD HOLD-SAV-ACCR TO INV-DIV-EXTL-ADJ                    1001985
399515                              WS-GL-INV-DIV-EXTL-ADJ              1004554
399520     ELSE                                                         1004554
399525         ADD HOLD-SAV-ACCR TO DDA-INT-ACC-ADJ-EXT                 1001985
399530                              WS-GL-DDA-INT-ACC-ADJ-EXT.          1004554
399550     ADD HOLD-SAV-ACCR TO WMS-MTD-ACCR-INT.                       1001985
399560     ADD HOLD-SAV-ACCR TO WMS-YTD-ACCR-INT.                       1105132
399600     IF  WMS-ACCR-INT LESS THAN +.005
399620     AND WMS-ACCR-INT GREATER THAN -0.005                         0902213
399650         MOVE ZERO TO WMS-ACCR-INT.
399700     MOVE WMS-ACCR-INT TO EX04-NEW-AMT.
399710     IF  BHW-SAV-FLAG  EQUAL 'R'                                  0316967
399720     AND WBHS-ENTRIES  GREATER THAN ZERO                          0902213
399722         ADD HOLD-SAV-ACCR  TO WBHS-SAV-ACCR-ADJ (1).             0316967
399724     IF  BHW-SAV-FLAG  EQUAL 'T'                                  0316967
399726     AND WBHT-ENTRIES  GREATER THAN ZERO                          0316967
399730         ADD HOLD-SAV-ACCR  TO WBHT-SAVT-ACCR-ADJ (1).            0316967
399732     IF  WMS-INT-TIS-EARN-INT + HOLD-SAV-ACCR LESS THAN ZERO      1001985
399736         MOVE ZERO TO WMS-INT-TIS-EARN-INT                        1004015
399738     ELSE                                                         1004015
399740         ADD HOLD-SAV-ACCR TO WMS-INT-TIS-EARN-INT.               1001985
399750     GO TO K4670.
399755 K4465.                                                           9915858
399760     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             9915858
399765         MOVE '015' TO REJRESN                                    0717565
399770         GO TO K4680.                                             9915858
399775     ADD +.005, WMS-DUAL-YR-PREV-IOD-INT GIVING WK-HOLD-AMT13.    9915858
399780     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915858
399785         MOVE '041' TO REJRESN                                    0717565
399790         GO TO K4680.                                             9915858
399792     ADD HOLD-AMT TO WMS-DUAL-YR-PREV-IOD-INT.                    9915858
399794     MOVE WMS-DUAL-YR-PREV-IOD-INT TO EX04-NEW-AMT.               9915858
399796     GO TO K4670.                                                 9915858
399800 K4470.
399850     IF WMS-SAVINGS-TRLR EQUAL TO '0'
399900     OR  WMS-INT-STATUS GREATER THAN '7'                          IM002
399950         MOVE '015' TO REJRESN                                    0717565
400000         GO TO K4680.
400010     ADD +.005, WMS-YTD-INT-PAID GIVING WK-HOLD-AMT13.            9915845
400020     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915845
400030         MOVE '041' TO REJRESN                                    0717565
400040         GO TO K4680.                                             IM003
400042     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN WMS-YTD-INT-PAID-1042 9915828
400044         MOVE '090' TO REJRESN                                    0717565
400046         GO TO K4680.                                             9915828
400050     ADD HOLD-AMT TO WMS-YTD-INT-PAID.                            1004554
400055     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
400060         ADD HOLD-AMT TO INV-DIV-PAID-YTD-ADJ                     1004554
400065                         WS-GL-INV-DIV-PAID-YTD-ADJ               1004554
400070     ELSE                                                         1004554
400075         ADD HOLD-AMT TO DDA-INT-YTD-ADJ                          1004554
400080                         WS-GL-DDA-INT-YTD-ADJ.                   1004554
400100     MOVE WMS-YTD-INT-PAID TO EX04-NEW-AMT.
400101     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
400102         ADD HOLD-AMT TO WMS-PLN-TRLR-PR-LTD-INT-PD.              0617360
400103     GO TO K4670.                                                 0617360
400104 K4472.                                                           2012254
400106     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             2012254
400108         MOVE '015' TO REJRESN                                    0717565
400110         GO TO K4680.                                             2012254
400112     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
400114         NEXT SENTENCE                                            2012254
400116     ELSE                                                         2012254
400118         MOVE '092' TO REJRESN                                    0717565
400120         GO TO K4680.                                             2012254
400122     IF  HOLD-AMT + WMS-DUAL-YR-CUR-IOD-STATE LESS ZERO           2012254
400124         MOVE '041' TO REJRESN                                    0717565
400126         GO TO K4680.                                             2012254
400128     IF  TR-CLASS EQUAL '61'                                      2012254
400130         ADD +1 TO DUAL-IO-TAX-ADJ-DN-NO-ST                       2012254
400132                   WS-GL-DUAL-IO-TX-ADJ-DN-ST-N                   2012254
400134         SUBTRACT HOLD-AMT FROM DUAL-IO-TAX-ADJ-DN-AMT-ST         2012254
400136                                WS-GL-DUAL-IO-TX-ADJ-DN-ST-A      2012254
400138     ELSE                                                         2012254
400140         ADD +1 TO DUAL-IO-TAX-ADJ-UP-NO-ST                       2012254
400142                   WS-GL-DUAL-IO-TX-ADJ-UP-ST-N                   2012254
400144         ADD HOLD-AMT TO DUAL-IO-TAX-ADJ-UP-AMT-ST                2012254
400146                         WS-GL-DUAL-IO-TX-ADJ-UP-ST-A.            2012254
400148     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-IOD-STATE.                   2012254
400150     MOVE WMS-DUAL-YR-CUR-IOD-STATE TO EX04-NEW-AMT.              2012254
400152     GO TO K4670.                                                 2012254
400154 K4474.                                                           2012254
400156     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             2012254
400158         MOVE '015' TO REJRESN                                    0717565
400160         GO TO K4680.                                             2012254
400162     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
400164         NEXT SENTENCE                                            2012254
400166     ELSE                                                         2012254
400168         MOVE '092' TO REJRESN                                    0717565
400170         GO TO K4680.                                             2012254
400172     IF  HOLD-AMT + WMS-DUAL-YR-CUR-IOD-LOCAL LESS ZERO           2012254
400174         MOVE '041' TO REJRESN                                    0717565
400176         GO TO K4680.                                             2012254
400178     IF  TR-CLASS EQUAL '61'                                      2012254
400180         ADD +1 TO DUAL-IO-TAX-ADJ-DN-NO-LOC                      2012254
400182                   WS-GL-DUAL-IO-TX-ADJ-DN-LOC-N                  2012254
400184         SUBTRACT HOLD-AMT FROM DUAL-IO-TAX-ADJ-DN-AMT-LOC        2012254
400186                                WS-GL-DUAL-IO-TX-ADJ-DN-LOC-A     2012254
400188     ELSE                                                         2012254
400190         ADD +1 TO DUAL-IO-TAX-ADJ-UP-NO-LOC                      2012254
400192                   WS-GL-DUAL-IO-TX-ADJ-UP-LOC-N                  2012254
400194         ADD HOLD-AMT TO DUAL-IO-TAX-ADJ-UP-AMT-LOC               2012254
400196                         WS-GL-DUAL-IO-TX-ADJ-UP-LOC-A.           2012254
400198     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-IOD-LOCAL.                   2012254
400200     MOVE WMS-DUAL-YR-CUR-IOD-LOCAL TO EX04-NEW-AMT.              2012254
400202     GO TO K4670.                                                 2012254
400204 K4476.                                                           2012254
400206     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             2012254
400208         MOVE '015' TO REJRESN                                    0717565
400210         GO TO K4680.                                             2012254
400212     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
400214         NEXT SENTENCE                                            2012254
400216     ELSE                                                         2012254
400218         MOVE '092' TO REJRESN                                    0717565
400220         GO TO K4680.                                             2012254
400222     IF  HOLD-AMT + WMS-DUAL-YR-CUR-SAV-STATE LESS ZERO           2012254
400224         MOVE '041' TO REJRESN                                    0717565
400226         GO TO K4680.                                             2012254
400228     IF  TR-CLASS EQUAL '61'                                      2012254
400230         ADD +1 TO DUAL-SV-TAX-ADJ-DN-NO-ST                       2012254
400232                   WS-GL-DUAL-SV-TX-ADJ-DN-ST-N                   2012254
400234         SUBTRACT HOLD-AMT FROM DUAL-SV-TAX-ADJ-DN-AMT-ST         2012254
400236                                WS-GL-DUAL-SV-TX-ADJ-DN-ST-A      2012254
400238     ELSE                                                         2012254
400240         ADD +1 TO DUAL-SV-TAX-ADJ-UP-NO-ST                       2012254
400242                   WS-GL-DUAL-SV-TX-ADJ-UP-ST-N                   2012254
400244         ADD HOLD-AMT TO DUAL-SV-TAX-ADJ-UP-AMT-ST                2012254
400246                         WS-GL-DUAL-SV-TX-ADJ-UP-ST-A.            2012254
400248     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-SAV-STATE.                   2012254
400250     MOVE WMS-DUAL-YR-CUR-SAV-STATE TO EX04-NEW-AMT.              2012254
400252     GO TO K4670.                                                 2012254
400254 K4478.                                                           2012254
400256     IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                             2012254
400258         MOVE '015' TO REJRESN                                    0717565
400260         GO TO K4680.                                             2012254
400262     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
400264         NEXT SENTENCE                                            2012254
400266     ELSE                                                         2012254
400268         MOVE '092' TO REJRESN                                    0717565
400270         GO TO K4680.                                             2012254
400272     IF  HOLD-AMT + WMS-DUAL-YR-CUR-SAV-LOCAL LESS ZERO           2012254
400274         MOVE '041' TO REJRESN                                    0717565
400276         GO TO K4680.                                             2012254
400278     IF  TR-CLASS EQUAL '61'                                      2012254
400280         ADD +1 TO DUAL-SV-TAX-ADJ-DN-NO-LOC                      2012254
400282                   WS-GL-DUAL-SV-TX-ADJ-DN-LOC-N                  2012254
400284         SUBTRACT HOLD-AMT FROM DUAL-SV-TAX-ADJ-DN-AMT-LOC        2012254
400286                                WS-GL-DUAL-SV-TX-ADJ-DN-LOC-A     2012254
400288     ELSE                                                         2012254
400290         ADD +1 TO DUAL-SV-TAX-ADJ-UP-NO-LOC                      2012254
400292                   WS-GL-DUAL-SV-TX-ADJ-UP-LOC-N                  2012254
400294         ADD HOLD-AMT TO DUAL-SV-TAX-ADJ-UP-AMT-LOC               2012254
400296                         WS-GL-DUAL-SV-TX-ADJ-UP-LOC-A.           2012254
400298     ADD HOLD-AMT TO WMS-DUAL-YR-CUR-SAV-LOCAL.                   2012254
400300     MOVE WMS-DUAL-YR-CUR-SAV-LOCAL TO EX04-NEW-AMT.              2012254
400302     GO TO K4670.                                                 2012254
400304*****    MEMO FIELD NUMBERS 7, 8, 11, 12 COME TO PARAGRAPH        2012254
400306*****  K4480 FIRST TO CHECK FOR A LOAN TRAILER.                   2012254
400308 K4480.                                                           2012254
400350     IF WMS-LOAN-TRLR EQUAL TO '0'
400400         MOVE '015' TO REJRESN                                    0717565
400450         GO TO K4680.
400650     IF  TR-MT-FLD EQUAL 08, GO TO K4490.                         1105504
400700     IF  TR-MT-FLD EQUAL 11, GO TO K4520.                         1105504
400750     IF  TR-MT-FLD EQUAL 12, GO TO K4530.                         1105504
400790     ADD +.005, WMS-LOAN-ACCR-INT GIVING WK-HOLD-AMT13.           9915845
400800     IF  WK-HOLD-AMT13 + HOLD-LOAN-ACCR LESS THAN ZERO            9915845
400900         MOVE '032' TO REJRESN                                    0717565
400950         GO TO K4680.
401000     ADD HOLD-LOAN-ACCR          TO WMS-LOAN-ACCR-INT             1001985
401010                                    LOAN-INT-ACC-ADJ-EXT          1001985
401020                                    WS-GL-LOAN-INT-ACC-ADJ-EXT.   1001985
401050     IF  WMS-EARNED-INT + HOLD-LOAN-ACCR LESS THAN ZERO           1001985
401070         MOVE ZERO TO WMS-EARNED-INT                              IM003
401080     ELSE                                                         IM003
401090         ADD HOLD-LOAN-ACCR TO WMS-EARNED-INT.                    1001985
401091     IF  WMS-LOAN-YTD-ACC-INT + HOLD-LOAN-ACCR LESS ZERO          1105132
401092         MOVE ZERO TO WMS-LOAN-YTD-ACC-INT                        1105132
401093     ELSE                                                         1105132
401094         ADD HOLD-LOAN-ACCR TO WMS-LOAN-YTD-ACC-INT.              1105132
401100     MOVE '02' TO IMEX-REC-NO.
401150     MOVE 'K0K4' TO IMEX-EX-CODE.
401200     MOVE HOLD-LOAN-ACCR TO EX02-BAL.                             9915255
401210     ADD +1 TO SEQ-CTR.                                           IM004
401220     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 IM004
401250     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
401300     IF WMS-LOAN-ACCR-INT LESS THAN +.005
401350         MOVE ZERO TO WMS-LOAN-ACCR-INT.
401400     MOVE WMS-LOAN-ACCR-INT TO EX04-NEW-AMT.
401450     GO TO K4670.
401500 K4490.
401510     ADD +.005, WMS-LOAN-YTD-INT GIVING WK-HOLD-AMT13.            9915845
401520     IF HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                   9915845
401530         MOVE '032' TO REJRESN                                    0717565
401540         GO TO K4680.                                             IM003
401550     ADD HOLD-AMT TO WMS-LOAN-YTD-INT, LOAN-INT-YTD-ADJ,          0902970
401551                                       WS-GL-LOAN-INT-YTD-ADJ.    0902970
401600     MOVE WMS-LOAN-YTD-INT TO EX04-NEW-AMT.
401650     GO TO K4670.
401700 K4500.
401750     IF  WMS-EXTRNL-DEPOSIT-TRLR EQUAL '0'
401800         MOVE '015' TO REJRESN                                    0717565
401850         GO TO K4680.
401900     ADD HOLD-AMT TO WMS-SAVINGS-BAL.
401950     MOVE WMS-SAVINGS-BAL TO EX04-NEW-AMT.
402000     GO TO K4670.
402050 K4510.
402100     ADD HOLD-NO TO WMS-SC-COMP-BAL.
402150     MOVE WMS-SC-COMP-BAL TO EX04-NEW-NO.
402200     GO TO K4670.
402250 K4520.
402260     ADD +.005, WMS-ADDITIONAL-CREDIT GIVING WK-HOLD-AMT13.       9915845
402270     IF HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                   9915845
402280         MOVE '032' TO REJRESN                                    0717565
402290         GO TO K4680.                                             IM003
402300     ADD HOLD-AMT TO WMS-ADDITIONAL-CREDIT.
402350     MOVE WMS-ADDITIONAL-CREDIT TO EX04-NEW-AMT.
402400     GO TO K4670.
402450 K4530.
402460     ADD +.005, WMS-PREV-BAL GIVING WK-HOLD-AMT13.                9915845
402470     IF HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                   9915845
402480         MOVE '032' TO REJRESN                                    0717565
402490         GO TO K4680.                                             IM003
402500     ADD HOLD-AMT TO WMS-PREV-BAL.
402550     MOVE WMS-PREV-BAL TO EX04-NEW-AMT.
402600     GO TO K4670.
402650 K4540.
402700     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'
402750         MOVE '015' TO REJRESN                                    0717565
402800         GO TO K4680.
402850     ADD HOLD-NO TO WMS-NONPAR-ITEMS, WMS-MTD-NONPAR-ITEMS.
402900     MOVE WMS-NONPAR-ITEMS TO EX04-NEW-NO.
402950     GO TO K4670.
403000 K4550.
403050     ADD HOLD-NO TO WMS-SC-TRAN-NO WMS-MTD-TRN-NO.
403100     MOVE WMS-SC-TRAN-NO TO EX04-NEW-NO.
403150     GO TO K4670.
403200 K4560.
403250     ADD HOLD-AMT TO WMS-SC-TRAN-AMT WMS-MTD-TRAN-AMT.
403300     MOVE WMS-SC-TRAN-AMT TO EX04-NEW-AMT.
403350     GO TO K4670.
403400 K4570.
403450     IF WMS-SAVINGS-TRLR EQUAL TO '0'
403500         MOVE '015' TO REJRESN                                    0717565
403550         GO TO K4680.
403600     ADD HOLD-NO TO WMS-INT-TRAN-NO WMS-INT-MTD-TRANNO.
403650     MOVE WMS-INT-TRAN-NO TO EX04-NEW-NO.
403700     GO TO K4670.
403750 K4580.
403800     IF  WMS-SAVINGS-TRLR EQUAL TO '0'
403850         MOVE '015' TO REJRESN                                    0717565
403900         GO TO K4680.
403950     ADD HOLD-AMT TO WMS-INT-TRAN-AMT WMS-INT-MTD-TRNAMT.
404000     MOVE WMS-INT-TRAN-AMT TO EX04-NEW-AMT.
404050     GO TO K4670.
404100 K4590.
404150     IF  WMS-STATUS EQUAL '04'
404200         MOVE '019' TO REJRESN                                    0717565
404250         GO TO K4680.
404300     IF  WMS-STATUS EQUAL '05'
404350         MOVE '008' TO REJRESN                                    0717565
404400         GO TO K4680.
404450     IF  WMS-STATUS EQUAL '08'
404500         MOVE '009' TO REJRESN                                    0717565
404550         GO TO K4680.
404600     IF  WMS-IOD-RATE-PTR EQUAL +0 AND WMS-HIFI-INDICATOR EQUAL +0
404650         MOVE '043' TO REJRESN                                    0717565
404700         GO TO K4680.
404790     ADD +.005, WMS-IOD-CYC-ACC-INT GIVING WK-HOLD-AMT13.         9915845
404800     IF  WK-HOLD-AMT13 + HOLD-SAV-ACCR LESS THAN ZERO             9915845
404820     AND WBC-IOD-NEG-ACCRUAL EQUAL '0'                            0266741
404850         MOVE '041' TO REJRESN                                    0717565
404900         GO TO K4680.
404950     MOVE '02' TO IMEX-REC-NO.
405000     MOVE 'K9' TO IMEX-CODE-1.
405050     MOVE HOLD-SAV-ACCR TO EX02-BAL.                              9915255
405060     ADD +1 TO SEQ-CTR.                                           IM004
405070     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 IM004
405100     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
405150     ADD HOLD-SAV-ACCR           TO WMS-IOD-CYC-ACC-INT           1001985
405160                                    IOD-INT-ACC-ADJ-EXT           1001985
405170                                    WS-GL-IOD-INT-ACC-ADJ-EXT.    1001985
405200     IF  WMS-IOD-MTD-ACC-INT + HOLD-SAV-ACCR LESS THAN ZERO       1001985
405220         MOVE ZERO TO WMS-IOD-MTD-ACC-INT                         IM003
405230     ELSE                                                         IM003
405240         ADD HOLD-SAV-ACCR TO WMS-IOD-MTD-ACC-INT.                1001985
405241     IF  WMS-IOD-YTD-ACC-INT + HOLD-SAV-ACCR LESS ZERO            1105132
405242         MOVE ZERO TO WMS-IOD-YTD-ACC-INT                         1105132
405243     ELSE                                                         1105132
405244         ADD HOLD-SAV-ACCR TO WMS-IOD-YTD-ACC-INT.                1105132
405250     IF  WMS-IOD-CYC-ACC-INT LESS THAN +.005
405270     AND WMS-IOD-CYC-ACC-INT GREATER THAN -0.005                  0902213
405300         MOVE ZERO TO WMS-IOD-CYC-ACC-INT.
405350     MOVE WMS-IOD-CYC-ACC-INT TO EX04-NEW-AMT.
405357     IF  BHW-IOD-FLAG  EQUAL 'M'                                  0902213
405364     AND WBHM-ENTRIES  GREATER THAN ZERO                          0902213
405371         ADD  HOLD-SAV-ACCR       TO WBHM-MMDA-ACCR-ADJ (1).      1105511
405378     IF  BHW-IOD-FLAG  EQUAL 'I'                                  0902213
405380     AND WBHI-ENTRIES  GREATER THAN ZERO                          1001985
405385         ADD  HOLD-SAV-ACCR       TO WBHI-IOD-ACCR-ADJ (1).       1001985
405390     IF  WMS-IOD-TIS-EARN-INT + HOLD-SAV-ACCR LESS THAN ZERO      1001985
405395         MOVE ZERO TO WMS-IOD-TIS-EARN-INT                        1004015
405396     ELSE                                                         1004015
405397         ADD HOLD-SAV-ACCR TO WMS-IOD-TIS-EARN-INT.               1001985
405400     GO TO K4670.
405450 K4600.
405460     ADD +.005, WMS-IOD-YTD-INT-PAID GIVING WK-HOLD-AMT13.        9915845
405470     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915845
405480         MOVE '041' TO REJRESN                                    0717565
405490         GO TO K4680.                                             IM003
405492     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN                       9915828
405494                    WMS-IOD-YTD-INT-PAID-1042                     9915828
405496         MOVE '090' TO REJRESN                                    0717565
405497         GO TO K4680.                                             0617360
405498     ADD HOLD-AMT TO WMS-IOD-YTD-INT-PAID IOD-INT-YTD-ADJ         0617360
405499                                          WS-GL-IOD-INT-YTD-ADJ.  0617360
405500     MOVE WMS-IOD-YTD-INT-PAID TO EX04-NEW-AMT.                   0617360
405501     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
405502         ADD HOLD-AMT TO WMS-PLN-TRLR-PR-LTD-INT-PD.              0617360
405503     GO TO K4670.                                                 2012254
405504 K4602.                                                           2012254
405505     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
405506         NEXT SENTENCE                                            2012254
405507     ELSE                                                         2012254
405508         MOVE '092' TO REJRESN                                    0717565
405509         GO TO K4680.                                             2012254
405510     IF  TR-CLASS EQUAL '61'                                      2012254
405511         IF  (HOLD-AMT + WMS-IOD-YTD-STATE-TAX) LESS +0           2012254
405512             MOVE '041' TO REJRESN                                0717565
405513             GO  TO  K4680                                        2012254
405514         ELSE                                                     2012254
405515             ADD +1 TO IOD-TAX-ADJ-DN-NO-ST                       2012254
405516                       WS-GL-IOD-TAX-ADJ-DN-ST-NO                 2012254
405517             SUBTRACT HOLD-AMT FROM IOD-TAX-ADJ-DN-AMT-ST         2012254
405518                                    WS-GL-IOD-TAX-ADJ-DN-ST-AMT   2012254
405519     ELSE                                                         2012254
405520         ADD +1 TO IOD-TAX-ADJ-UP-NO-ST WS-GL-IOD-TAX-ADJ-UP-ST-NO2012254
405521         ADD HOLD-AMT TO IOD-TAX-ADJ-UP-AMT-ST                    2012254
405522                         WS-GL-IOD-TAX-ADJ-UP-ST-AMT.             2012254
405523     ADD HOLD-AMT TO WMS-IOD-YTD-STATE-TAX.                       2012254
405524     MOVE '4' TO EX01-TYPE.                                       2012254
405525     MOVE '2' TO EX01-TAX-TYPE.                                   2012254
405526     MOVE WMS-IOD-YTD-STATE-TAX TO EX04-NEW-AMT.                  2012254
405527     GO TO K4670.                                                 2012254
405528 K4604.                                                           2012254
405529     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
405530         NEXT SENTENCE                                            2012254
405531     ELSE                                                         2012254
405532         MOVE '092' TO REJRESN                                    0717565
405533         GO TO K4680.                                             2012254
405534     IF  TR-CLASS EQUAL '61'                                      2012254
405535         IF  (HOLD-AMT + WMS-IOD-YTD-LOCAL-TAX) LESS +0           2012254
405536             MOVE '041' TO REJRESN                                0717565
405537             GO  TO  K4680                                        2012254
405538         ELSE                                                     2012254
405539             ADD +1 TO IOD-TAX-ADJ-DN-NO-LOC                      2012254
405540                       WS-GL-IOD-TAX-ADJ-DN-LOC-NO                2012254
405541             SUBTRACT HOLD-AMT FROM IOD-TAX-ADJ-DN-AMT-LOC        2012254
405542                                    WS-GL-IOD-TAX-ADJ-DN-LOC-AMT  2012254
405543     ELSE                                                         2012254
405544         ADD +1 TO IOD-TAX-ADJ-UP-NO-LOC                          2012254
405545                   WS-GL-IOD-TAX-ADJ-UP-LOC-NO                    2012254
405546         ADD HOLD-AMT TO IOD-TAX-ADJ-UP-AMT-LOC                   2012254
405547                         WS-GL-IOD-TAX-ADJ-UP-LOC-AMT.            2012254
405548     ADD HOLD-AMT TO WMS-IOD-YTD-LOCAL-TAX.                       2012254
405549     MOVE '4' TO EX01-TYPE.                                       2012254
405550     MOVE '3' TO EX01-TAX-TYPE.                                   2012254
405551     MOVE WMS-IOD-YTD-LOCAL-TAX TO EX04-NEW-AMT.                  2012254
405552     GO TO K4670.                                                 2012254
405553 K4606.                                                           2012254
405554     IF  WMS-SAVINGS-TRLR EQUAL '0'                               2012254
405555         MOVE '015' TO REJRESN                                    0717565
405556         GO TO K4680.                                             2012254
405557     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
405558         NEXT SENTENCE                                            2012254
405559     ELSE    MOVE '092' TO REJRESN                                0717565
405560         GO TO K4680.                                             2012254
405561     IF  TR-CLASS EQUAL '61'                                      2012254
405562         IF  (HOLD-AMT + WMS-YTD-SAV-STATE-TAX) LESS +0           2012254
405563             MOVE '041' TO REJRESN                                0717565
405564             GO TO K4680.                                         2012254
405565     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
405566         IF  TR-CLASS EQUAL '61'                                  2012254
405567             SUBTRACT HOLD-AMT FROM INV-TAX-ADJ-DN-ST             2012254
405568                                    WS-GL-INV-TAX-ADJ-DN-ST       2012254
405569         ELSE                                                     2012254
405570             ADD HOLD-AMT TO        INV-TAX-ADJ-UP-ST             2012254
405571                                    WS-GL-INV-TAX-ADJ-UP-ST       2012254
405572     ELSE                                                         2012254
405573         IF  TR-CLASS EQUAL '61'                                  2012254
405574             ADD +1 TO SAV-TAX-ADJ-DN-NO-ST                       2012254
405575                       WS-GL-SAV-TAX-ADJ-DN-ST-NO                 2012254
405576             SUBTRACT HOLD-AMT FROM SAV-TAX-ADJ-DN-AMT-ST         2012254
405577                                    WS-GL-SAV-TAX-ADJ-DN-ST-AMT   2012254
405578         ELSE                                                     2012254
405579             ADD +1 TO SAV-TAX-ADJ-UP-NO-ST                       2012254
405580                       WS-GL-SAV-TAX-ADJ-UP-ST-NO                 2012254
405581             ADD HOLD-AMT TO SAV-TAX-ADJ-UP-AMT-ST                2012254
405582                             WS-GL-SAV-TAX-ADJ-UP-ST-AMT.         2012254
405583     ADD HOLD-AMT TO WMS-YTD-SAV-STATE-TAX.                       2012254
405584     MOVE '8' TO EX01-TYPE.                                       2012254
405585     MOVE '2' TO EX01-TAX-TYPE.                                   2012254
405586     MOVE WMS-YTD-SAV-STATE-TAX TO EX04-NEW-AMT.                  2012254
405587     GO TO K4670.                                                 2012254
405588 K4608.                                                           2012254
405589     IF  WMS-SAVINGS-TRLR EQUAL '0'                               2012254
405590         MOVE '015' TO REJRESN                                    0717565
405591         GO TO K4680.                                             2012254
405592     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2' OR '3'            2012254
405593         NEXT SENTENCE                                            2012254
405594     ELSE   MOVE '092' TO REJRESN                                 0717565
405595         GO TO K4680.                                             9915858
405596     IF  TR-CLASS EQUAL '61'                                      2012254
405597         IF  (HOLD-AMT + WMS-YTD-SAV-LOCAL-TAX) LESS +0           2012254
405598             MOVE '041' TO REJRESN                                0717565
405599             GO TO K4680.                                         2012254
405600     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
405601         IF  TR-CLASS EQUAL '61'                                  2012254
405602             SUBTRACT HOLD-AMT FROM INV-TAX-ADJ-DN-LOC            2012254
405603                                    WS-GL-INV-TAX-ADJ-DN-LOC      2012254
405604         ELSE                                                     2012254
405605             ADD HOLD-AMT TO        INV-TAX-ADJ-UP-LOC            2012254
405606                                    WS-GL-INV-TAX-ADJ-UP-LOC      2012254
405607     ELSE                                                         2012254
405608         IF  TR-CLASS EQUAL '61'                                  2012254
405609             ADD +1 TO SAV-TAX-ADJ-DN-NO-LOC                      2012254
405610                       WS-GL-SAV-TAX-ADJ-DN-LOC-NO                2012254
405611             SUBTRACT HOLD-AMT FROM SAV-TAX-ADJ-DN-AMT-LOC        2012254
405612                                    WS-GL-SAV-TAX-ADJ-DN-LOC-AMT  2012254
405613         ELSE                                                     2012254
405614             ADD +1 TO SAV-TAX-ADJ-UP-NO-LOC                      2012254
405615                       WS-GL-SAV-TAX-ADJ-UP-LOC-NO                2012254
405616             ADD HOLD-AMT TO SAV-TAX-ADJ-UP-AMT-LOC               2012254
405617                             WS-GL-SAV-TAX-ADJ-UP-LOC-AMT.        2012254
405618     ADD HOLD-AMT TO WMS-YTD-SAV-LOCAL-TAX.                       2012254
405619     MOVE '8' TO EX01-TYPE.                                       2012254
405620     MOVE '3' TO EX01-TAX-TYPE.                                   2012254
405621     MOVE WMS-YTD-SAV-LOCAL-TAX TO EX04-NEW-AMT.                  2012254
405622     GO TO K4670.                                                 2012254
405623 K4610.                                                           2012254
405624     IF  HOLD-AMT + WMS-IOD-YTD-INT-PAID-1042 LESS THAN ZERO      2012254
405625         MOVE '041' TO REJRESN                                    0717565
405626         GO TO K4680.                                             2012254
405627     IF  HOLD-AMT + WMS-IOD-YTD-INT-PAID-1042 GREATER THAN        2012254
405628                    WMS-IOD-YTD-INT-PAID                          2012254
405629         MOVE '090' TO REJRESN                                    0717565
405630         GO TO K4680.                                             2012254
405631     ADD HOLD-AMT TO WMS-IOD-YTD-INT-PAID-1042.                   2012254
405632     MOVE WMS-IOD-YTD-INT-PAID-1042 TO EX04-NEW-AMT.              2012254
405633     GO TO K4670.                                                 2012254
405634 K4615.                                                           2012254
405635     IF WMS-SAVINGS-TRLR EQUAL TO '0'                             2012254
405636     OR  WMS-INT-STATUS GREATER THAN '7'                          2012254
405637         MOVE '015' TO REJRESN                                    0717565
405638         GO TO K4680.                                             2012254
405639     IF  HOLD-AMT + WMS-YTD-INT-PAID-1042 LESS THAN ZERO          2012254
405640         MOVE '041' TO REJRESN                                    0717565
405641         GO TO K4680.                                             2012254
405642     IF  HOLD-AMT + WMS-YTD-INT-PAID-1042 GREATER THAN            2012254
405643                    WMS-YTD-INT-PAID                              2012254
405644         MOVE '090' TO REJRESN                                    0717565
405645         GO TO K4680.                                             2012254
405646     ADD HOLD-AMT TO WMS-YTD-INT-PAID-1042.                       2012254
405647     MOVE WMS-YTD-INT-PAID-1042 TO EX04-NEW-AMT.                  2012254
405648     GO TO K4670.                                                 2012254
405649 K4620.                                                           2012254
405700     IF  WMS-SAVINGS-TRLR EQUAL '0'
405750         MOVE '015' TO REJRESN                                    0717565
405800         GO  TO  K4680.
405850     ADD HOLD-AMT TO WMS-CMA-PREV-YTD-MN-FEES.
405900     MOVE WMS-CMA-PREV-YTD-MN-FEES TO EX04-NEW-AMT.
405950     GO  TO  K4670.
406000 K4630.
406050     IF (HOLD-NO + WMS-SC-AMTTRNSFR-NO) LESS THAN +0
406100         MOVE '041' TO REJRESN                                    0717565
406150         GO  TO  K4680.
406200     ADD HOLD-NO TO WMS-SC-AMTTRNSFR-NO.
406250     MOVE WMS-SC-AMTTRNSFR-NO TO EX04-NEW-NO.
406300     GO  TO  K4670.
406350 K4640.
406400     IF (HOLD-NO + WMS-SC-CHECK-ITEMS) LESS THAN +0
406450         MOVE '041' TO REJRESN                                    0717565
406500         GO  TO  K4680.
406550     ADD HOLD-NO TO WMS-SC-CHECK-ITEMS.
406600     MOVE WMS-SC-CHECK-ITEMS TO EX04-NEW-NO.
406650     GO TO K4670.
406700 K4642.
406750     IF  TR-CLASS EQUAL '61'
406800         IF  (HOLD-AMT + WMS-IOD-YTD-TAX) LESS THAN +0
406850             MOVE '041' TO REJRESN                                0717565
406900             GO  TO  K4680
406950         ELSE
407000             ADD +1 TO IOD-TAX-ADJ-DN-NO, WS-GL-IOD-TAX-ADJ-DN-NO 0902970
407050             SUBTRACT HOLD-AMT FROM IOD-TAX-ADJ-DN-AMT
407051                                    WS-GL-IOD-TAX-ADJ-DN-AMT      0902970
407100     ELSE
407150         ADD +1 TO IOD-TAX-ADJ-UP-NO, WS-GL-IOD-TAX-ADJ-UP-NO     0902970
407200         ADD HOLD-AMT TO IOD-TAX-ADJ-UP-AMT                       0902970
407201                         WS-GL-IOD-TAX-ADJ-UP-AMT.                0902970
407250     ADD HOLD-AMT TO WMS-IOD-YTD-TAX.
407300     MOVE '4' TO EX01-TYPE.
407320     MOVE '1' TO EX01-TAX-TYPE.                                   2012254
407350     MOVE WMS-IOD-YTD-TAX TO EX04-NEW-AMT.
407400     GO TO K4670.
407450 K4644.
407500     IF  WMS-SAVINGS-TRLR EQUAL '0'
407550         MOVE '015' TO REJRESN                                    0717565
407600         GO TO K4680.
407650     IF  TR-CLASS EQUAL '61'
407700         IF  (HOLD-AMT + WMS-YTD-SAV-TAX) LESS THAN +0
407750             MOVE '041' TO REJRESN                                0717565
407800             GO TO K4680.                                         1004554
407850     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
407855         IF  TR-CLASS EQUAL '61'                                  1004554
407860             SUBTRACT HOLD-AMT FROM INV-TAX-ADJ-DN                1004554
407865                                    WS-GL-INV-TAX-ADJ-DN          1004554
407870         ELSE                                                     1004554
407875             ADD HOLD-AMT TO        INV-TAX-ADJ-UP                1004554
407880                                    WS-GL-INV-TAX-ADJ-UP          1004554
407885     ELSE                                                         1004554
407890         IF  TR-CLASS EQUAL '61'                                  1004554
407895             ADD +1 TO SAV-TAX-ADJ-DN-NO                          1004554
407900                       WS-GL-SAV-TAX-ADJ-DN-NO                    1004554
407950             SUBTRACT HOLD-AMT FROM SAV-TAX-ADJ-DN-AMT
407960                                    WS-GL-SAV-TAX-ADJ-DN-AMT      1004554
408000         ELSE                                                     1004554
408050             ADD +1 TO SAV-TAX-ADJ-UP-NO                          1004554
408060                       WS-GL-SAV-TAX-ADJ-UP-NO                    1004554
408100             ADD HOLD-AMT TO SAV-TAX-ADJ-UP-AMT                   1004554
408110                             WS-GL-SAV-TAX-ADJ-UP-AMT.            1004554
408150     ADD HOLD-AMT TO WMS-YTD-SAV-TAX.
408200     MOVE '8' TO EX01-TYPE.
408220     MOVE '1' TO EX01-TAX-TYPE.                                   2012254
408250     MOVE WMS-YTD-SAV-TAX TO EX04-NEW-AMT.
408300     GO TO K4670.
408350 K4646.
408360     ADD +.005, WMS-IOD-PRV-YTD-INT-PD GIVING WK-HOLD-AMT13.      9915845
408370     IF  HOLD-AMT + WK-HOLD-AMT13 LESS THAN ZERO                  9915845
408380         MOVE '041' TO REJRESN                                    0717565
408390         GO TO K4680.                                             IM003
408400     ADD HOLD-AMT TO WMS-IOD-PRV-YTD-INT-PD.
408450     MOVE WMS-IOD-PRV-YTD-INT-PD TO EX04-NEW-AMT.
408500     GO TO K4670.
408550 K4648.
408600     IF  WMS-OD-ACCRUAL-TRLR NOT EQUAL '1'
408650         MOVE '015' TO REJRESN                                    0717565
408700         GO TO K4680.
408750     IF  WMS-STATUS EQUAL '04'
408800         MOVE '019' TO REJRESN                                    0717565
408850         GO TO K4680.
408900     IF  WMS-STATUS EQUAL '05'
408950         MOVE '008' TO REJRESN                                    0717565
409000         GO TO K4680.
409050     IF  WMS-STATUS EQUAL '08'
409100         MOVE '009' TO REJRESN                                    0717565
409150         GO TO K4680.
409160     IF  WMS-OD-STATUS GREATER THAN '0'                           IM002
409170         MOVE '038' TO REJRESN                                    0717565
409180         GO TO K4680.                                             IM002
409190     ADD +.005, WMS-OD-CYC-ACR GIVING WK-HOLD-AMT13.              9915845
409200     IF  WK-HOLD-AMT13 + HOLD-SAV-ACCR LESS THAN ZERO             9915845
409270     AND WBC-OD-NEG-ACCRUAL EQUAL '0'                             0266741
409300         MOVE '041' TO REJRESN                                    0717565
409350         GO TO K4680.
409400     MOVE '02' TO IMEX-REC-NO.
409450     MOVE 'K5' TO IMEX-CODE-1.
409500     MOVE HOLD-SAV-ACCR TO EX02-BAL.                              9915255
409510     ADD +1 TO SEQ-CTR.                                           IM004
409520     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 IM004
409550     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
409600     ADD HOLD-SAV-ACCR           TO WMS-OD-CYC-ACR                1001985
409610                                    OD-ACCRL-ADJ-EXTRNL           1001985
409620                                    WS-GL-OD-ACCRL-ADJ-EXTRNL.    1001985
409650     ADD HOLD-SAV-ACCR TO WMS-OD-MTD-ACR.                         1001985
409660     ADD HOLD-SAV-ACCR TO WMS-OD-YTD-ACR.                         1105132
409700     IF  WMS-OD-CYC-ACR LESS THAN +.005
409720     AND WMS-OD-CYC-ACR GREATER THAN -0.005                       0902213
409750         MOVE ZERO TO WMS-OD-CYC-ACR.
409800     MOVE WMS-OD-CYC-ACR TO EX04-NEW-AMT.
409810     IF  BHW-ODAC-FLAG EQUAL 'N'                                  0902213
409820     AND WBHO-ENTRIES  GREATER THAN ZERO                          0902213
409830         ADD HOLD-SAV-ACCR       TO WBHO-ODAC-ACCR-ADJ (1).       1001985
409850     GO TO K4670.
409900 K4650.
409950     IF  WMS-OD-ACCRUAL-TRLR NOT EQUAL '1'
410000         MOVE '015' TO REJRESN                                    0717565
410050         GO TO K4680.
410060     IF  WMS-OD-STATUS GREATER THAN '0'                           IM002
410070         MOVE '038' TO REJRESN                                    0717565
410080         GO TO K4680.                                             IM002
410100     ADD HOLD-AMT TO WMS-OD-YTD-CHGD,
410150                     OD-CHRGS-ADJ-YTD                             0902970
410151                     WS-GL-OD-CHRGS-ADJ-YTD.                      0902970
410200     MOVE WMS-OD-YTD-CHGD TO EX04-NEW-AMT.
410250     GO TO K4670.
410300 K4652.
410350     IF  WMS-OD-ACCRUAL-TRLR NOT EQUAL '1'
410400         MOVE '015' TO REJRESN                                    0717565
410450         GO TO K4680.
410500     ADD HOLD-AMT TO WMS-OD-PREV-YTD-CHGD.
410550     MOVE WMS-OD-PREV-YTD-CHGD TO EX04-NEW-AMT.
410600     GO TO K4670.
410603 K4654.                                                           IM006
410606     IF  WMS-LOAN-TRLR EQUAL '0'                                  IM006
410609         MOVE '015' TO REJRESN                                    0717565
410612         GO TO K4680.                                             IM006
410615     ADD HOLD-AMT TO WMS-COSTS-UNEARNED, LOAN-ADJ-COSTS           0902970
410616                                         WS-GL-LOAN-ADJ-COSTS.    0902970
410617     MOVE WMS-COSTS-UNEARNED TO EX04-NEW-AMT.                     0902970
410618     GO TO K4670.                                                 IM006
410621 K4656.                                                           IM006
410624     IF  WMS-LOAN-TRLR EQUAL '0'                                  IM006
410627         MOVE '015' TO REJRESN                                    0717565
410630         GO TO K4680.                                             IM006
410633     ADD HOLD-AMT TO WMS-COSTS-AMORTIZED                          1004773
410634                     WMS-LOAN-AMORT-YTD.                          1004773
410643     MOVE WMS-COSTS-AMORTIZED TO EX04-NEW-AMT.                    IM006
410650     GO TO K4670.                                                 IM007
410652 K4658.                                                           IM007
410654     IF  TR-CLASS EQUAL '61'                                      IM007
410656         IF  (HOLD-AMT + WMS-IOD-PEND-TAX) LESS THAN +0           IM007
410658             MOVE '041' TO REJRESN                                0717565
410659             GO  TO  K4680.                                       2012254
410660*  ************************************************************   2012254
410661*   DO NOT INCREASE PENDING TAX IF WITHHOLDING AND PENDING OF *   2012254
410662*   INTEREST  DOES NOT APPLY                                  *   2012254
410663*  ************************************************************   2012254
410664     IF  TR-CLASS EQUAL '60'                                      2012254
410665         IF  SAV-BKUP-WTHLD-FLAG EQUAL '1' OR '2' OR '3'          2012254
410666             NEXT SENTENCE                                        2012254
410667         ELSE                                                     2012254
410668             MOVE '038' TO REJRESN                                0717565
410669             GO TO K4680.                                         2012254
410670     ADD HOLD-AMT TO WMS-IOD-PEND-TAX.                            2012254
410671     MOVE '4' TO EX01-TYPE.                                       2012254
410672     MOVE '1' TO EX01-TAX-TYPE.                                   2012254
410674     MOVE WMS-IOD-PEND-TAX TO EX04-NEW-AMT.                       IM007
410675     GO TO K4670.                                                 IM007
410676 K4660.                                                           IM007
410677     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
410678         MOVE '015' TO REJRESN                                    0717565
410679         GO TO K4680.                                             IM007
410680     IF  TR-CLASS EQUAL '61'                                      IM007
410681         IF  (HOLD-AMT + WMS-SAV-PEND-TAX) LESS THAN +0           IM007
410682             MOVE '041' TO REJRESN                                0717565
410684             GO  TO  K4680.                                       IM007
410686*  ************************************************************   IM007
410689*   DO NOT INCREASE PENDING TAX IF WITHHOLDING AND PENDING OF *   IM007
410692*   INTEREST  DOES NOT APPLY                                  *   IM007
410695*  ************************************************************   IM007
410698     IF  TR-CLASS EQUAL '60'                                      IM007
410700         IF  (SAV-BKUP-WTHLD-FLAG EQUAL '1' OR '2' OR '3')        IM007
410701         AND WMS-CMA-INDICATOR EQUAL '0'                          IM007
410702             NEXT SENTENCE                                        IM007
410704         ELSE                                                     IM007
410706             MOVE '038' TO REJRESN                                0717565
410708             GO TO K4680.                                         IM007
410716     ADD HOLD-AMT TO WMS-SAV-PEND-TAX.                            IM007
410719     MOVE '8' TO EX01-TYPE.                                       IM007
410720     MOVE '1' TO EX01-TAX-TYPE.                                   2012254
410722     MOVE WMS-SAV-PEND-TAX TO EX04-NEW-AMT.                       IM007
410725     GO TO K4670.                                                 IM007
410726 K4661.                                                           1004554
410728     IF  WMS-INVESTMENT-TRLR EQUAL TO '0'                         1004554
410729     OR (WMS-SAVINGS-TRLR EQUAL TO '1'                            1004554
410730     AND WMS-INT-STATUS GREATER THAN '6')                         1004554
410731         MOVE '015' TO REJRESN                                    0717565
410732         GO TO K4680.                                             1004554
410733     ADD +.005, WMS-INV-SVC-ACCRD-CYC GIVING WK-HOLD-AMT13.       9915845
410734     IF  HOLD-SAV-ACCR + WK-HOLD-AMT13 LESS THAN ZERO             0266605
410735         MOVE '041' TO REJRESN                                    0717565
410736         GO TO K4680.                                             1004554
410737     MOVE '02' TO IMEX-REC-NO.                                    0266605
410738     MOVE 'KJ' TO IMEX-CODE-1.                                    0266605
410739     MOVE HOLD-SAV-ACCR TO EX02-BAL.                              0266605
410740     ADD +1 TO SEQ-CTR.                                           0266605
410741     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 0266605
410742     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0266605
410743     ADD HOLD-SAV-ACCR TO WMS-INV-SVC-ACCRD-CYC                   0266605
410744                          INV-SVC-ADJ-EXTL                        0266605
410745                          WS-GL-INV-SVC-ADJ-EXTL.                 0266605
410746     ADD HOLD-SAV-ACCR TO WMS-INV-SVC-ACCRD-MTD.                  0266605
410747     IF  WMS-INV-SVC-ACCRD-CYC LESS THAN +.005                    0266605
410748         MOVE ZERO TO WMS-INV-SVC-ACCRD-CYC.                      0266605
410749     MOVE WMS-INV-SVC-ACCRD-CYC TO EX04-NEW-AMT.                  0266605
410750     GO TO K4670.                                                 0266605
410751 K4662.                                                           0266605
410752     ADD HOLD-AMT            TO WMS-NB-MTD-WVE-AMT.               0266605
410753     MOVE WMS-NB-MTD-WVE-AMT TO EX04-NEW-AMT.                     0266605
410754     GO TO K4670.                                                 0266605
410755 K4664.                                                           0266605
410756     ADD HOLD-AMT            TO WMS-NB-MTD-SC-AMT.                0266605
410757     MOVE WMS-NB-MTD-SC-AMT  TO EX04-NEW-AMT.                     0266605
410758     GO TO K4670.                                                 0266605
410759 K4666.                                                           0266605
410760     ADD HOLD-AMT            TO WMS-NB-MTD-MIN-WVE.               0266605
410761     MOVE WMS-NB-MTD-MIN-WVE TO EX04-NEW-AMT.                     0266605
410762     GO TO K4670.                                                 0266605
410903 K4668.                                                           9915858
410905     IF  WMS-EXT-SC-DATA-TRLR EQUAL TO '0'                        9915828
410910         MOVE '015' TO REJRESN                                    0717565
410915         GO TO K4680.                                             9915828
410920     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL TO '0' OR ' '             9915828
410925         MOVE '015' TO REJRESN                                    0717565
410930         GO TO K4680.                                             9915828
410935     IF  WMS-SC-MISC-CNTR-FLG (X) EQUAL TO '1' OR '3' OR '5'      9915828
410940         ADD HOLD-AMT TO WMS-SC-MISC-AMTS (X)                     9915828
410945         MOVE WMS-SC-MISC-AMTS (X) TO EX04-NEW-AMT                9915828
410950     ELSE                                                         9915828
410955         ADD HOLD-NO  TO WMS-SC-MISC-NOS (X)                      9915828
410960         MOVE WMS-SC-MISC-NOS (X) TO EX04-NEW-NO.                 9915828
410965     GO TO K4670.                                                 9915828
410970 K4669.                                                           2016639
410971     IF  WMS-XINV-LINK-IND EQUAL 'L' OR 'P'                       2016639
410972         GO TO K4669-CONT.                                        2016639
410973     IF  (HOLD-AMT + WMS-XINV-BALANCE) NOT EQUAL +0               2016639
410974         MOVE '038' TO REJRESN                                    0717565
410975         GO TO K4680.                                             2016639
410979 K4669-CONT.                                                      2016639
410980     IF  TR-CLASS EQUAL '61'                                      2016639
410981         IF  (HOLD-AMT + WMS-XINV-BALANCE) LESS THAN +0           2016639
410982             MOVE '041' TO REJRESN                                0717565
410983             GO TO K4680.                                         2016639
410984     ADD HOLD-AMT     TO  WMS-XINV-BALANCE                        2016639
410985                          WXI-XINV-BALANCE.                       2016639
410986     MOVE WMS-XINV-BALANCE   TO EX04-NEW-AMT.                     2016639
410987     IF  WMS-XINV-PROCESS-IND EQUAL '1'                           2016639
410988         ADD HOLD-AMT TO  T3-XINV-SD-EXT-ADJ-AMT                  2016639
410989                          WS-GL-XINV-SD-EXT-ADJ-AMT.              2016639
410990     IF  WMS-XINV-PROCESS-IND EQUAL '2'                           2016639
410991         ADD HOLD-AMT TO  T3-XINV-ND-EXT-ADJ-AMT                  2016639
410992                          WS-GL-XINV-ND-EXT-ADJ-AMT.              2016639
410993     PERFORM R9110-QN THRU R9199-EXIT.                            2016639
410994     GO TO K4670.                                                 2016639
411000 K4670.                                                           9915828
411002     MOVE WMS-DATE-LAST-MAINT TO EX04-DATE-LAST-MAINT.            9916299
411005     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
411010     IF  TR-MT-CUST-GEN EQUAL '1'                                 9915828
411011     AND WBC-DLCA-FLAG EQUAL '0'                                  0266741
411015         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
411020     MOVE '04' TO IMEX-REC-NO.                                    9915828
411025     MOVE 'B0B3' TO IMEX-EX-CODE.                                 9915828
411030     MOVE TR-MT-AMT TO EX04-AMT.                                  9915828
411035     MOVE TR-CLASS TO EX04-TR-CODE.                               9915828
411040     MOVE TR-MT-FLD TO EX04-FIELD-P.                              9915828
411045     IF  TR-MT-REF-NO NUMERIC                                     9915828
411050         MOVE TR-MT-REF-NO TO IM-EXC-REF-NUM                      9915828
411055     ELSE                                                         9915828
411060         MOVE ZEROES       TO IM-EXC-REF-NUM.                     9915828
411100     MOVE TR-SOURCE TO EX04-SOURCE.
411150     MOVE TR-BATCH TO EX04-BATCH.
411200     MOVE TR-SEQ TO EX04-SEQ.
411250     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
411300     GO TO Q4600.
411350 K4680.
411400     MOVE '09' TO RECNO.
411450     MOVE 'D0' TO EXCODE-1.
411500     MOVE TR-SOURCE TO EX09-SOURCE.
411550     MOVE TR-BATCH TO EX09-BATCH.
411600     MOVE TR-SEQ TO EX09-SEQ.
411650     MOVE TR-CLASS TO EX09-TR-CODE.
411700     MOVE TR-MEMO-TRANS TO EX09-REMAINDER.
411750     GO TO UNPOST-EXCEPT.
411800     SKIP3
411850 ROOT-SECTION-W      SECTION 1.
411900     SKIP3
411950*    *************  FORMATTED MASTER REQUEST  **************
412000     SKIP1
412050 K4700.
412100     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K3130.
412150     MOVE '03' TO IMEX-REC-NO.                                    0902213
412160     MOVE TR-SCLASS1 TO EX03-TYP.                                 0902213
412200     MOVE 'I3' TO IMEX-CODE-1.
412250     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
412300     GO TO Q4500.
412350     SKIP3
412400*    ***************  SPECIAL INSTRUCTIONS  ****************
412450     SKIP1
412500 K4800.
412550     IF ACCT-NOT-FOUND EQUAL TO '1'
412600         IF SH-REJ-FLAG EQUAL TO '0'
412650             GO TO K2410
412700         ELSE
412750             MOVE '31' TO TR-REJ-PROG
412800             MOVE '002' TO TR-REJ-RESN                            0817735
412850             MOVE '1' TO TRAN-REWRITE-SW                          IM002
412860             GO TO Q4600.                                         IM002
412870     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915857
412880         MOVE '0' TO TRIAL-CODE                                   9915857
412890         GO TO Q4600.                                             9915857
412900     MOVE '1' TO WMS-SPEC-INST-TODAY.
412950     IF TR-SH-NEW EQUAL '2' OR '3'
412960     AND WBC-DLCA-FLAG EQUAL '0'                                  0266741
413000         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.    0266741
413050     IF WBC-TRIAL-SPEC-INST EQUAL TO '1'                          0266741
413100         MOVE '1' TO TRIAL-CODE
413150     ELSE
413200         MOVE '0' TO TRIAL-CODE
413250         GO TO Q4600.
413300     GO TO R0010.
413350*  --ADDITIONAL PROCESSING OF SPECIAL INSTRUCTIONS AT S2010
413400     SKIP3
413450*    ******  NON-PAR/LOCK-BOX TRANSACTION PROCESSING  ******
413500     SKIP1
413550 K4900.
413600     IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'
413650         GO TO K3150.
413700     IF ACCT-NOT-FOUND EQUAL TO '1', GO TO K2280.
413750     ADD TR-NP-LOCAL-NO TO WMS-LOCAL-ITEMS, WMS-MTD-LOCAL-ITEMS.
413800     ADD TR-NP-FOREIGN-NO TO WMS-FOREIGN-ITEMS
413850                             WMS-MTD-FOREIGN-ITEMS.
413900     ADD TR-NP-NON-PAR-NO TO WMS-NONPAR-ITEMS
413950                             WMS-MTD-NONPAR-ITEMS.
414000     ADD TR-NP-NON-PAR-AMT TO WMS-NON-PAR-DEP
414050                              WMS-MTD-NONPAR-AMT.
414100     ADD TR-NP-LOCK-BOX-NO TO WMS-LOCKBOX-ITEMS
414150                              WMS-MTD-LOCKBOX-ITEMS.
414200     ADD TR-NP-CASH-DEP-AMT TO WMS-CASH-DEPOSITS
414250                               WMS-MTD-CASH-DEPOSITS.
414300     IF WBC-EXC-CODE (12) EQUAL TO '1'                            0266741
414350         IF TR-NP-NON-PAR-AMT GREATER THAN ZERO
414400             MOVE '04' TO IMEX-REC-NO
414450             MOVE '12' TO IMEX-CODE-1
414500             MOVE TR-BATCH TO EX04-BATCH
414550             MOVE TR-NP-NON-PAR-NO TO EX04-SEQ
414600             MOVE TR-NP-NON-PAR-AMT TO EX04-NO, EX04-NEW-NO
414610             MOVE ZERO TO EX04-TRACE, IM-EXC-REF-NUM              0326947
414650             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
414700     GO TO Q4500.
414750     SKIP3
414800 MAINT-SECTION-A     SECTION 23.
414850     SKIP3
414900*    ******* FILE MAINTENANCE TRANSACTION PROCESSING  ******
414950     SKIP1
415000 K5000.
415050     IF  ACCT-NOT-FOUND EQUAL TO '1'                              0901904
415055         MOVE GL-CURRENT-COST-CTR TO SAV-GL-CURRENT-COST-CTR      0902970
415060         MOVE 'N' TO GL-BUILD-MASTER-SW                           0902970
415065         PERFORM K5700 THRU K5700-EXIT                            0902970
415070         PERFORM C1009 THRU C1009-EXIT                            0902970
415072         MOVE TR-KEY  TO  WK-GL-ORIG-ACCT                         0902970
415080         MOVE TRN-NOT-FND-COST-CTR TO GL-CURRENT-COST-CTR         0902970
415100         ADD +1 TO DDA-MAINT-REJ, WS-GL-DDA-MAINT-REJ             0902970
415150         MOVE TR-FILE-MAINT TO EX09-REMAINDER
415200         PERFORM K3130 THRU K3168                                 IM002
415207         PERFORM UNPOST-EXCEPT THRU WRITE-EX-EXIT                 IM002
415214         MOVE '0' TO EX-MST-CTL, UNPOST-TODAY                     IM002
415221         MOVE SPACES TO EX-INFO                                   IM002
415228         MOVE '1' TO TRAN-REWRITE-SW                              IM002
415235         GO  TO  K5500.                                           IM002
415250     MOVE TR-FM-FLD-START TO FLD-START.
415300     IF  WMS-STATUS EQUAL TO '99'                                 0901904
415350         IF  TR-FM-FLD-NO EQUAL TO '0008'                         0901904
415400             MOVE '0' TO ACCT-NOT-FOUND
415450             GO TO K5100
415500         ELSE
415550             MOVE '1' TO ACCT-NOT-FOUND
415560             GO TO K5000.                                         9915857
415570     IF  TR-FM-IBT-IND EQUAL 'IBT'                                9915857
415572         MOVE '15' TO IMEX-REC-NO                                 9915857
415574         MOVE 'IB' TO IMEX-CODE-1                                 9915857
415576         MOVE 'IT' TO IMEX-CODE-2                                 9915857
415578         MOVE TR-FILE-MAINT TO EX15-FM-TRAN                       9915857
415580         MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT         9915857
415582         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                 9915857
415605*****  IF FIELD FILE MAINT IS OUT OF FIXED PORTION, GO TO K5040 **0903291
415610     IF  FLD-START GREATER THAN WS-MSTR-MAINT-PORTION             0903291
415615         GO TO K5040.                                             0903291
415620     IF  TR-FM-FLD-NO EQUAL '0715'                                0901904
415625         IF  TR-FM-NEW-BYTE (1)  EQUAL '2'                        0901904
415630             IF  WMS-ARP-CODE EQUAL '0' OR '1' OR '2' OR '4' OR   1105504
415631                                    '5' OR '6' OR '8'             1105504
415635                 MOVE '039' TO REJRESN                            0717565
415637                 GO TO K5085.                                     0427139
415639     IF  TR-FM-FLD-NO EQUAL '0013'                                0427139
415640         IF  TR-FM-NEW-BYTE (1) NOT EQUAL '0'                     0427139
415641             IF  WMS-PASSBOOK-ACCT EQUAL '1'                      0427139
415642                 MOVE 'D1' TO IMEX-CODE-2                         0427139
415643                 MOVE '097' TO REJRESN                            0717565
415644                 GO TO K5085.                                     0427139
415645* ACCRUAL TYPE 'S' REQUIRED TO USE SPLIT RATE ACCRUALS            0902509
415646     IF  TR-FM-FLD-NO EQUAL '1099'                                0902509
415647         IF TR-FM-NEW-BYTE (1) EQUAL 'S'                          0902509
415648             IF  WMS-IOD-ACCRUAL-TYPE NOT EQUAL 'S'               0902509
415649                 MOVE '057' TO REJRESN                            0717565
415650                 GO TO K5085.                                     0902509
415651     IF  TR-FM-FLD-NO EQUAL '1433'                                9715504
415652         IF  WMS-NB-SS-RT-IND EQUAL '4' OR '5' OR '6'             9715504
415653             IF  TR-FM-REQ-BY EQUAL 'SC.'                         9916269
415654                 NEXT SENTENCE                                    9715504
415655             ELSE                                                 9715504
415656                 MOVE '038' TO REJRESN                            0717565
415657                 GO TO K5085.                                     9715504
415658     IF  TR-FM-FLD-NO EQUAL '0562'                                IM005
415660         IF  WMS-SAVINGS-TRLR EQUAL '1'                           2012254
415662         AND (WMS-XINV-LINK-IND EQUAL ' ' OR 'D')                 2016639
415664             IF  TR-FM-NEW-AMT GREATER THAN WMS-DDA-MAX-BAL       2012254
415666                 MOVE '023' TO REJRESN                            0717565
415668                 GO TO K5085                                      2012254
415670             ELSE                                                 2012254
415672                 IF  WMS-INVESTMENT-TRLR EQUAL '1'                2012254
415674                     MOVE '038' TO REJRESN                        0717565
415676                     GO TO K5085.                                 2012254
415678     IF  TR-FM-FLD-NO EQUAL TO '1987'                             2012254
415680         MOVE '1' TO FM-TO-FED-TAX-PTR.                           2012254
415682     IF  TR-FM-FLD-NO EQUAL TO '1988'                             2012254
415684         MOVE '1' TO FM-TO-ST-TAX-PTR.                            2012254
415686     IF  TR-FM-FLD-NO EQUAL TO '1989'                             2012254
415688         MOVE '1' TO FM-TO-LOC-TAX-PTR.                           2012254
415691     IF  TR-FM-FLD-NO EQUAL '0022'                                0627531
415692         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        0627531
415693             IF  UB-OPTION-FLAG (21) NOT EQUAL 'Y'                0627531
415694                 MOVE '038' TO REJRESN                            0717565
415695                 GO TO K5085.                                     0627531
415696*                                                                 9915749
415697*--------------------------------------------------------------*  9915749
415698*   UNCOMMENT FOLLOWING CODE IF USING VECTOR SEGMENT CODE OR   *  9915749
415699*   NEXT VECTOR SEGMENT CODE.  CHANGE EDITS TO FIT YOUR NEEDS. *  9915749
415700*--------------------------------------------------------------*  9915749
415701*                                                                 9915749
415702*    IF  TR-FM-FLD-NO EQUAL '1397' OR '1426'                      9915749
415703*        IF  WMS-NEXT-STMT-PULL EQUAL SPACES                      9915749
415704*            IF  (TR-FM-NEW-STATUS GREATER THAN '18')             9915749
415705*            AND (TR-FM-NEW-STATUS LESS THAN '71')                9915749
415706*                IF  (WMS-TIS-CONSUMER-FLAG EQUAL 'N')            9915749
415707*                AND (WMS-STMT-PULL EQUAL 'E')                    9915749
415708*                    GO TO K5010                                  9915749
415709*                ELSE                                             9915749
415710*                    MOVE '065'  TO REJRESN                       0717565
415711*                    MOVE 'COMMERCIAL RANGE IS 19-70'             9915749
415712*                                TO EX09-GEN-DESC                 9915749
415713*                    GO TO K5085                                  9915749
415714*            ELSE                                                 9915749
415715*                NEXT SENTENCE                                    9915749
415716*        ELSE                                                     9915749
415717*            IF  (TR-FM-NEW-STATUS GREATER THAN '18')             9915749
415718*            AND (TR-FM-NEW-STATUS LESS THAN '71')                9915749
415719*                IF  (WMS-TIS-CONSUMER-FLAG EQUAL 'N')            9915749
415720*                AND (WMS-NEXT-STMT-PULL EQUAL 'E')               9915749
415721*                    GO TO K5010                                  9915749
415722*                ELSE                                             9915749
415723*                    MOVE '065'  TO REJRESN                       0717565
415724*                    MOVE 'COMMERCIAL RANGE IS 19-70'             9915749
415725*                                TO EX09-GEN-DESC                 9915749
415726*                    GO TO K5085.                                 9915749
415727*                                                                 9915749
415728*    IF  TR-FM-FLD-NO EQUAL '1397' OR '1426'                      9915749
415729*        IF  (TR-FM-NEW-STATUS GREATER THAN '70')                 9915749
415730*        AND (TR-FM-NEW-STATUS LESS THAN '97')                    9915749
415731*            IF  (WMS-TIS-CONSUMER-FLAG EQUAL 'N')                9915749
415732*            AND (WMS-ARP-CODE NOT EQUAL '0')                     9915749
415733*                GO TO K5010                                      9915749
415734*            ELSE                                                 9915749
415735*                MOVE '065'      TO REJRESN                       0717565
415736*                MOVE 'ARP ACCT. RANGE IS 71-96 '                 9915749
415737*                                TO EX09-GEN-DESC                 9915749
415738*                GO TO K5085.                                     9915749
415739*                                                                 9915749
415740     IF  TR-FM-FLD-NO EQUAL '0568'                                1105504
415750         IF  WMS-CLUB-ACCT-CONTROL EQUAL '0'                      0901904
415800             MOVE '2' TO WMS-CLUB-ACCT-CONTROL
415850         ELSE
415900             ADD +1 TO WMS-CLUB-TIMES-CHANGED
415910             MOVE WMS-CLUB-CURRENT-TYPE TO WMS-CLUB-LAST-TYPE.    0930013
415911     IF TR-FM-FLD-NO EQUAL '2031'                                 0930013
415912        IF TR-FM-NEW-DATA(01:08) NOT EQUAL SPACES                 0930013
415913           MOVE TR-FM-NEW-DATA(01:02)  TO SV-OP8-CENT             0930013
415914           MOVE TR-FM-NEW-DATA(03:02)  TO SV-OP8-YR               0930013
415915           MOVE TR-FM-NEW-DATA(05:02)  TO SV-OP8-MO               0930013
415916           MOVE TR-FM-NEW-DATA(07:02)  TO SV-OP8-DA               0930013
415917           IF WMS-NB-SS-RT-STOP-DT NOT EQUAL SPACES               0930013
415918              IF SAVE-OPEN-8 GREATER THAN WMS-NB-SS-RT-STOP-DT    0930013
415919                 MOVE '101' TO REJRESN                            0930013
415920                 GO TO K5085.                                     0930013
415921     IF TR-FM-FLD-NO EQUAL '2028'                                 0930013
415922        IF TR-FM-NEW-DATA(01:08) NOT EQUAL SPACES AND '99999999'  0930013
415923           MOVE TR-FM-NEW-DATA(01:02)  TO SV-OP8-CENT             0930013
415924           MOVE TR-FM-NEW-DATA(03:02)  TO SV-OP8-YR               0930013
415925           MOVE TR-FM-NEW-DATA(05:02)  TO SV-OP8-MO               0930013
415926           MOVE TR-FM-NEW-DATA(07:02)  TO SV-OP8-DA               0930013
415927           IF SAVE-OPEN-8 LESS THAN WMS-NB-SS-RT-START-DT         0930013
415928              MOVE '101' TO REJRESN                               0930013
415929              GO TO K5085.                                        0930013
415930*                                                                 0930013
415931* FLD2357 MAINTENANCE TO REG E OPT CODE UPDATES                   1020116
415932*         REG E OPT DATE USING THE BCR CAPTURE DATES              1020116
415933*                                                                 1020116
415934     IF  TR-FM-FLD-NO EQUAL '2357'                                1020116
415935         ADD +1                   TO WMS-OD-REGE-OPT-YTD          1020116
415936         MOVE WBC-CAPTURE-YR      TO WMS-OD-REGE-OPT-YR           1020116
415937         MOVE WBC-CAPTURE-MO      TO WMS-OD-REGE-OPT-MO           1020116
415938         MOVE WBC-CAPTURE-DA      TO WMS-OD-REGE-OPT-DA           1020116
415939         IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR            1020116
415940             MOVE '20'               TO WMS-OD-REGE-OPT-CENT      1020116
415941         ELSE                                                     1020116
415942             MOVE '19'               TO WMS-OD-REGE-OPT-CENT.     1020116
415949                                                                  1020116
415951     IF  TR-FM-FLD-NO EQUAL '2044'                                0417066
415952     AND TR-FM-NEW-DATE NUMERIC                                   0417066
415953         IF  WMS-BRT-TERM-OPT EQUAL '0'                           0417066
415954             MOVE '038' TO REJRESN                                0717565
415955             GO TO K5085.                                         0417066
415956     IF  TR-FM-FLD-NO EQUAL '0010'                                IM006
415962         IF  TR-FM-NEW-COMP EQUAL +0                              IM006
415968             MOVE '0' TO LG-ITEM-FLAG                             IM006
415974             MOVE +0.00 TO HOLD-LG-ITEM                           IM006
415980         ELSE                                                     IM006
415986             MOVE '1' TO LG-ITEM-FLAG                             IM006
415992             MOVE WBC-LRG-ITEM (TR-FM-NEW-COMP) TO HOLD-LG-ITEM.  0266741
415993     IF  TR-FM-FLD-NO EQUAL '0101' OR '0102' OR '0693' OR '0694'  9915849
415994         OR '0695'                                                9915849
415995***      PERFORM K5560 THRU K5560-EXIT                            9916151
415996         IF  TX-ERR-CODE EQUAL 'N'                                9915849
415997             MOVE '055' TO REJRESN                                0717565
415998             GO TO K5085.                                         9915849
415999***LINE #415995 TEMP COMMENTED PER- SOLVE#146985/R-SEC#IM6151**   9916151
416000     IF  TR-CLASS EQUAL '95'                                      IM007
416007     AND TR-FM-FLD-NO EQUAL '0693'                                IM007
416012         IF  TR-FM-NEW-BYTE (1) GREATER THAN ZERO                 0727628
416014         AND TR-FM-REQ-BY EQUAL 'HX.'                             0727628
416015             NEXT SENTENCE                                        0266928
416016         ELSE                                                     0266928
416017             MOVE  TR-FM-NEW-BYTE (1) TO SAV-BKUP-WTHLD-FLAG.     0266928
416018     IF  TR-FM-FLD-NO NOT EQUAL '0096'                            0266928
416019     OR  WMS-SAVINGS-TRLR NOT EQUAL '1'                           0266928
416020             GO TO K5000A.                                        0266928
416021     MOVE TR-FM-NEW-DATE         TO SAVE-OPEN-6.                  0266928
416022     MOVE SV-OP6-YR              TO SV-OP8-YR.                    0266928
416023     MOVE SV-OP6-DA              TO SV-OP8-DA.                    0266928
416024     MOVE SV-OP6-MO              TO SV-OP8-MO.                    0266928
416025     IF  SV-OP6-YR LESS THAN WBC-NEXT-CENT-YR                     0266928
416026     AND (SV-OP6-YR LESS THAN OR EQUAL WBC-CAPTURE-YR)            0266928
416027         MOVE '20'               TO SV-OP8-CENT                   0266928
416028     ELSE                                                         0266928
416029         MOVE '19'               TO SV-OP8-CENT.                  0266928
416030     MOVE '41'                   TO SICOMPDT-DATE-FORMATS.        0266928
416031     MOVE '0' TO WK-FLAG                                          0266928
416032     CALL 'SICOMPDT' USING SAVE-OPEN-8                            0266928
416033                           WMS-INT-DATE-OPENED                    0266928
416034                           WK-FLAG                                0266928
416035                           SICOMPDT-DATE-FORMATS.                 0266928
416036     IF  WK-FLAG EQUAL 'H'                                        0266928
416037         MOVE '038' TO REJRESN                                    0717565
416038         GO TO K5085.                                             0266928
416039 K5000A.                                                          0266928
416040     IF  TR-FM-FLD-NO EQUAL '0009' OR '0080'                      9915855
416042         IF  WMS-OD-LIMIT-FILE EQUAL '1'                          9915855
416044             MOVE '091' TO REJRESN                                0717565
416046             GO TO K5085.                                         9915855
416048     IF  TR-FM-FLD-NO EQUAL '1097'                                2016148
416049         IF  TR-FM-NEW-BYTE (1)  EQUAL '1' OR '2' OR '3'          0437111
416050             IF  WMS-NB-DC-REGD-PRD-CNV EQUAL '1'                 2016148
416051                 MOVE '039' TO REJRESN                            0717565
416052                 GO TO K5085                                      2016639
416053             ELSE                                                 2016639
416054             IF  WMS-XINV-LINK-IND EQUAL 'L' OR 'P'               2016639
416055                 MOVE '038' TO REJRESN                            0717565
416056                 GO TO K5085.                                     2016639
416057     IF  TR-FM-FLD-NO EQUAL '1374'                                2016639
416058         IF  TR-FM-NEW-BYTE (1)  EQUAL '1'                        2016639
416059             IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3'       0437111
416060                 MOVE '039' TO REJRESN                            0717565
416061                 GO TO K5085.                                     2016639
416062     IF  TR-FM-FLD-NO EQUAL '1378'                                2016639
416063         IF  TR-FM-NEW-DATE GREATER THAN SPACES                   2016639
416064             IF  WMS-NB-DC-REGD-PRD-CNV NOT EQUAL '1'             2016639
416065                 MOVE '1' TO WMS-NB-DC-REGD-PRD-CNV.              2016639
416066     IF  TR-FM-FLD-NO EQUAL '0209'                                0427053
416068         IF  TR-FM-NEW-BYTE (1)  GREATER THAN '0'                 0427053
416070             IF  WMS-EXT-SC-DATA-TRLR EQUAL '0'                   0427053
416072                 MOVE '038' TO REJRESN                            0717565
416074                 GO TO K5085.                                     0427053
416076     IF  TR-FM-FLD-NO EQUAL '0156'                                0627532
416078         IF  TR-FM-NEW-BYTE (1) EQUAL '8'                         0627532
416080             IF  WMS-LOAN-TRLR EQUAL '0'                          0627532
416082                 MOVE '038' TO REJRESN                            0717565
416084                 GO TO K5085.                                     0627532
416090*                                                                 2016639
416092     COPY IMPD31XM.                                               2016639
416094*                                                                 2016639
416100* FLD1091 FUNDING FLAG                                            0437111
416101     IF  TR-FM-FLD-NO  EQUAL '1091'                               0437111
416102         IF (TR-FM-NEW-BYTE (1)  EQUAL 'P')                       0437111
416103         AND (WMS-MMDA-INDICATOR EQUAL '3')                       0437111
416104             MOVE '038' TO REJRESN                                0717565
416105             GO TO K5085.                                         0437111
416106* FLD1097 MMDA/SAVINGS IND                                        0437111
416107     IF  TR-FM-FLD-NO NOT EQUAL '1097'                            0437111
416108         GO TO K500B-00.                                          0437111
416109     IF (TR-FM-NEW-BYTE (1)  EQUAL '3')                           0437111
416110     AND ((WMS-FUNDING-FLAG EQUAL 'P') OR                         0437111
416111          (WMS-TARGET-AMT-TRLR EQUAL '1') OR                      0437111
416112          (WMS-LIMIT-TRANSFER EQUAL '1'))                         0437111
416113         MOVE '099' TO REJRESN                                    0717565
416114         GO TO K5085.                                             0437111
416115     IF (TR-FM-NEW-BYTE (1)  EQUAL '2' OR '3')                    0437111
416116     AND ((WMS-PASSBOOK-ACCT EQUAL '1') OR                        0437111
416117          (WMS-SAVINGS-TRLR EQUAL '1')  OR                        0437111
416118          (WMS-LOAN-TRLR EQUAL '1')     OR                        0437111
416119          (WMS-MMDA-INDICATOR EQUAL '0' OR '1'))                  0437111
416120         MOVE '099' TO REJRESN                                    0717565
416121         GO TO K5085.                                             0437111
416122     IF (TR-FM-NEW-BYTE (1)  NOT EQUAL '1' AND '2')               0437111
416123         GO TO K500B-99.                                          0437111
416124     IF  WMS-SC-CYCLE NOT EQUAL '0'                               0437111
416125         IF WMS-SC-INCR NOT EQUAL '1'                             0437111
416126             MOVE '098' TO REJRESN                                0717565
416127             GO TO K5085                                          0437111
416128         ELSE                                                     0437111
416129             GO TO K500B-99.                                      0437111
416130     GO TO K500B-60.                                              0437111
416131                                                                  0437111
416132 K500B-00.                                                        0437111
416133     IF (WMS-MMDA-INDICATOR  NOT EQUAL '1' AND '2')               0437111
416134         GO TO K500B-99.                                          0437111
416135     IF  WMS-SC-CYCLE NOT EQUAL '0'                               0437111
416136         GO TO K500B-40.                                          0437111
416137* FLD0112 SCH PULL CODE FLD0113 SCH SUPP CODE FLD0570 CYCLE       0437111
416138*  SAVED IN NEW-BYTE 32-35 FOR CROSS EDIT                         0437111
416139     IF  TR-FM-FLD-NO NOT EQUAL '0112' AND '0113' AND '0570'      0437111
416140         GO TO K500B-20.                                          0437111
416141     IF  TR-FM-NEW-BYTE (32) EQUAL 'G'                            0437111
416142         MOVE TR-FM-NEW-BYTE (34) TO BYTE-1                       0437111
416143         MOVE TR-FM-NEW-BYTE (35) TO BYTE-2                       0437111
416144         IF  BYTE-1-2 EQUAL                                       0437111
416145         WBC-IRR-STMT-CYCLE (1) OR WBC-IRR-STMT-CYCLE (2) OR      0437111
416146         WBC-IRR-STMT-CYCLE (3) OR WBC-IRR-STMT-CYCLE (4) OR      0437111
416147         WBC-IRR-STMT-CYCLE (5) OR WBC-IRR-STMT-CYCLE (6) OR      0437111
416148         WBC-IRR-STMT-CYCLE (7) OR WBC-IRR-STMT-CYCLE (8) OR      0437111
416149         WBC-IRR-STMT-CYCLE (9) OR WBC-IRR-STMT-CYCLE (10)        0437111
416150             MOVE '098' TO REJRESN                                0717565
416151             GO TO K5085.                                         0437111
416152     IF  TR-FM-NEW-BYTE (32) EQUAL                                0437111
416153                            'G' OR 'B' OR 'D' OR 'E' OR 'F'       0437111
416154         IF  TR-FM-NEW-BYTE (33) EQUAL '0' OR '2'                 0437111
416155             GO K500B-99.                                         0437111
416157     IF  TR-FM-NEW-BYTE (32) EQUAL 'Y'                            0917834
416158         GO K500B-99.                                             0917834
416159     MOVE '098' TO REJRESN.                                       0917834
416160     GO TO K5085.                                                 0917834
416164 K500B-20.                                                        0437111
416165* FLD0961 NEXT STMT PULL FLD0962 NEXT STMT SUPP FLD0963 CYCLE     0437111
416166*  SAVED IN NEW-BYTE 32-35 FOR CROSS EDIT                         0437111
416167     IF  TR-FM-FLD-NO NOT EQUAL '0961' AND '0962' AND '0963'      0437111
416168         GO TO K500B-40.                                          0437111
416169     IF  TR-FM-NEW-BYTE (32) EQUAL 'G'                            0437111
416170         MOVE TR-FM-NEW-BYTE (34) TO BYTE-1                       0437111
416171         MOVE TR-FM-NEW-BYTE (35) TO BYTE-2                       0437111
416172         IF  BYTE-1-2 EQUAL                                       0437111
416173         WBC-IRR-STMT-CYCLE (1) OR WBC-IRR-STMT-CYCLE (2) OR      0437111
416174         WBC-IRR-STMT-CYCLE (3) OR WBC-IRR-STMT-CYCLE (4) OR      0437111
416175         WBC-IRR-STMT-CYCLE (5) OR WBC-IRR-STMT-CYCLE (6) OR      0437111
416176         WBC-IRR-STMT-CYCLE (7) OR WBC-IRR-STMT-CYCLE (8) OR      0437111
416177         WBC-IRR-STMT-CYCLE (9) OR WBC-IRR-STMT-CYCLE (10)        0437111
416178             MOVE '098' TO REJRESN                                0717565
416179             GO TO K5085.                                         0437111
416180     IF  TR-FM-NEW-BYTE (32) EQUAL                                0437111
416181                      ' ' OR 'G' OR 'B' OR 'D' OR 'E' OR 'F'      0437111
416182         IF  TR-FM-NEW-BYTE (33) EQUAL ' ' OR '0' OR '2'          0437111
416183             GO K500B-99.                                         0437111
416184     IF  TR-FM-NEW-BYTE (32) EQUAL 'Y'                            0917834
416185         GO TO K500B-99.                                          0917834
416186     MOVE '098' TO REJRESN.                                       0917834
416187     GO TO K5085.                                                 0917834
416193 K500B-40.                                                        0437111
416194* FLD0149 SEV CHG FREQ-INCR                                       0437111
416195     IF  TR-FM-FLD-NO NOT EQUAL '0149'                            0437111
416196         GO TO K500B-50.                                          0437111
416197     IF  WMS-SC-CYCLE NOT EQUAL '0'                               0437111
416198         IF  TR-FM-NEW-BYTE (1)  NOT EQUAL '1'                    0437111
416199             MOVE '098' TO REJRESN                                0717565
416200             GO TO K5085.                                         0437111
416201     GO TO K500B-99.                                              0437111
416202 K500B-50.                                                        0437111
416203* FLD0148 CYCLE                                                   0437111
416204     IF  TR-FM-FLD-NO NOT EQUAL '0148'                            0437111
416205         GO TO K500B-99.                                          0437111
416206     IF  TR-FM-NEW-BYTE (1)  NOT EQUAL '0'                        0437111
416207         IF WMS-SC-INCR NOT EQUAL '1'                             0437111
416208             MOVE '098' TO REJRESN                                0717565
416209             GO TO K5085                                          0437111
416210         ELSE                                                     0437111
416211             GO TO K500B-99.                                      0437111
416212 K500B-60.                                                        0437111
416213     IF  WMS-STMT-PULL EQUAL 'G'                                  0437111
416214         IF  WMS-STMT-FLD1 EQUAL                                  0437111
416215         WBC-IRR-STMT-CYCLE (1) OR WBC-IRR-STMT-CYCLE (2) OR      0437111
416216         WBC-IRR-STMT-CYCLE (3) OR WBC-IRR-STMT-CYCLE (4) OR      0437111
416217         WBC-IRR-STMT-CYCLE (5) OR WBC-IRR-STMT-CYCLE (6) OR      0437111
416218         WBC-IRR-STMT-CYCLE (7) OR WBC-IRR-STMT-CYCLE (8) OR      0437111
416219         WBC-IRR-STMT-CYCLE (9) OR WBC-IRR-STMT-CYCLE (10)        0437111
416220             MOVE '098' TO REJRESN                                0717565
416221             GO TO K5085.                                         0437111
416222     IF  WMS-NEXT-STMT-PULL EQUAL 'G'                             0437111
416223         IF  WMS-NEXT-STMT-CYCLE EQUAL                            0437111
416224         WBC-IRR-STMT-CYCLE (1) OR WBC-IRR-STMT-CYCLE (2) OR      0437111
416225         WBC-IRR-STMT-CYCLE (3) OR WBC-IRR-STMT-CYCLE (4) OR      0437111
416226         WBC-IRR-STMT-CYCLE (5) OR WBC-IRR-STMT-CYCLE (6) OR      0437111
416227         WBC-IRR-STMT-CYCLE (7) OR WBC-IRR-STMT-CYCLE (8) OR      0437111
416228         WBC-IRR-STMT-CYCLE (9) OR WBC-IRR-STMT-CYCLE (10)        0437111
416229             MOVE '098' TO REJRESN                                0717565
416230             GO TO K5085.                                         0437111
416232     IF  WMS-STMT-PULL EQUAL 'G' OR 'B' OR 'D' OR 'E' OR 'F'      0437111
416233      IF  WMS-STMT-SUPP EQUAL '0' OR '2'                          0437111
416234       IF  WMS-NEXT-STMT-PULL EQUAL                               0437111
416235                      ' ' OR 'G' OR 'B' OR 'D' OR 'E' OR 'F'      0437111
416236        IF  WMS-NEXT-STMT-SUPP EQUAL ' ' OR '0' OR '2'            0437111
416237             GO TO K500B-99.                                      0437111
416244*----------------------------------------------------------------*0917834
416245*    VERIFY THE STATEMENT PERIOD FOR PULL CODE Y                 *0917834
416246*----------------------------------------------------------------*0917834
416247     IF  WMS-STMT-PULL EQUAL 'Y'                                  0917834
416248         MOVE 'N' TO WK-STMT-ERR                                  0917834
416252         PERFORM K500B-70 THRU K500B-70-EXIT                      0917834
416253         IF  WK-STMT-ERR EQUAL 'Y'                                0917834
416254             GO TO K500B-98.                                      0917834
416255     GO TO K500B-99.                                              0917834
416256 K500B-70.                                                        0917834
416257     MOVE +0 TO X.                                                0917834
416258     IF  WMS-STMT-SUPP EQUAL '5'                                  0917834
416259         GO TO K500B-70-EDIT2.                                    0917834
416260                                                                  0917834
416261 K500B-70-LOOP.                                                   0917834
416262     ADD +1 TO X.                                                 0917834
416263     IF  X GREATER THAN +12                                       0917834
416264         GO TO K500B-70-EXIT.                                     0917834
416265     IF  WMS-STMT-FLD (X) NUMERIC                                 0917834
416266     AND WMS-STMT-FLD (X) GREATER THAN ZERO                       0917834
416267         GO TO K500B-70-LOOP.                                     0917834
416268     MOVE 'Y' TO WK-STMT-ERR.                                     0917834
416269     GO TO K500B-70-EXIT.                                         0917834
416270                                                                  0917834
416271 K500B-70-EDIT2.                                                  0917834
416272     ADD +1 TO X.                                                 0917834
416273     IF  X GREATER THAN +12                                       0917834
416274         GO TO K500B-70-EXIT.                                     0917834
416275     IF  WMS-STMTS-EACH-MO (X) GREATER THAN ZERO                  0917834
416276         GO TO K500B-70-EDIT2.                                    0917834
416277     IF  X EQUAL +1                                               0917834
416278     OR  X EQUAL +12                                              0917834
416279         MOVE 'Y' TO WK-STMT-ERR                                  0917834
416280         GO TO K500B-70-EXIT.                                     0917834
416281     SUBTRACT +1 FROM X.                                          0917834
416282     MOVE X TO Y.                                                 0917834
416283     ADD +2 TO Y.                                                 0917834
416284     MOVE ZERO TO DT-L-YR9                                        0917834
416285                  DT-H-YR9.                                       0917834
416286     MOVE X TO DT-L-MO9.                                          0917834
416287     MOVE Y TO DT-H-MO9.                                          0917834
416288     IF  WMS-STMTS-EACH-MO (Y) EQUAL ZERO                         0917834
416289         MOVE 'Y' TO WK-STMT-ERR                                  0917834
416290         GO TO K500B-70-EXIT.                                     0917834
416291     MOVE WMS-STMT-FLD (X) TO DT-L-DA9.                           0917834
416292     IF  WMS-STMTS-EACH-MO (X) GREATER THAN +1                    0917834
416293         ADD WMS-STMT-BUMP-DAYS TO DT-L-DA9.                      0917834
416294     MOVE WMS-STMT-FLD (Y) TO DT-H-DA9.                           0917834
416295     CALL 'SIDIF1'  USING DATE-AREA.                              0917834
416296     IF  RET-DAYS GREATER THAN +32                                0917834
416297         MOVE 'Y' TO WK-STMT-ERR                                  0917834
416298         GO TO K500B-70-EXIT.                                     0917834
416299     ADD +1 TO X.                                                 0917834
416300     GO TO K500B-70-EDIT2.                                        0917834
416301                                                                  0917834
416302 K500B-70-EXIT.                                                   0917834
416303     EXIT.                                                        0917834
416304 K500B-98.                                                        0917834
416305     MOVE '098' TO REJRESN.                                       0917834
416306     GO TO K5085.                                                 0917834
416307 K500B-99.                                                        0917834
416308     IF  TR-FM-FLD-NO NOT EQUAL '0660' AND '0689'                 0917834
416309         GO TO K5010.                                             0917834
416310     IF  TR-CLASS EQUAL '95'                                      0917834
416311         MOVE '038' TO REJRESN                                    0917834
416312         GO TO K5085.                                             0917834
416313*--------------------------------------------------------------*  ~~~0179
416314* IF MAINTENANCE HAS BEEN DONE TO FIELD NUMBERS 0660/0689 TODAY*  ~~~0179
416315* TO CHANGE EITHER TO A NON-ZERO VALUE, DO NOT ALLOW ANOTHER   *  ~~~0179
416316* MAINTENANCE TO THE SAME FIELD.                               *  ~~~0179
416317*--------------------------------------------------------------*  ~~~0179
416318     IF  TR-FM-FLD-NO EQUAL '0660'                                ~~~0179
416319     AND WS-MAINT-ON-0660-TDY EQUAL 'Y'                           ~~~0179
416320         MOVE '093' TO REJRESN                                    ~~~0179
416321         GO TO K5085.                                             ~~~0179
416322     IF  TR-FM-FLD-NO EQUAL '0689'                                ~~~0179
416323     AND WS-MAINT-ON-0689-TDY EQUAL 'Y'                           ~~~0179
416324         MOVE '093' TO REJRESN                                    ~~~0179
416325         GO TO K5085.                                             ~~~0179
416326     IF  TR-FM-FLD-NO EQUAL '0660'                                ~~~0179
416327     AND TR-FM-NEW-COMP-3 GREATER THAN ZERO                       ~~~0179
416328         MOVE 'Y' TO WS-MAINT-ON-0660-TDY.                        ~~~0179
416329     IF  TR-FM-FLD-NO EQUAL '0689'                                ~~~0179
416330     AND TR-FM-NEW-COMP-3 GREATER THAN ZERO                       ~~~0179
416331         MOVE 'Y' TO WS-MAINT-ON-0689-TDY.                        ~~~0179
416332     IF  TR-FM-FLD-NO EQUAL '0689', GO TO K5005.                  ~~~0179
416333     IF  WMS-HIFI-INDICATOR EQUAL +0                              ~~~0179
416350         IF  TR-FM-NEW-COMP-3 EQUAL +0                            1003625
416400         AND WMS-IOD-RATE-PTR NOT EQUAL ZERO
416420             PERFORM K5008 THRU K5008-EXIT                        IM007
416450             MOVE +0 TO WMS-IOD-PROJ-ACCR
416500             MOVE 'N' TO IOD-FLAG  IOD-CLOSE-FLAG
416550             PERFORM R3835 THRU R3864
416600             MOVE 'F' TO IOD-CLOSE-FLAG
416650             ADD +1 TO IOD-TRANSFER-FROM-NO,                      0902970
416651                       WS-GL-IOD-TRANSFER-FROM-NO                 0902970
416700             ADD WMS-DDA-BAL TO IOD-TRANSFER-FROM-AMT,            0902970
416701                                WS-GL-IOD-TRANSFER-FROM-AMT       0902970
416750             SUBTRACT TRANSFER-AMT FROM IOD-TRANSFER-FROM-AMT,    0902970
416751             SUBTRACT TRANSFER-AMT FROM                           0902970
416752                                   WS-GL-IOD-TRANSFER-FROM-AMT.   0902970
416800     IF  WMS-HIFI-INDICATOR EQUAL +0
416850         IF  TR-FM-NEW-COMP-3 NOT EQUAL +0                        1003625
416900         AND WMS-IOD-RATE-PTR EQUAL ZERO                          1003625
416950             MOVE '1' TO IOD-CALC-DALY
417000             ADD +1 TO IOD-TRANSFER-TO-NO,                        0902970
417001                       WS-GL-IOD-TRANSFER-TO-NO                   0902970
417050             ADD WMS-DDA-BAL TO IOD-TRANSFER-TO-AMT
417051                                WS-GL-IOD-TRANSFER-TO-AMT         0902970
417100             SUBTRACT TRANSFER-AMT FROM IOD-TRANSFER-TO-AMT,      0902970
417101                                        WS-GL-IOD-TRANSFER-TO-AMT 9715519
417102             MOVE WBC-CAPTURE-DATE TO WK-OPEN-DATE                0266741
417103             PERFORM CHECK-366 THRU C366-EXIT                     9715519
417104             IF  WK-RETURN-FLG NOT EQUAL WMS-LEAP-YEAR-FLG        9715519
417105                 MOVE WK-RETURN-FLG TO WMS-LEAP-YEAR-FLG.         9715519
417110     MOVE '1' TO FM-TO-DDA-PTR.                                   1003625
417150     MOVE 'F' TO IOD-FLAG.
417200     GO TO K5010.
417250 K5005.
417300     IF  TR-FM-NEW-COMP-3 EQUAL +0                                1003625
417310     AND WMS-HIFI-INDICATOR NOT EQUAL +0                          IM007
417320         PERFORM K5008 THRU K5008-EXIT                            IM007
417400         MOVE 'N' TO IOD-FLAG, IOD-CLOSE-FLAG
417450         PERFORM R3835 THRU R3864
417500         MOVE 'F' TO IOD-CLOSE-FLAG
417550         IF  WMS-IOD-RATE-PTR EQUAL +0
417600             ADD +1 TO IOD-TRANSFER-FROM-NO,                      0902970
417601                       WS-GL-IOD-TRANSFER-FROM-NO                 0902970
417650             ADD WMS-DDA-BAL TO IOD-TRANSFER-FROM-AMT
417651                                WS-GL-IOD-TRANSFER-FROM-AMT       0902970
417700             MOVE +0 TO WMS-IOD-PROJ-ACCR
417750             SUBTRACT TRANSFER-AMT FROM IOD-TRANSFER-FROM-AMT,    0902970
417751             SUBTRACT TRANSFER-AMT FROM                           0902970
417752                                   WS-GL-IOD-TRANSFER-FROM-AMT.   0902970
417800     IF  TR-FM-NEW-COMP-3 NOT EQUAL +0                            1003625
417850     AND WMS-HIFI-INDICATOR EQUAL +0                              1003625
417900     AND WMS-IOD-RATE-PTR EQUAL +0                                1003625
417950         MOVE '1' TO IOD-CALC-DALY
418000         ADD +1 TO IOD-TRANSFER-TO-NO,                            0902970
418001                   WS-GL-IOD-TRANSFER-TO-NO                       0902970
418050         ADD WMS-DDA-BAL TO IOD-TRANSFER-TO-AMT,                  0902970
418051                            WS-GL-IOD-TRANSFER-TO-AMT             0902970
418100         SUBTRACT TRANSFER-AMT FROM IOD-TRANSFER-TO-AMT,          0902970
418101                                    WS-GL-IOD-TRANSFER-TO-AMT     9715519
418102         MOVE WBC-CAPTURE-DATE TO WK-OPEN-DATE                    0266741
418103         PERFORM CHECK-366 THRU C366-EXIT                         9715519
418104         IF  WK-RETURN-FLG NOT EQUAL WMS-LEAP-YEAR-FLG            9715519
418105             MOVE WK-RETURN-FLG TO WMS-LEAP-YEAR-FLG.             9715519
418110     MOVE '1' TO FM-TO-DDA-PTR.                                   1003625
418150     MOVE 'F' TO IOD-FLAG.
418155     GO TO K5010.                                                 IM007
418160 K5008.                                                           IM007
418162     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
418165     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN ZERO                    IM007
418169     AND WMS-IOD-PEND-TAX GREATER THAN ZERO                       IM007
418173         MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT                 IM007
418177         PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT      IM007
418181         MOVE ZERO TO WMS-IOD-PEND-TAX.                           IM007
418190 K5008-EXIT.                                                      IM007
418195     EXIT.                                                        IM007
418200 K5010.
418202     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
418204         GO TO K5011.                                             0617360
418206     IF  TR-FM-FLD-NO EQUAL TO '0013'                             0617360
418208         IF  TR-FM-NEW-BYTE (1) GREATER THAN '0'                  0617360
418210             MOVE '038' TO REJRESN                                0717565
418212             GO TO K5085.                                         0617360
418214     IF  TR-FM-FLD-NO EQUAL TO '0780'                             0617360
418216         IF  TR-FM-NEW-BYTE (1) GREATER THAN '0'                  0617360
418218             MOVE '038' TO REJRESN                                0717565
418220             GO TO K5085.                                         0617360
418222 K5011.                                                           0617360
418250     IF TR-FM-FLD-NO NOT EQUAL TO '0008', GO TO K5100.
418300     IF  TR-FM-NEW-STATUS EQUAL '00'                              1105504
418350     AND WMS-STATUS EQUAL '08'
418400         MOVE '0' TO WMS-SC-CLEAR                                 IM007
418407         IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                       IM007
418414             MOVE +1 TO X                                         IM007
418421             PERFORM C2250-LOOP THRU C2255-EXIT                   IM007
418428         ELSE                                                     IM007
418435             PERFORM C2255      THRU C2255-EXIT.                  IM007
418436*----------------------------------------------------------------*1105504
418437*    PAY ACCRUED INTEREST IF STATUS IS CHANGED TO CLOSING (03)   *9715504
418438*----------------------------------------------------------------*1105504
418439     IF  TR-FM-NEW-STATUS EQUAL TO '03'                           1105504
418440         MOVE 'N' TO IOD-FLAG                                     9715504
418441         PERFORM R3835 THRU R3864                                 9715504
418442         MOVE 'F' TO IOD-FLAG.                                    9715504
418450     IF  TR-FM-NEW-STATUS NOT EQUAL '04' AND '05' AND '08'        1105504
418500         GO TO K5100.
418550     IF WMS-CURR-BAL NOT EQUAL TO ZERO, GO TO K5020.
418600     IF WMS-IOD-CYC-ACC-INT NOT EQUAL ZERO GO TO K5020.
418610     IF  WMS-IOD-PEND-TAX NOT EQUAL ZERO                          IM007
418620         GO TO K5020.                                             IM007
418650     IF  TR-FM-NEW-STATUS EQUAL '05'                              1105504
418660         IF  WMS-LOAN-TRLR EQUAL TO '1'                           IM005
418670         OR  WMS-SAVINGS-TRLR EQUAL TO '1'                        IM005
418680         OR  WMS-OD-ACCRUAL-TRLR EQUAL TO '1'                     IM005
418685         OR  WMS-DUAL-YEAR-TRLR EQUAL TO '1'                      9915858
418690         OR  WMS-COMBINED-STAT NOT EQUAL ZERO                     IM005
418700             GO TO K5020.                                         IM005
418702     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
418704         GO TO K5012.                                             0617360
418706     IF  TR-FM-NEW-STATUS EQUAL '05'                              0617360
418708     AND WMS-PLN-TRLR-CTDT-NO GREATER THAN ZERO                   0617360
418710         MOVE '8' TO TR-FM-NEW-BYTE (2).                          0617360
418712         GO TO K5100.                                             0617360
418714 K5012.                                                           0617360
418850     IF  TR-FM-NEW-STATUS EQUAL '05'                              1105504
418900         IF WMS-IOD-YTD-INT-PAID NOT EQUAL ZERO
418910             MOVE '51' TO TR-FM-NEW-REASON                        IMIB004
418950             MOVE '8' TO TR-FM-NEW-BYTE (2).
419000     GO TO K5100.
419050 K5020.
419100     MOVE '016' TO REJRESN.                                       0717565
419150     GO TO K5085.
419152 K5040.                                                           9915845
419153     IF  FLD-START NOT LESS THAN WS-TRL-DATA-CNTR-STRT            0617360
419154         IF  WMS-DC-TRLR EQUAL TO '1'                             0617360
419155             GO TO K5100                                          0617360
419156         ELSE                                                     0617360
419157             GO TO K5080.                                         0617360
419158     IF  FLD-START NOT LESS THAN WS-TRL-PLAN-STRT                 0617360
419159         IF  WMS-PLAN-TRLR EQUAL TO '1'                           0617360
419160             GO TO K5043                                          0617360
419161         ELSE                                                     0617360
419162             GO TO K5080.                                         9915845
419164     IF  FLD-START NOT LESS THAN WS-TRL-DUAL-YR-STRT              9915858
419166         IF  WMS-DUAL-YEAR-TRLR EQUAL TO '1'                      9915858
419168             GO TO K5100                                          9915845
419170         ELSE                                                     9915845
419172             GO TO K5080.                                         9915845
419174     IF  FLD-START NOT LESS THAN WS-TRL-EXTR-SC-STRT              9915845
419176         IF  WMS-EXT-SC-DATA-TRLR EQUAL TO '1'                    9915845
419178             GO TO K5100                                          9915845
419180         ELSE                                                     9915845
419200             GO TO K5080.                                         9915845
419201     IF FLD-START NOT LESS THAN WS-TRL-INVEST-STRT                1004554
419202        IF  WMS-INVESTMENT-TRLR EQUAL TO '1'                      1004554
419203            GO TO K5100                                           1004554
419204        ELSE                                                      1004554
419205            GO TO K5080.                                          1004554
419206     IF FLD-START NOT LESS THAN WS-TRL-FND-AVAIL-STRT             1004554
419207         IF WMS-EFA-TRLR EQUAL TO '1'                             1004554
419208             GO TO K5100                                          1004554
419209         ELSE                                                     1004554
419210             GO TO K5080.                                         1004554
419211     IF FLD-START NOT LESS THAN WS-TRL-KITING-STRT                1004554
419216         IF WMS-KITING-SUSP-TRLR EQUAL TO '1'                     IM006
419224             GO TO K5100                                          IM006
419232         ELSE                                                     IM006
419240             GO TO K5080.                                         IM006
419250     IF FLD-START NOT LESS THAN WS-TRL-EXTR-DEP-STRT              0903291
419300         IF WMS-EXTRNL-DEPOSIT-TRLR EQUAL TO '1'
419350             GO TO K5100
419400         ELSE GO TO K5080.
419650     IF  FLD-START NOT LESS THAN WS-TRL-INFO-STRT                 0447287
419700         IF  WMS-INFO-TRLR EQUAL TO '0'                           0447287
419705             GO TO K5080.                                         0447287
419710     IF  FLD-START LESS THAN WS-TRL-INFO-STRT                     0447287
419715         GO TO K5041-OD-ACCR.                                     0447287
419720 K5041-INFO.                                                      0447287
419725*                                                                 0447287
419730     IF  WBC-REG-1042 NOT EQUAL '1'                               0447287
419735         GO TO K5100.                                             0447287
419737     IF  WMS-TIN-CERTIFICATION NOT EQUAL '8'                      0637629
419738         GO TO K5100.                                             0637629
419740*                                                                 0447287
419745     IF  WMS-SOC-SEC-NA EQUAL 1                                   0447287
419750         IF  WMS-SSN-COUNTRY EQUAL 'CA'                           0447287
419755             NEXT SENTENCE                                        0447287
419760         ELSE                                                     0447287
419765             GO TO K5100                                          0447287
419770     ELSE                                                         0447287
419775         IF  WMS-NME-ADDR-TLRS GREATER THAN 0                     0447287
419780         AND WMS-NA-COUNTRY EQUAL 'CA'                            0447287
419785             NEXT SENTENCE                                        0447287
419790         ELSE                                                     0447287
419795             GO TO K5100.                                         0447287
419800*                                                                 0447287
419802     IF  TR-FM-FLD-NO NOT EQUAL '1937'                            1020113
419803         GO TO K5100.                                             1020113
419805     IF  TR-FM-NEW-DATA (1:TR-FM-FLD-LENGTH) EQUAL                0447287
419810         'AB' OR 'BC' OR 'NL' OR 'MB' OR 'NB' OR 'NS' OR          0837825
419815         'NT' OR 'NU' OR 'ON' OR 'PE' OR 'QC' OR 'SK' OR 'YT'     0837825
419820         GO TO K5100.                                             0447287
419825*                                                                 0447287
419830     MOVE '055' TO REJRESN.                                       0717565
419835     GO TO K5085.                                                 0637629
419840*                                                                 0447287
419845 K5041-OD-ACCR.                                                   0447287
419850     IF FLD-START NOT LESS THAN WS-TRL-OD-ACRUAL-STRT             0903291
419900         IF WMS-OD-ACCRUAL-TRLR EQUAL TO '0'
419950             GO TO K5080.
420000     IF  FLD-START LESS THAN WS-TRL-OD-ACRUAL-STRT                0903291
420050         GO TO K5042.
420051**** CHECK OD INT RATE PTR FOR CHANGE   ***********************   9915845
420052     IF  TR-FM-FLD-NO EQUAL '0746'                                1003625
420054     OR  TR-FM-FLD-NO EQUAL '0748'                                1003625
420056     OR  TR-FM-FLD-NO EQUAL '0752'                                1003625
420058     OR  TR-FM-FLD-NO EQUAL '1129'                                9915845
420060     OR  TR-FM-FLD-NO EQUAL '1130'                                9915845
420062     OR  TR-FM-FLD-NO EQUAL '1131'                                9915845
420064     OR  TR-FM-FLD-NO EQUAL '1132'                                9915845
420066     OR  TR-FM-FLD-NO EQUAL '1133'                                9915845
420068     OR  TR-FM-FLD-NO EQUAL '1134'                                9915845
420070         MOVE '1' TO FM-TO-OD-PTR.                                9915845
420090**** CHECK OD ACCRUAL STATUS FLD-START  ***********************   0903291
420100     IF  FLD-START EQUAL WS-TRL-OD-ACRUAL-STATUS                  1003625
420150     AND TR-FM-NEW-BYTE (1) EQUAL '1'                             IM004
420190         IF  WMS-OD-CYC-ACR GREATER THAN ZERO                     IM004
420300             MOVE '4' TO OD-ACR-PAY-FLAG
420350             PERFORM R4012-A THRU R4013-EXIT
420360             GO TO K5100.                                         0930013
420361     IF TR-FM-FLD-NO EQUAL '2029'                                 0930013
420362        IF TR-FM-NEW-DATA(01:08) NOT EQUAL SPACES                 0930013
420363           MOVE TR-FM-NEW-DATA(01:02)  TO SV-OP8-CENT             0930013
420364           MOVE TR-FM-NEW-DATA(03:02)  TO SV-OP8-YR               0930013
420365           MOVE TR-FM-NEW-DATA(05:02)  TO SV-OP8-MO               0930013
420366           MOVE TR-FM-NEW-DATA(07:02)  TO SV-OP8-DA               0930013
420367           IF WMS-OD-PRIME-ADJ-STOP-DT NOT EQUAL SPACES           0930013
420368              IF SAVE-OPEN-8 GREATER THAN WMS-OD-PRIME-ADJ-STOP-DT0930013
420369                 MOVE '101' TO REJRESN                            0930013
420370                 GO TO K5085.                                     0930013
420371     IF TR-FM-FLD-NO EQUAL '2030'                                 0930013
420372        IF TR-FM-NEW-DATA(01:08) NOT EQUAL SPACES AND '99999999'  0930013
420373           MOVE TR-FM-NEW-DATA(01:02)  TO SV-OP8-CENT             0930013
420374           MOVE TR-FM-NEW-DATA(03:02)  TO SV-OP8-YR               0930013
420375           MOVE TR-FM-NEW-DATA(05:02)  TO SV-OP8-MO               0930013
420376           MOVE TR-FM-NEW-DATA(07:02)  TO SV-OP8-DA               0930013
420377           IF SAVE-OPEN-8 LESS THAN WMS-OD-PRIME-ADJ-START-DT     0930013
420378              MOVE '101' TO REJRESN                               0930013
420379              GO TO K5085.                                        0930013
420380*                                                                 0930013
420407     IF  FLD-START EQUAL WS-TRL-OD-ACRUAL-STATUS                  1003625
420414     AND TR-FM-NEW-BYTE (1) EQUAL '2'                             IM004
420421         IF  WMS-OD-YTD-CHGD GREATER THAN ZERO                    IM004
420428         OR  WMS-OD-CYC-ACR GREATER THAN ZERO                     IM004
420435             GO TO K5020.                                         IM004
420437     IF  TR-FM-FLD-NO EQUAL '0745'                                9915845
420439     AND WKOD-LIMIT-PTR1-FLAG EQUAL '0'                           9915845
420440         MOVE WMS-OD-LIMIT1 TO WKOD-LIMIT-PTR (1)                 9915845
420441         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (1)            9915845
420442         MOVE '1'           TO WKOD-LIMIT-PTR1-FLAG               9915845
420444         GO TO K5100.                                             9915845
420446     IF  TR-FM-FLD-NO EQUAL '0754'                                9915845
420448     AND WKOD-LIMIT-PTR2-FLAG EQUAL '0'                           9915845
420450         MOVE WMS-OD-LIMIT2 TO WKOD-LIMIT-PTR (2)                 9915845
420451         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (2)            9915845
420452         MOVE '1'           TO WKOD-LIMIT-PTR2-FLAG               9915845
420454         GO TO K5100.                                             9915845
420456     IF  TR-FM-FLD-NO EQUAL '1117'                                9915845
420458     AND WKOD-LIMIT-PTR3-FLAG EQUAL '0'                           9915845
420460         MOVE WMS-OD-LIMIT3 TO WKOD-LIMIT-PTR (3)                 9915845
420461         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (3)            9915845
420462         MOVE '1'           TO WKOD-LIMIT-PTR3-FLAG               9915845
420464         GO TO K5100.                                             9915845
420466     IF  TR-FM-FLD-NO EQUAL '1118'                                9915845
420468     AND WKOD-LIMIT-PTR4-FLAG EQUAL '0'                           9915845
420470         MOVE WMS-OD-LIMIT4 TO WKOD-LIMIT-PTR (4)                 9915845
420471         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (4)            9915845
420472         MOVE '1'           TO WKOD-LIMIT-PTR4-FLAG               9915845
420474         GO TO K5100.                                             9915845
420476     IF  TR-FM-FLD-NO EQUAL '1119'                                9915845
420478     AND WKOD-LIMIT-PTR5-FLAG EQUAL '0'                           9915845
420480         MOVE WMS-OD-LIMIT5 TO WKOD-LIMIT-PTR (5)                 9915845
420481         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (5)            9915845
420482         MOVE '1'           TO WKOD-LIMIT-PTR5-FLAG               9915845
420484         GO TO K5100.                                             9915845
420486     IF  TR-FM-FLD-NO EQUAL '1120'                                9915845
420488     AND WKOD-LIMIT-PTR6-FLAG EQUAL '0'                           9915845
420490         MOVE WMS-OD-LIMIT6 TO WKOD-LIMIT-PTR (6)                 9915845
420491         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (6)            9915845
420492         MOVE '1'           TO WKOD-LIMIT-PTR6-FLAG               9915845
420494         GO TO K5100.                                             9915845
420495     IF  TR-FM-FLD-NO EQUAL '1121'                                9915845
420498     AND WKOD-LIMIT-PTR7-FLAG EQUAL '0'                           9915845
420500         MOVE WMS-OD-LIMIT7 TO WKOD-LIMIT-PTR (7)                 9915845
420501         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (7)            9915845
420502         MOVE '1'           TO WKOD-LIMIT-PTR7-FLAG               9915845
420504         GO TO K5100.                                             9915845
420506     IF  TR-FM-FLD-NO EQUAL '1122'                                9915845
420508     AND WKOD-LIMIT-PTR8-FLAG EQUAL '0'                           9915845
420510         MOVE WMS-OD-LIMIT8 TO WKOD-LIMIT-PTR (8)                 9915845
420511         MOVE TRAN-2        TO WKOD-FM-POINTER-REC (8)            9915845
420512         MOVE '1'           TO WKOD-LIMIT-PTR8-FLAG               9915845
420514         GO TO K5100.                                             9915845
420516     IF  TR-FM-FLD-NO EQUAL '0750'                                9915845
420518     AND WKOD-LIMIT1-FLAG EQUAL '0'                               9915845
420520         MOVE WMS-OD-LIMIT-AMT1 TO WKOD-LIMIT (1)                 9915845
420521         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (1)          9915845
420522         MOVE '1'               TO WKOD-LIMIT1-FLAG               9915845
420524         GO TO K5100.                                             9915845
420526     IF  TR-FM-FLD-NO EQUAL '0755'                                9915845
420528     AND WKOD-LIMIT2-FLAG EQUAL '0'                               9915845
420530         MOVE WMS-OD-LIMIT-AMT2 TO WKOD-LIMIT (2)                 9915845
420531         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (2)          9915845
420532         MOVE '1'               TO WKOD-LIMIT2-FLAG               9915845
420534         GO TO K5100.                                             9915845
420536     IF  TR-FM-FLD-NO EQUAL '1123'                                9915845
420538     AND WKOD-LIMIT3-FLAG EQUAL '0'                               9915845
420540         MOVE WMS-OD-LIMIT-AMT3 TO WKOD-LIMIT (3)                 9915845
420541         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (3)          9915845
420542         MOVE '1'               TO WKOD-LIMIT3-FLAG               9915845
420544         GO TO K5100.                                             9915845
420546     IF  TR-FM-FLD-NO EQUAL '1124'                                9915845
420548     AND WKOD-LIMIT4-FLAG EQUAL '0'                               9915845
420550         MOVE WMS-OD-LIMIT-AMT4 TO WKOD-LIMIT (4)                 9915845
420551         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (4)          9915845
420552         MOVE '1'               TO WKOD-LIMIT4-FLAG               9915845
420554         GO TO K5100.                                             9915845
420556     IF  TR-FM-FLD-NO EQUAL '1125'                                9915845
420558     AND WKOD-LIMIT5-FLAG EQUAL '0'                               9915845
420560         MOVE WMS-OD-LIMIT-AMT5 TO WKOD-LIMIT (5)                 9915845
420561         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (5)          9915845
420562         MOVE '1'               TO WKOD-LIMIT5-FLAG               9915845
420564         GO TO K5100.                                             9915845
420566     IF  TR-FM-FLD-NO EQUAL '1126'                                9915845
420568     AND WKOD-LIMIT6-FLAG EQUAL '0'                               9915845
420570         MOVE WMS-OD-LIMIT-AMT6 TO WKOD-LIMIT (6)                 9915845
420571         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (6)          9915845
420572         MOVE '1'               TO WKOD-LIMIT6-FLAG               9915845
420574         GO TO K5100.                                             9915845
420576     IF  TR-FM-FLD-NO EQUAL '1127'                                9915845
420578     AND WKOD-LIMIT7-FLAG EQUAL '0'                               9915845
420580         MOVE WMS-OD-LIMIT-AMT7 TO WKOD-LIMIT (7)                 9915845
420581         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (7)          9915845
420582         MOVE '1'               TO WKOD-LIMIT7-FLAG               9915845
420584         GO TO K5100.                                             9915845
420586     IF  TR-FM-FLD-NO EQUAL '1128'                                9915845
420588     AND WKOD-LIMIT8-FLAG EQUAL '0'                               9915845
420590         MOVE WMS-OD-LIMIT-AMT8 TO WKOD-LIMIT (8)                 9915845
420591         MOVE TRAN-2            TO WKOD-FM-LIMIT-REC (8)          9915845
420592         MOVE '1'               TO WKOD-LIMIT8-FLAG               9915845
420594         GO TO K5100.                                             9915845
420596     GO TO K5100.                                                 9915845
420598 K5042.                                                           9915845
420600     IF FLD-START NOT LESS THAN WS-TRL-DEC-TAX-STRT               9915845
420610         IF WMS-DCD-TAX-DATA-TRLR EQUAL TO '0'                    9915845
420650             GO TO K5080.
420700     IF  FLD-START LESS THAN WS-TRL-DEC-TAX-STRT                  0903291
420750         GO TO K5044.
420790***** CHECK DEC TAX TRAILER STATUS MAINT  *********************   0903291
420800     IF  FLD-START EQUAL WS-TRL-DEC-TAX-STATUS                    1003625
420850     AND TR-FM-NEW-BYTE (1) EQUAL '1'                             IM007
420900         IF  WMS-DCD-YTD-INT-IOD  GREATER THAN ZERO
420950         OR  WMS-DCD-YTD-INT-SAV  GREATER THAN ZERO
421000         OR  WMS-DCD-YTD-INT-LOAN GREATER THAN ZERO
421050         OR  WMS-DCD-YTD-TAX-IOD  GREATER THAN ZERO
421100         OR  WMS-DCD-YTD-TAX-SAV  GREATER THAN ZERO
421150             GO TO K5020.                                         IM007
421200     GO TO K5100.
421202 K5043.                                                           0617360
421204     IF  TR-FM-FLD-NO EQUAL '2181'                                0617360
421206          IF  TR-FM-NEW-AMT9 NOT EQUAL ZERO                       0617360
421208          AND WMS-PLN-TRLR-PY-MAX-CNT-PNT NOT EQUAL ZERO          0617360
421210              MOVE '038' TO REJRESN                               0717565
421212              GO TO K5085.                                        0617360
421214     IF  TR-FM-FLD-NO EQUAL '2221'                                0617360
421216          IF  TR-FM-NEW-AMT9 NOT EQUAL ZERO                       0617360
421218          AND WMS-PLN-TRLR-MAX-CNT-PNT NOT EQUAL ZERO             0617360
421220              MOVE '038' TO REJRESN                               0717565
421222              GO TO K5085.                                        0617360
421224     IF  TR-FM-FLD-NO EQUAL '2219' OR '2209'                      0617360
421226         MOVE TR-FM-NEW-DATA (1:2) TO WK-BIN9                     0617360
421228         MOVE WK-BINX              TO TR-FM-NEW-DATA.             0617360
421230     GO TO K5100.                                                 0617360
421250 K5044.
421300     IF  FLD-START NOT LESS THAN WS-TRL-LMT-TRNFR-STRT            0903291
421350         IF WMS-LIMIT-TRANSFER EQUAL TO '1'
421400             GO TO K5100
421450         ELSE GO TO K5080.
421500     IF FLD-START NOT LESS THAN WS-TRL-TARGT-BAL-STRT             0903291
421550         IF WMS-TARGET-AMT-TRLR EQUAL TO '1'
421600             GO TO K5100
421650         ELSE GO TO K5080.
421700     IF FLD-START NOT LESS THAN WS-TRL-BNK-AVAIL-STRT             0903291
421705         GO TO K5070.                                             0902970
421750     IF FLD-START NOT LESS THAN WS-TRL-SAVINGS-STRT               0903291
421800         IF WMS-SAVINGS-TRLR EQUAL TO '0'
421850             GO TO K5080.
421900     IF FLD-START LESS THAN WS-TRL-SAVINGS-STRT                   0903291
421905         GO TO K5050.                                             1003625
421940     IF  TR-FM-FLD-NO EQUAL '0499'                                1003625
421945         MOVE '1' TO FM-TO-SAV-PTR.                               1003625
421947     IF  TR-FM-FLD-NO EQUAL '2039'                                0316967
421948         MOVE '1' TO FM-TO-SAV-TIER-PTR.                          0316967
421951     IF  TR-FM-FLD-NO EQUAL '0500'                                IM006
421952         IF  TR-FM-NEW-COMP GREATER THAN +0                       IM006
421953             MOVE WBC-TRAN-INCR (TR-FM-NEW-COMP) TO HOLD-SAV-INCR 0266741
421954         ELSE                                                     IM006
421955             MOVE +0 TO HOLD-SAV-INCR.                            IM006
421960     IF  TR-FM-FLD-NO EQUAL '0532'                                IM005
421970         IF  WMS-MIN-BAL GREATER THAN TR-FM-NEW-AMT               IM005
421980             MOVE '023' TO REJRESN                                0717565
421981             GO TO K5085                                          1004554
421982         ELSE                                                     1004554
421983             IF  WMS-INVESTMENT-TRLR EQUAL '1'                    1004554
421984                 MOVE '038' TO REJRESN                            0717565
421985                 GO TO K5085.                                     1004554
421986     IF  TR-FM-FLD-NO EQUAL '1177'                                1004554
421987         MOVE '038' TO REJRESN                                    0717565
421988         GO TO K5085.                                             1004554
421989     IF  TR-FM-FLD-NO EQUAL '0680'                                1020057
421990     AND TR-FM-NEW-BYTE (1) EQUAL '1'                             1020057
421991         IF  WMS-LOAN-TRLR EQUAL '1'                              1020057
421992             IF  WMS-CRED-CARD-IND EQUAL 'Y'                      1020057
421993                 MOVE '105' TO REJRESN                            1020057
421994                 GO TO K5085.                                     1020057
421995     IF  TR-FM-FLD-NO EQUAL '0680'                                1020057
421996     AND TR-FM-NEW-BYTE (1) EQUAL '1'                             1020057
421997         IF  SAV-BKUP-WTHLD-FLAG GREATER THAN ZERO                1020057
421998         AND WMS-SAV-PEND-TAX GREATER THAN ZERO                   1020057
421999             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             1020057
422000             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  1020057
422002             MOVE ZERO TO WMS-SAV-PEND-TAX.                       1020057
422004     IF  FLD-START EQUAL WS-TRL-SAVINGS-STRT                      1020057
422020     AND TR-FM-NEW-BYTE (1) EQUAL '8'                             IM007
422040         IF  SAV-BKUP-WTHLD-FLAG GREATER THAN ZERO                IM007
422060         AND WMS-SAV-PEND-TAX GREATER THAN ZERO                   IM007
422080             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
422100             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
422120             MOVE ZERO TO WMS-SAV-PEND-TAX.                       IM007
422122     IF  FLD-START EQUAL WS-TRL-SAVINGS-STRT                      9915845
422124     AND TR-FM-NEW-BYTE (1) EQUAL '8'                             9915845
422126         IF  SAVINGS-MINIMUM EQUAL '1'                            9915845
422128             ADD WMS-MIN-AMT-FOR-SUPER TO WMS-INT-CUR-BAL         9915845
422130                                      WMS-CURR-BAL                9915845
422132                                      CUR-BAL                     9915845
422134             MOVE '0' TO SAVINGS-MINIMUM, NSF-CALC-FLAG.          9915845
422140     IF  FLD-START EQUAL WS-TRL-SAVINGS-STRT                      0903291
422160     AND TR-FM-NEW-BYTE (1) EQUAL '8'                             IM007
422180         IF  WMS-INT-CUR-BAL GREATER THAN ZERO                    IM007
422200         OR  WMS-ACCR-INT GREATER THAN ZERO                       IM007
422220         OR  WMS-YTD-INT-PAID GREATER THAN ZERO                   IM007
422225         OR  (WMS-DUAL-YEAR-TRLR EQUAL '1'                        9915858
422230         AND WMS-DUAL-YR-CUR-SAV-INT GREATER THAN ZERO)           9915858
422240             MOVE 'N' TO IOD-CLOSE-FLAG                           IM007
422260             PERFORM R3835 THRU R3864                             IM007
422280             MOVE 'F' TO IOD-CLOSE-FLAG                           IM007
422300             ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL                   IM007
422320                                    TRANSFER-AMT                  IM007
422340             MOVE ZERO TO WMS-INT-CUR-BAL                         IM007
422360             MOVE '7' TO TR-FM-NEW-BYTE (1).                      IM007
422400     IF  TR-FM-FLD-NO NOT EQUAL '1318'                            0266928
422401             GO TO K5044A.                                        0266928
422402     MOVE WMS-OPENED-YR          TO SV-OP8-YR.                    0266928
422403     MOVE WMS-OPENED-DA          TO SV-OP8-DA.                    0266928
422404     MOVE WMS-OPENED-MO          TO SV-OP8-MO.                    0266928
422405     IF  WMS-OPENED-YR LESS THAN WBC-NEXT-CENT-YR                 0266928
422406     AND (WMS-OPENED-YR LESS THAN OR EQUAL WBC-CAPTURE-YR)        0266928
422407         MOVE '20'               TO SV-OP8-CENT                   0266928
422408     ELSE                                                         0266928
422409         MOVE '19'               TO SV-OP8-CENT.                  0266928
422410     MOVE '14'                   TO SICOMPDT-DATE-FORMATS.        0266928
422411     MOVE '0' TO WK-FLAG                                          0266928
422412     CALL 'SICOMPDT' USING TR-FM-NEW-DATE                         0266928
422413                           SAVE-OPEN-8                            0266928
422414                           WK-FLAG                                0266928
422415                           SICOMPDT-DATE-FORMATS.                 0266928
422416     IF  WK-FLAG EQUAL 'L'                                        0266928
422417         MOVE '038' TO REJRESN                                    0717565
422418         GO TO K5085.                                             0266928
422500 K5044A.                                                          0266928
422600     MOVE 'B8' TO IMEX-CODE-2.
422650     GO TO K5100.
422700 K5050.
422708     IF  FLD-START NOT LESS THAN WS-TRL-OD-NSF-STRT               0903291
422716         IF  WMS-OD-NSF-TRLR EQUAL '1'                            IM003
422724             GO TO K5100                                          IM003
422732         ELSE                                                     IM003
422740             GO TO K5080.                                         IM003
422750     IF FLD-START NOT LESS THAN WS-TRL-TRNS-AFFL-STRT GO TO K5070.0903291
422800     IF FLD-START NOT LESS THAN WS-TRL-MRKTNG-STRT                0903291
422850         IF WMS-MARKET-TRLR EQUAL TO '1'
422900             GO TO K5100
422950         ELSE GO TO K5080.
423000     IF FLD-START LESS THAN WS-TRL-LOAN-STRT                      0903291
423050         GO  TO  K5060.
423100     IF WMS-LOAN-TRLR EQUAL TO '0', GO TO K5080.
423102     MOVE SPACES TO REJRESN.                                      1020057
423104*----------------------------------------------------------------*1020057
423106*    PREVENT LOAN RATE INCREASES FOR CREDIT CARDS.               *1020057
423108*----------------------------------------------------------------*1020057
423110     IF  RATE-CHG-SW EQUAL '1'                                    1020057
423111       IF  NEW-LOAN-SW EQUAL '0'                                  1020057
423112         IF  TR-FM-FLD-NO EQUAL '0287' OR '0288' OR '0290' OR     1020057
423114                                '0352' OR '0355' OR '0358' OR     1020057
423116                                '0360' OR '0378' OR '0379' OR     1020057
423118                                '0380' OR '0668'                  1020057
423120             PERFORM CC-RATE-CHECK THRU CC-RATE-EXIT              1020057
423122             IF  REJRESN NOT EQUAL SPACES                         1020057
423124                 GO TO K5085.                                     1020057
423150     IF  TR-FM-FLD-NO EQUAL TO '0287'                             1003625
423200         IF  TR-FM-NEW-COMP-3 EQUAL +7                            1003625
423250         AND WMS-PRIME-BAL-CALC EQUAL '0'                         1003625
423300         AND WMS-PRM-CUR-BCL EQUAL '1'                            1003625
423350             MOVE '035' TO REJRESN                                0717565
423400             GO TO K5085.
423410*----------------------------------------------------------------*1105504
423412*    ALLOW MAINTENANCE TO FIELD PRINCIPAL (310) FOR AUTOBORROW.  *1105504
423414*----------------------------------------------------------------*1105504
423416     IF  TR-FM-FLD-NO EQUAL '0310'                                1105504
423418         IF  WMS-NB-DC-ABM NOT EQUAL '1'                          1105504
423420             MOVE '035' TO REJRESN                                0717565
423422             GO TO K5085.                                         1105504
423424     IF TR-FM-FLD-NO EQUAL '0341'                                 1010074
423426         IF TR-FM-NEW-BYTE (1) EQUAL '5'                          1010074
423428             IF  WMS-PYMT-CALC-CODE NOT EQUAL '0'                 1010074
423430                 MOVE '102' TO REJRESN                            1010074
423432                 GO TO K5085.                                     1010074
423434     IF TR-FM-FLD-NO EQUAL '0339'                                 1010074
423436         IF TR-FM-NEW-BYTE (1) NOT EQUAL '0'                      1010074
423438             IF  WMS-PYMT-SCHED-CODE EQUAL '5'                    1010074
423440                 MOVE '102' TO REJRESN                            1010074
423442                 GO TO K5085.                                     1010074
423450     IF TR-FM-FLD-NO EQUAL '0669'
423500         IF (WMS-INT-RATE-PTR EQUAL +6 OR +7) AND
423550          (TR-FM-NEW-BYTE (1) EQUAL '2' OR '3') AND
423600          (WMS-PYMT-CALC-CODE NOT EQUAL '0')
423650             MOVE '042' TO REJRESN                                0717565
423700             GO TO K5085.
423750     IF TR-FM-FLD-NO EQUAL TO '0669'
423800         IF TR-FM-NEW-BYTE (1) EQUAL '1' AND
423850          WMS-INT-RATE-PTR EQUAL +7
423900             MOVE '035' TO REJRESN                                0717565
423950             GO TO K5085.
424000     IF  TR-FM-FLD-NO EQUAL TO '0669'                             1003625
424050         IF  TR-FM-NEW-BYTE (1) EQUAL '0'                         1003625
424100         AND WMS-INT-RATE-PTR EQUAL +7                            1003625
424150         AND WMS-PRM-CUR-BCL EQUAL '1'                            1003625
424200             MOVE '035' TO REJRESN                                0717565
424250             GO TO K5085.                                         1003625
424300     IF TR-FM-FLD-NO EQUAL '0339'
424350         IF (WMS-INT-RATE-PTR EQUAL +6 OR +7) AND
424400         (PRIME-CALC-FLAG EQUAL '2' OR '3') AND
424450         (TR-FM-NEW-BYTE (1) NOT EQUAL '0')
424500             MOVE '042' TO REJRESN                                0717565
424550             GO TO K5085.
424600     IF  TR-FM-FLD-NO EQUAL '0669'                                1003625
424650         IF  (WMS-INT-RATE-PTR EQUAL +6 OR +7)                    1003625
424700         AND (TR-FM-NEW-BYTE (1) EQUAL '0')                       1003625
424750         AND (WMS-PRM-CUR-BCL EQUAL '2' OR '3')                   1003625
424800         AND (WMS-PYMT-CALC-CODE NOT EQUAL '0')                   1003625
424850             MOVE '042' TO REJRESN                                0717565
424900             GO TO K5085.
424950     IF  TR-FM-FLD-NO EQUAL TO '0287'                             1003625
425000         IF  TR-FM-NEW-COMP-3 EQUAL +7                            1003625
425050         AND WMS-PRIME-BAL-CALC EQUAL '1'                         1003625
425100             MOVE '035' TO REJRESN                                0717565
425150             GO TO K5085.
425350     IF  TR-FM-FLD-NO EQUAL TO '0287'                             1003625
425400         IF  TR-FM-NEW-COMP-3 EQUAL +6                            1003625
425450         AND WMS-PRIME-BAL-CALC EQUAL '0'                         1003625
425500         AND WMS-PRM-CUR-BCL EQUAL '2'                            1003625
425550             MOVE '035' TO REJRESN                                0717565
425600             GO TO K5085.
425650     IF  TR-FM-FLD-NO EQUAL TO '0287'                             1003625
425700         IF  TR-FM-NEW-COMP-3 EQUAL +6                            1003625
425750         AND WMS-PRIME-BAL-CALC EQUAL '2'                         1003625
425800             MOVE '035' TO REJRESN                                0717565
425850             GO TO K5085.
425900     IF TR-FM-FLD-NO EQUAL TO '0669'
425950         IF TR-FM-NEW-BYTE (1) EQUAL '2' AND
426000          WMS-INT-RATE-PTR EQUAL +6
426050             MOVE '035' TO REJRESN                                0717565
426100             GO TO K5085.
426150     IF TR-FM-FLD-NO EQUAL TO '0669'
426200         IF TR-FM-NEW-BYTE (1) EQUAL '0' AND
426250          WMS-INT-RATE-PTR EQUAL +6 AND
426300          WMS-PRM-CUR-BCL EQUAL '2'                               1003625
426350             MOVE '035' TO REJRESN                                0717565
426400             GO TO K5085.
426407     IF TR-FM-FLD-NO EQUAL TO '0980'                              IM006
426414        IF  WMS-COSTS-RECALC EQUAL '1'                            IM006
426421            MOVE '2' TO LOAN-COSTS-FLAG                           IM006
426428            GO TO K5055                                           IM006
426430        ELSE                                                      1003625
426432            GO TO K5055.                                          1003625
426434     IF  TR-FM-FLD-NO EQUAL TO '0287'                             1003625
426436     OR  TR-FM-FLD-NO EQUAL TO '0288'                             1003625
426438         MOVE '1' TO FM-TO-LN-PTR.                                1003625
426440     IF  TR-FM-FLD-NO EQUAL TO '0378'                             1003625
426442     OR  TR-FM-FLD-NO EQUAL TO '0379'                             1003625
426444         MOVE '1' TO FM-TO-PREV-LN-PTR.                           1003625
426446     IF  TR-FM-FLD-NO EQUAL '0287'                                1003625
426448         IF  TR-FM-NEW-COMP-3 EQUAL +6 OR +7                      1003625
426450             MOVE '1' TO RATE-CALC.                               1003625
426452*ONLY ONE POINTER ALLOWED                                         1003625
426454     IF  (TR-FM-FLD-NO EQUAL '0287'                               1003625
426456     AND TR-FM-NEW-COMP-3 GREATER THAN +0)                        1003625
426458         IF  WMS-SPLIT-RATE-SCHD GREATER THAN + 0                 1003625
426460             MOVE +0 TO WMS-SPLIT-RATE-SCHD.                      1003625
426462     IF  (TR-FM-FLD-NO EQUAL '0288'                               1003625
426464     AND TR-FM-NEW-COMP-3 GREATER THAN +0)                        1003625
426466         IF  WMS-INT-RATE-PTR GREATER THAN + 0                    1003625
426468             MOVE +0 TO WMS-INT-RATE-PTR.                         1003625
426470*ONLY ONE PREV POINTER ALLOWED                                    1003625
426472     IF  (TR-FM-FLD-NO EQUAL '0378'                               1003625
426474     AND TR-FM-NEW-COMP-3 GREATER THAN +0)                        1003625
426476         IF  WMS-PREV-SPLIT-RATE-PTR GREATER THAN + 0             1003625
426478             MOVE +0 TO WMS-PREV-SPLIT-RATE-PTR.                  1003625
426480     IF  (TR-FM-FLD-NO EQUAL '0379'                               1003625
426482     AND TR-FM-NEW-COMP-3 GREATER THAN +0)                        1003625
426484         IF  WMS-PREV-INT-PTR GREATER THAN + 0                    1003625
426486             MOVE +0 TO WMS-PREV-INT-PTR.                         1003625
426500     MOVE '1' TO WMS-LOAN-CALC-CODE.                              1003625
426510     IF TR-FM-FLD-NO NOT EQUAL TO '0265'                          1003625
426550         GO TO K5055.
426600     IF TR-FM-NEW-BYTE (1) NOT EQUAL '3' AND
426650         TR-FM-NEW-BYTE (1) NOT EQUAL '4'
426700         GO TO K5055.
426750     IF TR-FM-NEW-BYTE (1) EQUAL TO '3'
426800         PERFORM K3025 THRU K3029
426850         SUBTRACT WMS-LOAN-YTD-INT FROM HOLD-AMT13.
426900     IF TR-FM-NEW-BYTE (1) EQUAL TO '4'
426950         PERFORM K3025 THRU K3029.
427000     IF HOLD-AMT13 NOT EQUAL ZERO
427050         MOVE '016' TO REJRESN                                    0717565
427100         GO TO K5085.
427150 K5055.
427200     MOVE 'B7' TO IMEX-CODE-2.
427250     GO TO K5100.
427300 K5060.
427550     IF  FLD-START NOT LESS THAN WS-TRL-SOC-SEC-STRT              0903291
427556         IF  WMS-SOC-SEC-NA EQUAL TO '1'                          IM003
427562             GO TO K5100                                          IM003
427568         ELSE                                                     IM003
427574             GO TO K5080.                                         IM003
427580     IF  FLD-START LESS THAN WS-TRL-NME-ADD-2-STRT                0903291
427586         GO TO K5065.                                             IM003
427592     IF  WMS-NME-ADDR-TLRS LESS THAN +2                           IM003
427598         GO TO K5080.                                             IM003
427600*****  CHECK FOR MAINT LESS THAN NAME/ADD TRLR 2 START DATE ***** 0903291
427604     IF  FLD-START LESS WS-TRL-NME-ADD-2-ST-DT                    1003625
427610         GO TO K5070.                                             IM003
427616     MOVE +0 TO X.                                                IM003
427618 K5061.                                                           IM003
427620     ADD +1 TO X.                                                 IM003
427621     IF  X EQUAL +9                                               9915845
427622     OR  X GREATER THAN WMS-NA-NO-LINES-2                         9915845
427624         MOVE '040' TO REJRESN                                    0717565
427626         GO TO K5085.                                             IM003
427628     IF  WMS-NAME-ADDR-TYPE-2 (X) NOT EQUAL '5'                   IM003
427630         GO TO K5061.                                             IM003
427632     SUBTRACT X FROM +8 GIVING Y.                                 1105504
427634     MULTIPLY  WS-TRL-NME-ADD-2-LINE BY Y.                        0903291
427636     SUBTRACT Y FROM FLD-START.                                   IM003
427638     IF  TR-FM-FLD-NO NOT EQUAL '0430'                            IM003
427640         GO TO K5100.                                             IM003
427646     IF  TR-FM-NEW-DATA EQUAL SPACES                              IM003
427652         MOVE ZERO TO WMS-NA-REMAIN-DAYS-2 (X)                    IM003
427658         GO TO K5100.                                             IM003
427664     MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE.                        0266741
427670     MOVE TR-FM-NEW-DATA TO DT-HIGH-DATE.                         IM003
427676     CALL 'SIDIF1' USING DATE-AREA.                               IM003
427682     MOVE RET-DAYS TO WMS-NA-REMAIN-DAYS-2 (X).                   IM003
427688     GO TO K5100.                                                 IM003
427694 K5065.                                                           IM003
427700     IF  FLD-START LESS THAN WS-TRL-NME-ADD-1-STRT                0903291
427703         GO TO K5070.                                             IM003
427706     IF  WMS-NME-ADDR-TLRS EQUAL ZERO                             IM003
427709         GO TO K5080.                                             IM003
427710*****  CHECK FOR LESS THAN NAME/ADD TRLR 1 START DATE  *********  0903291
427712     IF  FLD-START LESS THAN WS-TRL-NME-ADD-1-ST-DT               1003625
427715         GO TO K5070.                                             IM003
427718     MOVE +0 TO X.                                                IM003
427721 K5066.                                                           IM003
427724     ADD +1 TO X.                                                 IM003
427725     IF  X EQUAL +9                                               9915845
427727     OR  X GREATER THAN WMS-NA-NO-LINES-1                         9915845
427730         MOVE '040' TO REJRESN                                    0717565
427733         GO TO K5085.                                             IM003
427736     IF  WMS-NAME-ADDR-TYPE (X) NOT EQUAL '5'                     IM003
427739         GO TO K5066.                                             IM003
427742     SUBTRACT X FROM +8 GIVING Y.                                 1105504
427745     MULTIPLY WS-TRL-NME-ADD-1-LINE BY Y.                         0903291
427748     SUBTRACT Y FROM FLD-START.                                   IM003
427754     GO TO K5100.                                                 IM003
427760 K5070.                                                           IM003
427800     MOVE '020' TO REJRESN.                                       0717565
427850     GO TO K5085.
427900 K5080.
427950     MOVE '015' TO REJRESN.                                       0717565
428000 K5085.
428050     ADD +1 TO DDA-MAINT-REJ, WS-GL-DDA-MAINT-REJ.                0902970
428100     MOVE TR-FILE-MAINT TO EX09-REMAINDER.
428150     PERFORM K3165 THRU K3168.                                    IM002
428158     PERFORM UNPOST-EXCEPT THRU WRITE-EX-EXIT.                    IM002
428166     MOVE SPACES TO EX-INFO.                                      IM002
428174     MOVE '1' TO TRAN-REWRITE-SW.                                 IM002
428182     GO TO K5500.                                                 IM002
428200 K5100.
428201     COPY IMPD31IM.                                               9915851
428295     IF  WMS-PLAN-TRLR EQUAL '1'                                  0637585
428300     AND WBC-CAPTURE-DA EQUAL '01'                                0637585
428305     AND (TR-FM-FLD-NO EQUAL '2213' OR '2219' OR '2221')          1017800
428310         PERFORM BACKOUT-ACC-CONT-LMT THRU                        0617360
428315                 BACKOUT-ACC-CONT-LMT-EXIT.                       0617360
428400     MOVE FLD-START TO MAINT-START.                               9915845
428410     MOVE TR-FM-FLD-LENGTH TO MAINT-LENGTH.                       9915845
428412     IF TR-FM-FLD-NO EQUAL '0008'                                 IMIB004
428414        MOVE 2 TO MAINT-LENGTH.                                   IMIB004
428420     MOVE SPACES TO EX15-MST-OLD-DATA.                            9915845
428450*  --MOVE OLD DATA TO EXCEPTION AREA
428455     COMPUTE MAINT-START EQUAL MAINT-START + 4                    0266725
428500     MOVE MASTER-AREA (MAINT-START:MAINT-LENGTH)                  0266725
428551       TO WS-MST-OLD-DATA                                         0266741
428552*      MOVE WS-MST-OLD-DATA TO EX15-MST-OLD-DATA                  0266741
428555*      COMPUTE MAINT-START EQUAL MAINT-START - 4.                 0266725
428560     IF TR-FM-FLD-NO EQUAL '0008'                                 IMIB51
428562        MOVE WS-MST-OLD-DATA TO EX09-STATUS-IN                    IMIB51
428564     ELSE                                                         IMIB51
428566        MOVE WS-MST-OLD-DATA TO EX15-MST-OLD-DATA                 IMIB51
428568     END-IF                                                       IMIB51
428570       COMPUTE MAINT-START EQUAL MAINT-START - 4.                 IMIB51
428620 K5110.                                                           IM002
428625     IF  TR-FM-FLD-NO EQUAL '1357'                                1105504
428630         MOVE SPACES TO WMS-NB-DC-UNIV.                           1105504
428635     IF  TR-FM-FLD-NO EQUAL '1380'                                1105504
428640         MOVE SPACES TO WMS-NB-DC-GOAL.                           1105504
428650*  --MOVE NEW DATA TO MASTER
428655     COMPUTE MAINT-START EQUAL MAINT-START + 4                    0266725
428660     MOVE SPACES         TO WS-MST-OLD-DATA.                      0266741
428661     MOVE TR-FM-NEW-DATA TO WS-MST-OLD-DATA.                      0266741
428670     IF  ((TR-FM-IM2E-TYPE EQUAL '1' OR '2')                      0817665
428671     AND (TR-FM-ADD-SUB EQUAL 'Y'))                               0817665
428672         COMPUTE MAINT-START EQUAL MAINT-START - 4                0817665
428674         CALL 'IMCMPUTE' USING MASTER-BYTE (MAINT-START)          0817665
428676                               TR-FM-NEW-DATA                     0817665
428678                               MAINT-LENGTH                       0817665
428680     ELSE                                                         0817665
428701         MOVE WS-MST-OLD-DATA (1:MAINT-LENGTH)                    0817665
428750           TO MASTER-AREA (MAINT-START:MAINT-LENGTH)              0817665
428755           COMPUTE MAINT-START EQUAL MAINT-START - 4.             0817665
428780     MOVE '1' TO FM-TODAY.                                        0545942
428782     IF  TR-FM-FLD-NO EQUAL '1384'                                0817657
428784         IF  HOLD-DAILY-RATE-CODE NOT EQUAL WMS-DAILY-RATE-CODE   0817657
428786             MOVE WMS-DAILY-RATE-CODE TO HOLD-DAILY-RATE-CODE     0817657
428788             MOVE '1' TO FM-TO-DDA-PTR                            0817657
428790                         FM-TO-SAV-PTR                            0817657
428791                         FM-TO-SAV-TIER-PTR.                      0817657
428792     IF  TR-FM-FLD-NO NOT EQUAL '1385'                            0817657
428793         GO TO K5111.                                             0817657
428794     IF  HOLD-LOAN-360-DAY-FACTOR EQUAL WMS-LOAN-360-DAY-FACTOR   0817657
428795         GO TO K5111.                                             0817657
428796     MOVE WMS-LOAN-360-DAY-FACTOR TO HOLD-LOAN-360-DAY-FACTOR.    0817657
428797     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0817657
428798         MOVE '1' TO FM-TO-OD-PTR.                                0817657
428799     IF  WMS-LOAN-TRLR EQUAL '0'                                  0817657
428800         GO TO K5111.                                             0817657
428801     IF  WMS-INT-RATE-PTR GREATER THAN +0 AND LESS THAN +5        0817657
428802         MOVE '1' TO FM-TO-LN-PTR                                 0817657
428803                     FM-TO-PREV-LN-PTR                            0817657
428804         GO TO K5111.                                             0817657
428805     IF  WMS-INT-RATE-PTR EQUAL +6 OR +7                          0817657
428806         MOVE '1' TO RATE-CALC                                    0817657
428807         GO TO K5111.                                             0817657
428808     PERFORM C2302 THRU C2306-EXIT.                               0817657
428809 K5111.                                                           0817657
428810     IF  TR-CLASS NOT EQUAL '22'                                  IM002
428820         ADD +1 TO DDA-MAINT-ACC, WS-GL-DDA-MAINT-ACC.            0902970
428850     MOVE '15' TO IMEX-REC-NO.
428900     MOVE 'B0' TO IMEX-CODE-1.
428950     IF TR-FM-CHANGE-CODE EQUAL TO 'C'
429000       AND (IMEX-CODE-2 NOT EQUAL TO 'B7' AND 'B8')
429050         MOVE 'B1' TO IMEX-CODE-2.
429100     MOVE TR-FILE-MAINT TO EX15-FM-TRAN.
429102     MOVE TR-FM-IM2E-TYPE     TO EX15-FM-IM2E-TYPE.               0817665
429104     IF  TR-CLASS EQUAL '95'                                      0817665
429106         MOVE 'Y'             TO EX15-FM-AFT-POST.                0817665
429150     MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT.
429200     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
429250     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
429252* RESET RATE TRAILER VALUES FOR LOANS AFTER ANY F/M TO POINTERS.  1003625
429254     IF  FM-TO-LN-PTR EQUAL '1'                                   1003625
429256         PERFORM R0015-FM-LN THRU R0015-FM-LN-END                 1003625
429258         MOVE '0' TO FM-TO-LN-PTR.                                1003625
429260     IF  FM-TO-PREV-LN-PTR EQUAL '1'                              1003625
429262         PERFORM R0015-FM-PREV-LN THRU R0015-FM-PREV-LN-END       1003625
429264         MOVE '0' TO FM-TO-PREV-LN-PTR.                           1003625
429270     IF  RATE-CALC EQUAL '0'                                      1003625
429272         GO TO K5115.                                             1003625
429274     IF  WMS-PRIME-RATE EQUAL ZEROES                              1003625
429276         MOVE WMS-PRM-CUR-ANN TO WMS-PRIME-RATE.                  1003625
429278     MOVE ZERO TO PRIME-CALC-FLAG.                                1003625
429280     PERFORM C2270 THRU C2270-EXIT.                               1003625
429282     PERFORM PRIME-RATE-CALC THRU PRIME-EXIT.                     1003625
429284     MOVE '0' TO RATE-CALC.                                       1003625
429290 K5115.                                                           1003625
429300     IF TR-FM-FLD-NO NOT EQUAL '0008'                             0902079
429310         GO TO K5140.                                             0902079
429320*                                                                 0902079
429330*    RESET REASON CLOSED FOR FILE MAINTENANCE                     0902079
429340*                                                                 0902079
429342     MOVE WRK-DC-DSC-DATE  TO WMS-DC-DATE-STATUS-CHANGE.          IMIB004
429344     MOVE TR-FM-NEW-REASON TO WMS-REASON-CLOSED.                  IMIB004
429350     IF (TR-FM-NEW-STATUS EQUAL '00' OR '01' OR '02' OR '03' OR   1010046
429360                                '06' OR '07' OR '08' OR '10' OR   1010046
429362                                '11')                             1010046
429370     AND (WK-IM-STATUS-IN EQUAL '04' OR '05' OR '08')             0902079
429380         MOVE SPACES TO WMS-DATE-CLOSED                           0902079
429390*        MOVE '00' TO WMS-REASON-CLOSED                           UC2010
429400         GO TO K5130.                                             0902079
429410     IF  TR-FM-NEW-BYTE (2) EQUAL '4'                             0902079
429420         GO TO K5120.                                             0902079
429430     IF (TR-FM-NEW-BYTE (2) EQUAL '5' OR '8')                     0902079
429440     AND (WK-IM-STATUS-IN EQUAL '00' OR '01' OR '02' OR '11'      1010046
429450                             OR '03' OR '06' OR '07' OR '09')     1010046
429460         GO TO K5120.                                             0902079
429470     GO TO K5130.                                                 0902079
429480*                                                                 0902079
429490*    SET REASON CLOSED FOR FILE MAINTENANCE                       0902079
429500*                                                                 0902079
429510 K5120.                                                           0902079
429520     MOVE WBC-CAPTURE-MO TO WMS-CLOSED-MO.                        0266741
429530     MOVE WBC-CAPTURE-DA TO WMS-CLOSED-DA.                        0266741
429540     MOVE WBC-CAPTURE-YR TO WMS-CLOSED-YR.                        0266741
429550     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
429560         MOVE '20' TO WMS-CLOSED-CENT                             1004775
429570     ELSE                                                         0902079
429580         MOVE '19' TO WMS-CLOSED-CENT.                            0902079
429589     IF  WMS-REASON-CLOSED EQUAL '00' OR '  '                     1105504
429590         MOVE '03' TO WMS-REASON-CLOSED.                          1105504
429600                                                                  0902079
429610 K5130.                                                           0902079
429620     MOVE 'SU' TO IMEX-CODE-1.                                    0902079
429630     MOVE 'SD' TO IMEX-CODE-2.                                    0902079
429640     MOVE '09' TO IMEX-REC-NO.                                    0902079
429645     MOVE WMS-REASON-CLOSED TO EX09-GEN-REASON.                   IMIB004
429650     MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN.                      0902079
429660     MOVE WMS-STATUS TO EX09-STATUS-OUT                           0902079
429670                        WK-IM-STATUS-IN.                          0902079
429680     MOVE WMS-CURR-BAL TO EX09-CUR-BAL.                           0902079
429690     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     0902079
429700     IF  WMS-STATUS EQUAL '06' OR '07'                            0902079
429710         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.            0266741
429720                                                                  0902079
429730 K5140.                                                           0902079
429750*                                                                 1002953
429751*----------------------------------------------------------------*1002953
429752*    WHEN ANY LOAN BILLING TRAILER FIELD IS MAINTENANCED,        *1002953
429753*    (MAINT NOS. 1189 - 1209), WMS-PYMT-DUE-AMT AND              *1002953
429754*    WMS-PAST-DUE-AMT ARE RECALCULATED.                          *1002953
429755*----------------------------------------------------------------*1002953
429756*                                                                 1002953
429758     IF  TR-FM-FLD-NO GREATER THAN '1188'                         1002953
429759     AND TR-FM-FLD-NO LESS THAN    '1210'                         1002953
429762         NEXT SENTENCE                                            1002953
429764     ELSE                                                         1002953
429766         GO  TO  K5145.                                           1002953
429768     MOVE +0                     TO  WMS-PYMT-DUE-AMT             1002953
429770                                     WMS-PAST-DUE-AMT.            1002953
429772     MOVE +8 TO Z.                                                1002953
429774 K5141.                                                           1002953
429776     SUBTRACT +1 FROM Z.                                          1002953
429778     IF  Z EQUAL ZERO                                             1002953
429780         GO  TO  K5145.                                           1002953
429782     ADD WMS-BILL-DUE-AMT (Z)    TO  WMS-PYMT-DUE-AMT.            1002953
429784     IF  WMS-BILL-DUE-STAT (Z) NOT EQUAL ZERO                     1002953
429786         ADD WMS-BILL-DUE-AMT (Z) TO WMS-PAST-DUE-AMT.            1002953
429788     GO  TO  K5141.                                               1002953
429790 K5145.                                                           1002953
429800     IF TR-FM-FLD-NO EQUAL '0265'
429850         MOVE 'SU' TO IMEX-CODE-1
429900         MOVE 'SL' TO IMEX-CODE-2
429950         MOVE '09' TO IMEX-REC-NO
430000         MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
430050         MOVE TR-FM-NEW-BYTE (1) TO EX09-STATUS-OUT
430100                                   WK-LN-STATUS-IN
430150         MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
430200         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
430250     IF TR-FM-FLD-NO EQUAL '0495'
430300         MOVE 'SU' TO IMEX-CODE-1
430350         MOVE 'SS' TO IMEX-CODE-2
430400         MOVE '09' TO IMEX-REC-NO
430450         MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN
430500         MOVE TR-FM-NEW-BYTE (1) TO EX09-STATUS-OUT
430550                                   WK-SV-STATUS-IN
430600         MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL
430650         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
430700     IF  TR-FM-FLD-NO EQUAL '0947'
430750         MOVE 'SU' TO IMEX-CODE-1
430800         MOVE 'SA' TO IMEX-CODE-2
430850         MOVE '09' TO IMEX-REC-NO
430900         MOVE WK-OD-STATUS-IN TO EX09-STATUS-IN
430950         MOVE TR-FM-NEW-BYTE (1) TO EX09-STATUS-OUT
431000                                    WK-OD-STATUS-IN
431050         MOVE ZERO TO EX09-CUR-BAL
431100         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
431150     IF  TR-FM-FLD-NO EQUAL '0471'
431200         MOVE 'SU' TO IMEX-CODE-1
431250         MOVE 'SQ' TO IMEX-CODE-2
431300         MOVE '09' TO IMEX-REC-NO
431350         MOVE WK-DCD-STATUS-IN TO EX09-STATUS-IN
431400         MOVE TR-FM-NEW-BYTE (1) TO EX09-STATUS-OUT
431450                                    WK-DCD-STATUS-IN
431500         COMPUTE DCD-NET-INT = (WMS-DCD-YTD-INT-IOD +
431550                               WMS-DCD-YTD-INT-SAV) -
431600                               (WMS-DCD-YTD-TAX-IOD +
431650                               WMS-DCD-YTD-TAX-SAV)
431700         MOVE DCD-NET-INT TO EX09-CUR-BAL
431750         PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
431755     IF TR-FM-FLD-NO EQUAL '0994'                                 IM006
431760         IF  TR-FM-NEW-BYTE (1) EQUAL SPACE                       IM006
431765         AND TR-FM-NEW-BYTE (2) EQUAL SPACE                       IM006
431770             NEXT SENTENCE                                        IM006
431775         ELSE                                                     IM006
431780             MOVE 'M1' TO IMEX-CODE-1                             IM006
431785             MOVE '  ' TO IMEX-CODE-2                             IM006
431790             MOVE '17' TO IMEX-REC-NO                             IM006
431795             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.             IM006
431800     IF STATUS-IN EQUAL TO '06' OR WMS-STATUS EQUAL TO '06'
431850         MOVE 'DF' TO IMEX-CODE-1
431900         GO TO K5150.
431950     IF STATUS-IN EQUAL TO '07' OR WMS-STATUS EQUAL TO '07'
432000         MOVE 'IF' TO IMEX-CODE-1
432050         GO TO K5150.
432060     IF  STATUS-IN EQUAL '10' OR WMS-STATUS EQUAL '10'            9915749
432062         MOVE 'HL' TO IMEX-CODE-1                                 9915749
432064         GO TO K5150.                                             9915749
432100     GO TO K5300.
432150 K5150.
432200     MOVE '15' TO IMEX-REC-NO.
432250     MOVE TR-FILE-MAINT TO EX15-FM-TRAN.
432300     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
432350     SKIP3
432400 MAINT-SECTION-B     SECTION 23.
432450     SKIP3
432500 K5300.
432540     IF  TR-FM-FLD-NO NOT EQUAL '2219'                            0617360
432550         IF  TR-FM-NEW-DATA EQUAL TO EX15-MST-OLD-DATA            0617360
432555             GO TO K5500.                                         0617360
432560*----------------------------------------------------------------*1020057
432562*    RESET THE PREVIOUS PAYMENT DATE IF THE SCHEDULE CODE CHANGES*1020057
432564*----------------------------------------------------------------*1020057
432566     IF TR-FM-FLD-NO EQUAL '0341'                                 1020057
432568         MOVE SPACES TO WMS-PREV-PYMT-DATE.                       1020057
432600     IF TR-FM-FLD-NO EQUAL TO '0026'                              0817665
432650         IF TR-FM-NEW-BYTE (1) EQUAL TO '0'
432700             MOVE '0' TO WMS-BANK-AVAIL-TRLR                      IM007
432750             SUBTRACT WS-TRL-BNK-AVAIL-LNGTH FROM WMS-LENGTH      0903291
432800             MOVE ZEROS TO WMS-BANK-AVAIL-AMT                     IM007
432850             MOVE '1' TO BANK-AVAIL-CHANGE                        IM007
432900         ELSE
432950             PERFORM INIT-BANK-AVAIL-TRLR THRU                    IM007
432956                     INIT-BANK-AVAIL-END.                         IM007
432970     IF TR-FM-FLD-NO EQUAL TO '0027'                              0817665
433050         IF TR-FM-NEW-BYTE (1) EQUAL TO '0'
433100             MOVE '0' TO WMS-CUST-AVAIL-TRLR                      IM007
433150             SUBTRACT WS-TRL-CUS-AVAIL-LNGTH FROM WMS-LENGTH      0903291
433200             MOVE ZEROS TO WMS-CUST-AVAIL-AMT                     IM007
433250             MOVE '1' TO CUST-AVAIL-CHANGE                        IM007
433255             MOVE '0' TO WMS-EXTEND-FLOAT                         0927817
433260             MOVE 'F' TO AFF-FLAG                                 0927817
433265             MOVE +0  TO AFF-MAX-ENTRY                            0927817
433300         ELSE
433350             PERFORM INIT-CUST-AVAIL-TRLR THRU                    IM007
433354                     INIT-CUST-AVAIL-END.                         IM007
433358     IF  TR-FM-FLD-NO EQUAL TO '1038'                             0817665
433362         IF  TR-FM-NEW-BYTE (1) EQUAL TO '0'                      IM007
433366             MOVE '0' TO WMS-CASH-AVAIL-TRLR                      IM007
433370             SUBTRACT WS-TRL-CSH-AVAIL-LNGTH FROM WMS-LENGTH      0903291
433374             MOVE ZEROS TO WMS-CASH-AVAIL-AMT                     IM007
433378         ELSE                                                     IM007
433382             PERFORM INIT-CASH-AVAIL-TRLR THRU                    IM007
433386                     INIT-CASH-AVAIL-END.                         IM007
433400     IF  TR-FM-FLD-NO EQUAL '0476'
433450         IF  TR-FM-NEW-BYTE (1) EQUAL '0'
433500             MOVE '0' TO WMS-OD-NSF-TRLR
433550             SUBTRACT WS-TRL-OD-NSF-LNGTH FROM WMS-LENGTH         0903291
433600         ELSE
433602             PERFORM INIT-NSF-OD-TRLR THRU INIT-NSF-OD-END.       9915858
433605     IF  TR-FM-FLD-NO EQUAL '1852'                                9915858
433610     AND TR-FM-NEW-BYTE (1) EQUAL '0'                             9915858
433612         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         9915858
433615             IF  WMS-DUAL-YR-CUR-IOD-INT EQUAL ZERO               9915858
433620             AND WMS-DUAL-YR-CUR-IOD-FED EQUAL ZERO               9915858
433625             AND WMS-DUAL-YR-CUR-SAV-INT EQUAL ZERO               9915858
433630             AND WMS-DUAL-YR-CUR-SAV-FED EQUAL ZERO               9915858
433632             AND WMS-SAVINGS-TRLR EQUAL '0'                       9915858
433634             AND WMS-HIFI-INDICATOR EQUAL ZERO                    9915858
433636             AND WMS-IOD-RATE-PTR EQUAL ZERO                      9915858
433638                 MOVE '0' TO WMS-DUAL-YEAR-TRLR                   9915858
433640                 SUBTRACT WS-TRL-DUAL-YR-LNGTH FROM WMS-LENGTH    9915858
433645             ELSE                                                 9915858
433650                 MOVE '016' TO REJRESN                            0717565
433655                 GO TO K5085                                      9915858
433656         ELSE                                                     9915858
433657             MOVE '015' TO REJRESN                                0717565
433658             GO TO K5085.                                         9915858
433660     IF  TR-FM-FLD-NO EQUAL '1852'                                9915858
433662     AND TR-FM-NEW-BYTE (1) EQUAL '1'                             9915858
433665         IF  WMS-DUAL-YEAR-TRLR EQUAL '0'                         9915858
433670             PERFORM INIT-DUAL-TAX-YR-TRLR THRU                   9915858
433675                     INIT-DUAL-TAX-YR-TRLR-END                    9915858
433680         ELSE                                                     9915858
433685             MOVE '017' TO REJRESN                                0717565
433690             GO TO K5085.                                         9915858
433700     IF  TR-FM-FLD-NO EQUAL '0477'
433750         IF  TR-FM-NEW-BYTE (1) EQUAL '0'
433800             MOVE '0' TO WMS-EXTRNL-DEPOSIT-TRLR
433850             SUBTRACT WS-TRL-EXTR-DEP-LNGTH FROM WMS-LENGTH       0903291
433900         ELSE
433910         IF  WMS-EXTRNL-DEPOSIT-TRLR EQUAL '0'                    9915845
433950             PERFORM INIT-EXT-DEP-TRLR THRU INIT-EXT-DEP-END.
433957     IF  TR-FM-FLD-NO NOT EQUAL '0760'                            IM006
433959         GO TO K5310.                                             IM006
433961     IF  TR-FM-NEW-BYTE (1) EQUAL '0' OR '1'                      IM006
433963         IF  EX15-OLD-BYTE (1) EQUAL '2'                          IM008
433964             MOVE '0' TO WMS-KITING-SUSP-TRLR                     IM008
433965             SUBTRACT WS-TRL-KITING-LNGTH FROM WMS-LENGTH         0903291
433966             GO TO K5500                                          IM008
433967         ELSE                                                     IM008
433968             GO TO K5500.                                         IM008
433969     IF  WBC-KITING-SUSP EQUAL '0'                                0266741
433971         MOVE '053' TO REJRESN                                    0717565
433973         GO TO K5085.                                             IM006
433975     IF (WMS-TARGET-AMT-TRLR EQUAL '1') AND                       IM006
433977        (WMS-TARGET-DELETE NOT EQUAL '2')                         IM006
433979         MOVE '054' TO REJRESN                                    0717565
433981         GO TO K5085.                                             IM006
433983     PERFORM INIT-KITE-SUSP-TRLR THRU INIT-KITE-SUSP-END.         IM006
433998 K5310.                                                           IM006
433999     COPY IM31BHMN.                                               0902213
434000     IF  (FLD-START NOT LESS THAN WS-TRL-LOAN-STRT)               0903291
434005     AND (FLD-START LESS THAN WS-TRL-MRKTNG-STRT)                 1003969
434050         PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
434100     IF TR-FM-FLD-NO EQUAL TO '0008'
434150         MOVE '1' TO STATUS-MAINT
434200         IF  WMS-STATUS EQUAL '08'
434250             PERFORM R6205 THRU R6205-EXIT
434300             GO  TO  K5500
434350         ELSE
434400             GO  TO  K5500.
434410     IF  TR-FM-FLD-NO EQUAL '0022'                                IM008
434420         PERFORM X2100-00-RESET-RATES THRU X2100-99-EXIT.         IM008
434421     IF  TR-FM-FLD-NO EQUAL '0096' OR '1175'                      9715519
434422         MOVE WMS-DATE-OPENED TO WK-OPEN-DATE                     9715519
434423         PERFORM CHECK-366 THRU C366-EXIT                         9715519
434424         IF  WK-RETURN-FLG NOT EQUAL WMS-LEAP-YEAR-FLG            9715519
434425             MOVE '1' TO FM-TO-DDA-PTR                            9715519
434426             MOVE WK-RETURN-FLG TO WMS-LEAP-YEAR-FLG.             9715519
434427     IF  TR-FM-FLD-NO EQUAL '1318'                                9715519
434428     OR (TR-FM-FLD-NO EQUAL '1175'                                9715519
434429     AND WMS-SAVINGS-TRLR EQUAL '1')                              9715519
434430         MOVE WMS-INT-DATE-OPENED TO WK-OPEN-DATE                 9715519
434431         PERFORM CHECK-366 THRU C366-EXIT                         9715519
434432         IF  WK-RETURN-FLG NOT EQUAL WMS-INT-LEAP-YEAR-FLG        9715519
434433             MOVE WK-RETURN-FLG TO WMS-INT-LEAP-YEAR-FLG          0316967
434434             IF  WMS-SAV-TIER-PTR GREATER +0                      0316967
434435                 MOVE '1' TO FM-TO-SAV-TIER-PTR                   0316967
434436             ELSE                                                 0316967
434437                 MOVE '1' TO FM-TO-SAV-PTR.                       0316967
434450     IF TR-FM-FLD-NO EQUAL TO '0128'
434500         MOVE WMS-STMT-FORMAT TO WMS-NEXT-STMT-FORMAT
434550         MOVE '0' TO SERIAL-STMT
434600         PERFORM C2185 THRU C2185-EXIT
434650         GO TO K5500.
434700     IF TR-FM-FLD-NO EQUAL TO '0130'
434750         PERFORM C2900 THRU C2995
434800         GO TO K5500.
434850     IF TR-FM-FLD-NO EQUAL TO '0146'
434900         IF TR-FM-NEW-BYTE (1) EQUAL TO '4'
434910             MOVE '1' TO WMS-SC-FIRST-CHECK.                      0617360
434945     IF  WMS-PLAN-TRLR NOT EQUAL '1'                              0617360
434946         GO TO K5350.                                             0617360
434947     IF  TR-FM-FLD-NO EQUAL '2152' OR '2153' OR '2154'            0617360
434948         IF  WBC-PHASE-PLAN-KEY-EDIT NOT EQUAL SPACES             0617360
434949             MOVE WBC-PHASE-PLAN-KEY-EDIT  TO IM22-PH2            0617360
434950             MOVE WMS-PLN-TRLR-TYPE        TO WS-G8-PLN-TYPE      0617360
434951             MOVE WMS-PLN-TRLR-PLAN-KEY    TO WS-G8-PLAN-KEY      0617360
434952             CALL 'SILINK'              USING IM22-PHASE          0617360
434953                                              WS-G8-FIELDS        0617360
434954             MOVE WS-G8-EDITED-PLAN-KEY                           0617360
434955                                TO WMS-PLN-TRLR-EDITED-PLAN-KEY   0617360
434956         ELSE                                                     0617360
434957             MOVE WMS-PLN-TRLR-PK-PLAN-ID     TO WS-PA-PLAN-ID    0617360
434958             MOVE WMS-PLN-TRLR-PK-SEQ-NO      TO WS-PA-SEQ-NO     0617360
434959             MOVE WMS-PLN-TRLR-PK-EMP-PLAN-ID TO WS-PA-EMP-ID     0617360
434960             MOVE WS-PA-KEY-EDIT TO WMS-PLN-TRLR-EDITED-PLAN-KEY. 0617360
434961     IF  TR-FM-FLD-NO EQUAL '0100' OR '2209' OR '2219' OR '2221'  0617360
434962                         OR '2325'                                0617360
434963         PERFORM K3351 THRU K3351-CALC-LIMITS-EXIT.               0617360
434964     IF TR-FM-FLD-NO EQUAL TO '2216'                              0617360
434965         IF  WMS-PLN-TRLR-PART-EXC-FLG EQUAL '2'                  0617360
434966             MOVE '1' TO WMS-PLN-TRLR-VALID-CONTR.                0617360
434967     IF TR-FM-FLD-NO EQUAL TO '2301'                              0617360
434968        IF (WMS-PLN-TRLR-BENE-FLAG EQUAL 'Y' OR 'E' OR 'S')       0617360
434969             MOVE '1' TO WMS-PLN-TRLR-VALID-CONTR                 0617360
434970             MOVE 'N' TO WMS-PLN-TRLR-SNG-FAM-FLG                 0617360
434971             PERFORM K3351-CALC-LIMITS THRU                       0617360
434972                     K3351-CALC-LIMITS-EXIT                       0617360
434973             GO TO K5350.                                         0617360
434974     IF TR-FM-FLD-NO EQUAL TO '2209' OR '2219'                    0617360
434975         IF  WMS-PLN-TRLR-MAX-CNT-PNT NOT EQUAL ZERO              0617360
434976             MOVE ZEROS TO WMS-PLN-TRLR-MAX-CNT-LIM               0617360
434977             END-IF                                               0617360
434978         IF  WMS-PLN-TRLR-PY-MAX-CNT-PNT NOT EQUAL ZERO           0617360
434979             MOVE ZEROS TO WMS-PLN-TRLR-PY-MAX-CNT                0617360
434980             END-IF.                                              0617360
434981     IF TR-FM-FLD-NO NOT EQUAL '2213'                             0617360
434982         GO TO K5350.                                             0617360
434983     IF (WMS-PLN-TRLR-SNG-FAM-FLG EQUAL 'N' OR 'U')               0827778
434984         MOVE '1' TO WMS-PLN-TRLR-VALID-CONTR                     0617360
434985         PERFORM K3351-CALC-LIMITS THRU K3351-CALC-LIMITS-EXIT    0617360
434986         GO TO K5350.                                             0617360
434987     IF WMS-PLN-TRLR-MAX-CNT-LIM GREATER THAN ZERO                0617360
434988         GO TO K5350.                                             0617360
434989     MOVE +0 TO X.                                                0617360
434990                                                                  0617360
434991 K5320.                                                           0617360
434992     ADD +1 TO X.                                                 0617360
434993     IF  X GREATER THAN +5                                        0617360
434994         GO TO K5350.                                             0617360
434995     IF  WMS-PLN-TRLR-TYPE EQUAL WBC-PL-PLAN-TYPE (X)             0617360
434996         IF  WMS-PLN-TRLR-SNG-FAM-FLG EQUAL 'S'                   0617360
434997             MOVE WBC-PL-TYPE-MAX-CNT-PTR1 (X) TO                 0617360
434998                  WMS-PLN-TRLR-MAX-CNT-PNT                        0617360
434999         ELSE                                                     0617360
435000             MOVE WBC-PL-TYPE-MAX-CNT-PTR2 (X) TO                 0617360
435001                  WMS-PLN-TRLR-MAX-CNT-PNT                        0617360
435002     ELSE                                                         0617360
435003         GO TO K5320.                                             0617360
435004     PERFORM K3351 THRU K3351-CALC-LIMITS-EXIT.                   0617360
435005                                                                  0617360
435006 K5350.                                                           0617360
435007     IF TR-FM-FLD-NO EQUAL TO '0265'                              0617360
435050         MOVE '1' TO LOAN-STAT-MAINT
435100         IF  WMS-LOAN-STATUS EQUAL '3' OR '4'
435150             MOVE '1' TO SYS-REQ-STMT
435200             GO  TO  K5500
435250         ELSE
435300             GO  TO  K5500.
435350     IF  TR-FM-FLD-NO EQUAL '0495'
435400         IF  WMS-INT-STATUS EQUAL '7' OR '8'
435450             MOVE '1' TO SYS-REQ-STMT
435500             GO  TO  K5500
435550         ELSE
435600             GO  TO  K5500.
435610     IF  TR-FM-FLD-NO EQUAL '0532'                                9916072
435612         MOVE WMS-DDA-MAX-BAL TO WMS-DDA-MAX-BAL-BEG              9916072
435614         GO TO K5500.                                             9916072
435650     IF  TR-FM-FLD-NO EQUAL '0290' OR '0287'
435700         PERFORM C2302 THRU C2304-EXIT                            IM008
435750         GO  TO  K5500.
435800     IF  TR-FM-FLD-NO EQUAL '0352' OR '0355' OR '0358' OR '0380'
435850         PERFORM C2302 THRU C2302-EXIT                            IM008
435900         PERFORM C2306 THRU C2306-EXIT                            IM008
435950         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE       0266741
436000         GO  TO  K5500.
436050     IF  TR-FM-FLD-NO EQUAL '0360'
436055     AND (WMS-INT-RATE-PTR EQUAL +6 OR +7)                        1003625
436070         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE       0266741
436100         PERFORM PRIME-RATE-CHANGE THRU PRIME-CHANGE-EXIT
436150         GO TO K5500.
436152     IF  TR-FM-FLD-NO EQUAL TO '0669'                             IM008
436153         PERFORM C2270 THRU C2270-EXIT                            IM008
436154         GO TO K5500.                                             IM008
436155     IF  TR-FM-FLD-NO EQUAL '1036'                                IM008
436156     AND (WMS-INT-RATE-PTR EQUAL +6 OR +7)                        IM008
436157         PERFORM PRIME-RATE-CHANGE THRU PRIME-CHANGE-EXIT         IM008
436158         GO TO K5500.                                             IM006
436160     IF  TR-FM-FLD-NO EQUAL '1036'                                IM006
436162     AND WMS-INT-RATE-PTR GREATER THAN +0                         IM006
436164         PERFORM C2302 THRU C2304-EXIT                            IM008
436166         GO TO K5500.                                             IM006
436168     IF  TR-FM-FLD-NO EQUAL '1036'                                IM006
436170     AND WMS-SPLIT-RATE-SCHD EQUAL +0                             IM006
436172     AND WMS-ANNUAL-RATE GREATER THAN +0                          IM006
436174         PERFORM C2302 THRU C2304-EXIT                            IM008
436176         GO TO K5500.                                             IM006
436178     IF  TR-FM-FLD-NO EQUAL '1036'                                IM006
436180     AND WMS-SPLIT-RATE-SCHD EQUAL +0                             IM006
436182     AND WMS-ANNUAL-RATE GREATER THAN +0                          IM006
436184         PERFORM C2302 THRU C2302-EXIT                            IM008
436186         PERFORM C2306 THRU C2306-EXIT                            IM008
436188         GO TO K5500.                                             IM006
436200     IF  TR-FM-FLD-NO EQUAL '0659'
436202         MOVE '1' TO IOD-CALC-DALY.                               0527322
436204     IF  TR-FM-FLD-NO EQUAL '2147'                                0527322
436205         IF  TR-FM-NEW-COMP-3 EQUAL +0                            0527322
436206             MOVE SPACES TO WMS-CLOSE-EXP-DTE                     0527322
436207         ELSE                                                     0527322
436208             IF  WMS-DATE-OPENED NOT EQUAL SPACES                 0527322
436209                 MOVE WMS-DATE-OPENED  TO DT-LOW-DATE             0527322
436210                 MOVE TR-FM-NEW-COMP-3 TO RET-DAYS                0527322
436211                 CALL 'SIDHI'       USING DATE-AREA               0527322
436212                 MOVE DT-H-MO          TO WMS-CLOSE-EXP-DTE-MO    0527322
436213                 MOVE DT-H-DA          TO WMS-CLOSE-EXP-DTE-DA    0527322
436215                 MOVE DT-H-YR          TO WMS-CLOSE-EXP-DTE-YR    0527322
436216                 IF  DT-H-YR        LESS THAN WBC-NEXT-CENT-YR    0527322
436217                     MOVE '20'         TO WMS-CLOSE-EXP-DTE-CENT  0527322
436218                 ELSE                                             0527322
436219                     MOVE '19'         TO WMS-CLOSE-EXP-DTE-CENT. 0527322
436220 K5475.                                                           9913584
436225     IF  TR-FM-FLD-NO NOT EQUAL '0693'                            9913584
436230         GO TO K5500.                                             9913584
436235     IF  TR-CLASS EQUAL '95'                                      9913584
436240         IF  TR-FM-NEW-BYTE (1) GREATER THAN ZERO                 9913584
436250             GO TO K5500.                                         9913584
436256     MOVE TR-FM-NEW-BYTE (1) TO SAV-BKUP-WTHLD-FLAG.              0903055
436257     IF  TR-FM-NEW-BYTE (1) EQUAL '0'                             0903055
436258         GO TO K5495.                                             0903055
436259*----------------------------------------------------------------*0903055
436260*    ASSESS PENDING TAX IF BACKUP WITHHOLDING FLAG               *0903055
436261*    IS MAINTENANCED TO 4-9.                                     *0903055
436262*----------------------------------------------------------------*0903055
436263     IF  TR-FM-NEW-BYTE (1) GREATER THAN '3'                      0903055
436264         NEXT SENTENCE                                            0903055
436265     ELSE                                                         0903055
436266         GO TO K5500.                                             0903055
436269     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
436271     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         2012254
436272         MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT                 2012254
436273         MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC      2012254
436274         PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT      IM007
436278         SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX.          IM007
436280     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM007
436281         IF  WMS-SAV-PEND-TAX GREATER THAN +0                     IM007
436282             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
436283             MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC  2012254
436284             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  2012254
436285             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX.      IM007
436287     GO TO K5500.                                                 IM007
436292 K5495.                                                           IM007
436294     MOVE +0 TO WMS-IOD-PEND-TAX.                                 IM007
436295     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM007
436296         MOVE +0 TO WMS-SAV-PEND-TAX.                             IM007
436300 K5500.
436310     EXIT.                                                        IM002
436320 K5550.                                                           IM002
436347     GO TO Q4500.                                                 9915849
436348 K5560.                                                           9915849
436349     IF  TR-FM-FLD-NO EQUAL '0101'                                9915849
436350         MOVE WMS-TAX-CODE          TO TEMP-35                    9915849
436351         MOVE TR-FM-NEW-DATA        TO WMS-TAX-CODE               9915849
436352         GO TO K5560-EDIT.                                        9915849
436353     IF  TR-FM-FLD-NO EQUAL '0102'                                9915849
436354         MOVE WMS-TAX-NO            TO TEMP-35                    9915849
436355         MOVE TR-FM-NEW-DATA        TO WMS-TAX-NO                 9915849
436356         GO TO K5560-EDIT.                                        9915849
436357     IF  TR-FM-FLD-NO EQUAL '0693'                                9915849
436358         MOVE WMS-BKUP-WTHLD-FLAG   TO TEMP-35                    9915849
436359         MOVE TR-FM-NEW-DATA        TO WMS-BKUP-WTHLD-FLAG        9915849
436360         GO TO K5560-EDIT.                                        9915849
436361     IF  TR-FM-FLD-NO EQUAL '0694'                                9915849
436362         MOVE WMS-TAX-EXEMPT-RSN    TO TEMP-35                    9915849
436363         MOVE TR-FM-NEW-DATA        TO WMS-TAX-EXEMPT-RSN         9915849
436364         GO TO K5560-EDIT.                                        9915849
436365     IF  TR-FM-FLD-NO EQUAL '0695'                                9915849
436366         MOVE WMS-TIN-CERTIFICATION TO TEMP-35                    9915849
436367         MOVE TR-FM-NEW-DATA        TO WMS-TIN-CERTIFICATION.     9915849
436368 K5560-EDIT.                                                      9915849
436369     MOVE 'F'                 TO TX-ERR-CODE.                     9915849
436370     IF  WBC-TAX-ID-PHASE EQUAL SPACES                            0266741
436371         NEXT SENTENCE                                            9915849
436372     ELSE                                                         9915849
436373         MOVE WBC-TAX-ID-PHASE         TO IM31-USER-PHASE         0266741
436374         CALL 'SILINK' USING IM31-USER-PHASE-AREA                 9915849
436375                             MASTER-AREA                          9915849
436376                             DDA-WRKBCR-1                         0266741
436377                             TX-ERR-CODE                          9915849
436378                             TX-ERR-MSG                           0337046
436379                             SIWS-LANG-SUB.                       0337046
436380     IF  TX-ERR-CODE EQUAL 'Y'                                    0337046
436381         MOVE '055' TO REJRESN.                                   0717565
436382     IF  TR-FM-FLD-NO EQUAL '0101'                                0337046
436383         MOVE TEMP-35    TO WMS-TAX-CODE                          0337046
436384         GO TO K5560-EXIT.                                        0337046
436385     IF  TR-FM-FLD-NO EQUAL '0102'                                0337046
436386         MOVE TEMP-35    TO WMS-TAX-NO                            0337046
436387         GO TO K5560-EXIT.                                        0337046
436388     IF  TR-FM-FLD-NO EQUAL '0693'                                0337046
436389         MOVE TEMP-35    TO WMS-BKUP-WTHLD-FLAG                   0337046
436390         GO TO K5560-EXIT.                                        0337046
436391     IF  TR-FM-FLD-NO EQUAL '0694'                                0337046
436392         MOVE TEMP-35    TO WMS-TAX-EXEMPT-RSN                    0337046
436393         GO TO K5560-EXIT.                                        0337046
436394     IF  TR-FM-FLD-NO EQUAL '0695'                                0337046
436395         MOVE TEMP-35    TO WMS-TIN-CERTIFICATION.                0337046
436396 K5560-EXIT.                                                      0337046
436397     EXIT.                                                        0337046
436398*                                                                 0337046
436400 K5600.
436450**** GENERAL LEDGER CODE FILE MAINTENANCE -- TRAN CODE 19 ****
436452     IF  GL-MAINT-SW EQUAL 'N'                                    IM006
436454         MOVE WMS-GL-CODE TO TR-FM-OLD-GL                         IM006
436456         GO TO K5610.                                             IM006
436460     IF  ACCT-NOT-FOUND EQUAL TO '1'                              IM002
436470         MOVE '002' TO REJRESN                                    0717565
436480         GO TO K5085.                                             IM002
436500     IF  TR-FM-OLD-GL NOT EQUAL WMS-GL-CODE
436550         MOVE '044' TO REJRESN                                    0717565
436600         GO TO K5085.
436620 K5610.                                                           IM006
436650     MOVE TR-FM-NEW-GL TO WMS-GL-CODE.
436700     ADD +1 TO DDA-MAINT-ACC, WS-GL-DDA-MAINT-ACC.                0902970
436710     MOVE '1' TO FM-TODAY.                                        0902970
436750     MOVE TR-FM-OLD-GL TO EX15-MST-OLD-DATA.
436800     MOVE '15' TO IMEX-REC-NO.
436850     MOVE 'B0' TO IMEX-CODE-1.
436900     MOVE 'B1' TO IMEX-CODE-2.
436950     MOVE SPACES TO TR-FM-OLD-GL.
437000     MOVE TR-FILE-MAINT TO EX15-FM-TRAN.
437050     MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT.
437100     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
437150     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
437200     IF  GL-MAINT-SW EQUAL 'N'                                    0902970
437250         GO TO K5699-EXIT                                         0902970
437300     ELSE                                                         0902970
437350         GO TO Q4500.                                             0902970
437400 K5699-EXIT. EXIT.                                                0902970
437450     SKIP3                                                        0902970
437500 K5700.                                                           0902970
437550     IF  WBC-GL-PHASE EQUAL  SPACES                               0266741
437600         MOVE PROGRAM-NAME TO SIMESS-PROGRAM                      0902970
437650         MOVE 505 TO SIMESS-MESS-NO                               0902970
437700         MOVE 'NO GL GEN PHASE - BCR 7' TO SIMESS-OPTIONAL-MESSAGE0902970
437750         CALL 'SIMESS' USING SIMESS-AREA                          0902970
437800         GO TO Z9900.                                             0902970
437850     MOVE  WBC-GL-PHASE TO  IM31-PH2.                             0266741
437900     CALL 'SILINK' USING IM31-PHASE                               0902970
437950                         GL-BUILD-MISC-FIELDS                     0902970
438000                         MASTER-AREA                              0902970
438050                         TRAN-FILE                                0417078
438060                         DDA-WRKBCR-1.                            0417078
438100     IF  GL-BUILD-MASTER-SW EQUAL 'N'                             0902970
438125         MOVE GL-BUILD-COST-CENTER TO TRN-NOT-FND-COST-CTR        0902970
438150         GO TO K5700-EXIT.                                        0902970
438350     IF  WMS-GL-COST-CENTER EQUAL SPACES                          0902970
438355         MOVE GL-BUILD-COST-CENTER TO WMS-GL-COST-CENTER          0902970
438360             GO TO K5700-EXIT.                                    0902970
438365     IF  GL-BUILD-COST-CENTER EQUAL WMS-GL-COST-CENTER            0902970
438400             GO TO K5700-EXIT.                                    0902970
438410     MOVE WMS-GL-COST-CENTER TO EX15-MST-OLD-DATA.                0902970
438450     MOVE GL-BUILD-COST-CENTER TO WMS-GL-COST-CENTER.             0902970
438500     ADD +1 TO DDA-MAINT-ACC, WS-GL-DDA-MAINT-ACC.                0902970
438540*----------------------------------------------------------------*1105504
438542*    PLACE A FIELD NUMBER OF 9998 ON TAG RECORDS CREATED AS A    *1105504
438544*    RESULT OF MAINTENANCE TO THE COST CENTER.                   *1105504
438546*----------------------------------------------------------------*1105504
438550     MOVE WMS-GL-COST-CENTER TO IM-EXC15-FM-NEW-DATA-CC.          1105504
438560     MOVE IM-EXC15-FM-TRAN-CC TO EX15-FM-TRAN.                    1105504
438600     MOVE '15' TO IMEX-REC-NO.                                    0902970
438650     MOVE 'B0' TO IMEX-CODE-1.                                    0902970
438700     MOVE 'B1' TO IMEX-CODE-2.                                    0902970
438850     MOVE WMS-DATE-LAST-MAINT TO EX15-DATE-LAST-MAINT.            0902970
438900     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0902970
438920 K5720.                                                           9915845
438950     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
439000     ADD +1                      TO OUT-DDA-END-NO-ACCTS          0902970
439001                                    WS-GL-OUT-DDA-END-NO-ACCTS.   0902970
439050     ADD WMS-DDA-BAL             TO OUT-DDA-END-BAL               0902970
439051                                    WS-GL-OUT-DDA-END-BAL.        0902970
439054*--------------------------------------------------------------*  2016639
439056*    ADD TO EXTERNAL INVESTMENT TRANSFER OUT TOTALS            *  2016639
439058*--------------------------------------------------------------*  2016639
439060     IF  WMS-XINV-LINK-IND EQUAL 'L' OR 'P'                       2016639
439062         IF  WMS-XINV-PROCESS-IND EQUAL '1'                       2016639
439064             ADD +1                  TO T3-XINV-SD-OUT-NO         2016639
439066                                        WS-GL-XINV-SD-OUT-NO      2016639
439068             ADD WMS-XINV-BALANCE    TO T3-XINV-SD-OUT-AMT        2016639
439070                                        WS-GL-XINV-SD-OUT-AMT     2016639
439072         ELSE                                                     2016639
439074         IF  WMS-XINV-PROCESS-IND EQUAL '2'                       2016639
439076             ADD +1                  TO T3-XINV-ND-OUT-NO         2016639
439078                                        WS-GL-XINV-ND-OUT-NO      2016639
439080             ADD WMS-XINV-BALANCE    TO T3-XINV-ND-OUT-AMT        2016639
439082                                        WS-GL-XINV-ND-OUT-AMT.    2016639
439090*----------------------------------------------------------------*1105504
439091*    EXCLUDE AUTOBORROW ACCOUNTS                                 *1105504
439092*----------------------------------------------------------------*1105504
439100     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915749
439110     AND WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
439150         ADD +1                  TO OUT-LN-END-NO-ACCTS           0902970
439151                                    WS-GL-OUT-LN-END-NO-ACCTS     0902970
439200         ADD WMS-PRIN-BAL        TO OUT-LN-END-PRIN               0902970
439201                                    WS-GL-OUT-LN-END-PRIN         0902970
439250         ADD WMS-INTRST-BAL      TO OUT-LN-END-INTRST             0902970
439251                                    WS-GL-OUT-LN-END-INTRST       0902970
439300         ADD WMS-OTHER-CHGS      TO OUT-LN-END-OTHER              0902970
439301                                    WS-GL-OUT-LN-END-OTHER        0902970
439350         ADD WMS-INS1            TO OUT-LN-END-INS1               0902970
439351                                    WS-GL-OUT-LN-END-INS1         0902970
439400         ADD WMS-INS2            TO OUT-LN-END-INS2               0902970
439401                                    WS-GL-OUT-LN-END-INS2         0902970
439450         ADD WMS-FEES            TO OUT-LN-END-FEES               0902970
439451                                    WS-GL-OUT-LN-END-FEES         0902970
439500         ADD +.005 WMS-LOAN-ACCR-INT GIVING HOLD-ACCR1            0902970
439550         ADD HOLD-ACCR1          TO OUT-LN-END-ACC-INT            0902970
439551                                    WS-GL-OUT-LN-END-ACC-INT      0902970
439600         ADD WMS-LOAN-YTD-INT    TO OUT-LN-END-YTD-PAID           0902970
439601                                    WS-GL-OUT-LN-END-YTD-PAID.    0902970
439650     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0902970
439700         ADD +1                  TO OUT-SAV-END-NO-ACCTS          0902970
439701                                    WS-GL-OUT-SAV-END-NO-ACCTS    0902970
439750         ADD WMS-INT-CUR-BAL     TO OUT-SAV-END-BALANCE           0902970
439751                                    WS-GL-OUT-SAV-END-BALANCE     0902970
439800         ADD +.005 WMS-ACCR-INT GIVING HOLD-ACCR1                 0902970
439850         ADD HOLD-ACCR1          TO OUT-DDA-INT-ACC               0902970
439851                                    WS-GL-OUT-DDA-INT-ACC         0902970
439900         ADD WMS-YTD-INT-PAID    TO OUT-DDA-INT-PAID-YTD          0902970
439902                                    WS-GL-OUT-DDA-INT-PAID-YTD.   0617360
439904     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
439906         ADD +1                      TO OUT-PLN-END-NO-ACCTS      0617360
439908                                        WS-GL-OUT-PLN-END-NO-ACCTS0617360
439910         ADD WMS-CURR-BAL            TO OUT-PLN-END-BALANCE       0617360
439912                                        WS-GL-OUT-PLN-END-BALANCE 0617360
439914         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1          0617360
439916         ADD HOLD-ACCR1              TO OUT-PLN-INT-ACC           0617360
439918                                        WS-GL-OUT-PLN-INT-ACC     0617360
439920         ADD WMS-IOD-YTD-INT-PAID    TO OUT-PLN-INT-PAID-YTD      0617360
439922                                     WS-GL-OUT-PLN-INT-PAID-YTD.  0617360
439950     IF  WMS-IOD-RATE-PTR   GREATER THAN ZERO                     0902970
440010     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     0902970
440020         ADD +1                  TO OUT-IOD-END-NO-ACCTS          0902970
440021                                    WS-GL-OUT-IOD-END-NO-ACCTS    0902970
440030         ADD WMS-DDA-BAL TO OUT-IOD-END-BAL, WS-GL-OUT-IOD-END-BAL0902970
440040         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1          0902970
440050         ADD HOLD-ACCR1 TO OUT-IOD-INT-ACC, WS-GL-OUT-IOD-INT-ACC.0902970
440060     ADD WMS-IOD-YTD-INT-PAID TO OUT-IOD-PAID-YTD                 0902970
440061                                 WS-GL-OUT-IOD-PAID-YTD.          0902970
440062     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
440063         ADD WMS-DUAL-YR-CUR-IOD-INT TO DUAL-OUT-IO-INT-PAID-YTD  9915858
440065                                      WS-GL-DUAL-OUT-IO-PAID-YTD  9915858
440066         ADD WMS-DUAL-YR-CUR-SAV-INT TO DUAL-OUT-SV-INT-PAID-YTD  9915858
440067                                  WS-GL-DUAL-OUT-SV-INT-PAID-YTD. 9915858
440070     IF  WMS-DDA-BAL LESS THAN ZERO                               0902970
440080         ADD WMS-DDA-BAL  TO OUT-OD-END-BAL, WS-GL-OUT-OD-END-BAL 0902970
440090         ADD +1                  TO OUT-OD-END-NO-ACCTS           0902970
440091                                    WS-GL-OUT-OD-END-NO-ACCTS.    0902970
440100     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0902970
440110         ADD WMS-OD-ACCRL-BAL    TO OUT-OD-ACCRL-ACCT-BAL         0902970
440111                                    WS-GL-OUT-OD-ACCRL-ACCT-BAL   0902970
440120         ADD +.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR1               0902970
440130         ADD HOLD-ACCR1          TO OUT-OD-ACCRL-INT-BAL          0902970
440131                                    WS-GL-OUT-OD-ACCRL-INT-BAL    0902970
440140         ADD WMS-OD-CYC-CHGD     TO OUT-OD-ACCRL-CHRGD-CY         0902970
440141                                    WS-GL-OUT-OD-ACCRL-CHRGD-CY   0902970
440150         ADD WMS-OD-YTD-CHGD     TO OUT-OD-ACCRL-CHGD-YTD         0902970
440151                                    WS-GL-OUT-OD-ACCRL-CHGD-YTD   0902970
440160         ADD +1                  TO OUT-OD-ACCRL-NO-ACCTS,        0902970
440161                                    WS-GL-OUT-OD-ACCRL-NO-ACCTS.  0902970
440163 K5720-EXIT. EXIT.                                                9915845
440165 K5730.                                                           9915845
440170     PERFORM C2184 THRU C2184-EXIT.                               0902970
440171     ADD +1                      TO IN-DDA-END-NO-ACCTS           2016639
440172                                    WS-GL-IN-DDA-END-NO-ACCTS.    2016639
440173     ADD WMS-DDA-BAL             TO IN-DDA-END-BAL                2016639
440174                                    WS-GL-IN-DDA-END-BAL.         2016639
440175*--------------------------------------------------------------*  2016639
440176*    ADD TO EXTERNAL INVESTMENT TRANSFER IN TOTALS             *  2016639
440177*--------------------------------------------------------------*  2016639
440178     IF  WMS-XINV-LINK-IND EQUAL 'L' OR 'P'                       2016639
440179         IF  WMS-XINV-PROCESS-IND EQUAL '1'                       2016639
440180             ADD +1                  TO T3-XINV-SD-IN-NO          2016639
440181                                        WS-GL-XINV-SD-IN-NO       2016639
440182             ADD WMS-XINV-BALANCE    TO T3-XINV-SD-IN-AMT         2016639
440183                                        WS-GL-XINV-SD-IN-AMT      2016639
440184         ELSE                                                     2016639
440185         IF  WMS-XINV-PROCESS-IND EQUAL '2'                       2016639
440186             ADD +1                  TO T3-XINV-ND-IN-NO          2016639
440187                                        WS-GL-XINV-ND-IN-NO       2016639
440188             ADD WMS-XINV-BALANCE    TO T3-XINV-ND-IN-AMT         2016639
440189                                        WS-GL-XINV-ND-IN-AMT.     2016639
440192*----------------------------------------------------------------*1105504
440193*    EXCLUDE AUTOBORROW ACCOUNTS                                 *1105504
440194*----------------------------------------------------------------*1105504
440200     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915749
440205     AND WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
440210         ADD +1                  TO IN-LN-END-NO-ACCTS,           0902970
440211                                    WS-GL-IN-LN-END-NO-ACCTS      0902970
440220         ADD WMS-PRIN-BAL        TO IN-LN-END-PRIN                0902970
440221                                    WS-GL-IN-LN-END-PRIN          0902970
440230         ADD WMS-INTRST-BAL      TO IN-LN-END-INTRST              0902970
440231                                    WS-GL-IN-LN-END-INTRST        0902970
440240         ADD WMS-OTHER-CHGS      TO IN-LN-END-OTHER               0902970
440241                                    WS-GL-IN-LN-END-OTHER         0902970
440250         ADD WMS-INS1            TO IN-LN-END-INS1                0902970
440251                                    WS-GL-IN-LN-END-INS1          0902970
440260         ADD WMS-INS2            TO IN-LN-END-INS2                0902970
440261                                    WS-GL-IN-LN-END-INS2          0902970
440270         ADD WMS-FEES            TO IN-LN-END-FEES                0902970
440271                                    WS-GL-IN-LN-END-FEES          0902970
440280         ADD +.005 WMS-LOAN-ACCR-INT GIVING HOLD-ACCR1            0902970
440290         ADD HOLD-ACCR1          TO IN-LN-END-ACC-INT             0902970
440291                                    WS-GL-IN-LN-END-ACC-INT       0902970
440300         ADD WMS-LOAN-YTD-INT    TO IN-LN-END-YTD-PAID            0902970
440301                                    WS-GL-IN-LN-END-YTD-PAID.     0902970
440310     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0902970
440320         ADD +1                  TO IN-SAV-END-NO-ACCTS,          0902970
440321                                    WS-GL-IN-SAV-END-NO-ACCTS     0902970
440330         ADD WMS-INT-CUR-BAL     TO IN-SAV-END-BALANCE            0902970
440331                                    WS-GL-IN-SAV-END-BALANCE      0902970
440340         ADD +.005 WMS-ACCR-INT GIVING HOLD-ACCR1                 0902970
440350         ADD HOLD-ACCR1          TO IN-DDA-INT-ACC                0902970
440351                                    WS-GL-IN-DDA-INT-ACC          0902970
440360         ADD WMS-YTD-INT-PAID    TO IN-DDA-INT-PAID-YTD           0902970
440361                                    WS-GL-IN-DDA-INT-PAID-YTD.    0902970
440362     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
440363         ADD +1                      TO IN-PLN-END-NO-ACCTS       0617360
440364                                        WS-GL-IN-PLN-END-NO-ACCTS 0617360
440365         ADD WMS-CURR-BAL            TO IN-PLN-END-BALANCE        0617360
440366                                        WS-GL-IN-PLN-END-BALANCE  0617360
440367         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1          0617360
440368         ADD HOLD-ACCR1              TO IN-PLN-INT-ACC            0617360
440369                                        WS-GL-IN-PLN-INT-ACC      0617360
440370         ADD WMS-IOD-YTD-INT-PAID    TO IN-PLN-INT-PAID-YTD       0617360
440371                                        WS-GL-IN-PLN-INT-PAID-YTD.0617360
440375     IF  WMS-IOD-RATE-PTR   GREATER THAN ZERO                     0617360
440380     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     0902970
440390         ADD +1                  TO IN-IOD-END-NO-ACCTS           0902970
440391                                    WS-GL-IN-IOD-END-NO-ACCTS     0902970
440400         ADD WMS-DDA-BAL TO IN-IOD-END-BAL, WS-GL-IN-IOD-END-BAL  0902970
440410         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1          0902970
440420         ADD HOLD-ACCR1  TO IN-IOD-INT-ACC, WS-GL-IN-IOD-INT-ACC. 0902970
440430     ADD WMS-IOD-YTD-INT-PAID TO IN-IOD-PAID-YTD                  0902970
440431                                 WS-GL-IN-IOD-PAID-YTD.           0902970
440433     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
440435         ADD WMS-DUAL-YR-CUR-IOD-INT TO DUAL-IN-IO-INT-PAID-YTD   9915858
440437                                      WS-GL-DUAL-IN-IO-PAID-YTD.  9915858
440440     IF  WMS-DDA-BAL LESS THAN ZERO                               0902970
440450         ADD WMS-DDA-BAL TO IN-OD-END-BAL, WS-GL-IN-OD-END-BAL    0902970
440460         ADD +1                  TO IN-OD-END-NO-ACCTS            0902970
440461                                    WS-GL-IN-OD-END-NO-ACCTS.     0902970
440470     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0902970
440480         ADD WMS-OD-ACCRL-BAL    TO IN-OD-ACCRL-ACCT-BAL          0902970
440481                                    WS-GL-IN-OD-ACCRL-ACCT-BAL    0902970
440490         ADD +.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR1               0902970
440500         ADD HOLD-ACCR1          TO IN-OD-ACCRL-INT-BAL           0902970
440501                                    WS-GL-IN-OD-ACCRL-INT-BAL     0902970
440510         ADD WMS-OD-CYC-CHGD     TO IN-OD-ACCRL-CHRGD-CY          0902970
440511                                    WS-GL-IN-OD-ACCRL-CHRGD-CY    0902970
440520         ADD WMS-OD-YTD-CHGD     TO IN-OD-ACCRL-CHGD-YTD          0902970
440521                                    WS-GL-IN-OD-ACCRL-CHGD-YTD    0902970
440524         ADD +1                  TO IN-OD-ACCRL-NO-ACCTS          9915845
440526                                    WS-GL-IN-OD-ACCRL-NO-ACCTS.   9915845
440530 K5730-EXIT. EXIT.                                                9915845
440532 K5700-EXIT.                                                      9915812
440533     EXIT.                                                        9915812
440540 K5750-REGION-CALC.                                               9915812
440541     MOVE WMS-RATE-REGION       TO HOLD-RATE-REGION.              9915845
440542     MOVE WMS-SVC-CHRG-REGION   TO HOLD-SVC-CHRG-REGION.          9915845
440543     MOVE WBC-CTL2-FLAG         TO WS-CTL2-FLAG.                  0266741
440544     MOVE WBC1-CONTROL-2         TO WS-CONTROL-2.                 0266741
440545     MOVE WBC-CTL3-FLAG         TO WS-CTL3-FLAG.                  0266741
440546     MOVE WBC1-CONTROL-3         TO WS-CONTROL-3.                 0266741
440547     MOVE WBC-RATE-REGION       TO WS-RATE-REGION-KEY.            0266741
440548     MOVE WBC-SVCH-REGION       TO WS-SVCH-REGION-KEY.            0266741
440549     COPY IMPDXR.                                                 1003625
440550*WRITE EXCEPTION ONLY IF THE RATE REGION KEY CHANGES              1003625
440551     IF  HOLD-RATE-REGION NOT EQUAL WMS-RATE-REGION               1003625
440552         MOVE 'Y'               TO WS-RATE-REGION-KEY-CHANGE      1003625
440553         MOVE HOLD-RATE-REGION  TO EX15-MST-OLD-DATA              1003625
440554         MOVE WMS-RATE-REGION   TO R-EXC15-FM-NEW-DATA            1003625
440555         MOVE '1211'            TO R-EXC15-FM-FIELD               1003625
440556         MOVE RATE-REGION-KEY-LIT(SIWS-LANG-SUB)                  0266741
440557                                TO R-EXC15-FM-DESC                0266741
440558         MOVE REGION-EXC15-FM-TRAN TO EX15-FM-TRAN                0266741
440559         MOVE WMS-DATE-LAST-MAINT  TO EX15-DATE-LAST-MAINT        0266741
440560         MOVE '15'                 TO IMEX-REC-NO                 0266741
440561         MOVE 'B0'                 TO IMEX-CODE-1                 0266741
440562         MOVE 'B9'                 TO IMEX-CODE-2                 0266741
440563         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 0266741
440564*WRITE EXCEPTION ONLY IF THE S/C REGION KEY CHANGES               0266741
440565     IF  HOLD-SVC-CHRG-REGION NOT EQUAL WMS-SVC-CHRG-REGION       0266741
440566         MOVE HOLD-SVC-CHRG-REGION TO EX15-MST-OLD-DATA           0266741
440567         MOVE WMS-SVC-CHRG-REGION  TO R-EXC15-FM-NEW-DATA         0266741
440568         MOVE '1212'               TO R-EXC15-FM-FIELD            0266741
440569         MOVE SC-REGION-KEY-LIT(SIWS-LANG-SUB)                    0266741
440570                                   TO R-EXC15-FM-DESC             0266741
440571         MOVE REGION-EXC15-FM-TRAN TO EX15-FM-TRAN                0266741
440572         MOVE WMS-DATE-LAST-MAINT  TO EX15-DATE-LAST-MAINT        0266741
440573         MOVE '15'                 TO IMEX-REC-NO                 0266741
440574         MOVE 'B0'                 TO IMEX-CODE-1                 0266741
440575         MOVE 'B9'                 TO IMEX-CODE-2                 0266741
440576         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 0266741
440577 K5750-EXIT.                                                      0266741
440578     EXIT.                                                        0266741
440590 LOAN-SECTION-E      SECTION 25.                                  1003625
440600     SKIP3
440650*    *******  LOAN EXTENSION TRANSACTION PROCESSING  *******
440700     SKIP1
440750 K5800.
440800     IF ACCT-NOT-FOUND EQUAL TO '1'
440850         MOVE TR-LOAN-EXTENSION TO EX09-REMAINDER
440900         GO TO K3130.
440950     IF WMS-LOAN-TRLR EQUAL TO '0'
441000         MOVE TR-LOAN-EXTENSION TO EX09-REMAINDER
441050         GO TO K3150.
441100     IF  WMS-LOAN-STATUS EQUAL '3' OR '4' OR '6' OR '9'           9915599
441150         MOVE TR-LOAN-EXTENSION TO EX09-REMAINDER
441200         MOVE '038' TO REJRESN                                    0717565
441250         GO TO K3165.
441300     IF  TR-LOAN-WAIVE-FLG EQUAL '9' AND                          0902531
441350         TR-LOAN-WAIVE-AMT GREATER THAN WMS-PAST-DUE-AMT
441400         MOVE TR-LOAN-EXTENSION TO EX09-REMAINDER
441450         MOVE '041' TO REJRESN                                    0717565
441500         GO  TO  K3165.
441550     MOVE '18'                   TO  IMEX-REC-NO.                 9915845
441600     MOVE 'B0B5'                 TO  IMEX-EX-CODE.                9915845
441650     MOVE TR-LOAN-EXT-FLAG       TO  EX18-FLAG.                   9915845
441700     MOVE TR-LOAN-EXT-CY         TO  EX18-NO-CYC.                 9915845
441750     MOVE TR-LOAN-WAIVE-FLG      TO  EX18-WAIVE-FLG.              9915845
441800     MOVE TR-LOAN-WAIVE-AMT      TO  EX18-WAIVE-AMT.              9915845
441850     MOVE TR-LOAN-EXT-CHARGE     TO  EX18-EXT-CHARGE.             9915845
441900     MOVE WMS-LAST-EXT-DATE      TO  EX18-PE-DATE.                9915845
441950     MOVE WMS-EXTENSION-STATUS   TO  EX18-PE-FLAG.                9915845
442000     MOVE WMS-REMAIN-COUNT       TO  EX18-PE-REM-CYC.             9915845
442050     MOVE WMS-PAST-DUE           TO  EX18-PAST-DUE-FLAG.          1002953
442100     MOVE WMS-PAST-DUE-AMT       TO  EX18-PAST-DUE-AMT.           1002953
442150     MOVE WMS-BILLING-TRAILERS (1)                                1002953
442152                                 TO  EX18-BILLING-TRAILERS (1).   1002953
442154     MOVE WMS-BILLING-TRAILERS (2)                                1002953
442156                                 TO  EX18-BILLING-TRAILERS (2).   1002953
442158     MOVE WMS-BILLING-TRAILERS (3)                                1002953
442160                                 TO  EX18-BILLING-TRAILERS (3).   1002953
442162     MOVE WMS-BILLING-TRAILERS (4)                                1002953
442164                                 TO  EX18-BILLING-TRAILERS (4).   1002953
442166     MOVE WMS-BILLING-TRAILERS (5)                                1002953
442168                                 TO  EX18-BILLING-TRAILERS (5).   1002953
442170     MOVE WMS-BILLING-TRAILERS (6)                                1002953
442172                                 TO  EX18-BILLING-TRAILERS (6).   1002953
442174     MOVE WMS-BILLING-TRAILERS (7)                                1002953
442176                                 TO  EX18-BILLING-TRAILERS (7).   1002953
442200     MOVE WMS-PYMT-DUE-AMT       TO  EX18-PYMT-DUE-AMT.           1002953
442210     MOVE WMS-DATE-LAST-MAINT    TO  EX18-DATE-LAST-MAINT.        0266748
442250     MOVE WMS-LOAN-STATUS        TO EX18-PREV-LN-STAT.            9915845
442300     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.
442350     IF  TR-LOAN-EXT-CY NOT EQUAL ZERO
442400         ADD TR-LOAN-EXT-CY TO WMS-REMAIN-COUNT
442450                               WMS-YTD-EXT-MONTHS.
442500     IF  TR-LOAN-EXT-FLAG EQUAL '0'
442550         MOVE ZEROES TO WMS-REMAIN-COUNT.
442600     IF  TR-LOAN-EXT-CHARGE EQUAL ZERO                            9715253
442605         GO  TO  K5810.                                           9715253
442610     PERFORM R3642 THRU R3642-EXIT.                               9715253
442615     MOVE TR-LOAN-EXT-CHARGE         TO  OTH-DISB                 9715253
442620                                         FEE-CHG                  9715253
442625                                         HOLD-AMT.                9715253
442630     MOVE EX-LOAN-DISB               TO  EX01-LOAN-DISB.          9715253
442635     ADD TR-LOAN-EXT-CHARGE          TO  WMS-OTHER-CHGS           9715253
442640                                         WMS-FEE-THIS-CY          9715253
442645                                         WMS-FEES                 9715253
442650                                         WMS-BILLED-FEES          9715253
442655                                         WMS-LOAN-YTD-FEES        9715253
442665                                         LOAN-EXT-CHRG            9715253
442670                                         LOAN-DB-AMT              9715253
442675                                         LOAN-DR-OTH              9715253
442680                                         WS-GL-LOAN-DB-AMT        9715253
442685                                         WS-GL-LOAN-EXT-CHRG      9715253
442690                                         WS-GL-LOAN-DR-OTH.       9715253
442695     ADD +1                          TO  LOAN-EXT-NO              9715253
442700                                         LOAN-DB-NO               9715253
442705                                         WS-GL-LOAN-DB-NO         9715253
442710                                         WS-GL-LOAN-EXT-NO.       2011248
442720     MOVE WBC-GENERATED-TRANS (27)   TO  GEN-TRAN-OPTION-HOLD.    0266741
442725     MOVE '6'                        TO  EX01-TYPE.               9715253
442730     MOVE '27'                       TO  EX01-INT-CODE.           9715253
442735     MOVE 'G5'                       TO  IMEX-CODE-2.             9715253
442740     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 9715253
442745                                                                  9715253
442747 K5810.                                                           9715253
442750     MOVE WBC-CAPTURE-DATE TO WMS-LAST-EXT-DATE.                  0266741
442800     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MAINT.                0266741
442850     MOVE TR-LOAN-EXT-FLAG TO WMS-EXTENSION-STATUS.
442900     ADD +1 TO WMS-YTD-EXTENSIONS.
442950     IF (TR-LOAN-WAIVE-FLG EQUAL '1' OR '2')
443000     OR (WMS-REMAIN-COUNT GREATER THAN +0 AND
443050         WMS-EXTENSION-STATUS GREATER THAN '0')
443100         MOVE ZEROS              TO  WMS-PAST-DUE                 1002953
443120                                     WMS-PDUE-DAYS-AFTER-NTC      1002953
443150                                     WMS-DAYS-SINCE-PNLTY         1002953
443160         MOVE SPACES             TO  WMS-PAST-DUE-DATE            1002953
443200         MOVE WMS-PYMT-DUE-AMT   TO  AMT-PD                       1002953
443250         PERFORM K1502 THRU K1502-EXIT.                           1002953
443350     IF  TR-LOAN-WAIVE-FLG EQUAL ZERO                             1002953
443355     OR  TR-LOAN-WAIVE-FLG EQUAL '2'                              1002953
443360         GO  TO  Q4500.                                           1002953
443400     IF  TR-LOAN-WAIVE-FLG EQUAL '1'
443450         IF  WMS-LOAN-STATUS EQUAL '2'
443500             MOVE WMS-LOAN-STATUS TO EX09-STATUS-IN
443550             MOVE 'SU' TO IMEX-CODE-1
443600             MOVE 'SL' TO IMEX-CODE-2
443650             MOVE '09' TO IMEX-REC-NO
443700             MOVE '1' TO WMS-LOAN-STATUS  WK-LN-STATUS-IN
443750                          EX09-STATUS-OUT
443800             MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
443850             PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT              1002953
443860             GO TO Q4500                                          1002953
443870         ELSE                                                     1002953
443880             GO TO Q4500.                                         1002953
443900     IF  TR-LOAN-WAIVE-FLG EQUAL '9'                              0902531
443910         MOVE TR-LOAN-WAIVE-AMT  TO  AMT-PD                       1002953
443920         PERFORM K1502 THRU K1502-EXIT                            1002953
443930         GO  TO  K5820.                                           9915640
443940     IF  TR-LOAN-WAIVE-FLG GREATER THAN '2'                       1002953
443950         MOVE +7 TO Z                                             1002953
443960         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
443970     IF  TR-LOAN-WAIVE-FLG GREATER THAN '3'                       1002953
443980         MOVE +6 TO Z                                             1002953
443990         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
444000     IF  TR-LOAN-WAIVE-FLG GREATER THAN '4'                       1002953
444010         MOVE +5 TO Z                                             1002953
444020         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
444030     IF  TR-LOAN-WAIVE-FLG GREATER THAN '5'                       1002953
444040         MOVE +4 TO Z                                             1002953
444050         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
444060     IF  TR-LOAN-WAIVE-FLG GREATER THAN '6'                       1002953
444070         MOVE +3 TO Z                                             1002953
444080         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
444090     IF  TR-LOAN-WAIVE-FLG GREATER THAN '7'                       1002953
444100         MOVE +2 TO Z                                             1002953
444110         PERFORM K1502-02 THRU K1502-02-EXIT.                     1002953
445250 K5820.
445255     IF  TR-LOAN-WAIVE-FLG EQUAL '9'                              9915640
445260          MOVE ZERO TO WMS-BILL-DUE-STAT (1)                      9915640
445265          MOVE ZERO TO WMS-BILL-DUE-STAT (2)                      9915640
445270          MOVE ZERO TO WMS-BILL-DUE-STAT (3)                      9915640
445275          MOVE ZERO TO WMS-BILL-DUE-STAT (4)                      9915640
445280          MOVE ZERO TO WMS-BILL-DUE-STAT (5)                      9915640
445285          MOVE ZERO TO WMS-BILL-DUE-STAT (6)                      9915640
445290          MOVE ZERO TO WMS-BILL-DUE-STAT (7)                      9915640
445295     ELSE                                                         9915640
445300          MOVE ZERO TO WMS-BILL-DUE-STAT (Z).                     9915640
445310*                                                                 9915640
445400     GO  TO  Q4500.
445410*                                                                 2016639
445412     COPY IMPD31XL.                                               2016639
445414*                                                                 2016639
445450 ROOT-SECTION-G      SECTION 1.
445500     SKIP3
445550*    *************  STATEMENT ITEM PROCESSING  *************
445600     SKIP1
445650 K7000.
445700     IF  TR-80-TYPE EQUAL '02'
445750         ADD +1 TO DDA-DESC-NO, WS-GL-DDA-DESC-NO.                0902970
445800     IF  TR-80-TYPE EQUAL '03' OR '12'
445850         ADD +1 TO WMS-SC-NUM-ACH, WMS-MTD-NUM-ACH                IM004
445900         ADD +1 TO DDA-ACH-NO, WS-GL-DDA-ACH-NO.                  0902970
445950     IF  TR-80-TYPE EQUAL '10' OR '14'
446000         ADD +1 TO WMS-SC-NUM-ACH, WMS-MTD-NUM-ACH                IM004
446050         ADD +1 TO DDA-ADDENDA-NO, WS-GL-DDA-ADDENDA-NO.          0902970
446100     IF  TR-80-TYPE EQUAL '09' OR '13'
446150         ADD +1 TO WMS-SC-NUM-ATM, WMS-MTD-NUM-ATM                IM004
446200         ADD +1 TO DDA-ATM-NO, WS-GL-DDA-ATM-NO.                  0902970
446250     IF  SERIAL-STMT EQUAL '1',  GO  TO  K8500.
446300     IF WMS-STMT-FULL-SHEET EQUAL TO '1', GO TO Q4200.
446350 K7200.
446400     IF TR-OPTION (2) EQUAL TO '0', GO TO K7500.
446450     IF TR-OPTION (2) EQUAL TO '1'
446500         MOVE LINE-DB2 TO LINE-DB
446550         MOVE LINE-CR2 TO LINE-CR
446600         GO TO K8000.
446650     MOVE LINE-DB3 TO LINE-DB.
446700     MOVE LINE-CR3 TO LINE-CR.
446750     GO TO K8000.
446800 K7500.
446850     MOVE LINE-DB1 TO LINE-DB.
446900     MOVE LINE-CR1 TO LINE-CR.
446950 K8000.
447000     IF FS-CR GREATER THAN LINE-CR
447050         SUBTRACT LINE-CR FROM FS-CR
447100         MOVE ZERO TO FS-DB
447150         GO TO K8100.
447200     IF FS-DB GREATER THAN LINE-DB
447250         SUBTRACT LINE-DB FROM FS-DB
447300         MOVE ZERO TO FS-CR
447350         GO TO K8100.
447400     GO TO K8500.
447450 K8100.
447500     ADD +1 TO WMS-STMT-LINES.
447550     IF WMS-STMT-LINES LESS THAN PAGE-LINES, GO TO K8500.
447600     ADD +1 TO WMS-STMT-PAGE.
447650     SUBTRACT PAGE-LINES FROM WMS-STMT-LINES.
447700     IF WMS-STMT-FULL-SHEET NOT EQUAL TO '1', GO TO K8500.
447750     IF WMS-SAVINGS-TRLR EQUAL TO '1'
447800         GO TO K8500.
447850 K8200.
447900     MOVE '06' TO IMEX-REC-NO.
447950     MOVE 'FS' TO IMEX-CODE-1.
448000     MOVE WMS-STMT-FORMAT TO EX07-FORMAT.
448010     MOVE '1' TO FULL-SHEET-TODAY.                                1004015
448050     PERFORM R5192 THRU R5192-EXIT.
448100     MOVE WMS-STMT-LINES TO EX06-STMT-LINES.
448150     MOVE WMS-STMT-BEGIN-BAL TO EX06-BEG-BAL, EX06-DDA-BAL.       IM004
448200     MOVE WMS-STMT-NO-CREDITS TO EX06-CR-NO.
448250     MOVE WMS-STMT-CR-AMT TO EX06-CR-AMT.
448300     MOVE WMS-STMT-NO-DEBITS TO EX06-DB-NO.
448350     MOVE WMS-STMT-DR-AMT TO EX06-DB-AMT.
448400     MOVE WMS-STMT-SERV-CHG TO EX06-SVC-CHG.
448410     MOVE WMS-STMT-WAIVED-SC-RP TO EX06-WAIVED-SC-RP.             0347045
448450     MOVE WMS-STMT-ITEMS TO EX06-ITEMS.
448500     MOVE PAGE-LINES TO EX06-LINES.
448550     MOVE WMS-STMT-PAGE TO EX06-PAGES.
448600     MOVE WMS-CURR-BAL TO EX06-END-BAL.
448610     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM004
448615         MOVE WMS-INT-BEG-BAL TO EX06-SAV-BAL                     IM004
448616         SUBTRACT EX06-SAV-BAL FROM EX06-DDA-BAL                  IM004
448620     ELSE                                                         IM004
448625         MOVE +0.00           TO EX06-SAV-BAL.                    IM004
448626*----------------------------------------------------------------*9915749
448627*    EXCLUDE AUTOBORROW ACCOUNTS.                                *9915749
448628*----------------------------------------------------------------*9915749
448629     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915749
448630     AND WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
448635         MOVE WMS-BEGIN-BAL TO EX06-LOAN-BAL                      IM004
448637         MOVE WMS-PRIN-BAL  TO EX06-LOAN-PRIN-BAL                 IM008
448638         MOVE WMS-PREV-BAL  TO EX06-LOAN-PREV-BAL                 IM008
448640     ELSE                                                         IM004
448645         MOVE +0.00         TO EX06-LOAN-BAL                      IM008
448646                               EX06-LOAN-PRIN-BAL                 IM008
448647                               EX06-LOAN-PREV-BAL.                IM008
448650     MOVE WMS-DATE-LAST-STMT TO EX06-LAST-STMT.
448700     MOVE SEQ-CTR TO EX06-TR-SEQ.
448750     MOVE WMS-STMT-FORMAT TO EX06-FORMAT.
448800     PERFORM R5194 THRU R5195.                                    IM003
448850     MOVE SPACES TO IMEX-INFO.
448900     ADD WMS-STMT-DUPL TO DDA-STMT-FORMAT (WMS-STMT-FORMAT)       0902970
448901                          WS-GL-DDA-STMT-FORMAT (WMS-STMT-FORMAT).0902970
448950 K8300.
449000     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-STMT.                 0266741
449050     MOVE WMS-CURR-BAL TO WMS-STMT-BEGIN-BAL.
449100     MOVE ZERO TO WMS-STMT-NO-CREDITS
449150                  WMS-STMT-CR-AMT
449200                  WMS-STMT-NO-DEBITS
449250                  WMS-STMT-DR-AMT
449300                  WMS-STMT-SERV-CHG
449310                  WMS-STMT-WAIVED-SC-RP                           0347045
449350                  WMS-STMT-ITEMS
449400                  WMS-STMT-LINES.
449450 K8500.  EXIT.
449500 K8600.
449550     GO TO Q4200.
449600     SKIP3
449650*    ***************  TRANSACTION FILE READ  ***************
449700     SKIP1
449750 Q0010.
449800     MOVE '0' TO ACCT-NOT-FOUND.
449810     IF SAV-GL-CURRENT-COST-CTR NOT EQUAL SPACES                  0902970
449815        PERFORM C1009 THRU C1009-EXIT                             0902970
449830        MOVE SPACES TO SAV-GL-CURRENT-COST-CTR.                   0902970
449850     MOVE 'R' TO I-O-CONTROL-OPERATOR.
449900     CALL 'IMPOSTS' USING I-O-CONTROL-AREA,
449950                           TRAN-FILE.
450000     IF I-O-88-END-OF-FILE
450050         MOVE HIGH-VALUES TO TRN-CONTROL
450100         GO TO Q0080.
450110*                                                                 9915749
450120     IF  (TR-KEY EQUAL 'ZZZZZZZZZZZZZZZZZZZZZZ')                  9915749
450130     OR  (TR-CLASS EQUAL '49' OR '75')                            9915749
450140         GO TO Q4600.                                             0447268
450150*                                                                 9915749
450160*----------------------------------------------------------------*9915749
450161*    FIND 15-DIGIT REFERENCE NUMBER AND STORE FOR USE WHEN       *9915749
450162*    CREATING EXCEPTION RECORDS.                                 *9915749
450163*    SET STOP-HIT-FLAG ON FOR STOP SUSPECT TRANSACTIONS.         *9915749
450164*----------------------------------------------------------------*9915749
450165     PERFORM X0750 THRU X0750-EXIT.                               9915749
450200     MOVE '0' TO TRAN-REWRITE-SW.
450202     IF  TR-CLASS EQUAL '80'                                      9915749
450204         MOVE ' ' TO EX13-NB-PEND-DEC-IND                         9915749
450206                     EX13-CAPITAL-MKT-IND                         9915749
450208                     EX13-NB-FORCE-PAY-IND                        9915749
450209         MOVE '0' TO LIST-POST-ITEM                               0827768
450210         IF  TR-POST-PRIORITY EQUAL '3A' OR '0A'                  9915749
450212             NEXT SENTENCE                                        9915749
450214         ELSE                                                     9915749
450216             MOVE ' ' TO TR-PEND-DECISION.                        9915749
450218*                                                                 9915749
450220     IF  TR-REJ-PROG NOT GREATER THAN ZERO                        9915749
450222         IF  TR-REJ-RESN EQUAL TO 'SU '                           0817735
450224             IF  TR-POST-PRIORITY NOT EQUAL '3B'                  9915749
450226                 MOVE '1' TO STOP-HIT-FLAG.                       9915749
450250     IF TR-REJ-PROG NOT GREATER THAN ZERO, GO TO Q0020.
450300     IF TR-REJ-PROG EQUAL TO '31'
450350         MOVE SPACES TO TR-REJ-PROG
450400         MOVE '1' TO TRAN-REWRITE-SW
450450         GO TO Q0020.
450500     IF  TR-REJ-PROG EQUAL TO '28'                                0902008
450505     AND TR-REJ-RESN NOT EQUAL '030'                              0817735
450510         IF  TR-REJ-RESN EQUAL 'AL '                              0817735
450520             MOVE '1'            TO HAF-HIT-FLAG                  0902008
450530             GO TO Q0020                                          0902008
450540         ELSE                                                     0902008
450550             MOVE '1'            TO STOP-HIT-FLAG                 0902008
450600             GO TO Q0020.                                         0902008
450650     MOVE '1' TO UPLINE-REJ-SW.
450700     GO TO Q0020.
450750 Q0015.
450780     IF  EX-MST-CTL EQUAL '1'                                     IM003
450810         MOVE '2' TO UPLINE-REJ-SW.                               IM003
450840     PERFORM WRITE-EXCEPT THRU WRITE-EX-EXIT.                     IM003
450870     IF  UPLINE-REJ-SW NOT EQUAL '2'                              IM003
450900         MOVE '0' TO EX-MST-CTL.                                  IM003
450930     MOVE '0' TO UPLINE-REJ-SW.                                   IM003
450960     GO TO Q4600.                                                 0447268
450990 Q0020.                                                           IM003
451020     MOVE TR-KEY TO TRN-CONTROL.                                  IM003
451050 Q0080.  EXIT.                                                    IM003
451080 Q0100.                                                           IM003
451110     GO TO C3000.                                                 IM003
451400     SKIP3
451450*    *********** LOAN CAUTION ACCOUNT PROCESSING ***********
451500     SKIP1
451550 Q3000.
451600     IF WMS-LOAN-CAUTION EQUAL TO '1'
451650         AND WBC-EXC-CODE (3) EQUAL TO '1'                        0266741
451700         MOVE '03' TO IMEX-CODE-1
451750         MOVE '077' TO WK-REJ-REASON                              0717565
451760         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
451800         MOVE '1' TO TRAN-REWRITE-SW
451850         PERFORM K0330 THRU K0339.
451900     GO TO Q4400.
451950     SKIP3
452000*    **************  TRIAL TRANSACTION CALL  ***************
452050     SKIP3
452100 Q4200.
452150     IF WBC-TRANS-PRINT EQUAL TO ZERO, GO TO Q4250.               0266741
452200     MOVE '1' TO TRIAL-TRANS.
452250     PERFORM CALL-TRIAL-BAL THRU CALL-TRIAL-END.
452300     SKIP3
452350*    ***************  LARGE ITEM PROCESSING  ***************
452400     SKIP1
452450 Q4250.
452500     IF  LG-ITEM-FLAG EQUAL TO '0'                                IM006
452505         IF  KITE-ITEM-FLAG EQUAL '1'                             IM006
452510             MOVE ZERO TO WMS-KITE-LGE-ITEM                       IM006
452515             MOVE '0' TO KITE-ITEM-FLAG                           IM006
452520             GO TO Q4300                                          IM006
452525         ELSE                                                     IM006
452530             GO TO Q4300.                                         IM006
452535     IF  TR-AMOUNT LESS THAN HOLD-LG-ITEM                         IM006
452540         IF  KITE-ITEM-FLAG EQUAL '1'                             IM006
452550             MOVE '0' TO KITE-ITEM-FLAG                           IM006
452555             GO TO Q4300                                          IM006
452560         ELSE                                                     IM006
452565             GO TO Q4300.                                         IM006
452570     IF  KITE-ITEM-FLAG EQUAL '1'                                 IM006
452575         IF  TR-AMOUNT GREATER THAN WMS-KITE-LGE-ITEM             IM006
452579             MOVE TR-AMOUNT TO WMS-KITE-LGE-ITEM                  IM006
452583             MOVE '0' TO KITE-ITEM-FLAG                           IM006
452587         ELSE                                                     IM006
452591             MOVE '0' TO KITE-ITEM-FLAG.                          IM006
452600     MOVE 'F0' TO IMEX-CODE-1.
452650     MOVE '070' TO WK-REJ-REASON.                                 0717565
452660     PERFORM X3000-REJ-REASON THRU X3000-EXIT.                    IM008
452700     MOVE '1' TO TRAN-REWRITE-SW.
452750     PERFORM K0330 THRU K0339.
452800 Q4300.
452850     IF WMS-MARKET-TRLR EQUAL TO '0', GO TO Q4400.
452900     IF  WMS-MARKET-DELETE EQUAL '9', GO TO Q4400.
452950     IF  WMS-MKT-LARGE-ITEM EQUAL '0', GO TO Q4400.
453000     IF WMS-MKT-LARGE-ITEM EQUAL TO '1'
453050         IF  TR-TRAN-TYPE EQUAL '3'                               9915845
453100             GO TO Q4340
453150         ELSE GO TO Q4400.
453200     IF WMS-MKT-LARGE-ITEM EQUAL TO '2'
453250         IF  TR-TRAN-TYPE EQUAL '1'                               9915845
453300             GO TO Q4340
453350         ELSE GO TO Q4400.
453400*  --AT THIS POINT, 'WMS-MKT-LARGE-ITEM' MUST BE '3'
453450 Q4340.
453500     MOVE WMS-MRKT-LARGE-ITEM TO HOLD-MKT-LG-ITEM.
453550 Q4350.
453600     IF  TR-AMOUNT LESS THAN HOLD-MKT-LG-ITEM, GO TO Q4400.
453650     MOVE 'F1' TO IMEX-CODE-1.
453700     ADD +1 TO WMS-MRKT-ITEM-COUNT.
453750     PERFORM K0330 THRU K0339.
453800 Q4400.
453850     IF WMS-AUDIT EQUAL TO '1'
453900         MOVE 'H3' TO IMEX-CODE-1
453950         MOVE '074' TO WK-REJ-REASON                              0717565
453960         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
454000         MOVE '1' TO TRAN-REWRITE-SW
454050         PERFORM K0330 THRU K0339.
454100     IF TR-OPTION (1) NOT EQUAL TO '0'
454150         MOVE 'N' TO HOLD-X1
454200         MOVE TR-OPTION (1) TO HOLD-X2
454250         MOVE HOLD-X TO IMEX-CODE-1
454300         MOVE TR-OPTION (1) TO HOLD-REJ3                          0917829
454350         MOVE HOLD-REJ TO WK-REJ-REASON                           IM003
454360         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
454400         MOVE '1' TO TRAN-REWRITE-SW
454450         PERFORM K0330 THRU K0339.                                IM002
454700     IF  WMS-CURR-BAL EQUAL ZERO AND
454750         WMS-TARGET-AMT-TRLR EQUAL '0'
454800         IF  TR-TRAN-TYPE LESS THAN '5' OR GREATER THAN '6'       9915845
454820             MOVE 'H5' TO IMEX-CODE-1                             IM007
454840             PERFORM K0330 THRU K0339.                            IM007
454950     IF WMS-SPECL-HANDL GREATER THAN '0'
455100         MOVE '075' TO WK-REJ-REASON                              0717565
455110         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
455150         MOVE '1' TO TRAN-REWRITE-SW
455200         IF  WBC-EXC-CODE (1) EQUAL TO '1'                        0266741
455210             MOVE '01' TO IMEX-CODE-1                             IM006
455220             PERFORM K0330 THRU K0339.                            IM006
455250     IF WMS-CAUTION EQUAL TO '1'
455400         MOVE '076' TO WK-REJ-REASON                              0717565
455410         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
455450         MOVE '1' TO TRAN-REWRITE-SW
455500         IF  WBC-EXC-CODE (2) EQUAL TO '1'                        0266741
455510             MOVE '02' TO IMEX-CODE-1                             IM006
455520             PERFORM K0330 THRU K0339.                            IM006
455530*                                                                 0266866
455531** CREATES EXCEPTION FOR DUAL SIGNATURES REQUIRED **              0266866
455532*                                                                 0266866
455533     IF WMS-SIGNATURE-CARD GREATER THAN '1'                       0266866
455534         MOVE 'DS ' TO WK-REJ-REASON                              0717565
455535         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 0266866
455536         MOVE '1' TO TRAN-REWRITE-SW                              0266866
455537         IF  WBC-EXC-CODE (22) EQUAL TO '1'                       0727676
455538             MOVE '22' TO IMEX-CODE-1                             0727676
455539             PERFORM K0330 THRU K0339.                            0266866
455550     IF WMS-OFF-EMP NOT EQUAL TO '0'
455700         MOVE '078' TO WK-REJ-REASON                              0717565
455710         PERFORM X3000-REJ-REASON THRU X3000-EXIT                 IM008
455750         MOVE '1' TO TRAN-REWRITE-SW
455800         IF  WBC-EXC-CODE (4) EQUAL TO '1'                        0266741
455810             MOVE '04' TO IMEX-CODE-1                             IM006
455820             PERFORM K0330 THRU K0339.                            IM006
455850     IF WMS-MARKET-TRLR EQUAL TO '1'
455900         AND WMS-MARKET-DELETE NOT EQUAL '9'
455950         AND WMS-KEY-ACCT EQUAL TO '1'
456000         AND WBC-EXC-CODE (8) EQUAL TO '1'                        0266741
456050         MOVE '08' TO IMEX-CODE-1
456100         PERFORM K0330 THRU K0339.
456110     IF  (TR-SOURCE EQUAL '28' AND TR-80-TYPE EQUAL '80')         1004773
456115         ADD TR-AMOUNT TO WBC-REG-TFR-AMT (4)                     0266741
456120                          WBC-REG-CALL-AMT (13).                  0266741
456150     IF  (TR-SOURCE EQUAL '28' AND TR-80-TYPE EQUAL '01')         IM003
456160         IF WBC-EXC-CODE (7) EQUAL TO '1'                         0266741
456170             MOVE '07' TO IMEX-CODE-1                             IM003
456180             PERFORM K0330 THRU K0339.                            IM003
456190     IF  (TR-SOURCE EQUAL '28' AND TR-80-TYPE EQUAL '02')         IM003
456200         ADD +1        TO DDA-STOP-CHGS-NO                        IM003
456201                          WS-GL-DDA-STOP-CHGS-NO                  0902970
456210         ADD TR-AMOUNT TO DDA-STOP-CHGS-POSTED                    IM003
456211                          WS-GL-DDA-STOP-CHGS-POSTED              0902970
456220         MOVE 'H4'     TO IMEX-CODE-1                             IM003
456230         PERFORM K0330 THRU K0339.                                IM003
456300     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
456320         MOVE '5' TO WK-INVEST-FUNCTION                           1004554
456330         PERFORM CALL-INVEST-PHASE THRU CALL-INVEST-EXIT.         1004554
456332     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
456334         MOVE WS-WORK-COMB-PLN-CODES TO TR-COMB-PLN-CODES         0617360
456336     ELSE                                                         0617360
456338         MOVE '    '                 TO TR-COMB-PLN-CODES.        0617360
456340                                                                  1004554
456350 Q4500.
456400     IF TR-CLASS1 NOT EQUAL TO '8' OR TR-CLASS2 NOT EQUAL TO '0'
456450         IF TR-SCLASS2 EQUAL TO '1'
456460         AND WBC-DLCA-FLAG EQUAL '0'                              0266741
456500             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-CUST-ACTIVITY.0266741
456550 Q4600.
456560******************************************************************0427139
456565***  CHECK FIRST TO SEE IF TRANSACTION BELONGS TO A PASSBOOK      0427139
456570***  ACCOUNT.  IF IT DOES THEN SET TR-80-PSBK-FLAG TO A '1'       0427139
456575***  AND REWRITE THE TRANSACTION. VALID PASSBOOK TRANS ONLY.      0427139
456580******************************************************************0427139
456582     IF  TR-TRAN-CODE EQUAL '80'                                  0427139
456583         MOVE '0'         TO TR-80-PSBK-FLAG.                     0427139
456585     IF  WMS-PASSBOOK-ACCT EQUAL '1'                              0427139
456590     AND (TR-TRAN-CODE EQUAL '80')                                0427139
456595     AND (TR-TRAN-TYPE EQUAL '1' OR '2' OR '3' OR '4')            0427139
456600     AND (TR-80-TRAN-TYPE EQUAL '01' OR '02' OR '03' OR           0427139
456605                '06' OR '08' OR '09' OR '10' OR '12' OR           0427139
456610                '13' OR '14' OR '15')                             0427139
456615     MOVE '1'             TO TR-80-PSBK-FLAG                      0427139
456620     MOVE '1'             TO TRAN-REWRITE-SW.                     0427139
456625*                                                                 0427139
456700******************************************************************
456780***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE INCOMING   IM002
456860***  TRANSACTION AFTER IT IS POSTED.                              IM002
456940***                                                               IM002
457020***  COPY IM31UBWR.                                               IM002
457100***                                                               IM002
457180***  END OF USER EXIT.                                            IM002
457260******************************************************************IM002
457300     IF (WBC-IM31-TRAN-PH EQUAL SPACES OR LOW-VALUES)             0627561
457302         GO TO Q5000                                              0627561
457304     ELSE                                                         0627561
457306         MOVE WBC-IM31-TRAN-PH TO IM31-PH2                        0627561
457308         CALL 'SILINK' USING IM31-PHASE                           0627561
457310                             MASTER-AREA                          0627561
457312                             TRAN-FILE                            0627561
457314                             TRAN-REWRITE-SW.                     0627561
457570 Q5000.                                                           IM002
457600     MOVE 'L' TO I-O-CONTROL-OPERATOR.                            0447268
457650     CALL 'IMPOSTS' USING I-O-CONTROL-AREA,
457700                          TRAN-FILE.
457750     GO TO Q0010.
457800     SKIP3
457850*    *******************************************************
457900*    *         AFTER TRANSACTION MASTER PROCESSING         *
457950*    *******************************************************
458000     SKIP3
458050*    ************* DELETED TRAILER COMPRESSION *************
458100     SKIP1
458150 R0010.
458200     IF SKIP-READ-SW EQUAL TO '1'
458250         IF NEW-MASTER-SW EQUAL TO '0'
458300             GO TO C0500.
458302**** FOR AN ACCOUNT ADDED ONLINE WHOSE NEW ACCOUNT TRANSACTION  **IM003
458304**** DID NOT COME THROUGH BATCH, THE ACCOUNT IS DELETED FROM    **IM003
458306**** THE MASTER, MEMO, AND ALPHA FILES.                         **IM003
458308     IF  SI-88-ENVIRONMENT-ONLINE                                 IM003
458310     AND IM-MEMO-OL-NEW-ACCT                                      IM003
458312     AND OL-DELETE-SW EQUAL '1'                                   IM003
458314         MOVE 'D' TO I-O-CONTROL-OPERATOR                         IM003
458316         CALL 'IMACTM' USING  I-O-CONTROL-OPERATOR                IM003
458318                              MASTER-AREA                         IM003
458320                              SI-ENVIRONMENT-AREA                 IM003
458322         MOVE '0' TO SKIP-READ-SW                                 IM003
458324         MOVE '0' TO ACCT-NOT-FOUND                               IM003
458334         MOVE 'D' TO I-O-CONTROL-OPERATOR                         IM003
458336         CALL 'IMALPHA' USING  I-O-CONTROL-OPERATOR               IM003
458338                               SI-ENVIRONMENT-AREA                IM003
458340                               MASTER-AREA                        IM003
458341                               WBC-ONLINE-ALPHA-RECORD            0266741
458342         GO TO C0500.                                             IM003
458344******************************************************************0902970
458346***  THE FOLLOWING EXIT IS FOR FIELD FILE MAINT CROSS-CHECKING    9915845
458348***                                                               9915845
458350     COPY IMPD31CR.                                               9915845
458352***                                                               9915845
458354******************************************************************2016639
458356*                                                                 2016639
458358*--------------------------------------------------------------*  2016639
458359*    EXTERNAL INVESTMENT LINK INDICATOR CHANGED TODAY          *  2016639
458360*--------------------------------------------------------------*  2016639
458361     IF  WXI-LINK-IND-OUT NOT EQUAL  WMS-XINV-LINK-IND            2016639
458362         PERFORM K5900-XINV    THRU  K5900-EXIT.                  2016639
458363*                                                                 2016639
458364*--------------------------------------------------------------*  2016639
458365*    EXTERNAL INVESTMENT BALANCE ADJUSTMENT REQUIRED           *  2016639
458366*--------------------------------------------------------------*  2016639
458367     IF  WXI-XINV-BALANCE NOT EQUAL  WMS-XINV-BALANCE             2016639
458368         PERFORM K5910-XINV-BAL THRU K5910-EXIT.                  2016639
458369*                                                                 2016639
458370******************************************************************9915845
458372***  IF ACCOUNT HAS HAD FILE MAINTENANCE, CHECK COST CENTER CODE *9915845
458374     IF  FM-TODAY EQUAL '1'                                       9915845
458376         MOVE '0' TO FM-TODAY                                     9915845
458378         MOVE 'Y' TO GL-BUILD-MASTER-SW                           9915845
458380         PERFORM K5700 THRU K5700-EXIT                            9915845
458382         PERFORM K5750-REGION-CALC THRU K5750-EXIT.               9915845
458400******************************************************************0902970
458402***  THE FOLLOWING USER EXIT MAY BE USED TO DO MASTER PROCESSING  1003625
458404***  PRIOR TO MAINLINE AFTER-POSTING PROCESSING.                  1003625
458406***                                                               1003625
458408***  COPY IM31UBWR.                                               1003625
458410***                                                               1003625
458412***  END OF USER EXIT.                                            1003625
458414******************************************************************1003625
458416*                                                                 1003625
458418* REBUILD RATE TRAILERS IF RATE POINTERS HAVE BEEN MAINTENANCED.  1003625
458419* IF A RATE MATCH IS NOT FOUND CREATE A ZERO RATE TRAILER.        1003625
458420*                                                                 1003625
458422 R0015-FM-DDA.                                                    1003625
458423     IF  FM-TO-DDA-PTR EQUAL '0'                                  1003625
458424     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      1003625
458425     AND WS-RATE-DELETED           EQUAL 'N'                      1003625
458426         GO TO R0015-FM-DDA-END.                                  1003625
458428     IF  WMS-RATE-TRLR EQUAL '0'                                  1003625
458430         MOVE '1' TO WMS-RATE-TRLR                                1003625
458431         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      1003625
458432         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   1003625
458434     MOVE 'Y' TO WMS-DDA-RATE-FLAG.                               1003625
458435     IF  WMS-LEAP-YEAR-FLG EQUAL '1'                              0817657
458436         MOVE +366 TO DAF-DAYS                                    0817657
458437     ELSE                                                         0817657
458438         MOVE +365 TO DAF-DAYS.                                   0817657
458439     IF  WMS-DAILY-RATE-CODE EQUAL '1'                            0817657
458440         MOVE +360 TO DAF-DAYS.                                   0817657
458441     IF  WMS-DAILY-RATE-CODE EQUAL '3'                            0817657
458442         MOVE +365 TO DAF-DAYS.                                   1003625
458443     IF  (WMS-HIFI-INDICATOR GREATER THAN +0)                     9915845
458444         MOVE CRT-TIER-RATES TO WMS-TIER-RATES                    9915845
458445         MOVE '3' TO WS-RATE-KEY-LEVEL                            9915845
458446         PERFORM READ-RATE-TIER THRU READ-RATE-END                9915845
458447         IF  WS-RATE-NOT-FOUND = 'Y'                              9915845
458448             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            9915845
458449             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              9915845
458450             GO TO R0015-FM-DDA-END                               9915845
458451         ELSE                                                     9915845
458452             MOVE WS-RATE-KEY-LEVEL    TO WMS-TIER-RATE-KEY-LEVEL 9915845
458453             MOVE RMA-CUR-TIERED-DT    TO WMS-TIER-CUR-DATE       9915845
458454             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-TIER-CUR-ANN(1)    9915845
458455             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-TIER-CUR-ANN(2)    9915845
458456             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-TIER-CUR-ANN(3)    9915845
458457             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-TIER-CUR-ANN(4)    9915845
458458             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-TIER-CUR-ANN(5)    9915845
458459             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-TIER-CUR-ANN(6)    9915845
458460             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-TIER-CUR-ANN(7)    9915845
458461             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-TIER-CUR-ANN(8)    9915845
458462             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-TIER-CUR-ANN(9)    9915845
458463             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-TIER-CUR-LMT(1)    9915845
458464             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-TIER-CUR-LMT(2)    9915845
458465             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-TIER-CUR-LMT(3)    9915845
458466             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-TIER-CUR-LMT(4)    9915845
458467             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-TIER-CUR-LMT(5)    9915845
458468             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-TIER-CUR-LMT(6)    9915845
458469             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-TIER-CUR-LMT(7)    9915845
458470             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-TIER-CUR-LMT(8)    9915845
458471             MOVE RMA-PREV-TIERED-DT    TO WMS-TIER-PREV-DATE     9916251
458472             MOVE RMA-PREV-TIERED-ANN(1) TO WMS-TIER-PREV-ANN(1)  9915845
458473             MOVE RMA-PREV-TIERED-ANN(2) TO WMS-TIER-PREV-ANN(2)  9915845
458474             MOVE RMA-PREV-TIERED-ANN(3) TO WMS-TIER-PREV-ANN(3)  9915845
458475             MOVE RMA-PREV-TIERED-ANN(4) TO WMS-TIER-PREV-ANN(4)  9915845
458476             MOVE RMA-PREV-TIERED-ANN(5) TO WMS-TIER-PREV-ANN(5)  9915845
458477             MOVE RMA-PREV-TIERED-ANN(6) TO WMS-TIER-PREV-ANN(6)  9915845
458478             MOVE RMA-PREV-TIERED-ANN(7) TO WMS-TIER-PREV-ANN(7)  9915845
458479             MOVE RMA-PREV-TIERED-ANN(8) TO WMS-TIER-PREV-ANN(8)  9915845
458480             MOVE RMA-PREV-TIERED-ANN(9) TO WMS-TIER-PREV-ANN(9)  9915845
458481             MOVE RMA-PREV-TIERED-LMT(1) TO WMS-TIER-PREV-LMT(1)  9915845
458482             MOVE RMA-PREV-TIERED-LMT(2) TO WMS-TIER-PREV-LMT(2)  9915845
458483             MOVE RMA-PREV-TIERED-LMT(3) TO WMS-TIER-PREV-LMT(3)  9915845
458484             MOVE RMA-PREV-TIERED-LMT(4) TO WMS-TIER-PREV-LMT(4)  9915845
458485             MOVE RMA-PREV-TIERED-LMT(5) TO WMS-TIER-PREV-LMT(5)  9915845
458486             MOVE RMA-PREV-TIERED-LMT(6) TO WMS-TIER-PREV-LMT(6)  9915845
458487             MOVE RMA-PREV-TIERED-LMT(7) TO WMS-TIER-PREV-LMT(7)  9915845
458488             MOVE RMA-PREV-TIERED-LMT(8) TO WMS-TIER-PREV-LMT(8)  9915845
458489             PERFORM CALC-TIER-CUR-DAF                            9915845
458490                THRU CALC-TIER-PREV-DAF-EXIT                      9915845
458491             PERFORM VERIFY-YR-BOUNDRY-FOR-TIER                   9915845
458492                THRU VERIFY-TIER-EXIT                             9915845
458493             GO TO R0015-FM-DFLT-IOD.                             9915845
458494                                                                  9915845
458495     IF  (WMS-IOD-RATE-PTR GREATER THAN +0)                       9915845
458496         MOVE CRT-IOD-RATES TO WMS-IOD-RATES                      9915845
458497         MOVE '3' TO WS-RATE-KEY-LEVEL                            9915845
458498         PERFORM READ-RATE-IOD THRU READ-RATE-END                 9915845
458499         IF  WS-RATE-NOT-FOUND = 'Y'                              9915845
458500             MOVE RATE-NOT-FND-NOCHG-LIT(SIWS-LANG-SUB)           0266741
458501                                    TO EX09-GEN-DESC              9915845
458502             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            9915845
458503             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              9915845
458504             GO TO R0015-FM-DDA-END                               9915845
458505         ELSE                                                     9915845
458506             MOVE WS-RATE-KEY-LEVEL TO WMS-IOD-RATE-KEY-LEVEL     9915845
458507             MOVE RMA-CUR-ILO-DT    TO WMS-IOD-CUR-DATE           9915845
458508             MOVE RMA-CUR-ILO-ANN   TO WMS-IOD-CUR-ANN            9915845
458509             MOVE RMA-PREV-ILO-DT   TO WMS-IOD-PREV-DATE          9915845
458510             MOVE RMA-PREV-ILO-ANN  TO WMS-IOD-PREV-ANN           9915845
458511             PERFORM CALC-DAF-DAYS-DDA                            9915845
458512                THRU CALC-DAF-DAYS-DDA-EXIT                       9915845
458513             PERFORM CALC-IOD-CUR-DAF THRU CALC-IOD-PREV-DAF-EXIT 9915845
458514             PERFORM VERIFY-YR-BOUNDRY-FOR-IOD                    9915845
458515                THRU VERIFY-IOD-EXIT.                             9915845
458516*                                                                 9915845
458517* FIND THE DEFAULT IOD RATE FOR ACCOUNT.                          9915845
458518*                                                                 9915845
458519 R0015-FM-DFLT-IOD.                                               9915845
458520     MOVE 'I' TO WRK-TYPE.                                        9915845
458521     MOVE 001 TO WRK-PTR.                                         9915845
458522     MOVE '3' TO WS-RATE-KEY-LEVEL.                               9915845
458523     PERFORM READ-RATE-MASTER THRU READ-RATE-END.                 9915845
458524     IF  WS-RATE-NOT-FOUND = 'Y'                                  1003625
458525         MOVE CRT-DFLT-IOD-CUR-DATA  TO WMS-DFLT-IOD-CUR-DATA     0417145
458526         MOVE CRT-DFLT-IOD-PREV-DATA TO WMS-DFLT-IOD-PREV-DATA    0417145
458527         MOVE DEF-RATE-NF-NOCHG-LIT(SIWS-LANG-SUB)                0417145
458528                                TO EX09-GEN-DESC                  9915845
458530         PERFORM R0015-RATE-REJECT THRU R0015-EXIT                9915845
458532         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  9915845
458534     ELSE                                                         9915845
458536         MOVE RMA-CUR-ILO-DT    TO WMS-DFLT-IOD-CUR-DATE          9915845
458537         MOVE RMA-CUR-ILO-ANN   TO WMS-DFLT-IOD-CUR-ANN           9915845
458538         MOVE RMA-PREV-ILO-DT   TO WMS-DFLT-IOD-PREV-DATE         9915845
458539         MOVE RMA-PREV-ILO-ANN  TO WMS-DFLT-IOD-PREV-ANN          9915845
458540         PERFORM CALC-DAF-DAYS-DDA                                1003625
458542            THRU CALC-DAF-DAYS-DDA-EXIT                           1003625
458544         PERFORM CALC-DFLT-IOD-CUR-DAF                            1003625
458546            THRU CALC-DFLT-IOD-PREV-DAF-EXIT                      1003625
458548         PERFORM VERIFY-YR-BOUNDRY-FOR-DFLT-IOD                   1003625
458550            THRU VERIFY-DFLT-IOD-EXIT.                            1003625
458552*RESET FLAGS AND CHECK NEW POINTER/RATE FOR RATE CHANGES.         1003625
458554     MOVE 'N' TO  TIER-CHG-FLG                                    1003625
458556                  IOD-CHG-FLG                                     1003625
458558                  DFLT-IOD-CHG-FLG.                               1003625
458560     MOVE ZERO TO TIER-SUB,  TIER-FUT                             1003625
458562                  IOD-SUB,   IOD-FUT                              1003625
458564                  DFLT-IOD-SUB, DFLT-IOD-FUT.                     1003625
458566     PERFORM C2101 THRU C2102A-END.                               1003625
458567 R0015-FM-DDA-END.                                                1003625
458568 R0015-FM-FED-TAX.                                                2012254
458569     IF  (FM-TO-FED-TAX-PTR EQUAL '0'                             2012254
458570     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      2012254
458571     AND WS-RATE-DELETED           EQUAL 'N')                     2012254
458572         GO TO R0015-FM-FED-TAX-END.                              2012254
458573     IF  WMS-RATE-TRLR EQUAL '0'                                  2012254
458574         MOVE '1' TO WMS-RATE-TRLR                                2012254
458575         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      2012254
458576         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   2012254
458577     MOVE 'Y' TO WMS-FED-TAX-RATE-FLAG.                           2012254
458578     IF  WMS-TAX-FED-PTR GREATER THAN +0                          2012254
458579         MOVE CRT-FED-TAX-RATES TO WMS-FED-TAX-RATES              2012254
458580         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458581         PERFORM READ-RATE-TAX-FED THRU READ-RATE-END             2012254
458582         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458583             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458584             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458585         ELSE                                                     2012254
458586             MOVE WS-RATE-KEY-LEVEL TO WMS-FED-TAX-RATE-KEY-LEVEL 2012254
458587             MOVE RMA-CUR-TIERED-DT TO WMS-FED-TAX-CUR-DATE       2012254
458588             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-FED-TAX-CUR-ANN(1) 2012254
458589             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-FED-TAX-CUR-ANN(2) 2012254
458590             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-FED-TAX-CUR-ANN(3) 2012254
458591             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-FED-TAX-CUR-ANN(4) 2012254
458592             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-FED-TAX-CUR-ANN(5) 2012254
458593             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-FED-TAX-CUR-ANN(6) 2012254
458594             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-FED-TAX-CUR-ANN(7) 2012254
458595             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-FED-TAX-CUR-ANN(8) 2012254
458596             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-FED-TAX-CUR-ANN(9) 2012254
458597             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-FED-TAX-CUR-LMT(1) 2012254
458598             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-FED-TAX-CUR-LMT(2) 2012254
458599             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-FED-TAX-CUR-LMT(3) 2012254
458600             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-FED-TAX-CUR-LMT(4) 2012254
458601             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-FED-TAX-CUR-LMT(5) 2012254
458602             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-FED-TAX-CUR-LMT(6) 2012254
458603             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-FED-TAX-CUR-LMT(7) 2012254
458604             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-FED-TAX-CUR-LMT(8) 2012254
458605             PERFORM C2101A THRU C2101A-END.                      2012254
458606 R0015-FM-FED-TAX-END.                                            2012254
458607 R0015-FM-ST-TAX.                                                 2012254
458608     IF  (FM-TO-ST-TAX-PTR EQUAL '0'                              2012254
458609     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      2012254
458610     AND WS-RATE-DELETED           EQUAL 'N')                     2012254
458611         GO TO R0015-FM-ST-TAX-END.                               2012254
458612     IF  WMS-RATE-TRLR EQUAL '0'                                  2012254
458613         MOVE '1' TO WMS-RATE-TRLR                                2012254
458614         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      2012254
458615         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   2012254
458616     MOVE 'Y' TO WMS-ST-TAX-RATE-FLAG.                            2012254
458617     IF  WMS-TAX-STATE-PTR GREATER THAN +0                        2012254
458618         MOVE CRT-ST-TAX-RATES TO WMS-ST-TAX-RATES                2012254
458619         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458620         PERFORM READ-RATE-TAX-ST THRU READ-RATE-END              2012254
458621         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458622             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458623             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458624         ELSE                                                     2012254
458625             MOVE WS-RATE-KEY-LEVEL TO WMS-ST-TAX-RATE-KEY-LEVEL  2012254
458626             MOVE RMA-CUR-TIERED-DT TO WMS-ST-TAX-CUR-DATE        2012254
458627             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-ST-TAX-CUR-ANN(1)  2012254
458628             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-ST-TAX-CUR-ANN(2)  2012254
458629             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-ST-TAX-CUR-ANN(3)  2012254
458630             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-ST-TAX-CUR-ANN(4)  2012254
458631             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-ST-TAX-CUR-ANN(5)  2012254
458632             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-ST-TAX-CUR-ANN(6)  2012254
458633             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-ST-TAX-CUR-ANN(7)  2012254
458634             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-ST-TAX-CUR-ANN(8)  2012254
458635             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-ST-TAX-CUR-ANN(9)  2012254
458636             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-ST-TAX-CUR-LMT(1)  2012254
458637             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-ST-TAX-CUR-LMT(2)  2012254
458638             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-ST-TAX-CUR-LMT(3)  2012254
458639             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-ST-TAX-CUR-LMT(4)  2012254
458640             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-ST-TAX-CUR-LMT(5)  2012254
458641             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-ST-TAX-CUR-LMT(6)  2012254
458642             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-ST-TAX-CUR-LMT(7)  2012254
458643             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-ST-TAX-CUR-LMT(8)  2012254
458644             PERFORM C2101B THRU C2101B-END.                      2012254
458645 R0015-FM-ST-TAX-END.                                             2012254
458646 R0015-FM-LOC-TAX.                                                2012254
458647     IF  (FM-TO-LOC-TAX-PTR EQUAL '0'                             2012254
458648     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      2012254
458649     AND WS-RATE-DELETED           EQUAL 'N')                     2012254
458650         GO TO R0015-FM-LOC-TAX-END.                              2012254
458651     IF  WMS-RATE-TRLR EQUAL '0'                                  2012254
458652         MOVE '1' TO WMS-RATE-TRLR                                2012254
458653         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      2012254
458654         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   2012254
458655     MOVE 'Y' TO WMS-LOC-TAX-RATE-FLAG.                           2012254
458656     IF  WMS-TAX-LOCAL-PTR GREATER THAN +0                        2012254
458657         MOVE CRT-LOC-TAX-RATES TO WMS-LOC-TAX-RATES              2012254
458658         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458659         PERFORM READ-RATE-TAX-LOC THRU READ-RATE-END             2012254
458660         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458661             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458662             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458663         ELSE                                                     2012254
458664             MOVE WS-RATE-KEY-LEVEL TO WMS-LOC-TAX-RATE-KEY-LEVEL 2012254
458665             MOVE RMA-CUR-TIERED-DT TO WMS-LOC-TAX-CUR-DATE       2012254
458666             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-LOC-TAX-CUR-ANN(1) 2012254
458667             MOVE RMA-CUR-TIERED-ANN(2) TO WMS-LOC-TAX-CUR-ANN(2) 2012254
458668             MOVE RMA-CUR-TIERED-ANN(3) TO WMS-LOC-TAX-CUR-ANN(3) 2012254
458669             MOVE RMA-CUR-TIERED-ANN(4) TO WMS-LOC-TAX-CUR-ANN(4) 2012254
458670             MOVE RMA-CUR-TIERED-ANN(5) TO WMS-LOC-TAX-CUR-ANN(5) 2012254
458671             MOVE RMA-CUR-TIERED-ANN(6) TO WMS-LOC-TAX-CUR-ANN(6) 2012254
458672             MOVE RMA-CUR-TIERED-ANN(7) TO WMS-LOC-TAX-CUR-ANN(7) 2012254
458673             MOVE RMA-CUR-TIERED-ANN(8) TO WMS-LOC-TAX-CUR-ANN(8) 2012254
458674             MOVE RMA-CUR-TIERED-ANN(9) TO WMS-LOC-TAX-CUR-ANN(9) 2012254
458675             MOVE RMA-CUR-TIERED-LMT(1) TO WMS-LOC-TAX-CUR-LMT(1) 2012254
458676             MOVE RMA-CUR-TIERED-LMT(2) TO WMS-LOC-TAX-CUR-LMT(2) 2012254
458677             MOVE RMA-CUR-TIERED-LMT(3) TO WMS-LOC-TAX-CUR-LMT(3) 2012254
458678             MOVE RMA-CUR-TIERED-LMT(4) TO WMS-LOC-TAX-CUR-LMT(4) 2012254
458679             MOVE RMA-CUR-TIERED-LMT(5) TO WMS-LOC-TAX-CUR-LMT(5) 2012254
458680             MOVE RMA-CUR-TIERED-LMT(6) TO WMS-LOC-TAX-CUR-LMT(6) 2012254
458681             MOVE RMA-CUR-TIERED-LMT(7) TO WMS-LOC-TAX-CUR-LMT(7) 2012254
458682             MOVE RMA-CUR-TIERED-LMT(8) TO WMS-LOC-TAX-CUR-LMT(8) 2012254
458683             PERFORM C2101C THRU C2101C-END.                      2012254
458684 R0015-FM-LOC-TAX-END.                                            2012254
458716 R0015-FM-LN.                                                     2012254
458717     IF  (FM-TO-LN-PTR EQUAL '0'                                  2012254
458718     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      2012254
458719     AND WS-RATE-DELETED           EQUAL 'N')                     2012254
458720     OR  (WMS-LOAN-TRLR EQUAL '0')                                2012254
458721         GO TO R0015-FM-LN-END.                                   2012254
458722     IF  WMS-RATE-TRLR EQUAL '0'                                  2012254
458723         MOVE '1' TO WMS-RATE-TRLR                                2012254
458724         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      2012254
458725         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   2012254
458726     MOVE 'Y' TO WMS-LN-RATE-FLAG.                                2012254
458727     PERFORM CALC-DAF-DAYS-LOAN THRU CALC-DAF-DAYS-LOAN-EXIT.     2012254
458728     IF  WMS-INT-RATE-PTR EQUAL +6 OR +7                          2012254
458729         MOVE CRT-PRM-RATE TO WMS-PRM-RATE                        2012254
458730         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458731         PERFORM READ-RATE-PRIME THRU READ-RATE-END               2012254
458732         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458733             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458734             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458735         ELSE                                                     2012254
458736             MOVE WS-RATE-KEY-LEVEL   TO WMS-LN-RATE-KEY-LEVEL    2012254
458737             MOVE RMA-CUR-PRIME-DT        TO WMS-PRM-CUR-DATE     2012254
458738             MOVE RMA-CUR-PRIME-ANN       TO WMS-PRM-CUR-ANN      2012254
458739             MOVE ZEROS                   TO WMS-PRM-CUR-DAF      2012254
458740             MOVE RMA-CUR-PRIME-ADJ-CODE  TO WMS-PRM-CUR-ADC      2012254
458741             MOVE RMA-CUR-PRIME-BAL-CALC  TO WMS-PRM-CUR-BCL      2012254
458742             MOVE RMA-CUR-PRIME-ADJ(1)    TO WMS-PRM-CUR-ADJ(1)   2012254
458743             MOVE RMA-CUR-PRIME-ADJ(2)    TO WMS-PRM-CUR-ADJ(2)   2012254
458744             MOVE RMA-CUR-PRIME-ADJ(3)    TO WMS-PRM-CUR-ADJ(3)   2012254
458745             MOVE RMA-CUR-PRIME-ADJ(4)    TO WMS-PRM-CUR-ADJ(4)   2012254
458746             MOVE RMA-CUR-PRIME-ADJ(5)    TO WMS-PRM-CUR-ADJ(5)   2012254
458747             MOVE RMA-CUR-PRIME-LMT(1)    TO WMS-PRM-CUR-LMT(1)   2012254
458748             MOVE RMA-CUR-PRIME-LMT(2)    TO WMS-PRM-CUR-LMT(2)   2012254
458749             MOVE RMA-CUR-PRIME-LMT(3)    TO WMS-PRM-CUR-LMT(3)   2012254
458750             MOVE RMA-CUR-PRIME-LMT(4)    TO WMS-PRM-CUR-LMT(4)   2012254
458751             MOVE RMA-PREV-PRIME-DT       TO WMS-PRM-PREV-DATE    2012254
458752             MOVE RMA-PREV-PRIME-ANN      TO WMS-PRM-PREV-ANN     2012254
458753             MOVE ZEROS                   TO WMS-PRM-PREV-DAF     2012254
458754             MOVE RMA-PREV-PRIME-ADJ-CODE TO WMS-PRM-PREV-ADC     2012254
458755             MOVE RMA-PREV-PRIME-BAL-CALC TO WMS-PRM-PREV-BCL     2012254
458756             MOVE RMA-PREV-PRIME-ADJ(1)   TO WMS-PRM-PREV-ADJ(1)  2012254
458757             MOVE RMA-PREV-PRIME-ADJ(2)   TO WMS-PRM-PREV-ADJ(2)  2012254
458758             MOVE RMA-PREV-PRIME-ADJ(3)   TO WMS-PRM-PREV-ADJ(3)  2012254
458759             MOVE RMA-PREV-PRIME-ADJ(4)   TO WMS-PRM-PREV-ADJ(4)  2012254
458760             MOVE RMA-PREV-PRIME-ADJ(5)   TO WMS-PRM-PREV-ADJ(5)  2012254
458761             MOVE RMA-PREV-PRIME-LMT(1)   TO WMS-PRM-PREV-LMT(1)  2012254
458762             MOVE RMA-PREV-PRIME-LMT(2)   TO WMS-PRM-PREV-LMT(2)  2012254
458763             MOVE RMA-PREV-PRIME-LMT(3)   TO WMS-PRM-PREV-LMT(3)  2012254
458764             MOVE RMA-PREV-PRIME-LMT(4)   TO WMS-PRM-PREV-LMT(4)  2012254
458765             PERFORM CALC-LOAN-CUR-DAF                            2012254
458766                THRU CALC-LOAN-PREV-DAF-EXIT                      2012254
458767             PERFORM VERIFY-YR-BOUNDRY-FOR-PRIME                  2012254
458768                THRU VERIFY-PRIME-EXIT                            2012254
458769     ELSE                                                         2012254
458770     IF  WMS-INT-RATE-PTR GREATER THAN +0                         2012254
458771         MOVE CRT-LN-RATES TO WMS-LN-RATES                        2012254
458775         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458776         PERFORM READ-RATE-LOAN THRU READ-RATE-END                2012254
458777         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458778             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458779             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458780         ELSE                                                     2012254
458781             MOVE WS-RATE-KEY-LEVEL TO WMS-LN-RATE-KEY-LEVEL      2012254
458782             MOVE RMA-CUR-ILO-DT    TO WMS-LN-CUR-DATE            2012254
458783             MOVE RMA-CUR-ILO-ANN   TO WMS-LN-CUR-ANN             2012254
458784             MOVE RMA-PREV-ILO-DT   TO WMS-LN-PREV-DATE           2012254
458785             MOVE RMA-PREV-ILO-ANN  TO WMS-LN-PREV-ANN            2012254
458786             PERFORM CALC-LOAN-CUR-DAF                            2012254
458787                THRU CALC-LOAN-PREV-DAF-EXIT                      2012254
458788             PERFORM VERIFY-YR-BOUNDRY-FOR-LOAN                   2012254
458789                THRU VERIFY-LOAN-EXIT                             2012254
458790             MOVE WMS-LN-CUR-ANN    TO WMS-ANNUAL-RATE            2012254
458791             MOVE WMS-LN-CUR-DAF    TO WMS-DAILY-RATE             2012254
458792             PERFORM C2302 THRU C2304-EXIT                        2012254
458793             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE   0266741
458794     ELSE                                                         2012254
458795     IF  WMS-SPLIT-RATE-SCHD GREATER THAN +0                      2012254
458796         MOVE CRT-SPL-RATES TO WMS-SPL-RATES                      2012254
458797         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458798         PERFORM READ-RATE-SPLIT THRU READ-RATE-END               2012254
458799         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458800             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458801             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458802         ELSE                                                     2012254
458803             MOVE WS-RATE-KEY-LEVEL   TO WMS-SPL-RATE-KEY-LEVEL   2012254
458804             MOVE RMA-CUR-SPLIT-DT    TO WMS-SPL-CUR-DATE         2012254
458805             MOVE RMA-CUR-SPLIT-ANN(1) TO WMS-SPL-CUR-ANN(1)      2012254
458806             MOVE RMA-CUR-SPLIT-ANN(2) TO WMS-SPL-CUR-ANN(2)      2012254
458807             MOVE RMA-CUR-SPLIT-ANN(3) TO WMS-SPL-CUR-ANN(3)      2012254
458808             MOVE RMA-CUR-SPLIT-LMT(1) TO WMS-SPL-CUR-LMT(1)      2012254
458809             MOVE RMA-CUR-SPLIT-LMT(2) TO WMS-SPL-CUR-LMT(1)      2012254
458810             MOVE RMA-PREV-SPLIT-DT   TO WMS-SPL-PREV-DATE        2012254
458811             MOVE RMA-PREV-SPLIT-ANN(1) TO WMS-SPL-PREV-ANN(1)    2012254
458812             MOVE RMA-PREV-SPLIT-ANN(2) TO WMS-SPL-PREV-ANN(2)    2012254
458813             MOVE RMA-PREV-SPLIT-ANN(3) TO WMS-SPL-PREV-ANN(3)    2012254
458814             MOVE RMA-PREV-SPLIT-LMT(1) TO WMS-SPL-PREV-LMT(1)    2012254
458815             MOVE RMA-PREV-SPLIT-LMT(2) TO WMS-SPL-PREV-LMT(2)    2012254
458816             PERFORM CALC-LOAN-CUR-DAF                            2012254
458817                THRU CALC-LOAN-PREV-DAF-EXIT                      2012254
458818             PERFORM VERIFY-YR-BOUNDRY-FOR-SPLIT                  2012254
458819                THRU VERIFY-SPLIT-EXIT                            2012254
458820             MOVE WMS-SPL-CUR-ANN (1)    TO WMS-RATE1-ANNUAL      2012254
458821             MOVE WMS-SPL-CUR-DAF (1)    TO WMS-RATE1-DAILY       2012254
458822             MOVE WMS-SPL-CUR-ANN (2)    TO WMS-RATE2-ANNUAL      2012254
458823             MOVE WMS-SPL-CUR-DAF (2)    TO WMS-RATE2-DAILY       2012254
458824             MOVE WMS-SPL-CUR-ANN (3)    TO WMS-RATE3-ANNUAL      2012254
458825             MOVE WMS-SPL-CUR-DAF (3)    TO WMS-RATE3-DAILY       2012254
458826             MOVE WMS-SPL-CUR-LMT (1)    TO WMS-RATE1-LIMIT       2012254
458827             MOVE WMS-SPL-CUR-LMT (2)    TO WMS-RATE2-LIMIT       2012254
458828             PERFORM C2302 THRU C2302-EXIT                        2012254
458829             PERFORM C2306 THRU C2306-EXIT                        2012254
458830             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE.  0266741
458831*RESET FLAGS AND CHECK NEW POINTER/RATE FOR RATE CHANGES.         2012254
458832     MOVE 'N' TO  LOAN-CHG-FLG                                    2012254
458833                  PRIME-CHG-FLG                                   2012254
458834                  SPLIT-CHG-FLG.                                  2012254
458835     MOVE ZERO TO LOAN-SUB,  LOAN-FUT                             2012254
458836                  PRIME-SUB, PRIME-FUT                            2012254
458837                  SPLIT-SUB, SPLIT-FUT.                           2012254
458838     PERFORM C2105 THRU C2107-END.                                2012254
458839 R0015-FM-LN-END.                                                 2012254
458840                                                                  2012254
458841 R0015-FM-PREV-LN.                                                2012254
458842     IF  (FM-TO-PREV-LN-PTR EQUAL '0'                             2012254
458843     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      2012254
458844     AND WS-RATE-DELETED           EQUAL 'N')                     2012254
458845     OR  (WMS-LOAN-TRLR EQUAL '0')                                2012254
458846         GO TO R0015-FM-PREV-LN-END.                              2012254
458847     IF  WMS-RATE-TRLR EQUAL '0'                                  2012254
458848         MOVE '1' TO WMS-RATE-TRLR                                2012254
458849         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      2012254
458850         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   2012254
458851     MOVE 'Y' TO WMS-LN-RATE-FLAG.                                2012254
458852     PERFORM CALC-DAF-DAYS-LOAN THRU CALC-DAF-DAYS-LOAN-EXIT.     2012254
458853     IF  WMS-PREV-INT-PTR GREATER THAN +0                         2012254
458854         MOVE CRT-LN-OLD-RATES TO WMS-LN-OLD-RATES                2012254
458855         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458856         PERFORM READ-RATE-LOAN-PREV THRU READ-RATE-END           2012254
458857         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458858             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458859             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458860         ELSE                                                     2012254
458861             MOVE WS-RATE-KEY-LEVEL TO WMS-LN-OLD-RATE-KEY-LEVEL  2012254
458862             MOVE RMA-CUR-ILO-DT    TO WMS-LN-OLD-CUR-DATE        2012254
458863             MOVE RMA-CUR-ILO-ANN   TO WMS-LN-OLD-CUR-ANN         2012254
458864             MOVE RMA-PREV-ILO-DT   TO WMS-LN-OLD-PREV-DATE       2012254
458865             MOVE RMA-PREV-ILO-ANN  TO WMS-LN-OLD-PREV-ANN        2012254
458866             PERFORM CALC-LOAN-OLD-CUR-DAF                        2012254
458867                THRU CALC-LOAN-OLD-PREV-DAF-EXIT                  2012254
458868             PERFORM VERIFY-YR-BOUNDRY-FOR-OLD-LOAN               2012254
458869                THRU VERIFY-OLD-LOAN-EXIT                         2012254
458870             MOVE WMS-LN-OLD-CUR-ANN     TO WMS-PREV-ANNUAL       2012254
458871             MOVE WMS-LN-OLD-CUR-DAF     TO WMS-PREV-DAILY        2012254
458872             MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-RATE-CHANGE   0266741
458873     ELSE                                                         2012254
458874     IF  WMS-PREV-SPLIT-RATE-PTR GREATER THAN +0                  2012254
458875         MOVE CRT-SPL-OLD-RATES TO WMS-SPL-OLD-RATES              2012254
458876         MOVE '3' TO WS-RATE-KEY-LEVEL                            2012254
458877         PERFORM READ-RATE-SPLIT-PREV THRU READ-RATE-END          2012254
458878         IF  WS-RATE-NOT-FOUND = 'Y'                              2012254
458879             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            2012254
458880             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              2012254
458881         ELSE                                                     2012254
458882             MOVE WS-RATE-KEY-LEVEL TO WMS-SPL-OLD-RATE-KEY-LEVEL 2012254
458883             MOVE RMA-CUR-SPLIT-DT    TO WMS-SPL-OLD-CUR-DATE     2012254
458884             MOVE RMA-CUR-SPLIT-ANN(1) TO WMS-SPL-OLD-CUR-ANN(1)  2012254
458885             MOVE RMA-CUR-SPLIT-ANN(2) TO WMS-SPL-OLD-CUR-ANN(2)  2012254
458886             MOVE RMA-CUR-SPLIT-ANN(3) TO WMS-SPL-OLD-CUR-ANN(3)  2012254
458887             MOVE RMA-CUR-SPLIT-LMT(1) TO WMS-SPL-OLD-CUR-LMT(1)  2012254
458888             MOVE RMA-CUR-SPLIT-LMT(2) TO WMS-SPL-OLD-CUR-LMT(2)  2012254
458889             MOVE RMA-PREV-SPLIT-DT   TO WMS-SPL-OLD-PREV-DATE    2012254
458890             MOVE RMA-PREV-SPLIT-ANN(1) TO WMS-SPL-OLD-PREV-ANN(1)2012254
458891             MOVE RMA-PREV-SPLIT-ANN(2) TO WMS-SPL-OLD-PREV-ANN(2)2012254
458892             MOVE RMA-PREV-SPLIT-ANN(3) TO WMS-SPL-OLD-PREV-ANN(3)2012254
458893             MOVE RMA-PREV-SPLIT-LMT(1) TO WMS-SPL-OLD-PREV-LMT(1)2012254
458894             MOVE RMA-PREV-SPLIT-LMT(2) TO WMS-SPL-OLD-PREV-LMT(2)2012254
458895             PERFORM CALC-LOAN-OLD-CUR-DAF                        2012254
458896                THRU CALC-LOAN-OLD-PREV-DAF-EXIT                  2012254
458897             PERFORM VERIFY-YR-BOUNDRY-FOR-OLD-SPL                2012254
458898                THRU VERIFY-OLD-SPLIT-EXIT.                       2012254
458899*RESET FLAGS AND CHECK NEW POINTER/RATE FOR RATE CHANGES.         2012254
458900     MOVE 'N' TO  PREV-LOAN-CHG-FLG                               2012254
458901                  PREV-SPLIT-CHG-FLG.                             2012254
458902     MOVE ZERO TO PREV-LOAN-SUB,  PREV-LOAN-FUT                   2012254
458903                  PREV-SPLIT-SUB, PREV-SPLIT-FUT.                 2012254
458904     PERFORM C2108 THRU C2109-END.                                2012254
458905 R0015-FM-PREV-LN-END.                                            2012254
458910 R0015-FM-SAV.                                                    0316967
458911     IF  (FM-TO-SAV-PTR EQUAL '0' AND FM-TO-SAV-TIER-PTR EQUAL '0'0316967
458912     AND WS-RATE-REGION-KEY-CHANGE EQUAL 'N'                      0316967
458913     AND WS-RATE-DELETED           EQUAL 'N')                     0316967
458914     OR  (WMS-SAVINGS-TRLR EQUAL '0')                             0316967
458915         GO TO R0015-FM-SAV-END.                                  0316967
458916     IF  WMS-RATE-TRLR EQUAL '0'                                  0316967
458917         MOVE '1' TO WMS-RATE-TRLR                                0316967
458918         ADD WS-TRL-RATE-LNGTH TO WMS-LENGTH                      0316967
458919         MOVE CRT-RATE-TRAILER-FLAGS TO WMS-RATE-TRAILER-FLAGS.   0316967
458920     MOVE 'Y' TO WMS-SAV-RATE-FLAG.                               0316967
458921     IF  WMS-INT-RATE GREATER THAN +0                             0316967
458922     AND WMS-SAV-TIER-PTR EQUAL +0                                0316967
458923         MOVE CRT-SAV-RATES TO WMS-SAV-RATES                      0316967
458924         MOVE '3' TO WS-RATE-KEY-LEVEL                            0316967
458925         PERFORM READ-RATE-SAV THRU READ-RATE-END                 0316967
458926         IF  WS-RATE-NOT-FOUND = 'Y'                              0316967
458927             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            0316967
458928             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              0316967
458929         ELSE                                                     0316967
458930             MOVE WS-RATE-KEY-LEVEL TO WMS-SAV-RATE-KEY-LEVEL     0316967
458931             MOVE RMA-CUR-ILO-DT    TO WMS-SAV-CUR-DATE           0316967
458932             MOVE RMA-CUR-ILO-ANN   TO WMS-SAV-CUR-ANN            0316967
458933             MOVE RMA-PREV-ILO-DT   TO WMS-SAV-PREV-DATE          0316967
458934             MOVE RMA-PREV-ILO-ANN  TO WMS-SAV-PREV-ANN           0316967
458935             PERFORM CALC-DAF-DAYS-SAV                            0316967
458936                THRU CALC-DAF-DAYS-SAV-EXIT                       0316967
458937             PERFORM CALC-SAV-CUR-DAF THRU CALC-SAV-PREV-DAF-EXIT 0316967
458938             PERFORM VERIFY-YR-BOUNDRY-FOR-SAV                    0316967
458939                THRU VERIFY-SAV-EXIT                              0316967
458940             PERFORM C2103 THRU C2103-END.                        0316967
458943     IF  WMS-SAV-TIER-PTR GREATER THAN +0                         0316967
458944         MOVE CRT-SAV-RATES TO WMS-SAV-RATES                      0316967
458945         MOVE '3' TO WS-RATE-KEY-LEVEL                            0316967
458946         PERFORM READ-RATE-SAV-TIER THRU READ-RATE-END            0316967
458947         IF  WS-RATE-NOT-FOUND = 'Y'                              0316967
458948             PERFORM R0015-RATE-REJECT THRU R0015-EXIT            0316967
458949             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT              0316967
458950         ELSE                                                     0316967
458951             MOVE WS-RATE-KEY-LEVEL TO WMS-SAV-RATE-KEY-LEVEL     0316967
458952             MOVE RMA-CUR-TIERED-DT TO WMS-SAV-CUR-DATE           0316967
458953             MOVE RMA-CUR-TIERED-ANN(1) TO WMS-SAV-CUR-ANN        0316967
458954             MOVE RMA-PREV-TIERED-DT TO WMS-SAV-PREV-DATE         0316967
458955             MOVE RMA-PREV-TIERED-ANN(1) TO WMS-SAV-PREV-ANN      0316967
458956             PERFORM CALC-DAF-DAYS-SAV                            0316967
458957                THRU CALC-DAF-DAYS-SAV-EXIT                       0316967
458958             PERFORM CALC-SAV-CUR-DAF THRU CALC-SAV-PREV-DAF-EXIT 0316967
458959             PERFORM VERIFY-YR-BOUNDRY-FOR-SAV                    0316967
458960                THRU VERIFY-SAV-EXIT                              0316967
458961             PERFORM C2103A THRU C2103A-END.                      0316967
458962 R0015-FM-SAV-END.                                                0316967
458965 R0015-FM-OD.                                                     0316967
458966*                                                                 0316967
458967     COPY IMPDODFM.                                               0316967
458968*                                                                 0316967
458969*RESET FLAGS AND CHECK NEW POINTER/RATE FOR RATE CHANGES.         0316967
458970*                                                                 0316967
458971     MOVE 'N' TO OD-CHG-FLG          OD-TRLR-CHG-FLG (1)          0316967
458972                 OD-TRLR-CHG-FLG (2) OD-TRLR-CHG-FLG (3)          0316967
458973                 OD-TRLR-CHG-FLG (4) OD-TRLR-CHG-FLG (5)          0316967
458974                 OD-TRLR-CHG-FLG (6) OD-TRLR-CHG-FLG (7)          0316967
458975                 OD-TRLR-CHG-FLG (8) OD-TRLR-CHG-FLG (9).         0316967
458985*                                                                 9915856
458990     MOVE ZERO                   TO OD-SUB                        9915856
458995                                    OD-FUT                        9915856
459000                                    OD-TRLR-SUB (1)               9915856
459005                                    OD-TRLR-FUT (1)               9915856
459010                                    OD-TRLR-SUB (2)               9915856
459015                                    OD-TRLR-FUT (2)               9915856
459020                                    OD-TRLR-SUB (3)               9915856
459025                                    OD-TRLR-FUT (3)               9915856
459030                                    OD-TRLR-SUB (4)               9915856
459035                                    OD-TRLR-FUT (4)               9915856
459040                                    OD-TRLR-SUB (5)               9915856
459045                                    OD-TRLR-FUT (5)               9915856
459050                                    OD-TRLR-SUB (6)               9915856
459055                                    OD-TRLR-FUT (6)               9915856
459060                                    OD-TRLR-SUB (7)               9915856
459065                                    OD-TRLR-FUT (7)               9915856
459070                                    OD-TRLR-SUB (8)               9915856
459075                                    OD-TRLR-FUT (8)               9915856
459080                                    OD-TRLR-SUB (9)               9915856
459085                                    OD-TRLR-FUT (9).              9915856
459087*                                                                 9915856
459088     PERFORM C2104 THRU C2104-END.                                1003625
459089*                                                                 9915856
459090 R0015-FM-OD-END.                                                 1003625
459091                                                                  1003625
459092 R0015-FM-END.                                                    1105527
459093     GO TO R0018.                                                 1105527
459100*                                                                 1003625
459105* CREATE AN EXCEPTION THAT WILL SHOW UP ON THE REJECT JOURNAL,    1003625
459110* BECAUSE IT IS GENERATED INTERNALLY IT WILL NOT HAVE TRAN INFO.  1003625
459115 R0015-RATE-REJECT.                                               1003625
459120     MOVE SPACES  TO IMEX-REC-09.                                 1003625
459125     MOVE ZEROES  TO EX09-BATCH                                   1003625
459130                     EX09-SEQ                                     1003625
459135                     EX09-TRACE.                                  1003625
459140     MOVE '09'    TO RECNO.                                       1003625
459145     MOVE 'D0D3'  TO EXCODE.                                      1003625
459150     MOVE '31'    TO REJPROG.                                     1003625
459155     MOVE '060'    TO REJRESN.                                    0717565
459160     MOVE EX-INFO TO IMEX-INFO.                                   1003625
459165     MOVE SPACES  TO EX-INFO.                                     1003625
459170 R0015-EXIT.                                                      1003625
459175     EXIT.                                                        1003625
459180*                                                                 1003625
459230 R0018.                                                           1003625
459235     MOVE 'N' TO WS-RATE-REGION-KEY-CHANGE.                       1003625
459240*                                                                 1003625
459250 R0020.
459251*    **********************************************************   9915845
459252*    *  SKIP PROCESSING IF ACCT IS A DUMMY INTERBRANCH TRNSFR.*   9915845
459253*    *  DELETE THE NEW IBT IF NOT CONFIRMED NEXT DAY.         *   9915845
459254*    *  RESET THE OLD IBT ACCT IF NOT CONFIRMED NEXT DAY.     *   9915845
459255*    **********************************************************   9915845
459258     IF  IBT-NEW-FLAG EQUAL '1'                                   9915845
459260         MOVE '0' TO IBT-NEW-FLAG                                 9915845
459266         GO  TO  S2500.                                           9915845
459272     IF  IBT-ACCT-IND EQUAL '1'                                   9915845
459274     AND WMS-IBT-FLAG EQUAL '3'                                   9915857
459275         MOVE  '0' TO IBT-ACCT-IND, SAVE-IBT-FLG                  9915857
459276         MOVE '99' TO WMS-STATUS                                  9915857
459278         MOVE '44' TO IMEX-REC-NO                                 9915845
459280         MOVE 'IB' TO IMEX-CODE-1                                 9915845
459282         MOVE 'IM' TO IMEX-CODE-2                                 9915845
459283         MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20          9915845
459284         MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                       9915845
459285         MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT          9915845
459286         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  9915857
459287         MOVE 'D' TO I-O-CONTROL-OPERATOR                         9915857
459288         CALL 'IMACTM' USING I-O-CONTROL-AREA                     9915857
459289                             MASTER-AREA                          9915857
459290                             SI-ENVIRONMENT-AREA                  9915857
459291         IF  SI-88-ENVIRONMENT-ONLINE                             9915857
459292             MOVE  'D'       TO  I-O-CONTROL-OPERATOR             9915857
459293             CALL  'IMALPHA'                                      9915857
459294                          USING  I-O-CONTROL-AREA                 9915857
459295                                 SI-ENVIRONMENT-AREA              9915857
459296                                 MASTER-AREA                      9915857
459297                                 WBC-ONLINE-ALPHA-RECORD          0266741
459298             GO  TO  C0500                                        9915857
459299         ELSE                                                     9915857
459300             GO  TO  C0500.                                       9915857
459301     IF  IBT-ACCT-IND EQUAL '1'                                   9915857
459302     AND WMS-IBT-FLAG EQUAL '1'                                   9915857
459303         PERFORM X1100-RESET-IBT THRU X1100-EXIT.                 9915857
459310     IF WMS-STATUS       EQUAL       '99'                         9915857
459320         MOVE  '0' TO IBT-ACCT-IND, SAVE-IBT-FLG                  9915857
459350         IF WMS-CURR-BAL EQUAL       ZERO
459400         AND WMS-IOD-CYC-ACC-INT     EQUAL  ZERO
459450         AND WMS-IOD-YTD-INT-PAID    EQUAL  ZERO
459460         AND (WBC-RUN-FLAG           NOT EQUAL 'I')               0266741
459465         AND ((WMS-DUAL-YEAR-TRLR     EQUAL '0')                  9915858
459470         OR  (WMS-DUAL-YEAR-TRLR      EQUAL '1'                   9915858
459475         AND  WMS-DUAL-YR-CUR-IOD-INT EQUAL ZERO                  9915858
459480         AND  WMS-DUAL-YR-CUR-SAV-INT EQUAL ZERO))                9915858
459500             ADD  +1     TO  DDA-DROP-ACCTS, WS-GL-DDA-DROP-ACCTS 0902970
459510             MOVE '17'   TO  IMEX-REC-NO                          0326947
459520             MOVE 'SX'   TO  IMEX-CODE-1                          0326947
459530             MOVE '  '   TO  IMEX-CODE-2                          0326947
459540             PERFORM WRITE-EX-MST THRU WRITE-EXIT1                0326947
459550             IF WMS-IOD-RATE-PTR     GREATER THAN ZERO
459600             OR  WMS-HIFI-INDICATOR  GREATER THAN ZERO
459650                 ADD  +1  TO IOD-DROP-ACCTS, WS-GL-IOD-DROP-ACCTS 0902970
459700                 MOVE 'D'        TO  I-O-CONTROL-OPERATOR
459750                 CALL 'IMACTM' USING I-O-CONTROL-AREA
459800                                     MASTER-AREA
459850                                     SI-ENVIRONMENT-AREA
459900                 IF  SI-88-ENVIRONMENT-ONLINE
460250                     MOVE  'D'       TO  I-O-CONTROL-OPERATOR
460300                     CALL  'IMALPHA'
460350                                  USING  I-O-CONTROL-AREA
460370                                         SI-ENVIRONMENT-AREA      IM003
460400                                         MASTER-AREA
460420                                         WBC-ONLINE-ALPHA-RECORD  0266741
460450                     GO TO C0500
460500                 ELSE
460550                     GO TO C0500
460600             ELSE
460650                 MOVE 'D' TO I-O-CONTROL-OPERATOR
460700                 CALL 'IMACTM' USING I-O-CONTROL-AREA
460750                                     MASTER-AREA
460800                                     SI-ENVIRONMENT-AREA
460850                 IF  SI-88-ENVIRONMENT-ONLINE
461200                     MOVE  'D'       TO  I-O-CONTROL-OPERATOR
461250                     CALL  'IMALPHA'
461300                                  USING  I-O-CONTROL-AREA
461320                                         SI-ENVIRONMENT-AREA      IM003
461350                                         MASTER-AREA
461370                                         WBC-ONLINE-ALPHA-RECORD  0266741
461400                     GO TO C0500
461450                 ELSE
461500                     GO TO C0500
461550         ELSE
461600             MOVE '05' TO WMS-STATUS
461650             IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
461700                 MOVE 'SU' TO IMEX-CODE-1
461750                 MOVE 'SD' TO IMEX-CODE-2
461800                 MOVE '09' TO IMEX-REC-NO
461850                 MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
461900                 MOVE '05' TO EX09-STATUS-OUT,
461950                              WK-IM-STATUS-IN
461952                 MOVE WMS-REASON-CLOSED TO EX09-GEN-REASON        IMIB004
462000                 MOVE WMS-CURR-BAL TO EX09-CUR-BAL
462050                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
462100     IF  WMS-EXPANSION-IND EQUAL TO '0'                           9915845
462110         IF  (IBT-ACCT-IND EQUAL TO '2' OR '3')                   9915845
462120             GO TO R1200                                          9915845
462130         ELSE                                                     9915845
462140             GO TO R1100.                                         9915845
462150     IF  WMS-DC-TRLR EQUAL TO '1'
462200         IF  WMS-DC-DELETE EQUAL TO '9'
462250             SUBTRACT WMS-DC-TRLR-LENGTH FROM WMS-LENGTH
462300             MOVE '0' TO WMS-DC-TRLR.
462350     IF WMS-MARKET-TRLR EQUAL TO '1'
462400         IF WMS-MARKET-DELETE EQUAL TO '9'
462450             SUBTRACT WS-TRL-MRKTNG-LNGTH FROM WMS-LENGTH         0903291
462500             MOVE '0' TO WMS-MARKET-TRLR.
462550     IF WMS-TARGET-AMT-TRLR EQUAL TO '1'
462600         IF WMS-TARGET-DELETE EQUAL TO '9'
462650             SUBTRACT WS-TRL-TARGT-BAL-LNGTH FROM WMS-LENGTH      0903291
462700             MOVE '0' TO WMS-TARGET-AMT-TRLR.
462750     IF WMS-SAVINGS-TRLR EQUAL TO '1'
462800         IF WMS-INT-STATUS EQUAL TO '9'
462850             SUBTRACT WS-TRL-SAVINGS-LNGTH FROM WMS-LENGTH        0903291
462950             MOVE '0' TO WMS-SAVINGS-TRLR                         1004554
462952             MOVE 'N' TO WMS-SAV-RATE-FLAG                        1003625
462955             IF  WMS-INVESTMENT-TRLR EQUAL '0'                    1004554
462960                 ADD +1 TO SAV-TERM, WS-GL-SAV-TERM               1004554
462965             ELSE                                                 1004554
462970                 MOVE '0' TO WMS-INVESTMENT-TRLR                  1004554
462975                 SUBTRACT WS-TRL-INVEST-LNGTH FROM WMS-LENGTH     1004554
462980                 IF  WMS-INV-SVC-ACCRD-CYC GREATER THAN ZERO      1004554
462985                     ADD +.005 WMS-INV-SVC-ACCRD-CYC              1004554
462990                         GIVING HOLD-SVC-FEE1                     1004554
462995                     SUBTRACT HOLD-SVC-FEE1 FROM INV-SVC-ADJ-INTL 1004554
462999                                           WS-GL-INV-SVC-ADJ-INTL.1004554
463000     IF WMS-LOAN-TRLR EQUAL TO '1'
463050         IF WMS-LOAN-STATUS EQUAL TO '9'
463100             SUBTRACT WS-TRL-LOAN-LNGTH FROM WMS-LENGTH           0903291
463150             ADD +1 TO LOAN-TERM, WS-GL-LOAN-TERM                 0902970
463200             MOVE '0' TO WMS-LOAN-TRLR                            1003625
463210             MOVE 'N' TO WMS-LN-RATE-FLAG.                        1003625
463250     IF WMS-LIMIT-TRANSFER EQUAL TO '1'
463300         IF WMS-LIMIT-TRAN-DELETE EQUAL TO '9'
463350             SUBTRACT WS-TRL-LMT-TRNFR-LNGTH FROM WMS-LENGTH      0903291
463400             MOVE '0' TO WMS-LIMIT-TRANSFER.
463405**** CANNOT HAVE EXTENDED FLOAT RECORD WITH CASH AVAIL TRLR       0927817
463410     IF  WBC-EXTEND-FLOAT-OPT EQUAL '1' OR '2' OR '3'             0927817
463415         IF  AFF-FLAG         EQUAL 'N'                           0927817
463420         AND AFF-MAX-ENTRY  GREATER THAN +12                      0927817
463425         AND WMS-CASH-AVAIL-TRLR EQUAL '1'                        0927817
463430             MOVE '0'            TO WMS-CASH-AVAIL-FLAG           0927817
463435             MOVE '0'            TO WMS-CASH-AVAIL-TRLR           0927817
463440             SUBTRACT WS-TRL-CSH-AVAIL-LNGTH FROM WMS-LENGTH      0927817
463445             MOVE ZEROS          TO WMS-CASH-AVAIL-AMT.           0927817
463450     IF WMS-SOC-SEC-NA EQUAL TO '1'
463500         IF WMS-SSN-DELETE EQUAL TO '9'
463550             SUBTRACT WS-TRL-SOC-SEC-LNGTH FROM WMS-LENGTH        0903291
463600             MOVE '0' TO WMS-SOC-SEC-NA.
463650     IF  WMS-DCD-TAX-DATA-TRLR EQUAL '1'
463700         IF  WMS-DCD-STATUS EQUAL '9'
463750             SUBTRACT WS-TRL-DEC-TAX-LNGTH FROM WMS-LENGTH        0903291
463800             MOVE '0' TO WMS-DCD-TAX-DATA-TRLR.
463850     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
463900         IF  WMS-OD-STATUS EQUAL '9'
463950             SUBTRACT WS-TRL-OD-ACRUAL-LNGTH FROM WMS-LENGTH      0903291
464000             MOVE '0' TO WMS-OD-ACCRUAL-TRLR                      1003625
464010             MOVE 'N' TO WMS-OD-RATE-FLAG.                        1003625
464050     IF  WMS-INFO-TRLR EQUAL '1'
464100         IF  WMS-INFO-DELETE EQUAL '9'
464150             SUBTRACT WS-TRL-INFO-LNGTH FROM WMS-LENGTH           0903291
464200             MOVE '0' TO WMS-INFO-TRLR.
464250     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'
464300         IF  WMS-SC-DELETE EQUAL '9'
464350             SUBTRACT WS-TRL-EXTR-SC-LNGTH FROM WMS-LENGTH        0903291
464400             MOVE '0' TO WMS-EXT-SC-DATA-TRLR.
464402     IF  WMS-EFA-TRLR EQUAL '1'                                   IM007
464404         IF  WMS-EFA-DELETE EQUAL '9'                             IM007
464406             SUBTRACT WS-TRL-FND-AVAIL-LNGTH FROM WMS-LENGTH      0903291
464408             MOVE '0' TO WMS-EFA-TRLR.                            IM007
464410     IF  WMS-NME-ADDR-TLRS EQUAL +2                               IM005
464420         IF  WMS-NA-NO-LINES-2 EQUAL +0                           IM005
464430             MOVE +1 TO WMS-NME-ADDR-TLRS.                        IM005
464450* RESET RATE FLAG IF THE TRAILER DOES NOT EXIST.                  1003625
464455     IF  WMS-HIFI-INDICATOR EQUAL +0                              1003625
464460     AND WMS-IOD-RATE-PTR EQUAL +0                                1003625
464465     AND WMS-RATE-TRLR EQUAL '1'                                  1003625
464470         MOVE 'N' TO WMS-DDA-RATE-FLAG.                           1003625
464475     IF  WMS-SAVINGS-TRLR EQUAL TO '0'                            1003625
464480     AND WMS-RATE-TRLR EQUAL '1'                                  1003625
464485         MOVE 'N' TO WMS-SAV-RATE-FLAG.                           1003625
464490     IF  WMS-LOAN-TRLR EQUAL TO '0'                               1003625
464495     AND WMS-RATE-TRLR EQUAL '1'                                  1003625
464497         MOVE 'N' TO WMS-LN-RATE-FLAG.                            0266910
464498     IF  (WMS-LOAN-TRLR EQUAL '1')                                0266910
464499     AND (WMS-INT-RATE-PTR EQUAL +0)                              0266910
464500     AND (WMS-SPLIT-RATE-SCHD EQUAL +0)                           0266910
464501     AND (WMS-PREV-INT-PTR EQUAL +0)                              0266910
464502     AND (WMS-PREV-SPLIT-RATE-PTR EQUAL +0)                       0266910
464503     AND (WMS-RATE-TRLR EQUAL '1')                                0266910
464504         MOVE 'N' TO WMS-LN-RATE-FLAG.                            0266910
464505     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'                            1003625
464510     AND WMS-RATE-TRLR EQUAL '1'                                  1003625
464511         MOVE 'N' TO WMS-OD-RATE-FLAG.                            2012254
464512     IF  WMS-TAX-FED-PTR EQUAL +0                                 2012254
464513     AND WMS-RATE-TRLR EQUAL '1'                                  2012254
464514         MOVE 'N' TO WMS-FED-TAX-RATE-FLAG.                       2012254
464515     IF  WMS-TAX-STATE-PTR EQUAL +0                               2012254
464516     AND WMS-RATE-TRLR EQUAL '1'                                  2012254
464517         MOVE 'N' TO WMS-ST-TAX-RATE-FLAG.                        2012254
464518     IF  WMS-TAX-LOCAL-PTR EQUAL +0                               2012254
464519     AND WMS-RATE-TRLR EQUAL '1'                                  2012254
464520         MOVE 'N' TO WMS-LOC-TAX-RATE-FLAG.                       2012254
464521     IF  WMS-RATE-TRLR EQUAL '1'                                  2012254
464525         IF  WMS-RATE-TRAILER-FLAGS EQUAL 'NNNNNNN'               2012254
464530             SUBTRACT WS-TRL-RATE-LNGTH FROM WMS-LENGTH           1003625
464535             MOVE '0' TO WMS-RATE-TRLR.                           1003625
464540     IF  WMS-TRAILERS EQUAL TO NO-TRAILERS                        1003625
464541     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
464545         MOVE '0' TO WMS-EXPANSION-IND.                           1003625
464550 R0030.
464600     IF TRLR-DELETE-FLAGS EQUAL TO '00', GO TO R0090.
464650     SKIP3
464700 TRLR-SECTION-C      SECTION 47.
464750     SKIP3
464800 R0032.
464850     IF AMT-TRANSFER-DEL EQUAL TO '0', GO TO R0048.
464900 R0035.
464950     MOVE ZERO TO X, AMT-TRANSFER-DEL.
465000 R0037.
465050     ADD +1 TO X.
465100     IF X GREATER THAN WMS-TRNSFR-AFFL-TRLR, GO TO R0045.
465150     IF WMS-LINK-DELETE (X) NOT EQUAL TO HIGH-VALUE, GO TO R0037.
465200     MOVE X TO Y, Z.
465210     IF  X LESS THAN WMS-IOD-XFER-INT-PTR                         0546393
465220         SUBTRACT +1 FROM WMS-IOD-XFER-INT-PTR.                   0546393
465230     IF  WMS-SAVINGS-TRLR EQUAL '1'                               0546393
465240         IF  X LESS THAN WMS-SAV-XFER-INT-PTR                     0546393
465245             SUBTRACT +1 FROM WMS-SAV-XFER-INT-PTR.               0546393
465246     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0817704
465247         IF  X LESS THAN WMS-OD-INT-XFER-PTR                      0817704
465248             SUBTRACT +1 FROM WMS-OD-INT-XFER-PTR.                0817704
465250 R0040.
465300     ADD +1 TO Y.
465350     IF Y GREATER THAN WMS-TRNSFR-AFFL-TRLR
465400         SUBTRACT +1 FROM WMS-TRNSFR-AFFL-TRLR
465450         SUBTRACT WS-TRL-TRNS-AFFL-LNGTH FROM WMS-LENGTH          0903291
465500         SUBTRACT +1 FROM X
465550         GO TO R0037.
465600     MOVE WMS-TRANSFER-AFFILIATE-TRAILER (Y) TO
465650          WMS-TRANSFER-AFFILIATE-TRAILER (Z).
465700     ADD +1 TO Z.
465750     GO TO R0040.
465800 R0045.
465850     MOVE +1 TO X.
465900 R0046.
465950     IF X GREATER THAN WMS-TRNSFR-AFFL-TRLR
466000         GO TO R0048.
466050     IF WMS-LINK-SYS-ID (X) EQUAL 'TR'
466100         MOVE X TO WMS-SAV-PTR
466150         GO TO R0048.
466200     ADD +1 TO X.
466250     GO TO R0046.
466300 R0048.  EXIT.
466350 R0070.
466400     IF COMB-STMT-DEL EQUAL TO '0', GO TO R0088.
466450     MOVE ZERO TO X, COMB-STMT-DEL.
466500 R0075.
466550     ADD +1 TO X.
466600     IF X GREATER THAN WMS-COMBINED-STAT, GO TO R0081.            0637443
466650     IF WMS-COMB-STMT-DELETE (X) NOT EQUAL TO HIGH-VALUE
466700         GO TO R0075.
466750     MOVE X TO Y, Z.
466800 R0080.
466850     ADD +1 TO Y.
466900     IF Y GREATER THAN WMS-COMBINED-STAT
466950         SUBTRACT +1 FROM WMS-COMBINED-STAT
467000         SUBTRACT WS-TRL-COMB-STMT-LNGTH FROM WMS-LENGTH          0903291
467050         SUBTRACT +1 FROM X
467100         GO TO R0075.
467150     MOVE WMS-COMBINED-STATEMENT-TRAILER (Y) TO
467200          WMS-COMBINED-STATEMENT-TRAILER (Z).
467250     ADD +1 TO Z.
467300     GO TO R0080.
467310 R0081.  EXIT.                                                    0637443
467350 R0088.
467400     IF WMS-TRAILERS EQUAL TO NO-TRAILERS
467420     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
467450         MOVE '0' TO WMS-EXPANSION-IND
467500     ELSE MOVE '1' TO WMS-EXPANSION-IND.
467550 R0089.  EXIT.
467600     SKIP3
467650 ROOT-SECTION-M      SECTION 1.
467700     SKIP3
467750 R0090.
467752     IF  IBT-ACCT-IND EQUAL TO '2' OR '3'                         9915845
467753         GO TO R1200.                                             9915845
467755*----------------------------------------------------------------*9915749
467760*    EXCLUDE AUTOBORROW ACCOUNTS.                                *9915749
467765*----------------------------------------------------------------*9915749
467800     IF  WMS-LOAN-TRLR EQUAL '0'
467850     OR  WMS-LOAN-STATUS EQUAL '6'
467860     OR  WMS-NB-DC-ABM EQUAL '1'                                  9915749
467900         GO  TO  R0700.                                           IM007
467950     SKIP3
468000 LOAN-SECTION-B      SECTION 26.
468050     SKIP3
468100*    **********  LOAN OVERPAYMENT RECONCILIATION  **********
468150     SKIP1
468200 R0100.
468250     IF WMS-PRIN-BAL NOT LESS THAN ZERO, GO TO R0300.
468300     MULTIPLY -1 BY WMS-PRIN-BAL GIVING HOLD-AMT.
468350     ADD +1 TO FS-CR.
468400     PERFORM K7500 THRU K8500.
468450     MOVE WBC-GENERATED-TRANS (11) TO GEN-TRAN-OPTION-HOLD.       0266741
468500     ADD HOLD-AMT TO WMS-CURR-BAL, CUR-BAL, CUST-BAL.             IM003
468550     PERFORM K0530 THRU K0540-EXIT.
468600     ADD +1 TO DDA-LOAN-OVRPMT-NO, WS-GL-DDA-LOAN-OVRPMT-NO.      0902970
468650     ADD HOLD-AMT TO DDA-LOAN-OVRPMT-AMT                          0902970
468651                     WS-GL-DDA-LOAN-OVRPMT-AMT.                   0902970
468700     ADD +1 TO WMS-STMT-NO-CREDITS.
468750     ADD HOLD-AMT TO WMS-STMT-CR-AMT.
468800     IF WMS-IOD-RATE-PTR GREATER THAN ZERO
468850     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
468900         ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                     0902970
468950         ADD HOLD-AMT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT             0902970
469000     ELSE
469050         ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                     0902970
469100         ADD HOLD-AMT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.            0902970
469150     MOVE '11' TO EX01-INT-CODE.
469200     MOVE '2' TO EX01-TYPE.
469250     MOVE ZERO TO EX01-NUMBER.
469300     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
469350 R0120.
469400     MOVE WBC-GENERATED-TRANS (12) TO GEN-TRAN-OPTION-HOLD.       0266741
469450     ADD HOLD-AMT TO WMS-PRIN-BAL.
469500     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-BAL-CHANGE.           0266741
469550     ADD +1 TO LOAN-OVRPMT-NO, WMS-LN-STMT-DB-NO,                 0902970
469551               WS-GL-LOAN-OVRPMT-NO.                              0902970
469600     ADD HOLD-AMT TO LOAN-OVRPMT-AMT, WMS-LN-STMT-DB-AMT,         0902970
469601                     WS-GL-LOAN-OVRPMT-AMT.                       0902970
469650     ADD +1 TO LOAN-DB-NO, WS-GL-LOAN-DB-NO.                      0902970
469700     ADD HOLD-AMT TO LOAN-DB-AMT, WS-GL-LOAN-DB-AMT               0902970
469750                     LOAN-DR-PRIN, WS-GL-LOAN-DR-PRIN.            0902970
469800     MOVE '12' TO EX01-INT-CODE.
469850     MOVE 'G5' TO IMEX-CODE-2.
469900     MOVE '6' TO EX01-TYPE.
469950     PERFORM R0345 THRU R0346.
470000     MOVE HOLD-AMT TO PRIN-DISB.
470050     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
470100     MOVE ZERO TO EX01-NUMBER.
470150     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
470200     PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
470250     SKIP3
470300*    **********  AUTOMATIC LOAN PAYMENT CAPTURE  ***********
470350     SKIP1
470400 R0300.
470450     IF  WMS-SAVINGS-TRLR EQUAL '1' AND
470500         WMS-CMA-INDICATOR EQUAL '1'
470550         GO  TO  R0495.
470560     IF  WXI-SAME-DAY EQUAL '1'                                   2016639
470570         GO TO R0495.                                             2016639
470600     IF AUTO-LOAN-PMT EQUAL TO '1', GO TO R0495.
470650     MOVE '1' TO AUTO-LOAN-PMT.
470700     IF WMS-AUTO-PYMT EQUAL TO '0', GO TO R0495.
470750     IF WMS-LOAN-STATUS GREATER THAN '2' AND NOT EQUAL '5'
470800         GO TO R0495.
470850     IF WMS-STATUS EQUAL TO '01', GO TO R0495.
470900     IF WMS-PYMT-DUE-AMT NOT GREATER THAN ZERO, GO TO R0495.
470950     IF  WMS-PAST-DUE EQUAL ZERO                                  1002953
471000         GO TO R0310.
471050     PERFORM R0310 THRU R0314.
471100     IF RET-DAYS GREATER THAN ZERO
471150         SUBTRACT WMS-PAST-DUE-AMT FROM WMS-PYMT-DUE-AMT
471200                 GIVING LN-ND-AMT
471250         MOVE '1' TO LN-ND-FLG
471300         MOVE WMS-PAST-DUE-AMT TO WMS-PYMT-DUE-AMT.
471350     IF  WMS-PAST-DUE LESS THAN '3'                               1002953
471400         GO TO R0320.                                             IM003
471420     IF  WMS-AUTO-REACTIVATE EQUAL '0'                            IM003
471440         GO TO R0495.                                             IM003
471460     GO TO R0320.                                                 IM003
471550 R0310.
471600     MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE.                        0266741
471650     MOVE WMS-BILL-DUE-MO (1)    TO  DT-H-MO.                     1002953
471651     MOVE WMS-BILL-DUE-DA (1)    TO  DT-H-DA.                     1002953
471652     MOVE WMS-BILL-DUE-YR (1)    TO  DT-H-YR.                     1002953
471700     CALL 'SIDIF1' USING DATE-AREA.
471750 R0314.  EXIT.
471800 R0315.
471850     IF RET-DAYS GREATER THAN ZERO, GO TO R0495.
471900 R0320.
471950******************************************************************
472040***  THE FOLLOWING USER EXIT MAY BE USED TO DO MASTER PROCESSING  IM002
472130***  ON ACCOUNTS THAT HAVE AUTOMATIC PAYMENTS TAKEN TODAY.        IM002
472220***                                                               IM002
472310***  COPY IM31UBWR.                                               IM002
472400***                                                               IM002
472490***  END OF USER EXIT.                                            IM002
472580******************************************************************IM002
472850     ADD WMS-PRIN-BAL                                             1002953
472855         WMS-INTRST-BAL                                           1002953
472900         WMS-OTHER-CHGS      GIVING  HOLD-AMT9.                   1002953
472950     SUBTRACT WMS-LOAN-DLAY-INT                                   1002953
472955                               FROM  HOLD-AMT9.                   1002953
473000     IF  HOLD-AMT9 LESS THAN WMS-PYMT-DUE-AMT                     1002953
473050         IF  HOLD-AMT9 GREATER THAN ZERO                          1002953
473060             SUBTRACT HOLD-AMT9                                   1002953
473062                               FROM  WMS-PYMT-DUE-AMT             1002953
473064                             GIVING  AMT-PD                       1002953
473070             PERFORM K1502 THRU K1502-EXIT                        1002953
473100         ELSE                                                     1002953
473150             MOVE WMS-PYMT-DUE-AMT                                1002953
473200                                 TO  AMT-PD                       1002953
473225             PERFORM K1502 THRU K1502-EXIT                        1002953
473250             GO  TO  R0495.                                       1002953
473270     IF WMS-PYMT-DUE-AMT NOT GREATER THAN ZERO, GO TO R0495.      IM008
473300     IF NSF-CALC-FLAG EQUAL TO '0'
473350         PERFORM K0100 THRU K0105.
473360     IF  CUST-CALC-FLAG EQUAL '0'                                 IM003
473370         PERFORM K0106 THRU K0106-EXIT.                           IM003
473400     MOVE '0' TO WMS-LOAN-TO-MAKE-PYMT.
473450 R0330.
473500     IF  SAV-BKUP-WTHLD-FLAG NOT EQUAL '2' AND '3'                IM007
473506         GO TO R0331.                                             IM007
473512     IF  WMS-IOD-PEND-TAX GREATER THAN ZERO                       IM007
473518         SUBTRACT WMS-IOD-PEND-TAX FROM CUR-BAL.                  IM007
473524     IF  SAVINGS-PRESENT EQUAL '1'                                IM007
473536         IF  WMS-SAV-PEND-TAX GREATER THAN ZERO                   IM007
473542             SUBTRACT WMS-SAV-PEND-TAX FROM CUR-BAL.              IM007
473548 R0331.                                                           IM007
473554     IF  WMS-PYMT-DUE-AMT GREATER THAN CUR-BAL                    IM007
473560         GO TO R0350.                                             IM007
473566 R0332.                                                           IM007
473572     IF  SAV-BKUP-WTHLD-FLAG EQUAL '2' OR '3'                     IM007
473578         MOVE WMS-PYMT-DUE-AMT TO MAX-TAX                         IM007
473585         PERFORM R4840 THRU R4840-EXIT.                           IM007
473600     MOVE WMS-PYMT-DUE-AMT TO HOLD-AMT.
473650     MOVE WBC-GENERATED-TRANS (19) TO GEN-TRAN-OPTION-HOLD.       0266741
473700     MOVE GT-OPTION9 (6) TO HOLD-OPT.                             IM002
473710     IF  HOLD-OPT GREATER THAN +3                                 IM003
473720         SUBTRACT +4 FROM HOLD-OPT.                               IM003
473750     PERFORM K1350 THRU K1350-EXIT.
473800     IF  TOLERANCE-SW EQUAL 'N'
473850         PERFORM K1360 THRU K1360-EXIT.
473900     MOVE WMS-PYMT-DUE-AMT TO WK-HOLD-AMT13.                      9915845
473950 R0335.
474000     IF WMS-LOAN-TO-MAKE-PYMT = '0'
474050         MOVE ZERO TO WMS-CONSEC-PAY-LN.
474100     ADD +1 TO FS-DB.
474150     PERFORM K7500 THRU K8500.
474200     SUBTRACT WK-HOLD-AMT13 FROM CUR-BAL, WMS-CURR-BAL,           9915845
474203                             CUST-BAL, WMS-DDA-BAL.               IM005
474206     IF  HOLD-SAV-XFER GREATER THAN +0.00                         IM005
474209         ADD HOLD-SAV-XFER TO WMS-DDA-BAL                         IM005
474212         MOVE +0.00 TO HOLD-SAV-XFER.                             IM005
474250     ADD +1 TO DDA-LOAN-PMT-NO                                    1103704
474251               WS-GL-DDA-LOAN-PMT-NO.                             1103704
474300     ADD WK-HOLD-AMT13 TO DDA-LOAN-PMT-AMT                        9915845
474301                          WS-GL-DDA-LOAN-PMT-AMT.                 0902970
474350     MOVE WK-HOLD-AMT13          TO  AMT-PD.                      9915845
474360     PERFORM K1502 THRU K1502-EXIT.                               1002953
474400     ADD +1 TO WMS-STMT-NO-DEBITS.
474450     ADD WK-HOLD-AMT13 TO WMS-STMT-DR-AMT.                        9915845
474500     IF WMS-IOD-RATE-PTR GREATER THAN ZERO
474550     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
474600         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
474650         ADD WK-HOLD-AMT13 TO IOD-DB-AMT, WS-GL-IOD-DB-AMT        9915845
474700     ELSE
474750         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
474800         ADD WK-HOLD-AMT13 TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.       9915845
474850     MOVE WBC-GENERATED-TRANS (9) TO GEN-TRAN-OPTION-HOLD.        0266741
474900     MOVE '09' TO EX01-INT-CODE.
474950     MOVE '4' TO EX01-TYPE.
475000     MOVE ZERO TO EX01-NUMBER.
475050     MOVE WK-HOLD-AMT13 TO HOLD-AMT.                              9915845
475100     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
475150     MOVE '1' TO POST-TODAY.
475152     MOVE ZERO TO WMS-DAYS-ZERO-BAL.                              0737696
475200     MOVE HOLD-AMT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
475250     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
475300 R0345.
475350     MOVE ZERO TO PRIN-DISB
475400                  INT-DISB
475450                  OTH-DISB
475500                  PRIN-OLD-DISB
475550                  ADDL-CR-DISB.
475600 R0346.  EXIT.
475650 R0347.
475700     MOVE WBC-GENERATED-TRANS (10) TO GEN-TRAN-OPTION-HOLD.       0266741
475750     MOVE WK-HOLD-AMT13 TO HOLD-AMT11.                            9915845
475800     MOVE '1' TO CURR-PMT-AUTO.
475850     IF  TOLERANCE-SW EQUAL 'F'
475900         SUBTRACT WMS-LOAN-DLAY-INT FROM WMS-INTRST-BAL.
475950     MOVE '0' TO CALC-FLAG.
476000     IF  WMS-SAVINGS-TRLR EQUAL '1' AND
476050         WMS-CMA-INDICATOR EQUAL '1'
476100         IF  SWEEP-TODAY EQUAL '0'
476150             PERFORM K1245 THRU K1240-EXIT
476200             GO  TO  R0347-D.                                     IM005
476250     IF  WMS-EXTENSION-STATUS NOT EQUAL '0' AND ' '
476300         GO  TO  R0347-B.
476310     IF  TOLERANCE-SW EQUAL 'N'                                   IM005
476320         GO TO R0347-C.                                           IM005
476350     IF  WBC-PYMT-APPL EQUAL '2' OR '3'                           0266741
476400         GO  TO  R0347-A.
476450     PERFORM K1210-INTEREST THRU K1240-EXIT-A.
476500     PERFORM K1245 THRU K1240-EXIT.
476550     GO  TO  R0347-D.                                             IM005
476600 R0347-A.
476650     IF  WBC-PYMT-APPL EQUAL '2'                                  0266741
476700         PERFORM K1220-OTHER THRU K1220-EXIT
476750         PERFORM K1210-INTEREST THRU K1210-EXIT
476800         PERFORM K1240-PRINCIPAL THRU K1240-EXIT-A
476850         PERFORM K1245 THRU K1240-EXIT
476900     ELSE
476950         PERFORM K1210-INTEREST THRU K1210-EXIT
477000         PERFORM K1240-PRINCIPAL THRU K1240-EXIT-A
477050         PERFORM K1245 THRU K1240-EXIT.
477100     GO  TO  R0347-D.                                             IM005
477150 R0347-B.
477200     IF  WMS-EXTENSION-STATUS EQUAL '2'
477250         PERFORM K1210-INTEREST THRU K1210-EXIT
477300     ELSE
477350     IF  WMS-EXTENSION-STATUS EQUAL '3'
477400         PERFORM K1220-OTHER THRU K1220-EXIT
477450     ELSE
477500     IF  WMS-EXTENSION-STATUS EQUAL '4'
477550         IF  WBC-PYMT-APPL EQUAL '2'                              0266741
477600             PERFORM K1220-OTHER THRU K1220-EXIT
477650             PERFORM K1210-INTEREST THRU K1210-EXIT
477700     ELSE
477750             PERFORM K1210-INTEREST THRU K1220-EXIT.
477800     GO  TO  R0347-D.                                             IM005
477804 R0347-C.                                                         IM005
477808     MOVE 'N' TO PAYOFF-SW.                                       IM005
477812     PERFORM K1240-PRINCIPAL THRU K1240-EXIT.                     IM005
477816     PERFORM K1220-OTHER     THRU K1220-EXIT.                     IM005
477820     PERFORM K1210-INTEREST  THRU K1210-EXIT.                     IM005
477824     IF  HOLD-AMT11 GREATER THAN +0.00                            IM005
477828         MULTIPLY -1 BY HOLD-AMT11 GIVING WMS-PRIN-BAL            IM005
477832         ADD HOLD-AMT11 TO LOAN-PRIN-PAID, PRIN-DISB,             0902970
477833                           WS-GL-LOAN-PRIN-PAID.                  0902970
477836     MOVE 'F' TO PAYOFF-SW.                                       IM005
477840 R0347-D.                                                         IM005
477850     IF  TOLERANCE-SW EQUAL 'F'
477900         ADD WMS-LOAN-DLAY-INT TO WMS-INTRST-BAL.
477950     MOVE '0' TO CURR-PMT-AUTO.
478000     MOVE '10' TO EX01-INT-CODE.
478050     MOVE 'G5' TO IMEX-CODE-2.
478100     MOVE '5' TO EX01-TYPE.
478150     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
478200     MOVE ZERO TO EX01-NUMBER.
478250     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
478300     PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
478350     ADD +1 TO LOAN-AUTO-PMT-NO, WS-GL-LOAN-AUTO-PMT-NO.          0902970
478400     ADD WK-HOLD-AMT13 TO LOAN-AUTO-PMT-AMT                       9915845
478401                          WS-GL-LOAN-AUTO-PMT-AMT.                0902970
478450     ADD +1 TO LOAN-CR-NO, WS-GL-LOAN-CR-NO, WMS-LN-STMT-CR-NO.   0902970
478500     ADD WK-HOLD-AMT13 TO LOAN-CR-AMT, WMS-LN-STMT-CR-AMT,        9915845
478501                          WS-GL-LOAN-CR-AMT.                      0902970
478550     ADD PRIN-DISB TO LOAN-CR-PRIN, WS-GL-LOAN-CR-PRIN.           0902970
478600     ADD INT-DISB  TO LOAN-CR-INT, WS-GL-LOAN-CR-INT.             0902970
478650     ADD OTH-DISB  TO LOAN-CR-OTH, WS-GL-LOAN-CR-OTH.             0902970
478700     MOVE '1' TO LOAN-POST-TODAY.
478750     MOVE WK-HOLD-AMT13 TO WMS-LAST-PYMT-AMT.                     9915845
478800     MOVE WBC-CAPTURE-DATE TO WMS-LAST-PMT-DATE                   0266741
478850                             WMS-DATE-LAST-LOAN-ACTIVITY.
478900     IF  WMS-PAST-DUE GREATER THAN ZERO                           1002953
478950         MOVE HOLD-AMT TO EX10-PMT-AMT
479000         MOVE 'G' TO EX10-REASON
479050         PERFORM K1510 THRU K1519.
479100 R0348.  EXIT.
479150 R0349.
479190     IF  WMS-PYMT-DUE-AMT GREATER THAN ZERO                       1002953
479195         MOVE WMS-PYMT-DUE-AMT   TO  AMT-PD                       1002953
479200         PERFORM K1502 THRU K1502-EXIT.                           1002953
479250     IF  TOLERANCE-SW EQUAL 'N'
479300         MOVE 'F' TO TOLERANCE-SW
479350         PERFORM K1580.
479400     IF  WMS-PAST-DUE EQUAL ZERO                                  1002953
479405         GO  TO  R0495.                                           1002953
479450 R0349-A.
479500     MOVE ZEROS                  TO  WMS-PAST-DUE                 1002953
479550                                     WMS-PDUE-DAYS-AFTER-NTC      1002953
479600                                     WMS-DAYS-SINCE-PNLTY.        1002953
479610     MOVE SPACES                 TO  WMS-PAST-DUE-DATE.           1002953
479660     IF  WMS-LOAN-STATUS EQUAL '2'                                1002953
479670     AND WMS-AUTO-REACTIVATE EQUAL '1'                            1002953
479680         MOVE '1' TO WMS-LOAN-STATUS                              IM003
479690         PERFORM R0530 THRU R0530-EXIT.                           IM003
479700 R0349-A-EXIT. EXIT.
479750 R0349-B.
479800     GO  TO  R0495.
479850 R0350.
479900     IF WMS-STATUS NOT EQUAL TO '00' AND '04'
479920     AND WMS-LOAN-STATUS NOT EQUAL '2'                            IM008
479950         MOVE '2' TO WMS-LOAN-STATUS
480000         MOVE 'SU' TO IMEX-CODE-1
480050         MOVE 'SL' TO IMEX-CODE-2
480100         MOVE '09' TO IMEX-REC-NO
480150         MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
480200         MOVE '2' TO EX09-STATUS-OUT, WK-LN-STATUS-IN
480250         MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
480300         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT
480350         GO TO R0495.
480400     MOVE WBC-GENERATED-TRANS (9) TO GEN-TRAN-OPTION-HOLD.        0266741
480450     IF SAVINGS-OR-LOAN EQUAL TO '0'
480500         GO  TO  R0380.
480550     MOVE CUR-BAL TO AMT-AVAIL.
480600     IF SAVINGS-PRESENT EQUAL TO '1'
480650         ADD WMS-INT-CUR-BAL TO AMT-AVAIL.
480700     IF  LOAN-PRESENT EQUAL '0'                                   IM003
480710     OR  (GT-OPTION (3) EQUAL '0' OR '4')                         IM003
480750         MOVE '1' TO NO-LOAN
480800     ELSE
480850         MOVE '0' TO NO-LOAN
480900         ADD WMS-AVAIL-BAL TO AMT-AVAIL.
480950     IF AMT-AVAIL LESS THAN WMS-PYMT-DUE-AMT
481000         IF NO-LOAN EQUAL TO '0'
481050             GO TO R0375
481100         ELSE
481150             GO  TO  R0380.
481200     IF SAVINGS-OR-LOAN LESS THAN '3'
481250         GO TO R0400.
481300     IF NO-LOAN EQUAL TO '1'
481350         GO TO R0410.
481400     IF WMS-PYMT-DUE-AMT GREATER THAN CUR-BAL + WMS-AVAIL-BAL
481410         PERFORM K1730 THRU K1730-EXIT                            2015844
481450         ADD WMS-AVAIL-BAL TO LOAN-TODAY WMS-PRIN-BAL LOAN-MIN-BALIM005
481460                              CUR-BAL    CUST-BAL                 IM003
481500         GO TO R0410.
481550 R0352.
481600     IF GT-OPTION (3) NOT EQUAL '2' AND '6'                       IM003
481610        GO TO R0360.                                              IM003
481650 R0355.
481700     SUBTRACT CUR-BAL FROM WMS-PYMT-DUE-AMT GIVING HOLD-AMT.
481750 R0358.
481760     PERFORM K1730 THRU K1730-EXIT.                               2015844
481800     ADD HOLD-AMT TO CUR-BAL, WMS-PRIN-BAL, LOAN-TODAY,           IM005
481810                     CUST-BAL, LOAN-MIN-BAL.                      IM005
481850     GO TO R0365.
481900 R0360.
481950     IF WMS-AVAIL-BAL LESS THAN HOLD-INCRM
482000         AND WMS-AVAIL-BAL GREATER THAN ZERO
482050         MOVE WMS-AVAIL-BAL TO HOLD-AMT
482100         GO TO R0358.
482110     PERFORM K1730 THRU K1730-EXIT.                               2015844
482150     ADD HOLD-INCRM TO WMS-PRIN-BAL  LOAN-TODAY  LOAN-MIN-BAL     IM005
482160                       CUR-BAL       CUST-BAL.                    IM003
482200     SUBTRACT HOLD-INCRM FROM WMS-AVAIL-BAL.
482250     IF CUR-BAL LESS THAN WMS-PYMT-DUE-AMT, GO TO R0360.
482300 R0365.
482350     MOVE '1' TO WMS-LOAN-TO-MAKE-PYMT.
482400     ADD +1 TO WMS-CONSEC-PAY-LN.
482450     GO TO R0332.
482500 R0375.
482510     IF WMS-LOAN-BAD-ACCT GREATER THAN '0', GO TO R0380.          IM004
482520     IF WMS-OVERLIM-INCR EQUAL '2', GO TO R0377.                  IM004
482550     IF OVRLIM-FLAG EQUAL TO '1', GO TO R0380.
482600     IF WBC-OVRLIM-INCR EQUAL TO '0'                              0266741
482650         IF WMS-OVERLIM-INCR EQUAL TO '0'
482700             GO TO R0380.
482750     IF WMS-OVERLIMIT GREATER THAN '0', GO TO R0380.
482800     IF OVER-LINE EQUAL TO '1', GO TO R0380.
482900     IF WMS-PYMT-DUE-AMT GREATER THAN
482950         AMT-AVAIL + HOLD-INCRM
483000         GO TO R0380.
483050     MOVE '1' TO OVRLIM-FLAG.
483100     IF SAVINGS-PRESENT EQUAL TO '1'
483150         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFERIM005
483200         MOVE ZERO TO WMS-INT-CUR-BAL.
483210     PERFORM K1730 THRU K1730-EXIT.                               2015844
483250     ADD WMS-AVAIL-BAL HOLD-INCRM TO WMS-PRIN-BAL
483300                                     LOAN-TODAY
483320                                     LOAN-MIN-BAL                 IM005
483350                                     CUR-BAL                      IM003
483360                                     CUST-BAL.                    IM003
483400     GO TO R0365.
483403**** AUTO LOAN INCREMENT FLAG = 2  THE DEBIT WILL BE PAID    *****IM004
483406 R0377.                                                           IM004
483409     SUBTRACT AMT-AVAIL FROM WMS-PYMT-DUE-AMT                     IM004
483412              GIVING HOLD-LOAN-INCR.                              IM004
483415     IF SAVINGS-PRESENT EQUAL TO '1'                              IM004
483418         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFERIM005
483421         MOVE ZERO TO WMS-INT-CUR-BAL.                            IM004
483423     PERFORM K1730 THRU K1730-EXIT.                               2015844
483424     ADD WMS-AVAIL-BAL, HOLD-LOAN-INCR TO WMS-PRIN-BAL            IM004
483427                                          CUR-BAL                 IM004
483430                                          CUST-BAL                IM004
483431                                          LOAN-MIN-BAL            IM005
483433                                          LOAN-TODAY.             IM004
483436     GO TO R0365.                                                 IM004
483450 R0380.
483500     IF GT-OPTION (2) EQUAL TO '0', GO TO R0480.
483550     IF GT-OPTION (2) NOT EQUAL TO '1', GO TO R0390.
483600     IF  SAVINGS-PRESENT EQUAL '1'
483650         ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFERIM005
483700         MOVE ZERO TO WMS-INT-CUR-BAL.
483750     MOVE '1' TO WMS-OD-TODAY.
483755     IF WMS-SAV-PTR EQUAL TO ZERO                                 9715808
483760     AND WMS-SAVINGS-TRLR EQUAL '0'                               9715808
483765     AND WMS-CHG-CARD-FLG EQUAL '0'                               9715808
483770         GO TO R0382.                                             9715808
483775     IF  WMS-SAV-PTR NOT EQUAL TO ZERO                            9715808
483780         MOVE 'LE' TO IMEX-CODE-1                                 9715808
483785     ELSE                                                         9715808
483790         IF  WMS-SAVINGS-TRLR EQUAL '1'                           9715808
483795             MOVE 'LF' TO IMEX-CODE-1                             9715808
483800         ELSE                                                     9715808
483805             MOVE 'LH' TO IMEX-CODE-1.                            9715808
483810     MOVE '5' TO SAVE-TYPE.                                       9715808
483815     MOVE WMS-PYMT-DUE-AMT TO HOLD-AMT.                           9715808
483820     PERFORM WGT-5 THRU WGT-5-EXIT.                               9715808
483825 R0382.                                                           9715808
483850     IF WMS-SAV-PTR EQUAL TO ZERO
483870     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
483900         ADD +1 TO WMS-SC-OD-ITEMS, WMS-MTD-OD-ITEMS.
483950     MOVE '2' TO WMS-LOAN-TO-MAKE-PYMT.
484000     MOVE '1' TO OD-TODAY.
484050     GO TO R0332.                                                 IM002
484200 R0390.
484250     IF  LOAN-PRESENT EQUAL '0', GO TO R0480.
484300     IF GT-OPTION (2) LESS THAN '4', GO TO R0360.
484350     GO TO R0355.
484400 R0400.
484450     IF CUR-BAL + WMS-INT-CUR-BAL NOT LESS THAN WMS-PYMT-DUE-AMT
484500         GO TO R0410.
484550     ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFER.   IM005
484600     MOVE ZERO TO WMS-INT-CUR-BAL.
484650     GO TO R0352.
484700 R0410.
484750     IF WMS-INT-INCREMNT GREATER THAN ZERO
484800         IF HOLD-SAV-INCR GREATER THAN ZERO
484850         GO TO R0420.
484900     SUBTRACT CUR-BAL FROM WMS-PYMT-DUE-AMT GIVING HOLD-AMT.
484950     ADD HOLD-AMT TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFER.          IM005
485000     SUBTRACT HOLD-AMT FROM WMS-INT-CUR-BAL.
485050     GO TO R0332.
485100 R0420.
485125     SUBTRACT WMS-PYMT-DUE-AMT FROM CUR-BAL.                      1004189
485150     COMPUTE HOLD-SAV-INCR-COUNT =                                1004189
485175         ((CUR-BAL / HOLD-SAV-INCR * (-1)) + 1).                  1004189
485200     COMPUTE HOLD-SAV-INCR-TOTAL =                                1004189
485225         (HOLD-SAV-INCR-COUNT * HOLD-SAV-INCR).                   1004189
485250     IF  HOLD-SAV-INCR-TOTAL GREATER THAN WMS-INT-CUR-BAL         1004189
485275         ADD WMS-INT-CUR-BAL     TO CUR-BAL                       1004189
485300                                    TRANSFER-AMT                  1004189
485325                                    HOLD-SAV-XFER                 1004189
485350         MOVE ZERO               TO WMS-INT-CUR-BAL               1004189
485375         GO TO R0332.                                             1004189
485400     ADD HOLD-SAV-INCR-TOTAL     TO CUR-BAL                       1004189
485425                                    TRANSFER-AMT                  1004189
485450                                    HOLD-SAV-XFER.                1004189
485475     SUBTRACT HOLD-SAV-INCR-TOTAL                                 1004189
485500                               FROM WMS-INT-CUR-BAL.              1004189
485550     GO TO R0332.
485600 R0480.
485650     MOVE '3' TO WMS-LOAN-TO-MAKE-PYMT.
485700     IF WMS-LOAN-PART-PMT NOT EQUAL TO '1'
485750         GO TO R0495.
485800     IF SAVINGS-OR-LOAN EQUAL TO '0' OR '3'
485850         IF CUR-BAL LESS THAN WMS-LOAN-MIN-PART-PMT
485900             GO TO R0495
485950         ELSE
486000             GO TO R0490.
486050     IF CUR-BAL + WMS-INT-CUR-BAL LESS THAN WMS-LOAN-MIN-PART-PMT
486100         GO TO R0495.
486150     ADD WMS-INT-CUR-BAL TO CUR-BAL TRANSFER-AMT HOLD-SAV-XFER.   IM005
486200     MOVE ZERO TO WMS-INT-CUR-BAL.
486250 R0490.
486300     IF CUR-BAL NOT GREATER THAN ZERO
486350         GO TO R0495.
486400     MOVE CUR-BAL TO WK-HOLD-AMT13.                               9915845
486410     IF  SAV-BKUP-WTHLD-FLAG EQUAL '2' OR '3'                     IM007
486420         MOVE CUR-BAL TO MAX-TAX                                  IM007
486430         PERFORM R4840 THRU R4840-EXIT.                           IM007
486500     PERFORM R0335 THRU R0348.
486550     IF  WMS-PAST-DUE-AMT NOT GREATER THAN +0
486600         PERFORM R0349-A THRU R0349-A-EXIT.
486650 R0495.
486700     IF LN-ND-FLG EQUAL '1'
486750         ADD LN-ND-AMT TO WMS-PYMT-DUE-AMT
486800         MOVE '0' TO LN-ND-FLG
486850         MOVE +0.00 TO LN-ND-AMT.
486900 R0495-EXIT.                                                      1105504
486905       EXIT.                                                      1105504
486950*    **********  LOAN DELINQUENCY DETERMINATION  ***********
487000     SKIP1
487050 R0500.
487150     IF (WMS-SAVINGS-TRLR EQUAL '1'                               0417250
487200     AND WMS-CMA-INDICATOR EQUAL '1')                             1002953
487210         GO  TO  R0700.                                           1002953
487220     MOVE +8                     TO  Z.                           1002953
487230     MOVE 'N'                    TO  PAST-DUE-UPDATE-FLAG.        1002953
487240     MOVE ZERO                   TO  HOLD-BILL-DUE-STAT.          1002953
487245     MOVE SPACES                 TO  HOLD-BILL-DUE-DATE.          1002953
487250 R0505.                                                           1002953
487260     SUBTRACT +1               FROM  Z.                           1002953
487270     IF  Z EQUAL ZERO                                             1002953
487280         GO  TO  R0508.                                           1002953
487282     IF  WMS-BILL-DUE-AMT (Z) EQUAL ZERO                          0417250
487284         IF  WMS-BILL-DUE-STAT (Z) NOT EQUAL ZERO                 0417250
487286             MOVE ZERO   TO  WMS-BILL-DUE-STAT (Z)                0417250
487288             GO  TO  R0505.                                       0417250
487290     IF  WMS-BILL-DUE-AMT (Z) EQUAL ZERO                          1002953
487300         GO  TO  R0505.                                           1002953
487310     MOVE '11'                   TO  SICOMPDT-DATE-FORMATS.       1002953
487320     MOVE WMS-BILL-DUE-MO (Z)    TO  DT-L-MO.                     1002953
487330     MOVE WMS-BILL-DUE-DA (Z)    TO  DT-L-DA.                     1002953
487340     MOVE WMS-BILL-DUE-YR (Z)    TO  DT-L-YR.                     1002953
487350     MOVE WBC-CAPTURE-DATE       TO  DT-HIGH-DATE.                0266741
487360     CALL 'SICOMPDT'          USING  DT-LOW-DATE                  1002953
487370                                     DT-HIGH-DATE                 1002953
487380                                     SICOMPDT-RETURN-FLAG         1002953
487390                                     SICOMPDT-DATE-FORMATS.       1002953
487400     IF  SICOMPDT-RETURN-FLAG NOT EQUAL 'L'                       1002953
487410         GO  TO  R0505.                                           1002953
487420     CALL 'SIDIF1'            USING  DATE-AREA.                   1002953
487430     MOVE RET-DAYS               TO  CURR-PAST-DUE-DAYS.          1002953
487440     MOVE WBC-LAST-PROC-THRU-DATE TO DT-HIGH-DATE.                0266741
487450     CALL 'SIDIF1'            USING  DATE-AREA.                   1002953
487460     MOVE RET-DAYS               TO  PREV-PAST-DUE-DAYS.          1002953
487470     ADD +1                      TO  CURR-PAST-DUE-DAYS           1002953
487480                                     PREV-PAST-DUE-DAYS.          1002953
487490     PERFORM R0510 THRU R0510-EXIT.                               1002953
487500     MOVE ZERO                   TO  Y.                           1002953
487510 R0506.                                                           1002953
487520     ADD +1                      TO  Y.                           1002953
487530     IF  Y GREATER +6                                             1002953
487540         GO  TO  R0505.                                           1002953
487550     IF  CURR-PAST-DUE-DAYS NOT LESS THAN WBC-PD-BDRY (Y)         0266741
487560     AND PREV-PAST-DUE-DAYS     LESS THAN WBC-PD-BDRY (Y)         0266741
487570         GO  TO  R0507.                                           1002953
487580     GO  TO  R0506.                                               1002953
487590 R0507.                                                           1002953
487600     IF  PAST-DUE-UPDATE-FLAG EQUAL 'N'                           1002953
487610         MOVE 'Y'                TO  PAST-DUE-UPDATE-FLAG.        1002953
487620     SUBTRACT +1               FROM  Y                            1002953
487625                             GIVING  X.                           1002953
487630     ADD +1                      TO  WMS-PD-CNT (Y).              1002953
487635     IF  X EQUAL ZERO                                             1002953
487640         GO  TO  R0506.                                           1002953
487650     SUBTRACT +1               FROM  WMS-PD-CNT (X).              1002953
487660     IF  WMS-PD-CNT (X) LESS THAN ZERO                            1002953
487670         MOVE ZERO               TO  WMS-PD-CNT (X).              1002953
487680     GO  TO  R0506.                                               1002953
487690 R0508.                                                           1002953
487700     IF  PAST-DUE-UPDATE-FLAG EQUAL 'Y'                           1002953
487710         MOVE '17'               TO  IMEX-REC-NO                  1002953
487720         MOVE 'P1'               TO  IMEX-CODE-1                  1002953
487730         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 1002953
487740     GO  TO  R0520.                                               1002953
487750*                                                                 1002953
487760 R0510.                                                           1002953
487770     IF  WMS-BILL-DUE-STAT (Z) EQUAL '4'                          1002953
487780         GO  TO  R0510-01.                                        1002953
487790     IF  WMS-BILL-DUE-STAT (Z) EQUAL '3'                          1002953
487800         MOVE '4'                TO  WMS-BILL-DUE-STAT (Z)        1002953
487810         GO  TO  R0510-01.                                        1002953
487820     IF  CURR-PAST-DUE-DAYS NOT GREATER THAN WMS-PAST-DUE-DAYS    1002953
487830     AND WMS-BILL-DUE-STAT (Z) EQUAL ZERO                         1002953
487840         MOVE '1'                TO  WMS-BILL-DUE-STAT (Z)        1002953
487850         ADD WMS-BILL-DUE-AMT (Z)                                 1002953
487860                                 TO  WMS-PAST-DUE-AMT             1002953
487865         PERFORM X0950-CAPITALIZE-INTEREST THRU X0950-EXIT        9915852
487870         GO  TO  R0510-01.                                        1002953
487880     IF  CURR-PAST-DUE-DAYS NOT GREATER THAN WMS-PAST-DUE-DAYS    1002953
487890     AND WMS-BILL-DUE-STAT (Z) EQUAL '1'                          1002953
487900         MOVE '2'                TO  WMS-BILL-DUE-STAT (Z)        1002953
487910         GO  TO  R0510-01.                                        1002953
487920     IF  CURR-PAST-DUE-DAYS GREATER THAN WMS-PAST-DUE-DAYS        1002953
487930     AND WMS-BILL-DUE-STAT (Z) EQUAL ZERO                         1002953
487940         MOVE '3'                TO  WMS-BILL-DUE-STAT (Z)        1002953
487945         PERFORM X0950-CAPITALIZE-INTEREST THRU X0950-EXIT        9915852
487950         ADD WMS-BILL-DUE-AMT (Z)                                 1002953
487960                                 TO WMS-PAST-DUE-AMT              1002953
487970         GO  TO  R0510-01.                                        1002953
487980     IF  CURR-PAST-DUE-DAYS GREATER THAN WMS-PAST-DUE-DAYS        1002953
487990     AND (WMS-BILL-DUE-STAT (Z) EQUAL '1' OR '2')                 1002953
488000         MOVE '3'                TO  WMS-BILL-DUE-STAT (Z).       1002953
488010 R0510-01.                                                        1002953
488020     IF  WMS-BILL-DUE-STAT (Z) GREATER THAN HOLD-BILL-DUE-STAT    1002953
488030         MOVE WMS-BILL-DUE-STAT (Z)                               1002953
488040                                 TO  HOLD-BILL-DUE-STAT.          1002953
488050 R0510-02.                                                        1002953
488060     IF  WMS-BILL-DUE-DATE (Z) EQUAL SPACES                       1002953
488070         GO  TO  R0510-EXIT.                                      1002953
488080     IF  HOLD-BILL-DUE-DATE EQUAL SPACES                          1002953
488090         MOVE WMS-BILL-DUE-DATE (Z)                               1002953
488100                                 TO  HOLD-BILL-DUE-DATE           1002953
488110         GO  TO  R0510-EXIT.                                      1002953
488120     MOVE '44'                   TO  SICOMPDT-DATE-FORMATS.       1002953
488130     CALL 'SICOMPDT'          USING  WMS-BILL-DUE-DATE (Z)        1002953
488140                                     HOLD-BILL-DUE-DATE           1002953
488150                                     SICOMPDT-RETURN-FLAG         1002953
488160                                     SICOMPDT-DATE-FORMATS.       1002953
488170     IF  SICOMPDT-RETURN-FLAG EQUAL 'L'                           1002953
488180         MOVE WMS-BILL-DUE-DATE (Z)                               1002953
488190                                 TO  HOLD-BILL-DUE-DATE.          1002953
488200 R0510-EXIT.                                                      1002953
488210       EXIT.                                                      1002953
488220*                                                                 1002953
490150 R0520.
490160*                                                                 1002953
490200*----------------------------------------------------------------*1002953
490250*    USER EXIT COPY AREA                                         *1002953
490320*    THE USER MAY SET THE WMS-DAYS-SINCE-PNLTY IN THIS USER EXIT *1002953
490380*    TO ALLOW R0600 PARA TO PERFORM THE LATE CHARGE PARAGRAPHS   *1002953
490440*    IF A LATE CHARGE OR EXTENSION CHARGE IS NEEDED OTHER THAN AT*1002953
490500*    BOUNDARY TIME. THIS IS JUST AN EXAMPLE OF HOW THIS EXIT MAY *1002953
490670*    BE USED.                                                    *1002953
490740*                                                                *1002953
490810*    COPY IM31UBWR.                                              *1002953
490880*                                                                *1002953
490950*    END OF USER EXIT.                                           *1002953
491020*----------------------------------------------------------------*1002953
491030*                                                                 1002953
492000     IF  HOLD-BILL-DUE-STAT EQUAL ZERO                            1002953
492010         MOVE ZERO               TO  WMS-PAST-DUE                 1002953
492020         MOVE SPACES             TO  WMS-PAST-DUE-DATE            1002953
492030         GO  TO  R0600-EXIT.                                      1002953
492040     IF  WMS-PAST-DUE           EQUAL ZERO                        1002953
492050     AND HOLD-BILL-DUE-STAT NOT EQUAL ZERO                        1002953
492070         MOVE ZERO               TO  WMS-DAYS-SINCE-PNLTY         1002953
492085                                     WK-HOLD-AMT13                9915845
492090         PERFORM R0550 THRU R0584.                                1002953
492100     IF  WMS-PAST-DUE       NOT EQUAL ZERO                        1002953
492110     AND HOLD-BILL-DUE-STAT NOT EQUAL ZERO                        1002953
492120         PERFORM R0600 THRU R0600-EXIT.                           1002953
492130     IF  HOLD-BILL-DUE-STAT GREATER THAN '2'                      1002953
492140         MOVE '2'                TO  WMS-LOAN-STATUS              1002953
492150         MOVE ZERO               TO  WMS-PDUE-DAYS-AFTER-NTC      1002953
492160         PERFORM R0530 THRU R0530-EXIT.                           1002953
492170     IF  HOLD-BILL-DUE-STAT LESS THAN '3'                         1002953
492180     AND WMS-PAST-DUE GREATER THAN '2'                            1002953
492190     AND WMS-AUTO-REACTIVATE EQUAL '1'                            1002953
492200         MOVE '1'                TO  WMS-LOAN-STATUS              1002953
492210         PERFORM R0530 THRU R0530-EXIT.                           1002953
492220     MOVE HOLD-BILL-DUE-STAT     TO  WMS-PAST-DUE.                1002953
492225     MOVE HOLD-BILL-DUE-MM       TO  WMS-PAST-DUE-MO.             1002953
492226     MOVE HOLD-BILL-DUE-DD       TO  WMS-PAST-DUE-DA.             1002953
492227     MOVE HOLD-BILL-DUE-YY       TO  WMS-PAST-DUE-YR.             1002953
492230     IF  WMS-PAST-DUE NOT EQUAL '2'                               1002953
492235         GO  TO  R0600-EXIT.                                      1002953
492240     IF  WMS-PDUE-NTC-DAYS EQUAL ZERO                             1002953
492245         GO  TO  R0600-EXIT.                                      1002953
492250     IF  WMS-PDUE-DAYS-AFTER-NTC NOT LESS THAN WMS-PDUE-NTC-DAYS  1002953
492260         MOVE ZERO               TO  WMS-PDUE-DAYS-AFTER-NTC.     1002953
492270     MOVE WBC-PROCESS-THRU-DATE  TO  DT-HIGH-DATE.                0266741
492280     MOVE WBC-LAST-PROC-THRU-DATE TO DT-LOW-DATE.                 0266741
492290     CALL 'SIDIF1'            USING  DATE-AREA.                   1002953
492300     ADD RET-DAYS                TO  WMS-PDUE-DAYS-AFTER-NTC.     1002953
492310     GO  TO  R0600-EXIT.                                          1002953
492315*                                                                 1002953
493020 R0530.                                                           IM003
493050     IF WK-LN-STATUS-IN NOT EQUAL WMS-LOAN-STATUS
493100         MOVE 'SU' TO IMEX-CODE-1
493150         MOVE 'SL' TO IMEX-CODE-2
493200         MOVE '09' TO IMEX-REC-NO
493250         MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
493300         MOVE WMS-LOAN-STATUS TO EX09-STATUS-OUT, WK-LN-STATUS-IN IM003
493350         MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
493400         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
493420 R0530-EXIT. EXIT.                                                IM003
493450 R0550.
493500     IF WMS-PNLTY-CODE EQUAL TO '0' GO TO R0584.                  IM002
493520     IF WMS-WAIVE-FEE EQUAL TO '1' GO TO R0584.                   IM002
493600     IF WMS-PNLTY-CODE EQUAL TO '1'
493650         MOVE WMS-PNLTY-AMT TO WK-HOLD-AMT13                      9915845
493700         GO TO R0570.
493750*  --AT THIS POINT, 'WMS-PNLTY-CODE' MUST BE '2'.                 IM002
493800     IF WBC-LATE-CHG-PHASE EQUAL TO SPACES                        0266741
493850         MOVE ZERO TO WK-HOLD-AMT13                               9915845
493900         GO TO R0570.
493950     MOVE WBC-LATE-CHG-PHASE TO IM31-PH2.                         0266741
494000     CALL 'SILINK' USING IM31-PHASE
494050                           MASTER-AREA
494100                           WK-HOLD-AMT13                          9915845
494110                           DDA-WRKBCR-1.                          0266741
494150 R0570.
494200     IF WK-HOLD-AMT13 EQUAL TO ZERO, GO TO R0584.                 9915845
494250     PERFORM R3642 THRU R3642-EXIT.
494300     MOVE WK-HOLD-AMT13 TO OTH-DISB, FEE-CHG.                     9915845
494350     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
494400     ADD WK-HOLD-AMT13 TO WMS-OTHER-CHGS WMS-FEE-THIS-CY WMS-FEES.9915845
494450     ADD WK-HOLD-AMT13 TO WMS-BILLED-FEES, WMS-LOAN-YTD-FEES.     9915845
494500     ADD +1    TO LOAN-GEN-FEE-NO, LOAN-DB-NO, WS-GL-LOAN-DB-NO,  0902970
494501                                          WS-GL-LOAN-GEN-FEE-NO.  0902970
494530     ADD WK-HOLD-AMT13 TO LOAN-GEN-FEE-AMT                        9915845
494531                          WS-GL-LOAN-GEN-FEE-AMT                  0902970
494600                          LOAN-DB-AMT                             0902477
494601                          WS-GL-LOAN-DB-AMT                       0902970
494650                          LOAN-DR-OTH, WS-GL-LOAN-DR-OTH.         0902970
494700     MOVE WBC-GENERATED-TRANS (17) TO GEN-TRAN-OPTION-HOLD.       0266741
494750     MOVE WK-HOLD-AMT13 TO HOLD-AMT.                              9915845
494800     MOVE '6' TO EX01-TYPE.
494850     MOVE '17' TO EX01-INT-CODE.
494900     MOVE 'G5' TO IMEX-CODE-2.
494950     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
494970     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-LATE-CHG.             0266741
495000 R0584.  EXIT.
495002*                                                                 1003625
495004*--------------------------------------------------------------*  1002953
495006*  THE R0600 PARAGRAPH IS SET UP TO ALLOW A CALL TO THE LATE   *  1002953
495008*  CHARGE PHASE AFTER THE INITIAL CALL WHEN AN ACCOUNT GOES    *  1002953
495010*  PAST DUE OR DELINQUENT.  THE LATE CHARGE PHASE CAN TELL THE *  1002953
495012*  THE REASON FOR THE CALL BY TESTING THE WMS-DAYS-SINCE-PNLTY *  1002953
495014*  AND THE WMS-PAST-DUE FLAG (WMS-PAST-DUE WILL BE EQUAL TO 0  *  1002953
495016*  FOR A FIRST TIME PAST DUE AND 1 THRU 4 ON THE NEXT PAST DUE *  1002953
495018*  BOUNDARY).                                                  *  1002953
495020*--------------------------------------------------------------*  1002953
495022*                                                                 1002953
495408 R0600.                                                           IM002
495417     IF  WMS-PNLTY-DAYS EQUAL +0                                  IM008
495418         GO TO R0600-EXIT.                                        IM008
495419     IF  WMS-PNLTY-CODE EQUAL ZERO                                1002953
495422         GO TO R0600-EXIT.                                        1002953
495425     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
495426     MOVE WBC-LAST-CAPTURE-DATE TO DT-LOW-DATE.                   0266741
495427     CALL 'SIDIF1' USING DATE-AREA.                               IM004
495428     ADD RET-DAYS TO WMS-DAYS-SINCE-PNLTY.                        IM004
495429     IF  WMS-DAYS-SINCE-PNLTY NOT LESS THAN WMS-PNLTY-DAYS        IM004
495431         MOVE +0 TO WK-HOLD-AMT13                                 9915845
495434         PERFORM R0550 THRU R0584                                 IM004
495437         MOVE +0 TO WMS-DAYS-SINCE-PNLTY.                         IM004
495440 R0600-EXIT. EXIT.                                                IM004
495450     SKIP3
495451*    ************  EXPEDITED FUNDS ANALYSIS  ***************      IM007
495452     SKIP1                                                        IM007
495453 R0700.                                                           IM007
495456     IF  CALL-EFAA-FLAG EQUAL '0'                                 1003508
495457         IF  WMS-EFA-TRLR EQUAL '0'                               1003508
495458             GO TO R0800                                          1003508
495459         ELSE                                                     1003508
495460             IF  WMS-EFA-NEW-ACCT-FLAG EQUAL '0'                  1003508
495461             AND NSF-CTR EQUAL +0                                 1003508
495462             AND OD-CTR  EQUAL +0                                 1003508
495463                 GO TO R0800.                                     1003508
495466     IF  WBC-EFA-PHASE EQUAL SPACES                               0266741
495468         GO TO R0800.                                             IM008
495470     MOVE WBC-EFA-PHASE TO IM31-PH2.                              0266741
495472     CALL 'SILINK' USING IM31-PHASE                               IM008
495474                         MASTER-AREA                              IM008
495476                         WORK-BCA-AGGREGATES-AREA                 IM008
495478                         DDA-WRKBCR-1                             0266741
495480                         DDA-WRKBCR-5                             0266741
495482                         OD-CTR                                   IM008
495484                         NSF-CTR                                  IM008
495485                         NSF-RVRSL-CTR                            1104882
495486                         HOLD-EFA-NSF-AMT                         IM008
495488                         SEND-EFAA-NOTICE                         IM008
495490                         EXCEPTION-AREA                           IM008
495492                         EX-SEQ-CTR                               IM008
495494                         TRIAL-CONTROL                            IM008
495496                         DDA-CASH-AVAIL-AMT                       IM008
495497                         WS-GL-DDA-CASH-AVAIL-AMT                 0902970
495498                         DDA-CUST-AVAIL-AMT                       IM008
495499                         WS-GL-DDA-CUST-AVAIL-AMT                 0902970
495500                         CALL-EFAA-FLAG                           IM008
495502                         TRAN-1                                   0627536
495503                         NON-EFAA-ACCOUNT.                        0627536
495504 R0800.                                                           IM008
495505     IF  AFF-FLAG             EQUAL 'N'                           0927817
495506         MOVE WFF-FLOAT-01-12    TO WMS-CUST-AVAIL-TRAILER        0927817
495507         ADD  WFF-TOTAL-13-99    TO WMS-CUST-AVAIL-FUNDS (12).    0927817
495508     MOVE +1 TO X.                                                0927817
495509 R0810.                                                           0927817
495510     IF  X GREATER THAN +12                                       IM008
495512         GO TO R0820.                                             0927817
495514     IF  WMS-BANK-AVAIL-TRLR EQUAL '1'                            IM008
495516     AND X LESS THAN +8                                           IM008
495518         ADD WORK-BCA-51-AMT (X) TO WMS-BANK-AVAIL-TR-AMT (X).    IM008
495520     IF  WMS-CUST-AVAIL-TRLR EQUAL '1'                            IM008
495522     AND X LESS THAN +13                                          IM008
495523     AND AFF-FLAG            EQUAL 'F'                            0927817
495524         ADD WORK-BCA-52-AMT (X) TO WMS-CUST-AVAIL-FUNDS (X)      IM008
495528         ADD WORK-BCA-54-AMT (X) TO WMS-CUST-AVAIL-FUNDS (X)      IM008
495530         ADD WORK-BCA-55-AMT (X) TO WMS-CUST-AVAIL-FUNDS (X)      IM008
495532         ADD WORK-BCA-56-AMT (X) TO WMS-CUST-AVAIL-FUNDS (X)      IM008
495534         ADD WORK-BCA-57-REDEP (X) TO WMS-CUST-AVAIL-FUNDS (X)    IM008
495536         ADD WORK-BCA-57-RCTDC (X) TO WMS-CUST-AVAIL-FUNDS (X)    IM008
495538         ADD WORK-BCA-57-LWRSK (X) TO WMS-CUST-AVAIL-FUNDS (X).   IM008
495540     ADD +1 TO X.                                                 IM008
495542     GO TO R0810.                                                 IM008
495544     SKIP3                                                        IM008
495546 R0820.                                                           0927817
495548     IF  AFF-FLAG             EQUAL 'N'                           0927817
495550     AND AFF-MAX-ENTRY GREATER THAN +12                           0927817
495552         MOVE '17'               TO IMEX-REC-NO                   0927817
495554         MOVE 'FF'               TO IMEX-CODE-1                   0927817
495556         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 0927817
495558     SKIP3                                                        0927817
495580 ROOT-SECTION-L      SECTION 1.                                   0927817
495590     SKIP3                                                        0927817
495600*    ************  OVERDRAFT CHARGE GENERATION  ************
495650     SKIP1
495700 R1100.
495750     IF NSF-TOTAL EQUAL TO ZERO
495800         GO TO R1110.
495850     IF WMS-SAV-PTR NOT EQUAL ZERO                                IM004
495900         MOVE 'KA' TO IMEX-CODE-1
495950     ELSE
496000         IF  WMS-SAVINGS-TRLR EQUAL '1'                           IM004
496010             MOVE 'KB' TO IMEX-CODE-1                             IM004
496020         ELSE                                                     IM004
496030             MOVE 'KC' TO IMEX-CODE-1.                            IM004
496050     MOVE '02' TO IMEX-REC-NO.
496100     MOVE NSF-TOTAL TO EX02-BAL.
496150     PERFORM WRITE-EX-MST  THRU WRITE-EX-EXIT.
496200     MOVE ZERO TO NSF-TOTAL.
496250 R1110.
496300     IF  WMS-SAV-PTR EQUAL ZERO AND WMS-CHG-CARD-FLG EQUAL '0'    IM004
496310         NEXT SENTENCE                                            IM004
496320     ELSE GO TO R1130.                                            IM004
496400     IF  WMS-STATUS EQUAL '05' OR '08'
496450         MOVE ZERO TO OD-CTR
496500                      NSF-CTR                                     IM003
496510         GO  TO  R1190.                                           IM003
496550     IF OD-TODAY EQUAL TO '1'
496600         ADD +1 TO WMS-DAYS-OD-TO-DATE
496650                   WMS-SC-OD-TIMES
496700                   WMS-MTD-OD-TIMES.
496702     SUBTRACT OD-CTR-FDIC, ATM-POS-OD-CTR FROM OD-CTR.            1020116
496704     IF  OD-CTR LESS THAN ZERO                                    0927850
496706         MOVE ZERO TO OD-CTR.                                     0927850
496750     IF OD-CTR EQUAL TO ZERO, GO TO R1130.                        0547276
496800     IF WMS-OD-WAIVE EQUAL TO '1', GO TO R1130.
496850     IF WMS-OD-OVERDRAFT EQUAL TO '0', GO TO R1130.
496860     IF  WBC-ONLINE-NSF-OD-CHRG EQUAL '2' OR '3' OR '6' OR '7'    0547262
496862                                   OR '1'                         0547262
496864         GO TO R1130.                                             0547262
496900     ADD CUR-BAL WMS-OD-MIN-AMT GIVING DIFF-AMT.
496950     IF DIFF-AMT GREATER THAN ZERO
497000         GO TO R1130.
497050     IF WMS-OD-OVERDRAFT EQUAL TO '2'
497100         MOVE WMS-OD-CHG TO HOLD-AMT
497150     ELSE MULTIPLY WMS-OD-CHG BY OD-CTR GIVING HOLD-AMT.
497200     IF WMS-OD-MAX-CHG NOT EQUAL TO ZERO
497250         IF HOLD-AMT GREATER THAN WMS-OD-MAX-CHG
497300             MOVE WMS-OD-MAX-CHG TO HOLD-AMT.
497302     IF  HOLD-AMT LESS THAN WMS-OD-MIN-CHG                        0827728
497304         MOVE WMS-OD-MIN-CHG TO HOLD-AMT.                         0827728
497350     ADD +1 TO FS-DB.
497400     PERFORM K7500 THRU K8500.
497450     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL.      IM003
497500     ADD +1 TO DDA-OD-CHG-NO, WS-GL-DDA-OD-CHG-NO.                0902970
497550     ADD HOLD-AMT TO DDA-OD-CHG-AMT, WS-GL-DDA-OD-CHG-AMT.        0902970
497600     ADD +1 TO WMS-STMT-NO-DEBITS.
497650     ADD HOLD-AMT TO WMS-STMT-DR-AMT                              1004773
497660                     WBC-REG-TFR-AMT (4)                          0266741
497670                     WBC-REG-CALL-AMT (13).                       0266741
497700     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
497750     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
497800         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
497850         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
497900     ELSE
497950         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
498000         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
498050     MOVE WBC-GENERATED-TRANS (3) TO GEN-TRAN-OPTION-HOLD.        0266741
498100     MOVE 'G1' TO IMEX-CODE-2.
498150     MOVE '03' TO EX01-INT-CODE.
498200     MOVE '4' TO EX01-TYPE.
498250     MOVE ZERO TO EX01-NUMBER.
498300     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
498310     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1004015
498320     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-CTD.                 0627451
498322     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-YTD.                 0627451
498330 R1130.                                                           0920032
498331*----------------------------------------------------------------*0920032
498332*    IF THE ACCOUNT HAS AN OD LIMIT CODE OF 'S',  PERFORM THE    *0920032
498333*    SCORING MODULE, UPDATE THE ACCOUNT WITH THE NEW OD LIMIT    *0920032
498334*    AMOUNT, AND CREATE AN EXCEPTION RECORD.                     *0920032
498335*----------------------------------------------------------------*0920032
498336     IF  WMS-OD-LIMIT     EQUAL 'S'                               0920032
498338         PERFORM X0700-SCORE-ACCT THRU X0700-SCORE-EXIT.          0920032
498340     MOVE ZERO TO OD-CTR.                                         0920032
498341     MOVE ZERO TO ATM-POS-OD-CTR.                                 1020116
498342 R1140.                                                           0920032
498343*----------------------------------------------------------------*0920032
498344*  SET/RESET DATE OVER OD LIMIT IF ACCOUNT HAS EXCEEDED OD LIMIT,*0920032
498345*  REGARDLESS OF OTHER OD PERIODIC CHARGE OPTIONS AND SETTINGS.  *0920032
498346*  MUST FIRST DETERMINE IF OVER OD LIMIT.                        *0920032
498347*----------------------------------------------------------------*0920032
498348     IF  WMS-OD-LIMIT     EQUAL 'N'                               0920032
498350         MOVE ZERO               TO OD-PER-MIN-AMT-HOLD           0920032
498352     ELSE                                                         0920032
498354     IF  WMS-OD-LIMIT     EQUAL 'A'                               0920032
498356         MOVE +9999999999999.99  TO OD-PER-MIN-AMT-HOLD           0920032
498358     ELSE                                                         0920032
498360     IF  WMS-OD-LIMIT     EQUAL '0' OR 'L' OR 'S'                 0920032
498362         MOVE WMS-OD-LIMIT-AMT   TO OD-PER-MIN-AMT-HOLD           0920032
498364     ELSE                                                         0920032
498366         MOVE WBC-OD-LIMIT (WMS-OD-LIMIT-9)                       0920032
498368                                 TO OD-PER-MIN-AMT-HOLD.          0920032
498370     MULTIPLY -1                 BY OD-PER-MIN-AMT-HOLD.          0920032
498372     IF  OD-PER-MIN-AMT-HOLD NOT GREATER THAN WMS-CURR-BAL        0920032
498378         MOVE SPACES TO WMS-OVER-OD-LIMIT-DATE                    0547276
498379     ELSE                                                         0547276
498380     IF  WMS-OVER-OD-LIMIT-DATE EQUAL SPACES                      0547276
498381         MOVE WBC-CAPTURE-MO     TO  WMS-OVER-OD-LIMIT-MO         0547276
498382         MOVE WBC-CAPTURE-DA     TO  WMS-OVER-OD-LIMIT-DA         0547276
498383         MOVE WBC-CAPTURE-YR     TO  WMS-OVER-OD-LIMIT-YR         0547276
498384         MOVE '20'               TO  WMS-OVER-OD-LIMIT-CC.        0547276
498385*                                                                 0547276
498386*  CALCULATE THE DAYS BETWEEN THE OVER OD DATE AND TODAY.         0547276
498387*                                                                 0547276
498388     IF  WMS-OVER-OD-LIMIT-DATE EQUAL SPACES                      0920032
498390         MOVE ZERO TO WMS-OVER-OD-DAYS                            0920032
498392     ELSE                                                         0920032
498394         IF  WMS-OVER-OD-DAYS GREATER THAN ZERO                   0920032
498396             ADD WBC-ACCRUAL-DAYS TO WMS-OVER-OD-DAYS             0920032
498398             ADD WBC-PAST-ACCR-DAYS TO WMS-OVER-OD-DAYS           0920032
498400         ELSE                                                     0920032
498402             ADD WBC-ACCRUAL-DAYS TO WMS-OVER-OD-DAYS.            0920032
498403                                                                  0547276
498404     IF  WMS-OD-PER-MIN-AMT NOT EQUAL +9999999999999.99           0547276
498405         MULTIPLY WMS-OD-PER-MIN-AMT BY -1                        0547276
498406         GIVING OD-PER-MIN-AMT-HOLD.                              0547276
498407*                                                                 0547276
498408*----------------------------------------------------------------*0547276
498409*    DO NOT CHARGE IF OD PERIODIC CHARGE FLAG IS SET TO NO CHARGE*0547276
498410*----------------------------------------------------------------*0547276
498411***  AVOIDS PERIODIC CHARGES IN STATIC RUN                        0547276
498412     IF  WBC-RUN-FLAG EQUAL 'I' OR                                0547276
498413         WMS-OD-PER-CHRG-FLAG EQUAL '0'                           0547276
498414         GO TO R1150.                                             0547276
498415*----------------------------------------------------------------*0547276
498416*    MAKE SURE THE ACCOUNT IS OVERDRAWN BY THE MINIMUM AMOUNT    *0547276
498417*----------------------------------------------------------------*0547276
498420     IF  WMS-CURR-BAL GREATER THAN OD-PER-MIN-AMT-HOLD            0920032
498421         GO TO R1150.                                             0547276
498422*----------------------------------------------------------------*0547276
498423*    ACCOUNT MUST BE OD GREATER THAN GRACE DAYS                  *0547276
498424*----------------------------------------------------------------*9916073
498425     IF  WMS-OD-PER-CHRG-FLAG EQUAL '1'                           0547276
498426         MOVE WMS-INTO-OD-MO      TO C-LOW-MO                     0547276
498427         MOVE WMS-INTO-OD-DA      TO C-LOW-DA                     0547276
498428         MOVE WMS-INTO-OD-YR      TO C-LOW-YR                     0547276
498429     ELSE                                                         0547276
498430         MOVE WMS-OVER-OD-LIMIT-MO TO C-LOW-MO                    0547276
498431         MOVE WMS-OVER-OD-LIMIT-DA TO C-LOW-DA                    0547276
498432         MOVE WMS-OVER-OD-LIMIT-YR TO C-LOW-YR.                   0547276
498433     MOVE '19'                TO C-LOW-CENT.                      0547276
498434     IF C-LOW-YR LESS THAN WBC-NEXT-CENT-YR                       0547276
498435         MOVE '20'            TO C-LOW-CENT.                      0547276
498436     MOVE WMS-OD-PER-GRACE-DAYS TO C-NO-DAYS.                     0547276
498437*----------------------------------------------------------------*9916073
498438*    CALCULATE GRACE CALENDAR DAYS FROM DATE INTO OVERDRAFT      *0547276
498439*----------------------------------------------------------------*0547276
498440     CALL 'SIDCHI' USING C-LOW-DATE, C-HIGH-DATE, C-NO-DAYS.      0547276
498441     MOVE WBC-CAPTURE-MO      TO C-LOW-MO.                        0547276
498442     MOVE WBC-CAPTURE-DA      TO C-LOW-DA.                        0547276
498443     MOVE WBC-CAPTURE-YR      TO C-LOW-YR.                        0547276
498444     MOVE '19'                TO C-LOW-CENT.                      0547276
498445     IF C-LOW-YR LESS THAN WBC-NEXT-CENT-YR                       0547276
498446         MOVE '20'            TO C-LOW-CENT.                      0547276
498447*----------------------------------------------------------------*0547276
498448*    IF CURRENT BCR PROCESS (CAPTURE) DATE LESS THAN             *0547276
498449*        DATE INTO OVERDRAWN PLUS GRACE CALENDAR DAYS, GET OUT   *0547276
498450*----------------------------------------------------------------*0547276
498451     IF C-LOW-DATE LESS THAN C-HIGH-DATE                          0547276
498452         GO TO R1150.                                             0547276
498453*----------------------------------------------------------------*0547276
498454*    ACCOUNT MUST NOT BE GREATER THAN (CHARGE DAYS + GRACE DAYS) *0547276
498455*----------------------------------------------------------------*0547276
498456     IF  WMS-OD-PER-CHRG-FLAG EQUAL '1'                           0547276
498457         MOVE WMS-INTO-OD-MO      TO C-LOW-MO                     0547276
498458         MOVE WMS-INTO-OD-DA      TO C-LOW-DA                     0547276
498459         MOVE WMS-INTO-OD-YR      TO C-LOW-YR                     0547276
498460     ELSE                                                         0547276
498461         MOVE WMS-OVER-OD-LIMIT-MO TO C-LOW-MO                    0547276
498462         MOVE WMS-OVER-OD-LIMIT-DA TO C-LOW-DA                    0547276
498463         MOVE WMS-OVER-OD-LIMIT-YR TO C-LOW-YR.                   0547276
498464     MOVE '19'                TO C-LOW-CENT.                      0547276
498465     IF C-LOW-YR LESS THAN WBC-NEXT-CENT-YR                       0547276
498466         MOVE '20'            TO C-LOW-CENT.                      0547276
498467     MOVE WMS-OD-PER-CHRG-DAYS TO C-NO-DAYS.                      0547276
498468     ADD WMS-OD-PER-GRACE-DAYS TO C-NO-DAYS.                      0547276
498469     CALL 'SIDCHI' USING C-LOW-DATE, C-HIGH-DATE, C-NO-DAYS.      0547276
498470     MOVE WBC-CAPTURE-MO      TO C-LOW-MO.                        0547276
498471     MOVE WBC-CAPTURE-DA      TO C-LOW-DA.                        0547276
498472     MOVE WBC-CAPTURE-YR      TO C-LOW-YR.                        0547276
498473     MOVE '19'                TO C-LOW-CENT.                      0547276
498474     IF C-LOW-YR LESS THAN WBC-NEXT-CENT-YR                       0547276
498475         MOVE '20'            TO C-LOW-CENT.                      0547276
498476*----------------------------------------------------------------*9916073
498477*    IF CURRENT BCR PROCESS (CAPTURE) DATE GREATER THAN OR EQUAL *0547276
498478*     TO DATE INTO OVERDRAWN PLUS CHARGE AND GRACE DAYS, GET OUT *0547276
498479*----------------------------------------------------------------*0547276
498480     IF C-LOW-DATE EQUAL TO C-HIGH-DATE                           0547276
498481     OR C-LOW-DATE GREATER THAN C-HIGH-DATE                       0547276
498482         GO TO R1150.                                             0547276
498483*----------------------------------------------------------------*0547276
498484*    ACCOUNT MUST NOT HAVE HAD ACTIVITY TODAY                    *0547276
498485*----------------------------------------------------------------*0547276
498486     IF WMS-TODAYS-CREDITS GREATER THAN ZERO                      0547276
498487     OR WMS-TODAYS-DEBITS GREATER THAN ZERO                       0547276
498488         GO TO R1150.                                             0547276
498489*----------------------------------------------------------------*0547276
498490*    IF REG E IN EFFECT FOR THIS ACCOUNT DO NOT CHARGE.          *1020116
498491*    NOT OPTED-IN AND THERE ARE ATM/POS NON RECURRING DEBITS     *1020116
498492*    SINCE THE ACCOUNT WENT NEGATIVE.                            *1020116
498493*----------------------------------------------------------------*1020116
498494     IF  ((WS-REGE-EFF EQUAL 'A' OR 'Y')                          1020116
498495     AND (WMS-OD-REGE-OPT-CODE EQUAL '2')                         1020116
498496     AND (WMS-OD-REGE-SUST-CTR GREATER THAN ZERO))                1020116
498497         GO TO R1150.                                             1020116
498498*----------------------------------------------------------------*1020116
498499*    IF REG E IN EFFECT FOR THIS ACCOUNT DO NOT CHARGE.          *1020116
498500*    CHANGED TO OPT-IN TODAY (CANNOT CHARGE THE DAY IT CHANGED   *1020116
498501*    TO OPT-IN).                                                 *1020116
498502*----------------------------------------------------------------*1020116
498504     IF  ((WS-REGE-EFF EQUAL 'A' OR 'Y')                          1020116
498505     AND (OD-REGE-OPT-CODE-IN EQUAL '2' AND                       1020116
498506          (WMS-OD-REGE-OPT-CODE EQUAL '0' OR '1'))                1020116
498507     AND (WMS-OD-REGE-SUST-CTR GREATER THAN ZERO))                1020116
498508         GO TO R1150.                                             1020116
498509*----------------------------------------------------------------*1020116
498510*    CHARGE THIS ACCOUNT OD CHARGE TODAY                         *1020116
498511*----------------------------------------------------------------*1020116
498512     MOVE WMS-OD-PER-CHRG-AMT TO HOLD-AMT.                        1020116
498513     ADD +1 TO FS-DB.                                             1020116
498514     PERFORM K7500 THRU K8500.                                    1020116
498515     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL.      1020116
498516     ADD +1 TO DDA-OD-CHG-NO, WS-GL-DDA-OD-CHG-NO.                1020116
498517     ADD HOLD-AMT TO DDA-OD-CHG-AMT, WS-GL-DDA-OD-CHG-AMT.        1020116
498518     ADD +1 TO WMS-STMT-NO-DEBITS.                                1020116
498519     ADD HOLD-AMT TO WMS-STMT-DR-AMT,                             1020116
498520                     WBC-REG-TFR-AMT (4), WBC-REG-CALL-AMT (13).  1020116
498521     IF WMS-IOD-RATE-PTR GREATER THAN ZERO                        1020116
498522     OR WMS-HIFI-INDICATOR GREATER THAN ZERO                      1020116
498523         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     1020116
498524         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             1020116
498525     ELSE                                                         1020116
498526         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     1020116
498527         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            1020116
498528     MOVE WBC-GENERATED-TRANS (3) TO GEN-TRAN-OPTION-HOLD.        1020116
498529     IF  GT-MNEUMONIC EQUAL SPACES                                1020116
498530         MOVE 'OD' TO GT-MNEUMONIC.                               1020116
498531     MOVE 'GI' TO IMEX-CODE-2.                                    1020116
498532     MOVE '03' TO EX01-INT-CODE.                                  1020116
498533     MOVE '4'  TO EX01-TYPE.                                      1020116
498534     MOVE ZERO TO EX01-NUMBER.                                    1020116
498535     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 1020116
498536     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1020116
498537     SKIP3                                                        1020116
498538     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-CTD.                 1020116
498539     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-YTD.                 1020116
498540*    ***************  NSF CHARGE GENERATION  ***************      1020116
498550     SKIP1
498600 R1150.
498650     IF  WMS-SAV-PTR EQUAL ZERO AND WMS-CHG-CARD-FLG EQUAL '0'    IM004
498660         NEXT SENTENCE                                            IM004
498670     ELSE GO TO R1160.                                            IM004
498750     IF NSF-TODAY EQUAL TO '1'
498800         ADD +1 TO WMS-DAYS-NSF-TO-DATE
498850                   WMS-SC-NSF-TIMES
498900                   WMS-MTD-NSF-TIMES.
498902     SUBTRACT NSF-CTR-FDIC, ATM-POS-NSF-CTR FROM NSF-CTR.         1020116
498904     IF  NSF-CTR LESS THAN ZERO                                   0927850
498906         MOVE ZERO TO NSF-CTR.                                    0927850
498950     IF NSF-CTR EQUAL TO ZERO, GO TO R1180.                       IM003
499000     IF WMS-NSF-WAIVE EQUAL TO '1', GO TO R1160.                  IM003
499020     IF WMS-NSF-CODE EQUAL TO '0', GO TO R1160.                   IM003
499030     IF  WBC-ONLINE-NSF-OD-CHRG EQUAL '3' OR '5' OR '7' OR '8'    0547262
499032                                   OR '1'                         0547262
499034         GO TO R1160.                                             0547262
499100     IF WMS-NSF-CODE EQUAL TO '2'
499150         MOVE WMS-NSF-CHG TO HOLD-AMT
499200     ELSE MULTIPLY WMS-NSF-CHG BY NSF-CTR GIVING HOLD-AMT.
499250     IF WMS-NSF-MAX-CHG NOT EQUAL TO ZERO
499300         IF HOLD-AMT GREATER THAN WMS-NSF-MAX-CHG
499350             MOVE WMS-NSF-MAX-CHG TO HOLD-AMT.
499400     ADD +1 TO FS-DB.
499450     PERFORM K7500 THRU K8500.
499500     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL, CUST-BAL.      IM003
499550     ADD +1 TO DDA-NSF-CHG-NO, WS-GL-DDA-NSF-CHG-NO.              0902970
499600     ADD HOLD-AMT TO DDA-NSF-CHG-AMT, WS-GL-DDA-NSF-CHG-AMT.      0902970
499650     ADD +1 TO WMS-STMT-NO-DEBITS.
499700     ADD HOLD-AMT TO WMS-STMT-DR-AMT                              1004773
499710                     WBC-REG-TFR-AMT (4)                          0266741
499720                     WBC-REG-CALL-AMT (13).                       0266741
499750     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
499800     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
499850         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
499900         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
499950     ELSE
500000         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
500050         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
500100     MOVE WBC-GENERATED-TRANS (4) TO GEN-TRAN-OPTION-HOLD.        0266741
500150     MOVE 'G2' TO IMEX-CODE-2.
500200     MOVE '04' TO EX01-INT-CODE.
500250     MOVE '4' TO EX01-TYPE.
500300     MOVE ZERO TO EX01-NUMBER.
500350     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
500360     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1004015
500370     ADD HOLD-AMT TO WMS-STMT-NSF-CHGD-CTD.                       0627451
500372     ADD HOLD-AMT TO WMS-STMT-NSF-CHGD-YTD.                       0627451
500400 R1160.                                                           IM003
500410*----------------------------------------------------------------*9915749
500411*    IF THE ACCOUNT HAS HAD NSF ITEMS TODAY AND ITS OD LIMIT FLAG*9915749
500412*    IS 'S', PERFORM THE SCORING MODULE, UPDATE THE ACCOUNT WITH *9915749
500414*    THE NEW OD LIMIT AMOUNT, AND CREATE AN EXCEPTION RECORD.    *9915749
500416*----------------------------------------------------------------*9915749
500418     IF  WMS-NSF-TODAY EQUAL '1'                                  9915749
500420     AND WMS-OD-TODAY EQUAL '0'                                   9915749
500422         IF  WMS-OD-LIMIT EQUAL 'S'                               9915749
500424             PERFORM X0700-SCORE-ACCT THRU X0700-SCORE-EXIT.      9915749
500450     MOVE ZERO TO NSF-CTR.
500451     MOVE ZERO TO ATM-POS-NSF-CTR.                                1020116
500500     SKIP3
500505*    ****  DRAWING AGAINST UNAVAILABLE CHARGE GENERATION  ****    0547262
500510     SKIP1                                                        0547262
500515 R1180.                                                           0547262
500520     IF  DAU-TODAY EQUAL TO '1'                                   0547262
500525         ADD +1 TO WMS-SC-UNAVAIL-TIMES                           0547262
500530                   WMS-MTD-UNAVAIL-TIMES.                         0547262
500531     SUBTRACT ATM-POS-DAU-CTR FROM DAU-CTR.                       1020116
500532     IF  DAU-CTR LESS THAN ZERO                                   1020116
500533         MOVE ZERO TO DAU-CTR.                                    1020116
500535     IF  DAU-CTR EQUAL TO ZERO                                    0547262
500540         GO TO R1200.                                             0547262
500545     MOVE ZERO TO HOLD-AMT.                                       0547262
500550     IF  WMS-DAU-WAIVE EQUAL TO '1'                               0547262
500555         GO TO R1190.                                             0547262
500560     IF  WMS-CUST-AVAIL-CODE EQUAL TO '0'                         0547262
500565         GO TO R1190.                                             0547262
500570     IF  WBC-ONLINE-NSF-OD-CHRG EQUAL '4' OR '5' OR '6' OR '7'    0547262
500580         GO TO R1190.                                             0547262
500590     ADD CUST-BAL WMS-DAU-MIN-AMT GIVING DIFF-AMT.                IM003
500591     IF  DIFF-AMT GREATER THAN ZERO                               IM003
500592         GO TO R1190.                                             IM003
500593     IF  WMS-CUST-AVAIL-CODE EQUAL TO '2'                         IM007
500594         MOVE WMS-CUST-AVAIL-CHG TO HOLD-AMT                      IM007
500595     ELSE                                                         IM003
500596         MULTIPLY WMS-CUST-AVAIL-CHG BY DAU-CTR GIVING HOLD-AMT.  IM007
500597     IF  WMS-DAU-MAX-CHG NOT EQUAL TO ZERO                        IM003
500598         IF  HOLD-AMT GREATER THAN WMS-DAU-MAX-CHG                IM003
500599             MOVE WMS-DAU-MAX-CHG TO HOLD-AMT.                    IM003
500600     ADD +1 TO FS-DB.                                             IM003
500601     PERFORM K7500 THRU K8500.                                    IM003
500602     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL                          IM003
500603                            CUR-BAL                               IM003
500604                            CUST-BAL.                             IM003
500605     ADD +1 TO DDA-DAU-CHG-NO, WS-GL-DDA-DAU-CHG-NO.              0902970
500606     ADD HOLD-AMT TO DDA-DAU-CHG-AMT, WS-GL-DDA-DAU-CHG-AMT.      0902970
500607     ADD +1 TO WMS-STMT-NO-DEBITS.                                IM003
500608     ADD HOLD-AMT TO WMS-STMT-DR-AMT                              1004773
500609                     WBC-REG-TFR-AMT (4)                          0266741
500610                     WBC-REG-CALL-AMT (13).                       0266741
500611     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       1004773
500612     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     1004773
500613         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     1004773
500614         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             1004773
500615     ELSE                                                         1004773
500616         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     1004773
500617         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
500619     MOVE WBC-GENERATED-TRANS (24) TO GEN-TRAN-OPTION-HOLD.       0266741
500621     MOVE 'GC' TO IMEX-CODE-2.                                    IM003
500623     MOVE '24' TO EX01-INT-CODE.                                  IM003
500625     MOVE '4' TO EX01-TYPE.                                       IM003
500627     MOVE ZERO TO EX01-NUMBER.                                    IM003
500629     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 IM003
500630     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1004015
500631     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-CTD                  0930023
500632                     WMS-STMT-OVERDRAFT-CHGD-YTD.                 0930023
500633 R1190.                                                           0930023
500634     MOVE ZERO TO DAU-CTR.                                        0930023
500635     MOVE ZERO TO ATM-POS-DAU-CTR.                                1020116
500636     SKIP3                                                        1020116
500637*    **************  STATEMENT DETERMINATION  **************      IM003
500639     SKIP1                                                        IM003
500650 R1200.
500660*----------------------------------------------------------------*1105504
500661*    BYPASS ALL STATEMENT RENDERING DURING STATIC RUN.           *1105504
500662*----------------------------------------------------------------*1105504
500664     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
500666     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
500668         GO TO R2675.                                             1105504
500670     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915845
500672         NEXT SENTENCE                                            9915845
500674     ELSE                                                         9915845
500700     IF (WMS-STATUS EQUAL '08' OR '05')
500750         IF  WMS-LOAN-TRLR EQUAL '1' AND
500800            (WMS-LOAN-STATUS EQUAL '3' OR '4')
500850             MOVE '1' TO BYPASS-ACTIVITY-SW
500900             GO  TO  R2500                                        9915845
500950         ELSE
501000         IF  WMS-LOAN-TRLR EQUAL '0'
501050             MOVE '1' TO BYPASS-ACTIVITY-SW
501100             GO  TO  R2500.                                       9915845
501150     IF WMS-STMT-PULL EQUAL TO 'G'
501200         MOVE WMS-STMT-FLD1 TO X
501250         MOVE '1' TO DDA-CYCLE (X)
501300         IF  WBC-STMT-CODE (X) GREATER THAN '0' AND NOT EQUAL '9' 0266741
501350             MOVE WBC-STMT-CODE (X) TO STMT-CYCLE-DAYX            0266741
501400             GO TO R1400
501450         ELSE GO TO R1500.
501500     IF WMS-STMT-PULL EQUAL TO 'E'
501550         IF WBC-MONTH-END EQUAL TO '1'                            0266741
501600             MOVE WBC-ACCRUAL-DAYS TO STMT-CYCLE-DAY              0266741
501650             GO TO R1400
501700         ELSE GO TO R1500.
501750     IF WMS-STMT-PULL EQUAL TO 'P'                                IM004
501760         MOVE '1' TO STMT-CYCLE-DAYX                              IM004
501770         GO TO R1400.                                             IM004
501780     IF WMS-STMT-PULL EQUAL TO 'A'                                IM004
501800         IF POST-TODAY EQUAL TO '1'
501850             MOVE '1' TO STMT-CYCLE-DAYX
501900             GO TO R1400
501950         ELSE GO TO R1500.
502000     IF WMS-STMT-PULL NOT EQUAL TO 'D',  GO  TO  R1230.
502050     MOVE +1 TO X.
502100 R1220.
502150     IF WMS-STMT-FLD (1) EQUAL TO WBC-STMT-CAL (X)                0266741
502200        IF  X LESS THAN WBC-ACCRUAL-DAYS                          0266741
502250            MOVE X TO STMT-CYCLE-DAY
502300            GO  TO  R1400
502350        ELSE
502400            MOVE WBC-ACCRUAL-DAYS TO STMT-CYCLE-DAY               0266741
502450            GO  TO  R1400.
502500     ADD +1 TO X.
502550     IF X GREATER THAN +8
502600         GO  TO  R1500.
502650     GO  TO  R1220.
502700 R1230.
502750     IF WMS-STMT-PULL EQUAL TO 'B'
502800         IF WMS-STMT-FLD (1) EQUAL TO WBC-STMT-BANK (1) OR        0266741
502830                                      WBC-STMT-BANK (2) OR        0266741
502860                                      WBC-STMT-BANK (3) OR        0266741
502890                                      WBC-STMT-BANK (4) OR        0266741
502920                                      WBC-STMT-BANK (5) OR        0266741
502950                                      WBC-STMT-BANK (6)           0266741
503100             MOVE '1' TO STMT-CYCLE-DAYX
503150             GO TO R1400
503200         ELSE GO TO R1500.
503250     IF WMS-STMT-PULL EQUAL TO 'W'
503300         MOVE WMS-STMT-FLD (1) TO HOLD-X
503350         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503400                             WBC-STMT-WK-DAY (2) OR               0266741
503450                             WBC-STMT-WK-DAY (3) OR               0266741
503500                             WBC-STMT-WK-DAY (4) OR               0266741
503550                             WBC-STMT-WK-DAY (5) OR               0266741
503600                             WBC-STMT-WK-DAY (6)                  0266741
503650             MOVE '1' TO STMT-CYCLE-DAYX
503700             GO TO R1400.                                         9915853
503701     IF  WMS-STMT-PULL EQUAL TO 'W'                               9915853
503702     AND WMS-STMT-FLD (2) NOT EQUAL SPACES                        9915853
503703         MOVE WMS-STMT-FLD (2) TO HOLD-X                          9915853
503704         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503705                             WBC-STMT-WK-DAY (2) OR               0266741
503706                             WBC-STMT-WK-DAY (3) OR               0266741
503707                             WBC-STMT-WK-DAY (4) OR               0266741
503708                             WBC-STMT-WK-DAY (5) OR               0266741
503709                             WBC-STMT-WK-DAY (6)                  0266741
503710             MOVE '1' TO STMT-CYCLE-DAYX                          9915853
503711             GO TO R1400.                                         9915853
503712     IF  WMS-STMT-PULL EQUAL TO 'W'                               9915853
503713     AND WMS-STMT-FLD (3) NOT EQUAL SPACES                        9915853
503714         MOVE WMS-STMT-FLD (3) TO HOLD-X                          9915853
503715         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503716                             WBC-STMT-WK-DAY (2) OR               0266741
503717                             WBC-STMT-WK-DAY (3) OR               0266741
503718                             WBC-STMT-WK-DAY (4) OR               0266741
503719                             WBC-STMT-WK-DAY (5) OR               0266741
503720                             WBC-STMT-WK-DAY (6)                  0266741
503721             MOVE '1' TO STMT-CYCLE-DAYX                          9915853
503722             GO TO R1400.                                         9915853
503723     IF  WMS-STMT-PULL EQUAL TO 'W'                               9915853
503724     AND WMS-STMT-FLD (4) NOT EQUAL SPACES                        9915853
503725         MOVE WMS-STMT-FLD (4) TO HOLD-X                          9915853
503726         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503727                             WBC-STMT-WK-DAY (2) OR               0266741
503728                             WBC-STMT-WK-DAY (3) OR               0266741
503729                             WBC-STMT-WK-DAY (4) OR               0266741
503730                             WBC-STMT-WK-DAY (5) OR               0266741
503731                             WBC-STMT-WK-DAY (6)                  0266741
503732             MOVE '1' TO STMT-CYCLE-DAYX                          9915853
503733             GO TO R1400.                                         9915853
503734     IF  WMS-STMT-PULL EQUAL TO 'T'                               9915853
503735     AND WMS-STMT-FLD (2) EQUAL '01'                              9915853
503736         MOVE WMS-STMT-FLD (1) TO HOLD-X                          9915853
503737         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503738                             WBC-STMT-WK-DAY (2) OR               0266741
503739                             WBC-STMT-WK-DAY (3) OR               0266741
503740                             WBC-STMT-WK-DAY (4) OR               0266741
503741                             WBC-STMT-WK-DAY (5) OR               0266741
503742                             WBC-STMT-WK-DAY (6)                  0266741
503743             MOVE '1'     TO STMT-CYCLE-DAYX                      9915853
503744             MOVE '02'    TO WMS-STMT-FLD (2)                     9915853
503745             GO TO R1400                                          9915853
503746          ELSE                                                    9915853
503747             GO TO R1500.                                         9915853
503748     IF  WMS-STMT-PULL EQUAL TO 'T'                               9915853
503749     AND WMS-STMT-FLD (2) EQUAL '02'                              9915853
503750         MOVE WMS-STMT-FLD (1) TO HOLD-X                          9915853
503751         IF HOLD-X2 EQUAL TO WBC-STMT-WK-DAY (1) OR               0266741
503752                             WBC-STMT-WK-DAY (2) OR               0266741
503753                             WBC-STMT-WK-DAY (3) OR               0266741
503754                             WBC-STMT-WK-DAY (4) OR               0266741
503755                             WBC-STMT-WK-DAY (5) OR               0266741
503756                             WBC-STMT-WK-DAY (6)                  0266741
503757             MOVE '01'    TO WMS-STMT-FLD (2)                     9915853
503760*----------------------------------------------------------------*9915845
503761*    THE FOLLOWING 'GO TO R1500' IS CORRECT.                     *9915845
503762*----------------------------------------------------------------*9915845
503768             GO TO R1500                                          9915845
503769          ELSE                                                    9915845
503770             GO TO R1500.                                         9915845
503800     IF WMS-STMT-PULL EQUAL TO 'F'
503850         MOVE WMS-STMT-FLD (1) TO HOLD-X
503900         MOVE HOLD-X2 TO SAVE-FLD2
503950         MOVE WMS-STMT-FLD (2) TO HOLD-X
504000         MOVE HOLD-X2 TO SAVE-FLD1
504050         IF SAVE-STMT-FIELD EQUAL TO WBC-STMT-WEEK (1) OR         0266741
504100                                      WBC-STMT-WEEK (2) OR        0266741
504150                                      WBC-STMT-WEEK (3) OR        0266741
504200                                      WBC-STMT-WEEK (4) OR        0266741
504250                                      WBC-STMT-WEEK (5) OR        0266741
504300                                      WBC-STMT-WEEK (6)           0266741
504350             MOVE '1' TO STMT-CYCLE-DAYX
504400             GO TO R1400
504450         ELSE GO TO R1500.
504500 R1280.
504550     IF WMS-STMT-PULL NOT EQUAL TO 'C', GO TO R1300.
504600     MOVE +1 TO X, Y.
504650 R1290.
504700     MOVE WMS-STMT-FLD (X) TO HOLD-X.
504750     IF HOLD-X EQUAL TO SPACES, GO TO R1295.
504800 R1292.
504850     IF  HOLD-X EQUAL TO WBC-STMT-CAL (Y)                         0266741
504900         IF  Y LESS THAN WBC-ACCRUAL-DAYS                         0266741
504950             MOVE Y TO STMT-CYCLE-DAY
505000             GO  TO  R1400
505050         ELSE
505100             MOVE WBC-ACCRUAL-DAYS TO STMT-CYCLE-DAY              0266741
505150             GO  TO  R1400.
505200     ADD +1 TO Y.
505250     IF  Y GREATER THAN +8
505300         MOVE +1 TO Y
505350         GO  TO  R1295.
505400     GO TO R1292.
505450 R1295.
505500     ADD +1 TO X.
505550     IF X GREATER THAN +4, GO TO R1500.
505600     GO TO R1290.
505650 R1300.
505700     IF  WMS-STMT-PULL NOT EQUAL 'Y', GO TO R1500.                IM005
505750     MOVE WBC-LAST-STMT-MO TO WORK-DATE1-MO.                      0266741
505800     MOVE WBC-LAST-STMT-DA TO WORK-DATE1-DA.                      0266741
505850     MOVE WBC-LAST-STMT-YR TO WORK-DATE1-YR.                      0266741
505860     IF  WORK-DATE1-YR LESS THAN WBC-NEXT-CENT-YR                 0266741
505870         MOVE '20'               TO WORK-DATE1-CC                 1004775
505880     ELSE                                                         1004775
505890         MOVE '19'               TO WORK-DATE1-CC.                1004775
505900     MOVE WBC-STMT-MO TO WORK-DATE3-MO.                           0266741
505950     MOVE WBC-STMT-DA TO WORK-DATE3-DA.                           0266741
506000     MOVE WBC-STMT-YR TO WORK-DATE3-YR.                           0266741
506010     IF  WORK-DATE3-YR LESS THAN WBC-NEXT-CENT-YR                 0266741
506020         MOVE '20'               TO WORK-DATE3-CC                 1004775
506030     ELSE                                                         1004775
506040         MOVE '19'               TO WORK-DATE3-CC.                1004775
506050     MOVE WBC-STMT-MO TO HOLD-X.                                  0266741
506100     IF  WBC-STMT-PULL-CODE EQUAL '0'                             0266741
506150         MOVE WBC-CAPTURE-MO TO HOLD-Y                            0266741
506200     ELSE                                                         IM005
506250         MOVE WBC-LAST-CAPTURE-MO TO HOLD-Y.                      0266741
506300     IF  HOLD-X EQUAL HOLD-Y, GO TO R1320.                        IM005
506302     MOVE '1' TO YPULL-FLAG.                                      ~~~0161
506350     IF  WMS-STMT-FLD (HOLD-9Y) EQUAL SPACES, GO TO R1320.        IM005
506352     IF  WMS-STMT-SUPP EQUAL '5'                                  0917791
506354     AND WMS-STMTS-EACH-MO (HOLD-9Y) EQUAL 0                      0917791
506356         GO TO R1320.                                             0917791
506400     IF  WBC-STMT-PULL-CODE EQUAL '0'                             0266741
506450         MOVE WBC-CAPTURE-YR TO WORK-DATE2-YR                     0266741
506500     ELSE                                                         IM005
506550         MOVE WBC-LAST-CAPTURE-YR TO WORK-DATE2-YR.               0266741
506560     IF  WORK-DATE2-YR LESS THAN WBC-NEXT-CENT-YR                 0266741
506570         MOVE '20'               TO WORK-DATE2-CC                 1004775
506580     ELSE                                                         1004775
506590         MOVE '19'               TO WORK-DATE2-CC.                1004775
506600     MOVE HOLD-Y TO WORK-DATE2-MO.                                IM005
506650     MOVE WMS-STMT-FLD (HOLD-9Y) TO WORK-DATE2-DA.                IM005
506700     IF  WORK-DATE2 GREATER THAN WORK-DATE1                       IM005
506750     AND WORK-DATE2 NOT GREATER THAN WORK-DATE3                   IM005
506800         MOVE '1' TO STMT-TODAY                                   IM005
506850         PERFORM R1330 THRU R1330-EXIT.                           IM005
506900 R1320.                                                           IM005
506950     MOVE WMS-STMT-FLD (HOLD-9) TO HOLD-DAY.                      IM005
507000     IF  HOLD-DAY EQUAL SPACES, GO TO R1500.                      IM005
507002     IF  WMS-STMT-SUPP EQUAL '5'                                  0917791
507004*    AND WMS-STMTS-EACH-MO (HOLD-9Y) EQUAL 0                      0917791
507006*        GO TO R1800.                                             0917791
507007         IF  (WMS-STMTS-EACH-MO (HOLD-9Y) EQUAL 0                 ~~~0161
507008         AND  YPULL-FLAG EQUAL '0')                               ~~~0161
507009              GO TO R1800.                                        ~~~0161
507010     IF  WMS-STMT-SUPP EQUAL '5'                                  ~~~0161
507012         IF  YPULL-FLAG EQUAL '1'                                 ~~~0161
507014             IF  (WMS-STMTS-EACH-MO (HOLD-9Y) EQUAL 0             ~~~0161
507016             AND  WMS-STMTS-EACH-MO (HOLD-9) EQUAL 0)             ~~~0161
507018                  GO TO R1800.                                    ~~~0161
507050     MOVE WBC-STMT-YR TO WORK-DATE2-YR.                           0266741
507060     IF  WORK-DATE2-YR LESS THAN WBC-NEXT-CENT-YR                 0266741
507070         MOVE '20'               TO WORK-DATE2-CC                 1004775
507080     ELSE                                                         1004775
507090         MOVE '19'               TO WORK-DATE2-CC.                1004775
507100     MOVE HOLD-X TO WORK-DATE2-MO.                                IM005
507150     MOVE WMS-STMT-FLD (HOLD-9) TO WORK-DATE2-DA.                 IM005
507200     IF  WORK-DATE2 GREATER THAN WORK-DATE1                       IM005
507250     AND WORK-DATE2 NOT GREATER THAN WORK-DATE3                   IM005
507300         PERFORM R1330 THRU R1330-EXIT                            IM005
507350         GO TO R1350.                                             IM005
507950     IF  WMS-STMT-SUPP EQUAL '5',  GO  TO  R1800.
508000     GO TO R1500.
508003 R1330.                                                           IM005
508006     MOVE +1 TO X.                                                IM005
508009 R1330-10.                                                        IM005
508012     IF  WORK-DATE2-DA EQUAL WBC-STMT-CAL (X)                     0266741
508015         IF  X LESS THAN WBC-ACCRUAL-DAYS                         0266741
508018             MOVE X TO STMT-CYCLE-DAY                             IM005
508021             GO R1330-EXIT                                        IM005
508024         ELSE                                                     IM005
508027             MOVE WBC-ACCRUAL-DAYS TO STMT-CYCLE-DAY              0266741
508030             GO R1330-EXIT.                                       IM005
508033     ADD +1 TO X.                                                 IM005
508036     IF  X LESS THAN +9                                           IM005
508039         GO TO R1330-10.                                          IM005
508042 R1330-EXIT. EXIT.                                                IM005
508050 R1350.
508100     IF WMS-STMT-SUPP NOT EQUAL TO '5', GO TO R1450.
508150     SUBTRACT +1 FROM WMS-STMTS-EACH-MO (HOLD-9).
508200     IF WMS-STMTS-EACH-MO (HOLD-9) LESS THAN '1', GO TO R1450.
508250     ADD WMS-STMT-BUMP-DAYS TO HOLD-DAY9.
508300     MOVE HOLD-DAY TO WMS-STMT-FLD (HOLD-9).
508350     GO TO R1450.
508400 R1400.
508450     IF WMS-STMT-SUPP EQUAL TO '4', GO TO R1600.
508500 R1450.
508550     MOVE '1' TO STMT-TODAY.
508600     GO  TO  R1800.
508650 R1500.
508700     IF WMS-STMT-SUPP EQUAL ' ' OR '0' OR '4' OR '5'              0901873
508750         GO  TO  R1800.
508800     IF WMS-STMT-SUPP EQUAL TO '2', GO TO R1520.
508850     IF WBC-MONTH-END EQUAL TO '1'                                0266741
508870         MOVE 'N' TO SUPP-STMT-SW                                 IM006
508900         IF  STMT-CYCLE-DAYX EQUAL ' '
508950             MOVE WBC-ACCRUAL-DAYS TO STMT-CYCLE-DAY              0266741
509000             GO TO R1450
509050         ELSE
509100             GO TO R1450.
509150     IF  WMS-STMT-SUPP EQUAL '1',  GO  TO  R1800.
509200 R1520.
509250     IF POST-TODAY EQUAL TO '1'
509300         MOVE '05' TO IMEX-CODE-2
509350         MOVE '0' TO EX07-RESET
509400         MOVE '   ' TO EX07-REQ-BY
509450         PERFORM R5020 THRU R5045.
509500     GO  TO  R1800.
509550 R1600.
509600     MOVE WMS-STMT-FLD4 TO HOLD-9.
509650     IF  WBC-STMT-MO EQUAL WBC-LAST-STMT-MO                       0266741
509700         GO  TO  R1610.
509750     IF  WBC-STMT-CAL (1) EQUAL '01'                              0266741
509800         GO  TO  R1610.
509850     IF  WMS-STMT-PULL EQUAL 'G'
509900         IF  WBC-STMT-CYCLE (X) LESS THAN WBC-STMT-CAL (1)        0266741
509950             GO  TO  R1610
510000         ELSE MOVE WBC-LAST-STMT-MO TO HOLD-MO                    0266741
510050             GO  TO  R1620.
510100     IF  WMS-STMT-PULL EQUAL 'E'
510150         MOVE WBC-LAST-STMT-MO TO HOLD-MO                         0266741
510200         GO  TO  R1620.
510250     IF  WMS-STMT-PULL EQUAL 'D'
510300         IF  WMS-STMT-FLD (1) LESS THAN WBC-STMT-CAL (1)          0266741
510350             GO  TO  R1610
510400         ELSE MOVE WBC-LAST-STMT-MO TO HOLD-MO                    0266741
510450             GO  TO  R1620.
510500     IF  WMS-STMT-PULL EQUAL 'B'
510550         IF  WMS-STMT-FLD (1) LESS THAN WBC-STMT-BANK (1)         0266741
510600             GO  TO  R1610
510650         ELSE
510700             MOVE WBC-LAST-STMT-MO TO HOLD-MO                     0266741
510750             GO  TO  R1620.
510800     IF  WMS-STMT-PULL EQUAL 'F'
510850         IF  SAVE-STMT-FIELD GREATER THAN '21'
510900             MOVE WBC-LAST-STMT-MO TO HOLD-MO                     0266741
510950             GO  TO  R1620
511000         ELSE
511050             GO  TO  R1610.
511100 R1610.
511150     MOVE WBC-STMT-MO TO HOLD-MO.                                 0266741
511200 R1620.
511250     IF  HOLD-MO EQUAL TO HOLD-X, GO TO R1450.
511300     ADD WMS-STMT-FLD3 TO HOLD-9.
511350     IF  HOLD-X GREATER THAN '12', GO  TO  R1800.
511400     GO TO R1620.
511450     SKIP3
511500******************************************************************IM007
511503*    ****** CHECK FOR EFT STMT TO REPORT ATM/ACH TRANS  ******   *IM007
511506*    REGULATION E REQUIRES SERVICE PROVIDERS TO GIVE CONSUMERS   *IM007
511509*    A PERIODIC STATEMENT AT LEAST MONTHLY IF EFTS HAVE BEEN     *IM007
511512*    MADE BY THE CONSUMER AND QUARTERLY IF NO EFT HAS OCCURRED.  *IM007
511515*    R1800 WILL CHECK THE EFT ACTIVITY COUNTERS AND DETERMINE IF *IM007
511518*    EFT ACTIVITY HAS OCCURRED.  IF ACTIVITY HAS OCCURRED, THEN  *IM007
511521*    STATEMENT CYCLES WITH FREQUENCIES GREATER THAN MONTHLY ARE  *IM007
511524*    CHECKED FOR A STATEMENT WITHIN THE PAST MONTH.  IF ACTIVITY *IM007
511527*    HAS NOT OCCURRED, THEN SIDIF2 WILL COMPARE THE DATE LAST    *IM007
511530*    STATEMENT TO BE GREATER THAN 90 DAYS.                       *IM007
511533******************************************************************IM007
511550     SKIP3
511557 R1800.                                                           IM004
511558     GO TO R1805.                                                 IMIB59
511560     IF  WBC-REG-E        EQUAL '0'                               0266741
511561         GO TO R1805.                                             9915884
511564     IF  WBC-MONTH-END NOT EQUAL '1', GO TO R1805.                0266741
511570     IF  STMT-TODAY EQUAL '1', GO TO R1805.                       IM005
511572     IF  WMS-STATUS EQUAL '04'                                    0265991
511574     AND WMS-STMT-CYCL-CLSD GREATER THAN +0                       0265991
511576         GO TO R1805.                                             0265991
511578**** IF BROKER PROVIDES STATEMENT FOR CMA, BYPASS EFT STATEMENT   0627533
511579     IF  WBC-EFT-STMT-ON-CMA  EQUAL '0'                           0627533
511580     AND WMS-SAVINGS-TRLR     EQUAL '1'                           0627533
511581     AND WMS-CMA-INDICATOR    EQUAL '1'                           0627533
511582         GO TO R1805.                                             0627533
511584     IF  WMS-MTD-NUM-ACH EQUAL +0                                 IM005
511594     AND WMS-MTD-NUM-ATM EQUAL +0                                 IM005
511604         GO TO R1802.                                             IM008
511605     IF (WMS-STMT-PULL EQUAL 'R' OR 'Y')                          IM007
511606     OR  WMS-STMT-SUPP EQUAL '4'                                  IM007
511607     OR (WMS-STMT-PULL EQUAL 'G' AND                              0417209
511608        (WMS-STMT-FLD (1) EQUAL (WBC-IRR-STMT-CYCLE (1)           0417209
511609                             OR  WBC-IRR-STMT-CYCLE (2)           0417209
511610                             OR  WBC-IRR-STMT-CYCLE (3)           0417209
511611                             OR  WBC-IRR-STMT-CYCLE (4)           0417209
511612                             OR  WBC-IRR-STMT-CYCLE (5)           0417209
511613                             OR  WBC-IRR-STMT-CYCLE (6)           0417209
511614                             OR  WBC-IRR-STMT-CYCLE (7)           0417209
511615                             OR  WBC-IRR-STMT-CYCLE (8)           0417209
511616                             OR  WBC-IRR-STMT-CYCLE (9)           0417209
511617                             OR  WBC-IRR-STMT-CYCLE (10))))       0417209
511618         NEXT SENTENCE                                            0417209
511619     ELSE                                                         0417209
511620         GO TO R1805.                                             0417209
511621     IF  WMS-LAST-STMT-MO EQUAL '  '                              0417209
511624         MOVE WMS-OPENED-MO TO D1-MO                              IM005
511634     ELSE                                                         IM005
511644         MOVE WMS-LAST-STMT-MO TO D1-MO.                          IM005
511654     MOVE WBC-CAPTURE-MO TO D2-MO.                                0266741
511664     IF  D1-MO NOT EQUAL D2-MO                                    IM007
511666         GO TO R1804                                              IM007
511668     ELSE                                                         IM007
511670         GO TO R1805.                                             IM007
511672 R1802.                                                           IM007
511674     IF  WMS-DATE-LAST-STMT EQUAL SPACES                          IM007
511676         MOVE WMS-DATE-OPENED TO DT-LOW-DATE                      IM007
511678     ELSE                                                         IM007
511680         MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE.                  IM007
511682     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
511684     CALL 'SIDIF2' USING DATE-AREA.                               IM007
511686     IF  RET-DAYS LESS THAN +90                                   IM007
511688         GO TO R1805.                                             IM007
511690 R1804.                                                           IM007
511692     MOVE '1' TO EFT-STMT-FLAG.                                   IM007
511697     SKIP3                                                        IM004
511704*    *****  REQUEST OTHER APPL  STATEMENT FOR TOMORROW  *****     IM004
511711     SKIP3                                                        IM004
511718 R1805.                                                           IM004
511720     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915845
511722         GO  TO  R4900.                                           9915845
511725******************************************************************IM006
511727***  THE FOLLOWING USER EXIT MAY BE USED TO SKIP THE REQUEST TO   IM006
511729***  OTHER SYSTEMS FOR TRANSACTIONS WHEN WE ARE SKIPPING STATEMENTIM006
511731***  GENERATION FOR DORMANT/INACTIVE ACCOUNTS AT NON-QUARTER END. IM006
511733***                                                               IM006
511735***  COPY IM31UCS.                                                IM006
511737***                                                               IM006
511739***  END OF USER EXIT.                                            IM006
511741******************************************************************IM006
511743     IF  WMS-COMBINED-STAT EQUAL ZERO                             IM006
511745         GO  TO  R2000.                                           IM006
511750     IF  WMS-STMT-PULL EQUAL 'E'
511800         IF  WBC-NEXT-MONTH-END EQUAL '1'                         0266741
511850             GO TO R1810
511900         ELSE
511950             GO TO R2000.
512000     IF  WMS-STMT-PULL EQUAL 'G'
512050         MOVE WMS-STMT-FLD1 TO Y
512100         IF  WBC-STMT-CODE (Y) EQUAL '9'                          0266741
512150             GO  TO  R1810
512200         ELSE
512250             GO  TO  R1890.
512300     GO TO R2000.
512350 R1810.
512400     MOVE +0 TO X.
512450 R1820.
512500     ADD +1 TO X.
512550     IF  X GREATER THAN WMS-COMBINED-STAT
512600         GO  TO  R2000.
512650     IF  WMS-COMB-STMT-TRAN-FLAG (X) NOT EQUAL '1'
512700         GO  TO  R1820.
512750     MOVE 'RT' TO IMEX-CODE-1.
512800     MOVE WMS-COMB-STMT-SYS-ID (X) TO IMEX-CODE-2.
512850     MOVE '11' TO IMEX-REC-NO.
512900     MOVE WMS-COMB-STMT-SYS-ID (X) TO EX11-NOX.
512950     MOVE WMS-COMB-STMT-CONTROL (X) TO EX11-TRLR.
513000     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
513050     GO  TO  R1820.
513100 R1890.
513150     IF  WMS-STMT-SUPP EQUAL '1'
513200         IF  WBC-NEXT-MONTH-END EQUAL '1'                         0266741
513250             GO  TO  R1810.
513300     GO  TO  R2000.
513350     SKIP3
513400*    ***********  SERVICE CHARGE DETERMINATION  ***********
513450     SKIP1
513500 R2000.
513510                                                                  0902786
513520     IF  WMS-STATUS EQUAL '08'                                    0902786
513530         GO TO R2500.                                             9915845
513550     IF WBC-SERVICE-CHG-CODE EQUAL TO '0', GO TO R2500.           0266741
513600     IF WMS-SC-CYCLE NOT EQUAL TO '0', GO TO R2100.
513650     IF STMT-TODAY NOT EQUAL TO '1'                               IM006
513720         GO TO R2500.                                             9915845
513790     IF SUPP-STMT-SW EQUAL 'N'                                    IM006
513860         GO TO R2500.                                             9915845
513930     MOVE STMT-CYCLE-DAY TO SVCH-CYCLE-DAY.                       IM006
514000     GO TO R2450.                                                 IM006
514250 R2100.
514252     IF  WMS-SC-CYCLE EQUAL 'Y'                                   0827731
514254         IF  WBC-YEAR-END EQUAL '1'                               0827731
514256             GO TO R2450                                          0827731
514258         ELSE                                                     0827731
514260             GO TO R2500.                                         0827731
514300     IF  WMS-SC-CYCLE EQUAL TO 'E'                                IM003
514310         IF  WBC-MONTH-END EQUAL TO '1'                           0266741
514320             MOVE WBC-ACCRUAL-DAYS TO SVCH-CYCLE-DAY              0266741
514330             GO TO R2420                                          IM003
514340         ELSE                                                     IM003
514350             GO TO R2500.                                         9915845
514360     IF WMS-SC-CYCLE NOT EQUAL 'C',  GO  TO  R2150.               IM003
514400     MOVE +1 TO X.
514450 R2110.
514500     IF  WMS-SC-DAY EQUAL TO WBC-STMT-CAL (X)                     0266741
514550         IF  X LESS THAN WBC-ACCRUAL-DAYS                         0266741
514600             MOVE X TO SVCH-CYCLE-DAY
514650             GO  TO  R2420
514700         ELSE
514750             MOVE WBC-ACCRUAL-DAYS TO SVCH-CYCLE-DAY              0266741
514800             GO  TO  R2420.
514850     ADD +1 TO X.
514900     IF  X GREATER THAN +8
514950         GO  TO  R2500.                                           9915845
515000     GO TO R2110.
515050 R2150.
515100     IF WMS-SC-CYCLE EQUAL TO 'B'
515150         IF WMS-SC-DAY EQUAL TO WBC-STMT-BANK (1) OR              0266741
515180                                WBC-STMT-BANK (2) OR              0266741
515210                                WBC-STMT-BANK (3) OR              0266741
515240                                WBC-STMT-BANK (4) OR              0266741
515270                                WBC-STMT-BANK (5) OR              0266741
515300                                WBC-STMT-BANK (6)                 0266741
515450             MOVE '1' TO SVCH-CYCLE-DAYX
515500             GO TO R2420
515550         ELSE GO TO R2500.                                        9915845
515600     IF WMS-SC-CYCLE EQUAL TO 'W'
515650         IF WMS-SC-DAY  EQUAL TO WBC-STMT-WEEK (1) OR             0266741
515680                                 WBC-STMT-WEEK (2) OR             0266741
515710                                 WBC-STMT-WEEK (3) OR             0266741
515740                                 WBC-STMT-WEEK (4) OR             0266741
515770                                 WBC-STMT-WEEK (5) OR             0266741
515800                                 WBC-STMT-WEEK (6)                0266741
515950             MOVE '1' TO SVCH-CYCLE-DAYX
516000             GO TO R2420
516050         ELSE GO TO R2500.                                        9915845
516070     GO TO R2500.                                                 9915845
516450 R2420.
516500     IF WMS-SC-INCR EQUAL TO '1', GO TO R2450.
516550     MOVE WMS-SC-MONTH1 TO HOLD-9.
516560     IF  WMS-SC-CYCLE EQUAL 'C'                                   9915845
516565     AND WBC-MONTH-END EQUAL TO '1'                               0266741
516570     AND WMS-SC-DAY LESS THAN WBC-LAST-PROC-DA                    0266741
516575         GO  TO  R2435.                                           9915845
516580     IF  WMS-SC-CYCLE EQUAL 'W'                                   9915845
516585     AND WBC-MONTH-END EQUAL TO '1'                               0266741
516590     AND WMS-SC-DAY LESS THAN '22'                                9915845
516595         GO  TO  R2435.                                           9915845
516600 R2430.
516650     IF WBC-PROC-THRU-MO EQUAL TO HOLD-X, GO TO R2450.            0266741
516850     ADD WMS-SC-INCR TO HOLD-9.
516900     IF HOLD-X GREATER THAN '12', GO TO R2500.                    9915845
516950     GO TO R2430.
516960 R2435.                                                           9915845
516970     IF WBC-STMT-MO EQUAL TO HOLD-X, GO TO R2450.                 0266741
516980     ADD WMS-SC-INCR TO HOLD-9.                                   9915845
516990     IF HOLD-X GREATER THAN '12', GO TO R2500.                    9915845
516991     GO TO R2435.                                                 9916305
516992 R2450.                                                           9916305
516993     MOVE '1' TO SVCH-TODAY.                                      9916305
516994     SKIP3                                                        9916305
516995 ROOT-SECTION-B      SECTION 1.                                   9916305
516996     SKIP3                                                        9916305
516997 R2500.                                                           9916305
516998*----------------------------------------------------------------*9916305
516999*    THE FOLLOWING EXIT IS FOR INTEREST PAY/CHARGE CYCLE          9916305
517000*    DETERMINATION.                                               9916305
517001*----------------------------------------------------------------*9916305
517002     COPY IMPD31IS.                                               9916305
517003     SKIP3                                                        9916305
517004 R2675.                                                           9916305
517005*    ********  MAINTENANCE OF MINIMUM DDA BALANCE  ********       9916305
517006     ADD WMS-CURR-BAL LOAN-TODAY GIVING WMS-DDA-BAL.              9916305
517007     MOVE +0 TO LOAN-MIN-BAL.                                     9916305
517008     IF  WMS-SAVINGS-TRLR NOT EQUAL TO '1'                        9916305
517009     OR  WMS-INT-STATUS GREATER THAN '6'                          9916305
517010         GO  TO  R2675-B.                                         9916305
517011*--- RECALCULATE DDA MAX BALANCE FOR INT-TRAN-NO MAINTENANCE      9916305
517012     IF  WMS-DDA-MAX-FLAG EQUAL '1'                               9916305
517013         IF  WMS-INT-TRAN-NO GREATER THAN WMS-MAX-TRAN-FOR-SUPER  9916305
517014         AND WMS-DDA-MAX-BAL LESS THAN +9999999999999.99          9916305
517015             MOVE WMS-DDA-MAX-BAL TO WMS-DDA-MAX-BAL-BEG          9916305
517016             MOVE +9999999999999.99 TO WMS-DDA-MAX-BAL.           9916305
517017     IF  TRANSFER-AMT NOT GREATER THAN ZERO                       9916072
517018         GO  TO  R2675-A.                                         9916072
517019     MOVE ZERO TO CUR-BAL.                                        9916072
517020     PERFORM K0104 THRU K0105.                                    9916072
517021     MULTIPLY -1 BY CUR-BAL.                                      9916072
517022     IF  TRANSFER-AMT LESS THAN CUR-BAL                           9916072
517023         ADD TRANSFER-AMT TO WMS-INT-CUR-BAL                      9916072
517024         MOVE ZERO TO TRANSFER-AMT                                9916072
517025     ELSE                                                         9916072
517026         ADD CUR-BAL TO WMS-INT-CUR-BAL                           9916072
517027         SUBTRACT CUR-BAL FROM TRANSFER-AMT.                      9916072
517028 R2675-A.                                                         9916072
517029     SUBTRACT WMS-INT-CUR-BAL FROM WMS-DDA-BAL.                   9916072
517030 R2675-B.                                                         9916072
517031     IF  WMS-XINV-LINK-IND    EQUAL 'L'                           2016639
517032     AND WMS-XINV-PROCESS-IND EQUAL '2'                           2016639
517033         GO TO R3600.                                             2016639
517034     MOVE ZERO TO AMT-UNAVAIL.                                    2016639
517035     IF  WMS-MIN-BAL-CALC EQUAL '1'                               2016639
517036         GO TO R2675-C.                                           9916072
517037     IF  WMS-MIN-BAL-CALC EQUAL '2'                               2016639
517038         ADD WMS-HOLD-AMT TO AMT-UNAVAIL.                         2016639
517039     IF  WMS-MIN-BAL-CALC EQUAL '3'                               2016639
517040         ADD WMS-BANK-AVAIL-AMT TO AMT-UNAVAIL.                   2016639
517041     IF  WMS-MIN-BAL-CALC EQUAL '4'                               2016639
517042         ADD WMS-CUST-AVAIL-AMT TO AMT-UNAVAIL.                   2016639
517043     IF  WMS-MIN-BAL-CALC EQUAL '5'                               9916072
517044         ADD WMS-HOLD-AMT TO AMT-UNAVAIL                          9916072
517045         ADD WMS-BANK-AVAIL-AMT TO AMT-UNAVAIL                    9916072
517046         GO TO R2675-C.                                           9916072
517047     IF  WMS-MIN-BAL-CALC EQUAL '6'                               9916072
517048         ADD WMS-HOLD-AMT TO AMT-UNAVAIL                          9916072
517049         ADD WMS-CUST-AVAIL-AMT TO AMT-UNAVAIL                    9916072
517050         GO TO R2675-C.                                           9916072
517051     IF  WMS-MIN-BAL-CALC EQUAL '7'                               9916072
517052         ADD WMS-NB-OTH-HLD TO AMT-UNAVAIL.                       9916072
517053 R2675-C.                                                         9916072
517054     COMPUTE HOLD-AMT15 EQUAL WMS-DDA-BAL - AMT-UNAVAIL.          9916072
517055     IF HOLD-AMT15 NOT LESS THAN WMS-MIN-BAL, GO TO R3600.        9916072
517056     IF NSF-CALC-FLAG EQUAL TO '0'                                9916072
517057         PERFORM K0100 THRU K0105.                                9916072
517058     MOVE ZERO TO AMT-AVAIL.                                      9916072
517059     IF SAVINGS-PRESENT EQUAL TO '1'                              9916072
517060         ADD WMS-INT-CUR-BAL TO AMT-AVAIL.                        9916072
517061     IF LOAN-PRESENT EQUAL TO '1'                                 9916072
517062         AND WMS-MIN-BAL NOT EQUAL ZERO                           9916072
517063         ADD WMS-AVAIL-BAL TO AMT-AVAIL.                          9916072
517064     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9916072
517065     AND WMS-DDA-MAX-FLAG EQUAL '1'                               9916072
517066     AND WMS-CMA-SWEEP-IND EQUAL 'H'                              9916072
517067         COMPUTE HOLD-AMT9 EQUAL WMS-DDA-MAX-BAL -                9916072
517068                                 HOLD-AMT15                       9916072
517069     ELSE                                                         9916072
517070         COMPUTE HOLD-AMT9 EQUAL WMS-MIN-BAL -                    9916072
517071                                 HOLD-AMT15.                      9916072
517072     IF AMT-AVAIL NOT LESS THAN HOLD-AMT9                         9916072
517073         GO TO R2675-D.                                           9916072
517074     IF SAVINGS-PRESENT EQUAL TO '1'                              9916072
517075     AND WMS-INT-CUR-BAL GREATER THAN ZERO                        9916305
517076         ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL, TRANSFER-AMT         9916305
517077         SUBTRACT WMS-INT-CUR-BAL FROM HOLD-AMT9                  9916305
517078         MOVE ZERO TO WMS-INT-CUR-BAL                             9916305
517079         IF  WMS-DDA-MAX-FLAG EQUAL '1'                           9916305
517080             COMPUTE HOLD-NO3 EQUAL WMS-INT-TRAN-NO + +1          9916305
517081             IF  HOLD-NO3 NOT LESS WMS-MAX-TRAN-FOR-SUPER         9916305
517082             AND WMS-DDA-MAX-BAL LESS THAN +9999999999999.99      9916305
517083                 MOVE WMS-DDA-MAX-BAL TO WMS-DDA-MAX-BAL-BEG      9916305
517084                 MOVE +9999999999999.99 TO WMS-DDA-MAX-BAL.       9916305
517085     GO TO R2680.                                                 9916305
517086 R2675-D.                                                         9916305
517087     IF  WMS-SAVINGS-TRLR NOT EQUAL '1'                           9916305
517088         GO TO R2676.                                             9916305
517089     IF  WMS-DDA-MAX-FLAG EQUAL '0'                               9916305
517090     OR  WMS-INT-STATUS GREATER THAN '6'                          9916305
517091         GO TO R2676.                                             9916305
517092     COMPUTE HOLD-NO3 EQUAL WMS-INT-TRAN-NO + +1.                 9916305
517093     IF  HOLD-NO3 NOT LESS WMS-MAX-TRAN-FOR-SUPER                 9916305
517094     AND WMS-DDA-MAX-BAL LESS THAN +9999999999999.99              9916305
517095         MOVE WMS-INT-CUR-BAL TO HOLD-AMT9                        9916305
517096         MOVE WMS-DDA-MAX-BAL TO WMS-DDA-MAX-BAL-BEG              9916305
517097         MOVE +9999999999999.99 TO WMS-DDA-MAX-BAL.               9916305
517098 R2676.                                                           9916305
517099     IF SAVINGS-OR-LOAN EQUAL '0'                                 9916305
517100         GO TO R2680.                                             9916305
517101     IF SAVINGS-OR-LOAN LESS THAN '3'                             9916305
517102         GO TO R2685.                                             9916305
517103 R2677.                                                           9916305
517104     IF  WMS-MIN-BAL EQUAL ZERO                                   9916305
517105         GO  TO  R2687.                                           9916305
517106     IF  WMS-AVAIL-BAL LESS THAN HOLD-AMT9                        9916305
517107         PERFORM K1730 THRU K1730-EXIT                            2015844
517108         ADD WMS-AVAIL-BAL TO WMS-PRIN-BAL LOAN-TODAY LOAN-MIN-BAL2015844
517109         SUBTRACT WMS-AVAIL-BAL FROM HOLD-AMT9 WMS-AVAIL-BAL      2015844
517110         GO TO R2687.                                             2015844
517111 R2678.                                                           2015844
517112     IF WMS-SERV-CHARGE GREATER THAN HOLD-AMT9                    2015844
517113         GO TO R3600.                                             2015844
517114     IF WMS-MIN-BAL EQUAL TO ZERO, GO TO R3600.                   2015844
517115     IF WMS-STATUS EQUAL TO '04' OR '05' OR '08', GO TO R3600.    ~~~0145
517116     PERFORM K0131-A THRU K0131-B-EXIT.                           0546698
517117     PERFORM K1730 THRU K1730-EXIT.                               0546698
517118     ADD HOLD-AMT9 TO WMS-PRIN-BAL LOAN-TODAY LOAN-MIN-BAL.       0546698
517119     PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.                 0546698
517120     GO TO R3600.                                                 0546698
517121 R2680.                                                           0546698
517122     IF WMS-MIN-BAL EQUAL ZERO                                    0546698
517123         GO TO R3600.                                             0546698
517124     IF WMS-SAVINGS-TRLR EQUAL TO '1'                             0546698
517125         MOVE 'LB' TO  IMEX-CODE-2                                0546698
517126         GO  TO  R2682.                                           0546698
517127     IF WMS-SAV-PTR NOT EQUAL ZERO                                0546698
517128         MOVE 'LA' TO IMEX-CODE-2                                 0546698
517129         GO  TO  R2682.                                           0546698
517130     IF WMS-CHG-CARD-FLG EQUAL '1'                                0546698
517131         MOVE 'LI' TO IMEX-CODE-2                                 0546698
517132         GO  TO  R2682.                                           0546698
517133     IF  WBC-EXC-CODE (14) EQUAL TO '1'                           0546698
517134         MOVE '14' TO IMEX-CODE-1                                 0546698
517135         GO  TO  R2683.                                           0546698
517136 R2682.                                                           0546698
517137     MOVE 'L0' TO IMEX-CODE-1.                                    0546698
517138 R2683.                                                           0546698
517139     MOVE '02' TO IMEX-REC-NO.                                    0546698
517140     MOVE HOLD-AMT9 TO EX02-BAL.                                  0546698
517141     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0546698
517142     GO TO R3600.                                                 0546698
517143 R2685.                                                           0546698
517144     IF  WMS-INT-CUR-BAL LESS THAN HOLD-AMT9                      0546698
517145         ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL TRANSFER-AMT          0546698
517146         SUBTRACT WMS-INT-CUR-BAL FROM HOLD-AMT9                  0546698
517147         MOVE ZERO TO WMS-INT-CUR-BAL                             0546698
517148         GO TO R2678.                                             0546698
517149 R2687.                                                           0546698
517150     IF HOLD-SAV-INCR  GREATER THAN ZERO                          0546698
517151         PERFORM K0170-A THRU K0170-A-END.                        0546698
517152     ADD HOLD-AMT9 TO WMS-DDA-BAL TRANSFER-AMT.                   0546698
517153     SUBTRACT HOLD-AMT9 FROM WMS-INT-CUR-BAL.                     0546698
517154     SKIP3                                                        0546698
517155*    *************  LOAN PAYMENT CALCULATION  **************      0546698
517200     SKIP3
517250 ROOT-SECTION-I      SECTION 1.
517300     SKIP3
517350 R3600.
517400     IF  WMS-LOAN-TRLR EQUAL '0'                                  IM005
517401         GO TO R3700.                                             1105504
517402*----------------------------------------------------------------*9915749
517403*    EXCLUDE AUTOBORROW ACCOUNTS.                                *9915749
517404*----------------------------------------------------------------*9915749
517405     IF  WMS-NB-DC-ABM EQUAL TO '1'                               9915749
517406         GO TO R3696.                                             9915749
517407     MOVE +0 TO LOAN-ACCRUAL-DAY.                                 1105504
517408     IF  (WMS-SAVINGS-TRLR EQUAL '1'                              IM008
517410     AND WMS-CMA-INDICATOR EQUAL '1')                             IM008
517412         GO TO R3690.                                             IM008
517414     IF  (WMS-LOAN-STATUS EQUAL '3' OR '4' OR '6')                IM008
517672         GO TO R3630.                                             0901864
517900     SKIP3
517950 LOAN-SECTION-C      SECTION 26.
518000     SKIP3
518050 R3610.
518100     IF WMS-PYMT-CALC-CODE EQUAL TO '0'
518150         IF STMT-TODAY EQUAL TO '1'
518170             MOVE STMT-CYCLE-DAYX TO PYMT-CYCLE-DAYX              IM006
518200             GO TO R3620                                          IM005
518250         ELSE
518300             GO TO R3630.                                         IM005
518350     IF WMS-PYMT-CALC-CODE EQUAL TO '1' OR '3'
518400         IF WMS-PYMT-CALC-DAY EQUAL TO WBC-STMT-CAL (1) OR        0266741
518450                                       WBC-STMT-CAL (2) OR        0266741
518500                                       WBC-STMT-CAL (3) OR        0266741
518550                                       WBC-STMT-CAL (4) OR        0266741
518600                                       WBC-STMT-CAL (5) OR        0266741
518650                                       WBC-STMT-CAL (6) OR        0266741
518700                                       WBC-STMT-CAL (7) OR        0266741
518750                                       WBC-STMT-CAL (8)           0266741
518760             MOVE +1 TO X                                         IM006
518770             PERFORM R3615 THRU R3615-EXIT                        IM006
518800             GO TO R3620                                          IM005
518850         ELSE
518900             GO TO R3630.                                         IM005
518950     IF WMS-PYMT-CALC-CODE EQUAL TO '2' OR '4'
519000         IF WBC-MONTH-END EQUAL TO '1'                            0266741
519050             GO TO R3620.                                         IM005
519070     GO TO R3630.                                                 IM005
519071 R3615.                                                           IM006
519072     IF  WMS-PYMT-CALC-DAY EQUAL WBC-STMT-CAL (X)                 0266741
519073         IF  X LESS THAN WBC-ACCRUAL-DAYS                         0266741
519074             MOVE X TO PYMT-CYCLE-DAY                             IM006
519075             GO TO R3615-EXIT                                     IM006
519076         ELSE                                                     IM006
519077             GO TO R3615-EXIT.                                    IM006
519078     ADD +1 TO X.                                                 IM006
519079     IF  X NOT GREATER THAN +8                                    IM006
519080         GO TO R3615.                                             IM006
519081 R3615-EXIT. EXIT.                                                IM006
519090 R3620.                                                           IM005
519093     MOVE '1' TO LOAN-PMT-TODAY.                                  1004775
519095     MOVE STMT-CYCLE-DAYX TO WMS-LAST-STMT-CY-DAYX.               0817792
519096******************************************************************1004775
519099***  FORECAST THE LOAN PAYMENT DUE DATE FOR AUTO PAYMENTS      ***1004775
519102******************************************************************1004775
519105     IF  WMS-AUTO-PYMT EQUAL '0'                                  1004775
519108         GO TO R3630.                                             1004775
519111***  WMS-PYMT-SCHED-CODE = 0 OR 4 (DUE WHEN CALCULATED)        ***1004775
519114     IF  WMS-PYMT-SCHED-CODE EQUAL '0' OR '4'                     1004775
519117         MOVE WBC-CAPTURE-DATE TO WORK-LOAN-PYMT-DATE             0266741
519120         GO  TO  R3625.                                           1004775
519123***  WMS-PYMT-SCHED-CODE = 1 (DUE XX DAYS AFTER)               ***1004775
519126     IF  WMS-PYMT-SCHED-CODE EQUAL '1'                            1004775
519129         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0266741
519132         MOVE WMS-PYMT-SCHED-DAY TO DT-H-MO                       1004775
519135         MOVE DT-H-MO9 TO RET-DAYS                                1004775
519138         CALL 'SIDHI' USING DATE-AREA                             1004775
519141         MOVE DT-HIGH-DATE TO WORK-LOAN-PYMT-DATE                 1004775
519144         GO  TO  R3625.                                           1004775
519147***  WMS-PYMT-SCHED-CODE = 3 (DUE END OF MONTH)                ***1004775
519150     IF  WMS-PYMT-SCHED-CODE EQUAL '3'                            1004775
519153         IF  WBC-MONTH-END EQUAL '1'                              0266741
519156             MOVE WBC-CAPTURE-DATE TO WORK-LOAN-PYMT-DATE         0266741
519159             GO  TO  R3625                                        1004775
519162         ELSE                                                     1004775
519165             MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                 0266741
519168             MOVE '01' TO DT-L-DA                                 1004775
519171             MOVE +1 TO RET-DAYS                                  1004775
519174             CALL 'SIDMHI' USING DATE-AREA                        1004775
519177             MOVE +1 TO RET-DAYS                                  1004775
519180             CALL 'SIDLO' USING DATE-AREA                         1004775
519183             MOVE DT-LOW-DATE TO WORK-LOAN-PYMT-DATE              1004775
519186             GO  TO  R3625.                                       1004775
519187***  WMS-PYMT-SCHED-CODE = 5 (REG Z SCHEDULE)                  ***1010074
519188     IF  WMS-PYMT-SCHED-CODE EQUAL '5'                            1010074
519189         IF  WMS-PAST-DUE-DAYS NOT LESS (WBC-STMT-LEAD-DAYS + +21)1010074
519190             MOVE WBC-CAPTURE-DATE TO WORK-LOAN-PYMT-DATE         1010074
519191             GO TO R3625                                          1010074
519192         ELSE                                                     1010074
519193             GO TO R3630.                                         1010074
519194***  WMS-PYMT-SCHED-CODE = 2 (DUE CALENDAR DAY)                ***1010074
519195     MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE.                        1010074
519196     MOVE WMS-PYMT-SCHED-DAY TO DT-L-DA.                          1010074
519198     IF  WMS-PYMT-SCHED-DAY GREATER THAN WBC-STMT-DA              0816004
519201         SUBTRACT +1 FROM DT-L-MO9                                1004775
519204         IF  DT-L-MO9 LESS THAN +1                                1004775
519207             MOVE +12 TO DT-L-MO9                                 1004775
519210             IF  DT-L-YR EQUAL '00'                               1004775
519213                 MOVE '99'       TO DT-L-YR                       1004775
519216             ELSE                                                 1004775
519219                 SUBTRACT +1 FROM DT-L-YR9.                       1004775
519222     MOVE +1 TO RET-DAYS.                                         1004775
519225     CALL 'SIDMHI' USING DATE-AREA.                               1004775
519228     MOVE DT-HIGH-DATE TO WORK-LOAN-PYMT-DATE.                    1004775
519231 R3625.                                                           1004775
519234     IF  WBC-CAPTURE-DATE EQUAL WORK-LOAN-PYMT-DATE               0266741
519237         MOVE '1' TO SKIP-LOAN-ACCR-SW.                           1004775
519240                                                                  1004775
519251******************************************************************IM006
519252****    R3630 WILL CAUSE LOAN ACCRUALS FOR THE ACCRUAL DAYS. *****IM006
519253******************************************************************IM006
519254 R3630.                                                           IM006
519255     IF  SKIP-LOAN-ACCR-SW EQUAL '2'                              IM006
519256         PERFORM C2371 THRU C2400 ACCR-DAYS-SKIPPED TIMES         IM006
519257         MOVE '0' TO SKIP-LOAN-ACCR-SW                            IM008
519258         MOVE +0 TO ACCR-DAYS-SKIPPED.                            IM008
519259     ADD +1 TO LOAN-ACCRUAL-DAY.                                  IM008
519260     IF  LOAN-FUT GREATER THAN ZERO                               1003625
519261     OR  PRIME-FUT GREATER THAN ZERO                              1003625
519262     OR  SPLIT-FUT GREATER THAN ZERO                              1003625
519263     OR  PREV-LOAN-FUT GREATER THAN ZERO                          1003625
519264     OR  PREV-SPLIT-FUT GREATER THAN ZERO                         1003625
519265         PERFORM ROLL-FUTURE-LOAN-RATE THRU FUTURE-LOAN-RATE-EXIT.1003625
519266     IF  LOAN-ACCRUAL-DAY GREATER THAN WBC-ACCRUAL-DAYS           0266741
519267         IF  WBC-LOAN-DAILY-ACCRUAL EQUAL '0'                     0266741
519268             MOVE '2' TO SKIP-LOAN-ACCR-SW                        1003625
519269             PERFORM C2371 THRU C2400 ACCR-DAYS-SKIPPED TIMES     1003625
519270             MOVE '0' TO SKIP-LOAN-ACCR-SW                        1003625
519271             GO TO R3685                                          1003625
519272         ELSE                                                     1003625
519273             GO TO R3685.                                         1003625
519274     IF  LOAN-ACCRUAL-DAY EQUAL +1                                1003625
519275         IF  WBC-LOAN-DAILY-ACCRUAL EQUAL '1'                     0266741
519276             PERFORM C2371 THRU C2400                             1003625
519277         ELSE                                                     1003625
519278             NEXT SENTENCE                                        1003625
519279     ELSE                                                         1003625
519280         PERFORM C2371 THRU C2400.                                1003625
519281      IF  PYMT-CYCLE-DAY EQUAL LOAN-ACCRUAL-DAY                   1003625
519282          GO TO R3640                                             1003625
519283      ELSE                                                        1003625
519284          GO TO R3630.                                            1003625
519285 R3640.                                                           1003625
519286     IF  (WMS-LOAN-STATUS EQUAL '3' OR '4' OR '6')                1003625
519287     OR  (WMS-PRIN-BAL EQUAL ZERO                                 1003625
519288     AND WMS-LOAN-ACCR-INT EQUAL ZERO                             1003625
519289     AND WMS-INTRST-BAL EQUAL ZERO                                1003625
519290     AND WMS-OTHER-CHGS EQUAL ZERO                                1003625
519291     AND PRIME-CALC-FLAG NOT EQUAL '2' AND '3')                   1003625
519292         GO TO R3675.                                             1003625
519300     IF  LOAN-PMT-TODAY EQUAL '0'
519350         GO TO R3660.
519356     IF  LOAN-TODAY GREATER THAN +0.00                            IM006
519362         MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-LOAN-ACTIVITY     0266741
519368                                 WMS-DATE-LAST-ADVANCE            IM006
519374         MOVE LOAN-TODAY      TO WMS-AMT-LAST-ADVANCE             IM006
519380         MOVE WMS-PRIN-BAL    TO WMS-PRIN-LAST-ADVANCE            IM006
519386         MOVE WMS-INTRST-BAL  TO WMS-INT-LAST-ADVANCE             IM006
519392         MOVE WMS-OTHER-CHGS  TO WMS-CHGS-LAST-ADVANCE.           IM006
519400     IF  PRIME-CALC-FLAG EQUAL '2' OR '3'
519450         PERFORM R3660 THRU R3674
519500         PERFORM R3641 THRU R3652-EXIT
519550         GO TO R3679.                                             IM008
519600     IF  WMS-AUTO-PYMT EQUAL '0',  GO  TO  R3640-A.
519650     IF  WMS-PYMT-SCHED-CODE EQUAL '0' OR '4' OR '5'              1010074
519652         GO TO R3640-B.                                           1010074
519700     IF  WMS-PYMT-SCHED-CODE EQUAL '1',  GO  TO  R3640-A.
519750     IF  WMS-PYMT-SCHED-CODE EQUAL '2'
519800         IF  WMS-PYMT-SCHED-DAY EQUAL WBC-STMT-CAL (1) OR         0266741
519850                                      WBC-STMT-CAL (2) OR         0266741
519900                                      WBC-STMT-CAL (3) OR         0266741
519950                                      WBC-STMT-CAL (4) OR         0266741
520000                                      WBC-STMT-CAL (5) OR         0266741
520050                                      WBC-STMT-CAL (6) OR         0266741
520100                                      WBC-STMT-CAL (7) OR         0266741
520150                                      WBC-STMT-CAL (8)            0266741
520200             GO  TO  R3640-B
520250          ELSE  GO  TO  R3640-A.
520300     IF  WMS-PYMT-SCHED-CODE EQUAL '3'
520350         IF  WBC-MONTH-END EQUAL '1', GO  TO  R3640-B             0266741
520400         ELSE  GO  TO  R3640-A.
520450 R3640-A.
520500     PERFORM R3660 THRU R3674.                                    IM002
520520     PERFORM R3641 THRU R3652-EXIT.                               IM002
520600     GO TO R3679.                                                 IM008
520650 R3640-B.
520700     PERFORM R3670 THRU R3674.
520750 R3641.
520800     MOVE '1' TO WMS-PYMT-CLEAR.
520850     IF  WMS-REMAIN-COUNT NOT GREATER THAN ZERO
520900         MOVE '0' TO WMS-EXTENSION-STATUS.
520950 R3642.
521000     MOVE ZERO TO PRIN-DISB
521050                  INT-DISB
521100                  OTH-DISB
521150                  INS1-CHG
521200                  INS2-CHG
521250                  FEE-CHG.
521300 R3642-EXIT.
521350     EXIT.
521400 R3643.
521450     IF  WMS-WAIVE-PYMT EQUAL '1'
521500         MOVE '0' TO WMS-WAIVE-PYMT
521550         GO TO R3652-EXIT.
521600     IF  WMS-PYMT-PHASE EQUAL ZERO
521650         GO TO R3652-EXIT.
521700     MOVE WBC-PYMT-PHASE (WMS-PYMT-PHASE) TO IM31-PH2.            0266741
521750     IF  IM31-PH2 EQUAL SPACES
521800         GO TO R3652-EXIT.
521850     CALL 'SILINK' USING IM31-PHASE
521900                           MASTER-AREA
521950                           DDA-WRKBCR-1                           0266741
522000                           DDA-WRKBCR-4                           0266741
522050                           EX-LOAN-DISB
522100                           DDA-WRKBCR-2                           1010074
522102                           EXCEPTION-AREA                         1010074
522104                           EX-SEQ-CTR                             1010074
522106                           EX-MST-CTL.                            1010074
522150     MOVE SPACE TO EX10-REASON.
522200     IF  WMS-PYMT-DUE-AMT NOT GREATER THAN ZERO
522250         GO TO R3652-EXIT.
522300     IF  WMS-REMAIN-COUNT NOT GREATER THAN ZERO
522350         GO TO R3644.
522400     SUBTRACT +1 FROM WMS-REMAIN-COUNT.
522450     IF  WMS-EXTENSION-STATUS EQUAL '1' OR '0'
522500         MOVE 'J2' TO IMEX-CODE-2
522550         MOVE '1' TO EX10-REASON
522600         MOVE WMS-PYMT-DUE-AMT   TO  AMT-PD                       1002953
522625         PERFORM K1502 THRU K1502-EXIT                            1002953
522650         MOVE ZERO               TO  PRIN-DISB                    1002953
522700                                     OTH-DISB                     1002953
522750                                     INT-DISB                     1002953
522770                                     HOLD-PYMT                    1002953
522800         GO  TO  R3650.                                           1002953
522850     IF  WMS-EXTENSION-STATUS EQUAL '2'
522900         SUBTRACT INT-DISB     FROM  WMS-PYMT-DUE-AMT             1002953
522910                             GIVING  AMT-PD                       1002953
522925         PERFORM K1502 THRU K1502-EXIT                            1002953
522950         MOVE ZERO               TO  OTH-DISB                     1002953
523000                                     PRIN-DISB                    1002953
523050         GO  TO  R3644.                                           1002953
523100     IF  WMS-EXTENSION-STATUS EQUAL '3'
523150         SUBTRACT OTH-DISB     FROM  WMS-PYMT-DUE-AMT             1002953
523160                             GIVING  AMT-PD                       1002953
523175         PERFORM K1502 THRU K1502-EXIT                            1002953
523200         MOVE ZERO               TO  INT-DISB                     1002953
523250                                     PRIN-DISB                    1002953
523300         GO  TO  R3644.                                           1002953
523350     SUBTRACT INT-DISB                                            1002953
523360              OTH-DISB         FROM  WMS-PYMT-DUE-AMT             1002953
523370                             GIVING  AMT-PD.                      1002953
523375     PERFORM K1502 THRU K1502-EXIT.                               1002953
523400     MOVE ZERO TO PRIN-DISB.
523450 R3644.
523500     ADD PRIN-DISB TO LOAN-PRIN-BILL, WS-GL-LOAN-PRIN-BILL.       0902970
523550     ADD OTH-DISB TO LOAN-OTH-BILL, WS-GL-LOAN-OTH-BILL.          0902970
523600     MOVE WMS-PYMT-DUE-AMT TO HOLD-PYMT.
523650     IF  WMS-AUTO-PYMT EQUAL '0'
523700         MOVE 'J1' TO IMEX-CODE-2
523750         GO TO R3645.
523800     IF  WMS-LOAN-STATUS GREATER THAN '2' AND NOT EQUAL '5'
523850         MOVE 'J2' TO IMEX-CODE-2
523900         MOVE '0' TO EX10-REASON
523950         GO TO R3645.
523955     MOVE '41'                   TO  SICOMPDT-DATE-FORMATS.       1002953
523960     CALL 'SICOMPDT'          USING  WMS-BILL-DUE-DATE (1)        1002953
523965                                     WBC-CAPTURE-DATE             0266741
523970                                     SICOMPDT-RETURN-FLAG         1002953
523975                                     SICOMPDT-DATE-FORMATS.       1002953
524000     IF  SICOMPDT-RETURN-FLAG EQUAL 'E'                           1002953
524050         PERFORM R3652 THRU R3652-EXIT
524100         MOVE '1' TO R3652-ALREADY
524150         MOVE EX-LOAN-DISB TO TEMP-48                             9915845
524200         PERFORM R0320 THRU R0495-EXIT
524250         MOVE TEMP-48 TO EX-LOAN-DISB                             9915845
524300         IF  WMS-LOAN-TO-MAKE-PYMT EQUAL '3'
524350             MOVE 'J2' TO IMEX-CODE-2
524400             IF  HOLD-PYMT NOT EQUAL WMS-PYMT-DUE-AMT
524450                 MOVE '3' TO EX10-REASON
524500                 GO TO R3645
524550             ELSE
524600                 MOVE '2' TO EX10-REASON
524650                 GO TO R3645
524700         ELSE
524750             GO TO R3645.
524800     MOVE '4' TO EX10-REASON.
524850     MOVE 'J2' TO IMEX-CODE-2.
524900 R3645.
524950     MOVE 'J0' TO IMEX-CODE-1.
525000 R3646.
525050     MOVE '10' TO IMEX-REC-NO.
525100     MOVE HOLD-PYMT TO EX10-PMT-AMT.
525150     MOVE EX-LOAN-DISB TO EX10-DISTRIBUTION.
525200     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
525250 R3649.  EXIT.
525300 R3650.
525350     IF  WMS-DDA-DEPOSITS LESS THAN HOLD-PYMT
525400         MOVE '1' TO WMS-PAYMENT-SUSPECT
525450         MOVE 'J3' TO IMEX-CODE-1
525500         PERFORM R3646 THRU R3649
525550     ELSE
525600         MOVE '0' TO WMS-PAYMENT-SUSPECT.
525650     IF  R3652-ALREADY EQUAL '1'
525700         GO TO R3652-EXIT.
525750 R3652.
525800     MOVE EX-LOAN-DISB TO HOLD-LOAN-DISB.                         IM002
525810     PERFORM R3642 THRU R3642-EXIT.                               IM002
525820     IF  HOLD-INS1-CHG NOT EQUAL ZERO                             IM002
525900         ADD +1 TO LOAN-GEN-INS1-NO, WS-GL-LOAN-GEN-INS1-NO       0902970
525950                   LOAN-DB-NO, WS-GL-LOAN-DB-NO                   0902970
526000         ADD HOLD-INS1-CHG TO LOAN-GEN-INS1-AMT                   IM002
526001                              WS-GL-LOAN-GEN-INS1-AMT             0902970
526020                              WMS-OTHER-CHGS                      IM002
526040                              WMS-INS1                            IM002
526060                              WMS-INSUR1-THIS-CY                  IM002
526080                              WMS-BILLED-INS1                     IM002
526100                              WMS-LOAN-YTD-INS1                   IM002
526120                              LOAN-DB-AMT                         IM002
526121                              WS-GL-LOAN-DB-AMT                   0902970
526140                              LOAN-DR-OTH, WS-GL-LOAN-DR-OTH      0902970
526160         MOVE HOLD-INS1-CHG TO HOLD-AMT                           IM002
526180         MOVE HOLD-AMT TO INS1-CHG, OTH-DISB                      IM002
526200         MOVE EX-LOAN-DISB TO EX01-LOAN-DISB                      IM002
526450         MOVE 'G5' TO IMEX-CODE-2
526500         MOVE '6' TO EX01-TYPE
526550         MOVE WBC-GENERATED-TRANS (15) TO GEN-TRAN-OPTION-HOLD    0266741
526600         MOVE '15' TO EX01-INT-CODE
526650         PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
526700     IF  HOLD-INS2-CHG NOT EQUAL ZERO                             IM002
526750         ADD +1 TO LOAN-GEN-INS2-NO, WS-GL-LOAN-GEN-INS2-NO       0902970
526800                   LOAN-DB-NO, WS-GL-LOAN-DB-NO                   0902970
526850         ADD HOLD-INS2-CHG TO LOAN-GEN-INS2-AMT                   IM002
526851                              WS-GL-LOAN-GEN-INS2-AMT             0902970
526870                              WMS-OTHER-CHGS                      IM002
526890                              WMS-INS2                            IM002
526910                              WMS-INSUR2-THIS-CY                  IM002
526930                              WMS-BILLED-INS2                     IM002
526950                              WMS-LOAN-YTD-INS2                   IM002
526970                              LOAN-DB-AMT                         IM002
526971                              WS-GL-LOAN-DB-AMT                   0902970
526990                              LOAN-DR-OTH, WS-GL-LOAN-DR-OTH      0902970
527010         MOVE HOLD-INS2-CHG TO HOLD-AMT                           IM002
527030         MOVE HOLD-AMT TO INS2-CHG, OTH-DISB                      IM002
527050         MOVE EX-LOAN-DISB TO EX01-LOAN-DISB                      IM002
527300         MOVE 'G5' TO IMEX-CODE-2
527350         MOVE '6' TO EX01-TYPE
527400         MOVE WBC-GENERATED-TRANS (16) TO GEN-TRAN-OPTION-HOLD    0266741
527450         MOVE '16' TO EX01-INT-CODE
527500         PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
527550     IF  HOLD-FEE-CHG NOT EQUAL TO ZERO                           IM002
527570         MOVE HOLD-FEE-CHG TO WK-HOLD-AMT13                       9915845
527650         PERFORM R0570 THRU R0584.
527700 R3652-EXIT.
527750     EXIT.
527800 R3660.
527850     IF  WMS-PYMT-CALC-CODE LESS THAN '3'
527900         IF  LOAN-PMT-TODAY EQUAL '1'
527950             GO TO R3665
528000         ELSE
528050             GO TO R3674.
528100     IF  STMT-TODAY EQUAL '0'
528150         GO TO R3674.
528200 R3665.
528400     IF  PRIME-CALC-FLAG EQUAL '2' OR '3'
528450         GO TO R3666.
528500     GO TO R3670.
528550 R3666.
528570     MOVE '1' TO PRIME-BILL-FLAG.                                 IM008
528600     PERFORM R5197 THRU R5200.                                    1003343
528620     MOVE 'N' TO LOAN-AGGR-SW.                                    IM006
528650     PERFORM PRIME-RATE-CALC THRU PRIME-EXIT.
528700     ADD +.005 WMS-LOAN-ACCR-INT GIVING HOLD-ACCR2.
528800     MULTIPLY HOLD-AMT9 BY HOLD-RATE GIVING WMS-LOAN-ACCR-AMT.
528850     IF  WMS-LOAN-ACCR-AMT LESS THAN ZERO
528900         MOVE ZERO TO WMS-LOAN-ACCR-AMT.
528910*  CHECK FOR PAYOFF TODAY - SET LOAN ACCR AMT TO ZERO             9915698
528920     IF  LOAN-PMT-TODAY EQUAL '1'                                 9915698
528930         IF  WMS-PRIN-BAL EQUAL ZERO                              9915698
528940             MOVE ZERO TO WMS-LOAN-ACCR-AMT.                      9915698
528950     MULTIPLY WMS-LOAN-ACCR-AMT BY WMS-LN-STMT-CY-DAYS
529000         GIVING WMS-LOAN-ACCR-INT.
529050     ADD WMS-LOAN-ACCR-INT  .005  GIVING HOLD-ACCR1.
529100     SUBTRACT HOLD-ACCR2 FROM HOLD-ACCR1.
529150     ADD HOLD-ACCR1 TO WMS-EARNED-INT LOAN-INT-ACC
529151                                      WS-GL-LOAN-INT-ACC          0902970
529152                                      WMS-LOAN-YTD-ACC-INT        1105132
529200                                      WMS-LOAN-ACCR-TODAY.        0902970
529250 R3670.
529300     IF  R3670-ALREADY EQUAL '1'
529350         GO TO R3674.
529400     MOVE '1' TO R3670-ALREADY.
529450     ADD +.005  WMS-LOAN-ACCR-INT GIVING HOLD-AMT.
529500     IF  HOLD-AMT NOT GREATER THAN ZERO
529550         GO TO R3673.                                             IM008
529600     MOVE ZERO TO WMS-LOAN-ACCR-INT.
529650 R3671.
529700     ADD HOLD-AMT TO WMS-INTRST-BAL
529750                     WMS-FINCHG-THIS-CY
529760                     WMS-FINCHG-YTD                               1020057
529800                     LOAN-INT-BILL
529801                     WS-GL-LOAN-INT-BILL                          0902970
529850                     LOAN-GEN-INT-AMT
529851                     WS-GL-LOAN-GEN-INT-AMT                       0902970
529900                     LOAN-DR-INT
529901                     WS-GL-LOAN-DR-INT                            0902970
529950                     LOAN-DB-AMT                                  0902970
529951                     WS-GL-LOAN-DB-AMT.                           0902970
530000     ADD +1 TO LOAN-GEN-INT-NO, WS-GL-LOAN-GEN-INT-NO,            0902970
530050               LOAN-DB-NO, WS-GL-LOAN-DB-NO.                      0902970
530100     MOVE WBC-GENERATED-TRANS (14) TO GEN-TRAN-OPTION-HOLD.       0266741
530150     MOVE '6' TO EX01-TYPE.
530200     MOVE 'G5' TO IMEX-CODE-2.
530250     MOVE '14' TO EX01-INT-CODE.
530300     PERFORM R3642 THRU R3642-EXIT.
530350     MOVE HOLD-AMT TO INT-DISB.
530400     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
530450     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
530500     MOVE '19' TO IMEX-REC-NO.
530550     MOVE 'L1' TO IMEX-CODE-1.
530600     MOVE WMS-LOAN-AGGREGATE-DATA TO EX19-LOAN-AGGR-DATA.
530650     MOVE HOLD-AMT TO EX19-LOAN-ACCR-INT.
530700     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
530750     SUBTRACT HOLD-AMT FROM WMS-AVAIL-BAL.
530800     PERFORM CALC-AVAIL-BAL THRU CALC-3.                          0427188
530853                                                                  IM008
530856 R3673.                                                           IM008
530859     PERFORM R5197 THRU R5200.                                    1003343
530860     MOVE 'N' TO LOAN-AGGR-SW.                                    1004643
530865     MOVE LOAN-ACCRUAL-DAY TO RET-DAYS.                           IM008
530866     IF  ACCR-DAYS-SKIPPED NOT LESS THAN RET-DAYS                 IM008
530867         MOVE WBC-LAST-PROC-THRU-DATE TO DT-LOW-DATE              0266741
530868         MOVE WBC-PAST-ACCR-DAYS TO RET-DAYS                      0266741
530869     ELSE                                                         IM008
530870         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0266741
530871         SUBTRACT ACCR-DAYS-SKIPPED FROM RET-DAYS                 IM008
530872         SUBTRACT +1 FROM RET-DAYS.                               IM008
530873     IF  RET-DAYS LESS THAN +0                                    IM008
530874         MOVE +0 TO RET-DAYS.                                     IM008
530875     CALL 'SIDHI' USING DATE-AREA.                                IM008
530881     MOVE WMS-DATE-LAST-BILLING TO DT-LOW-DATE.                   1004643
530882     CALL 'SIDIF1' USING DATE-AREA.                               1004643
530883     CALL 'SICOMPDT' USING WMS-DATE-LAST-STMT                     1004643
530884                           WMS-DATE-LAST-BILLING                  1004643
530885                           BILLING-DATE-FLAG                      1004643
530886                           BILLING-DATE-FORMATS.                  1004643
530887     IF  BILLING-DATE-FLAG EQUAL 'L'                              1004643
530888         ADD RET-DAYS  TO WMS-LN-BILL-CY-DAYS                     1004643
530889     ELSE                                                         1004643
530890         MOVE RET-DAYS TO WMS-LN-BILL-CY-DAYS.                    1004643
530891     MOVE DT-HIGH-DATE TO WMS-DATE-LAST-BILLING.                  1004643
530892     IF  PRIME-CALC-FLAG EQUAL '2' OR '3'                         2016432
530893         MOVE WMS-LN-STMT-CY-DAYS TO WMS-LN-BILL-CY-DAYS.         2016432
530900 R3674.
530950     EXIT.
530954 R3675.                                                           0901864
530956     IF  (WMS-PRIN-BAL EQUAL ZERO                                 0901864
530958     AND WMS-LOAN-ACCR-INT EQUAL ZERO                             0901864
530960     AND WMS-INTRST-BAL EQUAL ZERO                                0901864
530962     AND WMS-OTHER-CHGS EQUAL ZERO                                0901864
530964     AND PRIME-CALC-FLAG NOT EQUAL '2' AND '3')                   0901864
530966     IF  STMT-TODAY EQUAL '1'                                     0901864
530968         PERFORM R5197 THRU R5200                                 1003343
530970         MOVE 'N'  TO LOAN-AGGR-SW.                               1004643
530982 R3679.                                                           0901864
530983     IF  LOAN-ACCRUAL-DAY LESS THAN WBC-ACCRUAL-DAYS              0266741
530984         IF  WMS-INT-RATE-PTR GREATER THAN +5                     1003343
530985         AND WMS-PRIME-CHNG-RTE NOT EQUAL '1'                     1003343
530986             MOVE WMS-LOAN-STMT-CLEAR TO SAVE-LOAN-STMT-CLEAR     1003343
530987             MOVE WMS-LOAN-STATEMENT-INFO TO                      1003343
530988                                     SAVE-LOAN-STATEMENT-INFO     1003343
530989             MOVE WMS-ANNUAL-RATE     TO SAVE-ANNUAL-RATE         1003343
530990             MOVE WMS-DAILY-RATE      TO SAVE-DAILY-RATE          1003343
530991             MOVE WMS-PRIME-RATE      TO SAVE-PRIME-RATE          1003343
530992             MOVE WMS-BEGIN-INT       TO SAVE-BEGIN-INT           1003343
530993             MOVE WMS-DATE-LAST-BILLING TO SAVE-DATE-LAST-BILLING 1003343
530996             PERFORM C2260 THRU C2260-EXIT                        1003343
530997             MOVE WMS-DATE-LAST-BILLING  TO CYCL-DATE-LAST-BILLING1003343
530998             MOVE WMS-LN-BILL-CY-DAYS    TO CYCL-LN-BILL-CY-DAYS  1003343
530999             MOVE SAVE-DATE-LAST-BILLING TO WMS-DATE-LAST-BILLING 1003343
531000             MOVE SAVE-LN-BILL-CY-DAYS   TO WMS-LN-BILL-CY-DAYS   1003343
531001             MOVE '1' TO PRIME-RATE-CHG                           1003343
531002             IF  WMS-DATE-LAST-RATE-CHANGE EQUAL WBC-CAPTURE-DATE 0266741
531003                 MOVE WBC-CAPTURE-DATE    TO DT-LOW-DATE          0266741
531004                 MOVE LOAN-ACCRUAL-DAY    TO RET-DAYS             1003343
531005                 CALL 'SIDHI' USING DATE-AREA                     1003343
531006                 MOVE DT-HIGH-DATE   TO WMS-DATE-LAST-RATE-CHANGE.1003343
531020     GO TO R3630.                                                 1003343
531080*                                                                 1003343
531090 R3685.                                                           1003343
531100     IF  PRIME-RATE-CHG EQUAL '1'                                 1003343
531130         PERFORM CALC-AVAIL-BAL THRU CALC-3                       1003343
531140         MOVE LOAN-BAL TO SAVE-PAYOFF-AMT.                        1003343
531150     SKIP3                                                        1003343
535850 LOAN-SECTION-H      SECTION 26.
535900     SKIP3
535950*    ************ LOAN TRANSACTION GENERATION ************
536000     SKIP1
536050 R3690.
536100******************************************************************
536190***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE THE OUTPUT     IM002
536280***  GENERATED LOAN TRANSACTION PRIOR TO ITS BEING WRITTEN.       IM002
536370***                                                               IM002
536460***  COPY IM31UBWR.                                               IM002
536550***                                                               IM002
536640***  END OF USER EXIT.                                            IM002
536730******************************************************************IM002
537000     IF  LOAN-TODAY NOT GREATER THAN ZERO                         1105706
537010         GO TO R3690-END.                                         1105706
537020     IF  UB-OPTION-FLAG(0018) EQUAL 'Y'                           0417235
537022         PERFORM UO-OPT0018-A THRU UO-OPT0018-A-EXIT.             0417235
537050     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-BAL-CHANGE.           0266741
537100     MOVE LOAN-TODAY TO HOLD-AMT.
537150     ADD +1 TO FS-CR.
537200     PERFORM K7500 THRU K8500.
537250     MOVE WBC-GENERATED-TRANS (7) TO GEN-TRAN-OPTION-HOLD.        0266741
537300     ADD HOLD-AMT TO WMS-CURR-BAL.
537320     ADD LOAN-MIN-BAL TO WMS-DDA-BAL.                             IM005
537350     ADD +1 TO DDA-LOAN-NO, WS-GL-DDA-LOAN-NO.                    0902970
537400     ADD HOLD-AMT TO DDA-LOAN-AMT, WS-GL-DDA-LOAN-AMT.            0902970
537450     ADD +1 TO WMS-STMT-NO-CREDITS.
537500     ADD HOLD-AMT TO WMS-STMT-CR-AMT.
537550     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
537600     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
537650         ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                     0902970
537700         ADD HOLD-AMT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT             0902970
537750     ELSE
537800         ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                     0902970
537850         ADD HOLD-AMT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.            0902970
537900     MOVE '07' TO EX01-INT-CODE.
537950     MOVE '2' TO EX01-TYPE.
538000     MOVE ZERO TO EX01-NUMBER.
538050     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
538100     MOVE WBC-GENERATED-TRANS (8) TO GEN-TRAN-OPTION-HOLD.        0266741
538150     ADD +1 TO LOAN-TODAY-NO, WS-GL-LOAN-TODAY-NO.                0902970
538200     ADD HOLD-AMT TO LOAN-TODAY-AMT, WS-GL-LOAN-TODAY-AMT.        0902970
538250     ADD +1 TO LOAN-DB-NO, WS-GL-LOAN-DB-NO, WMS-LN-STMT-DB-NO.   0902970
538300     ADD HOLD-AMT TO LOAN-DB-AMT, WS-GL-LOAN-DB-AMT               0902970
538350                     WMS-LN-STMT-DB-AMT
538400                     LOAN-DR-PRIN, WS-GL-LOAN-DR-PRIN.            0902970
538450     MOVE '08' TO EX01-INT-CODE.
538500     MOVE 'G5' TO IMEX-CODE-2.
538550     MOVE '6' TO EX01-TYPE.
538600     PERFORM R0345 THRU R0346.
538650     MOVE HOLD-AMT TO PRIN-DISB.
538700     MOVE EX-LOAN-DISB TO EX01-LOAN-DISB.
538750     MOVE ZERO TO EX01-NUMBER.
538760     IF  UB-OPTION-FLAG(0018) EQUAL 'Y'                           0417235
538762         PERFORM UO-OPT0018-B THRU UO-OPT0018-B-EXIT.             0417235
538800     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
538810     IF  UB-OPTION-FLAG(0018) EQUAL 'Y'                           0417235
538812         PERFORM UO-OPT0018-C THRU UO-OPT0018-C-EXIT.             0417235
538850     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-LOAN-ACTIVITY         0266741
538900                             WMS-DATE-LAST-ADVANCE.
538950     MOVE HOLD-AMT TO WMS-AMT-LAST-ADVANCE.
539000     MOVE ZERO TO LOAN-TODAY                                      1105706
539010                  LOAN-MIN-BAL.                                   1105706
539050     MOVE WMS-PRIN-BAL TO WMS-PRIN-LAST-ADVANCE.
539100     MOVE WMS-INTRST-BAL TO WMS-INT-LAST-ADVANCE.
539150     MOVE WMS-OTHER-CHGS TO WMS-CHGS-LAST-ADVANCE.
539175 R3690-END.                                                       1105706
539200*                                                                 1105706
539250*    *************  LOAN OVERLIMIT PROCESSING  *************
539300     SKIP1
539350 R3695.
539400     IF OVER-LINE EQUAL TO '0', GO TO R3700.
539450     IF WMS-OVERLIMIT EQUAL TO '0'
539500         MOVE '1' TO WMS-OVERLIMIT
539550     ELSE
539600         MOVE '2' TO WMS-OVERLIMIT.
539650     MOVE '1' TO WMS-OVER-THIS-CYCLE.
539700     SKIP3
539750*----------------------------------------------------------------*1105504
539760*    AUTOBORROW PROCESSING                                       *1105504
539770*----------------------------------------------------------------*1105504
539780     COPY IMPD31AB.                                               1105504
539790                                                                  1105504
539840 ROOT-SECTION-J      SECTION 1.                                   IM006
539843     SKIP3                                                        IM006
539850*    ************************************************************
539900*    ****   THIS AREA IS A LOOP AREA FOR ACCRUALS, INTEREST *****
539950*    ****  CHARGES AND PAYMENTS, AGGREGATES AND SERVICE     *****
540000*    ****  CHARGES. THE NUMBER OF LOOPS DEPENDS UPON THE    *****
540050*    ****  NUMBER OF ACCRUAL DAYS. THE NUMBER OF ACCRUAL    *****
540100*    ****  DAYS DEPENDS UPON NON PROCESS DAYS THE SYSTEM IS *****
540150*    ****  ACCRUING FOR. SEE THE BCR OPTIONS.               *****
540200*    ************************************************************
540250     SKIP3
540300 R3700.
540310     IF  BYPASS-ACTIVITY-SW EQUAL '1',  GO  TO  R4500.            0737689
540320     IF  WBC-BUSINESS-DAYS NOT LESS WBC-PREV-BUS-DAYS             0266741
540330         SUBTRACT WBC-PREV-BUS-DAYS FROM WBC-BUSINESS-DAYS        0266741
540340             GIVING WORK-BUSINESS-DAYS                            IM007
540350     ELSE                                                         IM007
540360         MOVE WBC-BUSINESS-DAYS TO WORK-BUSINESS-DAYS.            0266741
540370     SUBTRACT WBC-CURR-PAST-BUS-DAYS FROM WORK-BUSINESS-DAYS.     0266741
540380     SUBTRACT +1 FROM WORK-BUSINESS-DAYS.                         IM007
540400     MOVE +0 TO ACCRUAL-DAY.
540450     MOVE WBC-ACCRUAL-DAYS TO HOLD-ACCRUAL-DAYS.                  0266741
540458     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       IM005
540466     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     IM005
540474         ADD WBC-ACCRUAL-DAYS TO WMS-MTD-ACCRUAL-DAYS.            0266741
540482     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM005
540490         ADD WBC-ACCRUAL-DAYS TO WMS-INT-MTD-ACCR-DAYS.           0266741
540500     IF  SAVINGS-MINIMUM EQUAL '1'
540550         ADD WMS-MIN-AMT-FOR-SUPER TO WMS-INT-CUR-BAL
540600                                  WMS-CURR-BAL
540650                                  CUR-BAL
540700         MOVE '0' TO SAVINGS-MINIMUM.
541000******************************************************************IM004
541005****    THE FOLLOWING IF STATEMENT WILL CAUSE THE SWEEP TO OCCUR *IM004
541010****   BEFORE ACCRUALS FOR CMA ACCOUNTS USING TODAY'S BALANCE.   *IM005
541015******************************************************************IM004
541020     IF  WMS-SAVINGS-TRLR EQUAL TO '1' AND                        IM004
541025         WMS-CMA-INDICATOR GREATER THAN '0' AND                   IM004
541030         WMS-CMA-BALANCE-USE EQUAL '0' AND                        IM007
541031         WMS-INT-STATUS LESS THAN '7'                             IM007
541035         PERFORM R4605 THRU R4690-EXIT.                           IM004
541040     SKIP3                                                        IM004
541050 R3710.
541100     IF  WMS-SAVINGS-TRLR EQUAL TO '0'
541150     OR  (WMS-INT-STATUS EQUAL '2' OR '7' OR '8')
541170     OR  WMS-CMA-INDICATOR EQUAL '1'                              IM005
541200     OR  WMS-DDA-MAX-FLAG NOT EQUAL TO '1'
541250     OR  WMS-MIN-BAL GREATER THAN WMS-DDA-MAX-BAL
541300         GO  TO  R3710-EXIT.
541310     COMPUTE HOLD-AMT15 = WMS-DDA-BAL - AMT-UNAVAIL.              9916072
541350     IF  HOLD-AMT15 GREATER THAN WMS-DDA-MAX-BAL                  9916072
541400         SUBTRACT WMS-DDA-MAX-BAL FROM HOLD-AMT15                 9916072
541450             GIVING HOLD-AMT
541452         IF  UB-OPTION-FLAG(0019) EQUAL 'Y'                       0527332
541454             PERFORM UO-OPT0019-A THRU UO-OPT0019-A-END           0527332
541456         END-IF                                                   0527332
541500         SUBTRACT HOLD-AMT FROM TRANSFER-AMT
541550         ADD HOLD-AMT TO WMS-INT-CUR-BAL WMS-DDA-MAX-CYCLE-AMT
541600         ADD HOLD-AMT TO WMS-DDA-MAX-MTD-AMT
541650         MOVE 'N' TO MAX-TRNSFR-FG
541700         COMPUTE WMS-DDA-BAL = WMS-CURR-BAL - WMS-INT-CUR-BAL     0727507
541750         IF  MAX-PASS EQUAL '0'
541800             MOVE '1' TO MAX-PASS
541850             ADD +1 TO WMS-DDA-MAX-CYCLE-NO
541900                       WMS-DDA-MAX-MTD-NO.
541950 R3710-EXIT. EXIT.
542000 SKIP3
542050*    **************** IOD INTEREST ACCRUAL ****************
542100 SKIP1
542150 R3775.
542200     ADD +1 TO ACCRUAL-DAY.
542202     MOVE '0'                TO WS-WORK-CAL-YR                    0617360
542204                                WS-WORK-TAX-YR.                   0617360
542206     MOVE WMS-IOD-DIST-PL-CD TO WS-WORK-PLN-CODE.                 0617360
542208     MOVE SPACES             TO WS-WORK-PLN-CODE2.                0617360
542210     MOVE '0'                TO WS-WORK-TAX-CODE.                 0617360
542240 R3775A.                                                          IM004
542250     IF  WMS-IOD-RATE-PTR EQUAL ZERO AND
542300         WMS-HIFI-INDICATOR EQUAL ZERO
542350         GO TO R3800.
542400     SKIP3
542450 IOD-INT-SECTION-A   SECTION 20.
542500 R3776.
542550     MOVE '1' TO INTEREST-ADJUST-CODE.
542570     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            0902509
543400 R3778.
543450     MOVE WMS-DDA-BAL TO CUR-BAL.
543500     MOVE WMS-IOD-CALC TO CALC-FLAG.
543550     PERFORM K0104 THRU K0105.
543600     MOVE CUR-BAL TO ACCRUAL-BALANCE.
543650     MOVE +1 TO ACCRUAL-DAYS.
543700     MOVE 'N' TO IOD-FLAG.
543750 R3780.
543755     IF (WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3')              0437111
543760     AND ACCRUAL-BALANCE NOT GREATER THAN ZERO                    IM005
543765         MOVE '7' TO INTEREST-ADJUST-CODE                         IM005
543770         PERFORM ADJUST-ACCRUED-INTEREST THRU END-INT-ADJUST      IM005
543775         MOVE ZEROES TO WMS-IOD-DAILY-ACC, PROJ-ACCR-IOD-BAL      IM005
543780         MOVE '1' TO INTEREST-ADJUST-CODE                         IM005
543785         MOVE 'F' TO IOD-FLAG                                     IM005
543790         GO TO R3781.                                             1004015
543800     IF ACCRUAL-BALANCE GREATER THAN ZERO
543810     OR (WMS-IOD-RATE-USE EQUAL 'S'                               9915845
543815     AND WMS-HIFI-INDICATOR GREATER THAN +0)                      9915845
543820     OR (BHW-IOD-FLAG  EQUAL 'I' OR 'M')                          0902213
543850         MOVE ACCRUAL-BALANCE TO PROJ-ACCR-IOD-BAL
543900         PERFORM ADJUST-ACCRUED-INTEREST THRU END-INT-ADJUST
543950     ELSE
543970         MOVE ZEROES TO WMS-IOD-DAILY-ACC, PROJ-ACCR-IOD-BAL.     IM005
543975*                                                                 1105232
543977     IF  STMT-TODAY EQUAL '1'                                     1105232
543980     AND STMT-CYCLE-DAY EQUAL ACCRUAL-DAY                         1105232
543983         MULTIPLY WMS-IOD-CYC-ACC-INT BY +1 GIVING                1105232
543985                  WS-IOD-TIS-HOLD-CYC-BEG-ACCR ROUNDED.           1105232
543990     MOVE 'F' TO IOD-FLAG.                                        IM005
544000                                                                  1004015
544010*----------------------------------------------------------------*1004015
544020*    AGGREGATE BALANCE FOR REG DD BEFORE INTEREST PAYMENT.       *1004015
544030*    FORCE AGGREGATES TO BE ON A CALENDAR-DAY BASIS.             *1004015
544040*----------------------------------------------------------------*1004015
544050 R3781.                                                           1004015
544051*----------------------------------------------------------------*1105504
544052*    BYPASS ALL AGGREGATE CALCULATIONS DURING STATIS RUN.        *1105504
544053*----------------------------------------------------------------*1105504
544054     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
544055     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
544056         GO TO R3785-EXIT.                                        1105504
544060     IF  WMS-STATUS EQUAL '04' OR '05' OR '08'                    1004015
544070         GO TO R3785-EXIT.                                        1004015
544080     ADD +1 TO WMS-IOD-TIS-AGGR-DAYS.                             1004015
544085     IF  WMS-IOD-CALC EQUAL '1'                                   1004595
544090     OR  WMS-TISA-AGGR-BAL-CD EQUAL '1'                           1004595
544095         IF  WMS-DDA-BAL GREATER THAN ZERO                        1004595
544098             ADD WMS-DDA-BAL TO WMS-IOD-TIS-AGGR-BAL              1004595
544100             GO TO R3785-EXIT                                     1004595
544101         ELSE                                                     1004595
544102             GO TO R3785-EXIT.                                    1004595
544103     IF  ACCRUAL-BALANCE GREATER THAN ZERO                        1004595
544105         ADD ACCRUAL-BALANCE TO WMS-IOD-TIS-AGGR-BAL.             1004595
544110 R3785-EXIT.                                                      1004015
544120     EXIT.                                                        1004015
544200 SKIP3
544250*    ********** IOD INTEREST PAYMENT PROCESSING **********
544300 SKIP3
544350 R3790.
544351     MOVE ZERO TO SAVE-IOD-TAX SAVE-IOD-TAX-ST SAVE-IOD-TAX-LOC.  2012254
544357     IF  WBC-YEAR-END-INT-CODE EQUAL '1'                          0266741
544364     AND (WBC-YEAR-END EQUAL '1'                                  0266741
544366     OR  WBC-ALT-DUAL-YEAR-END EQUAL '1')                         0266741
544371         IF  WBC-ACCRUAL-DAYS EQUAL ACCRUAL-DAY                   0266741
544378             GO TO R3797                                          IM006
544385         ELSE                                                     IM006
544390             GO TO R3800.                                         9915845
544392***  THE FOLLOWING EXIT IS FOR INDEPENDENT INTEREST PAY CYCLE     9915851
544393***                                                               9915845
544394     COPY IMPD31PI.                                               9915851
544398                                                                  9915845
544399 R3794.                                                           9915845
544400     IF  WMS-IOD-INT-PAY-CYCLE EQUAL '2' OR '4',    GO  TO  R3795.9915845
544450     IF  SVCH-TODAY EQUAL '0',  GO  TO  R3800.
544500     IF  SVCH-CYCLE-DAYX EQUAL ' '
544550         IF  STMT-CYCLE-DAY EQUAL ACCRUAL-DAY
544600             GO  TO  R3797
544650         ELSE
544700             GO  TO  R3800
544750     ELSE
544800         IF  SVCH-CYCLE-DAY EQUAL ACCRUAL-DAY
544850             GO  TO  R3797.
544900     GO  TO  R3800.
544950 R3795.
545000     IF  STMT-TODAY EQUAL '0',  GO  TO  R3800.
545050     IF  STMT-CYCLE-DAY NOT EQUAL ACCRUAL-DAY,  GO  TO  R3800.
545100 R3797.
545102     MOVE '1' TO WMS-IOD-INT-CLEAR.                               0917853
545150     MOVE 'N' TO IOD-FLAG.
545200     PERFORM R3835 THRU R3864.
545250     MOVE 'F' TO IOD-FLAG.
545300     PERFORM R3710 THRU R3710-EXIT.
545350     SKIP3
545400 ROOT-SECTION-H      SECTION 1.
545450 SKIP3
545500*    ********  SAVINGS TRAILER PROCESSING  ********
545550     SKIP1
545600 R3800.
545650     IF WMS-SAVINGS-TRLR EQUAL TO '0'
545700     OR  WMS-INT-STATUS GREATER THAN '6'
545750         GO TO R3864.
545800     SKIP3
545850 INTRST-SECTION-B    SECTION 21.
545900 SKIP3
545950*    ****************  SAV INTEREST ACCRUAL  ****************
546000     SKIP1
546050 R3820.
546100     MOVE '1' TO INTEREST-ADJUST-CODE, CALC-FLAG.
546150     PERFORM R4005 THRU R4007.
546157     IF  CLEAR-SAV-CY-SW EQUAL 'N'                                IM002
546164         MOVE ZERO TO WMS-INT-AGGR-BAL                            IM002
546171                      WMS-INT-AGGR-DAYS                           IM002
546178         MOVE 'F' TO CLEAR-SAV-CY-SW.                             IM002
546200     MOVE CUR-BAL TO PROJ-ACCR-SV-BAL.
547000 R3824.
547007     IF  (WMS-HIFI-INDICATOR GREATER THAN +0                      0902509
547010     AND (WMS-MMDA-INDICATOR NOT EQUAL '1' AND '2' AND '3'))      0437111
547014     AND ACCRUAL-BALANCE NOT GREATER THAN ZERO                    IM005
547021         MOVE '7' TO INTEREST-ADJUST-CODE                         IM005
547028         PERFORM ADJUST-ACCRUED-INTEREST THRU END-INT-ADJUST      IM005
547035         MOVE '1' TO INTEREST-ADJUST-CODE                         IM005
547042         GO TO R3825.                                             IM005
547050     IF ACCRUAL-BALANCE GREATER THAN ZERO
547070     OR  BHW-SAV-FLAG EQUAL 'R' OR 'T'                            0316967
547100         PERFORM ADJUST-ACCRUED-INTEREST THRU END-INT-ADJUST.
547101*                                                                 1105232
547102     IF  STMT-TODAY EQUAL '1'                                     1105232
547103     AND STMT-CYCLE-DAY EQUAL ACCRUAL-DAY                         1105232
547105         MULTIPLY WMS-ACCR-INT BY +1 GIVING                       1105232
547106                  WS-INT-TIS-HOLD-CYC-BEG-ACCR ROUNDED.           1105232
547110 R3825.                                                           1004015
547115*----------------------------------------------------------------*1004015
547120*    AGGREGATE BALANCE FOR REG DD BEFORE INTEREST PAYMENT.       *1004015
547125*    FORCE AGGREGATES TO BE ON A CALENDAR-DAY BASIS.             *1004015
547130*----------------------------------------------------------------*1004015
547135     IF  WMS-INT-STATUS EQUAL '7' OR '8'                          1004015
547140         GO TO R3825-EXIT.                                        1004015
547145     IF  WMS-INT-STATUS EQUAL '0'                                 1004015
547150     AND WMS-INT-CUR-BAL NOT GREATER THAN ZERO                    1004382
547155         GO TO R3825-EXIT.                                        1004015
547160     ADD +1 TO WMS-INT-TIS-AGGR-DAYS.                             1004015
547165     IF  WMS-INT-CUR-BAL GREATER THAN ZERO                        1004382
547170         ADD WMS-INT-CUR-BAL TO WMS-INT-TIS-AGGR-BAL.             1004382
547175 R3825-EXIT.                                                      1004015
547180     EXIT.                                                        1004015
547200     SKIP3
547250*    **********SAV INTEREST PAYMENT PROCESSING  **********
547300     SKIP1
547350 R3830.
547400     MOVE ZERO TO TODAYS-INTRST-PYMT.
547403     MOVE ZERO TO SAVE-SAV-TAX SAVE-SAV-TAX-ST SAVE-SAV-TAX-LOC.  2012254
547407     IF  WBC-YEAR-END-INT-CODE EQUAL '1'                          0266741
547414     AND (WBC-YEAR-END EQUAL '1'                                  0266741
547416     OR  WBC-ALT-DUAL-YEAR-END EQUAL '1')                         0266741
547421         IF  WBC-ACCRUAL-DAYS EQUAL ACCRUAL-DAY                   0266741
547428             GO TO R3835                                          IM006
547435         ELSE                                                     IM006
547440             GO TO R3864.                                         9915845
547444*                                                                 9915851
547445     COPY IMPD31SP.                                               9915851
547448*                                                                 9915851
547449 R3831.                                                           9915845
547450     IF  WMS-SAV-INT-PAY-CYCLE EQUAL '2' OR '3',    GO  TO  R3832.9915845
547500     IF  SVCH-TODAY EQUAL '0',  GO  TO  R3864.
547550     IF  SVCH-CYCLE-DAYX EQUAL ' '
547600         IF  STMT-CYCLE-DAY EQUAL ACCRUAL-DAY
547650             GO  TO  R3835
547700         ELSE
547750             GO  TO  R3864
547800     ELSE
547850         IF  SVCH-CYCLE-DAY EQUAL ACCRUAL-DAY
547900             GO  TO  R3835.
547950     GO  TO  R3864.
548000 R3832.
548050     IF  STMT-TODAY EQUAL '0',  GO  TO  R3864.
548100     IF  STMT-CYCLE-DAY NOT EQUAL ACCRUAL-DAY,  GO  TO  R3864.
548150 R3835.
548170     MOVE 'Y' TO WS-ZERO-CYC-BEG-ACCR.                            1105232
548200     IF IOD-FLAG EQUAL 'N'
548250         MOVE WBC-INTRST-PAY-PHASE (WMS-IOD-INT-CALC) TO IM31-PH2 0266741
548260         IF  STMT-TODAY EQUAL '0'                                 1105232
548270             MOVE ZERO TO WMS-IOD-TIS-CYC-BEGIN-ACCR              1105232
548280         ELSE                                                     1105232
548290             NEXT SENTENCE                                        1105232
548300     ELSE
548350         MOVE WBC-INTRST-PAY-PHASE (WMS-INTRST-CALC) TO IM31-PH2  0266741
548360         IF  STMT-TODAY EQUAL '0'                                 1105232
548370             MOVE ZERO TO WMS-INT-TIS-CYC-BEGIN-ACCR.             1105232
548400     IF IM31-PH2 EQUAL TO SPACES
548450         GO TO R3864.
548455     MOVE +0 TO BRT-CNT.                                          2016374
548460     IF  WMS-BIR-FLAG EQUAL '1' OR '2'                            2016374
548465         IF  BONUS-CLEAR EQUAL 'F'                                2016374
548470             MOVE +0 TO WMS-BIR-AMT-PD                            2016374
548480             MOVE 'N' TO BONUS-CLEAR                              2016374
548485             PERFORM GET-BONUS-RATES THRU GET-BONUS-EXIT          2016374
548490         ELSE                                                     2016374
548495             PERFORM GET-BONUS-RATES THRU GET-BONUS-EXIT.         2016374
548500     CALL 'SILINK' USING IM31-PHASE
548550                           MASTER-AREA
548600                           TODAYS-INTRST-PYMT
548650                           IOD-FLAG
548700                           STMT-TODAY
548750                           SVCH-TODAY
548800                           IOD-CLOSE-FLAG
548850                           IOD-CLEAR
548900                           SAV-CLEAR
548950                           HIFI-RPT-INEL-FLAG
548960                           ACCRUAL-DAY                            1004015
548965                           BRT-CNT                                2016374
548970                           DDA-WRKBCR-1                           0266741
548980                           DDA-WRKBCR-4                           0266741
548985                           WORK-BRT-AREA.                         2016374
549013*--------------------------------------------------------------*  0902213
549016***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE INTEREST    *  0902213
549019***  PAYMENTS.                                                 *  0902213
549022***                                                            *  0902213
549025***  COPY IM31UR38.                                            *  0902213
549028***                                                            *  0902213
549031***  END OF USER EXIT.                                         *  0902213
549034*--------------------------------------------------------------*  0902213
549037     IF  TODAYS-INTRST-PYMT LESS THAN ZERO                        0902213
549040         MOVE ZERO TO TODAYS-INTRST-PYMT.                         0902213
549094 R3835-EXIT.                                                      2016374
549096       EXIT.                                                      2016374
549098 R3837.                                                           2016374
549100     IF IOD-FLAG EQUAL TO 'N' GO TO R3838.
549120     MOVE 'N' TO CLEAR-SAV-CY-SW.                                 IM002
549150     MOVE TODAYS-INTRST-PYMT TO TDAY-SAV-PMT.
549200     IF  SAV-CLEAR EQUAL 'F'
549250         GO TO R3864.
549300     MOVE WMS-ACCR-INT TO ACCRUAL-AMOUNT.
549350     IF WMS-ACCR-INT GREATER THAN ZERO
549400         ADD +.005 TO ACCRUAL-AMOUNT
549450     ELSE
549500         ADD -.005 TO ACCRUAL-AMOUNT.
549550     MOVE ACCRUAL-AMOUNT TO HOLD-AMT9.
549600     MOVE HOLD-AMT9 TO WMS-INT-EARN-INT.
549650     IF  TODAYS-INTRST-PYMT EQUAL TO HOLD-AMT9                    1004795
549655         ADD TODAYS-INTRST-PYMT  TO WMS-INT-TIS-EARN-INT          1004795
549656         SUBTRACT WMS-ACCR-INT FROM WMS-INT-TIS-EARN-INT          1004795
549700         GO TO R3850.
549750     SUBTRACT HOLD-AMT9 FROM TODAYS-INTRST-PYMT                   0902477
549760         GIVING WK-HOLD-AMT13.                                    0827727
549800     GO TO R3840.
549850 R3838.
549900     MOVE TODAYS-INTRST-PYMT TO TDAY-IOD-PMT.
549950     IF  IOD-CLEAR EQUAL 'F'
550000         GO TO R3864.
550050     MOVE WMS-IOD-CYC-ACC-INT TO ACCRUAL-AMOUNT.
550100     IF WMS-IOD-CYC-ACC-INT GREATER THAN ZERO
550150         ADD +.005 TO ACCRUAL-AMOUNT
550200     ELSE
550250         ADD -.005 TO ACCRUAL-AMOUNT.
550300     MOVE ACCRUAL-AMOUNT TO HOLD-AMT9.
550350     IF  TODAYS-INTRST-PYMT EQUAL TO HOLD-AMT9                    1004795
550355         ADD TODAYS-INTRST-PYMT         TO WMS-IOD-TIS-EARN-INT   1004795
550356         SUBTRACT WMS-IOD-CYC-ACC-INT FROM WMS-IOD-TIS-EARN-INT   1004795
550400         GO TO R3850.
550450     SUBTRACT HOLD-AMT9 FROM TODAYS-INTRST-PYMT                   0902477
550460         GIVING WK-HOLD-AMT13.                                    9915845
550500 R3840.
550550     IF  IOD-FLAG EQUAL 'N'
550600         ADD WK-HOLD-AMT13 TO IOD-INT-ACC-ADJ-INT                 9915845
550601                              WS-GL-IOD-INT-ACC-ADJ-INT           0902970
550610                              WMS-IOD-MTD-ACC-INT                 0902477
550615                              WMS-IOD-YTD-ACC-INT                 1105132
550620                              WMS-IOD-TIS-EARN-INT                1004015
550650         MOVE 'K8' TO IMEX-CODE-1
550700     ELSE
550710         MOVE 'K6' TO IMEX-CODE-1                                 1004554
550750         ADD WK-HOLD-AMT13 TO WMS-MTD-ACCR-INT                    9915845
550755                              WMS-YTD-ACCR-INT                    1105132
550760                              WMS-INT-TIS-EARN-INT                1004554
550770         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
550780             ADD WK-HOLD-AMT13 TO INV-DIV-INTL-ADJ                9915845
550800                                  WS-GL-INV-DIV-INTL-ADJ          1004554
550810         ELSE                                                     1004554
550820             ADD WK-HOLD-AMT13 TO DDA-INT-ACC-ADJ-INT             9915845
550830                                  WS-GL-DDA-INT-ACC-ADJ-INT.      1004554
550850     MOVE '02' TO IMEX-REC-NO.
550900     MOVE WK-HOLD-AMT13 TO EX02-BAL.                              9915845
550910     ADD +1 TO SEQ-CTR.                                           IM004
550920     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 IM004
550950     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
550955     IF  WMS-IOD-TIS-EARN-INT LESS THAN ZERO                      1004015
550960         MOVE ZERO TO WMS-IOD-TIS-EARN-INT.                       1004015
550965     IF  WMS-SAVINGS-TRLR EQUAL '1'                               1004015
550970     AND WMS-INT-TIS-EARN-INT LESS THAN ZERO                      1004015
550975         MOVE ZERO TO WMS-INT-TIS-EARN-INT.                       1004015
551000 R3845.  EXIT.
551050 R3850.
551100     IF IOD-FLAG EQUAL TO 'N'
551150         GO TO R3862.
551200     IF TODAYS-INTRST-PYMT EQUAL TO ZERO
551250         GO TO R3855.
551350     ADD TODAYS-INTRST-PYMT TO WMS-CURR-BAL
551400                               WMS-INT-CUR-BAL                    IM002
551450                               WMS-MTD-INT-PAID                   1004554
551500                               WMS-MTD-CALC-INT                   1004554
551550                               WMS-INT-ACCUM-INT                  1004554
551551                               WMS-YTD-INT-PAID.                  0617360
551552     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
551553         ADD TODAYS-INTRST-PYMT TO WMS-PLN-TRLR-PR-LTD-INT-PD.    0617360
551554     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
551556         ADD TODAYS-INTRST-PYMT TO WMS-DUAL-YR-CUR-SAV-INT.       9915858
551557     MOVE ACCR-MO TO WORK-INT-MM.                                 0436983
551558     MOVE ACCR-DA TO WORK-INT-DD.                                 0436983
551559     MOVE ACCR-YR TO WORK-INT-YY.                                 0436983
551560     MOVE WRK-INT-LAST-PAID-DATE                                  0436983
551561                  TO WMS-IOD-INT-DATE-LAST-PMT.                   0436983
551562     PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT.                  9915828
551564     IF  CERT-NAME-W8-STATUS EQUAL '1'                            9915828
551566         ADD TODAYS-INTRST-PYMT TO WMS-YTD-INT-PAID-1042.         9915828
551570     MOVE TODAYS-INTRST-PYMT TO WMS-INT-CALC-INT.                 1004554
551600     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
551610         ADD TODAYS-INTRST-PYMT TO INV-DIV-PAID-TDY               1004554
551620                                   WS-GL-INV-DIV-PAID-TDY         1004554
551630     ELSE                                                         1004554
551640         ADD +1                 TO DDA-INT-PAID-NO                1004554
551650                                   WS-GL-DDA-INT-PAID-NO          1004554
551660         ADD TODAYS-INTRST-PYMT TO DDA-INT-PAID-AMT               1004554
551670                                   WS-GL-DDA-INT-PAID-AMT         1004554
551680                                   DDA-INT-PAID-TODAY             1004554
551690                                   WS-GL-DDA-INT-PAID-TODAY.      1004554
551700     IF  SAV-BKUP-WTHLD-FLAG EQUAL ZERO                           IM007
551710     AND WMS-STATE-LOCAL-TX-CD EQUAL ZERO                         2012254
551730         GO TO R3852.                                             IM003
551760     MOVE IOD-FLAG           TO TAX-CALC-IOD-FLAG.                IM003
551790     MOVE TODAYS-INTRST-PYMT TO TAX-CALC-PAYMENT.                 IM003
551820     MOVE ZERO               TO TAX-CALC-AMOUNT                   2012254
551821                                TAX-CALC-AMOUNT-ST                2012254
551822                                TAX-CALC-AMOUNT-LOC.              2012254
551850     MOVE '0'                TO TAX-CALC-REASON.                  IM003
551880     PERFORM R3899-CALC-TAX-DAYS THRU R3899-EXIT.                 IM003
551910     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.                 IM003
551920 R3851.                                                           IM007
551940     IF  TAX-CALC-AMOUNT NOT GREATER THAN ZERO                    IM007
551945         GO TO R3851-STATE.                                       2012254
551956     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN '2'                     IM007
551976     OR  WMS-CMA-INDICATOR EQUAL '1'                              IM007
551980     OR  ((SAV-CLOSING-TRAN-FLAG EQUAL '1'                        1003634
551985     OR  DDA-CLOSING-TRAN-FLAG EQUAL '1')                         1003634
551990     AND SAV-BKUP-WTHLD-FLAG GREATER THAN '0')                    1003634
552000         MOVE TAX-CALC-AMOUNT TO HOLD-AMT                         IM007
552010         MOVE '8' TO EX01-TYPE                                    IM007
552015         MOVE '1' TO EX01-TAX-TYPE                                2012254
552020         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               IM007
552040         ADD +1 TO WMS-INT-DR-NUMBER                              1004554
552045         MOVE TAX-CALC-AMOUNT TO SAVE-SAV-TAX                     IM007
552060         ADD TAX-CALC-AMOUNT TO WMS-INT-DR-AMT                    1004554
552070                                WMS-YTD-SAV-TAX                   IM007
552080                                WMS-INT-TAX                       IM007
552090                                WMS-INT-MTD-TAX                   IM007
552100         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
552110             ADD TAX-CALC-AMOUNT TO INV-TAX-COLL-TDY              1004554
552120                                    WS-GL-INV-TAX-COLL-TDY        1004554
552130         ELSE                                                     1004554
552140             ADD +1              TO SAV-TAX-NO                    1004554
552150                                    WS-GL-SAV-TAX-NO              1004554
552160             ADD TAX-CALC-AMOUNT TO SAV-TAX-AMT                   1004554
552170                                    WS-GL-SAV-TAX-AMT             1004554
552180     ELSE                                                         2012254
552185         ADD TAX-CALC-AMOUNT TO WMS-SAV-PEND-TAX.                 2012254
552190     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN '2'                     2012254
552195     OR  WMS-CMA-INDICATOR EQUAL '1'                              2012254
552200     OR  ((SAV-CLOSING-TRAN-FLAG EQUAL '1'                        2012254
552205     OR  DDA-CLOSING-TRAN-FLAG EQUAL '1')                         2012254
552210     AND SAV-BKUP-WTHLD-FLAG GREATER THAN '0')                    2012254
552215         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
552220             ADD TAX-CALC-AMOUNT TO WMS-DUAL-YR-CUR-SAV-FED.      2012254
552222 R3851-STATE.                                                     2012254
552224     IF  TAX-CALC-AMOUNT-ST NOT GREATER ZERO                      2012254
552226         GO TO R3851-LOCAL.                                       2012254
552228     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2'                   2012254
552230         MOVE TAX-CALC-AMOUNT-ST TO HOLD-AMT                      2012254
552232         MOVE '8' TO EX01-TYPE                                    2012254
552234         MOVE '2' TO EX01-TAX-TYPE                                2012254
552236         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
552238         ADD +1 TO WMS-INT-DR-NUMBER                              2012254
552240         MOVE TAX-CALC-AMOUNT-ST TO SAVE-SAV-TAX-ST               2012254
552242         ADD  TAX-CALC-AMOUNT-ST TO WMS-INT-DR-AMT                2012254
552244                                    WMS-YTD-SAV-STATE-TAX         2012254
552246                                    WMS-INT-TAX-STATE             2012254
552248                                    WMS-INT-MTD-STATE-TAX         2012254
552250         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
552252             ADD TAX-CALC-AMOUNT-ST TO INV-TAX-COLL-TDY-ST        2012254
552254                                    WS-GL-INV-TAX-COLL-TDY-ST     2012254
552256         ELSE                                                     2012254
552258             ADD +1              TO SAV-TAX-NO-ST                 2012254
552260                                    WS-GL-SAV-TAX-ST-NO           2012254
552262             ADD TAX-CALC-AMOUNT-ST TO SAV-TAX-AMT-ST             2012254
552264                                    WS-GL-SAV-TAX-ST-AMT.         2012254
552266     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
552268     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                 2012254
552270         ADD TAX-CALC-AMOUNT-ST TO WMS-DUAL-YR-CUR-SAV-STATE.     2012254
552272 R3851-LOCAL.                                                     2012254
552274     IF  TAX-CALC-AMOUNT-LOC NOT GREATER ZERO                     2012254
552276         GO TO R3851-EXIT.                                        2012254
552278     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3'                   2012254
552280         MOVE TAX-CALC-AMOUNT-LOC TO HOLD-AMT                     2012254
552282         MOVE '8' TO EX01-TYPE                                    2012254
552284         MOVE '3' TO EX01-TAX-TYPE                                2012254
552286         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
552288         ADD +1 TO WMS-INT-DR-NUMBER                              2012254
552290         MOVE TAX-CALC-AMOUNT-LOC TO SAVE-SAV-TAX-LOC             2012254
552292         ADD  TAX-CALC-AMOUNT-LOC TO WMS-INT-DR-AMT               2012254
552294                                     WMS-YTD-SAV-LOCAL-TAX        2012254
552296                                     WMS-INT-TAX-LOCAL            2012254
552298                                     WMS-INT-MTD-LOCAL-TAX        2012254
552300         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        2012254
552302             ADD TAX-CALC-AMOUNT-LOC TO INV-TAX-COLL-TDY-LOC      2012254
552304                                    WS-GL-INV-TAX-COLL-TDY-LOC    2012254
552306         ELSE                                                     2012254
552308             ADD +1              TO SAV-TAX-NO-LOC                2012254
552310                                    WS-GL-SAV-TAX-LOC-NO          2012254
552312             ADD TAX-CALC-AMOUNT-LOC TO SAV-TAX-AMT-LOC           2012254
552314                                    WS-GL-SAV-TAX-LOC-AMT.        2012254
552316     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             2012254
552318     AND (WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                 2012254
552320         ADD TAX-CALC-AMOUNT-LOC TO WMS-DUAL-YR-CUR-SAV-LOCAL.    2012254
552350 R3851-EXIT.                                                      IM007
552450     EXIT.                                                        IM007
552550 R3852.
552555     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
552565         MOVE '4' TO WK-INVEST-FUNCTION                           1004554
552570         PERFORM CALL-INVEST-PHASE THRU CALL-INVEST-EXIT.         1004554
552600     MOVE WBC-GENERATED-TRANS (13) TO GEN-TRAN-OPTION-HOLD.       0266741
552650     MOVE TODAYS-INTRST-PYMT TO HOLD-AMT.
552660     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
552670         ADD HOLD-AMT TO INV-CR-AMT                               1004554
552680                         WS-GL-INV-CR-AMT                         1004554
552690         ADD +1       TO INV-CR-NO                                1004554
552700                         WS-GL-INV-CR-NO                          1004554
552710     ELSE                                                         1004554
552720         ADD HOLD-AMT TO SAV-CR-AMT                               1004554
552730                         WS-GL-SAV-CR-AMT                         1004554
552740         ADD +1       TO SAV-CR-NO                                1004554
552750                         WS-GL-SAV-CR-NO.                         1004554
552800     MOVE 'G0' TO IMEX-CODE-2.
552850     MOVE '13' TO EX01-INT-CODE.
552900     MOVE '7' TO EX01-TYPE.
552950     MOVE ZERO TO EX01-NUMBER.
553000     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
553010 R3853.                                                           1004554
553050     ADD +1 TO FS-CR.
553100     PERFORM K7500 THRU K8500.
553102     IF  WMS-SAV-DIST-CD EQUAL '0'                                IM006
553103         GO TO R3855.                                             0266630
553104     SUBTRACT SAVE-SAV-TAX SAVE-SAV-TAX-ST SAVE-SAV-TAX-LOC       0266630
553105                                           FROM HOLD-AMT.         0266630
553106     MOVE HOLD-AMT TO SAVE-AMT.                                   IM007
553107     IF  WMS-SAV-DIST-CD EQUAL '1'                                IM007
553108         IF (WBC-INT-DIST-CD EQUAL '1' OR '3')                    0266741
553109         AND WBC-INT-DIST-AMT NOT LESS THAN HOLD-AMT              0266741
553110             GO TO R3855                                          IM006
553111         ELSE                                                     IM006
553112             PERFORM R3868-SAV THRU R3868-EXIT                    IM007
553113             MOVE SAVE-AMT TO HOLD-AMT                            IM007
553114             MOVE '8' TO EX01-TYPE                                IM007
553115             PERFORM R3866 THRU R3866-EXIT                        IM007
553116             ADD +1 TO SAV-CHECKS-NO, WMS-INT-DR-NUMBER,          0902970
553117                                      WS-GL-SAV-CHECKS-NO         0902970
553118             ADD HOLD-AMT TO SAV-CHECKS-AMT, WMS-INT-DR-AMT,      0902970
553119                                             WS-GL-SAV-CHECKS-AMT 0902970
553120             GO TO R3855.                                         0902970
553121     IF  WBC-INT-DIST-CD EQUAL '2' OR '3'                         0266741
553122         IF  WBC-INT-DIST-AMT NOT LESS THAN HOLD-AMT              0266741
553123             GO TO R3855.                                         0902970
553124     IF  WMS-SAV-XFER-INT-PTR GREATER THAN +0                     0902970
553125         PERFORM R3868-SAV THRU R3868-EXIT                        0902970
553126         MOVE SAVE-AMT TO HOLD-AMT                                0902970
553127         MOVE WMS-SAV-XFER-INT-PTR TO X                           0902970
553128         MOVE '08' TO IMEX-REC-NO                                 0902970
553129         MOVE 'IS' TO IMEX-CODE-1                                 0902970
553130         MOVE WMS-LINK-SYS-ID (X) TO IMEX-CODE-2                  0902970
553131         MOVE WMS-LINKAGE-CNTL (X) TO EX08-CNTL                   0902970
553132         MOVE HOLD-AMT TO EX08-END-BAL                            0902970
553133         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 1103704
553196 R3855.                                                           IM007
553200     IF WMS-DDA-BAL NOT LESS THAN WMS-MIN-BAL
553250         GO TO R3860.
553300     IF WMS-INT-STATUS GREATER THAN '1'
553350         GO TO R3860.
553400     SUBTRACT WMS-DDA-BAL FROM WMS-MIN-BAL GIVING WK-HOLD-AMT13.  9915845
553450     IF WK-HOLD-AMT13 GREATER THAN WMS-INT-CUR-BAL                9915845
553500         MOVE WMS-INT-CUR-BAL TO WK-HOLD-AMT13.                   9915845
553550     SUBTRACT WK-HOLD-AMT13 FROM WMS-INT-CUR-BAL.                 9915845
553600     ADD WK-HOLD-AMT13 TO WMS-DDA-BAL                             9915845
553650                          TRANSFER-AMT.                           0902477
553800 R3860.
553860     IF  BHW-SAV-FLAG  EQUAL 'R'                                  0316967
553870     AND WBHS-ENTRIES  GREATER THAN ZERO                          0902213
553880         SUBTRACT WMS-ACCR-INT FROM WBHS-SAV-ACCR-ADJ (1).        0902213
553882     IF  BHW-SAV-FLAG  EQUAL 'T'                                  0316967
553884     AND WBHT-ENTRIES  GREATER THAN ZERO                          0316967
553886         SUBTRACT WMS-ACCR-INT FROM WBHT-SAVT-ACCR-ADJ (1).       0316967
553900     MOVE ZERO TO WMS-ACCR-INT.                                   IM002
554050     IF  IOD-CLOSE-FLAG EQUAL 'F'
554100         MOVE '1' TO SAV-ACCRUE
554150         GO TO R3864.
554200 R3861.
554250     PERFORM R4005 THRU R4007.
554300     MOVE CUR-BAL TO PROJ-ACCR-SV-BAL.
554350     MOVE '1' TO INTEREST-ADJUST-CODE.
554358*--------------------------------------------------------------*  0902213
554366*    IF THE BALANCE HAS CHANGED SINCE ACCRUALS, RECALCULATE    *  0902213
554374*    THE DAILY ACCRUAL AMOUNT.                                 *  0902213
554382*--------------------------------------------------------------*  0902213
554390     MOVE 'P' TO INTEREST-ADJ-SUBCODE.                            0902213
554400     PERFORM CALL-ACCRUAL-PHASE THRU CALL-ACCRUAL-END.
554420     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            0902213
554450     MOVE ACCRUAL-AMOUNT TO WMS-ACCRUAL-AMT.
554500     GO TO R3864.
554550 R3862.
554600     IF TODAYS-INTRST-PYMT EQUAL TO ZERO
554650         GO TO R3863.
554700     ADD +1 TO IOD-INT-PAID-NO, WS-GL-IOD-INT-PAID-NO.            0902970
554750     ADD TODAYS-INTRST-PYMT TO WMS-DDA-BAL
554800                               WMS-CURR-BAL
554850                               IOD-INT-PAID-TODAY
554851                               WS-GL-IOD-INT-PAID-TODAY           0902970
554900                               IOD-INT-PAID-AMT
554901                               WS-GL-IOD-INT-PAID-AMT             0902970
554950                               WMS-IOD-MTD-PAID-INT
555000                               WMS-IOD-CYC-PAID-INT
555050                               WMS-IOD-YTD-INT-PAID.
555051     IF  WMS-PLAN-TRLR EQUAL '1'                                  0617360
555052         ADD TODAYS-INTRST-PYMT TO WMS-PLN-TRLR-PR-LTD-INT-PD.    0617360
555053     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             0617360
555054         ADD TODAYS-INTRST-PYMT TO WMS-DUAL-YR-CUR-IOD-INT.       9915858
555056     MOVE ACCR-MO TO WORK-INT-MM.                                 0547344
555057     MOVE ACCR-DA TO WORK-INT-DD.                                 0547344
555058     MOVE ACCR-YR TO WORK-INT-YY.                                 0547344
555059     MOVE WRK-INT-LAST-PAID-DATE                                  0547344
555060          TO WMS-IOD-INT-DATE-LAST-PMT.                           0547344
555062     PERFORM CHECK-W8-STATUS THRU CHECK-W8-EXIT.                  9915828
555064     IF  CERT-NAME-W8-STATUS EQUAL '1'                            9915828
555066         ADD TODAYS-INTRST-PYMT TO WMS-IOD-YTD-INT-PAID-1042.     9915828
555100     IF  SAV-BKUP-WTHLD-FLAG GREATER ZERO                         2012254
555120     OR  WMS-STATE-LOCAL-TX-CD GREATER ZERO                       2012254
555150         PERFORM R3890-IOD-TAX-WITHHOLD THRU R3890-EXIT.
555200     MOVE WBC-GENERATED-TRANS (20) TO GEN-TRAN-OPTION-HOLD.       0266741
555250     MOVE TODAYS-INTRST-PYMT TO HOLD-AMT.
555300     ADD +1 TO FS-CR.
555350     MOVE 'G6' TO IMEX-CODE-2.
555400     MOVE '20' TO EX01-INT-CODE.
555450     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
555500     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
555550         ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                     0902970
555600         ADD HOLD-AMT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT             0902970
555650     ELSE ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                    0902970
555700         ADD HOLD-AMT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.            0902970
555750     MOVE '2' TO EX01-TYPE.
555800     MOVE ZERO TO EX01-NUMBER.
555850     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
555860*----------------------------------------------------------------*1105504
555862*    TO INCREMENT THE STMT-NO-CREDITS AND STMT-CR-AMT, REMOVE    *1105504
555864*    THE COMMENTS FROM THE FOLLOWING TWO LINES.                  *1105504
555866*    ADD +1 TO WMS-STMT-NO-CREDITS.                               1105504
555868*    ADD HOLD-AMT TO WMS-STMT-CR-AMT.                             1105504
555900     PERFORM K7500 THRU K8500.
555902     IF  WMS-IOD-DIST-CD EQUAL '0'                                IM006
555903         GO TO R3863.                                             0266630
555904     SUBTRACT SAVE-IOD-TAX SAVE-IOD-TAX-ST SAVE-IOD-TAX-LOC       0266630
555905                                           FROM HOLD-AMT.         0266630
555906     MOVE HOLD-AMT TO SAVE-AMT.                                   IM007
555907     IF  WMS-IOD-DIST-CD EQUAL '1'                                IM007
555908         IF (WBC-INT-DIST-CD EQUAL '1' OR '3')                    0266741
555909         AND WBC-INT-DIST-AMT NOT LESS THAN HOLD-AMT              0266741
555910             GO TO R3863                                          IM006
555911         ELSE                                                     IM006
555912             PERFORM R3867-IOD THRU R3867-EXIT                    IM007
555913             MOVE SAVE-AMT TO HOLD-AMT                            IM007
555914             MOVE '4' TO EX01-TYPE                                IM007
555915             PERFORM R3866 THRU R3866-EXIT                        IM007
555916             ADD +1 TO IOD-CHECKS-NO, WMS-STMT-NO-DEBITS,         0902970
555917                                      WS-GL-IOD-CHECKS-NO         0902970
555918             ADD SAVE-AMT TO IOD-CHECKS-AMT, WMS-STMT-DR-AMT,     0902970
555919                                        WS-GL-IOD-CHECKS-AMT      0902970
555920             GO TO R3863.                                         0902970
555921     IF  WBC-INT-DIST-CD EQUAL '2' OR '3'                         0266741
555922         IF  WBC-INT-DIST-AMT NOT LESS THAN HOLD-AMT              0266741
555923             GO TO R3863.                                         0902970
555924     IF  WMS-IOD-XFER-INT-PTR GREATER THAN +0                     0902970
555925         PERFORM R3867-IOD THRU R3867-EXIT                        0902970
555926         MOVE SAVE-AMT TO HOLD-AMT                                0902970
555927         MOVE WMS-IOD-XFER-INT-PTR TO X                           0902970
555928         MOVE '08' TO IMEX-REC-NO                                 0902970
555929         MOVE 'II' TO IMEX-CODE-1                                 0902970
555930         MOVE WMS-LINK-SYS-ID (X) TO IMEX-CODE-2                  0902970
555931         MOVE WMS-LINKAGE-CNTL (X) TO EX08-CNTL                   0902970
555932         MOVE HOLD-AMT TO EX08-END-BAL                            0902970
555933         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 1103704
555996 R3863.                                                           IM007
556001     IF  BHW-IOD-FLAG  EQUAL 'I'                                  0902213
556006     AND WBHI-ENTRIES  GREATER THAN ZERO                          0902213
556011         SUBTRACT WMS-IOD-CYC-ACC-INT FROM WBHI-IOD-ACCR-ADJ (1)  0902213
556016     ELSE                                                         0902213
556021     IF  BHW-IOD-FLAG  EQUAL 'M'                                  0902213
556026     AND WBHM-ENTRIES  GREATER THAN ZERO                          0902213
556031         SUBTRACT WMS-IOD-CYC-ACC-INT FROM WBHM-MMDA-ACCR-ADJ (1).0902213
556036     MOVE ZERO TO WMS-IOD-CYC-ACC-INT.                            0902213
556050     IF  IOD-CLOSE-FLAG EQUAL 'F'
556100         MOVE '1' TO IOD-ACCRUE
556150         GO TO R3864.
556200 R3863-A.
556250     MOVE WMS-DDA-BAL TO CUR-BAL.
556300     MOVE WMS-IOD-CALC TO CALC-FLAG.
556350     PERFORM K0104 THRU K0105.
556400     MOVE CUR-BAL TO ACCRUAL-BALANCE, PROJ-ACCR-IOD-BAL.
556450     MOVE +1 TO ACCRUAL-DAYS.
556500     MOVE '1' TO INTEREST-ADJUST-CODE.
556508*--------------------------------------------------------------*  0902213
556516*    IF THE BALANCE HAS CHANGED SINCE ACCRUALS, RECALCULATE    *  0902213
556524*    THE DAILY ACCRUAL AMOUNT.                                 *  0902213
556532*--------------------------------------------------------------*  0902213
556540     MOVE 'P' TO INTEREST-ADJ-SUBCODE.                            0902213
556550     IF  ACCRUAL-BALANCE GREATER THAN ZERO
556570     OR (BHW-IOD-FLAG  EQUAL 'I' OR 'M')                          0902213
556600         PERFORM CALL-ACCRUAL-PHASE THRU CALL-ACCRUAL-END
556650         MOVE ACCRUAL-AMOUNT TO WMS-IOD-DAILY-ACC.
556670     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            0902213
556700     MOVE 'F' TO IOD-FLAG.
556710     GO TO R3864.                                                 9915749
556711*----------------------------------------------------------------*9915749
556712*    CREATE ACM-AFM MAINTENANCE TRANS FOR COMMERCIAL SWEEP PROC. *9915749
556713*----------------------------------------------------------------*9915749
556720     COPY IMPD31AC.                                               9915749
556730                                                                  9915749
556750 R3864.
556800     EXIT.
556850     SKIP3
556900 R3865.
556950     GO TO R3899-EXIT.
557000     SKIP3
557002 R3866.                                                           IM006
557004     MOVE WBC-GENERATED-TRANS (25) TO GEN-TRAN-OPTION-HOLD.       0266741
557006     MOVE '25' TO EX01-INT-CODE.                                  IM006
557008     MOVE +1 TO EX01-NUMBER.                                      IM006
557010     IF  EX01-TYPE EQUAL '8'                                      IM006
557011         SUBTRACT HOLD-AMT FROM WMS-INT-CUR-BAL                   1004554
557012                                WMS-CURR-BAL                      1004554
557013         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
557014             ADD HOLD-AMT TO INV-DR-AMT                           1004554
557015                             WS-GL-INV-DR-AMT                     1004554
557016             ADD +1       TO INV-DR-NO                            1004554
557017                             WS-GL-INV-DR-NO                      1004554
557018         ELSE                                                     1004554
557019             ADD HOLD-AMT TO SAV-DR-AMT                           1004554
557020                             WS-GL-SAV-DR-AMT                     1004554
557021             ADD +1       TO SAV-DR-NO                            1004554
557022                             WS-GL-SAV-DR-NO                      1004554
557023     ELSE                                                         1004554
557024         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             1004554
557025         ADD +1       TO IOD-DB-NO, WS-GL-IOD-DB-NO               1004554
557026         SUBTRACT HOLD-AMT FROM WMS-DDA-BAL, WMS-CURR-BAL.        1004554
557027     MOVE 'GE'        TO IMEX-CODE-2.                             1004554
557028     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 IM006
557030     ADD +1 TO FS-DB.                                             IM006
557032     PERFORM K7500 THRU K8500.                                    IM006
557034 R3866-EXIT. EXIT.                                                IM006
557036     SKIP3                                                        IM006
557040 R3867-IOD.                                                       2012254
557042     IF  SAV-BKUP-WTHLD-FLAG NOT EQUAL '2' AND '3'                2012254
557043         GO TO R3867-EXIT.                                        2012254
557045     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
557053     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         IM007
557054         IF  WMS-IOD-PEND-TAX GREATER THAN HOLD-AMT               IM007
557055             MOVE HOLD-AMT TO TAX-CALC-AMOUNT                     IM007
557056             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
557057             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX       IM007
557058         ELSE                                                     IM007
557059             MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT             IM007
557060             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
557061             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX       IM007
557062     ELSE                                                         IM007
557063         MOVE ZERO TO TAX-CALC-AMOUNT.                            IM007
557064*----------------------------------------------------------------*IM007
557065*    TOTAL TAX WITHHELD CANNOT EXCEED THE TRANSACTION AMOUNT     *IM007
557066*----------------------------------------------------------------*IM007
557067     COMPUTE AMT-AVAIL = TODAYS-INTRST-PYMT                       IM007
557068                       - SAVE-IOD-TAX                             IM007
557069                       - TAX-CALC-AMOUNT.                         IM007
557070     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
557071         GO TO R3867-EXIT.                                        IM007
557072     IF  AMT-AVAIL GREATER THAN +0                                IM007
557073     AND WMS-SAV-PEND-TAX GREATER THAN +0                         IM007
557074         IF  WMS-SAV-PEND-TAX GREATER THAN AMT-AVAIL              IM007
557075             MOVE AMT-AVAIL TO TAX-CALC-AMOUNT                    IM007
557076             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
557077             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
557078         ELSE                                                     IM007
557079             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
557080             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
557081             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX.      IM007
557082 R3867-EXIT.                                                      IM007
557083     EXIT.                                                        IM007
557084 R3868-SAV.                                                       2012254
557085     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
557086     IF  SAV-BKUP-WTHLD-FLAG NOT EQUAL '2' AND '3'                IM007
557087         GO TO R3868-EXIT.                                        IM007
557088     IF  WMS-SAV-PEND-TAX GREATER THAN +0                         IM007
557089         IF  WMS-SAV-PEND-TAX GREATER THAN HOLD-AMT               IM007
557090             MOVE HOLD-AMT TO TAX-CALC-AMOUNT                     IM007
557091             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
557092             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
557093         ELSE                                                     IM007
557094             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
557095             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
557096             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
557097     ELSE                                                         IM007
557098         MOVE ZERO TO TAX-CALC-AMOUNT.                            IM007
557099*----------------------------------------------------------------*IM007
557100*    TOTAL TAX WITHHELD CANNOT EXCEED THE TRANSACTION AMOUNT     *IM007
557101*----------------------------------------------------------------*IM007
557102     COMPUTE AMT-AVAIL = TODAYS-INTRST-PYMT                       IM007
557103                       - SAVE-SAV-TAX                             IM007
557104                       - TAX-CALC-AMOUNT.                         IM007
557105     IF  (AMT-AVAIL GREATER THAN +0                               IM007
557106     AND WMS-IOD-PEND-TAX GREATER THAN +0)                        IM007
557107         IF  WMS-IOD-PEND-TAX GREATER THAN AMT-AVAIL              IM007
557108             MOVE AMT-AVAIL TO TAX-CALC-AMOUNT                    IM007
557109             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
557110             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX       IM007
557111         ELSE                                                     IM007
557112             MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT             IM007
557113             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
557114             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX.      IM007
557115 R3868-EXIT.                                                      IM007
557116     EXIT.                                                        IM007
557117     SKIP3                                                        IM007
557118 R3870-CALL-WITHHOLD.                                             IM007
557119     IF  (WMS-BKUP-WTHLD-FLAG GREATER ZERO                        2012254
557120     AND  WMS-TAX-FED-PTR EQUAL ZERO)                             2012254
557121     OR  ((WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2')                2012254
557122     AND   WMS-TAX-STATE-PTR EQUAL ZERO)                          2012254
557123     OR  ((WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3')                2012254
557124     AND   WMS-TAX-LOCAL-PTR EQUAL ZERO)                          2012254
557125         MOVE ZERO TO   TAX-CALC-AMOUNT     TAX-CALC-AMOUNT-ST    2012254
557126                        TAX-CALC-AMOUNT-LOC                       2012254
557127         GO TO R3870-EXIT.                                        2012254
557129     IF  WBC-TAX-CALC-PHASE EQUAL SPACES                          0266741
557130         CALL 'IM31TAX' USING TAX-CALC-WORK-FIELDS                2012254
557140                              MASTER-AREA                         2012254
557170     ELSE                                                         9915858
557180         MOVE WBC-TAX-CALC-PHASE TO IM31-PH2                      0266741
557190         CALL 'SILINK' USING IM31-PHASE                           9915858
557200                             TAX-CALC-WORK-FIELDS                 9915858
557210                             MASTER-AREA.                         9915858
557300 R3870-EXIT. EXIT.
557350     SKIP3
557400 R3880-GEN-WITHHOLD.
557450     MOVE WBC-GENERATED-TRANS (21) TO GEN-TRAN-OPTION-HOLD.       0266741
557500     MOVE '21' TO EX01-INT-CODE.
557550     MOVE +1 TO EX01-NUMBER.
557600     IF  EX01-TYPE EQUAL '8'
557610         SUBTRACT HOLD-AMT FROM WMS-INT-CUR-BAL                   1004554
557620                                WMS-CURR-BAL                      1004554
557630         PERFORM R3885-SAV-BAL-CHK THRU R3885-EXIT                1004554
557640         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
557650             ADD HOLD-AMT TO INV-DR-AMT                           1004554
557660                             WS-GL-INV-DR-AMT                     1004554
557700             ADD +1       TO INV-DR-NO                            1004554
557710                             WS-GL-INV-DR-NO                      1004554
557720         ELSE                                                     1004554
557730             ADD HOLD-AMT TO SAV-DR-AMT                           1004554
557740                             WS-GL-SAV-DR-AMT                     1004554
557750             ADD +1       TO SAV-DR-NO                            1004554
557760                             WS-GL-SAV-DR-NO                      1004554
557800     ELSE
557850         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
557900         ADD +1       TO IOD-DB-NO, WS-GL-IOD-DB-NO               0902970
557950         SUBTRACT HOLD-AMT FROM WMS-DDA-BAL, WMS-CURR-BAL.
558000     MOVE 'G7'        TO IMEX-CODE-2.
558050     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
558100     ADD +1 TO FS-DB.
558150     PERFORM K7500 THRU K8500.
558200 R3880-EXIT. EXIT.
558250     SKIP3
558254*---------------------------------------------------------------* IM007
558258*    RECONCILIATION OF POSSIBLE NEGATIVE SAVINGS BALANCE DUE TO * IM007
558262*    TAX WITHHOLDING.                                           * IM007
558266*---------------------------------------------------------------* IM007
558270 R3885-SAV-BAL-CHK.                                               IM007
558274     IF  WMS-INT-CUR-BAL LESS THAN +0.00                          IM007
558278         ADD WMS-INT-CUR-BAL TO TRANSFER-AMT                      IM007
558282         ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL                       IM007
558286         MOVE +0.00          TO WMS-INT-CUR-BAL.                  IM007
558290 R3885-EXIT.                                                      IM007
558292     EXIT.                                                        IM007
558294     SKIP3                                                        IM007
558300 R3890-IOD-TAX-WITHHOLD.
558350     MOVE TODAYS-INTRST-PYMT TO TAX-CALC-PAYMENT.
558400     MOVE IOD-FLAG           TO TAX-CALC-IOD-FLAG.
558450     MOVE +0                 TO TAX-CALC-AMOUNT                   2012254
558455                                TAX-CALC-AMOUNT-ST                2012254
558460                                TAX-CALC-AMOUNT-LOC.              2012254
558500     MOVE '0'                TO TAX-CALC-REASON.
558550     PERFORM R3899-CALC-TAX-DAYS THRU R3899-EXIT.
558600     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.
558620 R3890-IOD-TAX-GT.                                                IM007
558621     IF  (TAX-CALC-AMOUNT NOT GREATER THAN ZERO)                  2012254
558622         GO  TO  R3890-IOD-TAX-ST-GT.                             2012254
558623     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN '2'                     2012254
558624     OR  (DDA-CLOSING-TRAN-FLAG EQUAL '1'                         2012254
558625     AND SAV-BKUP-WTHLD-FLAG GREATER THAN '0')                    2012254
558626         MOVE TAX-CALC-AMOUNT TO HOLD-AMT                         2012254
558627         MOVE '4' TO EX01-TYPE                                    2012254
558628         MOVE '1' TO EX01-TAX-TYPE                                2012254
558629         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
558630         ADD +1 TO IOD-TAX-NO, WS-GL-IOD-TAX-NO                   2012254
558631                   WMS-STMT-NO-DEBITS                             2012254
558632         MOVE TAX-CALC-AMOUNT TO SAVE-IOD-TAX                     2012254
558633         ADD TAX-CALC-AMOUNT TO IOD-TAX-AMT, WS-GL-IOD-TAX-AMT    2012254
558634                                WMS-STMT-DR-AMT                   2012254
558635                                WMS-IOD-YTD-TAX                   2012254
558636                                WMS-IOD-CYC-TAX                   2012254
558637                                WMS-IOD-MTD-TAX                   2012254
558638     ELSE                                                         2012254
558639         ADD TAX-CALC-AMOUNT TO WMS-IOD-PEND-TAX.                 2012254
558640     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN '2'                     2012254
558641     OR  (DDA-CLOSING-TRAN-FLAG EQUAL '1'                         2012254
558642     AND SAV-BKUP-WTHLD-FLAG GREATER THAN '0')                    2012254
558643         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
558644             ADD TAX-CALC-AMOUNT TO WMS-DUAL-YR-CUR-IOD-FED.      2012254
558645 R3890-IOD-TAX-ST-GT.                                             2012254
558646     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '2'                   2012254
558647     AND TAX-CALC-AMOUNT-ST GREATER THAN ZERO                     2012254
558648         MOVE TAX-CALC-AMOUNT-ST TO HOLD-AMT                      2012254
558649         MOVE '4' TO EX01-TYPE                                    2012254
558650         MOVE '2' TO EX01-TAX-TYPE                                2012254
558651         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
558652         ADD +1 TO IOD-TAX-NO-ST, WS-GL-IOD-TAX-ST-NO             2012254
558653                   WMS-STMT-NO-DEBITS                             2012254
558654         MOVE TAX-CALC-AMOUNT-ST TO SAVE-IOD-TAX-ST               2012254
558655         ADD TAX-CALC-AMOUNT-ST TO IOD-TAX-AMT-ST                 2012254
558656                     WS-GL-IOD-TAX-ST-AMT    WMS-STMT-DR-AMT      2012254
558657                     WMS-IOD-YTD-STATE-TAX   WMS-IOD-CYC-STATE-TAX2012254
558658                     WMS-IOD-MTD-STATE-TAX                        2012254
558659         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
558660             ADD TAX-CALC-AMOUNT-ST TO WMS-DUAL-YR-CUR-IOD-STATE. 2012254
558661 R3890-IOD-TAX-LOC-GT.                                            2012254
558662     IF  WMS-STATE-LOCAL-TX-CD EQUAL '1' OR '3'                   2012254
558663     AND TAX-CALC-AMOUNT-LOC GREATER THAN ZERO                    2012254
558666         MOVE TAX-CALC-AMOUNT-LOC TO HOLD-AMT                     2012254
558667         MOVE '4' TO EX01-TYPE                                    2012254
558668         MOVE '3' TO EX01-TAX-TYPE                                2012254
558669         PERFORM R3880-GEN-WITHHOLD THRU R3880-EXIT               2012254
558670         ADD +1 TO IOD-TAX-NO-LOC, WS-GL-IOD-TAX-LOC-NO           2012254
558671                   WMS-STMT-NO-DEBITS                             2012254
558672         MOVE TAX-CALC-AMOUNT-LOC TO SAVE-IOD-TAX-LOC             2012254
558673         ADD TAX-CALC-AMOUNT-LOC TO IOD-TAX-AMT-LOC               2012254
558674                  WS-GL-IOD-TAX-LOC-AMT    WMS-STMT-DR-AMT        2012254
558675                  WMS-IOD-YTD-LOCAL-TAX    WMS-IOD-CYC-LOCAL-TAX  2012254
558676                  WMS-IOD-MTD-LOCAL-TAX                           2012254
558678         IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                         2012254
558679             ADD TAX-CALC-AMOUNT-LOC TO WMS-DUAL-YR-CUR-IOD-LOCAL.2012254
559100 R3890-EXIT. EXIT.
559150     SKIP3
559200 R3899-CALC-TAX-DAYS.
559202     IF  WMS-SAV-INT-PAY-CYCLE EQUAL 'B' OR 'C' OR 'W'            9915845
559204                                 OR    'E' OR 'L'                 9915845
559206         IF  WMS-SAV-INT-DATE-LAST-PMT EQUAL SPACES OR ZEROES     9915845
559208             MOVE WMS-DATE-OPENED TO DT-LOW-DATE                  9915845
559210             PERFORM R3899-B                                      9915845
559212             ADD +1 TO TAX-CALC-DAYS                              9915845
559214             GO  TO  R3899-EXIT                                   9915845
559216         ELSE                                                     9915845
559218             MOVE WMS-SAV-INT-DATE-LAST-PMT TO DT-LOW-DATE        9915845
559220             PERFORM R3899-B                                      9915845
559222             GO  TO  R3899-EXIT.                                  9915845
559224                                                                  9915845
559250     IF  IOD-FLAG EQUAL 'N' AND
559300         (WMS-IOD-INT-PAY-CYCLE EQUAL '2' OR '4')                 9915845
559350     OR  IOD-FLAG EQUAL 'F' AND
559400         (WMS-SAV-INT-PAY-CYCLE EQUAL '2' OR '3')                 9915845
559450         GO  TO  R3899-A.
559500     IF  SAVE-SC-DATE EQUAL SPACES OR ZEROES
559550         MOVE WMS-DATE-OPENED TO DT-LOW-DATE
559600         PERFORM R3899-B
559650         ADD +1 TO TAX-CALC-DAYS
559700     ELSE
559750         MOVE SAVE-SC-DATE TO DT-LOW-DATE
559800         PERFORM R3899-B.
559850     GO  TO  R3899-EXIT.
559900 R3899-A.
559950     IF  WMS-DATE-LAST-STMT EQUAL SPACES OR ZEROES
560000         MOVE WMS-DATE-OPENED TO DT-LOW-DATE
560050         PERFORM R3899-B
560100         ADD +1 TO TAX-CALC-DAYS
560150         GO  TO  R3899-EXIT
560200     ELSE
560250         MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE.
560300 R3899-B.
560350     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
560400     CALL 'SIDIF1' USING DATE-AREA.
560450     MOVE RET-DAYS TO TAX-CALC-DAYS.
560500 R3899-EXIT. EXIT.
560550     SKIP3
560600*    **************** OD INTEREST ACCRUAL *****************
560650 SKIP1
560700 R3900.
560750     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'
560800         GO TO R3920-EXIT.                                        0902213
560810*----------------------------------------------------------------*1105504
560811*    BYPASS OD ACCRUAL IF THIS IS A STATIC RUN.                  *1105504
560812*----------------------------------------------------------------*1105504
560813     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
560814     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
560815         GO TO R4008-EXIT.                                        1105504
560850     MOVE '1' TO INTEREST-ADJUST-CODE.
560900     MOVE WMS-DDA-BAL TO OD-BAL.
560950     MOVE WMS-OD-CALC-FLAG TO CALC-FLAG.
561000 R3910.
561050     IF CALC-FLAG EQUAL TO '1', GO TO R3910-EXIT.
561100     IF CALC-FLAG EQUAL TO '2'
561150         SUBTRACT WMS-HOLD-AMT FROM OD-BAL
561200         GO TO R3910-EXIT.
561250     IF CALC-FLAG EQUAL TO '3'
561300         SUBTRACT WMS-BANK-AVAIL-AMT FROM OD-BAL                  IM007
561350         GO TO R3910-EXIT.
561400     IF CALC-FLAG EQUAL TO '4'
561450         SUBTRACT WMS-CUST-AVAIL-AMT FROM OD-BAL                  IM007
561500         GO TO R3910-EXIT.
561550     IF CALC-FLAG EQUAL TO '5'
561600         SUBTRACT WMS-HOLD-AMT FROM OD-BAL
561650         SUBTRACT WMS-BANK-AVAIL-AMT FROM OD-BAL                  IM007
561700         GO TO R3910-EXIT.
561750     IF CALC-FLAG EQUAL TO '6'
561800         SUBTRACT WMS-HOLD-AMT FROM OD-BAL
561850         SUBTRACT WMS-CUST-AVAIL-AMT FROM OD-BAL.                 IM007
561900 R3910-EXIT.
561950     EXIT.
562000 R3920.
562050     IF  OD-BAL NOT LESS THAN ZERO
562070     AND BHW-ODAC-FLAG EQUAL 'F'                                  0902213
562100         MOVE ZEROES TO WMS-OD-ACCRL-AMT, WMS-OD-ACCRL-BAL        IM004
562150         GO TO R3920-EXIT                                         0902213
562200     ELSE
562250         MOVE OD-BAL TO WMS-OD-ACCRL-BAL.
562300     MOVE '1' TO INTEREST-ADJUST-CODE.
562350     MOVE +1 TO ACCRUAL-DAYS.
562400     MOVE '2' TO OD-ACR-PAY-FLAG.
562420     MOVE 'N' TO INTEREST-ADJ-SUBCODE.                            0902213
562450     PERFORM X0900-RHR-OD-ACCRUAL THRU X0900-RHR-OD-EXIT.
562460     IF  OD-BAL NOT LESS THAN ZERO                                0902213
562470         MOVE ZEROES TO WMS-OD-ACCRL-AMT, WMS-OD-ACCRL-BAL.       0902213
562500     MOVE '0' TO OD-ACR-PAY-FLAG.
562520 R3920-EXIT. EXIT.                                                0902213
562550 SKIP3
562600*    *******************  AGGREGATE AREA  *******************
562650     SKIP1
562700 R4000.
562710*----------------------------------------------------------------*1105504
562711*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
562712*----------------------------------------------------------------*1105504
562713     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
562714     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
562715         GO TO R4008-EXIT.                                        1105504
562750     MOVE WMS-COLL-CALC TO CALC-FLAG.
562800     MOVE WMS-CURR-BAL TO CUR-BAL.
562850     PERFORM K0104 THRU K0105.
562900     MOVE CUR-BAL TO COLL-BAL.
562919     MOVE '1' TO WXI-EXCLUDE-BAL.                                 2016639
562920     PERFORM K0106 THRU K0106-EXIT.                               IM003
562921     MOVE '0' TO WXI-EXCLUDE-BAL.                                 2016639
562950     IF  WBC-AGGREGATE EQUAL 'P' AND                              0266741
563000         AGGREGATE-LOOP-SW EQUAL '1'
563050         GO  TO  R4011.
563100 R4001.
563150     IF  WMS-SC-CLEAR EQUAL '1'
563200         PERFORM C2250 THRU C2255-EXIT.                           IM007
563300     ADD COLL-BAL TO WMS-SC-AGGR-COLL.
563320     ADD CUST-BAL TO WMS-SC-AGGR-CUST-COLL.                       IM003
563350     ADD +1 TO WMS-SC-AGGR-DAYS.
563360*----------------------------------------------------------------*2014039
563361*    TS USER OPTION TO INVOKE CLIENT SPECIFIC CUSTOM CODE.       *2014039
563362*    REFERENCE GN BASE DOCUMENTATION FOR USER OPTIONS.           *2014039
563363*    UPDATE AGGREGATE POSITIVE & NEGATIVE COLLECTED BALANCE.     *2014039
563364*----------------------------------------------------------------*2014039
563370     IF  (UB-OPTION-FLAG(2) EQUAL 'Y')                            2014039
563372         MOVE 'NDIMU002'         TO IM31-USER-PHASE-AREA          2014039
563374         CALL  'SILINK' USING    IM31-USER-PHASE-AREA             2014039
563375                                 MASTER-AREA                      2014103
563376                                 DDA-WRKBCR-1                     0266741
563377                                 DDA-WRKBCR-4                     0266741
563378                                 COLL-BAL                         2014039
563380                                 USER-OPTION-DETAIL               2014039
563382         MOVE 'IM31'             TO IM31-USER-PHASE-AREA.         2014039
563390*                                                                 2014039
563400     ADD WMS-CURR-BAL TO WMS-SC-AGGR-BAL.
563405     IF  WMS-SAVINGS-TRLR EQUAL '1' AND                           9916070
563410         WMS-CMA-INDICATOR EQUAL '1'                              9916070
563415         NEXT SENTENCE                                            9916070
563417     ELSE                                                         9916070
563420     ADD WMS-DDA-BAL  TO WMS-SC-AGGR-DDA.                         9916070
563450     IF WMS-CURR-BAL LESS THAN ZERO
563500        AND WMS-SAV-PTR EQUAL TO ZERO
563520        AND WMS-CHG-CARD-FLG EQUAL TO ZERO                        IM004
563550         ADD WMS-CURR-BAL TO WMS-SC-AGGR-OD-BAL.
563600     IF WMS-EXTRNL-DEPOSIT-TRLR EQUAL '1'
563650        ADD WMS-SAVINGS-BAL TO WMS-AGGR-SAV-BAL.
563700     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
563750         IF  WMS-OD-ACCRL-BAL LESS THAN ZERO
563800             ADD +1               TO WMS-OD-ACR-AGGR-DAYS-CTD
563850             ADD +1               TO WMS-OD-ACR-AGGR-DAYS-MTD
563900             ADD WMS-OD-ACCRL-BAL TO WMS-OD-ACR-AGGR-CTD
563950             ADD WMS-OD-ACCRL-BAL TO WMS-OD-ACR-AGGR-MTD.
563960     ADD WMS-STOP-PAYS TO WMS-SC-AGG-STOPS.                       IM003
563970     ADD WMS-HOLD-NO   TO WMS-SC-AGG-HOLDS.                       IM003
563980     ADD WMS-CASH-AVAIL-AMT TO WMS-CASH-AVAIL-CTD-AGGR.           IM007
564000 R4002.  EXIT.
564050 R4003.
564100     IF WMS-SAVINGS-TRLR NOT EQUAL TO '1'
564150         GO TO R4009.
564200 R4005.
564250     IF  WMS-CMA-INDICATOR EQUAL '1' AND
564300         WMS-CMA-BALANCE-USE EQUAL '1'
564350         MOVE WMS-PREV-INT-BAL TO CUR-BAL
564400     ELSE
564450         MOVE WMS-INT-CUR-BAL TO CUR-BAL.                         9916306
564500     IF WBC-ACCRUAL-CALC EQUAL TO '0'                             0266741
564550         GO TO R4006.
564600     IF WBC-ACCRUAL-CALC EQUAL TO '1'                             0266741
564650         MOVE WMS-COLL-CALC TO CALC-FLAG
564700     ELSE
564750         MOVE WMS-NSF-CALC TO CALC-FLAG.
564800     IF  WMS-CMA-INDICATOR EQUAL '1' AND                          IM004
564807         WMS-CMA-BALANCE-USE EQUAL '1' AND                        IM004
564814         CALC-FLAG NOT EQUAL '1'                                  IM004
564821         PERFORM X4050-CALC-ACCR-PREV THRU X4060-EXIT             IM008
564828     ELSE                                                         IM004
564835         PERFORM K0104 THRU K0105.                                IM004
564850 R4006.
564900     MOVE CUR-BAL TO ACCRUAL-BALANCE.
564950     MOVE +1 TO ACCRUAL-DAYS.
565000 R4007.  EXIT.
565050 R4008.
565100     ADD CUR-BAL TO WMS-INT-AGGR-BAL.                             9916306
565120     ADD +1      TO WMS-INT-AGGR-DAYS                             9916070
565130                    WMS-INT-SC-AGGR-DAYS.                         9916070
565131     IF  PAST-ACCR EQUAL '0'                                      2016683
565133         ADD +1 TO CMA-AGGR-DAYS                                  2016683
565134     ELSE                                                         2016683
565135         ADD +1 TO CMA-PAST-AGGR-DAYS.                            2016683
565140     IF  WMS-CMA-INDICATOR NOT EQUAL '1'                          2016653
565142         ADD WMS-INT-CUR-BAL      TO WMS-INT-SC-AGGR-BAL          2016653
565144         ADD CUR-BAL              TO WMS-INT-SC-AGGR-COLL.        2016653
565200 R4008-EXIT. EXIT.
565250     SKIP3
565300 ROOT-SECTION-J1     SECTION 1.
565350 SKIP3
565400 R4009.
565401*----------------------------------------------------------------*1105504
565402*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
565403*----------------------------------------------------------------*1105504
565404     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
565405     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
565406         GO TO R4011.                                             1105504
565410     IF  CLEAR-SAV-CY-SW EQUAL 'F'                                IM006
565420         GO TO R4009-CONTINUE.                                    IM006
565450     IF WMS-SAVINGS-TRLR EQUAL '1'
565500         IF WMS-INT-AGGR-DAYS EQUAL ZERO
565550             MOVE CUR-BAL TO WMS-INT-AVG-BAL
565600         ELSE
565650             DIVIDE WMS-INT-AGGR-DAYS INTO WMS-INT-AGGR-BAL
565700                 GIVING WMS-INT-AVG-BAL.
565720 R4009-CONTINUE.                                                  IM006
565750     IF WMS-CURR-BAL LESS THAN WMS-SC-MIN-BAL
565800         MOVE WMS-CURR-BAL TO WMS-SC-MIN-BAL.
565850     IF WMS-DDA-BAL LESS THAN WMS-SC-DDA-MIN
565900         MOVE WMS-DDA-BAL TO WMS-SC-DDA-MIN.
565903     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9916070
565905         IF  WMS-INT-CUR-BAL LESS THAN WMS-INT-SC-MIN-BAL         9916070
565907             MOVE WMS-INT-CUR-BAL TO WMS-INT-SC-MIN-BAL.          9916070
565910     IF WMS-YR2-LD EQUAL SPACE                                    IM004
565920     AND WMS-NEW-THIS-CYCLE EQUAL '1'                             IM004
565930         MOVE +9999999999999.99 TO WMS-SC-MIN-BAL,                9915845
565940                                   WMS-SC-DDA-MIN,                9916070
565945                                   WMS-INT-SC-MIN-BAL.            9916070
565950     IF WMS-SAV-PTR EQUAL TO ZERO
565970     AND WMS-CHG-CARD-FLG EQUAL TO ZERO                           IM004
566000         GO TO R4010.
566050     IF WMS-SC-MIN-BAL LESS THAN WMS-MIN-BAL
566100         MOVE WMS-MIN-BAL TO WMS-SC-MIN-BAL.
566150     IF WMS-SC-DDA-MIN LESS THAN WMS-MIN-BAL
566200         MOVE WMS-MIN-BAL TO WMS-SC-DDA-MIN.
566250 R4010.
566300     IF WMS-EXTRNL-DEPOSIT-TRLR EQUAL '1'
566350        IF WMS-SAVINGS-BAL NOT EQUAL TO ZERO
566400           IF WMS-SAVINGS-BAL LESS THAN WMS-MIN-SAV-BAL
566450              MOVE WMS-SAVINGS-BAL TO WMS-MIN-SAV-BAL.
566500     IF WMS-SAVINGS-TRLR EQUAL TO '1'
566550         IF WMS-INT-CUR-BAL LESS THAN WMS-INT-MIN-BALANCE
566600             MOVE WMS-INT-CUR-BAL TO WMS-INT-MIN-BALANCE.
566610 R4011.                                                           9915845
566611*   CHECK FOR REG D INTERMEDIATE VIOLATION NOTICE   *             0266776
566612     IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2'                      0437111
566614         PERFORM Y5000-50-REGD THRU Y5000-50-REGD-EXIT.           0266776
566616*                                                                 9915851
566618     COPY IMPD31OC.                                               9915851
566626*                                                                 9915851
566630 R4011-A.                                                         9915845
566660*----------------------------------------------------------------*1105504
566666*    DO NOT CONTINUE TO ACCRUE OD INTEREST IF ACCT IS CLOSED.    *1105504
566668*----------------------------------------------------------------*1105504
566700     IF  SVCH-TODAY EQUAL '0' AND STMT-TODAY EQUAL '0'
566750         GO TO R4090-END-LOOP.
566760     IF  WMS-STATUS EQUAL '04'                                    1105504
566770         GO TO R4014.                                             2016385
566800     SKIP1
566850*    ********  OVERDRAFT ACCRUAL CHARGE PROCESSING  *********     IM002
566900     SKIP3
566950     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'
567000         GO TO R4014.
567050     IF  WMS-OD-INT-SCHED EQUAL '2',  GO  TO  R4012.
567100     IF  SVCH-TODAY EQUAL '0',  GO  TO  R4014.
567150     IF  SVCH-CYCLE-DAYX EQUAL ' '
567200         IF  STMT-CYCLE-DAY EQUAL ACCRUAL-DAY
567250             GO  TO  R4012-A
567300         ELSE
567350             GO  TO  R4014
567400     ELSE
567450         IF  SVCH-CYCLE-DAY EQUAL ACCRUAL-DAY
567500             GO  TO  R4012-A.
567550     GO  TO  R4014.
567600 R4012.
567650     IF  STMT-TODAY EQUAL '0',  GO  TO  R4014.
567700     IF  STMT-CYCLE-DAY NOT EQUAL ACCRUAL-DAY,  GO  TO  R4014.
567750 R4012-A.
567800     MOVE ZERO   TO WMS-OD-CYC-CHGD
567850                    SC-AMT-OD-CHG.
567900     MOVE SPACES TO SC-STMT-SYM-OD.
567910*----------------------------------------------------------------*1105504
567912*    BYPASS OD ACCRUAL IF THIS IS STATIC RUN.                    *1105504
567914*----------------------------------------------------------------*1105504
567916     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
567918     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
567920         GO TO R4013-B.                                           1105504
567950     IF  WBC-OD-INT-PHASE EQUAL TO SPACES                         0266741
568000         MOVE ZERO TO WMS-OD-CYC-CHGD
568050         GO TO R4013-B.                                           0902940
568100     MOVE WBC-OD-INT-PHASE TO IM31-PH2.                           0266741
568150     MOVE '4' TO OD-ACR-PAY-FLAG.
568200     CALL 'SILINK' USING IM31-PHASE
568250                         MASTER-AREA
568300                         OD-CHARGE-PARAMETERS
568350                         DDA-WRKBCR-1                             0266741
568400                         DDA-WRKBCR-4                             0266741
568450                         INTEREST-ACCRUAL-PARAMETERS.
568451*--------------------------------------------------------------*  0902213
568452***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE OVERDRAFT   *  0902213
568453***  ACCRUAL CHARGES.                                          *  0902213
568454***                                                            *  0902213
568455***  COPY IM31UR40.                                            *  0902213
568456***                                                            *  0902213
568457***  END OF USER EXIT.                                         *  0902213
568458*--------------------------------------------------------------*  0902213
568459     IF  WMS-OD-CYC-CHGD LESS THAN ZERO                           0902213
568460         MOVE ZERO TO WMS-OD-CYC-CHGD.                            0902213
568570 R4012-B.                                                         1105504
568572     IF  BHW-ODAC-FLAG  EQUAL 'N'                                 1105504
568574     AND WBHO-ENTRIES  GREATER THAN ZERO                          1105504
568576         SUBTRACT WMS-OD-CYC-ACR FROM WBHO-ODAC-ACCR-ADJ (1).     1105504
568578     MOVE '0' TO OD-ACR-PAY-FLAG.                                 1105504
568580     IF  WMS-OD-CYC-ACR LESS THAN ZERO                            0917827
568582         ADD -.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR2               0917827
568584         SUBTRACT HOLD-ACCR2 FROM OD-ACCRL-ADJ-INTRNL             0917827
568586                                  WS-GL-OD-ACCRL-ADJ-INTRNL.      0917827
568588     MOVE WMS-OD-CYC-ACR TO EX01-OD-CYC-ACCR.                     0917827
568590     MOVE ZERO TO WMS-OD-CYC-ACR.                                 0917827
568600     IF  WMS-OD-CYC-CHGD NOT GREATER THAN ZERO
568650         GO TO R4013-B.                                           0902940
568660*----------------------------------------------------------------*1105504
568662*    OD INT GT REC AND GL TOTALS WHEN NOT PART OF OD INT HAS     *1105504
568664*    BEEN PAID BY EARNINGS CREDIT.                               *1105504
568666*----------------------------------------------------------------*1105504
568700     IF  (WMS-OD-INT-WAIVE EQUAL '1')                             2015870
568710     OR  (WBC-OD-MIN-CHG-AMT GREATER THAN WMS-OD-CYC-CHGD)        0266741
568750         SUBTRACT WMS-OD-CYC-CHGD FROM OD-ACCRL-ADJ-INTRNL
568751                                       WS-GL-OD-ACCRL-ADJ-INTRNL  0902970
568800         MOVE +0.00 TO WMS-OD-CYC-CHGD
568850         GO  TO  R4013-B.                                         0902940
568900     ADD WMS-OD-CYC-CHGD TO OD-CHARGED-TODAY                      0902970
568901                            WS-GL-OD-CHARGED-TODAY                9915845
568902                            WMS-OD-STMT-CYC-CHRG.                 9915845
568905     ADD +1              TO OD-CHARGED-TODAY-NO                   1003439
568910                            WS-GL-OD-CHARGED-TODAY-NO.            1003439
568950     ADD +1 TO FS-DB.
569000     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
569050     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
569100         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
569150         ADD WMS-OD-CYC-CHGD TO IOD-DB-AMT, WS-GL-IOD-DB-AMT      0902970
569200         MOVE '1' TO IOD-ACCRUE
569250     ELSE
569300         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
569350         ADD WMS-OD-CYC-CHGD TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.     0902970
569400     PERFORM K7500 THRU K8500.
569450     MOVE WBC-GENERATED-TRANS (22) TO GEN-TRAN-OPTION-HOLD        0266741
569500     MOVE SC-AMT-OD-CHG TO HOLD-AMT.
569510*----------------------------------------------------------------*1105504
569512*    DO NOT INCREMENT STMT DR COUNTER FOR GT22 IF SAA SET OTHER  *1105504
569514*    SET OTHER COUNTER TO '1'.                                   *1105504
569516*----------------------------------------------------------------*1105504
569518     IF  WMS-MTD-ANALYSIS NOT EQUAL '8'                           1105504
569550         ADD +1 TO WMS-STMT-NO-DEBITS.                            1105504
569600     ADD HOLD-AMT TO WMS-STMT-DR-AMT.
569650     IF  SC-STMT-SYM-OD NOT EQUAL SPACES
569700         MOVE SC-STMT-SYM-OD TO GT-MNEUMONIC.
569710     MOVE 1    TO EX01-SC-CTR-OTH.                                1105504
569750     MOVE '22' TO EX01-INT-CODE.
569800     MOVE 'G8' TO IMEX-CODE-2.
569850     MOVE '4' TO EX01-TYPE.
569900     MOVE ZERO TO EX01-NUMBER.
569950     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
569955 R4012-B-CONT.                                                    1105504
569960     ADD WMS-OD-CYC-CHGD TO WMS-IOD-TIS-CYC-FEES.                 1105504
569970     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-CTD.                 0627451
569972     ADD HOLD-AMT TO WMS-STMT-OVERDRAFT-CHGD-YTD.                 0627451
569974     IF  WMS-OD-INT-XFER-PTR GREATER THAN +0                      0817704
569976         MOVE WMS-OD-INT-XFER-PTR TO X                            0817704
569978         MOVE '08' TO IMEX-REC-NO                                 0817704
569980         MOVE 'IO' TO IMEX-CODE-1                                 0817704
569982         MOVE WMS-LINK-SYS-ID (X) TO IMEX-CODE-2                  0817704
569984         MOVE WMS-LINKAGE-CNTL (X) TO EX08-CNTL                   0817704
569986         MOVE HOLD-AMT TO EX08-END-BAL                            0817704
569988         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 0817704
570000     IF  WMS-SAVINGS-TRLR EQUAL '0'
570050         GO TO R4013.
570100     IF  WMS-INT-STATUS GREATER THAN '1'
570150         GO TO R4013.
570200     IF MAX-TRNSFR-FG NOT EQUAL 'N'
570250         GO TO R4012-C.                                           IM002
570300     MOVE '1' TO SAV-ACCRUE.
570350     MULTIPLY TRANSFER-AMT BY -1 GIVING POS-TRFR-AMT.
570400     IF WMS-OD-CYC-CHGD NOT GREATER THAN POS-TRFR-AMT
570450         ADD WMS-OD-CYC-CHGD TO TRANSFER-AMT
570500         SUBTRACT WMS-OD-CYC-CHGD FROM WMS-INT-CUR-BAL
570550                                       WMS-CURR-BAL
570600                                       WMS-DDA-MAX-CYCLE-AMT
570650                                       WMS-DDA-MAX-MTD-AMT
570700         GO TO R4013-A
570750     ELSE
570800         ADD TRANSFER-AMT TO WMS-INT-CUR-BAL
570850                             WMS-DDA-MAX-CYCLE-AMT
570900                             WMS-DDA-MAX-MTD-AMT
570950         SUBTRACT TRANSFER-AMT FROM WMS-DDA-BAL
571000         SUBTRACT +1 FROM WMS-DDA-MAX-CYCLE-NO
571050                          WMS-DDA-MAX-MTD-NO
571100         MOVE +0 TO TRANSFER-AMT.
571150 R4012-C.                                                         IM002
571200     IF  WMS-OD-CYC-CHGD NOT GREATER THAN WMS-DDA-BAL
571250         GO TO R4013.
571300     IF  WMS-OD-CYC-CHGD GREATER THAN WMS-CURR-BAL
571350         GO TO R4013.
571400     IF  (WMS-HIFI-INDICATOR GREATER THAN +0                      0902509
571425     AND (WMS-MMDA-INDICATOR NOT EQUAL '1' AND '2' AND '3'))      0437111
571450         IF  WMS-OD-CYC-CHGD GREATER THAN
571500            (WMS-CURR-BAL - WMS-MIN-AMT-FOR-SUPER)
571550             GO TO R4013.
571600     SUBTRACT WMS-DDA-BAL FROM WMS-OD-CYC-CHGD                    0902477
571610         GIVING WK-HOLD-AMT13.                                    9915845
571650     ADD WK-HOLD-AMT13 TO WMS-DDA-BAL TRANSFER-AMT.               9915845
571700     SUBTRACT WK-HOLD-AMT13 FROM WMS-INT-CUR-BAL.                 9915845
571800     MOVE '1' TO SAV-ACCRUE.
571850 R4013.
571900     SUBTRACT WMS-OD-CYC-CHGD FROM WMS-CURR-BAL.
571950     SUBTRACT WMS-OD-CYC-CHGD FROM WMS-DDA-BAL.
572000 R4013-A.
572050     ADD WMS-OD-CYC-CHGD TO WMS-OD-MTD-CHGD
572100                            WMS-OD-YTD-CHGD.
572107 R4013-B.                                                         0902940
572114     MOVE WMS-OD-ACR-AGGR-CTD TO SAVE-ODAC-AGGR-BAL.              0902940
572121     MOVE WMS-OD-ACR-AGGR-DAYS-CTD TO SAVE-ODAC-DAYS.             0902940
572128     MOVE '1' TO ODAC-CHG-TODAY.                                  0902940
572135     MOVE ZERO TO WMS-OD-ACR-AGGR-CTD                             0902940
572142                  WMS-OD-ACR-AGGR-DAYS-CTD.                       0902940
572150 R4013-EXIT. EXIT.
572200 SKIP3
572250*******************   SERVICE CHARGE AREA   ********************
572300 SKIP3
572350 R4014.
572352*----------------------------------------------------------------*0337109
572354*    ZERO THE EARNINGS CREDIT SERVICE CHARGE FIELDS.             *0337109
572356*----------------------------------------------------------------*0337109
572358     MOVE ZERO TO SC-TOT-EC                                       0337109
572360                  SC-RESV-AMT                                     0337109
572362                  SC-EC-RATE.                                     0337109
572400     IF  SVCH-TODAY EQUAL '0',  GO TO R4090-END-LOOP.             1004015
572450     IF  SVCH-CYCLE-DAYX EQUAL ' '
572500         IF  STMT-CYCLE-DAY NOT EQUAL ACCRUAL-DAY
572550             GO TO R4090-END-LOOP                                 1004015
572600         ELSE
572650             NEXT SENTENCE
572700     ELSE
572750         IF  SVCH-CYCLE-DAY NOT EQUAL ACCRUAL-DAY
572800             GO TO R4090-END-LOOP.                                1004015
572850     MOVE '1' TO WMS-SC-CLEAR.
572852     MOVE '1' TO WMS-IT-TRAN-FLAG2.                               9915749
572860     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1' AND                       IM004
572870         WMS-SC-DELETE NOT EQUAL '1'                              IM004
572880         MOVE 'C' TO WMS-SC-DELETE.                               IM004
572895     PERFORM Y4000-RESET-SC-FIELDS THRU Y4000-EXIT.               1105504
572900*----------------------------------------------------------------*0516691
572902*    SET WS FLAG IF ALL ANCILLARY FEES ARE TO BE WAIVED          *0516691
572904*----------------------------------------------------------------*0516691
572906     MOVE WMS-NB-ANC-CHARGE TO WS-ANC-CHARGE.                     0516691
572908     IF  WMS-NB-ANC-CHARGE EQUAL '1'                              0516691
572910         GO TO R4014-CONT.                                        0516691
572912     MOVE WBC-CAPTURE-YR         TO SV-DT8-YR.                    0516691
572913     MOVE WBC-CAPTURE-MO         TO SV-DT8-MO.                    0516691
572914     MOVE WBC-CAPTURE-DA         TO SV-DT8-DA.                    0516691
572915     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0516691
572916         MOVE '20'               TO SV-DT8-CENT                   0516691
572917     ELSE                                                         0516691
572918         MOVE '19'               TO SV-DT8-CENT.                  0516691
572919     MOVE WMS-NB-ANC-WV-EX-MM    TO WORK-DATE1-MO.                0516691
572920     MOVE WMS-NB-ANC-WV-EX-DD    TO WORK-DATE1-DA.                0516691
572921     MOVE WMS-NB-ANC-WV-EX-CC    TO WORK-DATE1-CC.                0516691
572922     MOVE WMS-NB-ANC-WV-EX-YY    TO WORK-DATE1-YR.                0516691
572924     IF  WORK-DATE1 NOT EQUAL SPACES                              0527419
572926         IF  WORK-DATE1 NOT GREATER THAN SAVE-DATE-8              0527419
572928             MOVE '1'            TO WS-ANC-CHARGE.                0527419
573510 R4014-CONT.                                                      1105504
573512*----------------------------------------------------------------*1105504
573514*    BYPASS SERVICE ROUTINE CALL IF STATUS = 04 - CLOSED         *1105504
573516*----------------------------------------------------------------*1105504
573518     IF  WMS-STATUS EQUAL '04'                                    1105504
573520         MOVE ZERO TO WMS-SC-CHARGE WMS-SERV-CHARGE               1105504
573522         GO TO R4020.                                             1105504
573550     IF WMS-SAVINGS-TRLR EQUAL TO '1'
573600         MOVE ZERO TO WMS-INT-TR-CHG                              9916072
573610         IF  WMS-CMA-FEE-WAIVE-IND EQUAL 'Y'                      9916072
573615         OR  WMS-SC-CHARGE         EQUAL '0'                      9916072
573620             MOVE '1' TO CMA-FEE-WAIVE.                           9916072
573650     IF WMS-SC-ROUTINE-PTR EQUAL TO ZERO
573700         MOVE ZERO TO WMS-SERV-CHARGE
573750         GO TO R4020.
573800     IF WBC-SERV-CHG-PHASE (WMS-SC-ROUTINE-PTR) EQUAL TO SPACES   0266741
573850         MOVE ZERO TO WMS-SERV-CHARGE
573900         GO TO R4020.
573951*--------------------------------------------------------------*  9915845
573952***  THE FOLLOWING USER EXIT MAY BE USED TO CHANGE FIELDS OR   *  9915845
573953***  PERFORM FUNCTIONS BEFORE CALLING THE SERVICE CHARGE PHASE *  9915845
573954***                                                            *  9915845
573955     COPY IMPD31SC.                                               9915845
573956***                                                            *  9915845
573957***  END OF USER EXIT.                                         *  9915845
573958*--------------------------------------------------------------*  9915845
574000 R4016.
574020     MOVE WBC-SERV-CHG-PHASE (WMS-SC-ROUTINE-PTR) TO IM31-PH2.    0266741
574050     CALL 'SILINK' USING IM31-PHASE
574100                           MASTER-AREA
574150                           SERVICE-CHARGE-PARAMETERS
574200                           DDA-WRKBCR-1                           0266741
574250                           CMA-FEE-PARAMETERS                     IM003
574350                           DDA-WRKBCR-4                           0266741
574400                           EX-SEQ-CTR
574460                           EXCEPTION-AREA                         1004962
574470                           IM-SC-ACCESS                           9715464
574480                           WS-SRV-CHG-ACC                         1105504
574481                           FEE-ACCUM-TABLE                        1105504
574482                           FEE-NUMBER-TABLE                       1105504
574483                           EMSG-99                                0736655
574484                           CMA-AGGR-DAYS                          0736655
574485                           CMA-PAST-AGGR-DAYS                     0736655
574486                           WS-PREV-INT-AGG-ADJ.                   0736655
574500 R4016-EXIT. EXIT.
574550 R4017.
574600*  --THE CALCULATED SERVICE CHARGE WILL BE RETURNED IN THE
574650*  --MASTER AREA IN 'WMS-SERV-CHARGE'.
574700*  --THE CALCULATED SERVICE CHARGE IS COMPRISED OF THE AMOUNTS
574750*  --RETURNED IN 'SC-AMT-SERV', 'SC-AMT-ACH', AND 'SC-AMT-ATM'.
574800*  --THE CALCULATED TRANSFER CHARGE FOR INTERNAL TRANSFERS WILL
574850*  --BE RETURNED IN 'WMS-INT-TR-CHG'. THE TRANSFER CHARGE FOR
574900*  --EXTERNAL TRANSFERS WILL BE RETURNED IN 'WMS-SC-TRAN-CHG'.
574950 R4020.
575000     IF WMS-SERV-CHARGE NOT GREATER THAN ZERO
575050         GO TO R4072.
575100     IF (WS-ANC-CHARGE EQUAL TO '0' AND                           0516691
575110        SC-FEE-TYPE EQUAL TO 'A')                                 0516691
575120         ADD +1 TO DDA-SVC-CHG-WAV-NO, WS-GL-DDA-SVC-CHG-WAV-NO   0516691
575130         ADD WMS-SERV-CHARGE TO DDA-SVC-CHG-WAV-AMT               0516691
575141                                WS-GL-DDA-SVC-CHG-WAV-AMT         0516691
575145         GO TO R4073.                                             0516691
575150     IF (WMS-SC-CHARGE EQUAL TO '0' AND                           0516691
575152        SC-FEE-TYPE NOT EQUAL TO 'A')                             0516691
575200         ADD +1 TO DDA-SVC-CHG-WAV-NO, WS-GL-DDA-SVC-CHG-WAV-NO   0902970
575250         ADD WMS-SERV-CHARGE TO DDA-SVC-CHG-WAV-AMT
575251                                WS-GL-DDA-SVC-CHG-WAV-AMT         0902970
575300         GO TO R4073.                                             IM003
575350     GO  TO  R4028.
575400 R4021.
575450     IF WMS-SAVINGS-TRLR EQUAL '0'
575500         GO TO R4025.
575550     IF WMS-INT-STATUS GREATER THAN '1'
575600         GO TO R4025.
575650     IF MAX-TRNSFR-FG NOT EQUAL 'N'
575700         GO TO R4022.
575750     MOVE '1' TO SAV-ACCRUE.
575755     MOVE HOLD-AMT TO HOLD-AMT13.                                 9915845
575760     ADD SC-AMT-EC TO WK-HOLD-EC-AMT.                             0337109
575800     MULTIPLY TRANSFER-AMT BY -1 GIVING POS-TRFR-AMT.
575850     IF  HOLD-AMT NOT GREATER THAN POS-TRFR-AMT                   IM003
575880         ADD HOLD-AMT TO TRANSFER-AMT                             IM003
575910         SUBTRACT HOLD-AMT FROM WMS-INT-CUR-BAL                   IM003
575940                                WMS-CURR-BAL                      IM003
575970                                WMS-DDA-MAX-CYCLE-AMT             IM003
576000                                WMS-DDA-MAX-MTD-AMT               IM003
576150         GO TO R4026                                              0337109
576200     ELSE
576220     IF  TRANSFER-AMT NOT EQUAL +0                                IM003
576250         ADD TRANSFER-AMT TO WMS-INT-CUR-BAL
576300                             WMS-DDA-MAX-CYCLE-AMT
576350                             WMS-DDA-MAX-MTD-AMT
576400         SUBTRACT TRANSFER-AMT FROM WMS-DDA-BAL
576450         SUBTRACT +1 FROM WMS-DDA-MAX-CYCLE-NO
576500                          WMS-DDA-MAX-MTD-NO
576550         MOVE +0 TO TRANSFER-AMT.
576560     MOVE HOLD-AMT13 TO HOLD-AMT.                                 1004525
576600 R4022.
576650     IF  HOLD-AMT NOT GREATER THAN WMS-DDA-BAL                    IM003
576700         GO  TO  R4025.
576750     IF  HOLD-AMT GREATER THAN WMS-CURR-BAL                       IM003
576800         GO  TO  R4025.
576850     IF  (WMS-HIFI-INDICATOR GREATER THAN +0                      0902509
576860     AND (WMS-MMDA-INDICATOR NOT EQUAL '1' AND '2' AND '3'))      0437111
576900         IF  HOLD-AMT GREATER THAN                                IM003
576950            (WMS-CURR-BAL - WMS-MIN-AMT-FOR-SUPER)
577000             GO  TO  R4025.
577050     SUBTRACT WMS-DDA-BAL FROM HOLD-AMT GIVING WK-HOLD-AMT13.     9915845
577100     ADD WK-HOLD-AMT13 TO WMS-DDA-BAL TRANSFER-AMT.               9915845
577150     SUBTRACT WK-HOLD-AMT13 FROM WMS-INT-CUR-BAL.                 9915845
577250     MOVE '1' TO SAV-ACCRUE.
577300 R4025.
577350     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL.                         IM003
577370     SUBTRACT HOLD-AMT FROM WMS-DDA-BAL.                          IM003
577450 R4026.
577500     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
577550     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
577600         MOVE '1' TO IOD-ACCRUE
577650         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
577700     ELSE
577750         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
577770     ADD HOLD-AMT TO WMS-STMT-SERV-CHG                            IM003
577780                     WMS-YTD-ACCUM-SERV-CHG                       0617360
577790                     WMS-MTD-ACCUM-SERV-CHG.                      IM003
577900 R4027-EXIT. EXIT.
577950 R4028.
577960     SKIP1                                                        IM003
577970**** WMS-SERV-CHARGE MUST EQUAL THE WORK FIELDS       ****        IM003
577980     SKIP1                                                        IM003
578000     IF WMS-SERV-CHARGE GREATER THAN ZERO
578050         AND SC-AMT-SERV EQUAL ZERO
578100         AND SC-AMT-ACH  EQUAL ZERO
578150         AND SC-AMT-ATM EQUAL ZERO
578200         AND CMA-MGMT-FEES EQUAL ZERO
578250             MOVE WMS-SERV-CHARGE TO SC-AMT-SERV                  IM003
578260     ELSE                                                         IM003
578270        ADD SC-AMT-SERV, SC-AMT-ACH, SC-AMT-ATM, CMA-MGMT-FEES    IM003
578280            GIVING WMS-SERV-CHARGE.                               IM003
578300     SKIP1
578350**** GENERATES TRANSACTION FOR REGULAR SERVICE CHARGE ****
578400     SKIP1
578450 R4030.
578500     IF SC-AMT-SERV NOT GREATER THAN ZERO
578550         GO TO R4035.
578600     IF  SC-SERV-WAIVE EQUAL '1'
578650         ADD SC-AMT-SERV TO DDA-SVC-CHG-WAV-AMT
578651                            WS-GL-DDA-SVC-CHG-WAV-AMT             0902970
578700         GO  TO  R4035.
578750 R4031.
578800     ADD +1 TO DDA-SVC-CHG-NO, WS-GL-DDA-SVC-CHG-NO, FS-DB.       0902970
578850     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
578900     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
578950         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
579000     ELSE
579050         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO.                    0902970
579100     PERFORM K7500 THRU K8500.
579150     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
579200 R4031-EXIT. EXIT.
579250 R4032.
579300     MOVE SC-AMT-SERV TO HOLD-AMT.
579350     IF SC-STMT-SYM-SERV NOT EQUAL SPACES
579400         MOVE SC-STMT-SYM-SERV TO GT-MNEUMONIC.
579450     MOVE '01' TO EX01-INT-CODE.
579500     PERFORM R4050 THRU R4072.
579550     SKIP1
579600**** GENERATES TRANSACTION FOR ACH SERVICE CHARGE ****
579650     SKIP1
579700 R4035.
579750     IF SC-AMT-ACH NOT GREATER THAN ZERO
579800         GO TO R4040.
579850     IF  SC-ACH-WAIVE EQUAL '1'
579900         ADD SC-AMT-ACH TO DDA-SVC-CHG-WAV-AMT
579901                           WS-GL-DDA-SVC-CHG-WAV-AMT              0902970
579950         GO  TO  R4040.
580000     ADD +1 TO DDA-SVC-CHG-NO, WS-GL-DDA-SVC-CHG-NO, FS-DB.       0902970
580050     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
580100     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
580150         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
580200     ELSE
580250         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO.                    0902970
580300     PERFORM K7500 THRU K8500.
580350     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
580400     MOVE SC-AMT-ACH TO HOLD-AMT.
580450     IF SC-STMT-SYM-ACH NOT EQUAL SPACES
580500         MOVE SC-STMT-SYM-ACH TO GT-MNEUMONIC.
580550     MOVE '01' TO EX01-INT-CODE.
580600     PERFORM R4050 THRU R4072.
580650     SKIP1
580700**** GENERATES TRANSACTION FOR ATM SERVICE CHARGE ****
580750     SKIP1
580800 R4040.
580850     IF SC-AMT-ATM NOT GREATER THAN ZERO
580900         GO  TO  R4045.
580950     IF  SC-ATM-WAIVE EQUAL '1'
581000         ADD SC-AMT-ATM TO DDA-SVC-CHG-WAV-AMT
581001                           WS-GL-DDA-SVC-CHG-WAV-AMT              0902970
581050         GO  TO  R4045.
581100 R4042.
581150     ADD +1 TO DDA-SVC-CHG-NO, WS-GL-DDA-SVC-CHG-NO, FS-DB.       0902970
581200     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
581250     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
581300         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
581350     ELSE
581400         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO.                    0902970
581450     PERFORM K7500 THRU K8500.
581500     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
581550     MOVE SC-AMT-ATM TO HOLD-AMT.
581600     IF SC-STMT-SYM-ATM NOT EQUAL SPACES
581650         MOVE SC-STMT-SYM-ATM TO GT-MNEUMONIC.
581700     MOVE '01' TO EX01-INT-CODE.
581750     PERFORM R4050 THRU R4072.
581800     SKIP3
581850*****   GENERATES CMA SERVICE CHARGE   ***************************
581900     SKIP3
581950 R4045.
582000     IF  WMS-SAVINGS-TRLR  EQUAL '0', GO TO R4045-EXIT.           9916072
582010     IF  WMS-CMA-INDICATOR EQUAL '0', GO TO R4045-EXIT.           9916072
582050     IF  CMA-MGMT-FEES EQUAL ZERO, GO TO R4045-EXIT.              9916072
582100     IF  CMA-FEE-WAIVE EQUAL '1'
582105         ADD +1            TO DDA-CMA-FEES-NBR-WV                 9916072
582110                              DDA-SVC-CHG-WAV-NO                  9916072
582115                              WS-GL-DDA-CMA-FEES-NBR-WV           9916072
582120                              WS-GL-DDA-SVC-CHG-WAV-NO            9916072
582150         ADD CMA-MGMT-FEES TO DDA-SVC-CHG-WAV-AMT
582151                              WS-GL-DDA-SVC-CHG-WAV-AMT           0902970
582160                              DDA-CMA-FEES-AMT-WV                 9916072
582161                              WS-GL-DDA-CMA-FEES-AMT-WV           9916072
582162                              WMS-CMA-CTD-MGMT-FEES-WV            9916072
582163                              WMS-CMA-YTD-MGMT-FEES-WV            9916072
582200         GO TO R4045-EXIT.                                        9916072
582250     MOVE CMA-MGMT-FEES TO WMS-CMA-CTD-MGMT-FEES.                 9916072
582255     ADD CMA-MGMT-FEES  TO WMS-CMA-YTD-MGMT-FEES                  9916072
582260                           DDA-CMA-FEES-AMT                       9916072
582265                           WS-GL-DDA-CMA-FEES-AMT.                9916072
582270     ADD +1 TO DDA-SVC-CHG-NO                                     9916072
582275               WS-GL-DDA-SVC-CHG-NO                               9916072
582280               FS-DB                                              9916072
582285               DDA-CMA-FEES-NBR                                   9916072
582290               WS-GL-DDA-CMA-FEES-NBR.                            9916072
582295     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       9916072
582300     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     9916072
582305         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     9916072
582310     ELSE                                                         9916072
582315         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO.                    9916072
582320     PERFORM K7500 THRU K8500.                                    9916072
582325     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
582330     MOVE CMA-MGMT-FEES TO HOLD-AMT.                              9916072
582335     MOVE CMA-MGMT-FEE-SYM TO GT-MNEUMONIC.                       9916072
582340     MOVE '01' TO EX01-INT-CODE.                                  9916072
582345     MOVE 'GX' TO IMEX-CODE-2.                                    9916072
582350     PERFORM R4050 THRU R4072.                                    9916072
582355 R4045-EXIT.                                                      9916072
582360     EXIT.                                                        9916072
582400 R4046.                                                           9916072
582450     GO  TO  R4072.
582500 R4050.
582520     PERFORM R4021 THRU R4027-EXIT.                               IM003
582525     IF  GT-MNEUMONIC EQUAL 'SJ'                                  2015391
582530         ADD HOLD-AMT TO SERV-CHG-DORM-AMT,                       2015391
582535                         WS-GL-SERV-CHG-DORM-AMT                  2015391
582537         ADD +1   TO SERV-CHG-DORM-NO, WS-GL-SERV-CHG-DORM-NO     2015391
582539         SUBTRACT +1  FROM DDA-SVC-CHG-NO, WS-GL-DDA-SVC-CHG-NO   2015391
582540     ELSE                                                         2015391
582550         ADD HOLD-AMT TO DDA-SVC-CHG-AMT, WS-GL-DDA-SVC-CHG-AMT.  2015391
582600     MOVE '4' TO EX01-TYPE.
582650     MOVE ZERO TO EX01-NUMBER.
582700     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
582701*----------------------------------------------------------------*1105504
582702*    INCREMENT THE STMT-DR-AMT AND STMT-NO-DEBIT.                *1105504
582703*    ONLY FOR ACCTS THAT ARE NOT SAA TO NO-DEBITS                *1105504
582704*----------------------------------------------------------------*1105504
582705*    IF  WMS-MTD-ANALYSIS NOT EQUAL '8'                           9915749
582706*        ADD +1 TO WMS-STMT-NO-DEBITS.                            9915749
582707*    ADD HOLD-AMT TO WMS-STMT-DR-AMT.                             9915749
582710     ADD HOLD-AMT TO WMS-IOD-TIS-CYC-FEES.                        1004015
582750 R4072.                                                           9915845
582760     EXIT.                                                        9915845
582800     SKIP3
582850*****   GENERATES MISC SERVICE CHARGE   **************************
582854******************************************************************IM003
582858*****   SC-AMT-OTH IS CALCULATED IN THE SERVICE CHARGE ROUTINE. **IM003
582862***** IT MUST NOT BE ADDED TO WMS-SERV-CHARGE IN THE ROUTINE.   **IM003
582866***** IT MUST BE CALCULATED THE FIRST TIME INTO THE ROUTINE IF  **IM003
582870***** THERE IS TO BE ANY MISC SERVICE CHARGES.  THEN IM31 WILL  **IM003
582874***** KEEP RETURNING TO THE SERVICE CHARGE ROUTINE FOR EACH     **IM003
582878***** MISC CHARGE UNTIL "SC-FLAG" IS SET TO '1' OR SC-AMT-OTH IS**IM003
582882***** EQUAL TO ZERO. THE SC-FLAG SHOULD BE SET TO '1' UPON THE  **IM003
582886***** LAST MISC CHARGE TO BE MADE.                              **IM003
582890******************************************************************IM003
582900     SKIP3
582950 R4073.
582960*----------------------------------------------------------------*1105504
582961*    USE ONLY SC-OTH-WAIVE TO DETERMINE IF AN INDIVIDUAL         *1105504
582962*    CHARGE IS TO BE WAIVED. SC-AMT-OTH CAN BE ZERO AND          *1105504
582963*    STILL NEED TO PROCESS OTHER CHARGES.                        *1105504
582964*----------------------------------------------------------------*1105504
583000*    IF  SC-AMT-OTH EQUAL +0,  GO  TO  R4074.                     1105504
583070     ADD SC-AMT-OTH TO WMS-SERV-CHARGE.                           IM005
583072     ADD SC-AMT-EC TO WK-HOLD-EC-AMT.                             0337109
583080     IF  CMA-MGMT-FEES GREATER THAN ZERO                          9916072
583084         PERFORM R4045 THRU R4045-EXIT                            9916072
583086         MOVE ZERO TO CMA-MGMT-FEES                               9916072
583088         GO TO R4073-EXIT.                                        9916072
583100     IF (WMS-SC-CHARGE EQUAL '0' AND                              0516691
583110         SC-FEE-TYPE NOT EQUAL 'A')                               0516691
583120     OR (WS-ANC-CHARGE EQUAL '0' AND                              0516691
583130         SC-FEE-TYPE EQUAL 'A')                                   0516691
583150     OR  SC-OTH-WAIVE NOT EQUAL TO '0'                            9915749
583170         ADD +1 TO DDA-SVC-CHG-WAV-NO, WS-GL-DDA-SVC-CHG-WAV-NO   0902970
583200         ADD SC-AMT-OTH TO DDA-SVC-CHG-WAV-AMT
583201                           WS-GL-DDA-SVC-CHG-WAV-AMT              9915749
583205         GO TO R4073-EXIT.                                        9915749
583210     IF  SC-STMT-SYM-SERV EQUAL 'SR'                              1105504
583212         MOVE SC-AMT-OTH  TO  EX14-SVC-RD-CHG.                    1105504
583214     IF  SC-AMT-OTH EQUAL +0                                      1105504
583250         GO TO R4073-EXIT.                                        1105504
583350     PERFORM R4031 THRU R4031-EXIT.
583400     MOVE SC-AMT-OTH TO HOLD-AMT.
583410     IF  SC-STMT-SYM-SERV NOT EQUAL SPACES                        1004525
583420         MOVE SC-STMT-SYM-SERV TO GT-MNEUMONIC                    1004525
583430     ELSE                                                         1004525
583450         MOVE SC-STMT-SYM-OTH TO GT-MNEUMONIC.                    1004525
583460     MOVE SC-CTR-OTH TO EX01-SC-CTR-OTH.                          1105504
583500     MOVE '01' TO EX01-INT-CODE.
583550     PERFORM R4050 THRU R4072.
583600 R4073-EXIT.
583650     IF  SC-FLAG EQUAL '1'
583700         PERFORM R4016 THRU R4016-EXIT
583702         GO  TO  R4073.                                           1105504
583705 R4074.                                                           1105504
583750     IF  WK-HOLD-EC-AMT IS GREATER THAN 0                         0717444
583800         ADD +1                      TO  SERV-CHG-EC-NO           0717444
583802                                         WS-GL-SERV-CHG-EC-NO     0717444
583804         ADD WK-HOLD-EC-AMT          TO  SERV-CHG-EC-AMT          0717444
583806                                         WS-GL-SERV-CHG-EC-AMT    0337109
583808                                         WMS-STMT-EARN-CRED.      0337109
583950 R4075.
584000     MOVE WMS-SC-TRAN-CHG TO HOLD-AMT5.
584050     IF WMS-SAVINGS-TRLR EQUAL TO '1'
584100         MOVE '1' TO WMS-INT-STMT-CLEAR
584150         ADD WMS-INT-TR-CHG TO HOLD-AMT5.
584200     IF HOLD-AMT5 NOT GREATER THAN ZERO
584250         GO TO R4080.
584300     ADD +1 TO DDA-GEN-TRANS-CHG-NO, WS-GL-DDA-GEN-TRANS-CHG-NO.  0902970
584350     ADD HOLD-AMT5 TO DDA-GEN-TRANS-CHG-AMT                       0902970
584351                      WS-GL-DDA-GEN-TRANS-CHG-AMT.                0902970
584400     ADD +1 TO FS-DB.
584450     PERFORM K7500 THRU K8500.
584500     IF HOLD-AMT5 NOT GREATER THAN WMS-DDA-BAL
584550         GO TO R4078.
584600     IF HOLD-AMT5 GREATER THAN WMS-CURR-BAL
584650         GO TO R4078.
584700     IF WMS-SAVINGS-TRLR EQUAL TO '0'
584750         GO TO R4078.
584800     IF WMS-INT-STATUS GREATER THAN '1'
584850         GO TO R4078.
584900     SUBTRACT WMS-DDA-BAL FROM HOLD-AMT5 GIVING WK-HOLD-AMT13.    9915845
584950     ADD WK-HOLD-AMT13 TO WMS-DDA-BAL TRANSFER-AMT.               9915845
585000     SUBTRACT WK-HOLD-AMT13 FROM WMS-INT-CUR-BAL.                 9915845
585100 R4078.
585150     SUBTRACT HOLD-AMT5 FROM WMS-CURR-BAL WMS-DDA-BAL.
585200     ADD HOLD-AMT5 TO WMS-STMT-TRAN-CHG.
585250     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO
585300     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
585350         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
585400         ADD HOLD-AMT5 TO IOD-DB-AMT, WS-GL-IOD-DB-AMT            0902970
585450     ELSE
585500         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
585550         ADD HOLD-AMT5 TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.           0902970
585600     MOVE HOLD-AMT5 TO HOLD-AMT.
585650     MOVE '18' TO EX01-INT-CODE.
585700     MOVE WBC-GENERATED-TRANS (18) TO GEN-TRAN-OPTION-HOLD.       0266741
585750     PERFORM R4050 THRU R4072.
585800 R4080.
585810*----------------------------------------------------------------*1105504
585811*    WMS-NB-REL-IND WILL BE USED INSTEAD OF WMS-SC-REL-CODE      *1105504
585812*    TO DETERMINE IF AN ACCOUNT IS IN A RELATIONSHIP.  HOWEVER,  *1105504
585813*    THE VALUES OF WMS-SC-REL-CODE WERE EXPANDED TO INDICATE IF  *1105504
585814*    A RELATED STUDENT ACCOUNT (6) OR A BALANCE WAIVER ACCOUNT   *1105504
585815*    (7).                                                        *1105504
585816*    ADD REPORT EXCEPTION CODES FOR RELATIONSHIP ACCOUNTS        *1105504
585817*    AND FOR ACCOUNTS IN VIOLATION OF REG D:                     *1105504
585818*       ZA = SERVICE CHG/RELATIONSHIP ACCT/REG D VIOLATION       *0266124
585819*       H8 = SERVICE CHG/RELATIONSHIP ACCT                       *1105504
585820*       ZC = SERVICE CHG/REG D VIOLATION                         *0266124
585821*----------------------------------------------------------------*1105504
585850     MOVE '14' TO IMEX-REC-NO.
585900     MOVE 'H7' TO IMEX-CODE-1.
585950     IF (WMS-SC-REL-CODE GREATER THAN '0' AND LESS THAN '6')      1105504
585952         IF (WMS-NB-REL-IND EQUAL TO '0' OR ' ')                  1105504
585954            IF  SC-STMT-SYM-SERV EQUAL TO 'SR'                    1105504
585956                MOVE 'ZA'           TO IMEX-CODE-2                1105504
585958            ELSE                                                  1105504
585960                MOVE 'H8'           TO IMEX-CODE-2                1105504
585962         ELSE                                                     1105504
585964            IF  SC-STMT-SYM-SERV EQUAL TO 'SR'                    1105504
585966                MOVE 'ZA'           TO IMEX-CODE-2                1105504
585968            ELSE                                                  1105504
585970                MOVE 'H8'           TO IMEX-CODE-2                1105504
585972     ELSE                                                         1105504
585974         IF (WMS-NB-REL-IND EQUAL TO '0' OR ' ')                  1105504
585976            IF  SC-STMT-SYM-SERV EQUAL TO 'SR'                    1105504
585978                MOVE 'ZC'           TO IMEX-CODE-2                1105504
585980            ELSE                                                  1105504
585982                NEXT SENTENCE                                     1105504
585984         ELSE                                                     1105504
585986            IF  SC-STMT-SYM-SERV EQUAL TO 'SR'                    1105504
585988                MOVE 'ZA'           TO IMEX-CODE-2                1105504
585990            ELSE                                                  1105504
586000                MOVE 'H8'           TO IMEX-CODE-2.               1105504
586050     MOVE WMS-SERVICE-CHARGE-DATA TO EX14-SVC-CHG-INFO            IM003
586060                                     SAVE-EXC-14-REC.             IM003
586062     MOVE WS-ANC-CHARGE           TO EX14-SVC-ANC-CHG.            0516691
586064     MOVE SC-FEE-TYPE             TO EX14-SVC-FEE-TYPE.           0516691
586070     IF  WMS-EXT-SC-DATA-TRLR EQUAL '1'                           IM008
586080         MOVE WMS-EXTENDED-SERV-CHG-TRLR TO SAVE-EXT-SC-REC.      IM008
586086     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM008
586092         MOVE WMS-INT-AGGR-DAYS    TO SAVE-AGGR-DAYS              9916431
586093         MOVE WMS-INT-SC-AGGR-DAYS TO SAVE-SC-AGGR-DAYS           2016653
586094         MOVE WMS-INT-SC-AGGR-BAL  TO SAVE-INT-AGGR-BAL           9916431
586096         MOVE WMS-INT-SC-AGGR-COLL TO SAVE-INT-AGGR-COLL          2016683
586097         MOVE CMA-AGGR-DAYS        TO SAVE-CMA-AGGR-DAYS          2016683
586098         MOVE CMA-PAST-AGGR-DAYS   TO SAVE-CMA-PAST-AGGR.         2016683
586100     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
586105*                                                                 9915749
586110*----------------------------------------------------------------*9915749
586115*   DO NOT UPDATE DATE LAST SERVICE CHARGE IF STATUS EQUAL       *9915749
586120*   '06' OR '10' AND SERVICE CHARGE AMT EQUAL 0.00.              *9915749
586125*----------------------------------------------------------------*9915749
586130*                                                                 9915749
586135     IF ((WMS-STATUS EQUAL '06' OR '10')                          9915749
586140     AND (WMS-SERV-CHARGE NOT GREATER THAN +0.00))                9915749
586145         GO TO R4090-END-LOOP.                                    9915749
586147*                                                                 9915749
586150     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-SERV-CHG.             0266741
586156     MOVE WMS-DL-SERV-CHG-DA TO HOLD-DAY.                         0902940
586162     IF  SVCH-CYCLE-DAYX EQUAL ' '                                0902940
586168         ADD STMT-CYCLE-DAY TO HOLD-DAY9                          0902940
586174     ELSE                                                         0902940
586180         ADD SVCH-CYCLE-DAY TO HOLD-DAY9.                         0902940
586183*                                                                 9915749
586186     SUBTRACT +1 FROM HOLD-DAY9.                                  0902940
586192     MOVE HOLD-DAY TO WMS-DL-SERV-CHG-DA.                         0902940
586198*                                                                 9915749
586250**************  END OF ACCRUAL LOOP AREA  **************
586300*                                                                 9915749
586350 R4090-END-LOOP.
586355     MOVE WMS-IOD-TIS-AGGR-BAL  TO IOD-TIS-AGGR-BAL (ACCRUAL-DAY).1004015
586360     MOVE WMS-IOD-TIS-AGGR-DAYS TO IOD-TIS-AGGR-DAY (ACCRUAL-DAY).1004015
586365     MOVE WMS-IOD-TIS-EARN-INT  TO IOD-TIS-EARN-INT (ACCRUAL-DAY).1004015
586370     IF  WMS-SAVINGS-TRLR EQUAL '0'                               1004015
586375         GO TO R4091.                                             1004015
586380     MOVE WMS-INT-TIS-AGGR-BAL  TO SAV-TIS-AGGR-BAL (ACCRUAL-DAY).1004015
586385     MOVE WMS-INT-TIS-AGGR-DAYS TO SAV-TIS-AGGR-DAY (ACCRUAL-DAY).1004015
586390     MOVE WMS-INT-TIS-EARN-INT  TO SAV-TIS-EARN-INT (ACCRUAL-DAY).1004015
586395 R4091.                                                           1004015
586400     IF  HOLD-ACCRUAL-DAYS GREATER THAN +1
586450         SUBTRACT +1 FROM HOLD-ACCRUAL-DAYS
586460         MOVE +1             TO C-NO-DAYS                         0902213
586470         MOVE ACCRUAL-DATE   TO C-LOW-DATE                        0902213
586480         CALL 'SIDCHI'    USING C-DATE-WORK                       0902213
586490         MOVE C-HIGH-DATE    TO ACCRUAL-DATE                      0902213
586495         PERFORM ROLL-FUTURE-RATES THRU FUTURE-RATE-EXIT          1003625
586500         MOVE '1' TO AGGREGATE-LOOP-SW
586510         MOVE 'N' TO ACCR-SW                                      IM002
586520         PERFORM C2340 THRU C2340-EXIT                            IM002
586530         MOVE 'F' TO ACCR-SW                                      IM002
586550         PERFORM R4095-CHECK-AVAIL THRU R4095-EXIT                IM007
586620         GO TO R3775.                                             IM007
586650*--------------------------------------------------------------*  0902213
586680*    IF THE BALANCE HAS CHANGED SINCE ACCRUALS, RECALCULATE    *  0902213
586710*    THE DAILY ACCRUAL AMOUNT.                                 *  0902213
586740*--------------------------------------------------------------*  0902213
586800     IF  IOD-ACCRUE EQUAL '1'
586810     AND (WMS-IOD-RATE-PTR GREATER THAN +0                        1003612
586820     OR  WMS-HIFI-INDICATOR GREATER THAN +0)                      1003612
586850         MOVE 'N' TO IOD-FLAG
586900         PERFORM R3863-A THRU R3864
586950         MOVE 'F' TO IOD-FLAG.
587000     IF SAV-ACCRUE EQUAL '1'
587010     AND WMS-SAVINGS-TRLR EQUAL '1'                               1003612
587050         PERFORM R3861 THRU R3864.
587070     MOVE 'F' TO CLEAR-SAV-CY-SW.                                 IM002
587071     GO TO R4100.                                                 IM007
587073     SKIP3                                                        IM007
587076 R4095-CHECK-AVAIL.                                               IM007
587079******************************************************************IM007
587080***  ONLY ROLL AVAILABILITY FOR CALENDAR DAYS OR FOR MULTIPLE  ***IM007
587081***  BUSINESS DAYS ON ACCOUNTS SUBJECT TO REG CC.              ***IM007
587082******************************************************************IM007
587087     IF  WBC-FLOAT-FLAG EQUAL TO 'P'                              0266741
587088         IF  NON-EFAA-ACCOUNT EQUAL '1'                           IM007
587089             GO TO R4095-EXIT.                                    IM007
587090     IF  NON-EFAA-ACCOUNT EQUAL '0'                               IM007
587091         IF  WORK-BUSINESS-DAYS NOT GREATER THAN +0               IM007
587092             GO TO R4095-EXIT.                                    IM007
587093     SUBTRACT +1 FROM WORK-BUSINESS-DAYS.                         IM007
587094     PERFORM C2430 THRU C2447-EXIT.                               IM007
587095     PERFORM X4000-ROLL-CHECK THRU X4045-EXIT.                    IM008
587096 R4095-EXIT. EXIT.                                                IM007
587100     SKIP3
587150*    ********  AMOUNT TRANSFER TRAILER PROCESSING  *********
587200     SKIP1
587250 R4100.
587300     IF  WMS-STATUS EQUAL '05' OR '08',  GO  TO  R5000.           IM007
587350     IF WMS-TRNSFR-AFFL-TRLR EQUAL TO ZERO, GO TO R4280.
587400     IF  WMS-STATUS EQUAL '01'                                    0902008
587405     OR  WMS-HOLD-ALL-FUNDS-FLAG EQUAL '1'                        0902008
587410     OR  (WMS-HOLD-ALL-FUNDS-FLAG EQUAL '2'                       0902008
587420     AND  WBC-ONLINE-HOLD-FLAG EQUAL '0')                         0266741
587440         GO  TO  R4280.                                           0902008
587450     SKIP3
587500 AMT-TRNF-SECT-A     SECTION 31.
587550     SKIP3
587600 R4101.
587650     MOVE +1 TO X.
587700     MOVE WBC-CAPTURE-DA TO WORK-XFER-DA-1.                       0266741
587710     MOVE WBC-CAPTURE-MO TO WORK-XFER-MO-1.                       0266741
587720     MOVE WBC-CAPTURE-YR TO WORK-XFER-YR-1.                       0266741
587730     MOVE WBC-NEXT-PROC-DA TO WORK-XFER-DA-3.                     0266741
587740     MOVE WBC-NEXT-PROC-MO TO WORK-XFER-MO-3.                     0266741
587750     MOVE WBC-NEXT-PROC-YR TO WORK-XFER-YR-3.                     0266741
587760     IF  WORK-XFER-YR-1 LESS THAN WBC-NEXT-CENT-YR                0266741
587765         MOVE '20' TO WORK-XFER-CENT-1                            1004775
587770     ELSE                                                         1004775
587875         MOVE '19' TO WORK-XFER-CENT-1.                           1004775
587880                                                                  1004775
587885     IF  WORK-XFER-YR-3 LESS THAN WBC-NEXT-CENT-YR                0266741
587890         MOVE '20' TO WORK-XFER-CENT-3                            1004775
587895     ELSE                                                         1004775
587900         MOVE '19' TO WORK-XFER-CENT-3.                           1004775
588050 R4107.
588100     IF  WMS-TRNSFR-AFFL-FLAG (X) EQUAL 'A'
588150         GO  TO  R4260.
588200     MOVE WMS-EFFECTIVE-DA (X) TO WORK-XFER-DA-2.                 IM006
588210     MOVE WMS-EFFECTIVE-MO (X) TO WORK-XFER-MO-2.                 IM006
588220     MOVE WMS-EFFECTIVE-YR (X) TO WORK-XFER-YR-2.                 IM006
588230     MOVE WMS-EFFECTIVE-CENT (X) TO WORK-XFER-CENT-2.             IM006
588240     IF  WORK-XFER-DATE-2 EQUAL SPACES                            IM006
588300         GO TO R4110.
588350     IF  WORK-XFER-DATE-2 GREATER THAN WORK-XFER-DATE-3           IM006
588500         GO TO R4260.
588550 R4110.
588600     MOVE WMS-EXPIRATION-DA (X) TO WORK-XFER-DA-2.                IM006
588610     MOVE WMS-EXPIRATION-MO (X) TO WORK-XFER-MO-2.                IM006
588620     MOVE WMS-EXPIRATION-YR (X) TO WORK-XFER-YR-2.                IM006
588630     MOVE WMS-EXPIRATION-CENT (X) TO WORK-XFER-CENT-2.            IM006
588640     IF  WORK-XFER-DATE-2 EQUAL TO SPACES                         IM006
588650         GO TO R4120.                                             IM006
588660     IF  WORK-XFER-DATE-2 GREATER THAN WORK-XFER-DATE-1           IM006
588670         GO TO R4150.                                             0903028
588850     GO TO R4140.
588900 R4120.
588950     IF WMS-ORIGINAL-NO (X) EQUAL TO ZERO, GO TO R4150.
589000     IF WMS-REMAINING-NO (X) GREATER THAN ZERO, GO TO R4150.
589050 R4140.
589100     MOVE X TO W.
589150     MOVE HIGH-VALUE TO WMS-LINK-DELETE (X).
589200     PERFORM R0035 THRU R0048.
589250*  --ABOVE PERFORM DELETES TRAILER FROM MASTER
589300     MOVE W TO X.
589350     MOVE '11' TO IMEX-REC-NO.
589400     MOVE 'C5C7' TO IMEX-EX-CODE.
589450     MOVE 'S' TO EX11-CODE.
589500     MOVE 'T' TO EX11-TYP.
589550     MOVE X TO EX11-NO.
589600     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
589650     IF WMS-TRAILERS EQUAL TO NO-TRAILERS
589670     AND WMS-DC-TRLR  EQUAL TO '0'                                9915845
589700         MOVE '0' TO WMS-EXPANSION-IND
589750     ELSE MOVE '1' TO WMS-EXPANSION-IND.
589800     GO TO R4270.
589850 R4150.
589860     MOVE WBC-NEXT-CAPTURE-MO TO HOLD-MO.                         0266741
589900     MOVE WMS-LINKAGE-SCHEDULE (X) TO TRLR-SCHD-HOLD.
589950     IF TRLR-CODE EQUAL TO 'E'
590000         IF WBC-NEXT-MONTH-END EQUAL TO '1'                       0266741
590050             GO TO R4200
590100         ELSE GO TO R4260.
590150     IF TRLR-CODE EQUAL TO 'D', GO TO R4200.
590200     MOVE '0' TO CALC-FLAG.
590250     IF TRLR-CODE NOT EQUAL TO 'M', GO TO R4170.
590300     MOVE TRLR-DAY1 TO HOLD-DAY.
590350 R4160.
590400     MOVE +0 TO Y, Z.                                             1003844
590410                                                                  1003844
590450 R4161.                                                           1003844
590500     ADD +1 TO Y.                                                 1003844
590550     IF  Y GREATER THAN +8                                        1003844
590560     OR  WBC-NEXT-CAL (Y) EQUAL HIGH-VALUES                       0266741
590600         GO TO R4164.                                             1003844
590650     IF  HOLD-DAY NOT EQUAL WBC-NEXT-CAL (Y)                      0266741
590700         GO TO R4161.                                             1003844
590710     MOVE '1' TO CALC-FLAG.                                       1003844
590720     IF  WBC-CAPTURE-MO EQUAL WBC-NEXT-CAPTURE-MO                 0266741
590730         GO TO R4164.                                             1003844
590740     MOVE WBC-NEXT-CAL (1) TO HOLD-NEXT-DAY.                      0266741
590750                                                                  1003844
590760 R4162.                                                           1003844
590770     ADD +1 TO Z.                                                 1003844
590780     IF  Z GREATER THAN +8                                        1003844
590790     OR  WBC-NEXT-CAL (Z) EQUAL HIGH-VALUES                       0266741
590800         GO TO R4164.                                             1003844
590810     IF  WBC-NEXT-CAL (Z) NOT LESS THAN HOLD-NEXT-DAY             0266741
590815         MOVE WBC-NEXT-CAL (Z) TO HOLD-NEXT-DAY                   0266741
590820         GO TO R4162.                                             1003844
590830     IF  Y LESS THAN Z                                            1003844
590840         MOVE WBC-CAPTURE-MO TO HOLD-MO.                          0266741
590850 R4164.  EXIT.
590900 R4165.
590950     IF CALC-FLAG EQUAL TO '1', GO TO R4200.
591000     IF TRLR-DAY2 NOT EQUAL TO SPACES
591050         MOVE TRLR-DAY2 TO HOLD-DAY
591100         PERFORM R4160 THRU R4164
591150         IF CALC-FLAG EQUAL TO '1'
591200             GO TO R4200.
591250     GO TO R4260.
591300 R4170.
591350     IF TRLR-CODE NOT EQUAL TO 'B', GO TO R4180.
591400     MOVE TRLR-DAY1 TO HOLD-DAY.
591410 R4171.                                                           1003844
591420     MOVE +0 TO Y, Z.                                             1003844
591430                                                                  1003844
591450 R4172.
591500     ADD +1 TO Y.                                                 1003844
591550     IF  Y GREATER THAN +6                                        1003844
591560     OR  WBC-NEXT-BANK (Y) EQUAL HIGH-VALUES                      0266741
591600         GO TO R4174.                                             1003844
591650     IF  HOLD-DAY NOT EQUAL WBC-NEXT-BANK (Y)                     0266741
591700         GO TO R4172.                                             1003844
591710     MOVE '1' TO CALC-FLAG.                                       1003844
591720     IF  WBC-CAPTURE-MO EQUAL WBC-NEXT-CAPTURE-MO                 0266741
591730         GO TO R4174.                                             1003844
591740     MOVE WBC-NEXT-BANK (1) TO HOLD-NEXT-DAY.                     0266741
591750                                                                  1003844
591760 R4173.                                                           1003844
591770     ADD +1 TO Z.                                                 1003844
591780     IF  Z GREATER THAN +6                                        1003844
591790     OR  WBC-NEXT-BANK (Z) EQUAL HIGH-VALUES                      0266741
591800         GO TO R4174.                                             1003844
591810     IF  WBC-NEXT-BANK (Z) NOT LESS THAN HOLD-NEXT-DAY            0266741
591815         MOVE WBC-NEXT-BANK (Z) TO HOLD-NEXT-DAY                  0266741
591820         GO TO R4173.                                             1003844
591830     IF  Y LESS THAN Z                                            1003844
591840         MOVE WBC-CAPTURE-MO TO HOLD-MO.                          0266741
591850 R4174.  EXIT.
591900 R4175.
591950     IF CALC-FLAG EQUAL TO '1', GO TO R4200.
592000     IF TRLR-DAY2 NOT EQUAL TO SPACES
592050         MOVE TRLR-DAY2 TO HOLD-DAY
592100         PERFORM R4171 THRU R4174                                 1003844
592150         IF CALC-FLAG EQUAL TO '1'
592200             GO TO R4200.
592250     GO TO R4260.
592300 R4180.
592350     IF TRLR-CODE NOT EQUAL TO 'W', GO TO R4190.
592400     MOVE TRLR-DAY1 TO HOLD-X.
592450 R4182.
592500     IF HOLD-X2  EQUAL TO WBC-NEXT-WK-DAY (1) OR                  0266741
592550                          WBC-NEXT-WK-DAY (2) OR                  0266741
592600                          WBC-NEXT-WK-DAY (3) OR                  0266741
592650                          WBC-NEXT-WK-DAY (4) OR                  0266741
592700                          WBC-NEXT-WK-DAY (5) OR                  0266741
592750                          WBC-NEXT-WK-DAY (6)                     0266741
592800         MOVE '1' TO CALC-FLAG.
592850 R4182-EXIT.
592900     EXIT.
592950 R4183.
593000     IF  TRLR-F1 EQUAL '1'
593050         GO TO R4184.
593100     IF CALC-FLAG EQUAL '1'
593150         IF  WMS-WEEK-CNTR (X) EQUAL TRLR-F1
593200             MOVE +1 TO WMS-WEEK-CNTR (X)
593250             GO TO R4220
593300         ELSE
593350             ADD +1 TO WMS-WEEK-CNTR (X)
593400             MOVE '0' TO CALC-FLAG
593450             GO TO R4260.
593500 R4184.  EXIT.
593550 R4185.
593600     IF  CALC-FLAG EQUAL '1'
593650         PERFORM R4220.
593700     MOVE '0' TO CALC-FLAG.
593750     IF TRLR-DAY2 NOT EQUAL TO SPACES
593800         MOVE TRLR-DAY2 TO HOLD-X
593850         PERFORM R4182 THRU R4182-EXIT
593900         IF CALC-FLAG EQUAL TO '1'
593950             GO TO R4220.
594000     GO TO R4260.
594050 R4190.
594100     IF TRLR-CODE NOT EQUAL TO 'O', GO TO R4260.
594150     MOVE TRLR-DAY1-2 TO HOLD-X1.
594200     MOVE TRLR-DAY2-2 TO HOLD-X2.
594210 R4191.                                                           1003844
594220     MOVE +0 TO Y, Z.                                             1003844
594230                                                                  1003844
594250 R4192.
594300     ADD +1 TO Y.                                                 1003844
594350     IF  Y GREATER THAN +6                                        1003844
594360     OR  WBC-NEXT-WEEK (Y) EQUAL HIGH-VALUES                      0266741
594400         GO TO R4194.                                             1003844
594450     IF  HOLD-X NOT EQUAL WBC-NEXT-WEEK (Y)                       0266741
594500         GO TO R4192.                                             1003844
594510     MOVE '1' TO CALC-FLAG.                                       1003844
594520     IF  WBC-CAPTURE-MO EQUAL WBC-NEXT-CAPTURE-MO                 0266741
594530         GO TO R4194.                                             1003844
594540     MOVE WBC-NEXT-WEEK (1) TO HOLD-NEXT-DAY.                     0266741
594550                                                                  1003844
594560 R4193.                                                           1003844
594570     ADD +1 TO Z.                                                 1003844
594580     IF  Z GREATER THAN +6                                        1003844
594590     OR  WBC-NEXT-WEEK (Z) EQUAL HIGH-VALUES                      0266741
594600         GO TO R4194.                                             1003844
594610     IF  WBC-NEXT-WEEK (Z) NOT LESS THAN HOLD-NEXT-DAY            0266741
594615         MOVE WBC-NEXT-WEEK (Z) TO HOLD-NEXT-DAY                  0266741
594620         GO TO R4193.                                             1003844
594630     IF  Y LESS THAN Z                                            1003844
594640         MOVE WBC-CAPTURE-MO TO HOLD-MO.                          0266741
594650 R4194.  EXIT.
594700 R4195.
594750     IF  CALC-FLAG NOT EQUAL '1'
594800         GO TO R4260.
594850 R4200.
594900     MOVE TRLR-F1 TO HOLD-NO3.
594950     MOVE '0' TO TRLR-F1.
595000 R4210.
595050     IF  HOLD-MO EQUAL TRLR-F                                     1003844
595055         GO TO R4220.                                             1003844
595100     ADD HOLD-NO3 TO TRLR-FREQ.
595150     IF TRLR-F GREATER THAN '12', GO TO R4260.
595200     GO TO R4210.
595250 R4220.
595300     MOVE '08' TO IMEX-REC-NO.
595350     MOVE 'I1' TO IMEX-CODE-1.
595400     MOVE WMS-LINK-SYS-ID (X) TO IMEX-CODE-2.
595450     MOVE WMS-LINKAGE-CNTL (X) TO EX08-CNTL.
595500     MOVE WMS-TRANSFER-AMT (X) TO EX08-END-BAL.
595550     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
595600     IF WMS-REMAINING-NO (X) GREATER THAN ZERO
595650         SUBTRACT +1 FROM WMS-REMAINING-NO (X).
595750 R4260.
595800     ADD +1 TO X.
595850 R4270.
595900     IF X GREATER THAN WMS-TRNSFR-AFFL-TRLR, GO TO R4280.
595950     GO TO R4107.
596000     SKIP3
596050 ROOT-SECTION-G1     SECTION 01.
596100     SKIP3
596150 ROOT-SECTION-X      SECTION 1.
596200     SKIP3
596250 R4280.
596300     IF  WMS-DC-TRLR NOT EQUAL TO '1'
596350         GO  TO  R4299-EXIT.                                      IM003
596400     SKIP3
596450 TRLR-SECTION-G      SECTION 1.
596500     SKIP3
596550 R4285.
596600******************************************************************
596690***  THE FOLLOWING USER EXIT MAY BE USED TO MASTER PROCESSING     IM002
596780***  IN THE DATA CENTER TRAILER.                                  IM002
596870***                                                               IM002
596960***  COPY IM31UBWR.                                               IM002
597050***                                                               IM002
597140***  END OF USER EXIT.                                            IM002
597230******************************************************************IM002
597700 R4299-EXIT. EXIT.
597750     SKIP3
597800 ROOT-SECTION-T      SECTION 1.
597850     SKIP3
597900 R4300.
597950     IF  WMS-MARKET-TRLR NOT EQUAL '1', GO TO R4500.              0617360
598000     SKIP3
598050 TRLR-SECTION-B      SECTION 46.
598100     SKIP3
598150*    ***********  MARKETING TRAILER PROCESSING  ************
598200     SKIP1
598250 R4305.
598300     IF WMS-CURR-BAL EQUAL TO ACCT-BAL-IN, GO TO R4380.
598350     SUBTRACT ACCT-BAL-IN FROM WMS-CURR-BAL GIVING HOLD-AMT.
598400     IF WMS-MKT-BAL-CHANGE EQUAL TO '0'
598450         GO  TO  R4380.
598500     IF WMS-MKT-BAL-CHANGE EQUAL TO '1'
598550         IF HOLD-AMT LESS THAN ZERO
598600             GO TO R4310
598650         ELSE GO TO R4380.
598700     IF WMS-MKT-BAL-CHANGE EQUAL TO '2'
598750         IF HOLD-AMT GREATER THAN ZERO
598800             GO TO R4310
598850         ELSE GO TO R4380.
598900*  --AT THIS POINT, 'WMS-MKT-BAL-CHANGE' MUST BE '3'
598950 R4310.
599000     IF HOLD-AMT LESS THAN ZERO
599050         MOVE WMS-PCT-DOWN TO HOLD-AMT5
599100         MOVE WMS-AMT-DOWN TO HOLD-AMT11
599150         MULTIPLY -1 BY HOLD-AMT
599200     ELSE
599250         MOVE WMS-PCT-UP TO HOLD-AMT5
599300         MOVE WMS-AMT-UP TO HOLD-AMT11.
599350     MULTIPLY HOLD-AMT5 BY WMS-CURR-BAL GIVING HOLD-AMT13.
599400     IF HOLD-AMT11 LESS THAN HOLD-AMT13
599450         MOVE HOLD-AMT11 TO HOLD-AMT13.
599500 R4320.
599550     IF HOLD-AMT LESS THAN HOLD-AMT13, GO TO R4380.
599600     MOVE '02' TO IMEX-REC-NO.
599650     MOVE 'I6' TO IMEX-CODE-1.
599700     MOVE ACCT-BAL-IN TO EX02-BAL.
599750     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
599800     ADD +1 TO WMS-MRKT-BAL-COUNT.
599850*  --THE NEXT FOUR PARAGRAPHS PROCESS THE MARKETING CALL SCHEDULE.
599900 R4380.
599950     IF  WMS-CALL-CODE EQUAL '0'
600000         IF  WMS-MRKT-DATE-NEXT-CALL EQUAL SPACES
600050             GO  TO  R4490                                        0617360
600100         ELSE
600150             MOVE SPACES TO WMS-MRKT-DATE-NEXT-CALL
600200             GO  TO  R4490.                                       0617360
600250     IF  WMS-MRKT-DATE-NEXT-CALL EQUAL SPACES
600300         MOVE ZEROS TO WMS-MRKT-DATE-NEXT-CALL
600350         GO TO R4440.
600400     IF  WMS-MRKT-DATE-NEXT-CALL EQUAL ZERO
600450         GO TO R4440.
600500     IF  WMS-CURR-CALLS NOT LESS THAN WMS-SCHED-NO
600550         MOVE ZEROS TO WMS-MRKT-DATE-NEXT-CALL
600600         GO  TO  R4490.                                           0617360
600650     MOVE WBC-PROC-THRU-MO TO D1-MO.                              0266741
600700     MOVE WBC-PROC-THRU-DA TO D1-DA.                              0266741
600750     MOVE WBC-PROC-THRU-YR TO D1-YR.                              0266741
600760     IF  D1-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
600770         MOVE '19' TO D1-CC                                       1105729
600780     ELSE                                                         1105729
600790         MOVE '20' TO D1-CC.                                      1105729
600800     MOVE WMS-MRKT-NEXT-CALL-MO TO D2-MO.
600850     MOVE WMS-MRKT-NEXT-CALL-DA TO D2-DA.
600900     MOVE WMS-MRKT-NEXT-CALL-YR TO D2-YR.
600910     IF  D2-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
600920         MOVE '19' TO D2-CC                                       1105729
600930     ELSE                                                         1105729
600940         MOVE '20' TO D2-CC.                                      1105729
600950     IF  DATE-2 GREATER THAN DATE-1
601000         GO  TO  R4490.                                           0617360
601050     IF  WMS-CALL-CODE EQUAL 'M'
601100         MOVE WMS-MRKT-DATE-NEXT-CALL TO DT-LOW-DATE
601150         MOVE WMS-MAX-PERIOD TO RET-DAYS
601200         GO TO R4420.
601250     IF  WMS-CALL-CODE EQUAL 'A'
601300         MOVE WMS-MRKT-DATE-NEXT-CALL TO DT-LOW-DATE
601350         MOVE +12 TO RET-DAYS
601400     SKIP3
601450         GO TO R4420.
601500     IF  WMS-CALL-CODE EQUAL 'S'
601550         MOVE WMS-MRKT-DATE-NEXT-CALL TO DT-LOW-DATE
601600         MOVE WMS-MAX-PERIOD TO RET-DAYS.
601650 R4400.
601700     CALL 'SIDHI' USING DATE-AREA.
601750     MOVE DT-HIGH-DATE TO WMS-MRKT-DATE-NEXT-CALL.
601800     ADD +1 TO WMS-CURR-CALLS.
601850     GO TO R4440.
601900 R4420.
601950     CALL 'SIDMHI' USING DATE-AREA.
602000     MOVE DT-HIGH-DATE TO WMS-MRKT-DATE-NEXT-CALL.
602050     ADD +1 TO WMS-CURR-CALLS.
602100 R4440.
602150     MOVE '02' TO IMEX-REC-NO.
602200     MOVE 'RM' TO IMEX-CODE-1.
602250     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
602300     IF  WMS-CURR-CALLS EQUAL TO WMS-SCHED-NO AND
602350         WMS-MRKT-DATE-NEXT-CALL NOT EQUAL ZERO
602400         MOVE ZERO TO WMS-MRKT-DATE-NEXT-CALL
602450         MOVE '02' TO IMEX-REC-NO
602500         MOVE 'RO' TO IMEX-CODE-1
602550         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
602556 R4490.                                                           0617360
602562     IF  WMS-MKT-ANALYSIS-CODE EQUAL SPACE                        IM006
602568         GO TO R4500.                                             0617360
602574     MOVE '17' TO IMEX-REC-NO.                                    IM006
602580     MOVE 'M1' TO IMEX-CODE-1.                                    IM006
602586     MOVE '  ' TO IMEX-CODE-2.                                    IM006
602592     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     IM006
602600     SKIP3
602602**************  PLAN PROCESSING AREA  **********                  0617360
602604     SKIP1                                                        0617360
602606 ROOT-SECTION-Y      SECTION 1.                                   0617360
602608     SKIP3                                                        0617360
602610 R4500.                                                           0617360
602612     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
602614         GO TO R4600.                                             0617360
602616     COPY IMPD31PL.                                               0617360
602618     SKIP3                                                        0617360
602650***************  CMA SWEEP AREA  ***************
602700     SKIP1
602750 ROOT-SECTION-R      SECTION 1.
602800     SKIP3
602850 R4600.
602852     IF  BYPASS-ACTIVITY-SW EQUAL '1',  GO  TO  R5000.            0737689
602900     IF  WMS-SAVINGS-TRLR EQUAL '0'
602950     OR  WMS-INT-STATUS GREATER THAN '6'
603000     OR  WMS-CMA-INDICATOR EQUAL '0'
603050         GO  TO  R4690-EXIT.                                      IM004
603060     IF  WMS-CMA-BALANCE-USE EQUAL '0'                            2016683
603065         PERFORM R4650 THRU R4655                                 2016683
603066         GO TO R4690-EXIT.                                        2016683
603070 R4605.                                                           IM004
603100*----------------------------------------------------------------*9915749
603105*    COMMERCIAL SWEEP PROCESSING.                                *9915749
603110*    BYPASS PROCESSING IF WMS-MIN-BAL EQUALS ALL 9'S             *9915749
603115*    BYPASS PROCESSING IF WMS-PRIN-BAL GREATER THAN 0.00         *9915749
603120*    FOR AUTOBORROW ACCOUNTS.                                    *9915749
603125*----------------------------------------------------------------*9915749
603130     PERFORM R3864-A THRU R3864-AX.                               9915749
603135     IF  WMS-NB-SWP-MIN EQUAL +9999999999999.99                   9915845
603140         MOVE +0 TO HOLD-AMT                                      9915749
603145         GO TO R4690-EXIT.                                        9915749
603150     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915749
603155     AND WMS-NB-DC-ABM EQUAL '1'                                  9915749
603160         IF WMS-PRIN-BAL GREATER THAN +0.00                       9915749
603165             MOVE +0 TO HOLD-AMT                                  9915749
603170             GO TO R4620.                                         9915749
603300     MOVE WMS-CMA-NXT-SWP-MO TO D2-MO.
603350     MOVE WMS-CMA-NXT-SWP-DA TO D2-DA.
603400     MOVE WMS-CMA-NXT-SWP-YR TO D2-YR.
603410     IF  D2-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
603420         MOVE '19' TO D2-CC                                       1105729
603430     ELSE                                                         1105729
603440         MOVE '20' TO D2-CC.                                      1105729
603450     MOVE WBC-LAST-PROC-MO TO D1-MO.                              0266741
603500     MOVE WBC-LAST-PROC-DA TO D1-DA.                              0266741
603550     MOVE WBC-LAST-PROC-YR TO D1-YR.                              0266741
603560     IF  D1-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
603570         MOVE '19' TO D1-CC                                       1105729
603580     ELSE                                                         1105729
603590         MOVE '20' TO D1-CC.                                      1105729
603600     MOVE WBC-PROC-THRU-MO TO D3-MO.                              0266741
603650     MOVE WBC-PROC-THRU-DA TO D3-DA.                              0266741
603700     MOVE WBC-PROC-THRU-YR TO D3-YR.                              0266741
603710     IF  D3-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
603720         MOVE '19' TO D3-CC                                       1105729
603730     ELSE                                                         1105729
603740         MOVE '20' TO D3-CC.                                      1105729
603750     IF  DATE-2 GREATER THAN DATE-1 AND
603800         DATE-2 NOT GREATER THAN DATE-3
603850         NEXT SENTENCE
603900     ELSE
603950         GO  TO  R4650.
604000 R4610.
604010*----------------------------------------------------------------*9915749
604011*    EXCLUDE AUTOBORROW ACCOUNTS.                                *9915749
604012*----------------------------------------------------------------*9915749
604050     IF  WMS-LOAN-TRLR EQUAL '1'                                  1105504
604060     AND WMS-NB-DC-ABM NOT EQUAL '1'                              9915749
604100         PERFORM R3670 THRU R3674
604150         MOVE '1' TO WMS-PYMT-CLEAR
604200         ADD WMS-PRIN-BAL, WMS-INTRST-BAL, WMS-OTHER-CHGS
604250             GIVING HOLD-AMT11
604300         SUBTRACT HOLD-AMT11 FROM WMS-CURR-BAL GIVING HOLD-AMT13
604305         MOVE HOLD-AMT11         TO  WMS-PYMT-DUE-AMT             1002953
604307         MOVE ZERO               TO  WMS-PAST-DUE-AMT             9715448
604308                                     WMS-PAST-DUE                 9715448
604309         MOVE SPACES             TO  WMS-PAST-DUE-DATE            9715448
604310         MOVE WMS-PYMT-DUE-AMT   TO  WMS-BILL-DUE-AMT (1)         1002953
604312         MOVE ZERO               TO  WMS-BILL-DUE-STAT (1)        9715448
604315         MOVE WBC-CAPTURE-MO     TO  WMS-BILL-DUE-MO  (1)         0266741
604320         MOVE WBC-CAPTURE-DA     TO  WMS-BILL-DUE-DA  (1)         0266741
604325         MOVE WBC-CAPTURE-YR     TO  WMS-BILL-DUE-YR  (1)         0266741
604330         IF  WMS-BILL-DUE-YR (1) LESS THAN WBC-NEXT-CENT-YR       0266741
604335             MOVE '20'           TO  WMS-BILL-DUE-CENT (1)        1002953
604340         ELSE                                                     1002953
604345             MOVE '19'           TO  WMS-BILL-DUE-CENT (1)        1002953
604400     ELSE                                                         1002953
604405         MOVE WMS-CURR-BAL TO HOLD-AMT13.                         1002953
604450     IF  WMS-CMA-BAL-CALC EQUAL '2' OR '5' OR '6'
604500         SUBTRACT WMS-HOLD-AMT FROM HOLD-AMT13.
604550     IF  WMS-CMA-BAL-CALC EQUAL '3' OR '5'
604600         SUBTRACT WMS-BANK-AVAIL-AMT FROM HOLD-AMT13.             IM007
604650     IF  WMS-CMA-BAL-CALC EQUAL '4' OR '6'
604700         SUBTRACT WMS-CUST-AVAIL-AMT FROM HOLD-AMT13.             IM007
604710*----------------------------------------------------------------*9915749
604711*    COMMERCIAL SWEEP PROCESSING.                                *9915749
604712*    COMPUTE A NEW MAX-BAL EACH PROCESSING DAY.                  *9915749
604713*----------------------------------------------------------------*9915749
604715*    COMPUTE WMS-DDA-MAX-BAL = WMS-MIN-BAL + WMS-NB-SWP-MIN.      9915749
604720     IF  WMS-CMA-SWEEP-IND EQUAL 'H'                              9916072
604725         MOVE WMS-DDA-MAX-BAL TO HOLD-AMT15                       9916072
604730     ELSE                                                         9916072
604735         MOVE WMS-MIN-BAL     TO HOLD-AMT15.                      9916072
604736     SUBTRACT WMS-INT-CUR-BAL FROM HOLD-AMT13 GIVING HOLD-CMA-AMT.9916305
604737     IF  WMS-CMA-SWEEP-IND EQUAL 'H'                              9916305
604738     AND HOLD-CMA-AMT NOT LESS THAN WMS-MIN-BAL                   9916305
604739     AND HOLD-CMA-AMT NOT GREATER THAN WMS-DDA-MAX-BAL            9916305
604740         GO TO R4630.                                             9916305
604750     IF  HOLD-AMT13 LESS THAN WMS-DDA-MAX-BAL
604800         MOVE +0 TO HOLD-AMT
604820         GO TO R4620                                              IM008
604850     ELSE
604900         SUBTRACT HOLD-AMT15 FROM HOLD-AMT13 GIVING HOLD-AMT.     9916072
604902     IF  WMS-CMA-INCR-PTR EQUAL +0                                IM008
604904         GO TO R4620.                                             IM008
604906     MOVE WMS-CMA-INCR-PTR TO X.                                  IM008
604908     IF  WBC-CMA-INCR (X) EQUAL ZEROES                            0266741
604910         GO TO R4620.                                             IM008
604912     MOVE HOLD-AMT TO HOLD-AMT-INCR.                              IM008
604914     DIVIDE WBC-CMA-INCR (X) INTO HOLD-AMT-INCR                   0266741
604916         GIVING INCR-TIMES                                        IM008
604918             REMAINDER HOLD-AMT-EXCESS.                           IM008
604920     IF  INCR-TIMES EQUAL ZEROES                                  IM008
604922         MOVE +0 TO HOLD-AMT                                      IM008
604924         GO TO R4620                                              IM008
604926     ELSE                                                         IM008
604928         SUBTRACT HOLD-AMT-EXCESS FROM HOLD-AMT-INCR              IM008
604930         MOVE ZEROES TO HOLD-AMT                                  IM008
604932         ADD HOLD-AMT-INCR TO HOLD-AMT.                           IM008
604934 R4620.                                                           IM008
604940*----------------------------------------------------------------*9915749
604941*    FOR COMMERCIAL SWEEP PROCESSING, COMMENT SUBTRACT STATEMENT *9915749
604942*    (604950) AND COMMENT CYCLE AND MTD ACCUMULATORS (605200-    *9915749
604943*    605350).                                                    *9915749
604944*----------------------------------------------------------------*9915749
604950     SUBTRACT WMS-INT-CUR-BAL FROM HOLD-AMT.
605000     IF  HOLD-AMT POSITIVE
605050         SUBTRACT HOLD-AMT FROM TRANSFER-AMT
605100                                WMS-DDA-BAL
605150         ADD HOLD-AMT TO WMS-INT-CUR-BAL
605200                         WMS-DDA-MAX-CYCLE-AMT
605250                         WMS-DDA-MAX-MTD-AMT
605300         ADD +1 TO WMS-DDA-MAX-CYCLE-NO
605350                   WMS-DDA-MAX-MTD-NO
605400     ELSE
605450         SUBTRACT HOLD-AMT FROM TRANSFER-AMT
605600                                WMS-DDA-BAL
605650         ADD HOLD-AMT TO WMS-INT-CUR-BAL.
605652     IF  WMS-INT-CUR-BAL NEGATIVE                                 9916490
605654         ADD WMS-INT-CUR-BAL TO WMS-DDA-BAL                       9916490
605656                                TRANSFER-AMT                      9916490
605658         MOVE +0             TO WMS-INT-CUR-BAL.                  9916490
605661*----------------------------------------------------------------*9915749
605662*    COMMERCIAL SWEEP PROCESSING.                                *9915749
605663*    DO NOT ALLOW ACCOUNT TO ACCRUE INTEREST ON CMA.             *9915749
605664*    INSERT THE FOLLOWING LINE:                                  *9915749
605665*    PERFORM R4660 THRU R4660-X.                                 *9915749
605666*    AND COMMENT OUT 605700-605900                               *9915749
605667*----------------------------------------------------------------*9915749
605670 R4630.                                                           9916072
605700     IF  WMS-IOD-RATE-PTR GREATER THAN +0
605750     OR  WMS-HIFI-INDICATOR GREATER THAN +0
605800         MOVE 'N' TO IOD-FLAG
605850         PERFORM R3863-A THRU R3864.
605900     PERFORM R3861 THRU R3864.
605950     IF  WMS-LOAN-TRLR EQUAL '1' AND
606000         WMS-LOAN-LINE-PCT NOT EQUAL ZEROES
606050         MULTIPLY WMS-INT-CUR-BAL BY WMS-LOAN-LINE-PCT
606100             GIVING WMS-CREDIT-LIMIT
606150         PERFORM CALC-AVAIL-BAL THRU CALC-AVAIL-EXIT.
606200     MOVE WMS-CMA-NEXT-SWEEP-DATE TO DT-LOW-DATE.
606250     MOVE WMS-CMA-FREQ-INCR TO RET-DAYS.
606300     MOVE '1' TO SWEEP-TODAY.
606350     IF  WMS-CMA-FREQ-CODE EQUAL 'D'
606400         IF  WMS-CMA-FREQ-INCR EQUAL +1
606420             MOVE WBC-NEXT-CAPTURE-DATE TO WMS-CMA-NEXT-SWEEP-DATE0266741
606450             GO  TO  R4650
606500         ELSE
606550             CALL 'SIDHI' USING DATE-AREA
606600     ELSE
606650     IF  WMS-CMA-FREQ-CODE EQUAL 'M'
606700         CALL 'SIDMHI' USING DATE-AREA
606750     ELSE
606800     IF  WMS-CMA-FREQ-CODE EQUAL 'E'
606850         MOVE '31' TO DT-L-DA
606900         CALL 'SIDMHI' USING DATE-AREA.
606950     MOVE DT-HIGH-DATE TO WMS-CMA-NEXT-SWEEP-DATE.
606956                                                                  IM008
606962*----------------------------------------------------------------*IM008
606968*    R4650 WILL PROCESS A LOAN AUTOMATIC PAYMENT IF FUNDS ARE    *IM008
606974*    AVAILABLE.  ALSO, LOAN ACCRUALS FOR CASH MANAGEMENT ACCOUNTS*IM008
606980*    WILL BE CALCULATED.  LOAN ACCRUALS ARE DONE HERE TO REFLECT *IM008
606986*    THE BALANCE CHANGE DUE TO THE AUTOMATIC PAYMENT.            *IM008
606992*----------------------------------------------------------------*IM008
607000 R4650.
607010     COMPUTE WMS-INT-SC-AGGR-BAL = WMS-INT-SC-AGGR-BAL +          2016683
607011            (WMS-INT-CUR-BAL * CMA-AGGR-DAYS) +                   2016683
607012            (WMS-PREV-INT-BAL * CMA-PAST-AGGR-DAYS).              2016683
607013     COMPUTE SAVE-CUR-BAL = (WMS-INT-CUR-BAL * CMA-AGGR-DAYS)     2016683
607014                        + (WMS-PREV-INT-BAL * CMA-PAST-AGGR-DAYS) 2016683
607015                        - (WS-PREV-INT-AGG-ADJ *                  2016683
607016                           CMA-PAST-AGGR-DAYS).                   2016683
607017     IF  WMS-INT-COLL-CALC EQUAL '2' OR '5' OR '6'                9916070
607018         COMPUTE SAVE-CUR-BAL = (SAVE-CUR-BAL -                   9916070
607020                 (WMS-HOLD-AMT * CMA-AGGR-DAYS)).                 2016683
607022     IF  WMS-INT-COLL-CALC EQUAL '3' OR '5'                       9916070
607024         COMPUTE SAVE-CUR-BAL = (SAVE-CUR-BAL -                   9916070
607026                 (WMS-BANK-AVAIL-AMT * CMA-AGGR-DAYS)).           2016683
607028     IF  WMS-INT-COLL-CALC EQUAL '4' OR '6'                       9916070
607030         COMPUTE SAVE-CUR-BAL = (SAVE-CUR-BAL -                   9916070
607032                 (WMS-CUST-AVAIL-AMT * CMA-AGGR-DAYS)).           2016683
607034     IF  WMS-INT-COLL-CALC EQUAL '7'                              9916070
607036         COMPUTE SAVE-CUR-BAL = (SAVE-CUR-BAL -                   9916070
607038                 (WMS-NB-OTH-HLD    * CMA-AGGR-DAYS)).            2016683
607040     ADD SAVE-CUR-BAL TO WMS-INT-SC-AGGR-COLL.                    9916070
607042                                                                  9916431
607044 R4655.                                                           2016683
607046     COMPUTE WMS-SC-AGGR-DDA = WMS-SC-AGGR-DDA +                  9916431
607048            (WMS-DDA-BAL * CMA-AGGR-DAYS) +                       2016683
607049            (CMA-DDA-PAST-BAL * CMA-PAST-AGGR-DAYS).              2016683
607050     MOVE +0 TO CMA-AGGR-DAYS CMA-PAST-AGGR-DAYS.                 2016683
607051 R4655-CONT.                                                      2016683
607052     IF  WMS-LOAN-TRLR EQUAL '0', GO TO R4690-EXIT.               2016683
607100     IF  SWEEP-TODAY EQUAL '0'
607105         MOVE WMS-PRIN-BAL       TO  WMS-PYMT-DUE-AMT             1002953
607107         MOVE ZERO               TO  WMS-PAST-DUE-AMT             9715448
607108                                     WMS-PAST-DUE                 9715448
607109         MOVE SPACES             TO  WMS-PAST-DUE-DATE            9715448
607110         MOVE WMS-PYMT-DUE-AMT   TO  WMS-BILL-DUE-AMT (1)         1002953
607112         MOVE ZERO               TO  WMS-BILL-DUE-STAT (1)        9715448
607115         MOVE WBC-CAPTURE-MO     TO  WMS-BILL-DUE-MO  (1)         0266741
607120         MOVE WBC-CAPTURE-DA     TO  WMS-BILL-DUE-DA  (1)         0266741
607125         MOVE WBC-CAPTURE-YR     TO  WMS-BILL-DUE-YR  (1)         0266741
607130         IF  WMS-BILL-DUE-YR (1) LESS THAN WBC-NEXT-CENT-YR       0266741
607135             MOVE '20'           TO  WMS-BILL-DUE-CENT (1)        1002953
607140         ELSE                                                     1002953
607145             MOVE '19'           TO  WMS-BILL-DUE-CENT (1).       1002953
607200     IF  WMS-PYMT-DUE-AMT GREATER THAN +0 AND
607250         WMS-DDA-BAL GREATER THAN WMS-MIN-BAL
607300         SUBTRACT WMS-MIN-BAL FROM WMS-DDA-BAL GIVING CUR-BAL
607350         MOVE +0 TO WK-HOLD-AMT13                                 9915845
607400         PERFORM R0330 THRU R0495-EXIT.                           9915845
607402     IF  LOAN-TODAY GREATER THAN ZERO                             1105706
607404         PERFORM R3690 THRU R3690-END.                            1105706
607408     MOVE WBC-ACCRUAL-DAYS TO ACCR-DAYS-SKIPPED.                  0266741
607416     IF  WBC-LOAN-DAILY-ACCRUAL EQUAL '0'                         0266741
607424         SUBTRACT +1 FROM ACCR-DAYS-SKIPPED.                      IM008
607432     IF  ACCR-DAYS-SKIPPED GREATER THAN +0                        IM008
607440         MOVE '0' TO SKIP-LOAN-ACCR-SW                            IM008
607448         PERFORM C2371 THRU C2400 ACCR-DAYS-SKIPPED TIMES         IM008
607456         MOVE +0 TO ACCR-DAYS-SKIPPED.                            IM008
607465     GO TO R4690-EXIT.                                            9915749
607466                                                                  9915749
607467     COPY IMPD31CS.                                               9915749
607468                                                                  9915749
607470 R4690-EXIT. EXIT.                                                IM004
607500*                                                                 2016639
607510     COPY IMPD31XN.                                               2016639
607520*                                                                 2016639
607550*    *********  LIMIT TRANSFER TRAILER PROCESSING  *********
607600     SKIP3
607650 R4800.
607670     MOVE ZERO TO ACCRUAL-DAY.                                    IM004
607700     IF  WMS-LIMIT-TRANSFER EQUAL '0', GO  TO  R4900.
607750     IF  WMS-STATUS EQUAL '01' OR '06' OR '07', GO  TO  R4900.
607755     IF  WMS-HOLD-ALL-FUNDS-FLAG EQUAL '1'                        0902008
607760     OR  (WMS-HOLD-ALL-FUNDS-FLAG EQUAL '2'                       0902008
607765     AND  WBC-ONLINE-HOLD-FLAG EQUAL '0')                         0266741
607770     GO TO R4900.                                                 0902008
607800     IF  WMS-LIM-TRAN-AMT NOT GREATER THAN ZERO, GO  TO  R4900.
607850     SKIP3
607900 TRLR-SECTION-E      SECTION 46.
607950     SKIP3
608000 R4820.
608050     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM007
608058     AND WMS-INT-STATUS EQUAL '2'                                 IM007
608066         MOVE WMS-DDA-BAL TO CUR-BAL                              IM007
608074     ELSE                                                         IM007
608075         MOVE WMS-CURR-BAL TO CUR-BAL.                            IM007
608076     IF  SAV-BKUP-WTHLD-FLAG NOT EQUAL '2' AND '3'                IM007
608077         GO TO R4830.                                             IM007
608078     IF  WMS-IOD-PEND-TAX GREATER THAN ZERO                       IM007
608079         SUBTRACT WMS-IOD-PEND-TAX FROM CUR-BAL.                  IM007
608080     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
608081     OR  WMS-INT-STATUS EQUAL '2'                                 IM007
608082          GO TO R4830.                                            IM007
608083     IF  WMS-SAV-PEND-TAX GREATER THAN ZERO                       IM007
608084         SUBTRACT WMS-SAV-PEND-TAX FROM CUR-BAL.                  IM007
608090 R4830.                                                           IM007
608098     IF  WMS-LIM-TRAN-AMT GREATER THAN CUR-BAL                    IM007
608106         GO TO R4900.                                             IM007
608114     IF  WMS-MIN-BAL GREATER THAN WMS-LIM-TRAN-AMT                IM007
608122         SUBTRACT WMS-MIN-BAL FROM CUR-BAL GIVING HOLD-AMT        IM007
608130     ELSE                                                         IM007
608138         SUBTRACT WMS-LIM-TRAN-AMT FROM CUR-BAL GIVING HOLD-AMT.  IM007
608146     MOVE WMS-NSF-CALC TO CALC-FLAG.                              IM007
608154     PERFORM K0104 THRU K0105.                                    IM007
608162     IF  HOLD-AMT GREATER THAN CUR-BAL                            IM007
608170         MOVE CUR-BAL TO HOLD-AMT.                                IM007
608178     IF  HOLD-AMT NOT GREATER THAN +0                             IM007
608186         GO TO R4900.                                             IM007
608194     IF  HOLD-AMT LESS THAN WBC-MIN-TRANSFER                      0266741
608202         GO TO R4900.                                             IM007
608203     MOVE '0' TO WS-WORK-CAL-YR                                   0617360
608204                 WS-WORK-TAX-YR.                                  0617360
608205     MOVE '21  ' TO WS-WORK-COMB-PLN-CODES.                       0617360
608206     MOVE '0' TO WS-WORK-TAX-CODE.                                0617360
608210     IF  SAV-BKUP-WTHLD-FLAG NOT EQUAL '2' AND '3'                IM007
608218         GO TO R4880.                                             IM007
608226     MOVE HOLD-AMT TO SAVE-AMT                                    IM007
608276                      MAX-TAX.                                    IM007
608326 R4840.                                                           IM007
608498*----------------------------------------------------------------*IM007
608506*    ASSESS ANY PENDING TAXES FOR LIMIT TRANSFER (WITHDRAWAL)    *IM007
608514*----------------------------------------------------------------*IM007
608517     MOVE ZERO TO TAX-CALC-AMOUNT-ST  TAX-CALC-AMOUNT-LOC.        2012254
608538     IF  WMS-IOD-PEND-TAX GREATER THAN +0                         IM007
608546         IF  WMS-IOD-PEND-TAX GREATER THAN MAX-TAX                IM007
608554             MOVE MAX-TAX TO TAX-CALC-AMOUNT                      IM007
608555             MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC  2012254
608562             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
608570             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX       IM007
608578         ELSE                                                     IM007
608586             MOVE WMS-IOD-PEND-TAX TO TAX-CALC-AMOUNT             IM007
608587             MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC  2012254
608594             PERFORM K0053-IOD-TAX-GT THRU K0053-IOD-TAX-GT-EXIT  IM007
608602             SUBTRACT TAX-CALC-AMOUNT FROM WMS-IOD-PEND-TAX       IM007
608610     ELSE                                                         IM007
608618         MOVE ZERO TO TAX-CALC-AMOUNT                             2012254
608619                      TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC.     2012254
608626     SUBTRACT TAX-CALC-AMOUNT FROM MAX-TAX.                       IM007
608634*----------------------------------------------------------------*IM007
608642*    TOTAL TAX WITHHELD CANNOT EXCEED THE TRANSACTION AMOUNT     *IM007
608650*----------------------------------------------------------------*IM007
608658     IF  WMS-SAVINGS-TRLR EQUAL '0'                               IM007
608666     OR  WMS-INT-STATUS EQUAL '2'                                 IM007
608674         GO TO R4840-EXIT.                                        IM007
608682     IF  MAX-TAX GREATER THAN +0                                  IM007
608690     AND WMS-SAV-PEND-TAX GREATER THAN +0                         IM007
608698         IF  WMS-SAV-PEND-TAX GREATER THAN MAX-TAX                IM007
608706             MOVE MAX-TAX TO TAX-CALC-AMOUNT                      IM007
608707             MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC  2012254
608714             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
608722             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
608730         ELSE                                                     IM007
608738             MOVE WMS-SAV-PEND-TAX TO TAX-CALC-AMOUNT             IM007
608739             MOVE ZERO TO TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC  2012254
608746             PERFORM K0053-SAV-TAX-GT THRU K0053-SAV-TAX-GT-EXIT  IM007
608754             SUBTRACT TAX-CALC-AMOUNT FROM WMS-SAV-PEND-TAX       IM007
608762     ELSE                                                         IM007
608770         MOVE ZERO TO TAX-CALC-AMOUNT                             2012254
608771                      TAX-CALC-AMOUNT-ST TAX-CALC-AMOUNT-LOC.     2012254
608778     SUBTRACT TAX-CALC-AMOUNT FROM MAX-TAX.                       IM007
608780 R4840-EXIT.                                                      IM007
608782     EXIT.                                                        IM007
608786 R4850.                                                           IM007
608794     MOVE SAVE-AMT TO HOLD-AMT.                                   IM007
608810 R4880.                                                           IM007
608850     ADD +1 TO FS-DB.
608900     PERFORM K7500 THRU K8500.
608950     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL.
609000     ADD +1 TO DDA-LIMIT-TRAN-NO, WS-GL-DDA-LIMIT-TRAN-NO.        0902970
609050     ADD HOLD-AMT TO DDA-LIMIT-TRAN-AMT, WS-GL-DDA-LIMIT-TRAN-AMT.0902970
609100     ADD +1 TO WMS-STMT-NO-DEBITS.
609150     ADD +1 TO WMS-SC-AMTTRNSFR-NO.
609200     ADD HOLD-AMT TO WMS-STMT-DR-AMT.
609250     IF WMS-IOD-RATE-PTR GREATER THAN ZERO
609300     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
609350         ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                     0902970
609400         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             0902970
609450     ELSE
609500         ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                     0902970
609550         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            0902970
609600     MOVE HOLD-AMT TO WMS-AMT-LAST-MONETARY-ACTIVITY.
609650     MOVE WBC-CAPTURE-DATE TO WMS-DATE-LAST-MONETARY-ACT.         0266741
609700     MOVE WBC-GENERATED-TRANS (6) TO GEN-TRAN-OPTION-HOLD.        0266741
609750     MOVE 'G3' TO IMEX-CODE-2.
609800     MOVE '06' TO EX01-INT-CODE.
609850     MOVE '4' TO EX01-TYPE.
609900     MOVE ZERO TO EX01-NUMBER.
609950     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.
610000     MOVE '08' TO IMEX-REC-NO.
610050     MOVE 'IZ' TO IMEX-CODE-1.
610100     MOVE WMS-LIM-TRAN-CODE TO IMEX-CODE-2
610150     MOVE WMS-LIM-TRAN-CONTROL TO EX08-CNTL.
610200     MOVE HOLD-AMT TO EX08-END-BAL.
610250     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
610300     IF WMS-SAVINGS-TRLR EQUAL TO '0'
610350         SUBTRACT HOLD-AMT FROM WMS-DDA-BAL
610400         GO TO R4900.
610450     SUBTRACT WMS-MIN-BAL FROM WMS-DDA-BAL GIVING CUR-BAL.
610500     IF CUR-BAL NOT LESS THAN HOLD-AMT
610550         SUBTRACT HOLD-AMT FROM WMS-DDA-BAL
610600         GO TO R4900.
610650     SUBTRACT WMS-DDA-BAL FROM HOLD-AMT.
610700     MOVE WMS-MIN-BAL TO WMS-DDA-BAL.
610750     ADD WMS-MIN-BAL TO HOLD-AMT.
610800     SUBTRACT HOLD-AMT FROM WMS-INT-CUR-BAL.
610850     ADD HOLD-AMT TO TRANSFER-AMT.                                IM006
610950     SKIP3
611000 ROOT-SECTION-S      SECTION 1.
611010     SKIP3                                                        9915845
611012*    ******  INTERBRANCH TRANSFER EXCEPTION PROCESSING  ******    9915845
611016     SKIP1                                                        9915845
611018 R4900.                                                           9915845
611020     IF  WMS-IBT-REROUTE-FLAG EQUAL '1'                           9915845
611022         MOVE '44' TO IMEX-REC-NO                                 9915845
611024         MOVE 'IB' TO IMEX-CODE-1                                 9915845
611026         MOVE 'IC' TO IMEX-CODE-2                                 9915845
611028         MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20          9915845
611030         MOVE WMS-CONTROL-1 TO HOLD-WK-CTL1                       9915845
611032         MOVE HOLD-WORK-ACCOUNT TO EX44-IBT-OLD-NEW-ACCT          9915845
611034         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 9915845
611036     IF  WMS-IBT-FLAG EQUAL '2'                                   9915845
611038         GO  TO  R5000.                                           9915845
611050     SKIP3
611100*    ******  ZERO BALANCE ACCOUNT TRAILER PROCESSING  ******
611150     SKIP1
611200 R4905.                                                           9915845
611210*----------------------------------------------------------------*9915749
611211*    BYPASS ZBA PROCESSING IN IM31.  IT IS PERFORMED IN IM29ZBA. *2016639
611212*----------------------------------------------------------------*9915749
611214*    I8 EXCEPTION CAUSES IM32 TO CREATE TRAN 75 ON THE IMFLGT    *2016639
611215*    FILE TO SEND BANK & CUST UNAVAIL (TC 75) AND HOLDS (TC 49)  *2016639
611216*    FROM THE ZBA CHILD TO THE ZBA PARENT ACCOUNT.               *2016639
611217*    THIS IS NO LONGER NECESSARY AS IM28 (HOLDS) AND IM29ZBA     *2016639
611218*    (UNAVAIL) NOW PERFORM THESE FUNCTIONS.                      *2016639
611219*----------------------------------------------------------------*2016639
611220     GO TO R4930.                                                 2016639
611250     IF  WMS-TARGET-AMT-TRLR EQUAL '0'                            2016639
611255         GO TO R4930.                                             2016639
611260     IF  WMS-TARGET-DELETE GREATER THAN '0'                       2016639
611265         GO TO R4930.                                             2016639
611270     IF  WMS-HOLD-ALL-FUNDS-FLAG EQUAL '1'                        2016639
611280     OR  (WMS-HOLD-ALL-FUNDS-FLAG EQUAL '2'                       2016639
611290     AND  WBC-ONLINE-HOLD-FLAG EQUAL '0')                         0266741
611300         GO TO R4930.                                             2016639
611310     IF  WMS-TARGET-FL-TO-PRNT EQUAL '0' OR '2' OR '3'            2016639
611315     OR  WMS-NB-ZB-PAR-CHILD   EQUAL 'P'                          2016639
611320         GO TO R4930.                                             2016639
611350     SKIP3                                                        2016639
611400 TRLR-SECTION-F      SECTION 46.
611450*    SKIP3                                                        9915749
611500 R4910.
611550     MOVE '08' TO IMEX-REC-NO.                                    2016639
611600     MOVE 'I8' TO IMEX-CODE-1.                                    2016639
611650     MOVE WMS-CURR-BAL TO EX08-END-BAL.                           2016639
611700     IF  WMS-TARGET-AMOUNT EQUAL ZERO                             2016639
611710         GO  TO  R4920.                                           2016639
611750     MOVE WMS-TARGET-AMOUNT TO HOLD-AMT11.                        2016639
611800     IF  WMS-TARGET-AMT-FLAG EQUAL '1'                            2016639
611850         MULTIPLY -1 BY HOLD-AMT11.                               2016639
611900     SUBTRACT HOLD-AMT11 FROM EX08-END-BAL.                       2016639
611950 R4920.
612000***  MOVE WMS-TARGET-CONTROL    TO EX08-CNTL.                     2016639
612005     MOVE WMS-NB-ZB-ULTMT-PAR   TO EX08-CNTL.                     2016639
612010     MOVE WMS-TARGET-FL-TO-PRNT TO EX08-FL-TO-PRNT.               2016639
612020     PERFORM WRITE-EX-MST       THRU WRITE-EX-EXIT.               2016639
612100     SKIP3                                                        2016639
612102*    ******  FUNDING SUBSYSTEM EXCEPTION PROCESSING   ******      0902557
612105     SKIP1                                                        0902557
612108 R4930.                                                           0902557
612111     IF  WBC-FUND-SYS-CODE EQUAL '0' OR ' '                       0266741
612112         GO TO R4931.                                             2016639
612114     IF  WMS-FUNDING-FLAG EQUAL '0' OR ' '                        2016639
612115         IF  WMS-OD-LIMIT EQUAL 'L'                               0917815
612116             GO TO R4932                                          0917815
612117         ELSE                                                     0917815
612118             GO TO R4931.                                         0917815
612119     IF  WMS-MIN-BAL NUMERIC                                      0917815
612120         IF  WMS-MIN-BAL NOT EQUAL ZEROS                          0902557
612123             IF  WMS-DDA-BAL LESS THAN WMS-MIN-BAL                0902557
612126                 MOVE WBC-NEXT-CAPTURE-DATE TO DT-HIGH-DATE       0266741
612129                 MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE             0266741
612132                 CALL 'SIDIF1' USING DATE-AREA                    0902557
612135                 ADD RET-DAYS TO WMS-DAYS-BELOW-MIN-BAL           0902557
612138             ELSE                                                 0902557
612141                 MOVE ZEROS TO WMS-DAYS-BELOW-MIN-BAL             0902557
612144         ELSE                                                     0902557
612147             MOVE ZEROS TO WMS-DAYS-BELOW-MIN-BAL                 0902557
612150     ELSE                                                         0902557
612153         MOVE ZEROS TO WMS-DAYS-BELOW-MIN-BAL.                    0902557
612154     GO TO R4932.                                                 2016639
612155 R4931.                                                           2016639
612156     IF  WMS-XINV-LINK-IND EQUAL ' ' OR 'A' OR 'D' OR 'P'         2016639
612157     OR  WMS-XINV-PROCESS-IND EQUAL '0' OR '2'                    2016639
612158         GO TO R5000.                                             2016639
612159 R4932.                                                           2016639
612160     MOVE '08' TO IMEX-REC-NO.                                    2016639
612161     MOVE 'FD' TO IMEX-CODE-1.                                    2016639
612162     MOVE SPACES      TO IMEX-REC-08.                             0326947
612163     MOVE WMS-DDA-BAL TO EX08-END-BAL.                            0326947
612165     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0902557
612168     SKIP3                                                        0902557
612171 ROOT-SECTION-E      SECTION 1.                                   0902557
612200     SKIP3
612250*    ********  STATEMENT RANGE REQUEST PROCESSING  *********
612300*    ********    STATEMENT EXCEPTION GENERATION    *********
612350     SKIP1
612400 R5000.
612450     IF  WMS-ARP-CODE NOT EQUAL '0'                               1105504
612500         ADD +1 TO DDA-ARP-NO, WS-GL-DDA-ARP-NO                   0902970
612550         MOVE '03' TO IMEX-REC-NO
612600         MOVE 'I2' TO IMEX-CODE-1
612650         MOVE WMS-ARP-CODE TO EX03-CODE
612670         MOVE WMS-ARP-ISSUE TO EX03-RESN                          IM004
612700         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
612750     IF  FS-DB GREATER THAN ZERO OR FS-CR GREATER THAN ZERO
612800         PERFORM K8100 THRU K8500.
612810     IF  FULL-SHEET-TODAY EQUAL '1'                               1004015
612820         MOVE '2' TO FULL-SHEET-TODAY                             1004015
612830         PERFORM X6000-TIS-CALC-APY THRU X6000-TIS-EXIT           1004015
612840         MOVE '3' TO FULL-SHEET-TODAY.                            1004015
612850     IF  EFT-STMT-FLAG EQUAL '1'                                  IM004
612854         MOVE HIGH-VALUES TO EX07-REQ-BY                          IM004
612858         MOVE '19' TO IMEX-CODE-2                                 IM005
612862         MOVE '0' TO EX07-RESET                                   IM004
612866         IF  WMS-LOAN-TRLR EQUAL TO '1'                           IM004
612870             MOVE '1' TO LOAN-STMT-CALC                           IM004
612874             PERFORM R5020 THRU R5045                             IM004
612878         ELSE                                                     IM004
612882             PERFORM R5020 THRU R5045.                            IM004
612886     IF  ST-REQ-TYPE (BIN-1) EQUAL TO ' '                         IM004
612900         GO  TO  R5010.
612950     SET REQ-IND TO +1.
612955     MOVE BIN-20        TO HOLD-NO10.                             9916309
612960     MOVE ZERO          TO HOLD-NO11                              9916309
612965                           HOLD-NO13.                             9916309
612970     MOVE WMS-STMT-DUPL TO HOLD-NO12.                             9916309
612975     IF  STMT-TODAY  EQUAL '1'                                    9916309
612980         SUBTRACT WMS-STMT-DUPL FROM HOLD-NO10.                   9916309
613000 R5005.
613050     IF  ST-REQ-TYPE (REQ-IND) EQUAL TO ' '
613100         GO  TO  R5007.
613102     IF  WMS-STMT-DUPL NOT GREATER THAN ZERO                      9916309
613104         MOVE WMS-CONTROL-KEY TO E07-KEY                          9916309
613106         MOVE 002             TO SIMESS-MESS-NO                   9916309
613108         MOVE EMSG-07         TO SIMESS-OPTIONAL-MESSAGE          9916309
613110         CALL 'SIMESS'     USING SIMESS-AREA                      9916309
613112         GO TO R5006.                                             9916309
613114     ADD WMS-STMT-DUPL        TO HOLD-NO11.                       9916309
613116     IF  HOLD-NO11  GREATER THAN HOLD-NO10                        9916309
613118         SUBTRACT HOLD-NO10 FROM HOLD-NO11 GIVING HOLD-NO13       9916309
613120         SUBTRACT HOLD-NO13 FROM WMS-STMT-DUPL.                   9916309
613122     IF  WMS-STMT-DUPL NOT GREATER THAN ZERO                      9916309
613124         GO TO R5006.                                             9916309
613150     MOVE ST-REQ-INIT (REQ-IND) TO EX07-REQ-BY.
613200     IF  ST-REQ-TYPE (REQ-IND) EQUAL TO '2'
613250         MOVE '03' TO IMEX-CODE-2
613300         MOVE '1' TO EX07-RESET, WMS-STMT-CLEAR
613305         MOVE '1' TO WMS-IT-TRAN-FLAG1                            9915749
613350     ELSE
613400         MOVE '05' TO IMEX-CODE-2
613450         MOVE '0' TO EX07-RESET.
613500     IF WMS-LOAN-TRLR EQUAL TO '1'
613550         IF  ST-REQ-TYPE (REQ-IND) EQUAL TO '2'
613600             MOVE '2' TO LOAN-STMT-CALC
613650         ELSE
613700             MOVE '1' TO LOAN-STMT-CALC.
613750     PERFORM R5020 THRU R5045.
613755 R5006.                                                           9916309
613800     SET REQ-IND UP BY +1.
613850     IF  REQ-IND NOT GREATER THAN +20
613900         GO  TO  R5005.
613950 R5007.
613955     MOVE HOLD-NO12 TO WMS-STMT-DUPL.                             9916309
614000     MOVE SPACES TO STATEMENT-REQUEST-TBL.
614050 R5010.
614100     IF SNAP-END EQUAL TO HIGH-VALUE, GO TO R5050.
614150     IF LOW-CONTROL GREATER THAN HIGH-SNAP
614200         MOVE HIGH-VALUE TO SNAP-END
614250         GO TO R5050.
614300     MOVE SNAP-INIT TO EX07-REQ-BY.
614350     MOVE '05' TO IMEX-CODE-2.
614400     MOVE '0' TO EX07-RESET.
614450     IF WMS-LOAN-TRLR EQUAL TO '1'
614500         MOVE '1' TO LOAN-STMT-CALC.
614550 R5020.
614600     IF  WBC-SNAPSHOT-FORMAT EQUAL TO ZERO                        0266741
614650     OR  EX07-RESET EQUAL '1'                                     9915845
614660     OR  WBC-MULTI-LANGUAGE-FLAG EQUAL '1'                        0266741
614700         MOVE WMS-STMT-FORMAT TO EX07-FORMAT
614750     ELSE
614800         MOVE WBC-SNAPSHOT-FORMAT TO EX07-FORMAT.                 0266741
614850     MOVE WMS-STMT-DUPL TO HOLD-NO1.
614900     PERFORM R5185 THRU R5192-EXIT.
614950     MOVE WBC-SERIAL-FORMAT (EX07-FORMAT) TO EX07-SERIAL.         0266741
615000     PERFORM R5194 THRU R5195.                                    IM003
615100 R5045.  EXIT.
615150 R5050.
615200     IF RESET-END EQUAL TO HIGH-VALUE, GO TO R5100.
615250     IF LOW-CONTROL GREATER THAN HIGH-RESET
615300         MOVE HIGH-VALUE TO RESET-END
615350         GO TO R5100.
615400     MOVE '03' TO IMEX-CODE-2.
615450     MOVE '1' TO EX07-RESET, WMS-STMT-CLEAR.
615455     MOVE '1' TO WMS-IT-TRAN-FLAG1.                               9915749
615500     MOVE RESET-INIT TO EX07-REQ-BY.
615550     PERFORM R5020 THRU R5045.
615600     IF WMS-LOAN-TRLR EQUAL TO '1'
615650         MOVE '2' TO LOAN-STMT-CALC.
615700 R5100.
615750     IF WMS-STMT-FULL-SHEET IS EQUAL TO '2' AND
615800         WMS-STMT-PAGE IS GREATER THAN +0
615850         MOVE '09' TO IMEX-CODE-2
615900         MOVE '1' TO STMT-TODAY.
615950     IF STMT-TODAY EQUAL TO '1', GO TO R5170.
616000     IF LOAN-STMT-CALC GREATER THAN '0'
616010     AND LOAN-AGGR-SW NOT EQUAL 'N'                               1003343
616050         IF LOAN-STMT-CALC EQUAL TO '1'
616100             PERFORM R5197 THRU R5198
616150         ELSE
616200             PERFORM R5197 THRU R5200.
616250     IF  SYS-REQ-STMT EQUAL '1'
616300         GO  TO  R5150.
616350     IF  WMS-STATUS EQUAL '05' OR '08'
616400         IF  WMS-LOAN-TRLR EQUAL '0'
616450             GO TO R5300
616500         ELSE
616550             IF  WMS-LOAN-STATUS EQUAL '3' OR '4'
616600                 GO TO R5300.
616650 R5140.
616700     IF WBC-PREV-MONTH-END NOT EQUAL TO '1', GO TO R5200.         0266741
616750     IF WBC-FORCE-STMT-DAYS EQUAL TO ZERO, GO TO R5200.           0266741
616760     IF  WMS-DATE-LAST-STMT EQUAL SPACES                          0266687
616770         MOVE WMS-DATE-OPENED TO DT-LOW-DATE                      0266687
616780     ELSE                                                         0266687
616800         MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE.                  0266687
616850     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
616860     CALL 'SIDIF1' USING DATE-AREA.                               9915749
616900     IF RET-DAYS LESS THAN WBC-FORCE-STMT-DAYS, GO TO R5200.      0266741
616950 R5150.
617000     MOVE '07' TO IMEX-CODE-2.
617050     MOVE '   ' TO EX07-REQ-BY.                                   9913506
617060     IF  SYS-REQ-STMT EQUAL '1'                                   9913506
617070         MOVE '0' TO EX07-RESET                                   9913506
617080     ELSE                                                         9913506
617100         MOVE '1' TO EX07-RESET                                   9913506
617130         MOVE '1' TO WMS-STMT-CLEAR                               9913506
617135         MOVE '1' TO WMS-IT-TRAN-FLAG1.                           9913506
617150     PERFORM R5020 THRU R5045.
617200     IF WMS-LOAN-TRLR EQUAL TO '1'
617250         PERFORM R5197 THRU R5200.
617300     GO TO R5200.                                                 2016432
617302                                                                  2016432
617304 R5160.                                                           2016432
617306     IF  LOAN-AGGR-SW EQUAL 'N'                                   2016432
617308         MOVE WMS-LN-STMT-CY-DAYS TO SV-LN-AGGR-DAYS              2016432
617310     ELSE                                                         2016432
617312         MOVE WMS-LOAN-AGGR-DAYS  TO SV-LN-AGGR-DAYS.             2016432
617353     MOVE WMS-DATE-LAST-BILLING TO DT-LOW-DATE.                   IM008
617354     CALL 'SIEDITDT' USING DATE-AREA.                             IM008
617355     IF  DATE-FLAG EQUAL '1'                                      IM008
617356         GO TO R5161.                                             IM008
617357     MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE.                      IM008
617358     CALL 'SIEDITDT' USING DATE-AREA.                             IM008
617359     IF  DATE-FLAG EQUAL '1'                                      IM008
617360         MOVE '0' TO DATE-FLAG                                    IM008
617361         GO TO R5161.                                             IM008
617362     MOVE WMS-DATE-LAST-BILLING TO DT-LOW-DATE.                   IM008
617363     MOVE WMS-DATE-LAST-STMT TO DT-HIGH-DATE.                     IM008
617364     CALL 'SIDIF1' USING DATE-AREA.                               IM008
617365     IF  DT-LOW-DATE EQUAL DT-HIGH-DATE                           IM008
617366         MOVE '1' TO DATE-FLAG                                    IM008
617367         GO TO R5161.                                             IM008
617368     IF  RET-DAYS GREATER THAN +0                                 IM008
617369         MOVE '1' TO DATE-FLAG                                    IM008
617370     ELSE                                                         IM008
617371         MOVE '0' TO DATE-FLAG.                                   IM008
617372                                                                  IM008
617373 R5161.                                                           IM008
617374     IF  DATE-FLAG EQUAL '0'                                      IM008
617375         MOVE WMS-DATE-LAST-BILLING TO EX07-LN-BILL-CY-DATE       IM008
617376         MOVE WMS-LN-BILL-CY-DAYS   TO EX07-LN-BILL-CY-DAYS       IM008
617377         MOVE SV-LN-AGGR-DAYS       TO EX07-LN-STMT-CY-DAYS       2016432
617378         GO TO R5169-EXIT.                                        IM008
617379     MOVE EX07-STMT-DATE            TO EX07-LN-BILL-CY-DATE       IM008
617380     MOVE SV-LN-AGGR-DAYS           TO EX07-LN-BILL-CY-DAYS       2016432
617381                                       EX07-LN-STMT-CY-DAYS.      IM008
617382     IF  EX07-STMT-DATE EQUAL WBC-PROCESS-THRU-DATE               0266741
617383         GO TO R5169-EXIT.                                        IM008
617384     MOVE EX07-STMT-DATE TO DT-LOW-DATE.                          IM008
617385     MOVE WBC-PROCESS-THRU-DATE TO DT-HIGH-DATE.                  0266741
617389     CALL 'SIDIF1' USING DATE-AREA.                               IM008
617390     IF  RET-DAYS NOT LESS THAN SV-LN-AGGR-DAYS                   2016432
617391         GO TO R5169-EXIT.                                        IM008
617392     SUBTRACT RET-DAYS FROM EX07-LN-BILL-CY-DAYS                  IM008
617393                            EX07-LN-STMT-CY-DAYS.                 IM008
617425 R5169-EXIT.                                                      IM008
617430     EXIT.                                                        IM008
617435                                                                  IM008
617438 R5170.                                                           0627532
617439     IF  STMT-TODAY EQUAL '1'                                     0627532
617440         PERFORM R5173 THRU R5173-EXIT.                           0627532
617441     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915845
617442         IF (WMS-STMT-NO-DEBITS EQUAL ZERO                        9915845
617444         AND WMS-STMT-NO-CREDITS EQUAL ZERO)                      9915845
617446             GO  TO  R5200                                        9915845
617448         ELSE                                                     9915845
617449             GO  TO  R5175.                                       9915845
617450*---------------------------------------------------------------* 1002512
617460*    GENERATE THE STATEMENT IF ANY OF THE FOLLOWING IS TRUE:    * 1002512
617470*        1. SERVICE CHARGE OCCURRED THIS CYCLE                  * 1002512
617480*        2. IOD INTEREST PAYMENT OCCURRED THIS CYCLE            * 1002512
617490*        3. AN ACTIVE LOAN TRAILER EXISTS                       * 1002512
617500*        4. SAVINGS INTEREST PAYMENT OCCURRED THIS CYCLE        * 1002512
617510*        5. NUMBER OF TRANSACTIONS EQUAL OR GREATER THAN THE BCR* 1002512
617520*     MINIMUM NUMBER OF TRANSACTIONS FOR THIS STATEMENT FORMAT. * 1002512
617530*---------------------------------------------------------------* 1002512
617540     IF  (WMS-STMT-SERV-CHG NOT EQUAL +0)                         1002512
617550     OR  (WMS-IOD-CYC-PAID-INT NOT EQUAL +0)                      1002512
617560         GO TO R5175.                                             1002512
617562     IF  (WMS-STMT-NO-DEBITS + WMS-STMT-NO-CREDITS                1002512
617564         GREATER THAN MIN-TRANS)                                  1002512
617566         GO TO R5175.                                             1002512
617568     IF  (WMS-STMT-NO-DEBITS + WMS-STMT-NO-CREDITS                1002512
617570         EQUAL MIN-TRANS)                                         1002512
617572         IF  MIN-TRANS NOT EQUAL +0                               1002512
617574             GO TO R5175                                          1002512
617576         ELSE                                                     1002512
617578             IF  WMS-STATUS NOT EQUAL '04'                        1002512
617580                 GO TO R5175.                                     1002512
617590     IF  WMS-LOAN-TRLR EQUAL TO '1'                               1002512
617600         IF  WMS-LN-STMT-DB-AMT EQUAL +0                          1002512
617610         AND WMS-LN-STMT-CR-AMT EQUAL +0                          1002512
617620         AND WMS-FINCHG-THIS-CY EQUAL +0                          1002512
617630         AND WMS-INSUR1-THIS-CY EQUAL +0                          1002512
617640         AND WMS-INSUR2-THIS-CY EQUAL +0                          1002512
617650         AND WMS-FEE-THIS-CY    EQUAL +0                          1002512
617660             NEXT SENTENCE                                        1002512
617670         ELSE                                                     1002512
617680             GO TO R5175.                                         1002512
617690     IF  WMS-SAVINGS-TRLR EQUAL '1'                               1002512
617700         IF  WMS-INT-ACCUM-INT NOT EQUAL +0                       1002512
617730             GO  TO  R5175.                                       1002512
617740*---------------------------------------------------------------* 1002512
617750*    GENERATE THE STATEMENT IF BOTH OF THE FOLLOWING ARE TRUE:  * 1002512
617760*        1. THE ACCOUNT IS CLOSED                               * 1002512
617770*        2. MONETARY ACTIVITY OCCURRED THIS CYCLE OR            * 0437316
617772*           THE ACCOUNT CLOSED SINCE THE LAST STATEMENT         * 0437316
617780*    OTHERWISE, DO NOT PRODUCE THE STATEMENT IF THE BCR CLOSED  * 1002512
617790*    STATEMENT OPTION IS EQUAL '0'.                             * 1002512
617800*---------------------------------------------------------------* 1002512
617810     IF  WMS-STATUS EQUAL '04'                                    1002512
617820         IF  WMS-STMT-NO-DEBITS + WMS-STMT-NO-CREDITS             1002512
617830             GREATER THAN +0                                      1002512
617840         OR (WMS-SAVINGS-TRLR EQUAL '1'                           1002512
617850         AND WMS-INT-DR-NUMBER + WMS-INT-CR-NUMBER                1002512
617860                 GREATER THAN +0)                                 1002512
617870             GO TO R5175                                          1002512
617880         ELSE                                                     1002512
617890             IF  CLSD-ACCT-STMT EQUAL '1'                         1002512
617892                 GO TO R5175                                      0437316
617896             ELSE                                                 0437316
617898                 MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE           0437316
617900                 MOVE WMS-CLOSED-YR      TO DT-H-YR               0437316
617902                 MOVE WMS-CLOSED-MO      TO DT-H-MO               0437316
617904                 MOVE WMS-CLOSED-DA      TO DT-H-DA               0437316
617906                 CALL 'SIDIF1'     USING DATE-AREA                0437316
617908                 IF  RET-DAYS GREATER ZERO                        0437316
617910                     GO TO R5175.                                 0437316
617915*---------------------------------------------------------------* 0437316
617920*    FORCE THE STATEMENT TO PRINT IF THE BALANCE IS EQUAL TO    * 1002512
617930*    OR GREATER THAN THE BCR STATEMENT FORCE BALANCE.           * 1002512
617940*---------------------------------------------------------------* 1002512
618100     IF WBC-STMT-FORCE EQUAL TO ZERO, GO TO R5200.                0266741
618150     IF WMS-CURR-BAL NOT LESS THAN WBC-STMT-FORCE, GO TO R5175.   0266741
618200     GO TO R5200.
618202 R5173.                                                           0627532
618204     IF  WMS-LOAN-TRLR EQUAL '0'                                  0627532
618206     OR  WMS-PYMT-DUE-AMT EQUAL +0                                0627532
618208         GO TO R5173-EXIT.                                        0627532
618210     IF  WMS-SC-REL-CODE NOT EQUAL '8'                            0627532
618212         GO TO R5173-EXIT.                                        0627532
618214     IF  WMS-LOAN-STATUS GREATER THAN '2' AND NOT EQUAL '5'       0627532
618216         GO TO R5173-EXIT.                                        0627532
618218     MOVE '08' TO IMEX-REC-NO.                                    0627532
618220     MOVE 'JP' TO IMEX-CODE-1.                                    0627532
618222     MOVE 'IM' TO IMEX-CODE-2.                                    0627532
618224     MOVE WMS-SC-REL-NO TO EX08-CNTL.                             0627532
618226     MOVE WMS-PYMT-DUE-AMT TO EX08-END-BAL.                       0627532
618228     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0627532
618230 R5173-EXIT.                                                      0627532
618232     EXIT.                                                        0627532
618234 R5174.                                                           0627532
618236     ADD +1                        TO  EX07-ADDR-PTR.             0627532
618238     PERFORM WRITE-EX-MST        THRU  WRITE-EXIT1.               0627532
618240 R5174-EXIT.                                                      0627532
618242     EXIT.                                                        0627532
618250 R5175.
618260     IF  STMT-TODAY EQUAL '1'                                     1105504
618265         MOVE WMS-IOD-CYC-PAID-INT TO WMS-NB-IOD-PRV-CTD-PD.      1105504
618300     IF WMS-STMT-SPECL-HANDL EQUAL TO '0'
618350         IF WMS-STMT-FULL-SHEET IS EQUAL TO '2' AND
618400             WMS-STMT-PAGE IS GREATER THAN +0
618450             MOVE '09' TO IMEX-CODE-2
618500             GO TO R5180
618550         ELSE
618600             MOVE '01' TO IMEX-CODE-2
618650             GO TO R5180.
618700     IF WMS-STMT-SPECL-HANDL EQUAL TO '1'
618750         MOVE '06' TO IMEX-CODE-2
618800         GO TO R5180.
618850     IF WMS-STMT-SPECL-HANDL EQUAL TO '2'
618900         MOVE '11' TO IMEX-CODE-2
618950         GO TO R5180.
619000     IF WMS-STMT-SPECL-HANDL EQUAL TO '3'
619050         MOVE '12' TO IMEX-CODE-2
619100         GO TO R5180.
619150     IF WMS-STMT-SPECL-HANDL EQUAL TO '4'
619200         MOVE '13' TO IMEX-CODE-2
619250         GO TO R5180.
619300     IF WMS-STMT-SPECL-HANDL EQUAL TO '5'
619350         MOVE '14' TO IMEX-CODE-2
619400         GO TO R5180.
619450     IF WMS-STMT-SPECL-HANDL EQUAL TO '6'
619500         MOVE '15' TO IMEX-CODE-2
619550         GO TO R5180.
619600     IF WMS-STMT-SPECL-HANDL EQUAL TO '7'
619650         MOVE '16' TO IMEX-CODE-2
619700         GO TO R5180.
619750     IF WMS-STMT-SPECL-HANDL EQUAL TO '8'
619800         MOVE '17' TO IMEX-CODE-2
619850         GO TO R5180.
619900     IF WMS-STMT-SPECL-HANDL EQUAL TO '9'
619950         MOVE '18' TO IMEX-CODE-2
620000         GO TO R5180.
620050 R5180.
620100     MOVE '   ' TO EX07-REQ-BY.
620150     MOVE WMS-STMT-DUPL TO HOLD-NO1.
620200     MOVE '1' TO EX07-RESET, WMS-STMT-CLEAR.
620205     MOVE '1' TO WMS-IT-TRAN-FLAG1.                               9915749
620250     MOVE WMS-STMT-FORMAT TO EX07-FORMAT.
620300 R5185.
620350     MOVE WMS-STMT-LINES TO HOLD-STMT-LINES.
620400     MOVE WMS-STMT-PAGE TO HOLD-STMT-PAGES.
620450     MOVE '07' TO IMEX-REC-NO.
620500     MOVE 'RS' TO IMEX-CODE-1.
620550     MOVE SERIAL-STMT TO EX07-SERIAL.
620600     MOVE WMS-COMBINED-STAT TO EX07-CMB-ST-TRLRS.
620650     IF  SERIAL-STMT EQUAL '0',  GO  TO  R5191.
620658     IF  LINE-DB1 EQUAL +0                                        IM004
620666     AND LINE-DB3 EQUAL +0                                        IM004
620674     AND LINE-CR1 EQUAL +0                                        IM004
620682     AND LINE-CR3 EQUAL +0                                        IM004
620690         GO TO R5191.                                             IM004
620700     MOVE WMS-STMT-LINES TO DAILY-BAL-LINES.
620750     MULTIPLY PAGE-LINES BY WMS-STMT-PAGE.
620800     ADD WMS-STMT-PAGE TO DAILY-BAL-LINES.
620850     MOVE +0 TO WMS-STMT-PAGE, WMS-STMT-LINES.
620900     DIVIDE LINE-DB1 INTO WMS-STMT-NO-DEBITS GIVING HOLD-DIVIDEND
620950         REMAINDER HOLD-REMAINDER.
621000     IF  HOLD-REMAINDER GREATER THAN ZERO
621050         ADD +1 TO HOLD-DIVIDEND.
621100     IF  WBC-DAYBAL-FORMAT (EX07-FORMAT) GREATER THAN '1'         0266741
621150         GO  TO  R5187.
621200     MOVE +0 TO DAILY-BAL-PAGES.
621250 R5186.
621300     IF  DAILY-BAL-LINES GREATER THAN PAGE-LINES
621350         ADD +1 TO DAILY-BAL-PAGES
621400         SUBTRACT PAGE-LINES FROM DAILY-BAL-LINES
621450         GO  TO  R5186.
621500     GO  TO  R5187A.
621550 R5187.
621600     MOVE WBC-DAYBAL-FORMAT (EX07-FORMAT) TO BYTE-1.              0266741
621650     IF  BYTE-1 EQUAL '2' OR '4' OR '6'
621700         DIVIDE +2 INTO DAILY-BAL-LINES GIVING WMS-STMT-LINES
621750             REMAINDER HOLD-REMAINDER
621800         IF  HOLD-REMAINDER GREATER +0
621850             ADD +1 TO WMS-STMT-LINES.
621900     IF  BYTE-1 EQUAL '3' OR '5' OR '7'
621950         DIVIDE +3 INTO DAILY-BAL-LINES GIVING WMS-STMT-LINES
622000             REMAINDER HOLD-REMAINDER
622050         IF  HOLD-REMAINDER GREATER THAN +0
622100             ADD +1 TO WMS-STMT-LINES.
622150     IF  BYTE-1 EQUAL '2' OR '3'
622200         ADD +2 TO WMS-STMT-LINES
622250     ELSE
622300     IF  BYTE-1 EQUAL '4' OR '5'
622350         ADD +3 TO WMS-STMT-LINES
622400     ELSE
622450         ADD +4 TO WMS-STMT-LINES.
622500     ADD HOLD-DIVIDEND TO WMS-STMT-LINES.
622550 R5187A.
622600     IF  LINE-CR3 EQUAL +0
622650         IF  LINE-CR1 EQUAL +0                                    IM004
622660             NEXT SENTENCE                                        IM004
622670         ELSE                                                     IM004
622680             DIVIDE LINE-CR1 INTO WMS-STMT-NO-CREDITS             IM004
622690                 GIVING HOLD-DIVIDEND REMAINDER HOLD-REMAINDER    IM004
622700             ADD HOLD-DIVIDEND TO WMS-STMT-LINES                  IM004
622710             IF  HOLD-REMAINDER GREATER THAN +0                   IM004
622720                 ADD +1 TO WMS-STMT-LINES.                        IM004
622900     IF  WMS-STMT-NO-CREDITS GREATER THAN +0
622950         ADD +2 TO WMS-STMT-LINES.
623000     IF  WMS-STMT-NO-DEBITS GREATER THAN +0
623050         ADD +2 TO WMS-STMT-LINES.
623100     IF  WBC-STAT-MSG (EX07-FORMAT) EQUAL '0' OR '3'              0266741
623150         GO  TO  R5188.
623200     IF  WBC-MESSAGE-LINE (1) EQUAL SPACES, GO TO  R5188          0266741
623250       ELSE  ADD +2 TO WMS-STMT-LINES.
623300     IF  WBC-MESSAGE-LINE (2) EQUAL SPACES, GO TO  R5188          0266741
623350       ELSE  ADD +1 TO WMS-STMT-LINES.
623400     IF  WBC-MESSAGE-LINE (3) EQUAL SPACES, GO TO  R5188          0266741
623450       ELSE  ADD +1 TO WMS-STMT-LINES.
623500 R5188.
623550     IF  WMS-STMT-LINES GREATER THAN PAGE-LINES
623600         ADD +1 TO WMS-STMT-PAGE
623650         SUBTRACT PAGE-LINES FROM WMS-STMT-LINES, GO TO R5188.
623690 R5188-EXIT.                                                      9915845
623695       EXIT.                                                      9915845
623700 R5188-A.
623750     IF  WMS-STMT-PAGE GREATER THAN +0
623800         MULTIPLY +3 BY WMS-STMT-PAGE GIVING HOLD-NO3
623850         ADD HOLD-NO3 TO WMS-STMT-LINES                           9915845
623855         PERFORM R5188 THRU R5188-EXIT.                           9915845
623900     IF  WBC-DAYBAL-FORMAT (EX07-FORMAT) EQUAL '1' AND            0266741
623950         DAILY-BAL-PAGES GREATER THAN WMS-STMT-PAGE
624000         MOVE DAILY-BAL-PAGES TO WMS-STMT-PAGE.
624050 R5189.
624100     IF  LINE-CR3 LESS THAN +1, GO  TO  R5191.
624150     IF  LINE-CR1 EQUAL +0, GO TO R5191.                          IM004
624160     DIVIDE LINE-CR1 INTO WMS-STMT-NO-CREDITS GIVING              IM004
624170            HOLD-DIVIDEND REMAINDER HOLD-REMAINDER.               IM004
624250     IF  HOLD-REMAINDER GREATER THAN +0
624300         ADD +1 TO HOLD-DIVIDEND.
624350     MOVE +0 TO HOLD-NO3.
624400 R5190.
624450     IF  HOLD-DIVIDEND GREATER THAN LINE-CR3
624500         ADD +1 TO HOLD-NO3
624550         SUBTRACT LINE-CR3 FROM HOLD-DIVIDEND
624600         GO  TO  R5190.
624650     IF  HOLD-NO3 GREATER THAN WMS-STMT-PAGE
624700         MOVE HOLD-NO3 TO WMS-STMT-PAGE.
624750 R5191.
624800     MOVE WMS-STMT-LINES TO EX07-STMT-LINES.
624850     MOVE PAGE-LINES TO EX07-STMT-PG-LINES.
624900     MOVE WMS-STMT-PAGE TO EX07-STMT-PAGES.
624950     IF WMS-STMT-LINES GREATER THAN ZERO
625000         OR EX07-STMT-PAGES EQUAL TO ZERO
625050         ADD +1 TO EX07-STMT-PAGES.
625100     IF  EX07-RESET EQUAL '0'
625150         MOVE HOLD-STMT-LINES TO WMS-STMT-LINES
625200         MOVE HOLD-STMT-PAGES TO WMS-STMT-PAGE.
625250     MOVE WMS-STMT-BEGIN-BAL TO EX07-BEG-BAL, EX07-DDA-BAL.       IM004
625271     IF  WMS-LOAN-TRLR EQUAL '1'                                  IM004
625278         MOVE WMS-BEGIN-BAL TO EX07-LOAN-BAL                      IM004
625281         MOVE WMS-PRIN-BAL  TO EX07-LOAN-PRIN-BAL                 IM008
625282         MOVE WMS-PREV-BAL  TO EX07-LOAN-PREV-BAL                 IM008
625285     ELSE                                                         IM004
625292         MOVE +0.00         TO EX07-LOAN-BAL                      IM008
625294                               EX07-LOAN-PRIN-BAL                 IM008
625296                               EX07-LOAN-PREV-BAL.                IM008
625300     IF WMS-SAVINGS-TRLR EQUAL TO '1'
625350         MOVE WMS-INT-BEG-BAL TO EX07-BEG-SAV-BAL, EX07-SAV-BAL   IM004
625360         SUBTRACT EX07-SAV-BAL FROM EX07-DDA-BAL                  IM004
625400     ELSE
625450         MOVE ZERO TO EX07-BEG-SAV-BAL, EX07-SAV-BAL.             IM004
625500     MULTIPLY HOLD-NO1 BY EX07-STMT-PAGES GIVING HOLD-NO5.
625550     ADD HOLD-NO5 TO DDA-STMT-FORMAT (EX07-FORMAT)                0902970
625551                     WS-GL-DDA-STMT-FORMAT (EX07-FORMAT).         0902970
625600 R5192.
625650     IF  WBC-ZIP-SORT (EX07-FORMAT) EQUAL '1'                     0266741
625700         MOVE WMS-ZIP-SAVE TO EX07-ZIP-CODE
625750     ELSE
625800         MOVE SPACES TO EX07-ZIP-CODE.
625850     IF (WMS-SC-REL-CODE EQUAL '3' OR '5')                        IM007
625870     AND WMS-SC-REL-NO NOT EQUAL WMS-CONTROL-KEY                  IM007
625950         MOVE WMS-SC-REL-NO TO EX07-PRIMARY-ACCT
626000     ELSE
626050         MOVE SPACES TO EX07-PRIMARY-ACCT.
626100     IF  WMS-COMBINED-STAT GREATER THAN +0
626150         MOVE '1' TO EX07-COMB-FILE
626200     ELSE
626250         MOVE '0' TO EX07-COMB-FILE.
626300     MOVE '0' TO EX07-COMB-ONLY.                                  IM003
626400     MOVE WMS-SAVINGS-TRLR TO EX07-SV-TRAILER.
626450     MOVE WMS-LOAN-TRLR TO EX07-LN-TRAILER.
626500     MOVE WMS-IOD-RATE-PTR TO EX07-IOD-PTR.
626550     MOVE WMS-HIFI-INDICATOR TO EX07-HIFI-IND.
626560     MOVE 'N' TO EX07-SV-INV-IND.                                 1004554
626600     IF  WMS-SAVINGS-TRLR EQUAL '1'
626610         MOVE WMS-INT-INV-IND TO EX07-SV-INV-IND                  0316967
626620         IF  WMS-SAV-TIER-PTR GREATER +0                          0316967
626630             MOVE WMS-SAV-TIER-PTR TO EX07-SV-RATE-PTR            0316967
626640         ELSE                                                     0316967
626650             MOVE WMS-INT-RATE TO EX07-SV-RATE-PTR                0316967
626700     ELSE
626750         MOVE ZERO TO EX07-SV-RATE-PTR.
627100     MOVE WBC-CAPTURE-DATE TO EX07-STMT-DATE.                     0266741
627150     MOVE STMT-CYCLE-DAYX TO WMS-LAST-STMT-CY-DAYX.               IM004
627160     IF  STMT-CYCLE-DAYX GREATER THAN '1'                         IM004
627200         ADD STMT-CYCLE-DAY TO EX07-STMT-DA
627250         SUBTRACT +1 FROM EX07-STMT-DA.
627255     IF  WMS-LOAN-TRLR EQUAL '1'                                  IM008
627260         MOVE WMS-INT-RATE-PTR TO EX07-LN-RATE-PTR                IM008
627265         MOVE WMS-SPLIT-RATE-SCHD TO EX07-LN-SPLIT-SCHED          IM008
627270         PERFORM R5160 THRU R5169-EXIT                            IM008
627275     ELSE                                                         IM008
627280         MOVE SPACES TO EX07-LN-BILL-CY-DATE                      IM008
627285         MOVE ZERO   TO EX07-LN-BILL-CY-DAYS                      IM008
627290                        EX07-LN-STMT-CY-DAYS                      IM008
627295         MOVE ZERO TO EX07-LN-RATE-PTR, EX07-LN-SPLIT-SCHED.      IM008
627297     PERFORM X6000-TIS-CALC-APY THRU X6000-TIS-EXIT.              1004015
627300 R5192-EXIT. EXIT.
627307 R5194.                                                           IM003
627313     IF  WMS-NME-ADDR-TLRS EQUAL +1                               IM003
627319         MOVE +1 TO EX07-ADDR-PTR                                 IM003
627321         MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY                   9915850
627325         GO  TO  R5194-E.                                         IM003
627331     IF  WMS-NME-ADDR-TLRS EQUAL +0                               IM003
627337         MOVE +0 TO EX07-ADDR-PTR                                 IM003
627343         GO  TO  R5194-E.                                         IM003
627349     MOVE +1 TO Y.                                                IM003
627355 R5194-A.                                                         IM003
627361     IF  WMS-NAME-ADDR-TYPE (Y) EQUAL '5'                         IM003
627362         MOVE +1 TO Z                                             IM003
627363         GO TO R5194-B.                                           IM003
627367     ADD +1 TO Y.                                                 IM003
627369     IF  Y EQUAL +9                                               9915845
627373     OR  Y GREATER THAN WMS-NA-NO-LINES-1                         9915845
627379         MOVE +1 TO EX07-ADDR-PTR                                 IM003
627381         MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY                   9915850
627385         GO  TO  R5194-E.                                         IM003
627391     GO  TO  R5194-A.                                             IM003
627397 R5194-B.                                                         IM003
627403     IF  WMS-NA-USE-CODE-1 (Y) EQUAL '1' OR ' '                   IM003
627409         MOVE +1 TO EX07-ADDR-PTR                                 IM003
627411         MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY                   9915850
627415         GO  TO  R5194-E.                                         IM003
627420 R5194-B1.                                                        9915850
627421     IF  WMS-NAME-ADDR-TYPE-2 (Z) EQUAL '5'                       9915850
627422         GO TO R5194-B2.                                          9915850
627423     ADD +1 TO Z.                                                 9915850
627424     IF  Z GREATER THAN WMS-NA-NO-LINES-2                         9915850
627425         MOVE +1 TO EX07-ADDR-PTR                                 9915850
627426         MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY                   9915850
627427         GO TO R5194-E.                                           IM003
627428     GO TO R5194-B1.                                              IM003
627429 R5194-B2.                                                        IM003
627430     IF  WMS-NA-NO-STMTS-1 (Y) EQUAL +0                           IM003
627431         IF  WMS-NA-NO-STMTS-2 (Z) EQUAL +0                       IM003
627433             MOVE +1 TO EX07-ADDR-PTR                             IM003
627435             MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY               9915850
627439             GO  TO  R5194-E.                                     IM003
627445     MOVE +1 TO X.                                                IM003
627451 R5194-C.                                                         IM003
627457     IF  X GREATER THAN WMS-NA-NO-STMTS-1 (Y)                     IM003
627463         GO  TO  R5194-D.                                         IM003
627469     MOVE +1 TO EX07-ADDR-PTR.                                    IM003
627471     MOVE WMS-NA-COUNTRY TO EX07-NA-COUNTRY.                      9915850
627475     PERFORM WRITE-EX-MST THRU WRITE-EXIT1.                       IM003
627481     ADD +1 TO X.                                                 IM003
627487     IF  X GREATER THAN WMS-STMT-DUPL                             IM003
627493         GO  TO  R5194-X.                                         IM003
627499     GO  TO  R5194-C.                                             IM003
627505 R5194-D.                                                         IM003
627511     MOVE +2 TO EX07-ADDR-PTR.                                    IM003
627513     MOVE WMS-NA-COUNTRY-2 TO EX07-NA-COUNTRY.                    9915850
627517     PERFORM WRITE-EX-MST THRU WRITE-EXIT1.                       IM003
627523     ADD +1 TO X.                                                 IM003
627529     IF  X GREATER THAN WMS-STMT-DUPL                             IM003
627535         GO  TO  R5194-X.                                         IM003
627541     GO  TO  R5194-D.                                             IM003
627547 R5194-E.                                                         IM003
627553     PERFORM WRITE-EX-MST THRU WRITE-EXIT1 WMS-STMT-DUPL TIMES.   IM003
627559 R5194-X.                                                         IM003
627560     IF  WMS-NB-ALT-NA-IND EQUAL '1'                              9915868
627561         NEXT SENTENCE                                            9915868
627562     ELSE                                                         9915868
627563         GO TO R5194-Z.                                           9915868
627564*                                                                 9915868
627565     MOVE WMS-CONTROL-KEY          TO  IMN-CONTROLS-WO-USE.       9915868
627566     MOVE 'ST'                     TO  IMN-USE-CODE.              9915868
627567     MOVE 'K'                      TO  I-O-CONTROL-OPERATOR.      9915868
627568     MOVE 'I'                      TO  I-O-CONTROL-ACCESS.        9915868
627569     CALL 'IMNMAMV'             USING  I-O-CONTROL-AREA           9915868
627570                                       IMN-MASTER-RECORD.         9915868
627571*                                                                 9915868
627572     IF  I-O-88-NOT-FOUND                                         9915868
627573         MOVE WMS-CONTROL-KEY      TO  E05-KEY                    9915868
627574         MOVE 002                  TO  SIMESS-MESS-NO             9915868
627575         MOVE EMSG-05              TO  SIMESS-OPTIONAL-MESSAGE    9915868
627576         CALL 'SIMESS'          USING  SIMESS-AREA                9915868
627577         GO TO R5194-Z.                                           9915868
627578*                                                                 9915868
627579     MOVE +10                    TO EX07-ADDR-PTR.                9915868
627580     PERFORM R5174 THRU R5174-EXIT IMN-NBR-ADDRS TIMES.           9915868
627581*                                                                 9915868
627582 R5194-Z.                                                         9915868
627583     MOVE SPACES TO IMEX-INFO.                                    9915868
627584     MOVE SPACES TO EX07-REQ-BY.                                  9915868
627585 R5195.  EXIT.                                                    9915868
627600 R5196.
627650     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO R5200.
627700 R5197.
627710     IF  LOAN-AGGR-SW EQUAL 'N'                                   IM006
627720         GO TO R5198.                                             2016432
627750     IF WMS-LOAN-AGGR-DAYS EQUAL TO ZERO
627800         ADD +.50, WMS-PRIN-BAL GIVING WMS-PREV-AVG-BAL (1)
627850         MOVE WMS-PRIN-BAL TO WMS-LN-STMT-AVG-BAL
627900     ELSE
627950         ADD WMS-CURR-AGGR1  WMS-PREV-AGGR1
628000             WMS-CURR-AGGR2  WMS-PREV-AGGR2
628050             WMS-CURR-AGGR3  WMS-PREV-AGGR3
628100             GIVING HOLD-AMT13                                    IM008
628120         DIVIDE WMS-LOAN-AGGR-DAYS INTO HOLD-AMT13                IM008
628140         MOVE HOLD-AMT13 TO WMS-LN-STMT-AVG-BAL                   IM008
628250         ADD +.50  HOLD-AMT13  GIVING  WMS-PREV-AVG-BAL (1).      0902646
628300     MOVE WMS-LOAN-AGGR-DAYS TO WMS-LN-STMT-CY-DAYS.
628350 R5198.  EXIT.
628400 R5199.
628402     IF  STMT-TODAY EQUAL '1'                                     2016432
628404         MOVE '1' TO WMS-LOAN-STMT-CLEAR.                         2016432
628440     IF  STMT-TODAY EQUAL '1'                                     1004643
628445     AND LOAN-AGGR-SW EQUAL 'F'                                   9915577
628451         MOVE ZERO TO WMS-LOAN-AGGR-DAYS                          1004643
628452                      WMS-CURR-AGGR1   WMS-PREV-AGGR1             1004643
628453                      WMS-CURR-AGGR2   WMS-PREV-AGGR2             1004643
628454                      WMS-CURR-AGGR3   WMS-PREV-AGGR3.            1004643
628460     IF  (PRIME-CALC-FLAG EQUAL '2' OR '3')                       9915698
628465     AND (LOAN-AGGR-SW    EQUAL 'F')                              9915698
628470         PERFORM R7705 THRU R7799-EXIT                            2016432
628480         MOVE '1'                TO SKIP-RATE-RECORD.             9915698
628500 R5200.  EXIT.
628550 R5210.
628600     IF WBC-STMT-ON-OD EQUAL TO '0', GO TO R5300.                 0266741
628650     IF WBC-STMT-ON-OD EQUAL TO '1'                               0266741
628700         IF WMS-CURR-BAL LESS THAN ZERO
628750             MOVE '04' TO IMEX-CODE-2
628800             MOVE '   ' TO EX07-REQ-BY
628850             MOVE '0' TO EX07-RESET
628900             PERFORM R5020 THRU R5045.
628950     SKIP3
629000*    ******** INTERNAL DDA/INTEREST TRANSFER EXCEPTION *****
629020     SKIP1                                                        9915845
629050 R5300.                                                           9915845
629070     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915845
629080         GO  TO  R6000.                                           9915845
629100     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9915845
629104         IF  WMS-CMA-INDICATOR EQUAL '1'                          9916072
629106         OR  WMS-DDA-MAX-FLAG EQUAL '1'                           9916072
629108             GO TO R5301.                                         9916072
629110     GO TO R5310.                                                 9916072
629111 R5301.                                                           9916072
629112     MOVE '04' TO IMEX-REC-NO.                                    IM008
629113     MOVE 'XF' TO IMEX-CODE-1.                                    9916072
629114     IF  WMS-CMA-INDICATOR EQUAL '1'                              9916072
629115         MOVE 'HS' TO IMEX-CODE-1.                                9916072
629116     IF  SWEEP-TODAY EQUAL '1'                                    IM008
629118         MOVE 'HT' TO IMEX-CODE-2                                 IM008
629120     ELSE                                                         IM008
629122         MOVE '  ' TO IMEX-CODE-2.                                IM008
629124     MOVE TRANSFER-AMT TO EX04-AMT.                               IM008
629126     IF  EX04-AMT LESS THAN +0.00                                 IM008
629128         MOVE '7' TO EX04-TYPE                                    IM008
629130         MULTIPLY -1 BY EX04-AMT                                  IM008
629132     ELSE                                                         IM008
629134         MOVE '8' TO EX04-TYPE.                                   IM008
629136     MOVE ZEROES TO EX04-INT-RATE.                                IM008
629138     IF  WMS-INT-RATE EQUAL +0                                    IM008
629139     AND WMS-SAV-TIER-PTR EQUAL +0                                0316967
629140         NEXT SENTENCE                                            IM008
629142     ELSE                                                         IM008
629143         IF  WMS-RATE-TRLR EQUAL '1'                              0527330
629144             MOVE WMS-SAV-CUR-ANN TO EX04-INT-RATE.               0527330
629146     MOVE SPACES TO EX04-SRC-INFORMATION.                         9915845
629150     MOVE ZEROES TO EX04-BATCH                                    0902218
629152                    EX04-SEQ                                      0902218
629154                    EX04-TRACE                                    0902218
629155                    IM-EXC-REF-NUM                                0326947
629156                    EX04-NEW-AMT.                                 0902218
629158     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0902218
629160 R5310.                                                           0902218
629162     IF  TRANSFER-AMT EQUAL ZERO                                  0902218
629164         GO TO R5320.                                             0902218
629165***  REMOVE COMMENTS TO BYPASS CMA ACCOUNTS.          ************1105504
629166*    IF  WMS-SAVINGS-TRLR EQUAL '1'                               1105504
629167*    AND WMS-CMA-INDICATOR EQUAL '1'                              1105504
629168*        GO TO R5320.                                             1105504
629170     ADD TRANSFER-AMT TO WMS-INT-TRAN-AMT WMS-INT-MTD-TRNAMT.     IM006
629200     MOVE TRANSFER-AMT TO HOLD-AMT.                               IM003
629210     IF  HOLD-AMT LESS THAN +0.00                                 IM003
629220         MULTIPLY -1 BY HOLD-AMT.                                 IM003
629230     MOVE WBC-GENERATED-TRANS (23) TO GEN-TRAN-OPTION-HOLD.       0266741
629240     MOVE 'GA' TO IMEX-CODE-2.                                    IM003
629250     MOVE '23' TO EX01-INT-CODE.                                  IM003
629260     IF  TRANSFER-AMT LESS THAN ZERO                              IM003
629270         MOVE '7' TO EX01-TYPE                                    IM003
629280         MOVE ZERO TO EX01-NUMBER                                 IM003
629290         ADD +1 TO FS-CR                                          IM003
629300         ADD +1 TO WMS-INT-CR-NUMBER                              IM003
629310         ADD HOLD-AMT TO WMS-INT-CR-AMT                           IM003
629320     ELSE                                                         IM003
629330         MOVE '8' TO EX01-TYPE                                    IM003
629340         MOVE +1 TO EX01-NUMBER                                   IM003
629350         ADD +1 TO FS-DB                                          IM003
629360         ADD +1 TO WMS-INT-DR-NUMBER                              IM003
629362         ADD +1 TO WMS-INT-MTD-TRANNO                             9916072
629364                   WMS-INT-TRAN-NO                                9916072
629370         ADD HOLD-AMT TO WMS-INT-DR-AMT.                          IM003
629380     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 IM003
629390     PERFORM K7500 THRU K8500.                                    IM003
629400     MOVE 'GB' TO IMEX-CODE-2.                                    IM003
629410     MOVE '23' TO EX01-INT-CODE.                                  IM003
629420     IF  TRANSFER-AMT LESS THAN ZERO                              IM003
629430         MOVE '4' TO EX01-TYPE                                    IM003
629440         MOVE +1 TO EX01-NUMBER                                   IM003
629450         ADD +1 TO FS-DB                                          IM003
629460         ADD +1 TO WMS-STMT-NO-DEBITS                             IM003
629470         ADD HOLD-AMT TO WMS-STMT-DR-AMT                          IM003
629480     ELSE                                                         IM003
629490         MOVE '2' TO EX01-TYPE                                    IM003
629500         MOVE ZERO TO EX01-NUMBER                                 IM003
629510         ADD +1 TO FS-CR                                          IM003
629520         ADD +1 TO WMS-STMT-NO-CREDITS                            IM003
629530         ADD HOLD-AMT TO WMS-STMT-CR-AMT.                         IM003
629540     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 IM003
629550     PERFORM K7500 THRU K8500.                                    IM003
629700     SKIP3
629750*    ***********  KITING SUSPECT DETERMINATION  ************
629800     SKIP1
629850 R5320.
629860     IF  BYPASS-ACTIVITY-SW EQUAL '1',  GO  TO  R6000.            IM004
629900     IF WBC-KITING-SUSP EQUAL TO '0', GO TO R5400.                0266741
629940     IF (WMS-TARGET-AMT-TRLR EQUAL '1') AND                       IM006
629942        (WMS-TARGET-DELETE NOT EQUAL '2')                         IM006
629944         GO TO R5350.                                             IM006
629950     IF  WMS-KITING-SUSP-TRLR EQUAL '0', GO TO R5330.             IM006
629970 R5325.                                                           IM006
630060     MOVE WBC-KITE-SUSP-PHASE TO IM31-PH2.                        0266741
630070     IF  IM31-PH2 EQUAL SPACES                                    IM006
630080         GO TO R5330.                                             IM006
630100     CALL 'SILINK' USING IM31-PHASE                               IM006
630140                           KITE-RATIO-PARAMETERS                  IM006
630180                           DDA-WRKBCR-5                           0266741
630220                           MASTER-AREA.                           IM006
630260******************************************************************IM006
630265*  WK-KITE-FLAG INDICATES WHETHER AN EXCEPTION IS PRODUCED FOR   *IM006
630270*  KITING SUSPECTS.  THE VALUE OF WK-KITE-FLAG IS DETERMINED IN  *IM006
630275*  THE KITING SUSPECT ROUTINE (IM31KS10).  IF WK-KITE-FLAG HAS A *IM006
630280*  VALUE OF 'N', AN EXCEPTION IS PRODUCED.                       *IM006
630285******************************************************************IM006
630290     IF  WK-KITE-FLAG EQUAL 'N'                                   IM006
630300         ADD +1 TO WMS-KITING-SUSP-DAYS                           IM006
630340         ADD +1 TO WMS-KITE-YTD-SUSP-DAYS                         IM006
630380         MOVE '17' TO IMEX-REC-NO                                 IM006
630420         MOVE 'M2' TO IMEX-CODE-1                                 IM006
630460         MOVE '  ' TO IMEX-CODE-2                                 IM006
630500         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  IM006
630540         MOVE 'F' TO WK-KITE-FLAG.                                IM006
630541 R5330.                                                           IM006
630542     IF  POST-TODAY EQUAL '0'                                     IM006
630543         GO TO R5350.                                             IM006
630544     IF  WMS-TODAYS-DEBITS EQUAL ZERO                             IM006
630545         GO TO R5350.                                             IM006
630546     MOVE WMS-TODAYS-CREDITS TO HOLD-AMT11.                       IM006
630547     IF  WBC-KITING-SUSP EQUAL '2'                                0266741
630548         ADD WMS-PREV-DAY-CR TO HOLD-AMT11.                       IM006
630549     IF  HOLD-AMT11 EQUAL ZERO                                    IM006
630550         GO TO R5350.                                             IM006
630551     IF (WMS-CURR-BAL - HOLD-AMT11) NOT LESS THAN +0              IM006
630552         GO TO R5350.                                             IM006
630553     ADD +1 TO WMS-KITE-CONSEC-DAYS, WMS-MTD-KITING-SUSP.         IM006
630560     MOVE '02' TO IMEX-REC-NO.                                    IM006
630561     MOVE 'I7' TO IMEX-CODE-1.                                    IM006
630563     MOVE WMS-TODAYS-DEBITS TO EX02-BAL.                          IM006
630565     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     IM006
630567     GO TO R5400.                                                 IM006
630569 R5350.                                                           IM006
630571     MOVE ZERO TO WMS-KITE-CONSEC-DAYS.                           IM006
630580     SKIP3                                                        IM006
631000*    ******  REPORTABLE BALANCE CHANGE DETERMINATION  ******
631050     SKIP1
631100 R5400.
631150     IF WMS-BAL-CHNG EQUAL TO ZERO, GO TO R5500.
631200     IF WMS-CURR-BAL EQUAL TO ACCT-BAL-IN, GO TO R5500.
631250     SUBTRACT ACCT-BAL-IN FROM WMS-CURR-BAL GIVING HOLD-AMT11.
631300     IF HOLD-AMT11 LESS THAN ZERO
631350         MULTIPLY -1 BY HOLD-AMT11.
631400     IF HOLD-AMT11 LESS THAN WBC-BAL-CHNG (WMS-BAL-CHNG)          0266741
631450         GO TO R5500.
631500     MOVE '02' TO IMEX-REC-NO.
631550     MOVE 'H6' TO IMEX-CODE-1.
631600     MOVE ACCT-BAL-IN TO EX02-BAL.
631650     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
631700     SKIP3
631750*    ****************  OVERDRAFT FOLLOW-UP  ****************
631800     SKIP1
631850 R5500.
631900     IF  WMS-OD-ACCRUAL-TRLR NOT EQUAL '1'
631950         GO TO R5600.
632000 R5510.
632050     IF  WMS-OD-ACCRL-BAL NOT LESS THAN ZERO
632100         MOVE SPACES TO WMS-DATE-INTO-OD1
632150                        WMS-DATE-INTO-OD2
632200                        WMS-DATE-INTO-OD3
632205                        WMS-DATE-INTO-OD4                         9915845
632210                        WMS-DATE-INTO-OD5                         9915845
632215                        WMS-DATE-INTO-OD6                         9915845
632220                        WMS-DATE-INTO-OD7                         9915845
632225                        WMS-DATE-INTO-OD8                         9915845
632230                        WMS-DATE-INTO-OD9                         9915845
632250         GO TO R5600.
632300     MULTIPLY WMS-OD-ACCRL-BAL BY -1 GIVING HOLD-OD-BAL.
632350     IF  WMS-DATE-INTO-OD1 EQUAL SPACES
632400         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INTO-OD1.              0266741
632410     MOVE +0 TO U.                                                9915845
632420     PERFORM R5515 THRU R5515-EXIT.                               9915845
632430     GO TO R5600.                                                 9915845
632800 R5515.                                                           9915845
632810     ADD +1 TO U.                                                 9915845
632830     IF  U GREATER THAN 8                                         9915845
632840         GO TO R5515-EXIT.                                        9915845
632850     IF  WMS-OD-LIMIT-1-TO-8 (U) EQUAL SPACE                      9915845
632860         GO TO R5515.                                             9915845
632862     IF  WMS-OD-LIMIT-1-TO-8N (U) NOT NUMERIC                     9915845
632864         GO TO R5515.                                             9915845
632870     MOVE WMS-DATE-INTO-OD-2-TO-9 (U) TO HOLD-OD-DATE.            9915845
632880     IF  WMS-OD-LIMIT-1-TO-8 (U) EQUAL '0' OR 'S' OR 'L'          9915845
632890         MOVE WMS-OD-LIMIT-AMT-1-TO-8 (U) TO HOLD-OD-LIMIT        9915845
632900     ELSE                                                         9915845
632910         MOVE WMS-OD-LIMIT-1-TO-8 (U) TO T                        9915845
632920         MOVE WBC-OD-LIMIT (T) TO HOLD-OD-LIMIT.                  0266741
632922     IF  U GREATER THAN 1                                         9915845
632924     AND HOLD-OD-LIMIT EQUAL +0                                   9915845
632926         MOVE SPACES          TO HOLD-OD-DATE                     9915845
632928     ELSE                                                         9915845
632930         PERFORM R5520 THRU R5520-EXIT.                           9915845
632940     MOVE HOLD-OD-DATE TO WMS-DATE-INTO-OD-2-TO-9 (U).            9915845
632950     GO TO R5515.                                                 9915845
632960 R5515-EXIT.                                                      9915845
632970     EXIT.                                                        9915845
633300 R5520.
633350     IF  HOLD-OD-BAL GREATER THAN HOLD-OD-LIMIT
633400         IF  HOLD-OD-DATE EQUAL SPACES
633450             MOVE WBC-CAPTURE-DATE TO HOLD-OD-DATE.               0266741
633500     IF  HOLD-OD-BAL NOT GREATER THAN HOLD-OD-LIMIT
633550         IF  HOLD-OD-DATE NOT EQUAL SPACES
633600             MOVE SPACES TO HOLD-OD-DATE.
633650 R5520-EXIT.
633700     EXIT.
633750     SKIP3
633800 R5600.
633810*----------------------------------------------------------------*1105504
633811*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
633812*----------------------------------------------------------------*1105504
633815     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
633816     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
633818         GO TO R6000.                                             1105504
633820*----------------------------------------------------------------*1010099
633822*    CALCULATE QTD AGGREGATES AFTER ALL ACTIVITY IS POSTED.      *1010099
633824*----------------------------------------------------------------*1010099
633826     MOVE WBC-ACCRUAL-DAYS TO HOLD-ACCRUAL-DAYS.                  1010099
633828     PERFORM C2315 THRU C2315-EXIT.                               1010099
633850     IF  WMS-DDA-BAL LESS THAN ZERO
633900         IF  DDA-BALANCE-IN NOT LESS THAN ZERO
633950             MOVE WBC-CAPTURE-DATE TO WMS-DATE-INTO-OD            0266741
634000             GO TO R5620.
634050     IF WMS-INTO-OD-YR-1 EQUAL TO SPACE, GO TO R6000.
634100     IF  WMS-DDA-BAL NOT LESS THAN ZERO
634150         MOVE SPACES TO WMS-DATE-INTO-OD
634200         MOVE ZERO TO WMS-DAYS-OD, WMS-OD-SEC-NOTICE
634202         MOVE ZERO TO WMS-OD-CONSEC-DAYS                          0627540
634203         MOVE ZERO TO WMS-OD-REGE-SUST-CTR                        1020116
634250         GO TO R6000.
634300 R5620.
634350     MOVE WMS-DATE-INTO-OD TO DT-LOW-DATE.
634400     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
634410     CALL 'SIDIF1' USING DATE-AREA.                               9915749
634450     ADD +1 TO RET-DAYS.
634500     MOVE RET-DAYS TO WMS-DAYS-OD.
634502     IF  WBC-OD-CONSEC-BAL EQUAL ZERO                             0627540
634504         MOVE ZERO TO WMS-OD-CONSEC-DAYS                          0627540
634506         GO TO R6000.                                             0627540
634508     MULTIPLY WMS-DDA-BAL BY -1 GIVING HOLD-AMT.                  0627540
634510     IF  HOLD-AMT NOT LESS THAN WBC-OD-CONSEC-BAL                 0627540
634512         ADD WBC-ACCRUAL-DAYS TO WMS-OD-CONSEC-DAYS               0627540
634514     ELSE                                                         0627540
634516         MOVE ZERO TO WMS-OD-CONSEC-DAYS.                         0627540
634550     SKIP3
634600*    *************  STATUS CHANGE PROCESSING  **************
634650     SKIP1
634700 R6000.
634710*----------------------------------------------------------------*1105504
634711*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
634712*----------------------------------------------------------------*1105504
634715     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
634716     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
634718         GO TO R6190.                                             1105504
413669     IF WMS-STATUS NOT EQUAL TO '00'
413369        IF WMS-STATUS = '01'                          AND
413369           (WMS-ACCT-TYPE = '137' OR '138')
413369           NEXT SENTENCE
413369        ELSE
413369           GO TO R6190.
634796     MOVE WMS-INACTIVE TO HOLD-STATUS-OPT.                        0717564
634800     IF WMS-CURR-BAL NOT EQUAL TO ZERO, GO TO R6100.
634850     IF WMS-CLS-OVRRIDE EQUAL TO '1', GO TO R6100.
634900     IF WMS-LOAN-TRLR EQUAL TO '1'
634950         IF (WMS-PRIN-BAL GREATER THAN ZERO
635000         OR  WMS-INTRST-BAL GREATER THAN ZERO
635050         OR  WMS-OTHER-CHGS GREATER THAN ZERO)
635100             GO  TO  R6100.
635150     IF WMS-TARGET-AMT-TRLR NOT EQUAL TO '0'
635200         GO TO R6100.
635206     IF  WMS-DAYS-ZERO-BAL + 1 LESS THAN WMS-0BAL-GRACE-DAYS      0902079
635212         GO TO R6100.                                             0902079
635218 R6050.                                                           1010054
635220     IF  WMS-IOD-CYC-ACC-INT EQUAL ZERO                           1010054
635222         GO TO R6060.                                             1010054
635224     IF  WMS-IOD-CYC-ACC-INT NOT LESS THAN WMS-MIN-CR-INT         1010054
635226         GO TO R6100.                                             1010054
635228     ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR2.             1010054
635230     SUBTRACT HOLD-ACCR2 FROM IOD-INT-ACC-ADJ-INT                 1010054
635232                              WS-GL-IOD-INT-ACC-ADJ-INT           1010054
635234                              WMS-IOD-MTD-ACC-INT                 1010054
635236                              WMS-IOD-YTD-ACC-INT.                1010054
635238     SUBTRACT WMS-IOD-CYC-ACC-INT FROM WMS-IOD-TIS-EARN-INT.      1010054
635240     MOVE 'K8' TO IMEX-CODE-1.                                    1010054
635242     MOVE '02' TO IMEX-REC-NO.                                    1010054
635244     MOVE HOLD-ACCR2  TO EX02-BAL.                                1010054
635246     MULTIPLY -1 BY EX02-BAL.                                     1010054
635248     MOVE ZEROS TO WMS-IOD-CYC-ACC-INT.                           1010054
635250     ADD +1 TO SEQ-CTR.                                           1010054
635252     MOVE SEQ-CTR TO EX02-SEQ-NO.                                 1010054
635254     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     1010054
635256     IF  WMS-IOD-TIS-EARN-INT LESS THAN ZERO                      1010054
635258         MOVE ZERO TO WMS-IOD-TIS-EARN-INT.                       1010054
635260     IF  WMS-IOD-MTD-ACC-INT LESS THAN ZERO                       1010054
635262         MOVE ZERO TO WMS-IOD-MTD-ACC-INT.                        1010054
635264     IF  WMS-IOD-YTD-ACC-INT LESS THAN ZERO                       1010054
635266         MOVE ZERO TO WMS-IOD-YTD-ACC-INT.                        1010054
635268                                                                  1010054
635270 R6060.                                                           1010054
635272     IF  WMS-OD-ACCRUAL-TRLR EQUAL '0'                            1010054
635274         GO TO R6070.                                             1010054
635276     IF  WMS-OD-CYC-ACR EQUAL ZERO                                1010054
635278         GO TO R6070.                                             1010054
635280     IF  WMS-OD-CYC-ACR LESS THAN ZERO                            1010054
635282         ADD -.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR2               1010054
635284     ELSE                                                         1010054
635286         ADD +.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR2.              1010054
635288     SUBTRACT HOLD-ACCR2 FROM OD-ACCRL-ADJ-INTRNL                 1010054
635289                              WS-GL-OD-ACCRL-ADJ-INTRNL           1010054
635290                              WMS-OD-MTD-ACR                      1010054
635291                              WMS-OD-YTD-ACR.                     1010054
635292     MOVE ZERO TO WMS-OD-CYC-ACR.                                 1010054
635293     IF  WMS-OD-MTD-ACR LESS THAN ZERO                            1010054
635294         MOVE ZERO TO WMS-OD-MTD-ACR.                             1010054
635295     IF  WMS-OD-YTD-ACR LESS THAN ZERO                            1010054
635296         MOVE ZERO TO WMS-OD-YTD-ACR.                             1010054
635297                                                                  1010054
635298 R6070.                                                           1010054
635299     MOVE '04' TO WMS-STATUS.                                     1010054
635300     MOVE '51'            TO WMS-REASON-CLOSED.                   IMIB004
635302     MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE.           IMIB004
635310     IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
635350         MOVE 'SU' TO IMEX-CODE-1
635400         MOVE 'SD' TO IMEX-CODE-2
635410         MOVE '51' TO EX09-GEN-REASON                             IMIB004
635450         MOVE '09' TO IMEX-REC-NO
635500         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
635550         MOVE '04' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
635600         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
635650         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
635656     IF  WBC-STMT-ON-CLOSED EQUAL '1'                             0266741
635662         MOVE '10' TO IMEX-CODE-2                                 IM005
635668         MOVE '1' TO EX07-RESET                                   IM005
635674         MOVE '   ' TO EX07-REQ-BY                                IM005
635680         PERFORM R5020 THRU R5045                                 IM005
635686         MOVE '1' TO WMS-STMT-CLEAR                               IM005
635687         MOVE '1' TO WMS-IT-TRAN-FLAG1                            9915749
635692         PERFORM R5196 THRU R5200.                                IM005
635700*                                                                 0902079
635703*    SET REASON CLOSED FOR ZERO BALANCE                           0902079
635706*                                                                 0902079
635709     MOVE WBC-CAPTURE-MO TO WMS-CLOSED-MO.                        0266741
635712     MOVE WBC-CAPTURE-DA TO WMS-CLOSED-DA.                        0266741
635715     MOVE WBC-CAPTURE-YR TO WMS-CLOSED-YR.                        0266741
635718     IF  WBC-CAPTURE-YR LESS THAN WBC-NEXT-CENT-YR                0266741
635721         MOVE '20' TO WMS-CLOSED-CENT                             1004775
635724     ELSE                                                         0902079
635727         MOVE '19' TO WMS-CLOSED-CENT.                            0902079
635728     IF  WMS-REASON-CLOSED = '00' OR '  '                         1105504
635730         MOVE '02' TO WMS-REASON-CLOSED.                          1105504
635733     GO TO R7000.                                                 0902079
635750 R6100.
635800     MOVE WMS-DATE-LAST-CUST-ACTIVITY TO DT-LOW-DATE.
635810 R6105.                                                           2015872
635900     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
635902     IF  HOLD-STATUS-OPT NOT EQUAL '2'                            0717564
635950         CALL 'SIDIF1' USING DATE-AREA                            0717564
635952     ELSE                                                         0717564
635954         CALL 'SIDIF2' USING DATE-AREA.                           0717564
635962     IF  WMS-DATE-LAST-CONTACT EQUAL SPACES                       9915749
635964         GO TO R6110.                                             9915749
635968     MOVE RET-DAYS TO DLCA-DAYS.                                  1105504
635970     MOVE WMS-DATE-LAST-CONTACT TO DT-LOW-DATE.                   1105504
635972     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
635973     IF  HOLD-STATUS-OPT NOT EQUAL '2'                            0717564
635974         CALL 'SIDIF1' USING DATE-AREA                            0717564
635975     ELSE                                                         0717564
635976         CALL 'SIDIF2' USING DATE-AREA.                           0717564
635977     IF  RET-DAYS GREATER THAN DLCA-DAYS                          0717564
635978         MOVE DLCA-DAYS TO RET-DAYS.                              1105504
636000 R6110.  EXIT.                                                    9915749
636050 R6120.
636060     IF WMS-INACTIVE EQUAL TO '0', GO TO R6140.
636101*----------------------------------------------------------------*1105504
636102*    CREATE NEW REPORT FOR SUSPECTED INACTIVE ACCOUNTS ONLY      *1105504
636103*    ON FIRST BUSINESS DAY OF MONTH. ALSO ALLOW FOR INACTIVE     *1105504
636104*    STATUS BASED ON MONTHS. CREATE 1ST INACTIVE NOTICE          *1105504
636105*    AND 2ND INACTIVE NOTICE WHEN NEEDED.                        *1105504
636106*----------------------------------------------------------------*1105504
636107     IF ((WMS-INACTIVE EQUAL TO '1') AND                          1105504
636108         (WMS-NB-INACT-NOT LESS THAN 1))                          1105504
636109         IF  WBC-PREV-MONTH-END EQUAL TO '1'                      0266741
636110             IF  RET-DAYS NOT LESS THAN WMS-INACTIVE-DAYS - +60   1105504
636111                 MOVE 'DI' TO IMEX-CODE-1                         1105504
636112                 MOVE 'D4' TO IMEX-CODE-2                         0261784
636113                 MOVE '17' TO IMEX-REC-NO                         1105504
636114                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT          1105504
636115                 MOVE 1 TO WMS-NB-INACT-NOT                       1105504
636116                 GO TO R7000.                                     1105504
636117     IF  WMS-INACTIVE EQUAL TO '1'                                1105504
636118         IF  WMS-STATUS NOT EQUAL '07'                            1105504
636119             IF  RET-DAYS NOT LESS THAN WMS-INACTIVE-DAYS         1105504
636120                 MOVE 'DI' TO IMEX-CODE-1                         1105504
636121                 MOVE 'D5' TO IMEX-CODE-2                         0261784
636122                 MOVE '17' TO IMEX-REC-NO                         1105504
636123                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT          1105504
636124                 MOVE 2 TO WMS-NB-INACT-NOT                       1105504
636125             ELSE                                                 1105504
636126                 GO TO R7000.                                     1105504
636127     IF  WMS-INACTIVE EQUAL TO '1'                                1105504
636128         IF ((WMS-STATUS EQUAL TO '07') AND                       1105504
636129            (WMS-NB-INACT-NOT LESS THAN 3))                       1105504
636130             IF  RET-DAYS NOT LESS THAN WMS-INACTIVE-DAYS + +30   1105504
636131                 MOVE 'DI' TO IMEX-CODE-1                         1105504
636132                 MOVE 'D6' TO IMEX-CODE-2                         0261784
636133                 MOVE '17' TO IMEX-REC-NO                         1105504
636134                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT          1105504
636135                 MOVE 3 TO WMS-NB-INACT-NOT                       1105504
636136             ELSE                                                 1105504
636137                 GO TO R7000.                                     1105504
636138     IF ((WMS-INACTIVE EQUAL TO '2') AND                          1105504
636139         (WMS-NB-INACT-NOT LESS THAN 1))                          1105504
636140         IF  WBC-PREV-MONTH-END EQUAL TO '1'                      0266741
636141             IF  RET-DAYS / +30 NOT LESS THAN                     1105504
636142                                        WMS-INACTIVE-DAYS - +2    1105504
636143                 MOVE 'DI' TO IMEX-CODE-1                         1105504
636144                 MOVE 'D4' TO IMEX-CODE-2                         0261784
636145                 MOVE '17' TO IMEX-REC-NO                         1105504
636146                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT          1105504
636147                 MOVE 1 TO WMS-NB-INACT-NOT                       1105504
636148                 GO TO R7000.                                     1105504
636149     IF  WMS-INACTIVE EQUAL TO '2'                                1105504
636150         IF  WMS-STATUS NOT EQUAL TO '07'                         1105504
636151             IF  RET-DAYS / +30 NOT LESS THAN  WMS-INACTIVE-DAYS  1105504
636152                 MOVE 'DI' TO IMEX-CODE-1                         1105504
636153                 MOVE 'D5' TO IMEX-CODE-2                         0261784
636154                 MOVE '17' TO IMEX-REC-NO                         1105504
636155                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT          1105504
636156                 MOVE 2 TO WMS-NB-INACT-NOT                       1105504
636157             ELSE                                                 1105504
636158                 GO TO R7000.                                     1105504
636159     IF  WMS-INACTIVE EQUAL TO '2'                                1105504
636160         IF ((WMS-STATUS EQUAL TO '07') AND                       1105504
636161            (WMS-NB-INACT-NOT LESS THAN 3))                       1105504
636162            IF RET-DAYS / +30 NOT LESS THAN WMS-INACTIVE-DAYS + +11105504
636163                MOVE 'DI' TO IMEX-CODE-1                          1105504
636164                MOVE 'D6' TO IMEX-CODE-2                          0261784
636165                MOVE '17' TO IMEX-REC-NO                          1105504
636166                PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT           1105504
636167                MOVE 3 TO WMS-NB-INACT-NOT                        1105504
636168            ELSE                                                  1105504
636169                GO TO R7000.                                      1105504
636170******************************************************************IMIBXXX
636171*    CALL RUTINA INACTIVAD (READ ( IB-SW = 1 )                    IMIBXXX
636172******************************************************************IMIBXXX
636173     MOVE 'IM31IBST'      TO IB-RATE-PGM.                         IMIBXXX
636174     MOVE 1               TO IB-SW.                               IMIBXXX
636175     MOVE WMS-CONTROL-KEY TO IB-CONTROL-KEY-ST.                   IMIBXXX
636176     MOVE WMS-ACCT-TYPE   TO IB-ACCT-TYPE-ST.                     IMIBXXX
636177     MOVE WMS-CURR-BAL    TO IB-CURR-BAL-ST.                      IMIBXXX
636178     CALL 'SILINK' USING IB-RATE-PGM                              IMIBXXX
636179                         IB-SW                                    IMIBXXX
636180                         IB-CONTROLS-ST                           IMIBXXX
636181                         IB-OUTPUT-ST.                            IMIBXXX
636182     IF  IB-RETURN-CODE-ST NOT EQUAL 0000                         IMIBXXX
636183         MOVE IB-RATE-PGM  TO SIMESS-PROGRAM                      IMIBXXX
636184         MOVE 505 TO SIMESS-MESS-NO                               IMIBXXX
636185         MOVE 'READ FAILED IMSTP' TO SIMESS-OPTIONAL-MESSAGE      IMIBXXX
636186         CALL 'SIMESS' USING SIMESS-AREA                          IMIBXXX
636187         GO TO Z9900.                                             IMIBXXX
636188     IF  IB-NO-INGRESO-ST                                         IMIBXXX
636189         GO TO  R7000.                                            IMIBXXX
636200     MOVE '07' TO WMS-STATUS.
636210***************************************************************** IMUP006
636212** SE AGREGA LA SIGUIENTE INSTRUCCION, PORQUE NO ES INVOCADO   ** IMUP006
636214** EL PROGRAMA IM31GLTS AL CAMBIAR STATUS EN FORMA AUTOMATICA  ** IMUP006
636216***************************************************************** IMUP006
636218     MOVE '07   ' TO WMS-GL-COST-CTR (5).                         IMUP006
636220     MOVE '51'            TO WMS-REASON-CLOSED.                   IMIB004
636222     MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE.           IMIB004
636250     IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
636255         MOVE '51' TO EX09-GEN-REASON                             IMIB004
636300         MOVE 'SU' TO IMEX-CODE-1
636350         MOVE 'SD' TO IMEX-CODE-2
636400         MOVE '09' TO IMEX-REC-NO
636450         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
636500         MOVE '07' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
636550         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
636600         MOVE '*'          TO EX09-GEN-STAT
636650         MOVE DDA-AUT-CHG-INA-LIT(SIWS-LANG-SUB)                  0266741
636700             TO EX09-GEN-DESC
636750         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT                  1105504
636800         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.            0266741
636810*----------------------------------------------------------------*1105504
636812*    ALLOW ACCOUNTS TO GO FROM INACTIVE TO DORMANT STATUS.       *1105504
636814*----------------------------------------------------------------*1105504
636850*    GO TO R7000.                                                 1105504
636900 R6140.
636910*----------------------------------------------------------------*1105504
636911*    BYPASS DORMANT STATUS IF THIS STATIC RUN.                   *1105504
636912*----------------------------------------------------------------*1105504
636920     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
636922     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
636924         GO TO R7000.                                             1105504
636926     MOVE WMS-DORMANT TO HOLD-STATUS-OPT.                         0717564
636928     PERFORM R6100 THRU R6110.                                    0717564
636950     IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3'               0437111
637000         IF  WMS-HIFI-DORM GREATER THAN ZERO
637050             GO  TO  R6145.
637100     IF WMS-DORMANT EQUAL TO '0', GO TO R7000.
637150     IF WMS-DORMANT EQUAL TO '1'
637200         IF RET-DAYS LESS THAN WMS-DORMANT-DAYS
637250             GO TO R7000
637300         ELSE GO TO R6150.
637350     IF RET-DAYS / +30 LESS THAN WMS-DORMANT-DAYS, GO TO R7000.
637400     GO TO R6150.
637450 R6145.
637500     IF WMS-HIFI-DORM EQUAL TO '1'
637550         IF RET-DAYS LESS THAN WMS-HIFI-DORM-DAYS
637600             GO TO R7000
637650         ELSE GO TO R6150.
637700     IF RET-DAYS / +30 LESS THAN WMS-HIFI-DORM-DAYS, GO TO R7000.
637750 R6150.
637800     IF WBC-STMT-ON-DORMANT EQUAL TO '1'                          0266741
637850         MOVE '08' TO IMEX-CODE-2
637900         MOVE '0' TO EX07-RESET
637950         MOVE '   ' TO EX07-REQ-BY
638000         PERFORM R5020 THRU R5045.
638050     MOVE '06' TO WMS-STATUS.
638100     IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
638150         MOVE 'SU' TO IMEX-CODE-1
638200         MOVE 'SD' TO IMEX-CODE-2
638250         MOVE '09' TO IMEX-REC-NO
638300         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
638350         MOVE '06' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
638400         MOVE WMS-CURR-BAL TO EX09-CUR-BAL
638450         MOVE '*'          TO EX09-GEN-STAT
638500         MOVE DDA-AUTO-CHGD-DOR-LIT(SIWS-LANG-SUB)                0266741
638550             TO EX09-GEN-DESC
638600         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
638650     MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.                0266741
638652*----------------------------------------------------------------*1105504
638654*    CHARGE DORMANT FEE.                                         *1105504
638656*----------------------------------------------------------------*1105504
638658     IF  WMS-CURR-BAL NOT LESS THAN +0.00                         1105504
638660         PERFORM R6160-DORM-FEE THRU R6169-DORM-EXIT.             1105504
638662     IF  WMS-CURR-BAL EQUAL TO +0.00                              1105504
638663     AND WMS-IOD-CYC-ACC-INT EQUAL ZERO                           1010054
638664         IF  WMS-CLS-OVRRIDE NOT EQUAL '1'                        1105504
638666             GO TO R6060.                                         1010054
638668     GO TO R7000.                                                 1105504
638670 R6160-DORM-FEE.                                                  1105504
638674     IF  WMS-MMDA-INDICATOR NOT EQUAL TO '1' AND '2' AND '3'      0437111
638676         IF  WBC-NB-DDA-DORM-FEE-FREQ NOT EQUAL TO '1'            0266741
638678             GO TO R6169-DORM-EXIT                                1105504
638680         ELSE                                                     1105504
638682             MOVE WBC-NB-DDA-DORM-FEE-AMT TO HOLD-AMT.            0266741
638684     IF  WMS-MMDA-INDICATOR EQUAL TO '1' OR '2' OR '3'            0437111
638686         IF  WBC-NB-SAV-DORM-FEE-FREQ NOT EQUAL TO '1'            0266741
638688             GO TO R6169-DORM-EXIT                                1105504
638690         ELSE                                                     1105504
638692             MOVE WBC-NB-SAV-DORM-FEE-AMT TO HOLD-AMT.            0266741
638693 R6165-DORM-FEE-CONT.                                             0417164
638694     IF  HOLD-AMT GREATER THAN WMS-CURR-BAL                       1105504
638696         MOVE HOLD-AMT      TO WS-HOLD-DORM-FEE                   1105504
638698         MOVE 'N'           TO IOD-FLAG                           9715504
638700         PERFORM R3835 THRU R3864                                 9715504
638702         MOVE 'F'           TO IOD-FLAG                           9715504
638704         MOVE WS-HOLD-DORM-FEE TO HOLD-AMT                        1105504
638706         IF  HOLD-AMT GREATER THAN WMS-CURR-BAL                   1105504
638708             MOVE WMS-CURR-BAL  TO HOLD-AMT.                      1105504
638709     IF  HOLD-AMT EQUAL +0.00                                     0417164
638710         GO TO R6169-DORM-EXIT.                                   0417164
638712     PERFORM K7500 THRU K8500.                                    1105504
638714     SUBTRACT HOLD-AMT FROM WMS-CURR-BAL, CUR-BAL,                1105504
638716                            CUST-BAL, WMS-DDA-BAL.                1105504
638718     ADD HOLD-AMT TO SERV-CHG-DORM-AMT, WS-GL-SERV-CHG-DORM-AMT.  1105504
638720     ADD +1       TO SERV-CHG-DORM-NO, WS-GL-SERV-CHG-DORM-NO.    1105504
638722     ADD HOLD-AMT TO WMS-NB-TOT-DMT-SC.                           1105504
638724     ADD +1       TO WMS-STMT-NO-DEBITS.                          1105504
638726     ADD HOLD-AMT TO WMS-STMT-DR-AMT,                             0527449
638727                     WBC-REG-TFR-AMT (4), WBC-REG-CALL-AMT (13).  0527449
638728     IF  WMS-IOD-RATE-PTR GREATER THAN ZERO                       1105504
638730     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO                     1105504
638732         ADD +1       TO IOD-DB-NO, WS-GL-IOD-DB-NO               1105504
638734         ADD HOLD-AMT TO IOD-DB-AMT, WS-GL-IOD-DB-AMT             1105504
638736     ELSE                                                         1105504
638738         ADD +1       TO DDA-DB-NO, WS-GL-DDA-DB-NO               1105504
638740         ADD HOLD-AMT TO DDA-DB-AMT, WS-GL-DDA-DB-AMT.            1105504
638742     MOVE WBC-GENERATED-TRANS (1) TO GEN-TRAN-OPTION-HOLD.        0266741
638744     MOVE 'GZ'                   TO IMEX-CODE-2.                  1105504
638746     MOVE '01'                   TO EX01-INT-CODE.                1105504
638748     MOVE '4'                    TO EX01-TYPE.                    1105504
638750     MOVE 'SJ'                   TO GT-MNEUMONIC.                 1105504
638752     MOVE ZERO                   TO EX01-NUMBER.                  1105504
638754     PERFORM WRITE-GEN-TRANS THRU WRITE-GEN-EXIT.                 1105504
638756     ADD HOLD-AMT                TO WMS-IOD-TIS-CYC-FEES.         1105504
638758     MOVE WBC-CAPTURE-DATE       TO WMS-DATE-LAST-SERV-CHG.       0266741
638760 R6169-DORM-EXIT.                                                 1105504
638762     EXIT.                                                        1105504
638770 R6190.                                                           1105504
638772*----------------------------------------------------------------*1105504
638774*    BYPASS ALL ACCOUNT AGING IF THIS IS A STATIC RUN.           *1105504
638776*----------------------------------------------------------------*1105504
638778     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
638780     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
638782         GO TO R7200.                                             1105504
638800     MOVE WMS-STATUS TO HOLD-X.
638810     IF  WMS-STATUS EQUAL '10'                                    1105504
638815         GO TO R7000.                                             1105504
638817     IF  WMS-STATUS EQUAL '11'                                    1010046
638819         GO TO R6800.                                             1010046
638850     GO TO R6800
638900           R6800
638950           R6200
639000           R6300
639050           R6400
639100           R6500
639150           R6600
639200           R6700                                                  IM006
639210           R7000 DEPENDING ON HOLD-9.                             IM006
639250     GO TO R7000.
639300 R6200.
639350     IF  WMS-CURR-BAL NOT EQUAL ZERO
639400         GO TO R6800.
639410     IF  WMS-IOD-CYC-ACC-INT EQUAL ZERO                           1010054
639420         NEXT SENTENCE                                            1010054
639430     ELSE                                                         1010054
639440         IF  WMS-IOD-CYC-ACC-INT NOT LESS THAN WMS-MIN-CR-INT     1010054
639500             GO TO R6800.                                         1010054
639510*----------------------------------------------------------------*1105504
639512*    CHANGE STATUS '03' TO '04' (CLOSED).                        *1105504
639514*----------------------------------------------------------------*1105504
639516     IF  WMS-STATUS NOT EQUAL '03', GO TO R6201.                  1105504
639518     IF  WMS-CURR-BAL NOT EQUAL TO ZERO, GO TO R7000.             1105504
639520     IF  WMS-CLS-OVRRIDE EQUAL TO '1', GO TO R7000.               1105504
639522     IF  WMS-LOAN-TRLR EQUAL TO '1'                               1105504
639524         IF (WMS-PRIN-BAL GREATER THAN ZERO                       1105504
639526         OR  WMS-INTRST-BAL GREATER THAN ZERO                     1105504
639528         OR  WMS-OTHER-CHGS GREATER THAN ZERO)                    1105504
639530             GO TO R7000.                                         1105504
639532     IF  WMS-TARGET-AMT-TRLR NOT EQUAL TO '0'                     1105504
639534         GO TO R7000.                                             1105504
639536     GO TO R6050.                                                 1105504
639538                                                                  0617360
639540 R6201.                                                           0617360
639542     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
639544         GO TO R6202.                                             0617360
639546     SET WMS-PLN-TRLR-IND TO 1.                                   0617360
639548     SET WMS-PLN-TRLR-IND2 TO WMS-PLN-TRLR-CTDT-NO.               0617360
639550     SEARCH WMS-PLN-TRLR-CTDT-TRLR                                0617360
639552         AT END GO TO R6202                                       0617360
639554         WHEN WMS-PLN-TRLR-IND GREATER THAN WMS-PLN-TRLR-IND2     0617360
639556             GO TO R6202                                          0617360
639558         WHEN WMS-PLN-TRLR-CAL-YR (WMS-PLN-TRLR-IND) EQUAL '0'    0617360
639560             MOVE '08' TO WMS-STATUS                              0617360
639562             GO TO R6203.                                         0617360
639564 R6202.                                                           0617360
639566     IF  WMS-LOAN-TRLR EQUAL TO '1'                               0617360
639568     OR  WMS-SAVINGS-TRLR EQUAL TO '1'                            0617360
639570     OR  WMS-OD-ACCRUAL-TRLR EQUAL TO '1'                         IM005
639580     OR  WMS-IOD-YTD-INT-PAID NOT EQUAL ZERO                      IM005
639590     OR  WMS-COMBINED-STAT NOT EQUAL ZERO                         IM005
639595     OR ((WMS-DUAL-YEAR-TRLR EQUAL TO '1') AND                    9915858
639600         (WMS-DUAL-YR-CUR-IOD-INT NOT EQUAL ZERO OR               9915858
639605          WMS-DUAL-YR-CUR-SAV-INT NOT EQUAL ZERO))                9915858
639610* SE ELIMINA EL CAMBIO A 8 POR NO SER NECESARIO EN IB             IMUP006
639700*        MOVE '08' TO WMS-STATUS
639710         MOVE '05' TO WMS-STATUS                                  IMUP006
639750     ELSE                                                         IM005
639780         MOVE '05' TO WMS-STATUS.                                 IM005
639782                                                                  0617360
639784 R6203.                                                           0617360
639810     IF  WK-IM-STATUS-IN NOT EQUAL WMS-STATUS                     IM005
639840         MOVE WMS-CURR-BAL TO EX09-CUR-BAL                        IM005
639870         MOVE 'SU' TO IMEX-CODE-1                                 IM005
639900         MOVE 'SD' TO IMEX-CODE-2                                 IM005
639930         MOVE '09' TO IMEX-REC-NO                                 IM005
639960         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN                   IM005
639990         MOVE WMS-STATUS TO EX09-STATUS-OUT  WK-IM-STATUS-IN      IM005
640020         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM005
640200 R6205.
640250     IF  WBC-STMT-ON-TERMINATED EQUAL '1'                         0266741
640300     OR  WMS-STMT-NO-DEBITS + WMS-STMT-NO-CREDITS NOT EQUAL ZERO
640350         IF STATUS-IN NOT EQUAL TO '08' AND
640400             WMS-STATUS IS EQUAL TO '08'
640450             MOVE '02' TO IMEX-CODE-2
640500             MOVE '1' TO EX07-RESET
640550             MOVE '   ' TO EX07-REQ-BY
640600             PERFORM R5020 THRU R5045
640650             MOVE '1' TO WMS-STMT-CLEAR
640655             MOVE '1' TO WMS-IT-TRAN-FLAG1                        9915749
640700             PERFORM R5196 THRU R5200.
640750 R6205-EXIT. EXIT.
640800 R6210.
640850     MOVE '03' TO IMEX-REC-NO.
640900     IF WMS-STATUS EQUAL TO '05'
640950         MOVE 'I5' TO IMEX-CODE-1
641000     ELSE MOVE 'I4' TO IMEX-CODE-1.
641050     MOVE 'S' TO EX03-CODE.
641100     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
641150     GO TO R6405.
641200 R6300.
641250     IF WMS-CURR-BAL NOT EQUAL TO ZERO
641300         MOVE '00' TO WMS-STATUS
641310*                     WMS-REASON-CLOSED                           0902079
641312         MOVE '51' TO WMS-REASON-CLOSED                           IMIB004
641314         MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE        IMIB004
641320         MOVE SPACES TO WMS-DATE-CLOSED                           0902079
641350         IF WK-IM-STATUS-IN NOT EQUAL WMS-STATUS
641400             MOVE 'SU' TO IMEX-CODE-1
641450             MOVE 'SD' TO IMEX-CODE-2
641500             MOVE '09' TO IMEX-REC-NO
641510             MOVE '51' TO EX09-GEN-REASON                         IMIB004
641550             MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
641600             MOVE '00' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
641650             MOVE WMS-CURR-BAL TO  EX09-CUR-BAL                   0902079
641700             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT
641750             GO TO R7000
641800         ELSE
641850             GO TO R7000.
641900     IF WMS-PURGE EQUAL TO '0', GO TO R7000.
641950     IF WMS-PURGE EQUAL TO '4'
642000         IF WMS-DAYS-ZERO-BAL LESS THAN ( WMS-PURGE-DAYS     +    510351
642010                                          WMS-0BAL-GRACE-DAYS )   510351
642050             GO TO R7000
642100         ELSE
642150             GO TO R6200.
642200     MOVE WMS-PURGE TO HOLD-X2.
642250     IF WMS-STMT-CYCL-CLSD LESS THAN HOLD-92 GO TO R7000.
642300     GO TO R6200.
642350 R6400.
642400     MOVE '03' TO IMEX-REC-NO.
642450     MOVE 'I5' TO IMEX-CODE-1.
642500     MOVE 'M' TO EX03-CODE.
642550     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
642600 R6405.
642650     IF  WMS-STATUS NOT EQUAL '05'
642700         GO TO R6800.
642750     MOVE +1 TO Z.
642800     IF WMS-TRNSFR-AFFL-TRLR EQUAL TO ZERO, GO TO R6430.
642850 R6410.
642900     IF  WMS-TRNSFR-AFFL-FLAG (Z) EQUAL 'A'
642950         MOVE 'I' TO EX11-TYP                                     9915845
643000     ELSE                                                         9915845
643050         MOVE 'T' TO EX11-TYP.                                    9915845
643060     MOVE Z TO EX11-NO.                                           9915845
643100     MOVE WMS-TRANSFER-AFFILIATE-TRAILER (Z) TO EX11-TRLR.
643150 R6416.
643200     MOVE '11' TO IMEX-REC-NO.
643250     MOVE 'C9' TO IMEX-CODE-1.
643300     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
643350 R6419.  EXIT.
643400 R6420.
643450     ADD +1 TO Z.
643500     IF Z GREATER THAN WMS-TRNSFR-AFFL-TRLR
643550         MOVE +1 TO Z
643600     ELSE
643650         GO TO R6410.
643700 R6430.
643750 R6440.
643800     IF WMS-COMBINED-STAT EQUAL TO ZERO, GO TO R6450.
643850 R6442.
643900     MOVE Z TO EX11-NO.
643950     MOVE 'S' TO EX11-TYP.
644000     MOVE WMS-COMBINED-STATEMENT-TRAILER (Z) TO EX11-TRLR.
644050     PERFORM R6416 THRU R6419.
644100     ADD +1 TO Z.
644150     IF  Z NOT GREATER THAN WMS-COMBINED-STAT
644200         GO TO R6442.
644250 R6450.
644300     IF  WMS-STMT-NO-DEBITS + WMS-STMT-NO-CREDITS EQUAL TO ZERO
644350         AND WMS-STMT-SERV-CHG EQUAL TO ZERO
644400         AND WMS-STMT-TRAN-CHG EQUAL TO ZERO
644450         IF WBC-STMT-ON-TERMINATED EQUAL TO '1'                   0266741
644470         AND IBT-ACCT-IND NOT EQUAL '2'                           9915845
644500             NEXT SENTENCE
644550         ELSE
644600             GO TO R7000.
644650     MOVE '02' TO IMEX-CODE-2.
644700     MOVE '1' TO EX07-RESET.
644750     MOVE '   ' TO EX07-REQ-BY.
644800     PERFORM R5020 THRU R5045.
644850     MOVE '1' TO WMS-STMT-CLEAR.
644855     MOVE '1' TO WMS-IT-TRAN-FLAG1.                               9915749
644900     GO TO R7000.
644950 R6500.
645000     IF STATUS-IN NOT EQUAL TO '06'
645050         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.            0266741
645100     IF WMS-CURR-BAL NOT EQUAL TO ZERO, GO TO R7000.
645102     IF WMS-IOD-CYC-ACC-INT EQUAL ZERO                            1010054
645104         NEXT SENTENCE                                            1010054
645106     ELSE                                                         1010054
645108         IF WMS-IOD-CYC-ACC-INT NOT LESS THAN WMS-MIN-CR-INT      1010054
645110             GO TO R7000.                                         1010054
645150     IF WMS-CLS-OVRRIDE EQUAL TO '1', GO TO R7000.
645200     IF  WMS-LOAN-TRLR EQUAL '1'
645250         IF  WMS-PRIN-BAL   GREATER THAN ZERO
645300         OR  WMS-INTRST-BAL GREATER THAN ZERO
645350         OR  WMS-OTHER-CHGS GREATER THAN ZERO
645400             GO  TO  R7000.
645410     IF WMS-DAYS-ZERO-BAL + 1 LESS THAN WMS-0BAL-GRACE-DAYS       0702079
645415        GO TO R7000                                               0702079
645420     ELSE                                                         0702079
645450     GO TO R6050.                                                 IM005
645950 R6600.
645955***  COMMENTED OUT.  REPLACED BY COPYBOOK IMPD31U2                IMUP006
646000*    IF WMS-CURR-BAL EQUAL TO ZERO
646050*    AND WMS-CLS-OVRRIDE EQUAL TO '0'                             1010054
646060*    AND ((WMS-IOD-CYC-ACC-INT EQUAL ZERO)                        1010054
646070*    OR (WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                    1010054
646080*    AND WMS-IOD-CYC-ACC-INT LESS THAN WMS-MIN-CR-INT))           1010054
646100*        IF  WMS-LOAN-TRLR EQUAL '1' AND
646150*            WMS-PRIN-BAL EQUAL ZERO AND
646200*            WMS-INTRST-BAL EQUAL ZERO AND
646250*            WMS-OTHER-CHGS EQUAL ZERO
646300*        OR  WMS-LOAN-TRLR EQUAL '0'
646350*            GO TO R6050                                          IM005
646800*    ELSE
646850*            GO TO R7000.
646855     COPY IMPD31U2.                                               IMUP006
646870*----------------------------------------------------------------*1105504
646871*    ALLOW INACTIVE ACCOUNT TO PASS THROUGH R6120 TO CREATE      *1105504
646872*    SECOND INACTIVE NOTICE.                                     *1105504
646900*----------------------------------------------------------------*1105504
646902     MOVE WMS-INACTIVE TO HOLD-STATUS-OPT.                        0717564
646950     GO TO R6100.                                                 1105504
647000 R6700.
647002     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915857
647004         IF  WMS-IBT-RETENTION-DAYS EQUAL +999                    9915857
647006             GO  TO  R7000                                        9915857
647008         ELSE                                                     9915857
647010         IF  WMS-IBT-RETENTION-DAYS GREATER THAN +1               9915845
647012             SUBTRACT +1 FROM WMS-IBT-RETENTION-DAYS              9915845
647014             GO  TO  R7000                                        9915845
647016         ELSE                                                     9915845
647018         IF  WMS-STMT-NO-DEBITS EQUAL ZERO                        9915845
647020         AND WMS-STMT-NO-CREDITS EQUAL ZERO                       9915845
647022             PERFORM X1300-PURGE-OLD-IBT THRU X1300-EXIT          9915857
647047         ELSE                                                     9915845
647048             GO  TO  R7000.                                       9915845
647050     MOVE 'N' TO WS-PLN-DEL-FLG.                                  0617360
647051     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
647052         GO TO R6701.                                             0617360
647053     SET WMS-PLN-TRLR-IND TO 1.                                   0617360
647054     SET WMS-PLN-TRLR-IND2 TO WMS-PLN-TRLR-CTDT-NO.               0617360
647055     SEARCH WMS-PLN-TRLR-CTDT-TRLR                                0617360
647056         AT END GO TO R6202                                       0617360
647057         WHEN WMS-PLN-TRLR-IND GREATER THAN WMS-PLN-TRLR-IND2     0617360
647058             GO TO R6202                                          0617360
647059         WHEN WMS-PLN-TRLR-CAL-YR (WMS-PLN-TRLR-IND) EQUAL '0'    0617360
647060             MOVE 'Y' TO WS-PLN-DEL-FLG.                          0617360
647061 R6701.                                                           0617360
647062     IF  WMS-LOAN-TRLR EQUAL TO '0'                               0617360
647063     AND WMS-SAVINGS-TRLR EQUAL ZERO                              0617360
647070     AND WMS-OD-ACCRUAL-TRLR EQUAL ZERO                           IM005
647080     AND WMS-IOD-YTD-INT-PAID EQUAL ZERO                          IM005
647085     AND WMS-IOD-CYC-ACC-INT EQUAL ZERO                           9915857
647090     AND WMS-COMBINED-STAT EQUAL ZERO                             IM005
647100     AND WMS-CURR-BAL EQUAL ZERO                                  1105504
647102     AND WS-PLN-DEL-FLG EQUAL 'N'                                 0617360
647105     AND ((WMS-DUAL-YEAR-TRLR EQUAL '0')                          9915858
647110     OR  (WMS-DUAL-YEAR-TRLR EQUAL '1'                            9915858
647115     AND WMS-DUAL-YR-CUR-IOD-INT EQUAL ZERO                       9915858
647120     AND WMS-DUAL-YR-CUR-SAV-INT EQUAL ZERO))                     9915858
647200         MOVE '05' TO WMS-STATUS
647250         IF  WK-IM-STATUS-IN NOT EQUAL WMS-STATUS                 IM005
647255             MOVE WRK-DC-DSC-DATE TO WMS-DC-DATE-STATUS-CHANGE    IMIB004
647260             MOVE '51' TO WMS-REASON-CLOSED                       IMIB004
647265                          EX09-GEN-REASON                         IMIB004
647300             MOVE 'SU' TO IMEX-CODE-1
647350             MOVE 'SD' TO IMEX-CODE-2
647400             MOVE '09' TO IMEX-REC-NO
647450             MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN
647500             MOVE '05' TO EX09-STATUS-OUT, WK-IM-STATUS-IN
647550             MOVE WMS-CURR-BAL TO EX09-CUR-BAL
647600             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT
647650             GO  TO  R6210
647700         ELSE
647750             GO  TO  R6210.
647800     IF WMS-LOAN-TRLR EQUAL TO '1'
647850         PERFORM K3025 THRU K3029
647900         IF HOLD-AMT13 EQUAL TO ZERO
647950             MOVE '4' TO WMS-LOAN-STATUS
648000             IF WK-LN-STATUS-IN NOT EQUAL WMS-LOAN-STATUS
648050                 MOVE 'SU' TO IMEX-CODE-1
648100                 MOVE 'SL' TO IMEX-CODE-2
648150                 MOVE '09' TO IMEX-REC-NO
648200                 MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
648250                 MOVE '4' TO EX09-STATUS-OUT, WK-LN-STATUS-IN
648300                 MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
648350                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
648400     IF WMS-SAVINGS-TRLR EQUAL TO '1'
648450         IF WMS-ACCR-INT EQUAL TO ZERO
648500         AND WMS-YTD-INT-PAID EQUAL TO ZERO
648550         AND WMS-INT-CUR-BAL EQUAL TO ZERO
648552         AND (WMS-DUAL-YEAR-TRLR EQUAL '0'                        9915858
648554         OR  (WMS-DUAL-YEAR-TRLR EQUAL '1'                        9915858
648556         AND WMS-DUAL-YR-CUR-SAV-INT EQUAL TO ZERO))              9915858
648600             MOVE '8' TO WMS-INT-STATUS
648650             IF WK-SV-STATUS-IN NOT EQUAL WMS-INT-STATUS
648700                 MOVE 'SU' TO IMEX-CODE-1
648750                 MOVE 'SS' TO IMEX-CODE-2
648800                 MOVE '09' TO IMEX-REC-NO
648850                 MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN
648900                 MOVE '8' TO EX09-STATUS-OUT, WK-SV-STATUS-IN
648950                 MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL
649000                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
649010     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            IM004
649020         IF  WMS-OD-CYC-ACR EQUAL ZERO AND                        IM004
649030             WMS-OD-YTD-CHGD EQUAL ZERO                           IM004
649040*            MOVE '2' TO WMS-OD-STATUS.                           IM004
649045             NEXT SENTENCE.                                       IMODTRAI
649050     GO TO R7000.
649100*----------------------------------------------------------------*
649150*    CREATE INACTIVE/DORMANT EXCEPTION FOR STATUS 01, 02, AND 03 *
649200*    INACT-DORM-FLAG:  0=NOT INACT/DORM, 1=INACTIVE, 2=DORMANT   *
649250*----------------------------------------------------------------*
649255*    MODIFIED R6800 TO ALLOW FOR MONTHS FOR INACTIVE AND TO      *1105504
649260*    USE 30 DAY MONTH DAY DIFF ROUTINE (SIDIF2).                 *1105504
649270*----------------------------------------------------------------*1105504
649300 R6800.
649350     IF  WMS-STATUS NOT EQUAL '01' AND '02' AND '03' AND '11'     1010046
649400         GO TO R7000.
649402     MOVE WMS-DORMANT TO HOLD-STATUS-OPT.                         0717564
649450     PERFORM R6100 THRU R6110.                                    9915749
649500     IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3'               0437111
649550         IF  WMS-HIFI-DORM GREATER THAN ZERO
649600             GO  TO  R6810.
649650     IF  WMS-DORMANT EQUAL '0'
649700         GO TO R6840.
649750     IF  WMS-DORMANT EQUAL '1'
649800         IF  RET-DAYS LESS THAN WMS-DORMANT-DAYS
649850             GO TO R6840
649900         ELSE
649950             GO TO R6820.
650000     IF  RET-DAYS / +30 LESS THAN WMS-DORMANT-DAYS
650050         GO TO R6840.
650100     GO TO R6820.
650150 R6810.
650200     IF  WMS-HIFI-DORM EQUAL '1'
650250         IF  RET-DAYS LESS THAN WMS-HIFI-DORM-DAYS
650300             GO TO R6840
650350         ELSE
650400             GO TO R6820.
650450     IF  RET-DAYS / +30 LESS THAN WMS-HIFI-DORM-DAYS
650500         GO TO R6840.
650550 R6820.
650600     MOVE '2' TO INACT-DORM-FLAG.
650650     IF  WMS-DATE-INACT-DORM EQUAL SPACES
650700         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.            0266741
650750     GO TO R7000.
650800 R6840.
650850     IF  WMS-INACTIVE EQUAL '0'
650900         GO TO R6860.
650902     MOVE WMS-INACTIVE TO HOLD-STATUS-OPT.                        0717564
650904     PERFORM R6100 THRU R6110.                                    0717564
650910     IF  WMS-INACTIVE EQUAL TO '1'                                1105504
650950         IF  RET-DAYS LESS THAN WMS-INACTIVE-DAYS                 1105504
651000             GO TO R6860.                                         1105504
651010     IF  WMS-INACTIVE EQUAL TO '2'                                1105504
651015         IF  RET-DAYS / +30 LESS THAN WMS-INACTIVE-DAYS           1105504
651020             GO TO R6860.                                         1105504
651050     MOVE '1' TO INACT-DORM-FLAG.
651100     IF  WMS-DATE-INACT-DORM EQUAL SPACES
651150         MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.            0266741
651200     GO TO R7000.
651250 R6860.
651300     IF  WMS-DATE-INACT-DORM NOT EQUAL SPACES
651350         MOVE SPACES TO WMS-DATE-INACT-DORM.
651400 R7000.
651405******************************************************************IM006
651410***  THE FOLLOWING USER EXIT MAY BE USED TO ALTER THE STATEMENT   IM006
651415***  PULL CODE FOR AN ACCOUNT THAT HAS ITS STATUS CHANGED TO      IM006
651420***  DORMANT (06) OR INACTIVE (07) TODAY.                         IM006
651425***                                                               IM006
651430***  COPY IM31UPC.                                                IM006
651435***                                                               IM006
651440***  END OF USER EXIT.                                            IM006
651441******************************************************************1105504
651442*----------------------------------------------------------------*1105504
651443*    DO NOT INCREMENT DAYS-ZERO-BAL DURING STATIC RUN.           *1105504
651444*----------------------------------------------------------------*1105504
651445     IF  WBC-RUN-FLAG NOT EQUAL 'I'                               0266741
651446     AND WBC-ACCRUAL-DAYS GREATER THAN ZERO                       0266741
651450         IF  WMS-CURR-BAL EQUAL TO ZERO                           1105504
651500             ADD +1 TO WMS-DAYS-ZERO-BAL                          1105504
651550         ELSE                                                     1105504
651560             MOVE ZERO TO WMS-DAYS-ZERO-BAL, WMS-STMT-CYCL-CLSD.  1105504
651562     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915845
651564             GO  TO  S0100.                                       9915845
651569*----------------------------------------------------------------*0717564
651570*    IF STATUS = '06', DORMANT, CHECK FOR ABANDONED              *0717564
651571*    MONTHS. CHANGE STATUS IF DATE SINCE LAST ACTIVITY           *0717564
651572*    NOT LESS THAN ABANDONED MONTHS.                             *0717564
651573*----------------------------------------------------------------*0717564
651574     IF  WMS-STATUS NOT EQUAL TO '06'                             0717564
651575          GO TO R7100.                                            0717564
651576     MOVE '2' TO HOLD-STATUS-OPT.                                 0717564
651577     PERFORM R6100 THRU R6110.                                    9915749
651578     IF  WMS-MMDA-INDICATOR NOT EQUAL TO '1' AND '2' AND '3'      0437111
651579         IF  WBC-NB-DDA-ABNDN-MTHS EQUAL 0                        0266741
651580         OR  RET-DAYS LESS THAN WBC-NB-DDA-ABNDN-MTHS * 30        0266741
651581             GO TO R7100.                                         9715504
651582     IF  WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3'               0437111
651583         IF  WBC-NB-SAV-ABNDN-MTHS EQUAL 0                        0266741
651584         OR  RET-DAYS NOT GREATER THAN WBC-NB-SAV-ABNDN-MTHS * 30 0266741
651585             GO TO R7100.                                         9715504
651586     MOVE '10' TO WMS-STATUS.                                     1105504
651587     MOVE 'DE' TO IMEX-CODE-1.                                    1105504
651588     MOVE '06' TO EX09-STATUS-IN.                                 1105504
651589     MOVE '10' TO EX09-STATUS-OUT.                                1105504
651590     MOVE '00' TO IMEX-CODE-2.                                    1105504
651591     MOVE '09' TO IMEX-REC-NO.                                    1105504
651592     MOVE WMS-CURR-BAL TO EX09-CUR-BAL                            1105504
651593     MOVE '*'          TO EX09-GEN-STAT                           1105504
651594     MOVE CHNGD-TO-ABAND-STS-LIT(SIWS-LANG-SUB)                   0266741
651595                                         TO EX09-GEN-DESC         0266741
651596     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0266741
651597     MOVE WBC-CAPTURE-DATE TO WMS-DATE-INACT-DORM.                0266741
651598                                                                  0266741
651599****************  ESCHEATMENT PROCESSING   ***********************0417164
651600 R7100.                                                           0417164
651601     COPY IMPD31DM.                                               0417164
651602*----------------------------------------------------------------*1105504
651603*    IF STATUS IS ABANDONED (10), CHECK BCR FOR ESCHEATMENT      *1105504
651604*       DATE AND FLAG ACCOUNT IF EQUAL TO CAPTURE DATE.          *1105504
651605*----------------------------------------------------------------*1105504
651606     IF  WMS-ESCHEAT-FLAG NOT EQUAL TO '1'                        1105504
651607         IF ((WBC-CAPTURE-MO EQUAL TO WBC-NB-ESCHT-FLG-MO) AND    0266741
651608             (WBC-CAPTURE-DA EQUAL TO WBC-NB-ESCHT-FLG-DA))       0266741
651609             IF  WMS-STATUS EQUAL TO '10'                         1105504
651610                 MOVE '1'           TO WMS-ESCHEAT-FLAG           1105504
651611                 MOVE WBC-CAPTURE-MO TO WMS-ESCHEAT-MO            0266741
651612                 MOVE WBC-CAPTURE-DA TO WMS-ESCHEAT-DA            0266741
651613                 MOVE WBC-CAPTURE-YR TO WMS-ESCHEAT-YR            0266741
651614                 MOVE 'ZE'          TO IMEX-CODE-1                1105504
651615                 MOVE '  '          TO IMEX-CODE-2                1105504
651616                 MOVE '09'          TO IMEX-REC-NO                1105504
651617                 MOVE '10'          TO EX09-STATUS-IN             1105504
651618                 MOVE '10'          TO EX09-STATUS-OUT            1105504
651619                 MOVE WMS-CURR-BAL  TO EX09-CUR-BAL               1105504
651620                 MOVE '*'           TO EX09-GEN-STAT              1105504
651621                 MOVE FLGD-4-ESCHMNT-AT-DD-LIT(SIWS-LANG-SUB)     0266741
651622                                    TO EX09-GEN-DESC              1105504
651623                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.         1105504
651624     IF  WMS-ESCHEAT-FLAG EQUAL TO '1'                            1105504
651625         IF  WMS-ESCHEAT-YR LESS THAN WBC-NEXT-CENT-YR            0266741
651626             MOVE '20' TO WMS-ESCHEAT-CENT                        1105504
651627         ELSE                                                     1105504
651628             MOVE '19' TO WMS-ESCHEAT-CENT.                       1105504
651629     IF ((WMS-ESCHEAT-FLAG EQUAL TO '1') AND                      1105504
651630         (WMS-STATUS EQUAL TO '10'))                              1105504
651631         IF ((WBC-CAPTURE-MO EQUAL TO WBC-NB-DUE-DILIGENCE-MO) AND0266741
651632             (WBC-CAPTURE-DA EQUAL TO WBC-NB-DUE-DILIGENCE-DA))   0266741
651633                 MOVE 'DE'          TO IMEX-CODE-1                1105504
651634                 MOVE 'D9'          TO IMEX-CODE-2                0261784
651635                 MOVE '09'          TO IMEX-REC-NO                1105504
651636                 MOVE '10'          TO EX09-STATUS-IN             1105504
651637                 MOVE '10'          TO EX09-STATUS-OUT            1105504
651638                 MOVE WMS-CURR-BAL  TO EX09-CUR-BAL               1105504
651639                 MOVE '*'           TO EX09-GEN-STAT              1105504
651640                 MOVE DUE-DIL-EXCEPT-REC-LIT(SIWS-LANG-SUB)       0266741
651641                                    TO EX09-GEN-DESC              1105504
651642                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.         1105504
651643     IF  WBC-IM31-ESCHEAT-PH EQUAL TO SPACES                      0266741
651644         GO TO R7200.                                             1105504
651645     IF  WMS-STATUS EQUAL TO '06' AND                             1105504
651646         WMS-ESCHEAT-FLAG EQUAL '0' AND                           1105504
651647         WMS-ESCHEAT-DATE EQUAL SPACES                            1105504
651648         MOVE WBC-IM31-ESCHEAT-PH TO IM31-PH2                     0266741
651649         CALL  'SILINK' USING    IM31-PHASE                       1105504
651650                                 DDA-WRKBCR-1                     0266741
651651                                 MASTER-AREA                      0902504
651656         IF  WMS-ESCHEAT-FLAG EQUAL '1'                           0902504
651661             MOVE 'DE' TO IMEX-CODE-1                             0902504
651666             MOVE '00' TO IMEX-CODE-2                             0902504
651671             MOVE '09' TO IMEX-REC-NO                             0902504
651686             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             0902504
651699 R7200.                                                           0902504
651700     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO R7400.
651750     IF WMS-LOAN-STATUS EQUAL '3' OR '4'
651800         IF LOAN-STATUS-IN EQUAL '0' OR '1' OR '2' OR '5' OR '6'
651850             MOVE WBC-CAPTURE-DATE TO WMS-LOAN-CLOSED-DATE.       0266741
651900     IF WMS-LOAN-STATUS EQUAL TO '0'
651950         IF  WMS-PRIN-BAL        GREATER THAN +0.00               IM008
651970         OR  WMS-LN-STMT-AVG-BAL GREATER THAN +0.00               IM005
652000         OR  WMS-LN-STMT-DB-AMT  GREATER THAN +0.00               IM008
652010         OR  WMS-LN-STMT-CR-AMT  GREATER THAN +0.00               IM008
652020         OR  WMS-LOAN-ACCR-INT   GREATER THAN +0.00               IM008
652030             MOVE '1' TO WMS-LOAN-STATUS                          IM008
652050             IF WK-LN-STATUS-IN NOT EQUAL WMS-LOAN-STATUS
652100                 MOVE 'SU' TO IMEX-CODE-1
652150                 MOVE 'SL' TO IMEX-CODE-2
652200                 MOVE '09' TO IMEX-REC-NO
652250                 MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN
652300                 MOVE '1' TO EX09-STATUS-OUT, WK-LN-STATUS-IN
652350                 MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL
652400                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
652450     IF WMS-LOAN-CALC-CODE EQUAL TO '1' AND
652500         WMS-LOAN-STATUS NOT EQUAL '6'
652550         IF WBC-LOAN-DAILY-ACCRUAL EQUAL TO '0'                   0266741
652600             MOVE '1' TO LOAN-ACCR-RECALC
652650             PERFORM C2372 THRU C2400
652700             MOVE '0' TO WMS-LOAN-CALC-CODE
652750                         LOAN-ACCR-RECALC.
652755* CHANGE THE LOAN-STATUS TO 6-STOP ACCRUAL WHEN                   0627535
652756* DELINQUENT WBC-LOAN-STOP-ACCR-DAYS                              0627535
652760     IF (WMS-SAVINGS-TRLR EQUAL '1'                               0627535
652762     AND WMS-CMA-INDICATOR EQUAL '1')                             0627535
652764         GO  TO  R7400.                                           0627535
652766     IF  WBC-LOAN-STOP-ACCR-DAYS EQUAL ZERO                       0627535
652768         GO  TO  R7400.                                           0627535
652770     IF  WMS-LOAN-STATUS     NOT EQUAL '2'                        0627535
652772         GO  TO  R7400.                                           0627535
652774     IF  WMS-PAST-DUE        NOT EQUAL '4'                        0627535
652775         GO  TO  R7400.                                           1020095
652776     IF  WMS-PAST-DUE-DATE       EQUAL SPACES                     1020095
652777         GO  TO  R7400.                                           1020095
652778     IF  UB-OPTION-FLAG(24) EQUAL 'Y'                             1020095
652779         PERFORM UO-OPT0024-A THRU UO-OPT0024-A-EXIT              1020095
652780         IF  WS-U0024-FLAG EQUAL 'N'                              1020095
652781             GO  TO  R7400.                                       1020095
652782     MOVE '11'                   TO  SICOMPDT-DATE-FORMATS.       0627535
652784     MOVE WMS-PAST-DUE-MO        TO  DT-L-MO.                     0627535
652786     MOVE WMS-PAST-DUE-DA        TO  DT-L-DA.                     0627535
652788     MOVE WMS-PAST-DUE-YR        TO  DT-L-YR.                     0627535
652790     MOVE WBC-CAPTURE-DATE       TO  DT-HIGH-DATE.                0627535
652792     CALL 'SICOMPDT'          USING  DT-LOW-DATE                  0627535
652794                                     DT-HIGH-DATE                 0627535
652796                                     SICOMPDT-RETURN-FLAG         0627535
652798                                     SICOMPDT-DATE-FORMATS.       0627535
652800     IF  SICOMPDT-RETURN-FLAG NOT EQUAL 'L'                       0627535
652802         GO  TO  R7400.                                           0627535
652804     CALL 'SIDIF1'            USING  DATE-AREA.                   0627535
652806     ADD  +1 TO RET-DAYS.                                         0627535
652808     IF  RET-DAYS GREATER THAN WBC-LOAN-STOP-ACCR-DAYS            0637624
652812         MOVE '1'                TO  LOAN-STAT-STOP-ACCR-TDY.     0627535
652840 R7400.                                                           0627535
652850     IF  WMS-SAVINGS-TRLR NOT EQUAL TO '1', GO TO R7600.          IM006
652860     IF  WMS-INT-STATUS EQUAL TO '0'                              IM005
652870         IF  WMS-INT-CUR-BAL GREATER THAN ZERO                    IM005
652880         OR  WMS-INT-DR-NUMBER GREATER THAN ZERO                  IM005
652890         OR  WMS-INT-CR-NUMBER GREATER THAN ZERO                  IM005
653000             MOVE '1' TO WMS-INT-STATUS
653050             IF  WK-SV-STATUS-IN NOT EQUAL TO WMS-INT-STATUS      IM005
653100                 MOVE 'SU' TO IMEX-CODE-1
653150                 MOVE 'SS' TO IMEX-CODE-2
653200                 MOVE '09' TO IMEX-REC-NO
653250                 MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN
653300                 MOVE '1' TO EX09-STATUS-OUT, WK-SV-STATUS-IN
653350                 MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL
653400                 PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
653450     IF (WMS-INT-STATUS EQUAL TO '0' OR GREATER THAN '3')         IM003
653451     OR  WMS-INT-DORM EQUAL TO '0'                                IM003
653452         GO TO R7600.                                             IM006
653453     MOVE WMS-INT-DATE-LAST-CUST-ACT TO DT-LOW-DATE.              IM003
653454     PERFORM R6105 THRU R6110.                                    2015872
653455     IF  WMS-INT-DORM EQUAL '1'                                   IM003
653456         IF  RET-DAYS LESS THAN WMS-INT-DORM-DAYS                 IM003
653457             GO TO R7600                                          IM006
653458         ELSE                                                     IM003
653459             GO TO R7500.                                         IM003
653460     IF  RET-DAYS / +30 LESS THAN WMS-INT-DORM-DAYS               IM003
653461         GO TO R7600.                                             IM006
653462 R7500.                                                           IM003
653463     MOVE WBC-CAPTURE-DATE TO WMS-INT-DATE-DORMANT.               0266741
653464     IF WBC-STMT-ON-DORMANT EQUAL TO '1'                          0266741
653465         MOVE '08' TO IMEX-CODE-2                                 IM003
653466         MOVE '0' TO EX07-RESET                                   IM003
653467         MOVE '   ' TO EX07-REQ-BY                                IM003
653468         PERFORM R5020 THRU R5045.                                IM003
653469     IF  WMS-INT-STATUS EQUAL '2' OR '3'                          IM003
653470         MOVE '1' TO SAV-DORMANT-FLAG                             IM003
653471         GO TO R7600                                              IM006
653472     ELSE                                                         IM003
653473         MOVE '6' TO WMS-INT-STATUS.                              IM003
653474     IF WK-SV-STATUS-IN NOT EQUAL WMS-INT-STATUS                  IM003
653475         MOVE 'SU' TO IMEX-CODE-1                                 IM003
653476         MOVE 'SS' TO IMEX-CODE-2                                 IM003
653477         MOVE '09' TO IMEX-REC-NO                                 IM003
653478         MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN                   IM003
653479         MOVE '6' TO EX09-STATUS-OUT, WK-SV-STATUS-IN             IM003
653480         MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL                     IM003
653481         MOVE '*'          TO EX09-GEN-STAT                       IM003
653482         MOVE SAV-AUTO-CHG-DOR-LIT(SIWS-LANG-SUB)                 0266741
653485             TO EX09-GEN-DESC                                     IM003
653488         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM003
653491     SKIP3                                                        IM003
653500*    *************  LOAN COSTS AMORTIZATION ****************      IM006
653501     SKIP1                                                        IM006
653502 R7600.                                                           IM006
653503     IF  WMS-LOAN-TRLR NOT EQUAL TO '1'                           IM006
653504         GO TO R7900.                                             0927850
653505     IF  WMS-COSTS-RECALC EQUAL '2'                               IM006
653506         GO TO R7700.                                             IM008
653507     IF  LOAN-COSTS-FLAG EQUAL '0'                                IM006
653508         GO TO R7610.                                             IM006
653509     MOVE WMS-COSTS-ORIG-TERM TO WMS-COSTS-REMN-TERM.             IM006
653511     MOVE WBC-CAPTURE-MO TO C-LOW-MO.                             0266741
653512     MOVE WBC-CAPTURE-DA TO C-LOW-DA.                             0266741
653513     MOVE WBC-CAPTURE-YR TO C-LOW-YR.                             0266741
653514     IF  WBC-CAPTURE-YR GREATER THAN WBC-NEXT-CENT-YR             0266741
653515         MOVE '19' TO C-LOW-CENT                                  IM006
653516     ELSE                                                         IM006
653517         MOVE '20' TO C-LOW-CENT.                                 IM006
653518     MOVE WMS-COSTS-ORIG-TERM TO C-NO-DAYS.                       IM006
653519     CALL 'SIDCMHI' USING C-DATE-WORK.                            IM006
653520     MOVE C-HIGH-MO TO WMS-COSTS-EXPR-MO.                         IM006
653521     MOVE C-HIGH-DA TO WMS-COSTS-EXPR-DA.                         IM006
653522     MOVE C-HIGH-YR TO WMS-COSTS-EXPR-YR.                         IM006
653523 R7610.                                                           IM006
653524     MOVE +0.00 TO EX24-COSTS-AMORTIZED-TDY.                      IM006
653525     IF  WBC-CAPTURE-DATE EQUAL WMS-LOAN-CLOSED-DATE              0266741
653526         MOVE +1 TO WMS-COSTS-REMN-TERM                           IM006
653527         GO TO R7620.                                             IM006
653528     IF  WMS-LOAN-STATUS EQUAL TO '6'                             IM006
653529         GO TO R7630.                                             IM006
653530     IF  WMS-COSTS-CODE EQUAL '0'                                 IM006
653531         IF  LOAN-PMT-TODAY EQUAL '1'                             IM006
653532             GO TO R7620                                          IM006
653533         ELSE                                                     IM006
653534             GO TO R7630.                                         IM006
653535     IF  WMS-COSTS-CODE EQUAL '3'                                 0717621
653536         MOVE WMS-APPROVAL-DA TO HOLD-COSTS-DAY.                  0717621
653537     IF  WMS-COSTS-CODE EQUAL '1'                                 0717621
653538         MOVE WMS-COSTS-DAY   TO HOLD-COSTS-DAY.                  0717621
653539     IF  WMS-COSTS-CODE EQUAL '1' OR '3'                          0717621
653540         IF  HOLD-COSTS-DAY EQUAL WBC-STMT-CAL (1) OR             0717621
653541             WBC-STMT-CAL (2)  OR WBC-STMT-CAL (3) OR             0717621
653542             WBC-STMT-CAL (4)  OR WBC-STMT-CAL (5) OR             0717621
653543             WBC-STMT-CAL (6)  OR WBC-STMT-CAL (7) OR             0717621
653544             WBC-STMT-CAL (8)                                     0717621
653545             GO TO R7620                                          0717621
653546         ELSE                                                     0717621
653547             GO TO R7630.                                         0717621
653548     IF  WMS-COSTS-CODE EQUAL '2'                                 0717621
653549         IF  WBC-MONTH-END EQUAL '1'                              0717621
653550             GO TO R7620.                                         0717621
653551     GO TO R7630.                                                 0717621
653552 R7620.                                                           0717621
653553     IF  WMS-COSTS-UNEARNED EQUAL +0.00                           0717621
653554     OR  WMS-COSTS-REMN-TERM EQUAL +0                             0717621
653555         GO TO R7630.                                             0717621
653556     IF  WMS-COSTS-REMN-TERM EQUAL +1                             0717621
653557         MOVE WMS-COSTS-UNEARNED TO HOLD-AMT11                    0717621
653558     ELSE                                                         0717621
653559         DIVIDE WMS-COSTS-UNEARNED BY WMS-COSTS-REMN-TERM         0717621
653560             GIVING HOLD-AMT11 ROUNDED.                           0717621
653565     ADD HOLD-AMT11 TO WMS-COSTS-AMORTIZED                        1004773
653566                       WMS-COSTS-AMORT-MTD                        1004773
653567                       WMS-LOAN-AMORT-YTD.                        1004773
653568     SUBTRACT HOLD-AMT11 FROM WMS-COSTS-UNEARNED.                 IM006
653569     SUBTRACT +1 FROM WMS-COSTS-REMN-TERM.                        IM006
653570     MOVE HOLD-AMT11 TO EX24-COSTS-AMORTIZED-TDY.                 IM006
653571     IF  HOLD-AMT11 NOT GREATER THAN +0.00                        IM006
653572         MULTIPLY -1 BY HOLD-AMT11                                IM006
653573         ADD HOLD-AMT11 TO LOAN-NEG-AMORT, WS-GL-LOAN-NEG-AMORT   0902970
653574     ELSE                                                         IM006
653575        ADD HOLD-AMT11 TO LOAN-AMORT-TODAY WS-GL-LOAN-AMORT-TODAY.0902970
653576 R7630.                                                           IM006
653577     IF  WMS-COSTS-ORIG-AMT  EQUAL +0.00                          IM006
653578     AND WMS-COSTS-UNEARNED  EQUAL +0.00                          IM006
653579     AND WMS-COSTS-AMORTIZED EQUAL +0.00                          IM006
653580         GO TO R7700.                                             IM008
653581     ADD WMS-COSTS-AMORTIZED TO LOAN-AMORT-COSTS                  0902970
653582                                WS-GL-LOAN-AMORT-COSTS.           0902970
653583     ADD WMS-COSTS-UNEARNED TO LOAN-END-COSTS WS-GL-LOAN-END-COSTS0902970
653584     MOVE '24' TO IMEX-REC-NO.                                    0902970
653585     MOVE 'OC' TO IMEX-CODE-1.                                    IM006
653586     MOVE LOAN-COSTS-FLAG TO EX24-COSTS-TERM-CHG-TDY.             1004775
653587     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     1004775
653588*----------------------------------------------------------------*2016432
653589*    BUILD INTEREST RATE ANALYSIS RECORDS FOR ACCUM TRAN FILE    *2016432
653590*----------------------------------------------------------------*2016432
653591 R7700.                                                           2016432
653592     IF  WMS-LOAN-STATUS EQUAL '0' OR '9'                         2016432
653593     OR  SKIP-RATE-RECORD EQUAL '1'                               2016432
653594         GO TO R7799-EXIT.                                        2016432
653595 R7705.                                                           2016432
653596     MOVE SPACES TO ATF-RATE-AREA.                                1004775
653597     MOVE WMS-LOAN-360-DAY-FACTOR TO ATF-DAY-FACTOR.              0817657
653598     MOVE WMS-INT-RATE-PTR TO ATF-INT-RATE-PTR.                   1004775
653599     MOVE WMS-SPLIT-RATE-SCHD TO ATF-SPLT-RATE-SCHD.              1004775
653600     MOVE WMS-PREV-INT-PTR TO ATF-PREV-INT-PTR.                   1004775
653601     MOVE WMS-PREV-SPLIT-RATE-PTR TO ATF-PREV-SPLT-RATE-PTR.      1004775
653602     MOVE WMS-SPLIT-RATE-IND TO ATF-SPLT-RATE-IND.                1004775
653603     MOVE '0' TO ATF-ADJUST-CODE.                                 1004775
653604     MOVE PRIME-CALC-FLAG TO ATF-PRIME-CALC-FLAG.                 1004775
653605     MOVE PRIME-BILL-FLAG TO ATF-PRIME-BILL-FLAG.                 1004775
653606     MOVE WBC-CAPTURE-YR TO ATF-CAPT-DATE-YR.                     0266741
653607     IF  ATF-CAPT-DATE-YR LESS THAN WBC-NEXT-CENT-YR              0266741
653608         MOVE '20' TO ATF-CAPT-DATE-CENT                          1004775
653609     ELSE                                                         1004775
653610         MOVE '19' TO ATF-CAPT-DATE-CENT.                         1004775
653611     MOVE WBC-CAPTURE-MO TO ATF-CAPT-DATE-MO.                     0266741
653612     MOVE WBC-CAPTURE-DA TO ATF-CAPT-DATE-DA.                     0266741
653613     IF  WMS-RATE-CHANGE-YR EQUAL SPACES                          1004775
653614         MOVE ATF-CAPTURE-DATE TO ATF-RATE-CHANGE-DATE            1004775
653615     ELSE                                                         1004775
653616         MOVE WMS-RATE-CHANGE-YR TO ATF-RATE-CHANGE-YR            IM008
653617         MOVE WMS-RATE-CHANGE-MO TO ATF-RATE-CHANGE-MO            IM008
653618         MOVE WMS-RATE-CHANGE-DA TO ATF-RATE-CHANGE-DA            IM008
653619         IF  ATF-RATE-CHANGE-YR LESS THAN WBC-NEXT-CENT-YR        0266741
653620             MOVE '20' TO ATF-RATE-CHANGE-CENT                    1004775
653621         ELSE                                                     1004775
653622             MOVE '19' TO ATF-RATE-CHANGE-CENT.                   1004775
653623     MOVE SPLIT-RATE-AREA TO ATF-CUR-SPLIT.                       1003625
653624     IF  WMS-INT-RATE-PTR GREATER THAN +0 AND LESS THAN +6        1003625
653625         MOVE WMS-LOAN-INTEREST-RATE TO ATF-CUR-RATE              1003625
653626         IF  LOAN-SUB GREATER 0                                   1003625
653627             MOVE WS-RWF-LN-CHG (LOAN-SUB) TO ATF-ADJUST-CODE     1003625
653628             GO TO R7710                                          1003625
653629         ELSE                                                     1003625
653630             GO TO R7710.                                         1003625
653631     IF  WMS-INT-RATE-PTR GREATER THAN +5                         1003625
653632         MOVE WMS-LOAN-INTEREST-RATE TO ATF-CUR-RATE              1003625
653633         IF  PRIME-SUB GREATER 0                                  1003625
653634             MOVE WS-RWF-PRM-CHG (PRIME-SUB) TO ATF-ADJUST-CODE   1003625
653635             GO TO R7710                                          1003625
653636         ELSE                                                     1003625
653637             GO TO R7710.                                         1003625
653638     IF  WMS-SPLIT-RATE-SCHD NOT EQUAL ZERO                       1003625
653639         IF  SAVE-PAST-ACCR-FLAG EQUAL '1'                        1003625
653640             MOVE SPLIT-RATE-HOLD TO ATF-CUR-SPLIT                IM008
653641             IF  SPLIT-SUB GREATER 0                              1003625
653642                 MOVE WS-RWF-SPL-CHG (SPLIT-SUB)                  1003625
653643                   TO ATF-ADJUST-CODE                             1003625
653644                 GO TO R7710                                      1003625
653645             ELSE                                                 1003625
653646                 GO TO R7710                                      1003625
653647         ELSE                                                     1003625
653648             PERFORM SPLIT-RATE-MOVE THRU SPLIT-RATE-MOVE-EXIT    1003625
653649             MOVE '0' TO MAX-EXC                                  1003625
653650             PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT           1003625
653651             MOVE SPLIT-RATE-HOLD TO ATF-CUR-SPLIT                1003625
653652             IF  SPLIT-SUB GREATER 0                              1003625
653653                 MOVE WS-RWF-SPL-CHG (SPLIT-SUB)                  1003625
653654                   TO ATF-ADJUST-CODE                             1003625
653655                 GO TO R7710                                      1003625
653656             ELSE                                                 1003625
653657                 GO TO R7710.                                     1003625
653658     IF  WMS-SPLIT-RATE-IND EQUAL '1'                             1003625
653659         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO ATF-CUR-SPLIT       1003625
653660         GO TO R7710.                                             1003625
653661     MOVE WMS-LOAN-INTEREST-RATE TO ATF-CUR-RATE.                 1003625
653662 R7710.                                                           1003625
653663     MOVE SPLIT-RATE-AREA TO ATF-PRV-SPLIT.                       1003625
653664     IF  WMS-PREV-INT-PTR GREATER THAN +0                         1003625
653665         MOVE WMS-PREV-ANNUAL TO ATF-PRV-PTR-ANN                  1003625
653666         MOVE WMS-PREV-DAILY  TO ATF-PRV-PTR-DAF                  1003625
653667         GO TO R7720.                                             1003625
653668     IF  WMS-PREV-SPLIT-RATE-PTR NOT EQUAL  +0                    1003625
653669         PERFORM OLD-SPLIT-RATE-MOVE                              1003625
653670            THRU OLD-SPLIT-RATE-MOVE-EXIT                         1003625
653671         MOVE '0' TO MAX-EXC                                      1003625
653672         PERFORM SPLIT-MAX-CALC THRU SPLIT-MAX-EXIT               1003625
653673         MOVE SPLIT-RATE-HOLD TO ATF-PRV-SPLIT                    1003625
653674         GO TO R7720.                                             1003625
653675     IF  WMS-SPLIT-RATE-IND EQUAL '2'                             1003625
653676         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO ATF-PRV-SPLIT       1003625
653677         GO TO R7720.                                             1003625
653678     MOVE WMS-PREV-ANNUAL TO ATF-PRV-PTR-ANN.                     1003625
653679     MOVE WMS-PREV-DAILY  TO ATF-PRV-PTR-DAF.                     1003625
653680 R7720.                                                           1003625
653681     MOVE '26' TO IMEX-REC-NO.                                    1003625
653682     MOVE 'HZ' TO IMEX-CODE-1.                                    1003625
653683     MOVE ATF-RATE-AREA TO EX26-RATE-AREA.                        1003625
653684     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     1003625
653685 R7799-EXIT.                                                      1003625
653686     EXIT.                                                        1003625
653687                                                                  1003625
653688 R7800.                                                           0627535
653690* CHANGE THE LOAN-STATUS TO 6-STOP ACCRUAL                        0627535
653692     IF  LOAN-STAT-STOP-ACCR-TDY EQUAL '1'                        0627535
653694         MOVE '6'                TO  WMS-LOAN-STATUS              0627535
653696         PERFORM R0530 THRU R0530-EXIT.                           0627535
653698 R7800-EXIT.  EXIT.                                               0627535
653699                                                                  0927850
653700 R7900.                                                           0927850
653701     IF  WBC-FDIC-CTL-OPT EQUAL 'N'                               0927850
653702         GO TO R8000.                                             0927850
653703     MOVE '20' TO WORK-DATE1-CC.                                  0927850
653704     MOVE WBC-CAPTURE-MO TO WORK-DATE1-MO.                        0927850
653705     MOVE WBC-CAPTURE-DA TO WORK-DATE1-DA.                        0927850
653706     MOVE WBC-CAPTURE-YR TO WORK-DATE1-YR.                        0927850
653707     IF  WBC-FDIC-CTL-DATE NOT EQUAL WORK-DATE1                   0927850
653708         GO TO R7910.                                             0927850
653709     IF  WBC-FDIC-HOLD-PHASE EQUAL TO SPACES                      0927850
653710         GO TO R8000.                                             0927850
653711     MOVE WBC-FDIC-HOLD-PHASE TO IM31-PH2.                        0927850
653712     CALL 'SILINK' USING IM31-PHASE                               0927850
653713                           MASTER-AREA                            0927850
653714                           DDA-WRKBC-3                            0927850
653715                           WS-PROV-HOLD-AMT.                      0927850
653716     MOVE WS-PROV-HOLD-AMT TO WMS-PROV-HOLD-AMT.                  0927850
653717                                                                  0927850
653720 R7910.                                                           0927850
653722     IF  WMS-PROV-HOLD-AMT NOT GREATER THAN ZERO                  0927850
653723         GO TO R8000.                                             0927850
653724     MOVE '08' TO IMEX-REC-NO.                                    0927850
653725     MOVE 'PF' TO IMEX-CODE-1.                                    0927850
653726     MOVE WMS-PROV-HOLD-AMT TO EX08-END-BAL.                      0927850
653727     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     0927850
653728                                                                  0927850
653729*    ********  DAILY REPORTS EXCEPTION GENERATION  *********      0927850
653730 R8000.                                                           0927850
653731     SET RPT-INDEX TO +1.                                         0927850
653732     MOVE WMS-CONTROL-KEY TO IMEX-KEY.                            0927850
653750     MOVE SPACES TO IMEX-INFO.
653760     PERFORM EXC-15 THRU EXC-15-EXIT.                             1105504
653770     PERFORM EXC-16 THRU EXC-16-EXIT.                             1105504
653780     PERFORM EXC-17 THRU EXC-17-EXIT.                             2016374
653790     PERFORM EXC-18 THRU EXC-18-EXIT.                             2016412
653792     PERFORM EXC-23 THRU EXC-23-EXIT.                             0437111
653794     PERFORM EXC-24 THRU EXC-24-EXIT.                             0437111
653800 R8100.
653850     IF RPT-END (RPT-INDEX) EQUAL TO SPACE, GO TO R9000.          1004554
653900     COMPUTE GO-TO-INDEX = RPT9 (RPT-INDEX) - 24.
653950     SKIP1
654000*  --24 IS SUBTRACTED FROM THE GO TO INDEX BECAUSE THE EXCEPTION
654050*  --CODES PROCESSED HERE BEGIN AT 25. THIS AVOIDS HAVING 'DUMMY'
654100*  --PARAGRAPH NAMES INSERTED TO MAKE THE GO-TO-DEPENDING-ON
654150*  --OPERATE.  IF ANY EXCEPTION CODES ARE ADDED AHEAD OF 25
654200*  --AND ARE TO BE PROCESSED IN THIS AREA, THE NUMBER SUBTRACTED
654250*  --FROM 'GO-TO-INDEX' MUST BE LOWERED ACCORDINGLY.
654300     SKIP1
654350     GO TO EXC-25    EXC-26    EXC-27    EXC-28    EXC-29
654400           EXC-30    EXC-31    EXC-32    EXC-33    EXC-34
654450           EXC-35    EXC-36    EXC-37    EXC-38    EXC-39
654500           EXC-40    EXC-41    EXC-42    EXC-43    EXC-44
654550           EXC-45    EXC-46    EXC-47    EXC-48    EXC-49
654600           EXC-50    EXC-51    EXC-52    EXC-53    EXC-54
654650           EXC-55    EXC-56    EXC-57    EXC-58    EXC-59
654700           EXC-60    EXC-61    EXC-62    EXC-63    EXC-64
654750           EXC-65    EXC-27    EXC-67    EXC-68    EXC-69
654800           EXC-70    EXC-71    EXC-72    EXC-73    EXC-74
654850           EXC-75    EXC-76    EXC-77    EXC-78    EXC-79
654900           EXC-80    EXC-81    EXC-82    EXC-83    EXC-84
654950           EXC-85    EXC-86    EXC-87    EXC-88    EXC-89
655000           EXC-90    EXC-91    EXC-92    EXC-93    EXC-94
655050           EXC-95    EXC-96    EXC-97    EXC-98    EXC-99         IM005
655100     DEPENDING ON GO-TO-INDEX.
655150     GO TO R9000.                                                 1004554
655200     SKIP3
655210 EXC-23.                                                          0437111
655212     IF  WBC-EXC-CODE (23) EQUAL TO '1'                           0437111
655214         IF  (WMS-IOD-RATE-PTR GREATER THAN +0                    0437111
655216         OR  WMS-HIFI-INDICATOR GREATER THAN +0)                  0437111
655218         AND WMS-MMDA-INDICATOR EQUAL '3'                         0437111
655220             MOVE '17' TO IMEX-REC-NO                             0437111
655222             MOVE '23' TO IMEX-CODE-1N                            0437111
655224             PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.              0437111
655226 EXC-23-EXIT.  EXIT.                                              0437111
655228 EXC-24.                                                          0437111
655230     IF  WBC-EXC-CODE (24) EQUAL TO '1'                           0437111
655232         IF  (WMS-IOD-RATE-PTR GREATER THAN +0                    0437111
655234         OR  WMS-HIFI-INDICATOR GREATER THAN +0)                  0437111
655236         AND WMS-MMDA-INDICATOR EQUAL '2'                         0437111
655238             MOVE '17' TO IMEX-REC-NO                             0437111
655240             MOVE '24' TO IMEX-CODE-1N                            0437111
655242             PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.              0437111
655244 EXC-24-EXIT.  EXIT.                                              0437111
655250 EXC-25.
655300     IF WMS-LOAN-TRLR EQUAL TO '0', GO TO R8900.
655350     IF WMS-LOAN-STATUS NOT EQUAL TO '2', GO TO R8900.
655400     IF WMS-LOAN-STATUS EQUAL TO LOAN-STATUS-IN, GO TO R8900.
655450     IF LOAN-STAT-MAINT EQUAL TO '1'
655500         MOVE 'M' TO EX03-CODE
655550     ELSE MOVE 'S' TO EX03-CODE.
655600     GO TO R8760.
655650 EXC-26.
655700     IF WMS-LOAN-TRLR EQUAL TO '1'
655750         IF  WMS-PAST-DUE EQUAL '3'                               1002953
655755             GO  TO  R8800.                                       1002953
655800     GO TO R8900.
655850 EXC-27.
655900*  --THIS PARAGRAPH PROCESSES EXC-66 (LOAN OVERLIMIT) AS WELL
655950*  --AS EXC-27 (LOAN OVERLIMIT TODAY).
656000     IF WMS-LOAN-TRLR EQUAL TO '0', GO TO R8900.
656050     IF WMS-OVERLIMIT EQUAL TO '0', GO TO R8900.
656100     IF GO-TO-INDEX EQUAL TO +42, GO TO R8800.
656150     IF WMS-OVERLIMIT EQUAL '1'                                   0265710
656200         GO TO R8800.
656250     GO TO R8900.
656300 EXC-28.
656350     IF WMS-LOAN-TRLR EQUAL TO '1'
656400         IF WMS-LOAN-BAD-ACCT EQUAL TO '1', GO TO R8800.
656450     GO TO R8900.
656500 EXC-29.
656550     IF  (WMS-STATUS EQUAL '01' OR '02' OR '03' OR '11')          1010046
656600     AND INACT-DORM-FLAG EQUAL '2'
656650     AND WMS-DATE-INACT-DORM EQUAL WBC-CAPTURE-DATE               0266741
656700         GO TO R8760.
656750     IF WMS-STATUS NOT EQUAL TO '06', GO TO R8900.
656800     IF WMS-STATUS EQUAL TO STATUS-IN, GO TO R8900.
656850     IF STATUS-MAINT EQUAL TO '1'
656900         MOVE 'M' TO EX03-CODE
656950     ELSE MOVE 'S' TO EX03-CODE.
657000     GO TO R8760.
657050 EXC-30.
657100     IF  (WMS-STATUS EQUAL '01' OR '02' OR '03' OR '11')          1010046
657150     AND INACT-DORM-FLAG EQUAL '1'
657200     AND WMS-DATE-INACT-DORM EQUAL WBC-CAPTURE-DATE               0266741
657250         GO TO R8760.
657300     IF WMS-STATUS NOT EQUAL TO '07', GO TO R8900.
657350     IF WMS-STATUS EQUAL TO STATUS-IN, GO TO R8900.
657400     IF STATUS-MAINT EQUAL TO '1'
657450         MOVE 'M' TO EX03-CODE
657500     ELSE MOVE 'S' TO EX03-CODE.
657550     GO TO R8760.
657600 EXC-31.
657650     IF WMS-DATE-LAST-CUST-WITHDRAWAL NOT EQUAL WBC-CAPTURE-DATE  0266741
657700         GO TO R8900.
657750     IF WMS-CURR-BAL LESS THAN WMS-BANK-AVAIL-AMT AND             IM007
657770        WMS-BANK-AVAIL-AMT GREATER THAN ZERO                      IM007
657850         MOVE ACCT-BAL-IN TO EX02-BAL
657900         GO TO R8720.
657950     IF WMS-CURR-BAL LESS THAN WMS-HOLD-AMT AND
658000        WMS-HOLD-AMT GREATER THAN ZERO
658050         MOVE ACCT-BAL-IN TO EX02-BAL
658100         GO TO R8720.
658150     GO TO R8900.
658200 EXC-32.
658250     IF WMS-DATE-LAST-CUST-WITHDRAWAL NOT EQUAL WBC-CAPTURE-DATE  0266741
658300         GO TO R8900.
658350     IF WMS-CURR-BAL LESS THAN WMS-CUST-AVAIL-AMT AND             IM007
658370        WMS-CUST-AVAIL-AMT GREATER THAN ZERO                      IM007
658450         MOVE ACCT-BAL-IN TO EX02-BAL
658500         GO TO R8720.
658550     IF WMS-CURR-BAL LESS THAN WMS-HOLD-AMT AND
658600        WMS-HOLD-AMT GREATER THAN ZERO
658650         MOVE ACCT-BAL-IN TO EX02-BAL
658700         GO TO R8720.
658750     GO TO R8900.
658800 EXC-33.
658850     IF WMS-STATUS EQUAL TO '06', GO TO R8800.
658900     IF  (WMS-STATUS EQUAL '01' OR '02' OR '03' OR '11')          1010046
658950     AND INACT-DORM-FLAG EQUAL '2'
659000         GO TO R8800.
659050     GO TO R8900.
659100 EXC-34.
659150     IF WMS-STATUS EQUAL TO '07', GO TO R8800.
659200     IF  (WMS-STATUS EQUAL '01' OR '02' OR '03' OR '11')          1010046
659250     AND INACT-DORM-FLAG EQUAL '1'
659300         GO TO R8800.
659350     GO TO R8900.
659400 EXC-35.
659450     IF MTD-AGGR-FLAG NOT EQUAL TO '1'
659500         PERFORM S1015 THRU S1024.
659550     MOVE '1' TO MTD-AGGR-FLAG.
659600     IF WMS-MTD-AGGR-DAYS EQUAL TO ZERO, GO TO R8900.
659650     COMPUTE HOLD-NO = WMS-MTD-AGGR-COLL / WMS-MTD-AGGR-DAYS.
659700     IF HOLD-NO LESS THAN WBC-LARGE-BAL, GO TO R8900.             0266741
659750     MOVE HOLD-NO TO EX04-NO.
659800     GO TO R8760.
659850 EXC-36.
659900     MOVE WMS-NSF-CALC TO CALC-FLAG.                              IM008
659920     MOVE WMS-DDA-BAL  TO CUR-BAL.                                IM008
659940     PERFORM K0104 THRU K0105.                                    IM008
659942     IF (WMS-STATUS EQUAL '04' OR '05' OR '08')                   0727641
659944     AND WMS-DDA-BAL EQUAL ZERO                                   0727641
659946         NEXT SENTENCE                                            0727641
659948     ELSE                                                         0727641
659960         IF  CUR-BAL LESS THAN ZERO, GO TO R8800.                 0727641
660050     IF  WMS-SAVINGS-TRLR EQUAL '1' AND
660100        (WMS-INT-STATUS EQUAL '1' OR '3')
660150         MOVE WMS-CURR-BAL TO CUR-BAL                             IM008
660240         PERFORM K0104 THRU K0105                                 IM008
660330         IF  CUR-BAL LESS THAN ZERO, GO TO R8800.                 IM008
660650     GO TO R8900.
660700 EXC-37.
660750     IF WMS-STATUS EQUAL TO '04', GO TO R8800.
660800     GO TO R8900.
660850 EXC-38.
660900     IF WMS-TRNSFR-AFFL-TRLR NOT EQUAL TO ZERO, GO TO R8800.
660950     GO TO R8900.
661000 EXC-39.
661050     IF  WMS-LIMIT-TRANSFER EQUAL TO '1'
661100         GO TO R8800.
661150     GO TO R8900.
661200 EXC-40.
661210     IF  WMS-IOD-YTD-INT-PAID-1042 GREATER THAN ZERO              9915828
661220         GO TO R8800.                                             9915828
661230     IF  WMS-SAVINGS-TRLR EQUAL TO '1'                            9915828
661240         IF  WMS-YTD-INT-PAID-1042 GREATER THAN ZERO              9915828
661250             GO TO R8800.                                         9915828
661300     GO TO R8900.
661350 EXC-41.
661400     IF WMS-SAVINGS-TRLR EQUAL TO '1', GO TO R8800.
661450     GO TO R8900.
661500 EXC-42.
661550     IF WMS-SPECL-HANDL GREATER THAN '0', GO TO R8800.
661600     GO TO R8900.
661650 EXC-43.
661700     IF WMS-CAUTION EQUAL TO '1', GO TO R8800.
661750     GO TO R8900.
661800 EXC-44.
661850     IF WMS-SYS-TYP-1-2 EQUAL TO '05'
661900         MOVE DATE-LAST-ACTIVE TO EX02-DATE-LAST
661950         GO TO R8720.
662000     GO TO R8900.
662050 EXC-45.
662100     IF WMS-OFF-EMP NOT EQUAL TO '0'
662150        MOVE DATE-LAST-ACTIVE TO EX02-DATE-LAST
662200         GO TO R8720.
662250     GO TO R8900.
662300 EXC-46.
662350     IF WMS-INTANG-TAX NOT EQUAL TO ' ' AND '0', GO TO R8800.
662400     GO TO R8900.
662450 EXC-47.
662500     IF WMS-LOST-CONTACT EQUAL TO '1', GO TO R8800.
662550     GO TO R8900.
662600 EXC-48.
662650     IF WMS-SYS-TYP-1-2 EQUAL TO '03', GO TO R8800.
662700     GO TO R8900.
662750 EXC-49.
662800     IF WMS-SYS-TYP-1-2 EQUAL TO '04', GO TO R8800.
662850     GO TO R8900.
662900 EXC-50.
662950     IF WMS-SYS-TYP-1-2 EQUAL TO '06', GO TO R8800.
663000     GO TO R8900.
663050 EXC-51.
663100     IF WMS-SYS-TYP-1-2 EQUAL TO '07', GO TO R8800.
663150     GO TO R8900.
663200 EXC-52.
663250     IF WMS-SYS-TYP-1-2 EQUAL TO '08', GO TO R8800.
663300     GO TO R8900.
663350 EXC-53.
663400     IF WMS-SYS-TYP-1-2 EQUAL TO '01', GO TO R8800.
663450     GO TO R8900.
663500 EXC-54.
663550     IF WMS-TAX-CODE EQUAL TO '0', GO TO R8800.
663600     GO TO R8900.
663650 EXC-55.
663700     IF WMS-SIGNATURE-CARD EQUAL TO '0', GO TO R8800.
663750     GO TO R8900.
663800 EXC-56.
663850     IF WMS-NEW-THIS-MONTH EQUAL TO '1', GO TO R8800.
663900     GO TO R8900.
663950 EXC-57.
663960*----------------------------------------------------------------*1105504
663961*    ADD OTHER WAIVE FLAGS TO COMPARISON TO CREATE WAIVED REPORT *1105504
663962*----------------------------------------------------------------*1105504
664000     IF  WMS-SC-CHARGE EQUAL TO '0'                               1105504
664010     OR  WS-ANC-CHARGE EQUAL TO '0'                               0516691
664020     OR  WMS-NB-DISC-AREA NOT EQUAL TO SPACES                     1105504
664030         GO TO R8800.                                             1105504
664050     GO TO R8900.
664100 EXC-58.
664150     IF WMS-SC-REL-CODE NOT EQUAL TO '0', GO TO R8800.
664200     GO TO R8900.
664250 EXC-59.
664300     IF WMS-CURR-BAL LESS THAN WMS-SC-COMP-BAL
664350         AND WMS-SC-COMP-BAL NOT EQUAL TO ZERO
664400         GO TO R8800.
664450     GO TO R8900.
664500 EXC-60.
664550     IF WMS-CURR-BAL EQUAL TO ZERO AND
664600         WMS-STATUS NOT EQUAL TO '04'
664650         GO TO R8800.
664700     GO TO R8900.
664750 EXC-61.
664780     IF  WMS-STATUS EQUAL '04' OR '05' OR '08'                    IM006
664800     OR  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
664810         GO TO R8900.                                             IM006
664850     IF WMS-CURR-BAL GREATER THAN WBC-CLOSE-BALANCE               0266741
664852     AND WBC-CLOSE-OPT EQUAL '0'                                  0827766
664870         GO TO R8900.                                             IM007
664880     IF  WBC-CLOSE-OPT EQUAL '1'                                  0827766
664882         MULTIPLY  WBC-CLOSE-BALANCE  BY -1 GIVING                0827766
664884                                            WS-WBC-CLOSE-BALANCE  0827766
664886         IF  WMS-CURR-BAL GREATER THAN WBC-CLOSE-BALANCE          0827766
664888         OR  WMS-CURR-BAL LESS THAN WS-WBC-CLOSE-BALANCE          0827766
664890             GO TO R8900.                                         0827766
664950     MOVE WMS-DATE-LAST-CUST-ACTIVITY TO DT-LOW-DATE.
665000     MOVE WBC-CAPTURE-DATE TO DT-HIGH-DATE.                       0266741
665050     CALL 'SIDIF1' USING DATE-AREA.
665100     IF RET-DAYS NOT LESS THAN WBC-CLOSE-DAYS, GO TO R8800.       0266741
665150     GO TO R8900.
665200 EXC-62.
665250     IF WMS-LOAN-TRLR EQUAL TO '1', GO TO R8800.
665300     GO TO R8900.
665350 EXC-63.
665400     IF WMS-LOAN-TRLR EQUAL TO '1'
665450         IF WMS-LOAN-STATUS EQUAL TO '0', GO TO R8800.
665500     GO TO R8900.
665550 EXC-64.
665600     IF WMS-LOAN-TRLR EQUAL TO '1'
665650         IF WMS-LOAN-STATUS EQUAL TO '2', GO TO R8800.
665700     GO TO R8900.
665750 EXC-65.
665800     IF  WMS-LOAN-TRLR EQUAL '1'                                  1002953
665824         IF  WMS-PAST-DUE NOT EQUAL ZERO                          1002953
665828             GO  TO  R8800.                                       1002953
665900     GO TO R8900.
665950     SKIP1
666000*  --FOR EXC-66, SEE EXC-27.
666050     SKIP1
666100 EXC-67.
666150     IF WMS-LOAN-TRLR EQUAL TO '1'
666200         IF WMS-LOAN-BAD-ACCT NOT EQUAL TO '0', GO TO R8800.
666250     GO TO R8900.
666300 EXC-68.
666350     IF WMS-LOAN-TRLR EQUAL TO '1'
666400         IF WMS-LOAN-CAUTION EQUAL TO '1', GO TO R8800.
666450     GO TO R8900.
666500 EXC-69.
666550     IF WMS-LOAN-TRLR EQUAL TO '1'
666600         IF WMS-INSUR1 EQUAL TO '1' OR WMS-INSUR2 EQUAL TO '1'
666650             GO TO R8800.
666700     GO TO R8900.
666750 EXC-70.
666800     IF WMS-LOAN-TRLR EQUAL TO '1'
666850         IF  WMS-PAST-DUE GREATER THAN '2'                        1002953
666855             GO  TO  R8800.                                       1002953
666900     GO TO R8900.
666950 EXC-71.
667000     IF WMS-LOAN-TRLR EQUAL TO '1'
667050         IF WMS-ADDITIONAL-CREDIT NOT EQUAL TO ZERO, GO TO R8800.
667100     GO TO R8900.
667150 EXC-72.
667200     IF WMS-LOAN-TRLR EQUAL TO '1'
667250         IF WMS-REMAIN-COUNT GREATER THAN ZERO, GO TO R8800.
667300     GO TO R8900.
667350 EXC-73.
667400     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO R8900.
667450     IF  WMS-OVERLIMIT GREATER THAN '0', GO TO R8900.
667500     IF  WBC-LINE-PCT EQUAL ZERO                                  0266741
667550         GO TO R8900.
667600     PERFORM CALC-AVAIL-BAL THRU CALC-1.
667650     MULTIPLY WBC-LINE-PCT BY LOAN-LIM.                           0266741
667700     IF  (LOAN-BAL NOT LESS THAN LOAN-LIM)
667750     AND (LOAN-BAL NOT EQUAL ZERO)
667800         GO TO R8800.
667850     GO TO R8900.
667900 EXC-74.
667950     IF WMS-MARKET-TRLR EQUAL TO '1', GO TO R8800.
668000     GO TO R8900.
668050 EXC-75.
668100     IF WMS-MARKET-TRLR EQUAL TO '1'
668150         IF WMS-KEY-ACCT EQUAL TO '1', GO TO R8800.
668200     GO TO R8900.
668250 EXC-76.
668300     IF WMS-MARKET-TRLR EQUAL TO '1'
668350         IF WMS-CURR-BAL NOT GREATER THAN WMS-MKT-LOW-LIMIT
668400             GO TO R8800.
668450     GO TO R8900.
668500 EXC-77.
668550     IF WMS-MARKET-TRLR EQUAL TO '1'
668600         IF WMS-CURR-BAL NOT LESS THAN WMS-MKT-HIGH-LIMIT
668650             GO TO R8800.
668700     GO TO R8900.
668750 EXC-78.
668800     IF WMS-SAV-PTR NOT EQUAL TO ZERO, GO TO R8800.
668850     GO TO R8900.
668900 EXC-79.
668910*----------------------------------------------------------------*1105504
668911*    COMMENT LINE 668950 TO ELIMINATE EXCEPTION 79 FOR IM41P8.   *1105504
668912*----------------------------------------------------------------*1105504
668950     IF WMS-MTD-ANALYSIS GREATER THAN '0', GO TO R8800.
669000     GO TO R8900.
669050 EXC-80.
669100     IF WMS-COMBINED-STAT GREATER THAN ZERO, GO TO R8800.
669150     GO TO R8900.
669200 EXC-81.
669250     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO R8900.
669300     IF WMS-LOAN-NEW-THIS-MONTH EQUAL TO '1', GO TO R8800.
669350     GO TO R8900.
669400 EXC-82.
669450     IF AUTO-DEP-DUE-TODAY EQUAL TO '1'
669500     AND AUTO-DEP-REC-TODAY NOT EQUAL TO '1', GO TO R8800.
669550     GO TO R8900.
669600 EXC-83.
669650     IF WMS-LOAN-TRLR NOT EQUAL TO '1', GO TO R8900.
669700     IF WMS-CR-RATING-DATE EQUAL TO SPACES
669750         GO TO R8900.
669800     MOVE WMS-CR-RATING-DATE TO D3-MO-DA.
669850     MOVE WMS-CR-RATING-YR TO D3-YR.
669860     IF  D3-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
669870         MOVE '19' TO D3-CC                                       1105729
669880     ELSE                                                         1105729
669890         MOVE '20' TO D3-CC.                                      1105729
669900     MOVE WBC-NEXT-CAPTURE-DATE TO D2-MO-DA.                      0266741
669950     MOVE WBC-NEXT-CAPTURE-YR TO D2-YR.                           0266741
669960     IF  D2-YR GREATER THAN WBC-NEXT-CENT-YR                      0266741
669970         MOVE '19' TO D2-CC                                       1105729
669980     ELSE                                                         1105729
669990         MOVE '20' TO D2-CC.                                      1105729
670000     IF DATE-3 GREATER THAN DATE-2, GO TO R8900.
670050     MOVE WMS-CR-RATING-DATE TO WMS-CREDIT-LAST-DATE.
670100     MOVE WMS-CR-RATING-MO TO HOLD-X.
670150     IF WMS-REVIEW-FREQ EQUAL TO 'S'
670200         MOVE +6 TO HOLD-NO3
670250     ELSE
670300         IF WMS-REVIEW-FREQ EQUAL TO 'Q'
670350             MOVE +3 TO HOLD-NO3
670400         ELSE
670450             IF WMS-REVIEW-FREQ EQUAL TO 'A'
670500                 MOVE +12 TO HOLD-NO3
670550             ELSE
670600                 MOVE +1 TO HOLD-NO3.
670650     ADD HOLD-NO3 TO HOLD-9.
670700     MOVE HOLD-X TO WMS-CR-RATING-MO.
670750     IF HOLD-X GREATER THAN '12'
670800         SUBTRACT +12 FROM HOLD-9
670850         MOVE HOLD-X TO WMS-CR-RATING-MO
670900         MOVE WMS-CR-RATING-YR TO HOLD-X
670950         ADD +1 TO HOLD-9
671000         MOVE HOLD-X TO WMS-CR-RATING-YR.
671050     GO TO R8800.
671100 EXC-84.
671110     IF WMS-OD-SUPPRESS-NTC EQUAL TO '1' OR '2'                   0900620
671120         GO TO R8900.                                             0900620
671150     IF WMS-INTO-OD-YR-1 EQUAL TO SPACE, GO TO R8900.
671200     IF WMS-OD-FOLLOWUP EQUAL TO ZERO, GO TO R8900.
671250     IF WMS-OD-SEC-NOTICE EQUAL TO '1' OR '2', GO TO R8900.       1105504
671300     IF WMS-DAYS-OD NOT GREATER THAN WMS-OD-FOLLOWUP, GO TO R8900.
671350     MOVE '1' TO WMS-OD-SEC-NOTICE.
671400     GO TO R8800.
671450 EXC-85.
671500     IF WMS-CLUB-ACCT-CONTROL GREATER THAN '0'
671550         GO TO R8800.
671600     GO TO R8900.
671650 EXC-86.
671700     IF WMS-SAVINGS-TRLR NOT EQUAL TO '1', GO TO R8900.
671750     IF WMS-INT-CUR-BAL EQUAL ZERO
671800         IF WMS-INT-STATUS NOT EQUAL TO '0'
671850             GO TO R8800.
671900     GO TO R8900.
671950 EXC-87.
672000     IF  WMS-DC-TRLR EQUAL TO '1', GO TO R8800.
672050     GO  TO  R8900.
672100 EXC-88.
672150     IF WMS-LOAN-TRLR NOT EQUAL TO '1' GO TO R8900.
672200     IF  WMS-BILL-DUE-AMT (1) NOT EQUAL ZERO                      1002953
672205         GO  TO  R8800.                                           1002953
672250     GO TO R8900.
672300 EXC-89.
672350     IF  (WMS-IOD-RATE-PTR GREATER THAN +0                        0902509
672360     OR  WMS-HIFI-INDICATOR GREATER THAN +0)                      0902509
672370     AND (WMS-MMDA-INDICATOR NOT EQUAL '1' AND '2' AND '3')       0437111
672380         GO TO R8800.                                             0902509
672400     GO TO R8900.
672450 EXC-90.
672500     IF  (WMS-IOD-RATE-PTR GREATER THAN +0                        0902509
672510     OR  WMS-HIFI-INDICATOR GREATER THAN +0)                      0902509
672520     AND WMS-MMDA-INDICATOR EQUAL '1'                             0902509
672530         GO TO R8800.                                             0902509
672550     GO  TO  R8900.
672600 EXC-91.
672650     IF  SAV-BKUP-WTHLD-FLAG GREATER THAN '0'                     IM007
672670     AND (WMS-IOD-RATE-PTR GREATER THAN ZERO                      IM007
672750     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
672760     OR  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
672800     OR  WMS-SAVINGS-TRLR EQUAL '1'
672850     OR  WMS-IOD-YTD-INT-PAID GREATER THAN ZERO
672870     OR  WMS-IOD-PEND-TAX GREATER THAN ZERO                       IM007
672900     OR  WMS-IOD-YTD-TAX GREATER THAN ZERO)
672950         GO TO R8800.
673000     GO TO R8900.
673050 EXC-92.
673100     IF (WMS-TIN-CERTIFICATION EQUAL '0' OR '2' OR '3' OR '4'     0902736
673110                                  OR '5' OR '6' OR '7' OR '9')    0902736
673150     AND WMS-TAX-EXEMPT-RSN EQUAL SPACES
673200     AND (SAV-BKUP-WTHLD-FLAG EQUAL '0')                          IM007
673250     AND (WMS-IOD-RATE-PTR GREATER THAN ZERO
673300     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
673350     OR  WMS-SAVINGS-TRLR EQUAL '1'
673360     OR  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
673400     OR  WMS-IOD-YTD-INT-PAID GREATER THAN ZERO
673450     OR  WMS-IOD-YTD-TAX GREATER THAN ZERO)
673500         GO TO R8800.
673550     GO TO R8900.
673600 EXC-93.
673650     IF  (WMS-TAX-NO EQUAL SPACES OR ZERO)
673660     AND (WMS-TIN-CERTIFICATION EQUAL '0' OR '1' OR '2' OR '3'    IM007
673670                           OR '4'  OR '5' OR '6' OR '7' OR '9')   0902736
673700     AND WMS-TAX-EXEMPT-RSN EQUAL SPACES
673750     AND (SAV-BKUP-WTHLD-FLAG EQUAL '0')                          IM007
673800     AND (WMS-IOD-RATE-PTR GREATER THAN ZERO
673850     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
673900     OR  WMS-SAVINGS-TRLR EQUAL '1'
673910     OR  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
673950     OR  WMS-IOD-YTD-INT-PAID GREATER THAN ZERO
674000     OR  WMS-IOD-YTD-TAX GREATER THAN ZERO)
674050         GO TO R8800.
674100     GO TO R8900.
674150 EXC-94.
674200     IF  WMS-IOD-YTD-TAX GREATER THAN ZERO
674250         GO TO R8800.
674300     IF  WMS-SAVINGS-TRLR EQUAL '1'
674350         IF  WMS-YTD-SAV-TAX GREATER THAN ZERO
674400             GO TO R8800.
674405     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
674410     AND (WMS-DUAL-YR-CUR-IOD-FED GREATER THAN ZERO               9915858
674415     OR  WMS-DUAL-YR-CUR-SAV-FED GREATER THAN ZERO)               9915858
674420         GO TO R8800.                                             9915858
674450     GO TO R8900.
674500 EXC-95.
674550     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
674600         GO TO R8800.
674650     GO TO R8900.
674657 EXC-96.                                                          IM003
674664     IF  WMS-SAVINGS-TRLR NOT EQUAL '1' GO TO R8900.              IM003
674671     IF  WMS-INT-STATUS EQUAL TO '6'                              IM003
674678     OR  SAV-DORMANT-FLAG EQUAL '1'                               IM003
674685         GO TO R8800.                                             IM003
674692     GO TO R8900.                                                 IM003
674693 EXC-97.                                                          IM003
674694     IF  WMS-INFO-TRLR NOT EQUAL '1' GO TO R8900.                 IM003
674695     IF  WMS-INFO-CONTINENT EQUAL '0' OR ' ' GO TO R8900.         IM003
674696     GO TO R8800.                                                 IM003
674697 EXC-98.                                                          IM004
674698     IF WMS-CHG-CARD-FLG EQUAL '1', GO TO R8800.                  IM004
674699     GO TO R8900.                                                 IM004
674700 EXC-99.                                                          IM005
674705     IF  WBC-MONTH-END NOT EQUAL '1', GO TO R8900.                0266741
674710     IF  WMS-BIRTHDATE EQUAL SPACES,  GO TO R8900.                IM005
674715     IF  WMS-BIRTH-YR  EQUAL HOLD-65-YR                           IM005
674720     AND WMS-BIRTH-MO  EQUAL HOLD-65-MO                           IM005
674725         GO TO R8800.                                             IM005
674730     GO  TO R8900.                                                IM005
674735 R8720.                                                           IM005
674750     MOVE '02' TO IMEX-REC-NO.
674800     GO TO R8820.
674850 R8760.
674900     MOVE '03' TO IMEX-REC-NO.
674950     GO TO R8820.
675000 R8800.
675050     MOVE '17' TO IMEX-REC-NO.
675100 R8820.
675150     MOVE RPT9 (RPT-INDEX) TO IMEX-CODE-1N.
675200     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.
675250 R8900.
675300     SET RPT-INDEX UP BY +1.
675305     GO TO R8100.                                                 1105504
675310*----------------------------------------------------------------*1105504
675311*    CREATE EXCEPTION CODE '15' TO GENERATE A NOTICE FOR OD      *1105504
675312*    ACCOUNTS WITH 'INTENT TO CLOSE'.                            *1105504
675313*    CREATE EXCEPTION CODE '16' TO GENERATE A NOTICE FOR         *1105504
675314*    ACCOUNTS WITH OD LIMIT CODE EQUAL TO 'L'.                   *1105504
675315*----------------------------------------------------------------*1105504
675316 EXC-15.                                                          1105504
675317     IF  WMS-OD-SUPPRESS-NTC EQUAL '1' OR '2'                     1105504
675318         GO TO EXC-15-EXIT.                                       1105504
675319     IF  WMS-INTO-OD-YR-1 EQUAL TO SPACE                          1105504
675320         GO TO EXC-15-EXIT.                                       1105504
675321     IF  WMS-OD-SEC-NOTICE NOT EQUAL '1'                          1105504
675322         GO TO EXC-15-EXIT.                                       1105504
675323     IF  WMS-STATUS  EQUAL  '04'  OR  '05'  OR  '06'  OR          1105504
675324                            '07'  OR  '08'  OR  '10'              1105504
675325         GO TO EXC-15-EXIT.                                       1105504
675326     ADD +40 WMS-OD-FOLLOWUP GIVING WK-OD-3RD-FOLLOWUP.           1105504
675327     IF  WMS-DAYS-OD NOT GREATER THAN WK-OD-3RD-FOLLOWUP          1105504
675328         GO TO EXC-15-EXIT.                                       1105504
675329     MOVE  '2' TO WMS-OD-SEC-NOTICE.                              1105504
675330     MOVE '17' TO IMEX-REC-NO.                                    1105504
675331     MOVE '15' TO IMEX-CODE-1N.                                   1105504
675332     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.                      1105504
675333 EXC-15-EXIT.                                                     1105504
675334     EXIT.                                                        1105504
675335*                                                                 9915749
675336 EXC-16.                                                          9915749
675337     IF  WMS-OD-LIMIT NOT EQUAL 'L'                               9915749
675338         GO TO EXC-16-EXIT.                                       9915749
675339*                                                                 9915749
675340     MOVE '17' TO IMEX-REC-NO.                                    9915749
675341     MOVE '16' TO IMEX-CODE-1N.                                   9915749
675342     PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.                      9915749
675343 EXC-16-EXIT.                                                     9915749
675344     EXIT.                                                        2016374
675346 EXC-17.                                                          2016374
675347     IF  WMS-BIR-FLAG EQUAL '1' OR '2'                            2016412
675348         MOVE '17' TO IMEX-REC-NO                                 2016412
675349         MOVE 'BR' TO IMEX-CODE-1                                 2016412
675350         MOVE '  ' TO IMEX-CODE-2                                 2016412
675351         PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.                  2016412
675352 EXC-17-EXIT.                                                     2016412
675353     EXIT.                                                        2016412
675354 EXC-18.                                                          2016412
675355     IF  WMS-LOAN-TRLR NOT EQUAL '1'                              2016412
675356         GO TO EXC-18-EXIT.                                       2016412
675357     IF  WMS-LOAN-CHG-OFF-AMT GREATER THAN 0                      2016412
675358         GO TO EXC-18-EXIT.                                       2016412
675359     IF  WMS-LOAN-CHG-OFF-STATUS NOT EQUAL '0'                    2016412
675360     OR  WMS-LOAN-CHG-OFF-DATE NOT EQUAL SPACES                   2016412
675361         MOVE '17' TO IMEX-REC-NO                                 2016412
675362         MOVE '18' TO IMEX-CODE-1N                                2016412
675363         PERFORM CALL-IM31RDWR THRU WRITE-EXIT1.                  2016412
675364 EXC-18-EXIT.                                                     2016412
675365     EXIT.                                                        2016412
675368*                                                                 2016412
675369*----------------------------------------------------------------*2016412
675370*    R9000 WILL PERFORM THE FOLLOWING FUNCTIONS FOR INVESTMENT   *1004554
675375*    PROCESSING:                                                 *1004554
675380*       1) PROCESS CLOSING SUSPECTS (WK-INVEST-FUNCTION = 3)     *1004554
675385*       2) PROCESS INVESTMENT EXCEPTIONS (WK-INVEST-FUNCTION = 2)*1004554
675390*----------------------------------------------------------------*1004554
675395 R9000.                                                           1004554
675400     IF  WMS-INVESTMENT-TRLR EQUAL '0'                            1004554
675410         GO TO R9100.                                             2016639
675415     MOVE '3' TO WK-INVEST-FUNCTION.                              1004554
675420     PERFORM CALL-INVEST-PHASE THRU CALL-INVEST-EXIT.             1004554
675425     MOVE '2' TO WK-INVEST-FUNCTION.                              1004554
675430     PERFORM CALL-INVEST-PHASE THRU CALL-INVEST-EXIT.             1004554
675435                                                                  1004554
675440     COPY IMPD31XR.                                               2016639
675445*                                                                 2016639
675450 S0100.
675500     MOVE '  ' TO IMEX-CODE-1, SVCH-CYCLE-DAYX.
675550     MOVE '1' TO STMT-CYCLE-DAYX.
675580     MOVE +0 TO HOLD-ACCRUAL-DAYS.                                9915857
675600     IF  IBT-ACCT-IND EQUAL '2' OR '3'                            9915857
675601         PERFORM X1350-IBT-ADD-TO-CNTRS THRU X1350-EXIT           9915857
675602         GO  TO  S2500.                                           9915857
675603     IF  YEAR-CHANGE EQUAL '0'                                    9915845
675604         GO TO S0100-CONT.                                        9715519
675606     MOVE WMS-LEAP-YEAR-FLG TO HOLD-DDA-LEAP-FLG.                 9715519
675608     IF  NEXT-DAYS EQUAL +366                                     9715519
675610         MOVE '1' TO WMS-LEAP-YEAR-FLG                            9715519
675612     ELSE                                                         9715519
675614         MOVE '0' TO WMS-LEAP-YEAR-FLG.                           9715519
675616     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9715519
675618         MOVE WMS-INT-LEAP-YEAR-FLG TO HOLD-SAV-LEAP-FLG          9715519
675620         IF  NEXT-DAYS EQUAL +366                                 9715519
675622             MOVE '1' TO WMS-INT-LEAP-YEAR-FLG                    9715519
675624         ELSE                                                     9715519
675626             MOVE '0' TO WMS-INT-LEAP-YEAR-FLG.                   9715519
675628                                                                  9715519
675630 S0100-CONT.                                                      9715519
675650     IF WMS-LOAN-TRLR EQUAL '0' GO TO S0200.
675700     PERFORM CALC-AVAIL-BAL THRU CALC-3.                          1001295
675750     MOVE LOAN-BAL TO WMS-PAYOFF-AMT.                             1001295
675752     IF  YEAR-CHANGE EQUAL '0'                                    1001295
675754         GO TO S0110.                                             1001295
675756     IF (WMS-LOAN-360-DAY-FACTOR EQUAL '1' OR '2')                0817657
675758         GO TO S0110.                                             1001295
675760     MOVE '1' TO LOAN-ACCR-RECALC                                 1001295
675762                 WMS-LOAN-CALC-CODE.                              1001295
675764*----------------------------------------------------------------*9914251
675765*  RECALCULATE WMS-LOAN-ACCR-AMT FOR LEAP YEAR BOUNDARIES        *9914251
675766*----------------------------------------------------------------*9914251
675768     IF  NEXT-DAYS EQUAL +366                                     1001295
675770         MOVE '1' TO WBC-LEAP-YEAR                                0266741
675772     ELSE                                                         1001295
675774         MOVE '0' TO WBC-LEAP-YEAR.                               0266741
675776     MOVE WMS-PRIN-BAL TO HOLD-AMT9.                              1001295
675778     SUBTRACT WMS-PREV-BAL FROM HOLD-AMT9.                        1001295
675780     IF  HOLD-AMT9 NOT GREATER THAN ZERO                          1001295
675782         GO TO S0105.                                             1001295
675784     IF  WMS-INT-RATE-PTR GREATER THAN +5                         1001295
675786         GO TO S0101.                                             1001295
675788     IF  WMS-INT-RATE-PTR GREATER THAN ZERO                       1001295
675790         MOVE WMS-LOAN-INTEREST-RATE TO YE-WMS-LN-CUR-RATES       1001295
675792         MOVE WMS-LN-CUR-RATES       TO YE-LN-CUR-RATES           1003625
675796         DIVIDE NEXT-DAYS INTO WMS-ANNUAL-RATE                    1001295
675798                          GIVING WMS-DAILY-RATE                   1003625
675802         DIVIDE NEXT-DAYS INTO WMS-LN-CUR-ANN                     1003625
675804                          GIVING WMS-LN-CUR-DAF                   1003625
675806         PERFORM C2372 THRU C2379                                 1001295
675808         MOVE YE-WMS-LN-CUR-RATES TO WMS-LOAN-INTEREST-RATE       1001295
675810         MOVE YE-LN-CUR-RATES     TO WMS-LN-CUR-RATES             1003625
675814         GO TO S0105.                                             1001295
675816     IF  WMS-SPLIT-RATE-SCHD NOT EQUAL ZERO                       1001295
675818         PERFORM SPLIT-RATE-MOVE-YE THRU SPLIT-RATE-MOVE-YE-EXIT  1003625
675824         DIVIDE NEXT-DAYS INTO WMS-SPL-CUR-ANN (1)                1003625
675826                          GIVING WMS-SPL-CUR-DAF (1)              1003625
675830         DIVIDE NEXT-DAYS INTO WMS-SPL-CUR-ANN (2)                1003625
675832                          GIVING WMS-SPL-CUR-DAF (2)              1003625
675836         DIVIDE NEXT-DAYS INTO WMS-SPL-CUR-ANN (3)                1003625
675838                          GIVING WMS-SPL-CUR-DAF (3)              1003625
675840         PERFORM C2372 THRU SPLIT-CALC-END                        1001295
675842         PERFORM YE-SPLIT-RATE-MOVE THRU YE-SPLIT-RATE-MOVE-EXIT  1003625
675846         GO TO S0105.                                             1001295
675848     IF  WMS-SPLIT-RATE-IND EQUAL '1'                             1001295
675850         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO YE-SPL-CUR-INFO     1003625
675852         DIVIDE NEXT-DAYS                                         1001295
675854                   INTO WMS-RATE1-ANNUAL GIVING WMS-RATE1-DAILY   1001295
675856         DIVIDE NEXT-DAYS                                         1001295
675858                   INTO WMS-RATE2-ANNUAL GIVING WMS-RATE2-DAILY   1001295
675860         DIVIDE NEXT-DAYS                                         1001295
675862                   INTO WMS-RATE3-ANNUAL GIVING WMS-RATE3-DAILY   1001295
675864         PERFORM C2372 THRU SPLIT-CALC-END                        1001295
675866         MOVE YE-SPL-CUR-INFO TO WMS-LOAN-SPLIT-RATE-SCHEDULE     1003625
675868         GO TO S0105.                                             1001295
675872     MOVE WMS-LOAN-INTEREST-RATE TO YE-WMS-LN-CUR-RATES.          1001295
675874     DIVIDE NEXT-DAYS INTO WMS-ANNUAL-RATE                        1001295
675876                                GIVING WMS-DAILY-RATE.            1001295
675878     PERFORM C2372 THRU C2379.                                    1001295
675880     MOVE YE-WMS-LN-CUR-RATES    TO WMS-LOAN-INTEREST-RATE.       1001295
675882     GO TO S0105.                                                 1001295
675884 S0101.                                                           1001295
675886     IF  WMS-INT-RATE-PTR EQUAL +6                                1001295
675887     AND PRIME-CALC-FLAG EQUAL '1'                                1001295
675888         MOVE WMS-LOAN-INTEREST-RATE TO YE-WMS-LN-CUR-RATES       1001295
675890         DIVIDE NEXT-DAYS INTO WMS-ANNUAL-RATE                    1001295
675892                                    GIVING WMS-DAILY-RATE         1001295
675894         PERFORM C2372 THRU C2379                                 1001295
675896         MOVE YE-WMS-LN-CUR-RATES    TO WMS-LOAN-INTEREST-RATE.   1001295
675898 S0105.                                                           1001295
675900*OLD MONEY                                                        1001295
675902     IF  WMS-PREV-BAL NOT GREATER THAN ZERO                       1001295
675904         MOVE '0' TO WMS-LOAN-CALC-CODE                           1001295
675906         GO TO S0110.                                             1001295
675907     MOVE ZERO TO WMS-LOAN-ACCR-AMT.                              0930033
675908     IF  WMS-PREV-INT-PTR GREATER THAN ZERO                       1001295
675910         MOVE WMS-PREV-ANNUAL      TO YE-WMS-ANNUAL-RATE          1003625
675912         MOVE WMS-PREV-DAILY       TO YE-WMS-DAILY-RATE           1003625
675914         MOVE WMS-LN-OLD-CUR-RATES TO YE-LN-CUR-RATES             1003625
675918         DIVIDE NEXT-DAYS INTO WMS-PREV-ANNUAL                    1001295
675920                          GIVING WMS-PREV-DAILY                   1003625
675924         DIVIDE NEXT-DAYS INTO WMS-LN-OLD-CUR-ANN                 1003625
675926                          GIVING WMS-LN-OLD-CUR-DAF               1003625
675928         PERFORM C2384 THRU C2400                                 1001295
675930         MOVE YE-WMS-ANNUAL-RATE TO WMS-PREV-ANNUAL               1001295
675932         MOVE YE-WMS-DAILY-RATE  TO WMS-PREV-DAILY                1001295
675934         MOVE YE-LN-CUR-RATES    TO WMS-LN-OLD-CUR-RATES          1003625
675938         GO TO S0110.                                             1001295
675940                                                                  1001295
675942     IF  WMS-PREV-SPLIT-RATE-PTR NOT EQUAL ZERO                   1001295
675944         PERFORM OLD-SPLIT-RATE-MOVE-YE                           1003625
675946            THRU OLD-SPLIT-RATE-MOVE-YE-EXIT                      1003625
675948         DIVIDE NEXT-DAYS                                         1001295
675950               INTO WMS-SPL-OLD-CUR-ANN (1)                       1003625
675952               GIVING WMS-SPL-OLD-CUR-DAF (1)                     1003625
675954         DIVIDE NEXT-DAYS                                         1001295
675956               INTO WMS-SPL-OLD-CUR-ANN (2)                       9916429
675958               GIVING WMS-SPL-OLD-CUR-DAF (2)                     9916429
675960         DIVIDE NEXT-DAYS                                         1001295
675962               INTO WMS-SPL-OLD-CUR-ANN (3)                       9916429
675964               GIVING WMS-SPL-OLD-CUR-DAF (3)                     9916429
675968         PERFORM C2384 THRU C2400                                 1001295
675970         PERFORM YE-OLD-SPLIT-RATE-MOVE                           1003625
675972            THRU YE-OLD-SPLIT-RATE-MOVE-EXIT                      1003625
675974         GO TO S0110.                                             1001295
675976                                                                  1001295
675978     IF  WMS-SPLIT-RATE-IND EQUAL '2'                             1001295
675980         MOVE WMS-LOAN-SPLIT-RATE-SCHEDULE TO YE-SPL-CUR-INFO     1003625
675982         DIVIDE NEXT-DAYS                                         1001295
675984                   INTO WMS-RATE1-ANNUAL GIVING WMS-RATE1-DAILY   1001295
675986         DIVIDE NEXT-DAYS                                         1001295
675988                   INTO WMS-RATE2-ANNUAL GIVING WMS-RATE2-DAILY   1001295
675990         DIVIDE NEXT-DAYS                                         1001295
675992                   INTO WMS-RATE3-ANNUAL GIVING WMS-RATE3-DAILY   1001295
675994         PERFORM C2384 THRU C2400                                 1001295
675996         MOVE YE-SPL-CUR-INFO TO WMS-LOAN-SPLIT-RATE-SCHEDULE     1003625
675998         GO TO S0110.                                             1001295
676000                                                                  1001295
676002     MOVE WMS-PREV-ANNUAL    TO YE-WMS-ANNUAL-RATE.               1001295
676004     MOVE WMS-PREV-DAILY     TO YE-WMS-DAILY-RATE.                1001295
676006     DIVIDE NEXT-DAYS INTO WMS-PREV-ANNUAL                        1001295
676008                             GIVING WMS-PREV-DAILY.               1001295
676010     PERFORM C2384 THRU C2400.                                    1001295
676012     MOVE YE-WMS-ANNUAL-RATE TO WMS-PREV-ANNUAL.                  1001295
676014     MOVE YE-WMS-DAILY-RATE  TO WMS-PREV-DAILY.                   1001295
676016 S0110.                                                           1001295
676250     MOVE WBC-NEXT-PAST-ACCR-DAYS TO HOLD-NO3.                    0266741
676300     IF WBC-LOAN-DAILY-ACCRUAL EQUAL '0'                          0266741
676350         ADD +1 TO HOLD-NO3.
676400     IF  WMS-LOAN-STATUS NOT EQUAL '6'                            IM006
676410         MULTIPLY HOLD-NO3 BY WMS-LOAN-ACCR-AMT GIVING ACCR-AMT1  IM006
676420     ELSE                                                         IM006
676430         MOVE ZERO TO ACCR-AMT1.                                  IM006
676450     ADD +.005  WMS-LOAN-ACCR-INT TO ACCR-AMT1.
676500     ADD ACCR-AMT1 TO WMS-PAYOFF-AMT.                             IM006
676510     IF  YEAR-CHANGE EQUAL '1'                                    1001295
676520         IF  WMS-LOAN-360-DAY-FACTOR EQUAL '0'                    0817657
676540             MOVE '0' TO LOAN-ACCR-RECALC                         1001295
676545                         WMS-LOAN-CALC-CODE                       1001295
676550             MOVE LEAP-YEAR-FLAG TO WBC-LEAP-YEAR.                0266741
676600 S0200.
676650     IF  WMS-SAVINGS-TRLR EQUAL '0'
676700         GO  TO  S0300.
676750     IF  WMS-INT-STATUS GREATER THAN '6'
676800         MOVE +0 TO WMS-PROJ-ACCR
676850         GO TO S0300.
676900     IF  WBC-NEXT-PAST-ACCR-DAYS EQUAL ZEROES                     0266741
676950         MOVE WMS-ACCR-INT TO ACCR-AMT1
676960         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
676970             MOVE WMS-INV-SVC-ACCRD-CYC TO ACCR-SVC-AMT           1004554
676980             GO TO S0260                                          1004554
676990         ELSE                                                     1004554
677000             GO TO S0260.                                         1004554
677010     MOVE WBC-NEXT-PAST-ACCR-DAYS TO HOLD-NO3.                    0266741
677050     IF  WMS-CMA-INDICATOR EQUAL '1' AND
677100         WMS-CMA-BALANCE-USE EQUAL '1'
677150         MOVE WMS-PREV-INT-BAL TO CUR-BAL, HOLD-CUR-BAL           IM002
677200     ELSE
677250         MOVE WMS-INT-CUR-BAL TO CUR-BAL, HOLD-CUR-BAL.           IM002
677260 S0210.                                                           1004678
677300     MOVE '1' TO INTEREST-ADJUST-CODE.
677350     MOVE PROJ-ACCR-SV-BAL TO PROJ-ACCR-BAL.
677400     IF WBC-ACCRUAL-CALC EQUAL '0', GO TO S0240.                  0266741
677450     IF  WBC-ACCRUAL-CALC EQUAL '1'                               0266741
677500         MOVE WMS-COLL-CALC TO CALC-FLAG
677550     ELSE
677600         MOVE WMS-NSF-CALC TO CALC-FLAG.
677650 S0220.
677700     IF  CALC-FLAG EQUAL '1', GO TO S0240.                        0902509
677750     IF (CALC-FLAG EQUAL '2' OR '5' OR '6')
677800         SUBTRACT WMS-HOLD-AMT FROM CUR-BAL.
677850     IF  WBC-FLOAT-FLAG EQUAL 'P', GO TO S0225.                   0266741
677900     IF (CALC-FLAG EQUAL '3' OR '5') AND
677950         WMS-BANK-AVAIL-TRLR EQUAL '1' AND                        IM007
677970         WMS-BANK-AVAIL-AMT GREATER THAN +0                       IM007
677990         MOVE WMS-BANK-AVAIL-TRAILER TO WORK-BANK-AVAIL-TRLR      IM007
678030         MOVE 'N' TO PROJ-BANK-AVAIL-CHANGE                       IM007
678150         GO  TO  S0240.
678200     IF (CALC-FLAG EQUAL '4' OR '6') AND
678250         WMS-CUST-AVAIL-TRLR EQUAL '1' AND                        IM007
678270         WMS-CUST-AVAIL-AMT GREATER THAN +0                       IM007
678290         MOVE WMS-CUST-AVAIL-TRAILER TO WORK-CUST-AVAIL-TRLR      IM007
678400         MOVE 'N' TO PROJ-UNAVAIL-CHANGE                          IM007
678450         GO  TO  S0240.
678500 S0225.
678550     IF (CALC-FLAG EQUAL '3' OR '5')
678600         SUBTRACT WMS-BANK-AVAIL-AMT FROM CUR-BAL.                IM007
678650     IF (CALC-FLAG EQUAL '4' OR '6')
678700         SUBTRACT WMS-CUST-AVAIL-AMT FROM CUR-BAL.                IM007
678950 S0240.  EXIT.
679250 S0247.
679255     IF  YEAR-CHANGE EQUAL '0'                                    1001295
679258         GO TO S0247-PROJECT.                                     0627539
679260     IF  WMS-DAILY-RATE-CODE EQUAL '1' OR '3'                     0817657
679261         GO TO S0247-PROJECT.                                     1001295
679262 S0247-YEAR-CHANGE.                                               1001295
679263     IF  IOD-FLAG EQUAL 'N'                                       1001295
679264         IF  WMS-HIFI-INDICATOR GREATER THAN +0                   1001295
679265             GO TO CALC-TIERED-FACTORS.                           1001295
679267     GO TO CALC-NON-TIERED-FACTORS.                               0817657
679269 CALC-TIERED-FACTORS.                                             1001295
679271     MOVE +0                   TO ACCRUAL-ANNUAL-RATE             1003625
679272                                  ACCRUAL-DAILY-RATE.             1003625
679273     MOVE WMS-TIER-CUR-DATA    TO YEAR-END-FND-CUR-DATA.          1003625
679275     MOVE WMS-DFLT-IOD-CUR-DAF TO YEAR-END-DDA-CUR-DATA.          1003625
679276     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (1)                   1003625
679277                    GIVING WMS-TIER-CUR-DAF (1).                  1003625
679278     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (2)                   1003625
679279                    GIVING WMS-TIER-CUR-DAF (2).                  1003625
679280     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (3)                   1003625
679281                    GIVING WMS-TIER-CUR-DAF (3).                  1003625
679282     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (4)                   1003625
679283                    GIVING WMS-TIER-CUR-DAF (4).                  1003625
679284     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (5)                   1003625
679285                    GIVING WMS-TIER-CUR-DAF (5).                  1003625
679286     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (6)                   1003625
679287                    GIVING WMS-TIER-CUR-DAF (6).                  1003625
679288     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (7)                   1003625
679289                    GIVING WMS-TIER-CUR-DAF (7).                  1003625
679290     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (8)                   1003625
679291                    GIVING WMS-TIER-CUR-DAF (8).                  1003625
679292     DIVIDE NEXT-DAYS INTO WMS-TIER-CUR-ANN (9)                   1003625
679293                    GIVING WMS-TIER-CUR-DAF (9).                  1003625
679294     IF  WMS-DAILY-RATE-CODE EQUAL '0'                            0817657
679295     OR (WMS-DAILY-RATE-CODE EQUAL '2'                            0817657
679296     AND WBC-DAILY-RATE-PHASE EQUAL SPACES)                       0817657
679297         DIVIDE NEXT-DAYS INTO WMS-DFLT-IOD-CUR-ANN               0817657
679298                        GIVING WMS-DFLT-IOD-CUR-DAF               0817657
679299     ELSE                                                         0817657
679300         IF  WMS-DAILY-RATE-CODE EQUAL '2'                        0817657
679301             MOVE WMS-DFLT-IOD-CUR-ANN TO WK-LIR-ANNUAL           0817657
679302             MOVE WBC-DAILY-RATE-PHASE TO IM31-PH2                0817657
679303             CALL 'SILINK' USING IM31-PHASE                       0817657
679304                                 RATE-WORK-AREA                   0817657
679305             MOVE WK-LIR-DAILY TO WMS-DFLT-IOD-CUR-DAF.           0817657
679306     GO TO S0247-PROJECT.                                         0817657
679307 CALC-NON-TIERED-FACTORS.                                         0817657
679308     IF IOD-FLAG EQUAL 'N'                                        0817657
679309         MOVE WMS-IOD-CUR-ANN                                     0817657
679310                 TO ACCRUAL-ANNUAL-RATE                           0817657
679311     ELSE                                                         0817657
679312         MOVE WMS-SAV-CUR-ANN                                     0817657
679313                 TO ACCRUAL-ANNUAL-RATE.                          0817657
679314     IF  WMS-DAILY-RATE-CODE EQUAL '0'                            0817657
679315     OR (WMS-DAILY-RATE-CODE EQUAL '2'                            0817657
679316     AND WBC-DAILY-RATE-PHASE EQUAL SPACES)                       0817657
679317         DIVIDE NEXT-DAYS INTO ACCRUAL-ANNUAL-RATE                0817657
679318                  GIVING ACCRUAL-DAILY-RATE                       0817657
679319     ELSE                                                         0817657
679320         IF  WMS-DAILY-RATE-CODE EQUAL '2'                        0817657
679321             MOVE ACCRUAL-ANNUAL-RATE TO WK-LIR-ANNUAL            0817657
679322             MOVE WBC-DAILY-RATE-PHASE TO IM31-PH2                0817657
679323             CALL 'SILINK' USING IM31-PHASE                       0817657
679324                                 RATE-WORK-AREA                   0817657
679325             MOVE WK-LIR-DAILY TO ACCRUAL-DAILY-RATE.             0817657
679326 S0247-PROJECT.                                                   0817657
679327     MOVE ZEROES TO ACCR-AMT1.                                    0817657
679328     MOVE ZEROES TO ACCR-SVC-AMT.                                 0817657
679330     MOVE +0 TO W.                                                1001295
679350     IF  PROJ-BANK-AVAIL-CHANGE EQUAL 'N'                         IM007
679400         PERFORM PROJECT-FLOAT THRU PROJECT-ACCRUALS-END          1001295
679450             HOLD-NO3 TIMES                                       1004678
679500         MOVE 'F' TO PROJ-BANK-AVAIL-CHANGE                       IM007
679550         GO TO S0247-PROJECT-END.                                 1001295
679600     IF PROJ-UNAVAIL-CHANGE EQUAL 'N'                             IM007
679620         PERFORM PROJECT-UNAVAIL THRU PROJECT-ACCRUALS-END        1001295
679700             HOLD-NO3 TIMES                                       1004678
679750         MOVE 'F' TO PROJ-UNAVAIL-CHANGE                          IM007
679800         GO TO S0247-PROJECT-END.                                 1001295
679850     MOVE CUR-BAL TO ACCRUAL-BALANCE.
679900     PERFORM PROJECT-ACCRUALS THRU PROJECT-ACCRUALS-END           1001295
679902                              HOLD-NO3 TIMES.                     1004678
679903 S0247-PROJECT-END.                                               1001295
679904     IF  WMS-DAILY-RATE-CODE EQUAL '1' OR '3'                     0817657
679905         GO TO S0247-EXIT.                                        0627539
679906     IF  YEAR-CHANGE EQUAL '1'                                    0627539
679908         IF  IOD-FLAG EQUAL 'N'                                   1001295
679910             IF  WMS-HIFI-INDICATOR GREATER THAN +0               1001295
679912                 MOVE YEAR-END-FND-CUR-DATA                       1003625
679914                        TO WMS-TIER-CUR-DATA                      1003625
679916                 MOVE YEAR-END-DDA-CUR-DATA                       1003625
679918                        TO WMS-DFLT-IOD-CUR-DAF.                  1003625
679920                                                                  1001295
679950 S0247-EXIT. EXIT.
680000 S0250.
680050     ADD WMS-ACCR-INT TO ACCR-AMT1.
680060     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
680070         ADD WMS-INV-SVC-ACCRD-CYC TO ACCR-SVC-AMT.               1004554
680080 S0250-EXIT.                                                      1004678
680090     EXIT.                                                        1004678
680100 S0260.
680105     IF  WMS-CMA-INDICATOR EQUAL '1'                              1004678
680110     AND WMS-CMA-BALANCE-USE EQUAL '1'                            1004678
680115         MOVE WMS-INT-CUR-BAL TO CUR-BAL                          1004678
680120                                 HOLD-CUR-BAL                     1004678
680125         PERFORM S0210 THRU S0240                                 1004678
680130         MOVE +1 TO HOLD-NO3                                      1004678
680135         MOVE 'F' TO IOD-FLAG                                     1004678
680140         PERFORM S0247 THRU S0250-EXIT.                           1004678
680150     IF ACCR-AMT1 GREATER THAN ZERO
680200         ADD +.005 TO ACCR-AMT1
680250     ELSE
680300         ADD -.005 TO ACCR-AMT1.
680350     MOVE ACCR-AMT1 TO WMS-PROJ-ACCR.
680360     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
680370         IF  ACCR-SVC-AMT GREATER THAN ZERO                       1004554
680380             ADD +.005 ACCR-SVC-AMT GIVING HOLD-SVC-FEE1          1004554
680390             SUBTRACT HOLD-SVC-FEE1 FROM WMS-PROJ-ACCR.           1004554
680400     IF  WMS-ACCR-INT GREATER THAN ZERO
680450         ADD +.005, WMS-ACCR-INT GIVING HOLD-ACCR2
680500     ELSE
680550         ADD -.005, WMS-ACCR-INT GIVING HOLD-ACCR2.
680560     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
680570         ADD HOLD-ACCR2 TO INV-DIV-ACCRD-END                      1004554
680580                           WS-GL-INV-DIV-ACCRD-END                1004554
680590     ELSE                                                         1004554
680600         ADD HOLD-ACCR2 TO DDA-END-INT-BAL                        1004554
680601                           WS-GL-DDA-END-INT-BAL                  1004554
680650         ADD +1         TO DDA-END-INT-NO                         1004554
680660                           WS-GL-DDA-END-INT-NO.                  1004554
680700 S0300.
680710*----------------------------------------------------------------*1105504
680711*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
680712*----------------------------------------------------------------*1105504
680715     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
680716     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
680717         GO TO S0470.                                             1105504
680750     IF  WMS-IOD-RATE-PTR EQUAL ZERO AND
680800         WMS-HIFI-INDICATOR EQUAL ZERO
680850         GO TO S0500.                                             0335614
680900     IF  WMS-STATUS EQUAL '03' OR '04' OR '05' OR '08'            9916132
680950         MOVE +0 TO WMS-IOD-PROJ-ACCR
681000         GO TO S0470.                                             IM006
681050     IF  WBC-NEXT-PAST-ACCR-DAYS EQUAL ZEROES                     0266741
681100         MOVE WMS-IOD-CYC-ACC-INT TO ACCR-AMT1
681150         GO  TO  S0460.
681200     MOVE '1' TO INTEREST-ADJUST-CODE.
681250     MOVE WMS-DDA-BAL TO CUR-BAL, HOLD-CUR-BAL.                   IM002
681300     MOVE WMS-IOD-CALC TO CALC-FLAG.
681350     MOVE PROJ-ACCR-IOD-BAL TO PROJ-ACCR-BAL.
681400     PERFORM S0220 THRU S0240.
681650     MOVE 'N' TO IOD-FLAG.
681660     MOVE WBC-NEXT-PAST-ACCR-DAYS TO HOLD-NO3.                    0266741
681700     PERFORM S0247 THRU S0247-EXIT.
681750     MOVE 'F' TO IOD-FLAG.
681800 S0450.
681850     ADD WMS-IOD-CYC-ACC-INT TO ACCR-AMT1.
681900 S0460.
681950     IF ACCR-AMT1 GREATER THAN ZERO
682000         ADD +.005 TO ACCR-AMT1
682050     ELSE
682100         ADD -.005 TO ACCR-AMT1.
682150     MOVE ACCR-AMT1 TO WMS-IOD-PROJ-ACCR.
682170 S0470.                                                           IM006
682200     IF  WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                    0902970
682250         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR2
682300     ELSE
682350         ADD -.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR2.
682400     ADD HOLD-ACCR2 TO IOD-END-INT-BAL, WS-GL-IOD-END-INT-BAL.    0902970
682450     ADD +1 TO IOD-END-INT-NO, WS-GL-IOD-END-INT-NO.              0902970
682460*                                                                 0335614
682462     COPY IMPDODPJ.                                               0335614
682464*                                                                 0335614
682500 S1000.
682550     IF WBC-FILE-LIST-TODAY EQUAL TO '1'                          0266741
682600         AND WBC-TEMP-FILE-LIST NOT EQUAL TO '0'                  0266741
682650         MOVE '17' TO IMEX-REC-NO
682700         MOVE '00' TO IMEX-CODE-1
682750         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
682800     IF WMS-BANK-AVAIL-EXCP EQUAL TO '1'                          IM007
682850         MOVE '17' TO IMEX-REC-NO
682900         MOVE 'I9' TO IMEX-CODE-1
682950         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
683000     IF  HIFI-RPT-INEL-FLAG EQUAL '1'
683050         MOVE '17' TO IMEX-REC-NO
683100         MOVE 'HI' TO IMEX-CODE-1
683150         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
683160     IF  (WMS-TAX-NO EQUAL (ALL '0' OR ALL SPACES))               9715664
683165     OR  ((WMS-TAX-CODE IS NUMERIC)                               9715664
683167             AND (WMS-TAX-NO IS NOT NUMERIC))                     9715664
683170     OR  ((WMS-TAX-CODE IS ALPHABETIC)                            9715664
683172             AND (WMS-INFO-TRLR EQUAL '0'))                       9715664
683175     OR  ((WMS-TAX-CODE IS ALPHABETIC)                            9715664
683178             AND (WMS-NRA-TAX-COUNTRY EQUAL SPACES))              9715664
683180             MOVE '17' TO IMEX-REC-NO                             1105664
683185             MOVE 'MS' TO IMEX-CODE-1                             1105664
683190             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             1105664
683191     IF  WMS-SC-REL-CODE  EQUAL '1' OR '4' OR '5'                 9915749
683193         MOVE '17'      TO  IMEX-REC-NO                           IM007
683194         MOVE 'EA'      TO  IMEX-CODE-1                           IM007
683195         PERFORM WRITE-EX-MST  THRU  WRITE-EX-EXIT.               IM007
683200     IF  WMS-EFA-TRLR    EQUAL   '1'                              IM007
683202         NEXT SENTENCE                                            IM007
683204     ELSE                                                         IM007
683206         GO  TO  S1006.                                           IM007
683221     IF  WMS-EFA-STATUS-FLAG  GREATER THAN  '0'                   IM007
683222     OR  WMS-EFA-COLLECTN-FLAG GREATER THAN '0'                   IM007
683223         MOVE '17'      TO  IMEX-REC-NO                           IM007
683225         MOVE 'EB'      TO  IMEX-CODE-1                           IM007
683233         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 IM007
683236 S1006.                                                           IM007
683239     ADD +1 TO DDA-END-NO-ACCTS, WS-GL-DDA-END-NO-ACCTS.          0902970
683250     ADD WMS-DDA-BAL TO DDA-END-BAL                               0902970
683251                        WS-GL-DDA-END-BAL.                        0902970
683300     IF WMS-IOD-RATE-PTR GREATER THAN ZERO
683350     OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
683400         ADD +1 TO IOD-END-NO-ACCTS, WS-GL-IOD-END-NO-ACCTS       0902970
683450         ADD WMS-DDA-BAL TO IOD-END-BAL, WS-GL-IOD-END-BAL.       0902970
683458     IF  WMS-CLUB-ACCT-CONTROL EQUAL '0'                          IM006
683466         GO TO S1010.                                             IM006
683474     IF  WMS-STATUS EQUAL '04' OR '05' OR '08'                    IM006
683482         IF  WMS-CLUB-ACCT-STATUS EQUAL '0'                       IM006
683490             MOVE '1' TO WMS-CLUB-ACCT-STATUS.                    IM006
683500 S1010.
683550     IF MTD-AGGR-FLAG EQUAL TO '1', GO TO S1024.
683600 S1015.
683620     MOVE WMS-COLL-CALC TO CALC-FLAG.                             IM003
683650     MOVE WMS-CURR-BAL TO CUR-BAL.
683700     PERFORM K0104 THRU K0105.
683750     MOVE CUR-BAL TO COLL-BAL.
683769     MOVE '1' TO WXI-EXCLUDE-BAL.                                 2016639
683770     PERFORM K0106 THRU K0106-EXIT.                               IM003
683771     MOVE '0' TO WXI-EXCLUDE-BAL.                                 2016639
683800 S1020.
683810*----------------------------------------------------------------*1105504
683811*    BYPASS AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
683812*----------------------------------------------------------------*1105504
683815     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
683816     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
683817         GO TO S1024.                                             1105504
683850     ADD COLL-BAL TO WMS-MTD-AGGR-COLL
683900                     WMS-YTD-AGGR-BAL.
683905     IF  COLL-BAL LESS THAN ZERO                                  2016654
683910         ADD COLL-BAL       TO WMS-MTD-NEG-AGGR-COLL.             2016654
683920     ADD CUST-BAL TO WMS-MTD-AGGR-CUST-COLL.                      IM003
683925     IF  CUST-BAL LESS THAN ZERO                                  2016654
683927         ADD CUST-BAL       TO WMS-MTD-NEG-AGGR-CUST-COLL.        2016654
683930     ADD WMS-CASH-AVAIL-AMT TO WMS-CASH-AVAIL-MTD-AGGR            IM007
683940                               WMS-CASH-AVAIL-YTD-AGGR.           IM007
683950     ADD +1 TO WMS-MTD-AGGR-DAYS
683955               WMS-YTD-AGGR-DAYS.                                 2016639
683960     IF  WMS-XINV-LINK-IND    EQUAL 'L' OR 'P'                    2016639
683965         ADD WMS-XINV-BALANCE        TO WMS-XINV-CTD-AGGR         2016639
683970                                        WMS-XINV-MTD-AGGR         2016639
683975                                        WMS-XINV-YTD-AGGR         2016639
683980         ADD +1                      TO WMS-XINV-CTD-DAYS         2016639
683985                                        WMS-XINV-MTD-DAYS         2016639
683990                                        WMS-XINV-YTD-DAYS.        2016639
684000*                                                                 2016639
684010     IF  WMS-SAVINGS-TRLR EQUAL '1'                               IM003
684020         PERFORM R4005 THRU R4007                                 IM004
684030         ADD CUR-BAL TO WMS-INT-MTD-AGGR, WMS-INT-YTD-AGGR-BALS   IM004
684040         ADD +1              TO WMS-INT-YTD-AGGR-DAYS.            IM004
684060     ADD WMS-CURR-BAL TO WMS-MTD-AGGR-BAL.                        IM004
684100     IF  WMS-CURR-BAL GREATER THAN WMS-MTD-HIGH-BAL OR            0515543
684110         WBC-BANKING-DAYS EQUAL 1                                 0515543
684150         MOVE WMS-CURR-BAL TO WMS-MTD-HIGH-BAL.
684200     IF WMS-CURR-BAL LESS THAN WMS-MTD-MIN-BAL
684250         IF  WMS-SAV-PTR EQUAL ZERO                               IM004
684270         AND WMS-CHG-CARD-FLG EQUAL ZERO                          IM004
684300             MOVE WBC-CAPTURE-DATE TO WMS-DATE-MIN                0266741
684350             MOVE WMS-CURR-BAL TO WMS-MTD-MIN-BAL
684400         ELSE
684450         IF  WMS-MIN-BAL LESS THAN WMS-MTD-MIN-BAL
684500             MOVE WBC-CAPTURE-DATE TO WMS-DATE-MIN                0266741
684550             MOVE WMS-MIN-BAL TO WMS-MTD-MIN-BAL.
684600     IF WMS-DDA-BAL LESS THAN WMS-MTD-DDA-MIN
684650         MOVE WMS-DDA-BAL TO WMS-MTD-DDA-MIN.
684700     IF WMS-SAV-PTR EQUAL TO ZERO
684720     AND WMS-CHG-CARD-FLG EQUAL ZERO                              IM004
684750         GO TO S1022.                                             IM003
684800     IF WMS-MTD-DDA-MIN LESS THAN WMS-MIN-BAL
684850         MOVE WMS-MIN-BAL TO WMS-MTD-DDA-MIN.
684852 S1022.                                                           IM003
684854     IF  WMS-MARKET-TRLR EQUAL '0'                                IM003
684856     OR  WMS-MARKET-DELETE EQUAL '1'                              IM003
684858         GO TO S1024.                                             IM003
684860     IF  WMS-HISTORY-OPT-BAL EQUAL '1'                            IM003
684862         MOVE WMS-DDA-BAL TO HOLD-AMT13.                          IM003
684864     IF  WMS-HISTORY-OPT-BAL EQUAL '2'                            IM003
684866         IF  WMS-SAVINGS-TRLR EQUAL '1'                           IM007
684867             MOVE WMS-INT-CUR-BAL TO HOLD-AMT13                   IM007
684868         ELSE                                                     IM007
684869             MOVE +0.00           TO HOLD-AMT13.                  IM007
684870     IF  WMS-HISTORY-OPT-BAL EQUAL '3'                            IM007
684871         MOVE WMS-CURR-BAL TO HOLD-AMT13.                         IM007
684872     IF  WMS-HISTORY-BAL-CALC EQUAL '2' OR '5' OR '6'             IM003
684874     OR  (WMS-HISTORY-BAL-CALC EQUAL '0'                          IM003
684875     AND (WMS-COLL-CALC EQUAL '2' OR '5' OR '6'))                 IM003
684876         SUBTRACT WMS-HOLD-AMT FROM HOLD-AMT13.                   IM003
684877     IF  WMS-HISTORY-BAL-CALC EQUAL '3' OR '5'                    IM003
684878     OR  (WMS-HISTORY-BAL-CALC EQUAL '0'                          IM003
684879     AND (WMS-COLL-CALC EQUAL '3' OR '5'))                        IM003
684880         SUBTRACT WMS-BANK-AVAIL-AMT FROM HOLD-AMT13.             IM007
684881     IF  WMS-HISTORY-BAL-CALC EQUAL '4' OR '6'                    IM003
684882     OR  (WMS-HISTORY-BAL-CALC EQUAL '0'                          IM003
684883     AND (WMS-COLL-CALC EQUAL '4' OR '6'))                        IM003
684884         SUBTRACT WMS-CUST-AVAIL-AMT FROM HOLD-AMT13.             IM007
684885     ADD HOLD-AMT13 TO WMS-HST-AGGR-BAL.                          IM003
684886     ADD +1 TO WMS-HST-AGGR-DAYS (1).                             IM003
684888     IF  WMS-HST-AGGR-DAYS (1) GREATER THAN ZERO                  IM003
684890         DIVIDE WMS-HST-AGGR-BAL BY WMS-HST-AGGR-DAYS (1)         IM003
684892             GIVING WMS-HST-AVG-BAL (1).                          IM003
684900 S1024.  EXIT.
684950 S1025.
685000     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'
685050         IF  WMS-OD-CYC-ACR GREATER THAN +0                       0902213
685060             ADD +.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR2           0902213
685070             ADD HOLD-ACCR2     TO OD-ACCRD-CY, WS-GL-OD-ACCRD-CY 0902970
685080         ELSE                                                     0902213
685090             ADD -.005 WMS-OD-CYC-ACR GIVING HOLD-ACCR2           0902213
685100             ADD HOLD-ACCR2    TO OD-ACCRD-CY, WS-GL-OD-ACCRD-CY. 0902970
685110     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            0902213
685150         ADD WMS-OD-CYC-CHGD      TO OD-CHARGED-CY,               0902970
685151                                     WS-GL-OD-CHARGED-CY          0902970
685200         ADD WMS-OD-MTD-ACR       TO OD-ACCRUED-MTD,              0902970
685201                                     WS-GL-OD-ACCRUED-MTD         0902970
685202         ADD WMS-OD-YTD-ACR       TO OD-ACCRUED-YTD               1105132
685203                                     WS-GL-OD-ACCRUED-YTD         1105132
685250         ADD WMS-OD-MTD-CHGD      TO OD-CHARGED-MTD
685251                                     WS-GL-OD-CHARGED-MTD         0902970
685300         ADD WMS-OD-YTD-CHGD      TO OD-CHARGED-YTD
685301                                     WS-GL-OD-CHARGED-YTD         0902970
685350         IF  WMS-OD-ACCRL-BAL LESS THAN ZERO
685400             ADD WMS-OD-ACCRL-BAL TO OD-END-ACCT-BAL,             0902970
685401                                     WS-GL-OD-END-ACCT-BAL        0902970
685450             ADD +1               TO OD-END-ACCT-NO               0902970
685451                                     WS-GL-OD-END-ACCT-NO.        0902970
685460*----------------------------------------------------------------*1105504
685462*    NEGATE AGGREGATE UPDATES IF THIS IS A STATIC RUN.           *1105504
685464*    SUBTRACT BEFORE PROGRAM ADDS TO CREATE NET EFFECT OF 0.     *1105504
685466*----------------------------------------------------------------*1105504
685468     IF  WBC-RUN-FLAG EQUAL 'I'                                   0266741
685470     AND WBC-ACCRUAL-DAYS EQUAL ZERO                              0266741
685472         IF  WMS-DDA-BAL LESS THAN ZERO                           1105504
685474             IF  WMS-SAV-PTR EQUAL ZERO                           1105504
685476             AND WMS-CHG-CARD-FLG EQUAL ZERO                      1105504
685478                 SUBTRACT WMS-DDA-BAL FROM WMS-MTD-AGGR-OD        1105504
685480                 SUBTRACT +1 FROM WMS-MTD-OD-DAYS.                1105504
685500     IF  WMS-DDA-BAL GREATER THAN ZERO
685550         GO TO S1027.
685600     IF  WMS-DDA-BAL LESS THAN ZERO
685650         ADD +1 TO DDA-END-OD-NO, WS-GL-DDA-END-OD-NO             0902970
685700         ADD WMS-DDA-BAL TO DDA-END-OD-AMT, WS-GL-DDA-END-OD-AMT  0902970
685750         IF WMS-SAV-PTR EQUAL ZERO                                IM004
685760         AND WMS-CHG-CARD-FLG EQUAL ZERO                          IM004
685770             ADD WMS-DDA-BAL TO WMS-MTD-AGGR-OD                   IM004
685780             ADD +1 TO WMS-MTD-OD-DAYS                            IM004
685800             GO TO S1027
685850         ELSE
686000             GO TO S1027.
686050     IF  WMS-SAVINGS-TRLR EQUAL '1'
686100         AND WMS-INT-STATUS NOT EQUAL '2'
686150         IF  WMS-CURR-BAL EQUAL ZERO
686200             ADD +1 TO DDA-END-ZERO-BAL, WS-GL-DDA-END-ZERO-BAL   0902970
686250             GO TO S1027
686300         ELSE
686350             GO TO S1027.
686400     ADD +1 TO DDA-END-ZERO-BAL, WS-GL-DDA-END-ZERO-BAL.          0902970
686450 S1027.
686500     MOVE +0 TO X.
686550     MOVE 'F' TO AFFL-ACCT-FLAG.
686600     IF WMS-TRNSFR-AFFL-TRLR EQUAL ZERO, GO  TO  S1029.
686650 S1028.
686700     ADD +1 TO X.
686750     IF  X GREATER THAN WMS-TRNSFR-AFFL-TRLR, GO  TO  S1029.
686800     IF WMS-TRNSFR-AFFL-FLAG (X) EQUAL 'A'
686850         MOVE 'N' TO  AFFL-ACCT-FLAG
686900         ADD +1 TO AFFIL-TRLR-NO, WS-GL-AFFIL-TRLR-NO.            0902970
686950     GO  TO  S1028.
686951 S1029.                                                           1005110
686952*---------------------------------------------------------------  1005110
686953* UPDATE DAILY TOTALS FOR TFR PROCESSING                          1005110
686954*---------------------------------------------------------------  1005110
686955     IF  WMS-SAVINGS-TRLR  EQUAL '1'                              1005110
686956     AND WMS-INT-INV-IND   EQUAL 'Y'                              1005110
686957         SUBTRACT WMS-PREV-INT-BAL   FROM   WMS-INT-CUR-BAL       1005110
686958                                     GIVING SAVINGS-BALANCE-DIF   1005110
686959         IF  SAVINGS-BALANCE-DIF GREATER THAN ZERO                1005110
686960             ADD SAVINGS-BALANCE-DIF TO WBC-REG-TFR-AMT (20).     0266741
686962     IF  WBC-REG-TFR-AMT(20) GREATER ZERO                         0266741
686964     AND WBC-QUARTER-DAYS  GREATER ZERO                           0266741
686966         DIVIDE WBC-REG-TFR-AMT(20) BY WBC-QUARTER-DAYS           0266741
686968             GIVING WBC-REG-CALL-AMT(21)                          0266741
686970     ELSE                                                         1105132
686972         MOVE ZERO TO WBC-REG-CALL-AMT(21).                       0266741
686990     MOVE WBC-ACCRUAL-DAYS TO HOLD-ACCRUAL-DAYS.                  0266741
687000     PERFORM S3010-RCK-AVERAGES THRU S3010-EXIT.                  1005110
687002     IF  WMS-LOAN-TRLR EQUAL '1'                                  0637525
687004     AND WMS-LOAN-STATUS EQUAL '6'                                0637525
687005     AND WMS-LOAN-STAT-CHG EQUAL 'N'                              0637636
687006         IF  WMS-LOAN-STATUS NOT EQUAL TO LOAN-STATUS-IN          0637525
687007             MOVE 'Y' TO WMS-LOAN-STAT-CHG                        0637636
687008             ADD WMS-PRIN-BAL TO WBC-REG-NONACCR-AMT              0637525
687010             ADD WMS-INTRST-BAL TO WBC-REG-NONACCR-AMT            0637525
687012             ADD WMS-LOAN-ACCR-INT +.005 GIVING HOLD-ACCR1        0637525
687014             ADD HOLD-ACCR1 TO WBC-REG-NONACCR-AMT                0637525
687016             SUBTRACT WMS-COSTS-UNEARNED FROM WBC-REG-NONACCR-AMT.0637525
687026     IF WBC-MONTH-END EQUAL '0'                                   0417181
687027         GO TO S1029-NOT-EOM.                                     0417181
687028*--------------------------------------------------------------*  0417181
687029* UPDATE MONTH-END TOTALS FOR TFR PROCESSING                   *  0417181
687030*--------------------------------------------------------------*  0417181
687031     PERFORM Y5000-30-TFRCSI-ACCUM THRU Y5000-30-EXIT.            0417181
687032*---------------------------------------------------------------  1004773
687033* UPDATE THE AMOUNT OF NET EARNED THIS QUARTER ON                 1004773
687034* COMMERCIAL NONMORTGAGE LOANS                                    1004773
687035*---------------------------------------------------------------  1004773
687036     IF WMS-LOAN-TRLR EQUAL '1'                                   1004773
687037     AND WMS-LOAN-REG-CODE EQUAL '303'                            1004773
687042         ADD WMS-EARNED-INT TO WBC-REG-TFR-AMT (1)                0266741
687043         ADD WMS-COSTS-AMORT-MTD TO WBC-REG-TFR-AMT (1).          0266741
687044     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            1004773
687045         IF (WMS-SYS-TYPE GREATER THAN '009'                      1004773
687046         AND WMS-SYS-TYPE LESS THAN '020')                        1004773
687047         OR (WMS-SYS-TYPE GREATER THAN '029'                      1004773
687048         AND WMS-SYS-TYPE LESS THAN '050')                        1004773
687049         OR (WMS-SYS-TYPE GREATER THAN '069'                      1004773
687050         AND WMS-SYS-TYPE LESS THAN '100')                        1010048
687051             ADD WMS-OD-MTD-ACR TO WBC-REG-TFR-AMT (1).           0266741
687052*---------------------------------------------------------------  1004773
687053* UPDATE THE AMOUNT OF INTEREST EARNED THIS QUARTER ON            1004773
687054* CONSUMER NONMORTGAGE LOANS                                      1004773
687055*---------------------------------------------------------------  1004773
687056     IF WMS-LOAN-TRLR EQUAL '1'                                   1004773
687057     AND WMS-LOAN-REG-CODE EQUAL '330'                            0417181
687062         ADD WMS-EARNED-INT TO WBC-REG-TFR-AMT (2)                0266741
687063         ADD WMS-COSTS-AMORT-MTD TO WBC-REG-TFR-AMT (2).          0266741
687064     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            1004773
687065         IF (WMS-SYS-TYPE GREATER THAN '019'                      1004773
687066         AND WMS-SYS-TYPE LESS THAN '030')                        1004773
687067         OR (WMS-SYS-TYPE GREATER THAN '049'                      1004773
687068         AND WMS-SYS-TYPE LESS THAN '070')                        1004773
687069             ADD WMS-OD-MTD-ACR TO WBC-REG-TFR-AMT (2).           0266741
687070*---------------------------------------------------------------  1004773
687071* UPDATE THE AMOUNT OF INTEREST EXPENSE THIS QUARTER              1004773
687072*---------------------------------------------------------------  1004773
687073     ADD WMS-IOD-MTD-ACC-INT TO WBC-REG-TFR-AMT (3).              0266741
687074     IF  WMS-SAVINGS-TRLR EQUAL '1'                               1004773
687075         IF  WMS-INT-INV-IND EQUAL 'N'                            1004773
687076             ADD WMS-MTD-ACCR-INT TO WBC-REG-TFR-AMT (3)          0266741
687077         ELSE                                                     1005110
687078             IF  WMS-INVESTMENT-TRLR EQUAL '1'                    1005127
687080                 ADD WMS-INV-SVC-COLL-MTD TO WBC-REG-TFR-AMT (11) 0266741
687081                                             WBC-REG-TFR-AMT (4). 0920031
687082* UPDATE THE AMOUNT OF LATE CHARGES AND TRANS FEES THIS QUARTER   1005127
687083     IF  WMS-LOAN-TRLR EQUAL '1'                                  1004773
687084         ADD WMS-BILLED-FEES TO WBC-REG-TFR-AMT (4).              0266741
687085     ADD WMS-MTD-ACCUM-SERV-CHG TO WBC-REG-TFR-AMT (4).           0266741
687086*---------------------------------------------------------------  1004773
687087* UPDATE THE AMOUNT OF INTEREST CREDITED DURING THE QUARTER       1004773
687088* (DOES NOT INCLUDE INTEREST PAID OUT IN CASH                     1004773
687089*---------------------------------------------------------------  1004773
687090     IF  WMS-IOD-DIST-CD EQUAL '0' OR '2'                         1004773
687091         ADD WMS-IOD-MTD-PAID-INT TO WBC-REG-TFR-AMT (10).        0266741
687092     IF  WMS-SAVINGS-TRLR EQUAL '1'                               1004773
687093         IF  WMS-INT-INV-IND EQUAL 'N'                            1004773
687096         AND (WMS-SAV-DIST-CD EQUAL '0' OR '2')                   1004773
687097             ADD WMS-MTD-INT-PAID TO WBC-REG-TFR-AMT (10).        0266741
687098*---------------------------------------------------------------  1004773
687099* UPDATE THE TOTAL AMOUNTS CHARGED DEPOSITORS FOR SERVICE         1004773
687100* CHARGES THIS YEAR.                                              1004773
687101*---------------------------------------------------------------  1004773
687102     ADD WMS-MTD-ACCUM-SERV-CHG TO WBC-REG-CALL-AMT (13).         0266741
687103*---------------------------------------------------------------  1004773
687104* UPDATE THE AMOUNT OF OTHER FEES AND COMMISSIONS THIS YEAR       1004773
687105*---------------------------------------------------------------  1004773
687106     IF  WMS-LOAN-TRLR EQUAL '1'                                  1004773
687107         ADD WMS-BILLED-INS1 TO WBC-REG-CALL-AMT (14)             0266741
687108         ADD WMS-BILLED-INS2 TO WBC-REG-CALL-AMT (14).            0266741
687110 S1029-NOT-EOM.                                                   1004773
687130     IF  AFFL-ACCT-FLAG EQUAL 'N'                                 1004773
687140         ADD +1 TO AFFIL-TRLR-ACCTS, WS-GL-AFFIL-TRLR-ACCTS.      1004773
687150     IF WMS-TARGET-AMT-TRLR IS EQUAL TO '1'
687200         ADD +1 TO ZERO-BAL-TRLR-NO, WS-GL-ZERO-BAL-TRLR-NO.      0902970
687250     IF WMS-BANK-AVAIL-TRLR IS EQUAL TO '1'                       IM007
687300         ADD +1 TO BANK-AVAIL-TRLR-NO, WS-GL-BANK-AVAIL-TRLR-NO.  0902970
687350     IF  WMS-MARKET-TRLR EQUAL TO '1'                             IM003
687370     AND WMS-MARKET-DELETE NOT EQUAL TO '1'                       IM003
687450         ADD +1 TO DDA-END-MKT-NO, WS-GL-DDA-END-MKT-NO           0902970
687500         ADD WMS-CURR-BAL TO DDA-END-MKT-BAL                      0902970
687501                             WS-GL-DDA-END-MKT-BAL.               0902970
687700     IF WMS-SAVINGS-TRLR NOT EQUAL TO '1'
687750         GO TO S1030.
687800     IF WMS-INT-CUR-BAL LESS THAN WMS-INT-MTD-MIN
687850         MOVE WMS-INT-CUR-BAL TO WMS-INT-MTD-MIN.
687900     IF WMS-INT-CUR-BAL EQUAL ZERO
687950         ADD +1 TO SV-NO-ZERO-BAL, WS-GL-SV-NO-ZERO-BAL.          0902970
688000     IF WMS-INT-STATUS LESS THAN '9'
688010     AND WMS-INT-INV-IND EQUAL 'N'                                1004554
688050         ADD +1 TO SAV-END-NO-ACCTS, WS-GL-SAV-END-NO-ACCTS       0902970
688100         ADD WMS-INT-CUR-BAL TO SAV-END-BALANCE                   0902970
688101                                WS-GL-SAV-END-BALANCE.            0902970
688110     IF  TRANSFER-AMT LESS THAN ZERO                              1004554
688112         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
688114             ADD +1                  TO INV-CR-NO                 1004554
688116                                        WS-GL-INV-CR-NO           1004554
688118             SUBTRACT TRANSFER-AMT FROM INV-CR-AMT                1004554
688120                                        WS-GL-INV-CR-AMT          1004554
688122         ELSE                                                     1004554
688124             ADD +1                  TO SAV-CR-NO                 1004554
688126                                        WS-GL-SAV-CR-NO           1004554
688128             SUBTRACT TRANSFER-AMT FROM SAV-CR-AMT                1004554
688130                                        WS-GL-SAV-CR-AMT.         1004554
688150     IF TRANSFER-AMT LESS THAN ZERO
688200         ADD +1 TO DDA-GEN-TRAN-DR-NO                             1004554
688201                   WS-GL-DDA-GEN-TRAN-DR-NO                       0902970
688250         SUBTRACT TRANSFER-AMT FROM DDA-GEN-TRAN-DR-AMT           1004554
688251                                    WS-GL-DDA-GEN-TRAN-DR-AMT     1004554
688300         IF WMS-IOD-RATE-PTR GREATER THAN ZERO
688350         OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
688400             ADD +1 TO IOD-DB-NO, WS-GL-IOD-DB-NO                 0902970
688450             SUBTRACT TRANSFER-AMT FROM IOD-DB-AMT,               0902970
688451                                        WS-GL-IOD-DB-AMT          0902970
688500         ELSE
688550             ADD +1 TO DDA-DB-NO, WS-GL-DDA-DB-NO                 0902970
688600             SUBTRACT TRANSFER-AMT FROM DDA-DB-AMT,               0902970
688601                                        WS-GL-DDA-DB-AMT.         0902970
688610     IF TRANSFER-AMT GREATER THAN ZERO                            1004554
688612         IF  WMS-INVESTMENT-TRLR EQUAL '1'                        1004554
688614             ADD +1           TO INV-DR-NO                        1004554
688616                                 WS-GL-INV-DR-NO                  1004554
688618             ADD TRANSFER-AMT TO INV-DR-AMT                       1004554
688620                                 WS-GL-INV-DR-AMT                 1004554
688622         ELSE                                                     1004554
688624             ADD +1           TO SAV-DR-NO                        1004554
688626                                 WS-GL-SAV-DR-NO                  1004554
688628             ADD TRANSFER-AMT TO SAV-DR-AMT                       1004554
688630                                 WS-GL-SAV-DR-AMT.                1004554
688650     IF TRANSFER-AMT GREATER THAN ZERO
688700         ADD +1 TO DDA-GEN-TRAN-CR-NO                             1004554
688701                   WS-GL-DDA-GEN-TRAN-CR-NO                       0902970
688750         ADD TRANSFER-AMT TO DDA-GEN-TRAN-CR-AMT                  1004554
688751                             WS-GL-DDA-GEN-TRAN-CR-AMT            1004554
688800         IF WMS-IOD-RATE-PTR GREATER THAN ZERO
688850         OR  WMS-HIFI-INDICATOR GREATER THAN ZERO
688900             ADD +1 TO IOD-CR-NO, WS-GL-IOD-CR-NO                 0902970
688950             ADD TRANSFER-AMT TO IOD-CR-AMT, WS-GL-IOD-CR-AMT     0902970
689000         ELSE
689050             ADD +1 TO DDA-CR-NO, WS-GL-DDA-CR-NO                 0902970
689100             ADD TRANSFER-AMT TO DDA-CR-AMT, WS-GL-DDA-CR-AMT.    0902970
689105     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            1004554
689110         ADD WMS-MTD-ACCR-INT TO INV-DIV-ACCRD-MTD                1004554
689115                                 WS-GL-INV-DIV-ACCRD-MTD          1004554
689116         ADD WMS-YTD-ACCR-INT TO INV-DIV-ACCRD-YTD                1105132
689117                                 WS-GL-INV-INT-ACC-YTD            1105132
689120         ADD WMS-MTD-INT-PAID TO INV-DIV-PAID-MTD                 1004554
689125                                 WS-GL-INV-DIV-PAID-MTD           1004554
689130     ELSE                                                         1004554
689150         ADD WMS-MTD-ACCR-INT TO DDA-INT-ACC-MTD                  1004554
689160                                 WS-GL-DDA-INT-ACC-MTD            1004554
689170         ADD WMS-YTD-ACCR-INT TO DDA-INT-ACC-YTD                  1105132
689172                                 WS-GL-DDA-INT-ACC-YTD            1105132
689200         ADD WMS-MTD-INT-PAID TO DDA-INT-PAID-MTD                 1004554
689201                                 WS-GL-DDA-INT-PAID-MTD.          1004554
689250     IF  WMS-ACCR-INT GREATER THAN ZERO                           0902970
689258         ADD +.005, WMS-ACCR-INT GIVING HOLD-ACCR2                0902970
689266     ELSE                                                         0902970
689268         ADD -.005, WMS-ACCR-INT GIVING HOLD-ACCR2.               9915858
689270     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
689272         ADD WMS-DUAL-YR-CUR-SAV-INT TO DUAL-SV-INT-PAID-YTD      9915858
689274                                      WS-GL-DUAL-SV-INT-PAID-YTD  9915858
689276         ADD WMS-DUAL-YR-CUR-SAV-FED TO DUAL-SV-TAX-YTD-END       9915858
689278                                  WS-GL-DUAL-SV-TAX-YTD-END       2012254
689279         ADD WMS-DUAL-YR-CUR-SAV-STATE TO DUAL-SV-TAX-YTD-END-ST  2012254
689280                                  WS-GL-DUAL-SV-TX-YTD-END-ST     2012254
689281         ADD WMS-DUAL-YR-CUR-SAV-LOCAL TO DUAL-SV-TAX-YTD-END-LOC 2012254
689282                                  WS-GL-DUAL-SV-TX-YTD-END-LOC.   2012254
689283     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            2012254
689300         ADD WMS-YTD-INT-PAID TO INV-DIV-PAID-YTD-END             1004554
689305                                 WS-GL-INV-DIV-PAID-YTD-END       1004554
689310         ADD WMS-YTD-SAV-TAX  TO INV-TAX-YTD-END                  1004554
689315                                 WS-GL-INV-TAX-YTD-END            1004554
689316         ADD WMS-YTD-SAV-STATE-TAX  TO INV-TAX-YTD-END-ST         2012254
689317                                       WS-GL-INV-TAX-YTD-END-ST   2012254
689318         ADD WMS-YTD-SAV-LOCAL-TAX  TO INV-TAX-YTD-END-LOC        2012254
689319                                       WS-GL-INV-TAX-YTD-END-LOC  2012254
689320     ELSE                                                         1004554
689325         ADD HOLD-ACCR2       TO DDA-INT-ACC-CY                   1004554
689330                                 WS-GL-DDA-INT-ACC-CY             1004554
689335         ADD WMS-YTD-INT-PAID TO DDA-INT-PAID-YTD                 1004554
689340                                 WS-GL-DDA-INT-PAID-YTD           1004554
689342         ADD WMS-YTD-SAV-TAX  TO SAV-TAX-YTD-END                  2012254
689343                                 WS-GL-SAV-TAX-YTD-END            2012254
689344         ADD WMS-YTD-SAV-STATE-TAX  TO SAV-TAX-YTD-END-ST         2012254
689345                                 WS-GL-SAV-TAX-YTD-END-ST         2012254
689346         ADD WMS-YTD-SAV-LOCAL-TAX  TO SAV-TAX-YTD-END-LOC        2012254
689347                                 WS-GL-SAV-TAX-YTD-END-LOC.       2012254
689348     IF  WMS-INVESTMENT-TRLR EQUAL '1'                            0336977
689350         ADD WMS-YTD-INT-PAID-1042 TO YTD-DIV-INT-1042            0336977
689352     ELSE                                                         0336977
689354         ADD WMS-YTD-INT-PAID-1042 TO YTD-SAV-INT-1042.           0336977
689390     ADD WMS-INT-MTD-TRANNO TO MTD-DDA-INTERNAL-NO                0336977
689391                               WS-GL-MTD-DDA-INTERNAL-NO.         0336977
689400     ADD WMS-INT-MTD-TRNAMT TO MTD-DDA-INTERNAL-AMT               0902970
689401                               WS-GL-MTD-DDA-INTERNAL-AMT.        0902970
689450     ADD WMS-DDA-MAX-MTD-NO TO MTD-SAV-INTERNAL-NO                0902970
689451                               WS-GL-MTD-SAV-INTERNAL-NO.         0902970
689500     ADD WMS-DDA-MAX-MTD-AMT TO MTD-SAV-INTERNAL-AMT              0902970
689501                               WS-GL-MTD-SAV-INTERNAL-AMT.        0902970
689551     IF  WMS-INVESTMENT-TRLR EQUAL '0'                            1004554
689552         GO TO S1030.                                             1004554
689553     IF  WMS-INV-SVC-ACCRD-TDY GREATER THAN ZERO                  1004554
689554         ADD +.005 WMS-INV-SVC-ACCRD-TDY GIVING HOLD-ACCR2        1004554
689555     ELSE                                                         1002970
689556         ADD -.005 WMS-INV-SVC-ACCRD-TDY GIVING HOLD-ACCR2.       1004554
689557     ADD HOLD-ACCR2 TO INV-SVC-ACCRD-TDY                          1004554
689558                       WS-GL-INV-SVC-ACCRD-TDY.                   1004554
689560     IF  WMS-INV-SVC-ACCRD-CYC GREATER THAN ZERO                  1004554
689561         ADD +.005 WMS-INV-SVC-ACCRD-CYC GIVING HOLD-ACCR2        1004554
689562     ELSE                                                         1002970
689563         ADD -.005 WMS-INV-SVC-ACCRD-CYC GIVING HOLD-ACCR2.       1004554
689564     ADD HOLD-ACCR2 TO INV-SVC-ACCRD-CYC                          1004554
689565                       WS-GL-INV-SVC-ACCRD-CYC.                   1004554
689566     ADD WMS-INV-SVC-ACCRD-MTD TO INV-SVC-ACCRD-MTD               1004554
689567                                  WS-GL-INV-SVC-ACCRD-MTD.        1004554
689568     ADD WMS-INV-SVC-COLL-TDY  TO INV-SVC-COLL-TDY                1004554
689569                                  WS-GL-INV-SVC-COLL-TDY.         1004554
689570     ADD WMS-INV-SVC-COLL-CYC  TO INV-SVC-COLL-CYC                1004554
689571                                  WS-GL-INV-SVC-COLL-CYC.         1004554
689572     ADD WMS-INV-SVC-COLL-MTD  TO INV-SVC-COLL-MTD                1004554
689573                                  WS-GL-INV-SVC-COLL-MTD.         1004554
689574     ADD WMS-INV-SVC-COLL-YTD  TO INV-SVC-COLL-YTD                1004554
689575                                  WS-GL-INV-SVC-COLL-YTD.         1004554
689576     IF  WBC-PREV-YEAR-END EQUAL '1'                              0266741
689577         ADD WMS-INV-SVC-COLL-PYTD  TO INV-SVC-RPTD-YTD           1004554
689578                                       WS-GL-INV-SVC-RPTD-YTD     1004554
689579         ADD WMS-INV-SVC-COLL-PYTD  TO INV-SVC-RPTD-YTD           1004554
689580                                       WS-GL-INV-SVC-RPTD-YTD     1004554
689581         ADD WMS-PREV-YTD-INT       TO INV-DIV-RPTD-YTD           1004554
689582                                       WS-GL-INV-DIV-RPTD-YTD     1004554
689583         ADD WMS-PREV-YTD-SAV-TAX   TO INV-TAX-YTD-RPTD           1004554
689584                                       WS-GL-INV-TAX-YTD-RPTD     2012254
689585         ADD WMS-PREV-YTD-SAV-STATE-TAX TO INV-TAX-YTD-RPTD-ST    2012254
689586                                       WS-GL-INV-TAX-YTD-RPTD-ST  2012254
689587         ADD WMS-PREV-YTD-SAV-LOCAL-TAX TO INV-TAX-YTD-RPTD-LOC   2012254
689588                                       WS-GL-INV-TAX-YTD-RPTD-LOC.2012254
689589     ADD +1                    TO INV-END-NO                      2012254
689590                                  WS-GL-INV-END-NO.               2012254
689591     ADD WMS-INT-CUR-BAL       TO INV-END-AMT                     2012254
689592                                  WS-GL-INV-END-AMT.              2012254
689593     ADD WMS-PREV-INT-BAL      TO INV-BEG-AMT                     2012254
689594                                  WS-GL-INV-BEG-AMT.              2012254
689595     SUBTRACT WMS-PREV-INT-BAL FROM WMS-INT-CUR-BAL               2012254
689596         GIVING HOLD-AMT13.                                       2012254
689597     IF  HOLD-AMT13 POSITIVE                                      2012254
689598         ADD HOLD-AMT13 TO INV-XFER-IN-AMT                        2012254
689599                           WS-GL-INV-XFER-IN-AMT                  2012254
689600     ELSE                                                         2012254
689601         MULTIPLY -1 BY HOLD-AMT13                                2012254
689602         ADD HOLD-AMT13 TO INV-XFER-OUT-AMT                       2012254
689603                           WS-GL-INV-XFER-OUT-AMT.                2012254
689604 S1030.                                                           2012254
689650     ADD WMS-IOD-MTD-ACC-INT TO IOD-INT-ACC-MTD                   0902970
689651                                WS-GL-IOD-INT-ACC-MTD.            0902970
689652     ADD WMS-IOD-YTD-ACC-INT TO IOD-INT-ACC-YTD                   1105132
689653                                WS-GL-IOD-INT-ACC-YTD.            1105132
689700     IF  WMS-IOD-CYC-ACC-INT GREATER THAN ZERO                    0902970
689707         ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR2          0902970
689714     ELSE                                                         0902970
689721         ADD -.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR2.         0902970
689728     ADD HOLD-ACCR2 TO IOD-INT-ACC-CY                             0902970
689735                       WS-GL-IOD-INT-ACC-CY.                      0902970
689750     ADD WMS-IOD-MTD-PAID-INT TO IOD-INT-PAID-MTD                 0902970
689751                                 WS-GL-IOD-INT-PAID-MTD.          0902970
689800     ADD WMS-IOD-YTD-INT-PAID TO IOD-INT-PAID-YTD                 0902970
689801                                 WS-GL-IOD-INT-PAID-YTD.          0902970
689830     ADD WMS-IOD-YTD-INT-PAID-1042 TO YTD-IOD-INT-1042.           9915828
689832     IF  WMS-DUAL-YEAR-TRLR EQUAL '1'                             9915858
689834         ADD WMS-DUAL-YR-CUR-IOD-INT TO DUAL-IO-INT-PAID-YTD      9915858
689836                                  WS-GL-DUAL-IO-INT-PAID-YTD      9915858
689838         ADD WMS-DUAL-YR-CUR-IOD-FED TO DUAL-IO-TAX-YTD-END       9915858
689840                                  WS-GL-DUAL-IO-TAX-YTD-END       2012254
689841         ADD WMS-DUAL-YR-CUR-IOD-STATE TO DUAL-IO-TAX-YTD-END-ST  2012254
689842                                  WS-GL-DUAL-IO-TX-YTD-END-ST     2012254
689843         ADD WMS-DUAL-YR-CUR-IOD-LOCAL TO DUAL-IO-TAX-YTD-END-LOC 2012254
689844                                  WS-GL-DUAL-IO-TX-YTD-END-LOC.   2012254
689845     ADD WMS-IOD-YTD-TAX TO IOD-TAX-YTD-END                       2012254
689846                            WS-GL-IOD-TAX-YTD-END.                2012254
689847     ADD WMS-IOD-YTD-STATE-TAX TO IOD-TAX-YTD-END-ST              2012254
689848                            WS-GL-IOD-TAX-YTD-END-ST.             2012254
689849     ADD WMS-IOD-YTD-LOCAL-TAX TO IOD-TAX-YTD-END-LOC             2012254
689850                            WS-GL-IOD-TAX-YTD-END-LOC.            2012254
689900     ADD WMS-BANK-AVAIL-AMT TO DDA-END-BANK-AVAIL                 0902970
689901                               WS-GL-DDA-END-BANK-AVAIL.          0902970
689910     ADD WMS-CASH-AVAIL-AMT TO DDA-END-CASH-AVAIL                 0902970
689911                               WS-GL-DDA-END-CASH-AVAIL.          0902970
689950     MOVE ZERO TO TRANSFER-AMT.
690000     ADD WMS-MTD-TRN-NO TO MTD-DDA-EXTERNAL-NO                    0902970
690001                           WS-GL-MTD-DDA-EXTERNAL-NO.             0902970
690050     ADD WMS-MTD-TRAN-AMT TO MTD-DDA-EXTERNAL-AMT,                0902970
690051                             WS-GL-MTD-DDA-EXTERNAL-AMT.          0902970
690100     IF WMS-SAV-PTR GREATER THAN ZERO
690150         ADD +1 TO PLANA-ACCTS, WS-GL-PLANA-ACCTS.                0902970
690200     ADD WMS-CUST-AVAIL-AMT TO DDA-END-CUST-AVAIL                 0902970
690201                               WS-GL-DDA-END-CUST-AVAIL.          0902970
690250     IF POST-TODAY EQUAL TO '1'
690300         ADD +1 TO DDA-NO-ACTIVE, WS-GL-DDA-NO-ACTIVE.            0902970
690350     IF WMS-MTD-ANALYSIS NOT EQUAL TO '0' AND '8'                 1105504
690400         ADD +1 TO DDA-ANALYSIS-NO, WS-GL-DDA-ANALYSIS-NO.        0902970
690450     MOVE '1' TO DDA-FORMAT (WMS-STMT-FORMAT).
690452*--------------------------------------------------------------*  2016639
690454*    ADD TO EXTERNAL INVESTMENT ENDING TOTALS                  *  2016639
690456*--------------------------------------------------------------*  2016639
690458     IF  WMS-XINV-LINK-IND        EQUAL 'L' OR 'P'                2016639
690460         IF  WMS-XINV-PROCESS-IND EQUAL '1'                       2016639
690462             ADD +1               TO  T3-XINV-SD-END-NO           2016639
690464                                      WS-GL-XINV-SD-END-NO        2016639
690466             ADD WMS-XINV-BALANCE TO  T3-XINV-SD-END-AMT          2016639
690468                                      WS-GL-XINV-SD-END-AMT       2016639
690470         ELSE                                                     2016639
690472         IF  WMS-XINV-PROCESS-IND EQUAL '2'                       2016639
690474             ADD +1               TO  T3-XINV-ND-END-NO           2016639
690476                                      WS-GL-XINV-ND-END-NO        2016639
690478             ADD WMS-XINV-BALANCE TO  T3-XINV-ND-END-AMT          2016639
690480                                      WS-GL-XINV-ND-END-AMT.      2016639
690482*                                                                 2016639
690500     IF WMS-STATUS EQUAL TO '00', GO TO S1500.
690550     IF WMS-STATUS EQUAL TO '04'
690600         ADD +1 TO DDA-END-CLOSED, WS-GL-DDA-END-CLOSED           0902970
690650         IF STATUS-IN NOT EQUAL TO '04'
690700             ADD +1 TO DDA-CLSD-ACCTS, WS-GL-DDA-CLSD-ACCTS.      0902970
690750     IF WMS-STATUS EQUAL TO '06'
690800         ADD +1 TO DDA-END-DORM-NO, WS-GL-DDA-END-DORM-NO         0902970
690850         ADD WMS-CURR-BAL TO DDA-END-DORM-BAL
690851                             WS-GL-DDA-END-DORM-BAL               0902970
690900         GO TO S1500.
690950     IF WMS-STATUS EQUAL TO '07'
691000         ADD +1 TO DDA-END-INACT-NO, WS-GL-DDA-END-INACT-NO       0902970
691050         ADD WMS-CURR-BAL TO DDA-END-INACT-BAL
691051                             WS-GL-DDA-END-INACT-BAL              0902970
691100         GO TO S1500.
691150 S1040.
691200     IF WMS-STATUS EQUAL TO '08'
691250         ADD +1 TO DDA-END-TERMIN, WS-GL-DDA-END-TERMIN           0902970
691300         IF STATUS-IN NOT EQUAL TO '08'
691350             ADD +1 TO DDA-TERM-ACCTS, WS-GL-DDA-TERM-ACCTS.      0902970
691400 S1500.
691402     IF  WMS-PLAN-TRLR EQUAL '0'                                  0617360
691406         GO TO S1501.                                             0617360
691408     ADD +1           TO T3-PLAN-END-NO                           0617360
691410                         WS-GL-PLAN-END-NO.                       0617360
691412     ADD WMS-CURR-BAL TO T3-PLAN-END-AMT                          0617360
691414                         WS-GL-PLAN-END-AMT.                      0617360
691416     ADD +.005 WMS-IOD-CYC-ACC-INT GIVING HOLD-ACCR1.             0617360
691420     ADD HOLD-ACCR1           TO T3-PLAN-END-ACC                  0617360
691422                                 WS-GL-PLAN-END-ACC.              0617360
691424     ADD WMS-IOD-YTD-TAX      TO T3-PLAN-END-YTD-TAX              0617360
691426                                 WS-GL-PLAN-END-YTD-TAX.          0617360
691428     ADD WMS-IOD-MTD-ACC-INT  TO T3-PLAN-MTD-ACC                  0617360
691430                                 WS-GL-PLAN-MTD-ACC.              0617360
691432     ADD WMS-IOD-MTD-PAID-INT TO T3-PLAN-MTD-PAID                 0617360
691434                                 WS-GL-PLAN-MTD-PAID.             0617360
691436     ADD WMS-IOD-YTD-ACC-INT  TO T3-PLAN-YTD-ACC                  0617360
691438                                 WS-GL-PLAN-YTD-ACC.              0617360
691440     ADD WMS-IOD-YTD-INT-PAID TO T3-PLAN-YTD-PAID                 0617360
691442                                 WS-GL-PLAN-YTD-PAID.             0617360
691444     PERFORM PL-RECERT-CKUP THRU PL-RECERT-EXIT.                  0827778
691472 S1501.                                                           0617360
691490     IF  WMS-LOAN-TRLR EQUAL '0'                                  0617360
691500         GO TO S1550-WITHHOLD-PROJ.
691550     SKIP3
691600 LOAN-SECTION-D      SECTION 26.
691650     SKIP3
691700 S1510.
691750     IF WMS-LOAN-BAD-ACCT EQUAL TO '1'
691800         MOVE '2' TO WMS-LOAN-BAD-ACCT.
691850     IF LOAN-POST-TODAY EQUAL TO '1'
691900         ADD +1 TO LOAN-NO-ACTIVE, WS-GL-LOAN-NO-ACTIVE.          0902970
691950     ADD +1 TO LOAN-END-NO-ACCTS, WS-GL-LOAN-END-NO-ACCTS.        0902970
692100     ADD WMS-PRIN-BAL
692150         WMS-INTRST-BAL
692200         WMS-OTHER-CHGS
692250         WMS-LOAN-ACCR-INT GIVING HOLD-AMT13.
692300     IF HOLD-AMT13 EQUAL ZERO
692350         ADD +1 TO LOAN-NO-ZERO-BAL, WS-GL-LOAN-NO-ZERO-BAL.      0902970
692400     ADD WMS-PRIN-BAL TO LOAN-END-PRIN, WS-GL-LOAN-END-PRIN.      0902970
692450     ADD WMS-INTRST-BAL TO LOAN-END-INTRST, WS-GL-LOAN-END-INTRST.0902970
692500     ADD WMS-OTHER-CHGS TO LOAN-END-OTHER, WS-GL-LOAN-END-OTHER.  0902970
692550     ADD WMS-INS1       TO LOAN-END-INS1, WS-GL-LOAN-END-INS1.    0902970
692600     ADD WMS-INS2       TO LOAN-END-INS2, WS-GL-LOAN-END-INS2.    0902970
692650     ADD WMS-FEES       TO LOAN-END-FEES, WS-GL-LOAN-END-FEES.    0902970
692700     ADD WMS-CURR-BAL TO LOAN-END-DDA-BAL, WS-GL-LOAN-END-DDA-BAL.0902970
692750     ADD +.005, WMS-LOAN-ACCR-INT GIVING WK-HOLD-AMT13.           9915845
692800     ADD WK-HOLD-AMT13 TO LOAN-END-ACC-INT                        9915845
692801                          WS-GL-LOAN-END-ACC-INT.                 0902970
692850     ADD WMS-LOAN-YTD-INT TO LOAN-END-YTD-PAID                    0902970
692851                             WS-GL-LOAN-END-YTD-PAID.             0902970
692900     ADD WMS-LOAN-YTD-INS1 TO LOAN-YTD-INS1                       0902970
692901                              WS-GL-LOAN-YTD-INS1.                0902970
692950     ADD WMS-LOAN-YTD-INS2 TO LOAN-YTD-INS2                       0902970
692951                              WS-GL-LOAN-YTD-INS2.                0902970
693000     ADD WMS-LOAN-YTD-FEES TO LOAN-YTD-FEES, WS-GL-LOAN-YTD-FEES. 0902970
693050     ADD WMS-BILLED-FEES TO LOAN-MTD-FEES-BILL                    0902970
693051                            WS-GL-LOAN-MTD-FEES-BILL.             0902970
693060     ADD WMS-EARNED-INT TO LOAN-END-MTD-ERND                      0902970
693061                           WS-GL-LOAN-END-MTD-ERND.               0902970
693062     ADD WMS-LOAN-YTD-ACC-INT TO LOAN-END-YTD-ERND                1105132
693063                                 WS-GL-LOAN-END-YTD-ERND.         1105132
693070     ADD WMS-COLLECT-INT TO LOAN-END-MTD-COLL                     0902970
693071                            WS-GL-LOAN-END-MTD-COLL.              0902970
693080     IF  WMS-LOAN-STATUS EQUAL '3' OR '4'                         IM005
693090         GO  TO  S1550-WITHHOLD-PROJ.                             IM005
693100     ADD LOAN-LIM TO LOAN-END-APPR-CR, WS-GL-LOAN-END-APPR-CR.    0902970
693150     IF HOLD-AMT9 LESS THAN +0
693200         ADD +1 TO LOAN-END-OVR-NO, WS-GL-LOAN-END-OVR-NO         0902970
693250         SUBTRACT HOLD-AMT9 FROM LOAN-END-OVR-AMT                 0902970
693251         SUBTRACT HOLD-AMT9 FROM WS-GL-LOAN-END-OVR-AMT.          0902970
693300     ADD WMS-AVAIL-BAL TO LOAN-END-AVAL-CR,                       0902970
693301                          WS-GL-LOAN-END-AVAL-CR.                 0902970
693450     IF  WMS-PAST-DUE NOT EQUAL ZERO                              1002953
693500         ADD +1 TO LOAN-END-PD-NO, WS-GL-LOAN-END-PD-NO           0902970
693550         ADD WMS-PAST-DUE-AMT TO LOAN-END-PD-AMT                  0902970
693551         ADD WMS-PAST-DUE-AMT TO WS-GL-LOAN-END-PD-AMT.           0902970
693600     IF WMS-INT-RATE-PTR EQUAL +6 OR +7
693650         ADD +1 TO LOAN-PRIME-NO, WS-GL-LOAN-PRIME-NO             0902970
693700         ADD WMS-PRIN-BAL TO LOAN-PRIME-AMT, WS-GL-LOAN-PRIME-AMT.0902970
693750     SKIP3
693800 ROOT-SECTION-K      SECTION 1.
693850     SKIP3
693900 S1550-WITHHOLD-PROJ.
693950     MOVE ZEROES TO SAVE-IOD-TAX SAVE-IOD-TAX-ST SAVE-IOD-TAX-LOC 0266630
694000                    SAVE-SAV-TAX SAVE-SAV-TAX-ST SAVE-SAV-TAX-LOC.0266630
694050     IF  WMS-STATUS EQUAL '08' OR '05'
694100     OR (SAV-BKUP-WTHLD-FLAG EQUAL ZERO                           2012254
694120         AND  WMS-STATE-LOCAL-TX-CD EQUAL ZERO)                   2012254
694150         GO TO S2000.
694200     IF  WMS-IOD-PROJ-ACCR NOT GREATER THAN +0
694250         GO TO S1570.
694300 S1555.
694350     MOVE 'N'                 TO IOD-FLAG.
694400     MOVE '1'                 TO TAX-CALC-REASON.
694450     MOVE IOD-FLAG            TO TAX-CALC-IOD-FLAG.
694500     MOVE WMS-IOD-PROJ-ACCR   TO ACCRUAL-AMOUNT.
694550     IF  ACCRUAL-AMOUNT GREATER THAN +0
694600         ADD +.005 TO ACCRUAL-AMOUNT
694650     ELSE
694700         ADD -.005 TO ACCRUAL-AMOUNT.
694750     MOVE ACCRUAL-AMOUNT TO TAX-CALC-PAYMENT.
694800     MOVE WBC-NEXT-CAPTURE-DATE TO DT-HIGH-DATE.                  0266741
694850     PERFORM S1578-CALC-TAX-DAYS THRU S1579-EXIT.
694900     IF  TAX-CALC-DAYS GREATER THAN ZERO
694950         SUBTRACT +1 FROM TAX-CALC-DAYS.
695000     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.
695050     MOVE TAX-CALC-AMOUNT TO SAVE-IOD-TAX.
695060     MOVE TAX-CALC-AMOUNT-ST  TO SAVE-IOD-TAX-ST.                 2012254
695065     MOVE TAX-CALC-AMOUNT-LOC TO SAVE-IOD-TAX-LOC.                2012254
695070     ADD  WMS-IOD-PEND-TAX TO SAVE-IOD-TAX.                       IM007
695100     MOVE 'F' TO IOD-FLAG.
695150 S1555-EXIT. EXIT.
695200 S1570.
695250     IF  WMS-SAVINGS-TRLR EQUAL '0'
695300         GO  TO  S2000.
695350     IF  WMS-INT-STATUS NOT GREATER THAN '6'
695400         GO  TO  S1575.
695450     IF  WMS-PROJ-ACCR NOT GREATER THAN +0
695500         GO  TO  S2000.
695550 S1575.
695600     MOVE '1'           TO TAX-CALC-REASON.
695650     MOVE IOD-FLAG      TO TAX-CALC-IOD-FLAG.
695700     MOVE WMS-PROJ-ACCR TO ACCRUAL-AMOUNT.
695750     IF  ACCRUAL-AMOUNT GREATER THAN +0
695800         ADD +.005 TO ACCRUAL-AMOUNT
695850     ELSE
695900         ADD -.005 TO ACCRUAL-AMOUNT.
695950     MOVE ACCRUAL-AMOUNT TO TAX-CALC-PAYMENT.
696000     MOVE WBC-NEXT-CAPTURE-DATE TO DT-HIGH-DATE.                  0266741
696050     PERFORM S1578-CALC-TAX-DAYS THRU S1579-EXIT.
696100     IF  TAX-CALC-DAYS GREATER THAN ZERO
696150         SUBTRACT +1 FROM TAX-CALC-DAYS.
696200     PERFORM R3870-CALL-WITHHOLD THRU R3870-EXIT.
696250     MOVE TAX-CALC-AMOUNT TO SAVE-SAV-TAX.
696260     MOVE TAX-CALC-AMOUNT-ST  TO SAVE-SAV-TAX-ST.                 2012254
696265     MOVE TAX-CALC-AMOUNT-LOC TO SAVE-SAV-TAX-LOC.                2012254
696270     ADD  WMS-SAV-PEND-TAX TO SAVE-SAV-TAX.                       IM007
696300     GO TO S2000.
696350 S1575-EXIT. EXIT.
696400     SKIP3
696450 S1578-CALC-TAX-DAYS.
696452     IF  WMS-SAV-INT-PAY-CYCLE EQUAL 'B' OR 'C' OR 'E'            9915845
696454                                 OR    'L' OR 'W'                 9915845
696456         IF  WMS-SAV-INT-DATE-LAST-PMT EQUAL SPACES OR ZEROES     9915845
696458             MOVE WMS-DATE-OPENED TO DT-LOW-DATE                  9915845
696460             PERFORM S1579                                        9915845
696462             ADD +1 TO TAX-CALC-DAYS                              9915845
696464             GO  TO  S1579-EXIT                                   9915845
696466         ELSE                                                     9915845
696468             MOVE WMS-SAV-INT-DATE-LAST-PMT TO DT-LOW-DATE        9915851
696470             PERFORM S1579                                        9915845
696472             GO  TO  S1579-EXIT.                                  9915845
696474                                                                  9915845
696500     IF  IOD-FLAG EQUAL 'N' AND
696550         (WMS-IOD-INT-PAY-CYCLE EQUAL '2' OR '4')                 9915845
696600     OR  IOD-FLAG EQUAL 'F' AND
696650         (WMS-SAV-INT-PAY-CYCLE EQUAL '2' OR '3')                 9915845
696700         GO  TO  S1578-A.
696750     IF  WMS-DATE-LAST-SERV-CHG EQUAL SPACES OR ZEROES
696800         MOVE WMS-DATE-OPENED TO DT-LOW-DATE
696850         PERFORM S1579
696900         ADD +1 TO TAX-CALC-DAYS
696950         GO  TO  S1579-EXIT
697000     ELSE
697050         MOVE WMS-DATE-LAST-SERV-CHG TO DT-LOW-DATE
697100         GO TO S1579.
697150 S1578-A.
697200     IF  STMT-TODAY EQUAL '1'
697250         MOVE WBC-CAPTURE-DATE TO DT-LOW-DATE                     0266741
697300         PERFORM S1579
697350         GO  TO  S1579-EXIT
697400     ELSE
697450         IF  WMS-DATE-LAST-STMT EQUAL SPACES OR ZEROES
697500             MOVE WMS-DATE-OPENED TO DT-LOW-DATE
697550             PERFORM S1579
697600             ADD +1 TO TAX-CALC-DAYS
697650             GO  TO  S1579-EXIT
697700         ELSE
697750             MOVE WMS-DATE-LAST-STMT TO DT-LOW-DATE.
697800 S1579.
697850     CALL 'SIDIF1' USING DATE-AREA.
697900     MOVE RET-DAYS TO TAX-CALC-DAYS.
697950 S1579-EXIT. EXIT.
698000     SKIP3
698050 S2000.
698052     IF  RW-SW EQUAL 'Y'                                          0817741
698054         CALL 'IM31RWEX' USING MASTER-AREA                        0817741
698056                               DDA-WRKBCR-1                       0817741
698058                               DDA-WRKBCR-2                       0817741
698060                               EXCEPTION-AREA                     0817741
698062                               EXCEPTION-LENGTH-TABLE             0817741
698064                               EX-SEQ-CTR                         0817741
698066                               EX-MST-CTL.                        0817741
698068                                                                  0817741
698100 CALL-TRIAL-BAL.
698110     MOVE ZEROES                 TO WS-TODAYS-COLL-BAL.           9916180
698120*                                                                 9916180
698150     CALL 'SILINK' USING    TRIAL-PHASE
698200                            SIWS-STANDARD-HEADING
698250                            WS-SPOOL-AREA
698300                            TRIAL-CONTROL
698350                            DDA-WRKBCR-1                          0266741
698400                            DDA-WRKBCR-4                          0266741
698450                            MASTER-AREA
698500                            TRAN-0
698520                            CONTROL-CODE                          0902575
698550                            EXCEPTION-AREA
698600                            SAVE-WITHHOLD-TAXES
698650                            EX-SEQ-CTR
698700                            IM31-TOTALS
698750                            TODAYS-REPORT-TABLE                   1105504
698752                            PRODUCT-FILE-TABLE                    1105504
698754                            DDA-BALANCE-IN                        1105504
698756                            WS-TODAYS-COLL-BAL.                   1105504
698760     MOVE WS-TODAYS-COLL-BAL TO WMS-NB-TODAYS-COLL-BAL.           9915749
698800     MOVE '0' TO TRIAL-TRANS.
698850 CALL-TRIAL-END.   EXIT.
698900 S2010.
698950     IF TRIAL-CODE EQUAL TO '0'
699000         GO TO S2500.
699050     IF UNPOST-TODAY EQUAL TO '1'
699100         AND WBC-EXC-CODE (11) EQUAL TO '1'                       0266741
699150         MOVE '08' TO IMEX-REC-NO
699200         MOVE '11' TO IMEX-CODE-1
699250         MOVE TR-SPEC-INSTR TO EX08-SPEC-INSTR
699300         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.
699350 S2020.
699400     PERFORM Q4600 THRU Q0080.                                    0447268
699450     IF TRN-CONTROL EQUAL TO LOW-CONTROL
699500         IF WBC-TRIAL-SPEC-INST EQUAL TO '1'                      0266741
699550             MOVE '2' TO TRIAL-CODE
699600             GO TO CALL-TRIAL-BAL
699610         ELSE                                                     9915845
699615             GO  TO  S2020.                                       9915845
699620 S2500.                                                           9915845
699622     IF  IBT-96-FLAG NOT EQUAL '1'                                9915845
699624     OR  WMS-EXC-CODE EQUAL '0'                                   9915845
699626         GO  TO  WRITE-DDA-MASTER.                                9915845
699627     PERFORM X1000-WRITE-IBT-SEG THRU X1000-EXIT.                 9915845
699628     MOVE WMS-STATUS TO EX03-IBT-OLD-DDA-STATUS.                  9915845
699630     MOVE '01' TO WMS-STATUS.                                     9915845
699632     MOVE '03' TO IMEX-REC-NO.                                    9915845
699634     MOVE 'IB' TO IMEX-CODE-1.                                    9915845
699636     MOVE 'IK' TO IMEX-CODE-2.                                    9915845
699638     MOVE SPACES TO EX03-IBT-OLD-LOAN-STATUS                      9915845
699640                    EX03-IBT-OLD-SAV-STATUS                       9915845
699642                    EX03-IBT-OLD-OD-STATUS.                       9915845
699644     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915845
699646         MOVE WMS-LOAN-STATUS TO EX03-IBT-OLD-LOAN-STATUS.        9915845
699648     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9915845
699650         MOVE WMS-INT-STATUS  TO EX03-IBT-OLD-SAV-STATUS.         9915845
699652     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            9915845
699654         MOVE WMS-OD-STATUS   TO EX03-IBT-OLD-OD-STATUS.          9915845
699655     MOVE SAVE-IBT-STMT-REQ TO EX03-CODE.                         9915845
699656     PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                     9915845
699658     IF  WK-IM-STATUS-IN NOT EQUAL WMS-STATUS                     9915845
699660         MOVE '09' TO IMEX-REC-NO                                 9915845
699662         MOVE 'SU' TO IMEX-CODE-1                                 9915845
699664         MOVE 'SD' TO IMEX-CODE-2                                 9915845
699666         MOVE WK-IM-STATUS-IN TO EX09-STATUS-IN                   9915845
699668         MOVE '01' TO WK-IM-STATUS-IN, EX09-STATUS-OUT            9915845
699670         MOVE WMS-CURR-BAL TO EX09-CUR-BAL                        9915845
699672         PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.                 9915845
699674     IF  WMS-LOAN-TRLR EQUAL '1'                                  9915845
699676         MOVE '2' TO WMS-LOAN-STATUS                              9915845
699678         IF  WK-LN-STATUS-IN NOT EQUAL WMS-LOAN-STATUS            9915845
699680             MOVE '09' TO IMEX-REC-NO                             9915845
699682             MOVE 'SU' TO IMEX-CODE-1                             9915845
699684             MOVE 'SL' TO IMEX-CODE-2                             9915845
699686             MOVE WK-LN-STATUS-IN TO EX09-STATUS-IN               9915845
699688             MOVE '2' TO WK-LN-STATUS-IN, EX09-STATUS-OUT         9915845
699690             MOVE WMS-PAYOFF-AMT TO EX09-CUR-BAL                  9915845
699692             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             9915845
699694     IF  WMS-SAVINGS-TRLR EQUAL '1'                               9915845
699696         MOVE '3'  TO WMS-INT-STATUS                              9915845
699698         IF  WK-SV-STATUS-IN NOT EQUAL WMS-INT-STATUS             9915845
699700             MOVE '09' TO IMEX-REC-NO                             9915845
699702             MOVE 'SU' TO IMEX-CODE-1                             9915845
699704             MOVE 'SS' TO IMEX-CODE-2                             9915845
699706             MOVE WK-SV-STATUS-IN TO EX09-STATUS-IN               9915845
699708             MOVE '3' TO WK-SV-STATUS-IN, EX09-STATUS-OUT         9915845
699710             MOVE WMS-INT-CUR-BAL TO EX09-CUR-BAL                 9915845
699712             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             9915845
699714     IF  WMS-OD-ACCRUAL-TRLR EQUAL '1'                            9915845
699716*        MOVE '1'  TO WMS-OD-STATUS                               IMODTRAI
699718         IF  WK-OD-STATUS-IN NOT EQUAL WMS-OD-STATUS              9915845
699720             MOVE '09' TO IMEX-REC-NO                             9915845
699722             MOVE 'SU' TO IMEX-CODE-1                             9915845
699724             MOVE 'SA' TO IMEX-CODE-2                             9915845
699726             MOVE WK-OD-STATUS-IN TO EX09-STATUS-IN               9915845
699728             MOVE '1' TO WK-OD-STATUS-IN, EX09-STATUS-OUT         9915845
699730             MOVE ZERO TO EX09-CUR-BAL                            9915845
699732             PERFORM WRITE-EX-MST THRU WRITE-EX-EXIT.             9915845
699750 WRITE-DDA-MASTER.                                                9915855
699751     COPY IM31FFWR.                                               0927817
699752     COPY IM31BHWR.                                               9915855
699754     IF  IBT-96-FLAG EQUAL '1'                                    9915855
699756     AND WS-OD-LIMIT-MATCH-SW EQUAL '1'                           9915855
699758         MOVE OD-LIMIT-KEY        TO  WS-SAVE-OD-LIMIT-KEY        9915855
699760         MOVE WMS-IBT-OLD-NEW-ACCOUNT TO HOLD-WK-ACCT-20          9915855
699762         MOVE WMS-CONTROL-1       TO  HOLD-WK-CTL1                9915855
699764         MOVE HOLD-WORK-ACCOUNT   TO  OD-LIMIT-KEY                9915855
699766         MOVE 'O'                 TO  I-O-CONTROL-ACCESS          9915855
699768         MOVE 'L'                 TO  I-O-CONTROL-OPERATOR        9915855
699770         CALL 'IMIBTTS'        USING  I-O-CONTROL-AREA            9915855
699772                                      OD-LIMIT-REC                9915855
699774         MOVE WS-SAVE-OD-LIMIT-KEY TO OD-LIMIT-KEY.               9915855
699776     IF  WS-OD-LIMIT-MATCH-SW EQUAL '1'                           9915855
699778         IF WBC-PROCESS-FLAG EQUAL TO '0' OR '2'                  0266741
699780             PERFORM C2472-WRITE-OD-FILE  THRU C2472-EXIT.        9915855
699802* --  UPDATE THE MEMO POSTING FILE WHEN THE                       IM004
699804* --  APPLICATION ENVIRONMENT IS VSAM AND THEY HAVE ON-LINE       IM004
699806* --  AND IT IS NOT AN HEADER RECORD.                             IM004
699808     SKIP1                                                        IM004
699809     IF  EX-MST-CTL EQUAL '1'                                     9915845
699810     AND WMS-EXC-CODE NOT EQUAL '0'                               9915845
699811     AND (SI-88-ENVIRONMENT-SEQ OR                                IM008
699812          SI-88-ENVIRONMENT-EXCM)                                 IM008
699813         MOVE '0' TO SAVE-MASTER-FLAG                             IM008
699814         PERFORM S3100 THRU S3199-EXIT.                           IM008
699815     IF  MASTER-GROUPING-SW EQUAL 'N'                             1003624
699816         GO TO S2525-GRP-CNTLS-END.                               1003624
699817     IF  WMS-EXC-CODE NOT EQUAL '0'                               1003624
699818         GO TO S2525-GRP-DETAIL.                                  1003624
699819******************************************************************1003624
699820*  WRITE HEADER RECORDS TO EACH ONLINE GROUP FOR THIS SEGMENT     1003624
699821*  THAT THE SSR SPECIFIES USES THE HEADER RECORD CONTROLS         1003624
699822******************************************************************1003624
699823     MOVE WMS-CONTROL-KEY TO WK-CONTROL-KEY.                      1003624
699824     MOVE WK-CNTLS        TO SIWSLK-ARGUMENT-CNTLS.               1003624
699825     MOVE SV-SEGMENT-NO   TO SIWSLK-ARGUMENT-SEGNO.               1003624
699844     MOVE '1'             TO SIWSLK-ACTION-FLAG-1.                1003624
699845     MOVE '5'             TO SIWSLK-ACTION-FLAG-2.                1003624
699846     IF  WBC-CTL2-FLAG EQUAL '2'                                  0266741
699847         MOVE '6'         TO SIWSLK-ACTION-FLAG-2.                1003624
699848     IF  WBC-CTL3-FLAG EQUAL '2'                                  0266741
699849         MOVE '7'         TO SIWSLK-ACTION-FLAG-2.                1003624
699850     CALL 'SISSLKP' USING SIWSLK-ACTION-PARAMETERS                1003624
699851                          SIWSBL-TABLE-AREA                       1003624
699852                          SIWSLK-RETURN-ENTRY.                    1003624
699853     IF  SIWSLK-LKP-RETURN-CODE EQUAL '0' OR '1'                  1003624
699854         NEXT SENTENCE                                            1003624
699855     ELSE                                                         1003624
699856         MOVE 0501                   TO SIMESS-MESS-NO            1003624
699857         MOVE SIWSLK-LKP-RETURN-CODE TO SIMESS-M11-CODE           1003624
699858         SET  SIMESS-OPTIONAL-INDX   TO 11                        1003624
699859         MOVE SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)               1003624
699860                                     TO SIMESS-OPTIONAL-MESSAGE   1003624
699861         CALL 'SIMESS' USING SIMESS-AREA.                         1003624
699862     GO TO S2525-GRP-CNTLS-END.                                   1003624
699863 S2525-GRP-DETAIL.                                                1003624
699864     MOVE WMS-CONTROL-KEY TO WK-CONTROL-KEY.                      1003624
699865     IF  WK-CNTLS EQUAL HOLD-MST-CONTROLS                         1003624
699866         GO TO S2525-GRP-CNTLS-END.                               1003624
699867     MOVE WK-CNTLS TO HOLD-MST-CONTROLS                           1003624
699868                      SIWSLK-ARGUMENT-CNTLS.                      1003624
699869     MOVE '1'             TO SIWSLK-ACTION-FLAG-1.                1003624
699870     MOVE '0'             TO SIWSLK-ACTION-FLAG-2.                1003624
699871     CALL 'SISSLKP' USING SIWSLK-ACTION-PARAMETERS                1003624
699872                          SIWSBL-TABLE-AREA                       1003624
699873                          SIWSLK-RETURN-ENTRY.                    1003624
699874     IF  SIWSLK-LKP-RETURN-CODE EQUAL '0' OR '1'                  1003624
699875         NEXT SENTENCE                                            1003624
699876     ELSE                                                         1003624
699877         MOVE 0501                   TO SIMESS-MESS-NO            1003624
699878         MOVE SIWSLK-LKP-RETURN-CODE TO SIMESS-M11-CODE           1003624
699879         SET  SIMESS-OPTIONAL-INDX   TO 11                        1003624
699880         MOVE SIMESS-MESSAGE (SIMESS-OPTIONAL-INDX)               1003624
699881                                     TO SIMESS-OPTIONAL-MESSAGE   1003624
699882         CALL 'SIMESS' USING SIMESS-AREA.                         1003624
699883     MOVE SIWSLK-RET-MSTR-GROUP-NO TO SV-MASTER-GROUP-NO.         1003624
699884 S2525-GRP-CNTLS-END.                                             1003624
699885     IF  SI-88-ENVIRONMENT-ONLINE AND WMS-EXC-CODE NOT EQUAL '0'  1003624
699886         PERFORM WRITE-MEMO-UPDATE THRU WRITE-MEMO-EXIT           1003624
699887         PERFORM S3050-WRITE-MEMO-RECORD                          1003624
699888            THRU S3050-EXIT                                       1003624
699889     ELSE                                                         1003624
699890     IF  SI-88-ENVIRONMENT-ONLINE AND WMS-EXC-CODE IS EQUAL TO '0'1003624
699891*    **HEADER RECORD**                                            1003624
699892         PERFORM S3050-WRITE-MEMO-RECORD                          1003624
699893            THRU S3050-EXIT.                                      1003624
699894     SKIP1                                                        1003624
699895     IF  (NEW-BK-NO-TRN-FLAG EQUAL '1' AND WMS-EXC-CODE EQUAL '0')1003624
699900         OR SKIP-READ-SW EQUAL '1'
699950         IF WMS-EXC-CODE NOT EQUAL '0' AND
700000           SI-88-ENVIRONMENT-ONLINE AND NOT IM-MEMO-OL-NEW-ACCT
700050             MOVE 'A' TO I-O-CONTROL-OPERATOR
700100             CALL 'IMALPHA' USING I-O-CONTROL-AREA
700120                                  SI-ENVIRONMENT-AREA             IM003
700150                                  MASTER-AREA
700170                                  WBC-ONLINE-ALPHA-RECORD         0266741
700200             MOVE 'A' TO I-O-CONTROL-OPERATOR
700250         ELSE
700300             MOVE 'A' TO I-O-CONTROL-OPERATOR
700350     ELSE
700355         MOVE 'W' TO I-O-CONTROL-OPERATOR.                        1003625
700389*                                                                 1003625
700390*RECALC THE DAILY FACTORS WHEN GOING INTO OR OUT OF A LEAP YEAR.  1003625
700391*                                                                 1003625
700392     IF  WMS-EXC-CODE EQUAL '1'                                   1003625
700393         IF  YEAR-CHANGE EQUAL '1'                                1003625
700394             PERFORM YEAR-CHANGE-RATE-CHANGE                      1003625
700396                THRU YEAR-CHANGE-RATE-CHANGE-EXIT                 9915949
700398             MOVE WMS-RATE-TRAILER TO SAVE-RATE-TRAILER.          9915949
700401     IF  MASTER-GROUPING-SW EQUAL 'N'                             1003624
700402         GO TO WRITE-GROUP-OL-DDA-END.                            1003624
700403*                                                                 1003624
700404*  WRITE HEADER RECORDS TO EACH ONLINE GROUP THAT THE             1003624
700405*  SSR SPECIFIES USES THE HEADER RECORD CONTROLS.                 1003624
700406*                                                                 1003624
700407     IF  WMS-EXC-CODE NOT EQUAL '0'                               1003624
700408         GO TO S2525-WRITE-GROUP-OL-DDA.                          1003624
700409*                                                                 1003624
700410     MOVE 'W'       TO I-O-CONTROL-OPERATOR.                      1003624
700411     CALL 'IMACTS'  USING I-O-CONTROL-AREA                        1003624
700412                          MASTER-AREA                             1003624
700413                          SI-ENVIRONMENT-AREA                     1003624
700414                          I-O-BASE                                1003624
700415                          SIWSLK-STACK-TABLE.                     1003624
700416     MOVE SPACES    TO HOLD-MST-CONTROLS.                         1003624
700417     GO TO WRITE-DDA-END.                                         1003624
700418*                                                                 1003624
700419 S2525-WRITE-GROUP-OL-DDA.                                        1003624
700420     MOVE SV-MASTER-GROUP-NO TO I-O-BASE-SEG-NO.                  1003624
700421     CALL 'IMACTS' USING I-O-CONTROL-AREA                         1003624
700422                         MASTER-AREA                              1003624
700423                         SI-ENVIRONMENT-AREA                      1003624
700424                         I-O-BASE                                 1003624
700425                         SV-MASTER-GROUPS.                        1003624
700426 S2525-WRITE-GROUP-DDA-EXIT.  EXIT.                               1003624
700427 S2525-WRITE-GROUP-END.                                           1003624
700428     GO TO WRITE-DDA-END.                                         1003624
700429 WRITE-GROUP-OL-DDA-END.                                          1003624
700450     CALL  'IMACTM' USING I-O-CONTROL-AREA
700500                          MASTER-AREA
700550                          SI-ENVIRONMENT-AREA.
700560 WRITE-DDA-END.                                                   1003624
700600     SKIP1
701906* --  EXCEPTION RECORDS ARE WRITTEN ONLY WHEN THE                 IM003
701909* --  APPLICATION ENVIRONMENT IS NON-VSAM.                        IM003
701912     SKIP1                                                        IM003
701921     IF  EX-MST-CTL EQUAL '1'                                     IM003
701924         MOVE '0' TO EX-MST-CTL                                   IM003
701927         IF  SI-88-ENVIRONMENT-SEQ                                IM003
701930         OR  SI-88-ENVIRONMENT-EXCM                               IM003
701931             PERFORM S3100 THRU S3199-EXIT                        IM008
701933             MOVE  '1' TO I-O-CONTROL-OPERATOR                    IM003
701936             CALL  'IMACTM' USING I-O-CONTROL-AREA                IM003
701939                                  MASTER-AREA                     IM003
701940                                  SI-ENVIRONMENT-AREA.            1105504
701941*----------------------------------------------------------------*9915749
701942*  WRITE HDR REC FOR IMBRRRM PER RESERVE RECLASS PROCESSING.     *9915749
701943*----------------------------------------------------------------*9915749
701944     IF  WMS-EXC-CODE EQUAL '0'                                   9915749
701945         MOVE DDA-ACCT-MASTER TO BANK-REPORTING-RECORD            9915749
701946         MOVE 'O'             TO I-O-CONTROL-ACCESS               9915749
701947         MOVE 'L'             TO I-O-CONTROL-OPERATOR             9915749
701948         CALL 'IMBRRMS' USING    I-O-CONTROL-AREA                 9915749
701949                                 BANK-REPORTING-RECORD.           9915749
701970     MOVE '0' TO IBT-96-FLAG, IBT-ACCT-IND, SAVE-IBT-FLG.         9915857
701990 WRITE-DDA-EXIT.    EXIT.                                         9915845
702000 S3000.                                                           9715504
702002     MOVE '0' TO NEW-MASTER-SW.                                   1005110
702004     GO TO C0500.                                                 1005110
702005 S3010-RCK-AVERAGES.                                              2015719
702007     IF  WMS-LOAN-TRLR EQUAL '0'                                  1005110
702008     OR (WMS-LOAN-TRLR EQUAL '1' AND                              1005110
702009         WMS-PRIN-BAL EQUAL ZERO)                                 1005110
702010         GO TO S3010-NO-LOAN.                                     1004773
702011     SUBTRACT WMS-COSTS-UNEARNED FROM WMS-PRIN-BAL                1004773
702012                               GIVING WK-TFR-PRIN-BAL.            1004773
702013     MULTIPLY WK-TFR-PRIN-BAL BY HOLD-ACCRUAL-DAYS                1005110
702014                               GIVING WK-TFR-PRIN-BAL.            1005110
702015     ADD HOLD-ACCRUAL-DAYS TO WK-RCK06A0-NO.                      1004773
702016     ADD WK-TFR-PRIN-BAL TO WK-RCK06A0-AMT.                       1004773
702017     IF  WMS-COMPT-CALL-CODE EQUAL '04A0' OR '04B0'               1004773
702018         ADD HOLD-ACCRUAL-DAYS TO WK-RCK06D0-NO                   1004773
702019         ADD WK-TFR-PRIN-BAL TO WK-RCK06D0-AMT.                   1004773
702020     IF  WMS-COMPT-CALL-CODE EQUAL '06A0' OR '06B0'               1004773
702021         ADD HOLD-ACCRUAL-DAYS TO WK-RCK06E0-NO                   1004773
702022         ADD WK-TFR-PRIN-BAL TO WK-RCK06E0-AMT.                   1004773
702023 S3010-NO-LOAN.                                                   2010312
702024     IF  WMS-SAVINGS-TRLR EQUAL '1'                               2010312
702025     AND WMS-INT-INV-IND EQUAL 'N'                                2010312
702026     AND WMS-CMA-INDICATOR EQUAL '0'                              2010312
702027         MOVE WMS-INT-CUR-BAL TO WK-TFR-PRIN-BAL                  1005110
702028     ELSE                                                         1005110
702029         MOVE ZERO TO WK-TFR-PRIN-BAL.                            1005110
702030     IF  WMS-DDA-BAL GREATER THAN ZERO                            1005110
702031         ADD WMS-DDA-BAL TO WK-TFR-PRIN-BAL.                      1005110
702032     MULTIPLY WK-TFR-PRIN-BAL BY HOLD-ACCRUAL-DAYS                1005110
702033         GIVING WK-TFR-PRIN-BAL.                                  1005110
702034     IF  WK-TFR-PRIN-BAL GREATER THAN ZERO                        1004773
702035     AND (WMS-MMDA-INDICATOR NOT EQUAL '1' AND '2' AND '3')       0437111
702036     AND (WMS-IOD-RATE-PTR GREATER THAN 0 OR                      1004773
702037         WMS-HIFI-INDICATOR GREATER THAN 0)                       1004773
702038         ADD HOLD-ACCRUAL-DAYS TO WK-RCK1000-NO                   1004773
702039         ADD WK-TFR-PRIN-BAL TO WK-RCK1000-AMT.                   1004773
702040     IF  WK-TFR-PRIN-BAL GREATER THAN ZERO                        1004773
702041     AND (WMS-MMDA-INDICATOR EQUAL '1' OR '2' OR '3')             0437111
702042     AND (WMS-IOD-RATE-PTR GREATER THAN 0 OR                      1004773
702043         WMS-HIFI-INDICATOR GREATER THAN 0)                       1004773
702044         ADD HOLD-ACCRUAL-DAYS TO WK-RCK11A0-NO                   1004773
702045         ADD WK-TFR-PRIN-BAL TO WK-RCK11A0-AMT.                   1004773
702046 S3010-EXIT.                                                      1005110
702047     EXIT.                                                        1005110
702048                                                                  1005110
815800*                                                                 0727606
815801***-------------------------------------------------------------* U06ENE
815802***  THE REST OF IM31 CODE WAS TRANSFERRED TO COPYBOOK          * U06ENE
815803***-------------------------------------------------------------* U06ENE
815804     COPY IMPD31UA.                                               U06ENE
815805*                                                                 U06ENE
815900     COPY IMPD31PE.                                               0937740
816000*                                                                 0727606
816100     COPY IMPDPLED.                                               0727606
816200*                                                                 0727606
900200     COPY IMPD31PR.                                               0827778
900300                                                                  0827778
900400     COPY IMPD31CC.                                               1020057
900500                                                                  1020057
